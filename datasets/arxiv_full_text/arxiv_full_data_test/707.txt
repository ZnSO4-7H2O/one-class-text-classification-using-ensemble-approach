{"title": "Adaptation to criticality through organizational invariance in embodied  agents", "tag": "q-bio", "abstract": " Many biological and cognitive systems do not operate deep within one or other regime of activity. Instead, they are poised at critical points located at phase transitions in their parameter space. The pervasiveness of criticality suggests that there may be general principles inducing this behaviour, yet there is no well-founded theory for understanding how criticality is generated at a wide span of levels and contexts. In order to explore how criticality might emerge from general adaptive mechanisms, we propose a simple learning rule that maintains an internal organizational structure from a specific family of systems at criticality. We implement the mechanism in artificial embodied agents controlled by a neural network maintaining a correlation structure randomly sampled from an Ising model at critical temperature. Agents are evaluated in two classical reinforcement learning scenarios: the Mountain Car and the Acrobot double pendulum. In both cases the neural controller appears to reach a point of criticality, which coincides with a transition point between two regimes of the agent's behaviour. These results suggest that adaptation to criticality could be used as a general adaptive mechanism in some circumstances, providing an alternative explanation for the pervasive presence of criticality in biological and cognitive systems. ", "text": "dept. computer science university zaragoza zaragoza spain ias-research center life mind society university basque country donostia-san sebasti´an spain institute cross-disciplinary physics complex systems palma spain arag´on institute engineering research zaragoza spain *scimaguilera.net many biological cognitive systems operate deep within regime activity. instead poised critical points located phase transitions parameter space. pervasiveness criticality suggests general principles inducing behaviour well-founded theory understanding criticality generated wide span levels contexts. order explore criticality might emerge general adaptive mechanisms propose simple learning rule maintains internal organizational structure speciﬁc family systems criticality. implement mechanism artiﬁcial embodied agents controlled neural network maintaining correlation structure randomly sampled ising model critical temperature. agents evaluated classical reinforcement learning scenarios mountain acrobot double pendulum. cases neural controller appears reach point criticality coincides transition point regimes agent’s behaviour. results suggest adaptation criticality could used general adaptive mechanism circumstances providing alternative explanation pervasive presence criticality biological cognitive systems. introduction generally behaviour biological cognitive systems steadily poised phase another. instead living beings operate around points critical activity boundary separating ordered disordered dynamics. critical activity criticality refers distinctive properties found transition. properties include presence wide range scales activity maximal sensitivity external ﬂuctuations facilitating systems criticality present optimal responses facing complex heterogeneous environments. surprising fact that unlike unanimated matter critical transitions order disorder take place ﬁne-tuning parameters system living systems appear ubiquitously poised near critical points. instance signatures criticality detected neural cultures immune receptor proteins network genes controlling morphogenesis embryos bacterial clustering. indicators critical behaviour also observed brain cognitive behavioural patterns. although results suggest general theoretical principles might underlie biological self-organization well-founded theory understanding living systems operate near critical points broad range contexts. compels type mechanisms driving biological systems dauntingly diverse span levels organization operate near critical points activity. last couple decades issue popularized ‘adaptation edge chaos’ different solutions tested modelling approaches. however stated question still unresolved general mathematical framework understanding living systems driven criticality lacking. synthesize approaches proposed explain presence criticality spreading wide range natural systems could broadly consider general positions. hand approaches assuming biological systems self-tuned either learning evolution regions parameter space displaying optimal ﬁtness optimal points often placed near critical points functional advantages critical behaviour words criticality understood by-product derived adaptive survival processes living systems. hand different views focused idea self-organized criticality systems criticality emerges spontaneously simple local interactions without tuning parameters model. typically models exploit clever local rules produce critical behaviour speciﬁc context–. nevertheless approaches present weaknesses. understanding criticality biological systems indirect consequence adaptation external circumstances explanatory provide ways test alternatives. general explanations simply assume consequence ‘survival ﬁttest’ often unfalsiﬁable. regard second approach well known many models highly idealized many cases able capture basic interactions living systems often failing provide general explanations ubiquitous emergence criticality. reason although adaptive self-tuning models present interesting insights generally applicable relatively narrow contexts highly idealized conditions. paper explore alternative approach examine system display critical activity wide variety situations. propose model that using general local mechanisms aimed adaptively maintain behaviour system around critical point parameter space maintaining certain relational invariants. words instead thinking criticality by-product adaptation complex environments spontaneous property certain systems inquire possibility biological systems might equipped adaptive mechanisms aimed preserve internal equilibrium near critical points interact environment. among outcomes existence cheap learning mechanisms maintaining parameters system around regions criticality could drastically reduce cost searching large parametric spaces ﬁnding solutions even generate interesting solutions unsupervised manner. paper structured follows. first propose novel method appears capable driving system near critical points maintaining certain relational invariants. case invariants extracted correlation structure well-known model operating critical point correlations scale distance according power function. second propose simple learning rule maintaining correlation invariance hypothesize could used driving systems different contexts operate near critical points. test model using classical examples learning control mountain double pendulum. show evidence suggesting general rule proposed able drive adaptive agents free parameters towards critical points operation. time agents poised points behavioural transition able exploit broad span dynamic possibilities available environment suggesting link internal search critical points exploration external behavioural points transition. finally suggest tests criticality discuss limitations possible generalization synthetic approach contribution towards understanding deeper principles governing biological cognitive systems. model inspired ideas described above present novel simple mechanism designed test whether general adaptive system able drive neural controller near criticality imposing certain patterns organizational structure system. focus system’s organization instead mechanistic properties components supported existence well-known universality classes provide uniﬁed expression families systems operating criticality. physics concept universality allows group great variety different critical phenomena small number universality classes systems belonging given universality class essentially identical near critical point. thus systems belonging universality class even deﬁned different material parameters physical properties critical exponents characterizing diverging observables. example different spin percolation models family bidimensional lattices spatial correlations follow asymptotic form near phase transition point lattice structures dimension particular model. surprising property provides perspective criticality terms universal relations suggesting could model criticality using simple non-speciﬁc mechanisms independently individual parameters system. hypothesis following systems belonging universality class present distribution correlations criticality adjusting arbitrary system reproduce distribution correlations might drive system similar critical point. said neighborhood critical points critical exponents assume universal values particular class could enough analysis simple model. looking generality least structured statistical model network interacting units constrained pairwise correlations them. known ising model physics boltzmann machine computer science. interest using also simplest models criticality solved analytically. ising model speciﬁed neural network binary variables constrained pairwise correlations. units value affected local bias couplings pairs units. parameters take continuous values assume couplings symmetric order simulate behaviour model units updated sequentially random order using glauber dynamics unit activated probability follows sigmoid function effective ﬁeld received neuron summing internal ﬁeld inputs neurons energy difference required sign unit state model updated sequentially applying glauber dynamics simulation step units network random order. updated sequentially ising model symmetric couplings reach equilibrium maximum entropy distribution normalization value. energy distribution follows exponential family state size deﬁned terms bias couplings pairs units boltzmann’s constant temperature system. without loss generality operating working temperature following intuition introduced universality classes looking model preserves certain structure correlations system. experimental evidence showing that given ising model near critical point could build family models learning correlations drawn random original system poised near critical point. inspired idea propose reproduce support criticality maintaining distribution correlations particular universality class. interestingly ising model well-studied example universality class. case bidimensional lattices pairwise correlations follow asymptotic form distance units. however instead restricting model particular mechanisms given topology decide design learning rule preserves distribution correlations critical point belonging speciﬁc universality class. could capture properties universality class without choosing speciﬁc topology parametrical conﬁguration. next goal would test whether adaptive mechanism capability driving arbitrary system critical point. case system poised near critical point display interesting features adaptive behaviour maximal sensitivity wide dynamic range behaviours. order test idea design simple learning rule adjust parameters arbitrary ising model desired distribution correlations. nutshell learning rule operate follows distribution correlations ﬁnite square lattice ising model calculated model deﬁned assigning neuron reference correlation values synapses randomly sampled previous distribution learning neuron sorts synapses correlation strength adjusts correlations reference values assigned using inverse ising learning rule. proceed explain points detail. first since size models employed thermodynamic limit instead directly using diverging asymptotic form approximate computing correlation structure ﬁnite model operating known critical temperature. cases ising model presents exact solution model zero ﬁelds exploiting this build bidimensional square lattice connectivity critical point appears observed figure since ﬁelds units zero means units also zero. second distribution correlations obtained generate models adjusting correlations match distribution applying local information assign neuron correlation values ...n drawn random step compute actual correlations neuron neighbours denote sorted reference values equal zero. reason sorting values correlations give ﬂexibility rule since interested maintaining relation independently connection holds value. constant learning rate mean correlations model current values generally performing learning step computationally expensive since requires summing possible states although approximate methods monte carlo sampling generally used speed learning. similarly compute approximate correlations simulating networks using glauber dynamics equation number steps. testing adaptation criticality isolated networks demonstration method apply learning rule different networks sizes assigning means correlations drawn random distribution found lattice ising model. network apply equation learning order simplify process made operative decisions. instance since precision learning important wait convergence algorithm simply update learning rule times. learning rate compute samples learning step size system. simplicity also instead critical temperature lattice ising model arbitrary inverse temperature note choice operating temperature irrelevant since implies rescaling parameters algorithm compensate. network test near critical point computing heat capacity. divergence heat capacity sufﬁcient indicator continuous phase transition indicating presence critical point maximal sensitivity parametrical changes. model heat capacity represented e−e) hisi jsis energy ising model plogp entropy system. test system criticality using entropy system order parameter looking continuous phase transitions associated critical points. detect continuous phase transition entropy presents sharp continuous transition derivative entropy diverges system size increases. simulate network steps different values heat capacity networks diverges operating temperature showing values similar original lattice ising model periodic boundaries. point although distribution correlations similar lattice ising model structure network radically changed. instead original ordered structure uniform lattice disordered distribution couplings including positive negative values. also execution learning algorithm yields completely different arrangement values couplings following section test capacity learning rule driving neural controller embodied agent towards critical point. order need take account environment learning. consider interconnected ising models equation holds perfectly apply values corresponding units neural controller. case ising model environment instead classical examples reinforcement learning goal testing realist scenario. therefore learning rule valid long statistics environment approximated ising model arbitrary number units. luckily ising models form boltzmann machines universal approximators stationary distribution arbitrary environment approximated equivalent ising model. embodied model mountain acrobot order evaluate behaviour proposed learning rule test embodied situations using openai toolkit. deﬁne neural network consisting ising model deﬁned equation describing network figure divergence heat capacity models learning random correlations sampled figure maximum minimum values shown grey area. distribution values coupling matrix units ising model learning correlations sampled figure values correspond values colour bar. figure structure embodied neural controller model units hidden units. mountain environment under-powered must drive steep hill balancing gain momentum. acrobot environment agent balance double pendulum reach high part environment. units hidden units motor units sensor units. motor units deﬁne actions performed agents. sensor units magnetic ﬁeld unit ﬁxed parameter updated value external input sensor units motor units connected hidden neurons hidden neurons connected neurons choose conﬁguration widely used neural networks allowed recurrence connectivity hidden units although architecture choice restrictive. units assigned reference values shown figure units except sensor units assigned objective mean value learning agent applies rule equation adjusting means correlations assigned values. simulation step units ising model updated sequential random order using glauber dynamics ﬁrst embodiment network consists mountain environment. environment classical testbed reinforcement learning depicting under-powered must drive steep hill since gravity stronger car’s engine vehicle must learn gain potential energy driving hill able make goal opposite hill neural network receives speed system input controls force car’s engine output. second embodiment consists double pendulum ‘acrobot’ coordinate movements connected links lift weight neural network receives speed ﬁrst pendulum controls torque applied joint pendulums. sizes train agents environments applying learning rule equation note agents learning explicit goal adjusting correlations system random sample extracted probability distribution figure supplementary videos observe example behaviour agents training. figure s.c-d distribution correlations agent figure s.e-f shows error distribution figures s.c-d agents. figures s.c-d observe agents learning display correlation results section analyse behaviour neural controllers behavioural patterns agents respect possibilities parameter space. goal test learning rule proposed effective driving agent near critical points. observe below agents display quite similar behaviour environment despite fact learned different values interested analysing anything special conﬁguration reached agents learning. order compare agents behavioural possibilities explore parameter space changing parameter agents. modifying value equivalent global rescaling parameters agent transforming thus exploring parameter space along speciﬁc direction. changing testing dimension parameter space possible models. first assess presence criticality neural controller agent. speciﬁcally look presence continuous phase transition order parameter system presents sharp transition displaying divergence derivative second analyze behaviour neural controller agent whole looking behavioural transitions agents divergences susceptibility agent’s behaviour parametrical changes. signatures criticality neural controller order test whether agents driven towards critical point analyse signatures critical behaviour neural controller agent. mentioned before sufﬁcient indicator criticality presence divergence heat capacity system divergence heat capacity indicates presence continuous phase transition presenting critical point system maximally sensitive parametrical changes. unfortunately neural controller embodied mountain acrobot environments longer access formal description probability distribution agent-environment system thus cannot directly compute energy system values entropy heat capacity system. nevertheless still directly compute entropy plogp variable system estimating probability distribution simulations. order compute entropy heat capacity different variables simulate agent’s behaviour values logarithmically distributed interval agents embodiment simulation steps reseting agent’s position state every simulation steps. first compute entropy probability function hidden neurons controller. computational constraints compute entropy agents hidden units. displaying entropy neurons different values observe agents near order-disorder transition larger sizes make transition sharper closer operating temperature entropy variable heat capacity computed computed values entropy estimated ﬁtting curve using cubic b-splines indicated methods section. figure observe system displays similar divergence heat capacity neural network ising model suggesting robot’s neural controller critical point. order conﬁrm divergence observed transition larger systems evaluated. since evaluating entropy hidden neurons computationally infeasible large sizes repeat analysis state sensor units network larger amount hidden units. figure show entropy heat capacity sensor units sizes hidden neurons observe similar picture figure suggesting heat capacity diverges second order transition takes place neural controller agent. results suggest agent’s neural controller operating near point criticality resembling continuous phase transition indicating neural controller self-organizes present maximal sensitivity changes parameter space. addition presence continuous phase transition classical signature criticality presence power distributions statistical descriptions states system. unlike isolated ising model neural network connected environment probability distribution ising neural controller longer described equation thus compute probability distribution system counting occurrence state units compute probability distribution ising model simulate system simulation steps. training agent’s position state reset every simulation steps. observe agents approximately follow zipf’s mountain acrobot embodiments error bars narrow range. power-law distribution neural activation patterns suggests neural controller agents operating near critical figure entropy agent’s neural controller different sizes different agents values heat capacity agent’s neurons computed estimated using b-splines. maximum minimum values shown grey area. ﬁgures suggest mountain acrobot embodiments model presents divergence heat capacity number neurons increases suggesting neural controller system near continuous phase transition. figure entropy sensor units different sizes different agents values heat capacity agent’s neurons computed maximum minimum values shown grey area. ﬁgures suggest mountain acrobot embodiments system presents divergence heat capacity number neurons increases suggesting neural controller system near second order phase transition. figure ranked probability distribution function neural network different agents different sizes mountain acrobot embodiments. real distribution compared distribution following zipf’s /rank dash-dotted line). observe good agreement model zipf’s suggesting critical scaling. point. note sole occurrence power generally insufﬁcient assess presence criticality arise naturally non-equilibrium conditions. nevertheless together apparent divergence heat capacity supports idea neural controller agents might poised near critical state. behavioural transitions parameter space imply agent adapt poised near critical point? remarked agents given explicit goal. tend adapt behavioural patterns maintaining distribution correlations randomly sampled distribution shown figure explore issue examine different behavioural modes agent exploring parameter space changing value behaviour mountain described horizontal position speed different moments time. well horizontal vertical positions acrobot’s links good description behaviour. figure .a-c observe behaviour mountain agent {..} respectively. observe values lower operating temperature agents able reach mountain. hand higher agents present ‘rigid’ trajectories going mountain peak other. agent able reach mountain displaying larger behavioural diversity. similarly figure .d-f observe acrobot agent displays diverse range behaviours able reach plane while lowered increased drifts behavioural modes less diverse regimes. although agent represented environment results figure similar agents sizes. general picture different agents sizes analyse behavioural transitions relevant variables agent environment systems. furthermore analyse whether behaviour agent neural controller near critical point. inspecting this calculate mean height agents simulations compute susceptibility height value case susceptibility appears increase monotonically size size doubled even increases uniform figures although tests criticality could validate criticality also found whole agent-environment system ﬁgures suggest continuous phase transition neural controller corresponds sharp transition agent’s behaviour. discussion recapitulating main ideas presented tested taking correlations chosen random distribution generated lattice ising model critical point construct model appears also near critical point parameter space. moreover embodied agent maintains correlations using simple learning rule interacting environment sort organizational homeostasis agent neural controller seems driven critical point coincides behavioural transitions agent-environment parameter space. computational limitations estimating probability distribution embodied ising networks calculate entropy heat capacity neural controllers hidden neurons approximate larger sizes computing entropy heat capacity sensor neurons neural controllers total neurons. results still thermodynamic limit tests conﬁrm results presented larger sizes. nevertheless cases observe clear diverging tendency heat capacity every time size system doubled. tests larger sizes could performed designing environments described gibbs distribution figure transition behavioural regime agents show behaviour individual agents different values mountain acrobot embodiments. observe transition point modes behaviour agents. figure mean height agents different sizes different agents values susceptibility agent’s behaviour computed maximum minimum values shown grey area. ﬁgures suggest mountain acrobot embodiments behaviour agent presents sharp transition around results suggest possibility criticality could diagnosed induced directly maintenance given distribution correlations rather modelling precise mechanistic structure. also results show criticality could generated quite simple mechanisms relying local information maintaining speciﬁc correlations around given value. implemented mechanism simple boltzmann learning process rules could effect combination hebbian anti-hebbian tendencies speciﬁc ratios simple mechanisms. model require system maintain distribution relations components system. connects systemic approaches biology interested speciﬁc intrinsic components biological systems networks relations processes–. also line notions relational invariance piaget’s approach functional invariants cognitive development maturana varela’s ideas autopoietic machines deﬁned homeostatic systems maintain organization constant network relations components. assuming similar systemic perspective derived learning rule intended drive system towards critical points maintaining invariant structure correlations roughly deﬁned critical exponent /rη. approach assumes different point view self-organized criticality distribution correlations consequence criticality speciﬁc topology cause driving indeterminate topology appears critical point. question whether imposing connections derived function strong assumption implies particularly exigent circumstances. think since power functions naturally generated simple rules preferential attachment favouring ‘rich-get-richer’ cumulative inequalities directly natural consequence certain geometries space model assumes system going adapt order preserve internal network relations. emphasizes maintenance organizational structures capable reproducing behaviour living systems without relying internal models external source sensory input. contrasts approaches focused understanding criticality strategy effectively represent complex variable external world example studying criticality predictive coding deep learning architectures dealing complex inputs cases internalist view assumed neural controller represents structures external world whose complexity cause critical activity neural controller. instead approach agnostic terms inputs external world organism deals agent rearranges internal structures facing different environments. agents presented speciﬁcally designed particular problem. simple terms agents generate wide variability richness behaviours permits explore space parameters eventually achieve solutions designed ﬁnd. empirical evidence experiments shown supports idea. parallel could established concept play understood ‘rule-breaker’ activity constraints stable self-equilibrating regime behaviours concrete goals. model presented could used exploring life-like autonomous behaviour without need explicit internal representations goals rule-based behaviour. conceptual models critical activity based maintenance system’s relational invariants could help development synthetic route towards exploration adaptive embodied criticality. mountain car. environment consists mass moving along one-dimensional environment. environment agent moves position horizontal axis limited interval horizontal position represents point environment mountains whose height deﬁned .sin. velocity horizontal axis updated time step .cos action motor either impulsing force inputs sensor units deﬁned array units assigned instantaneous velocity discretized array bits. input assigned value corresponding active otherwise. acrobot. acrobot two-link planar robot composed pendulums joined motor applying torque clockwise counterclockwise directions joint links. position system deﬁned torque applied system either mass links length links lengths center mass links moments inertia links gravity. well variables total moments inertia link linked potential energy system order make tasks challenging maximum velocity allowed mountain task difﬁculty. mass acrobot links parameters designed make difﬁcult agents controlled neural networks random parameters solve task success rates mountain acrobot. success rates evaluated simulating neural controllers random parameters mountain simulated simulation steps starting random position valley considered successful reached maximum position least once. acrobot simulated simulation steps bottom position consider successful reached vertical position higher training. training agents initialized starting random positions bottom environments mountain acrobot). state neural network randomized initial parameters zero. agents simulated trials steps computing trial values applying equation trial. agent’s position state reset every simulation steps code availability. source code implementing learning rule different examples freely available https// github.com/miguelaguilera/adaptation-to-criticality-through-organizational-invariance. curve interpolation. heat capacity hidden sensor units computed interpolating entropy curves using cubic b-splines using scipy function splrep smoothing coeﬁcient different coeﬁcients tested similar results. mora bialek biological systems poised criticality? stat. phys. schneidman berry segev bialek weak pairwise correlations imply strongly correlated network states kauffman origins order self-organization selection evolution beggs plenz neuronal avalanches neocortical circuits. neurosci. tang wiesenfeld self-organized criticality. phys. rev. lett. ./phys. brockman openai gym. arxiv. moore efﬁcient memory-based learning robot control sutton generalization reinforcement learning successful examples using sparse coarse coding. advances dierckx curve surface fitting splines bernard greene introduction study experimental medicine rosen relational cell models metabolism-repair systems. foundations mathematical biology ashby principles self-organizing system. princ. self-organization piaget biology knowledge essay relations organic regulations cognitive processes acknowledgements research supported part spanish national programme fostering excellence scientiﬁc technical research project psi--exp project tin--r funded spanish ministry economy competitiveness upv/ehu post-doctoral training program espdoc/.", "year": "2017"}