{"title": "Perfect spike detection via time reversal", "tag": "q-bio", "abstract": " Spiking neuronal networks are usually simulated with three main simulation schemes: the classical time-driven and event-driven schemes, and the more recent hybrid scheme. All three schemes evolve the state of a neuron through a series of checkpoints: equally spaced in the first scheme and determined neuron-wise by spike events in the latter two. The time-driven and the hybrid scheme determine whether the membrane potential of a neuron crosses a threshold at the end of of the time interval between consecutive checkpoints. Threshold crossing can, however, occur within the interval even if this test is negative. Spikes can therefore be missed. The present work derives, implements, and benchmarks a method for perfect retrospective spike detection. This method can be applied to neuron models with affine or linear subthreshold dynamics. The idea behind the method is to propagate the threshold with a time-inverted dynamics, testing whether the threshold crosses the neuron state to be evolved, rather than vice versa. Algebraically this translates into a set of inequalities necessary and sufficient for threshold crossing. This test is slower than the imperfect one, but faster than an alternative perfect tests based on bisection or root-finding methods. Comparison confirms earlier results that the imperfect test rarely misses spikes (less than a fraction $1/10^8$ of missed spikes) in biologically relevant settings. This study offers an alternative geometric point of view on neuronal dynamics. ", "text": "perfect spike detection time reversal krishnan p.g.l. porta mana helias diesmann napoli institute neuroscience medicine jülich research centre germany institute advanced simulation jülich research centre germany department physics faculty rwth aachen university aachen germany aachen institute advanced study computational engineering science rwth aachen university germany correspondence* jeyashree krishnan j.krishnanfz-juelich.de spiking neuronal networks usually simulated three main simulation schemes classical time-driven event-driven schemes recent hybrid scheme. three schemes evolve state neuron series checkpoints equally spaced first scheme determined neuron-wise spike events latter two. time-driven hybrid scheme determine whether membrane potential neuron crosses threshold time interval consecutive checkpoints. threshold crossing however occur within interval even test negative. spikes therefore missed. present work derives implements benchmarks method perfect retrospective spike detection. method applied neuron models affine linear subthreshold dynamics. idea behind method propagate threshold time-inverted dynamics testing whether threshold crosses neuron state evolved rather vice versa. algebraically translates inequalities necessary sufficient threshold crossing. test slower imperfect faster alternative perfect tests based bisection root-finding methods. comparison confirms earlier results imperfect test rarely misses spikes biologically relevant settings. last decade considerable work devoted improve accuracy simulators capable efficiently simulating large networks spiking neurons field driven ideal combining capability cope high-frequency synaptic classical schemes simulate neuronal networks time-driven event-driven schemes schemes describe state neurons variables action potentials events mediate interaction them. time-driven scheme state neuron updated time grid defined simulation step neurons updated membrane potential checked threshold crossings. membrane potential neuron threshold checkpoint spike delivered neurons connected subsequently iteration step begins. step size stipulates frequently occurrences threshold crossings inspected simulation. choice step size trade-off spike accuracy speed simulation morrison grid-constrained simulations force spike event position equidistant temporal grid spanned step size therefore induce artificial synchronization network dynamics event-driven scheme state neuron updated receives spike. central queue events maintained spike inserted queue time stamp. upon update neuron predicts next spike occur absence input. preliminary event inserted queue confirmed becomes removed invalidated input. efficient elegant predicition methods developed classes neuron models without invertable dynamics however maintaining central queue distributed simulation challenging compromise time performance simulator hybrid scheme circumvents shortcomings schemes embedding locally eventdriven algorithm neuron globally time-driven scheme arrival spike neuron introduces additional update check point. dynamics given neuron propagated incoming spike incoming spike eventually point global timestep. membrane potential neuron threshold local global check point precise point threshold crossing determined continuous time spike emitted. next location time grid scheme spike events carry floating point offset. thus contrast event-driven scheme hybrid scheme predict future spike times identifies threshold crossings retrospectively. hanuschkin demonstrate latter scheme equally accurate former lower computational costs. hybrid scheme still loophole however spikes missed. reason that time-driven scheme crossing threshold voltage tested inspecting whether membrane potential neuron threshold checkpoint nevertheless membrane potential evolved subthreshold dynamics threshold consecutive checkpoints double quadruple etc. threshold-crossing occurred between. first crossing constitutes missed spike. symbolically figure illustration undetected threshold crossing consecutive checkpoints time grid. short black vertical represents incoming spike causes increase membrane voltage neuron leading threshold crossing subthreshold dynamics however brings voltage threshold next checkpoint. since test yields false outgoing spike missed. dots indicate points values state variables known. conceptual question therefore remains whether globally time-driven scheme formulated detects every threshold crossing. although hanuschkin argue loss spikes standard test practical relevance natural parameter regimes availability method perfect construction would free researcher inquietude costly controls faced previously unexplored neuron models network architectures. work propose spike-detection method term lossless method lossless test necessary sufficient condition threshold crossing occur given time interval. method based state-space analysis works neuron model affine linear subthreshold dynamics. consists system inequalities linear non-linear state-space variables together determine whether initial state neuron reach threshold within time interval next checkpoint. lossless method replaces standard test time-driven hybrid scheme. alone solve problem artificial synchronization time-driven scheme suffers from. hence method meaningful within hybrid scheme. thanks perfect spike detection lossless method fact used benchmark hybrid scheme based standard test; hanuschkin method d’haene purpose. section present idea behind lossless method general neuron model affine linear dynamics develop mathematical construction. parts construction must addressed case-by-case basis; therefore section provide concrete implementation lossless method leaky integrate-and-fire model exponential synaptic currents within hybrid scheme. method algorithmically expressed different ways. explore alternative cascades inequalities assess costs terms time-to-completion relative hybrid scheme based standard test latter scheme also assess number missed spikes commonly considered network regimes. hybrid scheme based lossless method delivers desired exact implementation mathematical definition neuron model without approximation floating point precision. preliminary results published abstract form technology described present article made available next major releases open-source simulation software nest. conceptual algorithmic work described module long-term collaborative project provide technology neural systems simulations summarize problem mentioned previous section. assume neuron’s state evolves according three different dynamics integrable subthreshold dynamic long neuron’s membrane potential threshold changes input currents; discrete jumps subthreshold dynamics predetermined times corresponding incoming spikes sudden changes external currents; formally incorporated subthreshold dynamics delta functions; spike i.e. instantaneous jump membrane potential threshold reset value soon potential reaches threshold value. jump followed refractory period membrane potential remains constant reset value. integrable dynamics takes place again. advantage integrable dynamics state neuron time analytically determined time negative positive. evolution thus calculated discrete time steps particular times jumps occur. spike part dynamics however forces check whether membrane potential reached threshold value within timestep interval call event threshold crossing sufficient condition threshold crossing membrane potential threshold time step continuity must assumed threshold value time interval condition necessary time step potential touch surpass threshold value again figure even number times. value threshold ends time step test relies sufficient condition standard test therefore miss spikes leading incorrect dynamics. need test based necessary sufficient condition. necessary sufficient condition threshold crossing trajectory state t+h] intersect hypersurface membrane potential threshold value. translated analytic geometry means finding solutions system parametric equations representing threshold hypersurface trajectory test whether solution empty idea illustrated figure two-dimensional state space. system usually transcendental solutions found numerically. unfortunately numerical solutions typically rely bisection algorithms involving increasingly finer timestepping dynamics. nullifies advantage integrable dynamics coarse-grained time steps. problem test intersection trajectory threshold tells whether threshold crossing occurs also time does. test’s high computational cost partly comes delivering additional information. problem avoided formulate different geometric test tells whether threshold crossing occurs deliver crossing time. instead evolving state neuron forwards time tracing trajectory state-space checking crosses threshold hypersurface evolve threshold hypersurface backwards time sweeping hypervolume check crosses initial neuron state point. words testing whether point belongs particular state-space region. test intersection -dimensional curve -dimensional surface replaced test membership point n-dimensional volume. idea illustrated figure two-dimensional state-space. mathematically latter test translates system inequalities initial state must satisfy cross threshold within even transcendental functions appear system need find roots need test whether inequalities satisfied simply inserting value state-space variables functions. equations corresponding inequalities represent piecewise-differentiable boundary states cross threshold within timestep call spike region won’t call no-spike region. finding inequalities explicit form important point method achieved heuristic procedure find hypervolume swept threshold parametric form. done representing backpropagation threshold state-space manifolds product manifold threshold time state-space manifold. find boundary hypervolume parametric form. done determining placement images boundaries product manifold important images critical points map. latter points becomes singular thus mapping hypervolume elements hypersurface elements following analysis mathematically develop first steps general neuron model affine dynamic. point generalized kinds dynamics. procedure last steps depends particular neuron model give general guidelines. section provides concrete example steps. advantage procedure geometrically explained needs carried given neuron model. advantage novel test computational cost distributed differently approach trajectory initial point followed. hand-waving terms trajectory-based test crossing time immediately available parametrization orbit; threshold-crossing condition represented computationally costly inequalities crossing time exists read immediately. novel test crossing time complicated function hypervolume parametrization; threshold-crossing condition case represented inequalities computationally less costly explicitly deliver crossing time. knowledge latter requires additional computational cost. novel test thus allows avoid extra cost check existence threshold-crossing; need crossing occur. figure illustration exact methods check whether initial state crosses threshold evolution upper panel idea root-finding method evolve state forwards time step check whether trajectory intersects threshold. method informs intersection occurs threshold time. lower panel idea lossless method evolve whole threshold backwards time step check whether trajectory volume state-space contains initial state kept fixed. threshold shifts rotates evolves trajectories individual points unknown method inform crossing occurs therefore computationally faster. mathematical point view approaches equivalent. state-space technique useful reformulation conventional trajectory view obtained suitable mathematical manipulations. conceptual device propagating threshold backwards time useful performs manipulations transparent manner gives intuitive dynamical meaning. final equations obtained derived concepts vector analysis cartesian geometry functional analysis; derivation lengthy. shorten concepts terminology affine spaces differential manifolds state-space neuron natural vector-space structure inherited physical quantities define membrane potential physical quantities whose exact number definition depend specific neuron model purpose useful consider n-dimensional differential manifold points neuron states quantities coordinates e.g. membrane potential state coordinates respect vector structure state-space i.e. likewise defines normal hyperplane affine term. inequality half-spaces delimited hyperplane. threshold hyperplane especially important states whose membrane potential threshold value show integrable part neuron dyamics within finite time step affine transform. similarly integrable part neuron dynamics consider affine evolution determined equation mathematically summarize first threshold-crossing test discussed section said state evolution efficiently used time-step scheme numerical simulations need test whether threshold crossing occurred time necessary sufficient condition would existence solutions trascendental equation develop second kind threshold-crossing test discussed section according steps i–iv. steps performed full generality affine dynamics. steps solved case-by-case basis analysis guideline; concrete example perform given section section direction past. analytic generally embedding self-intersections. significance section immersion either singular points; especially important constitute part boundary spike no-spike regions. figure two-dimensional example. must find boundary image latter closed image closed continuous map; boundary must therefore image points domain. points must either boundaries domain critical points both differentiable. example figure determinant inverse ratio volume element point image state-space hence ratio vanishes points volume elements mapped onto area elements feature boundary. two-dimensional example figure look points determinant exponential never vanishes consider determinant matrix right. easily calculated laplace expansion along last whose elements vanish except last. cofactor last element hence locus four important interrelated features first form locus critical points flat along dimensions corresponding fixed value coordinate curved normally direction -ruled surface. second points locus corresponding fixed belong hyperplane coefficients easily checked substitution. words locus critical points envelope backpropagated threshold hyperplanes different times tangent hyperplanes normals fourth comparing dynamics threshold hyperplane critical-point condition notice latter also condition trajectory state threshold hyperplane extremum membrane potential hence locus critical points trajectory intersection threshold -nullcline. next step elimination parameters express envelope implicit equations defined domains state-space coordinates step involve transcendental equation therefore cannot give general solution regard criticism might raised immediately address looks like already taken great care avoiding solve face another difficult transcendental equation? current problem manageable three reasons. first observe equations needed re-express curved surface explicit form generally easier handle section gives concrete example. second problem finding explicit form curved surface must solved once whereas solution original equation found initial state third equation curved surface condition leaves completely undetermined outside envelope. therefore possible useful extend condition follows. since envelope backpropagated threshold hyperplanes different times must correspond backpropagated tangent them. inequalities below-threshold half-plane useful choose inequality determines side corresponding intersection half-spaces. example given section differential positive multiple collinear tangency condition). state cross threshold hyperplane time must definition belong every image half-space lies threshold half-space backpropagated time mathematically simply statement equivalence construction previous subsection inequality defines region intersection backpropagated half-spaces bounded envelope need join condition boundaries corresponding times discussed section previous section mentioned n-dimensional product manifold formed dimensional threshold hyperplane time interval presents self-intersections mapped state-space. two-dimensional examples region shown figure lower panel figure region called note impossible affine transformation since first column never vanish. condition simply means crosses threshold interval interval continuity dynamics must crossing above below exactly scenario double threshold crossing illustrated figure suppose probability distribution initial states example invariant dynamics probability self-intersection region probability initial state lead double-crossing threshold therefore missed. fact used section estimate number spikes missed. affine dynamics preserves affine combinations solutions therefore convex combinations well. arbitrary initial states no-spike region propagated states also satisfy also propagation convex combination satisfies convexity important approximations. transforming parametric equation envelope implicit form turns analytically impossible numerically find points envelope approximate latter simplices constructed points finely needed. words triangularize envelope. owing convexity triangularization done completely side no-spike region completely spike region formulate test false positives false negatives both. envelope moreover ruled surface shown section triangulation side no-spike region therefore conveniently chosen face simplex fully lies envelope. previous section mathematically developed idea propagating threshold backward time order check whether threshold-crossing occurs time-stepped dynamics. derivation valid affine subthreshold dynamics general therefore also quite abstract; moreover involves couple mathematical steps general formulae given. explain idea concreteness give example face steps apply scheme simple relevant model -dimensional state-space leaky integrate-and-fire neuron exponentially decaying post-synaptic currents. model homogeneous linear dynamics -dimensional state-space third coordinate input current. current constant dynamics rewritten -dimensional affine one. leaky integrate-and-fire models despite simplicity approximate behavior real neurons high accuracy model exponential synaptic currents captures important properties real neurons postsynaptic potential finite rise decay time membrane potential continuous function time. continuity avoids artificial synchronization present simpler models. moreover model extent analytically tractable. short synaptic time constants mean firing rate well linear response small inputs obtained analytically. example model -dimensional state-space single neuron defined post-synaptic current membrane potential also coordinates. subthreshold interspike dynamics section affine membrane capacitance membrane time constant synaptic input current external input current. membrane potential subject dissipation time constant integrates post-synaptic current latter decays exponentially time constant typical values parameters threshold incoming spikes incorporated equation current dirac deltas external current jump discontinuities time. timestepped evolution discontinuous events implemented instantaneous changes initial state timestep. hence need consider explicitly equations since state space -dimensional hyperplanes hypersurfaces section straight lines curves. particular threshold hyperplane line; propagated time maps onto line covector affine term given explicitly model testing threshold-crossing checking intersection propagated state threshold line means solving following transcendental system given initial state product manifold threshold line time interval case -dimensional coordinates value current threshold crossing corresponding time point. mapping state-space propagated different times. area element domain small rectangles upper plane mapped area element image. note area elements rotated sheared. thicker green curve singular points determinant tangent vanishes points singular around images area elements flattened dimension. discuss region self-intersection bounded thick light cyan line thick dark blue line thick green curved line. next step procedure convert parametric equation envelope explicit implicit equation coordinates section provide general algorithm illustrate process using example model. figure example dimensions. upper panel abstract manifold coordinates corresponding values current time threshold crossing. lower panel image state space. thick green curve corresponds singular points yellow lines constant trajectories states ending threshold. violet lines constant snapshots threshold moving backwards time. thicker violet blue lines correspond boundaries envelope degenerates point limit point reached infinite time initial point no-spike region; geometric interpretation equality external rheobase currents. calculate differential discussed section find latter positive multiple differential backpropagated threshold true three cases above. consequently inequality always includes no-spike region. summary arrive analytic implicit equation curved boundary expression transcendental function owing generally irrational exponent τs/τ used inequality hence need find roots. contrast original transcendental equation threshold-crossing condition requires bisection algorithm find solution. figure illustrates system cases former case three inequalities necessary; latter well last inequality automatically enforced first right-hand side larger threshold figure lower panel trajectories several states timestep ending threshold line represented yellow curves. figure identify region trajectories selfintersect bounded segment thick light blue line segment thick dark blue line portion thick green curved line. trajectories initial states region must therefore cross threshold twice interval explained section threshold-crossing detected sole condition states region thus generate spikes missed standard test region crucial comparison performances schemes implementing present lossless method schemes relying standard test comparison quantitatively made section figure system inequalities determining no-spike region. colored areas represent complementary inequalities system solution system white area. region delimited horizontal line corresponds first equation system blue region delimited inclined line second yellow region delimited curved line third. upper panel case inequalities necessary. lower panel case third inequality redundant. last section arrived system three inequalities determines whether current state cross threshold within timestep state cross threshold system satisfied cross threshold system satisfied. system inequalities constitutes lossless method present model. system requires current timestep state external electric current inputs timestep minimum global timestep time interval next input coming neurons hence differ every time test called. external electric current also vary stepwise simulation hence also distinct call test. system inequalities satisfied thus predicting absence spike within timestep state neuron evolved applying propagator leading state procedure starts again. system satisfied thus predicting occurrence spike within necessary compute time threshold crossed. calculation explained appendix made interpolation current state time state time tmax membrane potential would reach maximum allowed increase threshold. calculated spike emitted communicated postsynaptic neurons membrane potential reset vreset refractory period. refractory period procedure starts again. evolution loop described membrane potential reset value threshold soon crosses latter. thus initial state means first inequality system always satisfied dropped. inequalities assessed leading reduced system geometric meaning inequalities illustrated figure figure shows four regions no-spike region union spike region union figure separated thick line partly curved black partly straight blue. subregion particularly important region missed spikes discussed section corresponding self-intersection region figure lower panel. contains states lead spikes missed schemes rely standard test region separated dashed blue line continuous blue line continuation dashed one. partly dashed partly continuous blue line corresponds equation fhie. hence inequality fhie satisfied initial state region blue boundary spike. inequality satisfied state could spike spike; undetermined case. inequality requires modest computational costs linear involves exponentials regions separated black curve hence inequality satisfied initial state boundary spike. inequality satisfied initial state either spike occur. figure state-space subregions formed intersections reduced inequalities fhie auxiliary inequality ghie spike region no-spike region subregion contains states emit spikes undetected standard test detected lossless method. computationally expensive inequality involves irrational powers advisable avoid direct computation often possible pre-testing linear inequality. section discussed pre-test indeed possible thanks convexity no-spike region. there argued curved envelope approximated triangular hypersurfaces simply reduce straight segment present two-dimensional case dot-dashed line figure separating line equation ghie auxiliary inequality ghie satisfied initial state also satisfied. therefore convenient test auxiliary inequality computationally costly discarded test positive. figure suggests test might positive system translated computational algorithm several different ways depending order evaluation inequalities auxiliary inequality simplified terms algorithm consists sequence tests variously implemented constructs finding initial state space-time regions order tests important. pici frequency states found region call occupation frequency cumulative time cost test region time cost cumulative sense tests must performed false outcomes arrive test efficiency algorithm therefore depends mathematical form inequalities defining region occupation frequencies regions determined dynamics. factors extrapolated theoretical analysis practically measured running long test simulations typical network setups corresponding cases interested determine efficient algorithm present case. region least costly bounded line therefore involving inequality linear region bounded lines involving linear inequalities; finally regions bounded curve involves rational exponentiation. example model tried different orderings show possible extreme cases illustrate significant difference computational cost. algorithm based assumption occupation frequency subregion proportional subregion’s relative size. check largest first order therefore likely exit test first branches. value ghie used branches computed saved sequence order save computations. algorithm uses composite or-and condition rather several ifs. assuming left-to-right evaluation algorithm corresponds testing first either case leading spike. neither true tests necessary state must necessarily no-spike region. test made less costly average using auxiliary inequality algorithm uses test less overall previous require test average region highest occupation frequency. left-to-right evaluation assumption always hold modern processors build statistics optimize test order logical constructs. figure schematic simulation setup used calculate occupation frequencies compare hybrid scheme lossless method algorithm lossless method standard test. neuron model implementing three schemes receives input external current excitatory inhibitory poisson generator. total input mean variance sample membrane-potential dynamics analysis assumed θc/τ. reduced system algorithm however also valid case corresponding lower panel figure case subregions exist threshold inequalities ghie always satisfied always evaluate true algorithms. algorithms therefore correctly distinguish spiking non-spiking states case although become inefficient owing additional superfluous evaluations ghie spiking states. decide modify present work case unusual real applications. efficient algorithms case designed interested readers following guidelines given section. want measure occupation frequencies typical case neuron embedded recurrent network receiving fluctuating synaptic input. setup simulation illustrated figure formulae explained appendix neuron coupled strengths excitatory inhibitory poisson generator also receives constant external current. poisson generators mimic excitatory inhibitory population. neuron thus receives fluctuating input current average variance instance code simulation includes subroutine informs current state every time lossless method test called without altering test dynamics. figure gives visual idea occupation frequencies correspond case values correspond composite average input spikes/s total average input current presynaptic input makes neuron fire average rate spikes/s. sample membrane dynamics shown figure subregion overwhelmingly largest occupation frequency. three subregions actually small figure frequency density states state space call threshold-crossing test network parameters colourbar units dotted purple line threshold visible region plot horizontal blue line boundary no-spike spike regions. spike region subregion visible scale exceedingly small average timestep discern need zoom done upper panel curved envelope straight lines separate extend horizontally vertically lower panel. contrast much larger timestep three boundaries would larger extension discernible plot precise comparison occupation frequencies four regions shown figure several combinations three network parameters producing different dynamic regimes. parameters average variance input current presynaptic coupling strength values parameters include typical realistic cases well extreme cases like unusually high coupling strengths. panel figure shows occupation frequencies dynamical regimes constant several panels last correspond case µc/τ θc/τ subregions exist threshold. important remember boundary size regions figure vary timestep parameter simulation scheme dynamics event-driven hybrid scheme step varies inversely event input rate poisson input generators proportional consequence frequencies displayed figure determined liouville distribution dynamics alone also details numerical-implementation scheme. dependence boundaries illustrated figure decreases line fhie auxiliary line ghie gets closer threshold subregions disappear. plausible since limit evolving initial state all. increases point tangency envelope line fhie moves increasingly lower voltages higher currents; subregion takes subregion becomes wider. typical timestep values several milliseconds though subregions still small. rough estimate dependence areas bounded regions parameters obtained looking figure considering areas together form triangle vertices fhie triangle base height bie]|. expressing terms using inversely proportional input rate find approximate formula shows subregions grow square input mean third fourth power ratio recall regions exist occupation frequencies depend areas alone however also dynamics explained previous section. identify several dynamical mechanisms dependence parameters increase mean input leads frequent threshold crossings thus frequently bringing voltage reset value underneath subregions occupation frequencies subregions therefore decrease even though areas grow occupation frequency subregion dominates others varying depending network parameters. subregion follows order frequency frequently visited spike subregions. subregions scarcely visited lower synaptic amplitudes frequencies slightly often higher synaptic amplitudes time performance accuracy hybrid scheme based lossless method average time costs algorithm algorithm within hybrid scheme assessed real-time simulation measurements. average time cost hybrid scheme based standard test also assessed comparison. therefore compare algorithms lossless method sufficiency test section. figure occupation frequencies four subregions figure various sets input-current mean variance synaptic strength. panel shows frequencies current variance fixed current mean synaptic strength. columns ranging rows ranging frequencies measured samples depending dotted lines plot show inverse number samples network regime. thickness segments connecting data points equals standard deviation. shaded regions show limiting frequencies expected probability using johnson-dirichlet model parameter determined posterior maximization frequencies region particularly important frequencies spike-misses standard test basic setup frequency analysis explained appendix network parameters difference present case code include subroutine informs frequencies would otherwise increase bias real-time durations simulations. three instances basic setup prepared first neuron modelled hybrid scheme lossless method algorithm second neuron modelled hybrid scheme lossless method algorithm third neuron modelled hybrid scheme standard threshold-crossing test various random-number-generator seeds three instances exactly same three neurons receive exactly input spike-for-spike; essential fair comparison three schemes. three instances long time repeated several times enough collect reliable statistics. statistics collected sets values frequency analysis. total real-time length simulation depends three schemes often checkpoints threshold-crossing tests occurs turn depends presynaptic input frequency already discussed. rather showing results sets parameters case informative show figure values yield slowest fastest performances. average computation costs algorithm algorithm embody lossless method turn similar within other’s standard deviations basically identical comparison cost scheme based standard test slower hybrid scheme standard test around slower case high-activity regime frequent incoming spikes around slower case activity regime infrequent incoming spikes extremes shown figure sets network parameters hybrid scheme lossless method around slower standard hybrid scheme threshold-crossing test mentioned subregion contains states standard threshold-crossing test misses spike. occupation frequencies subregion therefore direct measure number spike missed neuron standard hybrid scheme. shown stars figure various sets network parameters frequency missed spikes simple monotonic dependence three parameters owing interaction several mechanisms discussed section increase synaptic coupling input current generally leads frequently missed spikes neuron spikes often overall. high suprathreshold input currents however frequency decreases spikes missed anymore; change trend happens checkpoints become frequent. regimes diffusion-like processes frequent arrival synaptic events lead missed spikes. regimes high shot-noise processes sudden infrequent arrival synaptic events leads suprathreshold excursions missed spikes. separate simulations show hybrid scheme based lossless method either algorithm reproduce analytic solution neuron model within floating point precision. biologically realistic synaptic couplings standard hybrid scheme faster scheme lossless method misses less spike every test calls neuron; couplings figure even becomes less spike every test calls. synaptic couplings standard hybrid scheme starts miss spikes reaching even missed spike every test calls subthreshold average input currents; faster hybrid scheme lossless method. figures user decide hybrid scheme standard lossless test depending desired balance accuracy speed. figure computational costs hybrid scheme lossless method algorithm lossless method algorithm standard threshold-crossing test describes regimes lossless method highest increase computational cost around regimes high activity frequently incoming spikes. describe regimes lossless method lowest increase computational cost around regimes activity infrequently incoming spikes. data come simulations simulation-time each. present general method solve threshold-crossing detection problem integrable affine linear neuronal dynamics. method based geometric idea propagating threshold plane backwards time determine whether swept volume contains initial state rather propagating initial state forward time check whether crosses threshold. procedures obviously mathematically equivalent distribute computational load different ways. forward-propagation state looks value crossing time; value exists means threshold crossing. backward-propagation threshold first tests whether crossing time exists without yielding value; latter calculated afterwards. different distribution computational load procedures explained geometrically algebraically. first procedure geometrically checks intersection curve hypersurface algebraically corresponds finding roots system equations often transcendental. second procedure geometrically checks intersection point hypervolume i.e. inclusion former latter. algebraically corresponds testing inequalities. latter procedure efficient numerical computations relies inequality tests presence transcendental functions much less costly equation needs solved particular variable. determination exact crossing-time involves bisection algorithms costlier part done existence value certain. root search unnecessarily performed. calculated system inequalities expressing threshold-crossing condition generic affine linear neuronal dynamics dimension. result conjunction inequalities consists affine linear inequalities state-space variables voltage currents nonlinear one. numerical implementation system inequalities optimized case-by-case basis. order give concrete implementation example generic inequalities show geometrical meaning give example optimizationin present work apply procedure step-by-step -dimensional case leaky integrate-and-fire neuron exponentially decaying post-synaptic currents generic inequalities take case concrete form quantitative data present work obtained integrating inequalities combined event-and-time-driven simulation framework large-scale spiking neuronal network models released implementation comparison earlier work show that system inequalities non-linear particular expressed analytically terms state-space variables even original threshold-crossing condition involves transcendental equation would therefore require bisection algorithms. compare computationally expensive non-linear function system conveniently triangularized speeding algorithm even testing linear inequality first ruling majority initial states; method reproduces analytic solution neuron model within floating point precision. detects threshold crossings particular approximate test hanuschkin misses ranges mean activity fluctuations synaptic-coupling strength default spike accuracy reference simulator method slower fastest available solver spike loss therefore comparable speed embedded event driven methods inset). practice method hanuschkin rarely misses spikes biologically realistic synaptic amplitudes. frequencies afferent synaptic events however missed threshold-crossings happen. scheme therefore offers alternative users need guaranteed spike detection willing price terms slightly longer computation time. state-spaces higher dimensions difficult derive non-linear inequality system implicit form approximating flat surfaces still easily calculated. worst-case scenario inequality expressible analytically still possible construct nested sequence approximating flat surfaces tested hierarchically. construction needs done given model detects spikes desired precision. linear nested inequalities likely computationally less expensive bisection algorithm. problem detecting sort threshold crossing system coupled first-order linear differential equations appears many applications phenomena like switching friction saturation example air-conditioning unit thermostat controls on-off state based certain threshold value room temperature dynamics system similar described sections .–.. another example problem ejecting pilot collision aircraft stabilizer avoided. present work concepts differential geometry particular extrusions critical points maps manifolds shows concepts readily understandable geometrical visual meaning. notion extrusion recently found applications numerical discretization techniques partial integral differential equations notion critical points manifold mapping ubiquitous science caustics propagating seismic fronts seismic wave changes phase singularities coordinate charts general relativity affect accuracy global navigation satellite systems indeed neuron model analysed section exhibits similarity dynamics point mass near black hole. simulation timestep large curved surface separating states lead spike acts like event horizon general relativity state evolved spike region enter no-spike region cannot escape always remain no-spike state. true dynamics though constant affine term resets threshold. inputs neurons lead discontinuous changes affine term dynamics causing transport initial states event horizon no-spike spike region. nevertheless maybe similarities mere coincidences. example trajectory threshold surface leaky integrate-and-fire model α-shaped post-synaptic currents implicitly expressed terms lambert-w function analysis along lines section shows. function also appears implicit expression point-mass trajectories -dimensional general relativity surely worthwhile bring nascent field neuronal dynamics closer ideas techniques differential geometry general relativity. know neuron voltage threshold times threshold somewhere interval continuity must reach maximum threshold time tmax time obtained solving equation given solution zero-mean gaussian process. parameters characterize stochastic input mean variance total incoming synaptic current. related synaptic couplings excitatory inhibitory population input neurons mimicked poisson generators rates coupled neuron strengths input current pglpm thanks forschungszentrum librarians always prompt kind help mari miri continuous encouragement affection buster keaton filling life inspiration developers maintainers latex emacs auctex miktex arxiv biorxiv philsci python inkscape sci-hub making free unfiltered scientific exchange possible. references abramowitz stegun handbook mathematical functions formulas graphs mathematical tables vol. national bureau standards applied mathematics series tenth printing corrections edn. first publ. bernard stockley willis wheal synaptic integration nmda non-nmda receptors large neuronal network models solved means differential equations. biol. cybern. coxeter introduction geometry edn. first publ. rham differentiable manifolds forms currents harmonic forms vol. grundlehren mathematischen wissenschaften transl. smith. first publ. french d’haene schrauwen campenhout stroobandt accelerating event-driven simulation spiking neurons multiple synaptic time constants. neural comput. doi./neco..-- fourcaud brunel dynamics firing probability noisy integrate-and-fire neurons. neural comp. http//galton.uchicago.edu/~nbrunel/pdfs/ fourcaud.pdf fujimoto parallel distributed simulation systems gewaltig m.-o. diesmann nest scholarpedia good estimate probabilities. inst. maths. applics hansel mato meunier neltner numerical simulations integrate-and-fire hanuschkin kunkel helias morrison diesmann general efficient method incorporating precise spike times globally time-driven simulations. front. neuroinform. krishnan porta mana helias diesmann napoli perfect detection spikes time-reversal. proceedings bernstein conference. doihttp//dx.doi.org/./ nncn.bc. marsden ratiu manifolds tensor analysis applications vol. applied mathematical sciences edn. http//www.esm.vt.edu/~sdross/pub/ books/. written collaboration ralph abraham. first publ. morrison diesmann maintaining causality discrete time neuronal network simulations. lectures supercomputational neuroscience dynamics complex brain networks eds. beim graben zhou thiel kurths understanding complex systems. morrison straube plesser diesmann exact subthreshold integration rauch camera lüscher senn fusi neocortical pyramidal cells respond integrate-and-fire neurons vivo like input currents. journal neurophysiology rockafellar convex analysis vol. princeton mathematical series (princeton princeton", "year": "2017"}