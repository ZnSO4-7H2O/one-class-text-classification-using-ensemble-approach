{"title": "Multi-Objective De Novo Drug Design with Conditional Graph Generative  Model", "tag": "q-bio", "abstract": " Recently, deep generative models have revealed itself as a promising way of performing de novo molecule design. However, previous research has focused mainly on generating SMILES strings instead of molecular graphs. Although current graph generative models are available, they are often too general and computationally expensive, which restricts their application to molecules with small sizes. In this work, a new de novo molecular design framework is proposed based on a type sequential graph generators that do not use atom level recurrent units. Compared with previous graph generative models, the proposed method is much more tuned for molecule generation and have been scaled up to cover significantly larger molecules in the ChEMBL database. It is shown that the graph-based model outperforms SMILES based models in a variety of metrics, especially in the rate of valid outputs. For the application of drug design tasks, conditional graph generative model is employed. This method offers higher flexibility compared to previous fine-tuning based approach and is suitable for generation based on multiple objectives. This approach is applied to solve several drug design problems, including the generation of compounds containing a given scaffold, generation of compounds with specific drug-likeness and synthetic accessibility requirements, as well as generating dual inhibitors against JNK3 and GSK3$\\beta$. Results show high enrichment rates for outputs satisfying the given requirements. ", "text": "yibo liangren zhang* zhenming liu* *correspondence liangrenbjmu.edu.cn; zmliubjmu.edu.cn state laboratory natural biomimetic drugs school pharmaceutical sciences peking university xueyuan road haidian district beijing china recently deep generative models revealed promising performing novo molecule design. however previous research focused mainly generating smiles strings instead molecular graphs. although current graph generative models available often general computationally expensive restricts application molecules small sizes. work novo molecular design framework proposed based type sequential graph generators atom level recurrent units. compared previous graph generative models proposed method much tuned molecule generation scaled cover signiﬁcantly larger molecules chembl database. shown graph-based model outperforms smiles based models variety metrics especially rate valid outputs. application drug design tasks conditional graph generative model employed. method oﬀers higher ﬂexibility compared previous ﬁne-tuning based approach suitable generation based multiple objectives. approach applied solve several drug design problems including generation compounds containing given scaﬀold generation compounds speciﬁc drug-likeness synthetic accessibility requirements well generating dual inhibitors gskβ. results show high enrichment rates outputs satisfying given requirements. introduction ultimate goal drug design discovery chemical entities desirable pharmacological properties. achieving goal requires medicinal chemists perform searching optimization inside space molecules. task proved extremely diﬃcult mainly size complexity search space. estimated novo molecular design aims assisting processes computer-based methods. early works developed various algorithms produce molecular structures atom based elongation fragment based combination. algorithms often coupled global optimization techniques colony optimization genetic algorithms particle swam optimization generation molecules desired properties. recent developments deep learning shed light area novo molecule generation. works shown deep generative models eﬀective modeling smiles representation molecules using recurrent neural networks architecture extensively applied tasks related sequential data. segler applied smiles language model task generating focused molecule libraries ﬁne-tuning trained network smaller molecules desirable properties. olivecrona used based trained chembl dataset generate smiles string. mode ﬁne-tuned using reinforcement learning generation molecules speciﬁc requirements. popova propose integrate generative predictive network together generation phase. segler applied smiles task generating focused molecule libraries ﬁne-tuning trained network smaller molecules desirable properties. beside language model g´omez-bombarelli used variational autoencoder generate drug-like compounds zinc database. work aims obtaining bi-directional mapping molecule space continuous latent space operations molecules achieved manipulating latent representation. blaschke compared diﬀerent architectures applied task designing active compounds drd. works described demonstrated eﬀectiveness smiles based model regarding molecule generation. however producing valid smiles strings requires model learn rules irrelevant molecular structures smiles grammar atom ordering adds unnecessary burden training process making smiles string less preferable representation compared molecular graphs. research deep learning recently enabled direct generation molecular graphs. johnson proposed sequential generation approach graphs. though implementation mainly reasoning tasks framework provided potentially applicable molecule generation. compared approach recent method proposed generating entire graph once. model successfully applied generation small molecular graphs. implementation similar recent work using sequential decoding scheme similar johnson decoding invariance introduced sampling diﬀerent atom ordering predeﬁned distribution. method applied generation molecules less heavy atoms chembl dataset. though inspiring methods discussed common problems. first generators proposed relatively general. design allows techniques applied various scenarios requires optimization application molecule generation. secondly many models suﬀer scalability issue restricts application molecules small sizes. work propose graph-based generator suited molecules. model scaled cover compounds containing heavy atoms chembl dataset. results show graph-based model proposed able outperform smiles based methods variety metrics including rate valid outputs divergence molecular properties well loss. conditional version model employed solve various drug design related tasks multiple objectives promising performance demonstrated according results. figure cimetidine graph based representation graph based generative models molecules represented graphs atoms bonds viewed nodes edges respectively atom types speciﬁed three parameters atomic symbol number explicit hydrogens attached number formal charges bond types single double triple aromatic bonds considered work labeled corresponding atom type. work atom type speciﬁed using three variables atomic symbol number explicit hydrogens attached number formal charges. example nitrogen atom pyrrole represented triple similarly edges labeled bond types. four types bonds considered work single double triple aromatic. figure schematic representation molecule generation process starting empty graph initialization performed ﬁrst atom. step graph transition sampled performed intermediate molecule structure. probability sampling transition given parametrized using deep neural atom types bond types denoted respectively. extracted molecules chembl dataset contains elements total. visualized demonstration molecular graph given figure graph generative model consider deep generative models directly output molecular graphs. work mainly focus sequential graph generators builds graph iteratively reﬁning intermediate structure. process starts empty graph previous graph generative models usually general less optimized generation molecular graphs. oﬀer following optimizations much simpler decoding scheme used decrease number steps required generation. atom level recurrent unit used decoding policy. instead explored options parametrizing decoding policy markov process using molecule level recurrent unit. modiﬁcations helps increase scalability model. figure type graph generative architectures explored work molmp architecture models graph generation markov process transition depends current state graph history. molrnn architecture adds single molecule level recurrent unit molmp. entire process shown figure detailed illustration provided figure theory contain actions violate validity constraints molecules. however order test ability model learn constraints explicity exclude actions training. note compared implementation action adding atom action connecting molecule merged single append step. helps reduce number steps generation. easy show number steps required generating graph decoding policy generation decoding policy need specify probability value graph transition speciﬁcally need output following probability values vector size whose element represents probability connecting latest added atom using bond type scalar value indicating probability terminating generation. visualized depiction figure decoding policy parameterized using neural network. step network accepts decoding history input calculates probability values architectures involve atom level recurrency helps increase scalability model. type architecture include recurrent units less expensive compared based models. moreover computation diﬀerent steps easily parallelized training. detailed architecture molmp given follows initial atom embedding except ﬁrst layer convolutional layer graphconvl adopts bn-relu-conv structure suggested detailed architecture graph convolution described graph convolution. convolution layers work output units. figure network architecture molmp ﬁgure shows detailed model architecture molmp. molrnn adopts structure highly similar molmp except inclusion molecule level recurrent unit. atom matrix size subsequently split size |a|×|b| |b|respectively. scalar containing activation value termination action mlpθis layer fully connected network hidden size mlp∗ layer fully connected network. mlpθ mlp∗ uses exponential activiaton outfigure architecture graph convolutional layer layer output representation atom given input representation previous layers information local neighbors information distant neighbors. molrnn second architecture adds single molecule level recurrent unit molmp shown figure refer method molrnn. model architecture speciﬁed follows first model generates atom level overall architecture molrnn highly similar molmp. however found molecule level recurrent unit molrnn provides signiﬁcant improvements model performance inducing little extra computational cost compared molmp. graph convolution work rely graph convolutional network extract information graph states graph convolutional layer adopts bnrelu-conv structure described before. terms possible decoding route marginal likelihood function intractable molecules encountered drug design. resolve problem importance sampling proposed conditional generative model molecule design tasks require produce compounds satisfying certain criteria synthetically available high aﬃnity certain target. currently popular solution ﬁne-tune existing model suited speciﬁc task. however modeling multiple objectives challenging type models. herein conditional generative model propose generation tasks speciﬁc requirements. ﬁrst convert given requirement numerial representation called conditional code generative model modiﬁed conditioned graph generative model means output representation atom layer atoms directly connected atom bond type path atoms whose distance atom equals represents receptive ﬁeld size work. architecture illustrated figure implementation graph convolution similar edge conditioned convolution simonovsky except also include information remote neighbors order reach larger receptive ﬁeld fewer layers. likelihood function train generative model need maximize log-likelihood training samples. however step-wise generative models discussed above likelihood tractable given decoding route simply state included graph convoludion architecture adding additional term unconditional implementation smilels based model conditional code included concatenating input step concat. one-hot representation smiles charactor input step conditional models already used previous work molecule generation restricted small molecules used simple properties number heavy atoms conditional codes. here model applied tasks much related drug design including scaﬀold-based generation property-based generation design dual inhibitor gskβ scaﬀold-based generation concept molecular scaﬀold long signiﬁcant importance medicinal chemistry. though various deﬁnitions available widely accepted deﬁnition given bemis murcko proposed derive scaﬀold given molecule removing side chain atoms. studies found various scaﬀolds privileged characteristics terms activity certain target. privileged structure found related task produce compound libraries containing scaﬀolds subsequent screening. here conditional graph generative model applied generate compounds containing scaﬀold drawnfrom pre-deﬁned scaﬀold {si}ns extracted list approved drugs drugbank. types structures extracted molecules construct bemis-murcko scaﬀolds ring assemblies. ring assemblies included since found including extra structural information beside bemismurcko scaﬀolds helps improve conditional figure conditonal generative models generation molecules based requriements requriement ﬁrst converted numerical representation called conditoinal code generative model modiﬁed conditioned scaﬀold based molecule generation. generation based drug-likeness synthetic accessibility. designing dual inhibitors gsk-β generation performance. detailed scaﬀold extraction workﬂow shown supplementary text molecule conditional code binary vector contains substructure otherwise. refer scaﬀold ﬁngerprint since fact viewed substructure ﬁngerprint based scaﬀold generate molecule figure workﬂow scaﬀold based molecule generation. scaﬀold ﬁrst extracted compounds drugbank. conditional code substructure ﬁngerprint based training performed training samples labeled generation based synthetic accessibility drug-likeness drug-likeness synthetic accessibility properties signiﬁcant importance development novo drug candidate. drug-likeness measures consistency given compound currently known drugs terms structural physical properties frequently used ﬁlter obvious non-drug like compounds early phase screening. synthetic accessibility also important property novo drug design since subsequent experimental validation requires synthesis given compound. task model required generate molecules according given level drug-likeness synthetic accessibility. druglikeness measured using quantitative estimate drug-likeness synthetic accessibility evaluated using score. conditional code deﬁned score calculated using rdkit. practice instead specifying single value score often intervals express requirements desired output molecules. means required sample molecules designing dual inhibitor gsk-β ability model multiple requirements once conditional generative models used design compounds speciﬁc activity proﬁles multiple targets. here consider task designing dual inhibitors c-jun n-terminal kinase glycogen synthase kinase- beta targets serine/threonine kinases shown related pathogenesis various types diseases. notably gsk-β shown potential target treatment alzheimer’s disease jointly inhibiting gsk-β provide potential beneﬁt treatment cgsk−β binary values indicating whether compound active gsk-β. compounds chembl dataset cgsk−β labeled using separately trained predictor. random forest classiﬁer demonstrated provide good performance kinase activity prediction used predictor gsk-β activity ecfp diameter descriptor. predictive model trained using activity data excape-db integrated database activity values chembl pubchem. workﬂow data extraction predictor training provided supplementary text found molecules chembl predicted active gsk-β. imbalance results enrichment rate conditioned generation. better result model ﬁrst trained unconditioned setting ﬁne-tuned based molecules mentioned above. training details graph generative models trained using chembl dataset. data processing workﬂow largely follows olivecrona described supplementary text mxnet used implement networks adam optimizer used network training. initial learning rate used together decay rate every iterations. parameters optimizer default values suggested model architectures well optimized achieve best performance. however computational cost molmp molrnn unable systematically optimize hyperparameters. througout discussion given smiles based methods proposed graph-based model compared several smiles based models model performance sample quality. type methods variational autoencoder language model considered comparison. implementation smiles follows g´omez-bombarelli encoder contains three convolutional layers ﬁlters kernels each fully connected layer hidden units. model uses latent variables decoder three layers hidden units. sequential data faces issue optimization challenge. original implementation uses kl-annealing tackle problem follow method provided kingma controlling level free bits. oﬀers higher ﬂexibility stability compared kl-annealing. restrict minimal level free bits latent variable. types recurrent units adopted. ﬁrst type uses includes architectures ﬁrst architecture consists three layers hidden units each second uses wider architecture units following implementation olivecrona beside also included lstm based smiles language model following segler architecture uses three lstm layers units. sample validity test whether generative models capable producing chemically correct outputs structures generated model subsequently evalulated rdkit rate valid outputs. also evaluate ability model produce novel structures. done accessing rate generated compounds occure inside training set. molecular properties good molecule generator correctly model distribution important molecular properties. therefore distribution molecular weight logpartition coeﬃcient generated dataset test compared matrix used evaluate ability model control output based conditional code value gives rate correctly generated outputs denoted high quality conditional models high value values paractice value scaﬀold property based generation signiﬁcantly samller relatively inﬂuence model’s performance. therefore result omitted scaﬀold property based task reported task kinase inhibitor design. deﬁnition similar used previous work except implementation calculated using generated samples unconditioned model continuous codes subset conditional code space used describe generation requirements. sampled target based generation task rate reproduced molecules also reported following previous works. take example. during evaluation sets outputs generated using conditions gsk-β gsk-β. outputs dedkl widely used deep generated models training evaluation here values determined using kernel density method implemented scipy used gaussian kernel bandwidth selected based scott’s rule. negative log-likelihood model performance also evaluated using oﬀer comparison graph smiles based generative model evaluated using canonical ordering follows note graph based models reported models trained models using value caluclated directly compared diﬀerent models. therefore rely metrics djs. also smiles importance sampling performed obtain tighter bound. number samples several randomly generated samples molrnn grouped molecular weight shown figure comparison smiles based graph based models performed results summarized table table ﬁrst analysed model performance terms nll. according result molrnn able achieve best performance molmp although unable outperform smiles smiles lstm achieves better performance compared smiles smiles vae. noted smiles noted values used comparison relatively loose bonds evaluated using deterministic decoding route. therefore focuces evaluation metrics discussed below. terms rate valid outputs rate valid novel outputs molrnn molmp outperform smiles based methods. also noted changing signiﬁcantly increase rate valid outputs molmp molrnn. decreasing produce margincal eﬀect. high validity output structures graph-based model surprising generation smiles poses much stricter rules output compared generation molecular graphs. figure figure summarize respectively common mistakes made smiles-based graphbased model generation. results figure show common cause invalid output smiles based models grammar mistakes unclosed parentheses unpaired ring numberings. graph-based model majority invalid output caused broken aromaticity demonstrated figure likely result stepwise decoding pattern graph-based models decoder part aromatic structure during generation determination aromaticity requires information entire ring. also observed mistakes related atom valance relatively minor meaning rules easy learning using graph convolution. graph-based methods also advantage giving highly interpretable outputs compared smiles. means large portion invalid outputs easily corrected necessary. example broken aromaticity restored literately reﬁning number explicit hydrogens aromatic atoms unclosed aromatic rings corrected simply connecting ends using aromatic bond. though possible corrections introduce additional bias output samples depending implementation thus adopted subsequent evaluations. next investigate ability generators learn distribution molecular properties demonstrated table results shown molrnn gives best performance molecular weight smiles gives best performance logp. molmp although able outperform smiles fails give better performance djs. observation suggest comes inﬂuence found changing signiﬁcantly improve perforamnce molmp molrnn molecular properties. decreasing diﬀerent eﬀect molmp molrnn. molmp hurt overall performance molrnn inprove performance molecular weight signiﬁcantly decrease performance logp. overall better choise molmp suited molrnn. generally molrnn showed signiﬁcant advantages among generative mdoels considered. subsequent evaluation conditonal generative models best performing graph based model best performing smiles based model implemented conditonal models compared among tasks. scaﬀold-based generation ﬁrst task conditional generative models trained produce molecules based given scaffold. illustrate result scaﬀold extracted antihypertensive drug candesartan used example along several related scaﬀolds derived scaﬀold conditional codes constructed type scaﬀold output structures produced according corresponding code. results smiles based graph based conditional generator given table terms output validity graph based model able produce higher fraction valid outputs scaﬀolds compared smiles based methods. similar results unconditional models terms rate correctly generated outputs although models unable achieve correctness results signiﬁcantly higher oﬀering high enrichment rate random. graph based smiles based model able achieve eorc scaﬀold well eorc scaﬀold showing promising ability model produce enriched output according given scaﬀold query. comparing result type architectures found graph based model higher performance scaﬀold smiles based method higher structural diversity output samples also evaluated model. found smiles based model tends produce outputs diverse compared graph based model except scaﬀold indicate graph based model tends slightly overtrained compared smiles based model. however diﬀerences relatively minor compared standard deviation value. several generated samples graph based model given scaﬀold figure recall outputs given scaﬀold contain type molecules molecules bemis-murcko scaﬀold molecule whose bemis-murcko scaffold contains reside inside types observed scaﬀold shown figure investigating generated samples observed model seems learnt side chains characteristics scaﬀold. example samples generated scaﬀold usually substitutions occur restricted positions frequently contains long aliphatic side chain. interestingly actually reﬂects structural activity relationship angiotensin receptor antagonists. fact scaﬀold long treated privileged structure receptors result molecules scaﬀold largely biased matches rules target. trained biased dataset model memorize underlying structural activity relationship byproduct scaﬀold based learning. characteristic beneﬁcial generation libraries containing speciﬁed privileged structures. generation based drug-likeness synthetic accessibility task generative model used produce molecules according requirement druglikeness synthetic accessibility. conditional code speciﬁed ﬁrst experiments models required generate molecules based following requirements expressed subvalues determined distribution chembl dataset using quantile. conditions illustrated figure four sets represent four classes molecules respectively ﬁrst class conditions respectively. conditions shown intervals represented error bar. distribution sascore molecules generated using single point conditions respectively. conditions represented dots plot. icant conditions requiring high sascore observation suggests smiles based model diﬃculty generating complexed structures maintaining structural validity. corresponds molecules high druglikeness synthetic accessibility. however result easy understand. since deﬁnition drug-likeness contains requriement high synthetic accessibility ﬁnding molecules high score high sascore diﬃcult task. conditions results models varies values lower compared scaﬀold based task nonetheless showing enrichments conditions distribution chembl. diversity generated samples also reported. similar observation scaﬀold-based generation smiles based method able produce outputs slighly higher diversity compared graph based method. based generator shown figure a-d. random samples also chosen class visualization figure structural features output samples mostly consistent predeﬁned conditions small simple molecules highly complexed molecules note conditional model also supports generation based given point sascore. possibility demonstrated visualization using graph based conditional model. molecule generation conditioned single points conditional code here four diﬀerent conditions speciﬁed follows figure visualizing distribution generated samples target. ﬁgure shows t-sne visualization molecules form test gsk-β samples conditioned gsk-β molecules test gsk-β samples conditioned gsk-β. molecules test samples conditioned gsk-β molecules test samples conditioned gsk-β speciﬁed using single value score distribution properties output samples relatively dispersed. result surprising since score relatively abstract descriptions structural features molecules small modiﬁcation molecule structure lead signiﬁcant changes scores. nonetheless found generated samples enriched around corresponding code also observed distribution concentrated qed. probably direct measurement molecular graph complexity easier model graph based generator. contrast abstract descriptor related various molecular properties. generating dual inhibitors gsk-β task model used generate dual inhibitor gsk-β. predictive model ﬁrst used label conditional code chembl dataset conditional graph generator trained labeled training set. predictors yield good results general auc=. auc=. gsk-β. curves models show figure results smiles based graph based conditional generator given table terms output validity graph based model outperforms smiles based model generating gsk-β selective selective compounds generation dual inhibitors smiles based model outperforms graph based model. terms eorc smiles based model achieves better performance table matrix kinase inhibitor generation task diagnal elements omitted since reported table results reported stddev. model giving best performance metric highlighted boldface task generating dual inhibitors task generating selective inhibitors gsk-β graph based model achieves better performance task generating selective inhibitors.the matrices graph based smiles based model shown table graph based smiles based model noted generating compounds active gsk-β signiﬁcant amount outputs falling category gsk-β positive negative. nonetheless terms enrichment random eorc models able achieve high performance selectivity combinations. note selective inhibitors gsk-β relatively enriched chembl database according result predictor. comparison selective inhibitors dual inhibitor gskβ much rarer. however model still able achieve signiﬁcant enrichment types selectivity. result shows potential application target combinations data enrichment rate. better demonstrate structural distribution generated samples visualization based tsneis performed using ecfp ﬁngerprint. generated samples diﬀerent selectivity speciﬁcations molecules test target projected two-dimensional embeddings shown figure a-d. result illustrates structural distribution well-matched generated molecules test set. also shown conditional generator tends produce molecules near test samples consistent obselectivity condition several molecules sampled using model demonstrated figure a-c. investigating generated structures detail observed model tends generate samples containing well-established scaffold corresponding target. structures diaminopurines triazolones frequently used design inhibitors show high occurrence generated samples. observation gsk-β example like -bis-arylmaleimides class widely studied inhibitor gsk-. hand aminopyrimidines frequently shown outputs selectivity conditions enriched generated dual inhibitors. observations show good interpretability outputs indicate structural features generated samples line existing knowledge targets. finally report percentage reproduced samples test target. result molecules reproduced molecules reproduced gsk-β. note molecules test sets targets excluded chembl training task means method capable generating molecules conﬁrmed positive without seeing training predictive model conditional generative model. figure samples conditioned diﬀerent selectivity conditions. a-c. generated samples diﬀerent condition selectivity dual inhibitors gsk-β selective inhibitors selective inhibitors. d-e. several recovered actives gsk-β conclusion work framework novo molecular design proposed based graph generative model applied solve diﬀerent drug design problems. graph generator designed ﬁtted tasks molecule generation using simple decoding scheme graph convolutional architecture less computationally expensive. furthermore ﬂexible introducing decoding invariance also suggested. method trained using molecules chembl dataset demonstrated better performance compared smiles based methods especially terms rate valid outputs. generate molecules speciﬁc requirements propose conditional generative model provides higher ﬂexibility much easier train compared previous ﬁne-tuning based methods. model applied solve problems highly related drug design generating molecules based given scaﬀold generating molecules good drug-likeness synthetic accessibility generation molecules speciﬁc proﬁle multiple targets. high enrichment rates presented results show conditional generative model provides promising solution many real-life drug design tasks. work extended various aspects. first models used work completely ignores stereochemistry information molecules. fact stereochemistry extremely important process drug development introducing information helps improve applicability existing models. secondly target based generation much helpful jointly train generator decoder utilizing strategies semi-supervised learning. finally besides three tasks experimented work conditional graph generator used many scenarios. summarize graph generative architecture proposed work gives promising result various drug design tasks worthwhile explore potential applications using method. smiles simpliﬁed molecular-input line-entry system recurrent neural network language model random forest reinforcement learning variational autoencoder gated recurrent unit dopamine receptor c-jun n-terminal kinase gskβ glycogen synthase kinase- beta quantitative estimate drug-likeness synthetic accessibility ecfp extended connectivity ﬁngerprint t-sne t-distributed stochastic neighbor embedding yibo formulated concept contributed implementation. yibo wrote manuscript liangren zhang zhenming reviewed edited manuscript. authors read approved ﬁnal manuscript. research supported national natural science foundation china well national major scientiﬁc technological special project signiﬁcant drugs development", "year": "2018"}