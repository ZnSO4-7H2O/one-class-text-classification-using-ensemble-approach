{"title": "Exact and approximate limit behaviour of the Yule tree's cophenetic  index", "tag": "q-bio", "abstract": " In this work we study the limit distribution of an appropriately normalized cophenetic index of the pure-birth tree conditioned on $n$ contemporary tips. We show that this normalized phylogenetic balance index is a submartingale that converges almost surely and in L2. We link our work with studies on trees without branch lengths and show that in this case the limit distribution is a contraction-type distribution, similar to the Quicksort limit distribution. In the continuous branch case we suggest approximations to the limit distribution. We propose heuristic methods of simulating from these distributions and it may be observed that these algorithms result in reasonable tails. Therefore, we propose a way based on the quantiles of the derived distributions for hypothesis testing, whether an observed phylogenetic tree is consistent with the pure-birth process. Simulating a sample by the proposed heuristics is rapid, while exact simulation (simulating the tree and then calculating the index) is a time-consuming procedure. We conduct a power study to investigate how well the cophenetic indices detect deviations from the Yule tree and apply the methodology to empirical phylogenies. ", "text": "work study limit distribution appropriately normalized cophenetic index pure–birth tree conditioned contemporary tips. show normalized phylogenetic balance index submartingale converges almost surely link work studies trees without branch lengths show case limit distribution contraction–type distribution similar quicksort limit distribution. continuous branch case suggest approximations limit distribution. propose heuristic methods simulating distributions observed algorithms result reasonable tails. therefore propose based quantiles derived distributions hypothesis testing whether observed phylogenetic tree consistent pure–birth process. simulating sample proposed heuristics rapid exact simulation time–consuming procedure. conduct power study investigate well cophenetic indices detect deviations yule tree apply methodology empirical phylogenies. markov chain mutations individual positions genetic sequence given phylogenetic tree often interest quantify rate speciation extinction studied species. commonly assumes birth–death process constant rates. however development formal statistical tests whether given tree comes given branching process model open area research reason apparent lack widespread tests could lack commonly agreed test statistic. tree complex object multiple ways summarize single number. proposed summarizing tree indices quantify balanced i.e. close fully symmetric tree. indices many years sackin’s colless’ alternatively mckenzie steel proposed measure balance counting cherries tree showed appropriate centring scaling index converges standard normal distribution recently balance index proposed—the cophenetic index work inspired private communication evolutionary biologist gabriel yedid concerning usage cophenetic index signiﬁcance testing whether given tree consistent pure– birth process. noticed simulated distributions index much heavier tails normal distributions hence comparing centred scaled cophenetic indices usual gaussian quantiles appropriate signiﬁcance testing. would lead higher false positive rate—rejecting null hypothesis extinction tree generated pure–birth process. propose approach working analytically cophenetic index especially improve hypothesis tests phylogenetic trees i.e. recognize tree yule zone show relationship cophenetic index quicksort algorithm. suggests methods exploring limiting distribution quicksort algorithm inspiration studying analytical properties paper organized follows. section formally deﬁne cophenetic index present important results manuscript. deﬁne associated submartingale converges almost surely propose elegant representation promising approximation afterwards section show discrete setting limit normalized cophenetic index contraction–type distribution. based propose alternative approximations limit normalized cophenetic index. section describe heuristic algorithms simulate limit laws show simulated quantiles explore power cophenetic index recognize deviations yule tree apply indices example empirical data. section prove claims presented section alongside supporting results. then section study second order properties decomposition conjecture central limit theorem paper section describing alternative representations cophenetic index. show index better resolution traditional ones. particular cophenetic index range values order colless’ sackin’s ranges order furthermore unlike previously mentioned makes mathematical sense trees fully resolved remark original setting distance nodes measured counting branches consider edge leading root. work here prime concern trees random branch lengths include branch leading root. diﬀerence remember distance nodes exponential —parametrization rate) random variable results present manuscript built around scaled version cophenetic index almost surely convergent submartingale. ﬁrst introduce notation. σ–algebra containing remark despite apparent elegance straightforward derive central limit theorem limit statements concerning representation initially could hope could converge a.s. random variable limiting distribution similarly proof thm. section density function wn’s density density based simulated values simulated –tips yule trees obtain sample independent random variables drawn. simulated sample mean variance skewness excess kurtosis simulated sample mean variance skewness excess kurtosis applied reader interested results practically used. written already introduction balance indices often used provide single–number summary tree’s shape. statistics used e.g. test tree consistent null model naturally extensive work using diﬀerent balance indices signiﬁcance testing however previous works nearly always worked indices considered topology often obtained rejection regions direct simulations. unfortunately looking tree’s topology allow distinguishing models. particular diﬀerence yule tree constant rate birth–death tree coalescent tree. hence temporal index also takes account branch lengths used statistic based performs signiﬁcantly better however shows true usefulness employed distinguish biased speciation yule model. blum fran¸cois indicated regime topological indices fail completely. table shows setup temporal index superior recognizing deviation yule tree. directly simulating tree null model calculating index course give sample correct null distribution. however approach costly terms time memory. therefore theoretical results provide equivalent asymptotic approximate representations index’s available could speed study orders magnitude. fact clearly visible tab. calculating cophenetic index directly sample simulated pure–birth trees times slower considering even dramatically obtain sample approximation equivalent representation asymptotic distribution nearly times faster directly sampling discrete cophenetic index. alg. describe presented approach used signiﬁcance testing. then section discuss detail required computational procedures present simulation results concerning power tests apply tests empirical data. preceding computational section characterization limit distribution another proposal approximate limit section justiﬁes described simulation algorithms section having root edge included cophenetic distance them. case branch lengths expectation root edge distributed one. without root edge reason variance independent random variables distributed). branch lengths leading speciation point. rationale behind choice distribution randomly chosen internal branch conditioned yule tree rate distributed course approximation cannot expect laws branch lengths depth recursion become indistinguishable average branch. fact expect depend i.e. level recursion. larger branches distributions concentrated smaller values e.g. compare randomly sampled root adjacent branch length average branch length. however shall simulations indicate approximating average still could still yield acceptable heuristics good approximation notation diﬀerentiate root branch included i.e. processes look similar scaled recursive representation quicksort algorithm fact interest that present work martingale proof ﬁrst showed convergence quicksort recursive approach required identiτ uniformly distributed cally distributed random variables independent. following r¨osler approach turns limiting distributions satisfy equalities eqs. using lemmata arguing r¨osler section especially proof thm. obtain converge wasserstein d–metric whose laws ﬁxed points respectively. minor point made. here instead counterpart r¨osler prop nentially distributed. therefore also experimented drawing gamma distribution rate equalling shape equalling however signiﬁcantly increased duration density scaled cophenetic index known resort sort simulations obtain critical values. directly simulating large number pure–birth trees take overly long time measured minutes fortunately cophenetic index calculated time tree–traversing algorithm employed obtain hand suggestive approximations contraction limiting distributions eqs. signiﬁcantly faster simulate tab. ables satisfying eqs. involved possible develop exact rejection algorithm here choose simple approximate still eﬀective heuristics order demonstrate usefulness approach signiﬁcance testing. recursion alg. given realization random variables directly solved. however numerical experiments implementing alg. iteratively seemed computationally ineﬀective. times. compare quantiles diﬀerent distributions. approximation good used needs work distribution cophenetic index branch lengths. case discrete cophenetic index found exact limit distribution contraction–type distribution. therefore relatively quickly simulate sample without need lengthy simulations whole tree calculations cophenetic index. unfortunately contraction approach seem give good results yule tree branch lengths case. used approximation constructing contraction. instead taking length daughter branches took random internal branch. induces diﬀerence tails distributions clearly visible simulations. even second moment level approximation seems better already second moment level. generally cannot aﬀord time memory simulate large sample yule tree simulating values seems attractive option discrepancy distributions seems small. fig. compare density estimates continuous discrete branches cophenetic indices respective contraction–type limit distributions. density estimates generally agree know tab. approximation. simulated yule trees hence report quantiles quantiles tails seemed less accurate hence included table. similarly less correspondence diﬀerent estimates kurtosis. statistic relies fourth moments hence sensitive tails. hand much greater monte carlo error kurtosis simulations including setup values extracted directly yule trees. values seem similar values yule tree. expect shown exact limit distribution. mean–square–error. look error tails correct fraction distributions’ support consider. proxy true quantiles take pooled values yule columns. index runs repeats simulations. rmse using seems level rmse direct simulations. error twice size looking rmse exactly level yule column’s rmse. even though used recursion level exact match distributions take place limit however rapid exponential convergence contraction seems make diﬀerences invisible already recursion level. given test statistic useful also needs know power ability reject null hypothesis given alternative true. example balance indices based topology like sackin’s colless’ cannot expected diﬀerentiate trees generated diﬀerent constant rate birth–death processes coalescent. rationale behind topologies induced contemporary species stochastically indistinguishable matter death birth rate similarly regarding coalescent bottom steel mckenzie write coalescent model model starts intelrxeonrcpue–v.thecalculationofthermseisdescribedinthetextnexttoeq.. alsoy=foralg..thesimulationswereruninr..foropensuse.ona.ghz. generationsandrecursiondepthoftherespectivealgorithm.inalg.theinitialpopulationissetatand .othercentringsandscalingsaresummarizedintab..n=foralgs.andisthenumberof yuletreeφ˜φvaluesarecentredandscaledbyexpectationandstandarddeviationfromeqs.and )usedtoobtaintheyuletreeswithspeciationrateλ=n=tipsandarootedge.the rownamesareforaveragevarianceskewnessexcesskurtosisandroot– runningtimesareaveragesofindependentrepeatswithdrawseach.theabbreviationsinthe therepeatsontherightthemaximumandinthelinebelowfrompoolingallrepeatstogether.the centrings scalings required obtain mean zero variance versions random variables i.e. location scale z–transformed cophenetic index. case take asymptotic scaling comparable convenience reader also provide corresponding centrings scalings root–edge setup figure density estimates scaled centred cophenetic indices simulated yule trees simulation alg. also scaled centred mean variance left density estimates right curves calculate density function. probability distribution times coalescences yule model ignore element. diﬀerentiate trees needs take consideration branch lengths. compare power sackin’s colless’ indices signiﬁcance level. null hypothesis always tree generated pure–birth process rate alternative ones birth–death processes coalescent process function paradis biased speciation model ﬁxed entire tree. rates eﬀective daughter species speciate. values close yield imbalanced trees values around lead over–balanced phylogenies. simulated trees in–house code. model simulated trees conditioned contemporary tips. checked tree outside yule zone procedure described alg. calculated normalized sackin’s colless’ discrete continuous cophenetic indices functions sackin.phylo colless.phylo phylotop package used cophenetic indices calculated using linear time in–house implementation based traversing tree tests considered two–sided right–tailed one. discrete cophenetic index quantiles simulation alg. considered continuous power estimated fraction times null hypothesis rejected represented tab. corresponding type error rates. yule tree simulation signiﬁcance level met. simulated trees independent trees used obtain values tab. quantiles sackin’s colless’ indices. hence oﬀer validation rejection regions. summarize power study tab. indicated alg. ﬁrst correct tree speciation rate using cophenetic index branch lengths. distributional results derived cophenetic indices unit speciation rate yule tree. mathematical perspective signiﬁcant restriction. pure–birth tree generated process tree equivalent unit rate. hence results presented general multiplicative constant. however applied perspective situation cannot treated lightly. example used cophenetic index branch lengths yule tree large speciation rate would expect signiﬁcant deviation. however unless interested deviations unit speciation rate yule tree would useful. hence needs correct eﬀect. tree come yule process estimate speciation rate isreported.eachtree’sbrancheswerescaledbyitsparticularˆλestimate. branchlengthswithˆλ.themeanandvarianceoveralltreesofˆλasobtainedthroughape’syulefunction superscriptcindicatestestswherethetreeswerecorrectedforthespeciationratethroughmultiplyingall test.thecriticalregionsforthecopheneticindicesweretakenfromthepooledestimatesintab..the bythevarioustests.columnswith>labelindicateright–tailedtestandwithlabelthetwo–sided eachprobabilityisthefractionofindependentlysimulatedtreesthatwereacceptedasyuletrees undertheyulesothisisaconﬁrmationofcorrectsigniﬁcancelevel. treeforvariousalternativemodelsatthe%signiﬁcancelevel.intheﬁrstrowthetreesweresimulates tablepowerpresentedastypeiierrorratesofthevariousindicestodetectdeviationsfromtheyule biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. biasedspeciationp=. birth–deathµ=. birth–deathµ=. coalescent yule maximum likelihood obtained. example work used ape’s yule function. then multiplies branch lengths tree calculates cophenetic index transformed tree. important point estimate hence random variable. eﬀects source randomness limit distribution deserve separate detailed study. balance indices branch lengths suﬀer issue hand miss another aspect tree—proportions branch lengths non–yule like. power analysis presented tab. generally agrees intuition power analysis done blum fran¸cois ﬁrst shows tests statistics signiﬁcance level approximately kept. then next three rows topology based indices fail completely completely unsurprising removes speciation events leading extinct species birth– death tree remaining tree topologically equivalent pure birth tree. true coalescent model topology identical yule tree’s one. cophenetic index branch lengths high type error rate still better topological indices. however corrects index manages nearly perfectly reject coalescent model trees. tests nearly perfect however correction signiﬁcantly worsened ability detect deviations. imbalance decreased power topological indices. overbalanced trees one–sided tests failed sided worked cophenetic index branch lengths consider topology able successfully reject pure–birth tree power study observed using quantiles standard normal distribution right–tailed test based rejects yule trees based rejects yule trees two–sided test rejects yule trees two–sided test rejects yule trees. type error rates two–sided tests within observed monte carlo errors right–tailed tests’ type error evidently inﬂated. conﬁrms right tail scaled cophenetic index much heavier normal. short power study indicates cophenetic index branch lengths considered option detect deviations yule tree. able information sources—the topology time actually evident decomposition describe topology branch lengths. information powerful testing procedure possible. deviations topologically visible e.g. biased speciation regimes detectable. correct eﬀects speciation rate otherwise merely detects deviations unit rate yule tree. correction mixed blessing. help hinder detection. naturally interesting indices behave phylogenies estimated sequence data. comparing database phylogenies like treebase another index’s distribution yule model expected yield interesting results. yule model indicated inadequate describe collection treebase’s trees therefore choose particular study estimated tree also reported collection posterior trees. sosa recent work providing trees beast’s output well suited purpose. sosa estimate evolutionary relationships tree ferns species. report posterior phylogenies tab. look percentage trees posterior accepted consistent yule tree various tests indices. seen discrete cophenetic index high acceptance rate. continuous also takes account branch lengths accept single tree. however lost corrects speciation rate used make trees binary ones). tests indices rejected yule tree maximum likelihood estimate phylogeny exceptions. two–sided discrete cophenetic index test reject null hypothesis pure–birth tree. also correcting speciation rate neither test based continuous cophenetic index rejected yule tree. therefore conclude yule tree null hypothesis rejected clade plants. table percentage trees sosa posterior trees accepted yule trees various tests indices. columns label indicate right–tailed test label two–sided test. critical regions cophenetic indices taken pooled estimates tab. superscript indicates tests trees corrected speciation rate multiplying branch lengths ape’s yule function returned average trees estimate also followed blum fran¸cois looking yusim phylogeny human immunodeﬁciency virus type group gene sequences available package. phylogeny consists tips blum fran¸cois could reject null hypothesis pure–birth tree after pruning tree keep only internal branches corresponded oldest ancestors able reject yule tree. conclude results probably indicate change evolutionary rate evolution impact cladogenesis early expansion virus. repeating experiment versions cophenetic index point deviation two– sided test based ˜φ’s test conﬂicts conclusions sackin’s colless’ draw conclusions. however test indicates deviation inclined reject null hypothesis yule tree. strengthened fact signiﬁcance remains correction even though topology whole seems consistent pure–birth tree branch lengths not. fact two–sided test rejected yule tree indicates phylogeny over–balanced comparison pure–birth tree. fact biased speciation model tree over–balance observed values close trees declining speciation rate grow hence supports blum fran¸cois aforementioned explanation. table values normalized indices yusim hiv– phylogeny. index indication index deviates signiﬁcance level yule tree dash insigniﬁcant asterisk signiﬁcant. ﬁrst symbol concerns right–tailed test second two–sided test. superscripted calculated tree corrected speciation rate multiplying branch lengths study asymptotic distributional properties pure–birth tree model using techniques previous papers branching brownian ornstein–uhlenbeck processes assume speciation rate tree property pure– birth tree case time speciation events distributed minimum random variables. furthermore assume tree starts single species lives time splits species. consider conditioned contemporary species tree. conditioning translates stopping tree process speciation event i.e. last interspeciation time distributed. introduce notation height tree time coalescent randomly selected species time speciation events section prove series rather technical lemmata theorems concerning second order properties even though obtain weak limit derived properties give insight delicate behaviour also show simple limit e.g. possible. obtain results used mathematica linux running ubuntu evaluate required sums closed forms. mathematica code available appendix paper. i.e. sample pair tips twice pairs coalesced k–th speciation event. three possibilities drew pair drew pairs sharing single node drew disjoint pairs. event occurs indicator variables independently sampled pairs coalesced speciation events respectively. possibilities represented fig. counterpart probability event divided worth noting lemmata theorems conﬁrmed numerical evaluations formulae comparing simulations performed obtain fig. check also notice that implied variance properties would tempting take distribution normal one. however wary rem. fig. rather delicate problem even simulations indicate incorrect weak limits. remains study variance conditional variance entirely clear variance conditional variance converge hence remains open problem investigate conjecture black curve density ﬁtted simulated data density function. sample variance simulated values indicating still high variability alternatively variance sample variance converge therefore every variable whose expectation goes however bounded understood terms conditional cumulative distribution function random variable κ—at speciation event random cophenetic index discrete continuous version following poly´a description. start ﬁlled balls. ball number painted initially. step remove pair balls numbers return ball number painted stop ball supported knut alice wallenberg foundation swedish research council grant grateful barcelona graduate school mathematics sponsoring workshop algebraical combinatorial phylogenetics signiﬁcantly contributed development work. would like thank whole computational biology bioinformatics research group balearic islands university hosting multiple occasions many discussions suggestions phylogenetic indices. visits balearic islands university partially supported magnuson foundation royal swedish academy sciences foundation scientiﬁc research education mathematics would like acknowledge gabriel yedid numerous discussions distribution cophenetic index sharing cophenetic index simulation code. grateful cecilia holmgren svante janson pointing works contraction–type distributions many discussions. would furthermore like acknowledge wojciech bartoszek sergey bobkov joachim domsta serik sagitov mike steel helpful comments discussions related work. indebted anonymous reviewers anonymous editor haochi kiang careful reading earlier version manuscript comments signiﬁcantly improving", "year": "2017"}