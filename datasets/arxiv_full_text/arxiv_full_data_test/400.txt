{"title": "RIDDLE: Race and ethnicity Imputation from Disease history with Deep  LEarning", "tag": "q-bio", "abstract": " Anonymized electronic medical records are an increasingly popular source of research data. However, these datasets often lack race and ethnicity information. This creates problems for researchers modeling human disease, as race and ethnicity are powerful confounders for many health exposures and treatment outcomes; race and ethnicity are closely linked to population-specific genetic variation. We showed that deep neural networks generate more accurate estimates for missing racial and ethnic information than competing methods (e.g., logistic regression, random forest). RIDDLE yielded significantly better classification performance across all metrics that were considered: accuracy, cross-entropy loss (error), and area under the curve for receiver operating characteristic plots (all $p < 10^{-6}$). We made specific efforts to interpret the trained neural network models to identify, quantify, and visualize medical features which are predictive of race and ethnicity. We used these characterizations of informative features to perform a systematic comparison of differential disease patterns by race and ethnicity. The fact that clinical histories are informative for imputing race and ethnicity could reflect (1) a skewed distribution of blue- and white-collar professions across racial and ethnic groups, (2) uneven accessibility and subjective importance of prophylactic health, (3) possible variation in lifestyle, such as dietary habits, and (4) differences in background genetic variation which predispose to diseases. ", "text": "center statistics machine learning department computer science princeton university princeton jersey united states america king abdullah university science technology computational bioscience research center computer electrical mathematical sciences engineering division thuwal saudi arabia. institute genomics systems biology computation institute departments medicine human genetics university chicago chicago illinois united states america manuscript revised published plos computational biology. arxiv preprint outdated; updated article available free open access publication https//doi.org/./journal.pcbi.. anonymized electronic medical records increasingly popular source research data. however datasets often lack race ethnicity information. creates problems researchers modeling human disease race ethnicity powerful confounders many health exposures treatment outcomes; race ethnicity closely linked population-speciﬁc genetic variation. showed deep neural networks generate accurate estimates missing racial ethnic information competing methods riddle yielded signiﬁcantly better classiﬁcation performance across metrics considered accuracy cross-entropy loss area curve receiver operating characteristic plots made speciﬁc eﬀorts interpret trained neural network models identify quantify visualize medical features predictive race ethnicity. used characterizations informative features perform systematic comparison diﬀerential disease patterns race ethnicity. fact clinical histories informative imputing race ethnicity could reﬂect skewed distribution bluewhite-collar professions across racial ethnic groups uneven accessibility subjective importance prophylactic health possible variation lifestyle dietary habits diﬀerences background genetic variation predispose diseases. electronic medical records increasingly popular source biomedical research data emrs digital records patient medical histories describing occurrence speciﬁc diseases however datasets often anonymized lack race ethnicity information race ethnicity information also missing speciﬁc individuals within datasets. problematic research settings race ethnicity powerful confounder variety eﬀects. race ethnicity strong correlates socioeconomic status predictor access quality education healthcare. factors diﬀerentially associated disease incidence trajectories. result correlation race ethnicity associated variation medical histories. example reported referrals cardiac catheterization rarer among african american patients white patients furthermore researchers reported diﬀerences genetic variation inﬂuence disease across racial ethnic groups association race ethnicity medical histories hypothesize clinical features emrs used impute missing race ethnicity information. addition race ethnicity information useful producing investigating hypotheses epidemiology. example variation disease risk across racial ethnic groups cannot fully explained allele frequency information provide insights possible environmental modiﬁers genes task race ethnicity imputation serialized supervised learning problem. typically goal imputation estimate posterior probability distribution plausible values missing variable. distribution plausible values used generate single imputed dataset generate multiple imputed datasets multiple imputation setting goal impute distribution mutually-exclusive racial ethnic classes given clinical features. features comprised gender codes international disease classiﬁcation version codes describe medical conditions medical procedures family information treatment outcomes. bayesian approaches race ethnicity imputation using census data proposed used race ethnicity imputation datasets however approaches require sensitive geolocation surname data patients. geolocation surname data missing anonymized datasets limiting utility approaches information. traditionally logistic regression classiﬁers used impute categorical variables race ethnicity however recent interest deep learning solving similar supervised learning tasks. deep learning particularly exciting oﬀers ability automatically learn complex representations high-dimensional data. representations used solve learning tasks regression classiﬁcation neural network. neural network directed graph functions referred units neurons nodes. network organized several layers; layer corresponds diﬀerent representation input data. input data transformed propagated network data layer corresponds alternate-dimension representation sample imputation task learn representation individual mixture race ethnicity classes class assigned probability. representation encoded ﬁnal output layer neural network. output neural network functions prediction distribution race ethnicity classes given input features. introduce framework using deep learning estimate missing race ethnicity information datasets riddle race ethnicity imputation disease history deep learning. riddle uses relatively simple multilayer perceptron type neural network architecture directed acyclic graph nodes neural network architecture utilizes parametric rectiﬁer linear units rectiﬁer functions addition investigating novel utility deep learning race ethnicity imputation used recent methods interpreting neural network models perform systematic evaluation racial ethnic patterns approximately diﬀerent medical events. believe type large-scale evaluation disease patterns maladies race ethnicity done heretofore. figure neural network architecture. riddle uses multi-layer perceptron network containing hidden layers parametric rectiﬁed linear unit nodes. input binary encoded features comprising gender international disease classiﬁcation version codes. output probability estimates four race ethnicity classes. aimed assess riddle’s imputation performance multiclass classiﬁcation setting. used datasets chicago york city collectively describing million unique patients. approximately unique input features consisting basic demographic information observations clinical events target class race ethnicity; possible values white black hispanic. although race ethnicity described mixture training datasets labeled race ethnicity four mutually exclusive classes. testing treated target race ethnicity class missing compared predicted class true class. large dimensionality features high number samples heterogeneity source populations present unique challenging classiﬁcation problem. experiments riddle yielded average accuracy top-two accuracy cross-entropy loss test data signiﬁcantly outperforming logistic regression random forest classiﬁers support vector machines various kernels also evaluated. however svms could feasibly used computational cost high; experiment required hours. multiclass learning problem appeared relatively hard riddle exhibited class-speciﬁc receiver operating characteristic’s area curve values mean micro-average signiﬁcantly higher figure receiver operating characteristic curves. curves corresponding area curve values calculated four race ethnicity classes. micro-average macroaverage curves also computed. data representative experiment shown. across experiments mean micro-average mean macro-average riddle exhibited runtime performance comparable machine learning methods standard computing conﬁguration without graphics processing unit support vector machines also evaluated precise runtime measurements could obtained experiments took greater hours however smaller subset full dataset riddle exhibited signiﬁcantly better classiﬁcation accuracy faster runtime performance svms various kernels table runtime comparisons riddle methods. riddle demonstrated runtimes logistic regression random forest classiﬁers. runtime values averaged k-fold cross-validation experiments. standard computing conﬁguration used intel sandybridge cores ghz; graphics processing units utilized. order replicate real-world applications data race ethnicity missing conducted additional experiments simulate random missing data. random subset sample features artiﬁcially masked completely random. otherwise classiﬁcation training evaluation scheme used before. simulation random missing data riddle signiﬁcantly outperformed logistic regression random forest classiﬁers terms classiﬁcation accuracy figure accuracy riddle method compared standard techniques situations missing data. experiments simulating diﬀerent proportions random missing data riddle outperformed logistic regression random forest classiﬁers. riddle yielded signiﬁcantly higher accuracy scores missing data experiment riddle compared logistic regression random forest respectively; missing data experiment missing data experiment accuracy scores averaged k-fold cross-validation major criticism deep learning opaqueness trained neural network models intuitive interpretation. intricate functional architectures enable neural networks learn complex tasks also create barrier understanding learning decisions made. addition creating precise race ethnicity estimation framework sought identify describe factors contribute estimations. computed deeplift scores quantitatively describe speciﬁc features contribute probability estimates class. deeplift algorithm compares activation node reference activation; diﬀerence reference observed activation used compute contribution score neuron class feature contributes selecting particular class feature-class pair assigned positive deeplift score; conversely feature contributes selecting particular class pair assigned negative score. magnitude deeplift score represents strength contribution. using deeplift scores able construct natural orderings race ethnicity classes feature sorting classes positive negative scores. following example ordering shows example feature strong predictor african american class table deeplift contribution score orderings predictive codes. deeplift scores computed pair feature race ethnicity class; list codes highest ranges scores correspond discriminative ability. feature-to-class contribution scores used construct orderings race ethnicity classes feature. deeplift scores summed across samples. positive scores indicate favorable contribution class zero scores indicate contribution negative scores indicate discrimination class. visualized orderings common features using frequencies deeplift scores race ethnicity class orderings obtained frequency scores distinctly diﬀerent obtained deeplift scores. suggests riddle’s network able learn non-linear non-frequentist relationships codes race ethnicity categories. according orderings constructed using deeplift scores important feature predicting race ethnicity models seek medical attention least likely african addition speciﬁc medical diagnoses convey grains racial ethnic information hypertension human immunodeﬁciency virus predictive african american individuals white individuals. ﬁnding also reﬂected medical literature reported african americans signiﬁcantly higher risk heart disease white peers. fact features important imputing race ethnicity could reﬂect skewed distribution bluewhite-collar professions across racial ethnic groups uneven accessibility subjective importance prophylactic health care across racial ethnic groups possible variation lifestyle dietary habits. work would involve investigating epidemiological hypotheses environmental factors aﬀect diﬀerential clinical patterns across race ethnicity. genetic diseases famously discriminative races ethnicities. example sickle cell disease occurs time frequently african americans rest population model sickle cell anemia strongly predicts african american race. reported lyme disease predominately occurs whites largely unreported hispanics african americans ﬁnding also reﬂected model lyme disease serves strong predictor white race. additional strongly white-predictive diseases medical procedures include atrial ﬁbrillation hypothyroidism prostate neoplasm dressing sutures lump breast coronary atherosclerosis. primarily diseases older suggesting lifespan varies across race ethnicity socioeconomic lifestyle reasons. orderings provide high-level description community structure reﬂect socioeconomic cultural habitual genetic variation linked race ethnicity across population large cities york city chicago. figure visualizing class orderings common features. constructed natural orderings features common code features using frequency information deeplift scores. frequency scores mean-centered; higher scores indicate larger contribution feature class. orderings rank contribution code particular class visualized stacked bar. strongest feature-toclass contributions represented rightmost bar; length corresponds magnitude contribution linear scale. scores summed across samples. experiments riddle yielded favorable classiﬁcation performance class-speciﬁc values riddle displayed signiﬁcantly better classiﬁcation performance across tested metrics compared popular classiﬁcation methods logistic regression random forest. riddle’s superior top-two accuracy loss results suggest riddle produces accurate probability estimates race ethnicity classes compared currently used techniques. although results could obtained svms unacceptably high computational costs riddle outperformed svms runtime eﬃciency classiﬁcation performance smaller subset full dataset furthermore riddle without displayed runtimes comparable traditional classiﬁcation techniques required less memory. ﬁndings argue deeplearning-driven imputation oﬀers notable utility race ethnicity imputation anonymized datasets. current work simulated conditions ethnicity missing completely random. future work involve simulating conditions race ethnicity missing random missing random formalizing multiple imputation framework involving deep-learning estimators. however results also highlight growing privacy concern. shown application machine learning poses non-trivial privacy risks sensitive information recovered non-sensitive features results underscore need anonymization clinical datasets race ethnicity private information; simple exclusion suﬃcient. addition assessing predictive computational performance imputation framework made eﬀorts analyze speciﬁc features contribute race ethnicity imputations neural network model. individual feature represent weak trend together numerous indicators synergize provide compelling evidence person’s lifestyle social circles even genetic background vary race ethnicity. aforementioned highlights raceethnicity-inﬂuenced patterns health diversity disparity extended thousands codes. best knowledge systematic comparison across classes maladies respect race ethnicity done ﬁrst time study. study used de-identiﬁed independently collected patient data determined internal review board university chicago exempt review federal regulations category used anonymized datasets jointly comprising individual medical histories york city chicago metropolitan populations medical histories encoded variable length lists codes coupled onset ages years. individual belongs four mutually exclusive classes race ethnicity features included quinary gender reported years. onset information code removed continuous information coerced discrete integer categories. features vectorized binary encoding scheme individual represented binary vector zeros ones element binary encoded vector corresponds input node trained neural network k-fold cross-validation random shuﬄing used produce complementary subsets training testing data corresponding classiﬁcation experiments; allowed test coverage entire dataset. training approximately samples used holdout validation data parameter tuning performance monitoring. testing data held separately used evaluation process. hyperparameters selected using randomized grid search samples validation data. reported randomized grid search requires less computational eﬀort exhaustive grid search slightly worse performance used keras tensorflow backend train deep multilayer perceptron parameterized rectiﬁed linear units network composed input layer nodes hidden layers prelu nodes each softmax output layer four nodes dropout regularization applied hidden layer trained iteratively using adam optimizer training performed batch-wise fashion; data vectorization also done batch-wise coordination training. large number samples attention scalability necessitated vectorization. number training epochs determined early stopping patience model caching model epoch minimal validation loss selected. categorical cross-entropy chosen loss function; categorical cross-entropy penalizes assignment lower probability correct class assignment non-zero probability incorrect classes. evaluated several machine learning approaches random forest classiﬁer logistic regression support vector machines various kernels traditionally logistic regression used categorical imputation tasks used fast cython array implementations methods oﬀered popular ‘scikit-learn‘ library. order replicate real-world scenarios additional information absent conducted simulation experiments randomly removed proportion feature data conducted separate training testing pipelines deﬁcient datasets. computed standard accuracy cross-entropy loss scores testing data across experiments. also computed top-two accuracy speciﬁcation top-k accuracy. top-k accuracy prediction considered correct true class contained within classes highest probability assignments. addition evaluating classiﬁcation performance also monitored runtime performance across methods. models trained standard computing conﬁguration intel sandybridge cores ghz. computed deeplift scores interpret certain features contribute probability estimates class deeplift algorithm takes trained neural network produces feature-toclass contribution scores passed sample. computed deeplift scores using test samples k-fold cross validation experiments achieve full coverage dataset. describe high-level relationships features classes summed scores across samples produce aggregate score. aggregate deeplift scores predictive features summarized table described prior computed orderings race ethnicity classes feature’s deeplift scores. orderings describe certain features predict particular race ethnicity class. visualize orderings deﬁned deeplift scores twenty-ﬁve common features compare orderings produced total frequencies feature-class observations. visualizations frequency counts mean-centered facilitate comparison deeplift scores. grateful drs. raul rabadan rachel melamed preparing columbia university dataset. work funded darpa mechanism program contract grants uhl- gift kent dauten.", "year": "2017"}