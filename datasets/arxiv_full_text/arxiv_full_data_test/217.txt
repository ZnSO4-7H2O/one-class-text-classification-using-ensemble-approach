{"title": "Perfect phylogenies via branchings in acyclic digraphs and a  generalization of Dilworth's theorem", "tag": "q-bio", "abstract": " Motivated by applications in cancer genomics and following the work of Hajirasouliha and Raphael (WABI 2014), Hujdurovi\\'c et al. (IEEE TCBB, to appear) introduced the minimum conflict-free row split (MCRS) problem: split each row of a given binary matrix into a bitwise OR of a set of rows so that the resulting matrix corresponds to a perfect phylogeny and has the minimum possible number of rows among all matrices with this property. Hajirasouliha and Raphael also proposed the study of a similar problem, in which the task is to minimize the number of distinct rows of the resulting matrix. Hujdurovi\\'c et al. proved that both problems are NP-hard, gave a related characterization of transitively orientable graphs, and proposed a polynomial-time heuristic algorithm for the MCRS problem based on coloring cocomparability graphs.  We give new, more transparent formulations of the two problems, showing that the problems are equivalent to two optimization problems on branchings in a derived directed acyclic graph. Building on these formulations, we obtain new results on the two problems, including: (i) a strengthening of the heuristic by Hujdurovi\\'c et al. via a new min-max result in digraphs generalizing Dilworth's theorem, which may be of independent interest, (ii) APX-hardness results for both problems, (iii) approximation algorithms, and (iv) exponential-time algorithms solving the two problems to optimality faster than the na\\\"ive brute-force approach. Our work relates to several well studied notions in combinatorial optimization: chain partitions in partially ordered sets, laminar hypergraphs, and (classical and weighted) colorings of graphs. ", "text": "motivated applications cancer genomics following work hajirasouliha raphael hujdurovi´c introduced minimum conﬂict-free split problem split given binary matrix bitwise rows resulting matrix corresponds perfect phylogeny minimum possible number rows among matrices property. hajirasouliha raphael also proposed study similar problem task minimize number distinct rows resulting matrix. hujdurovi´c proved problems np-hard gave related characterization transitively orientable graphs proposed polynomial-time heuristic algorithm mcrs problem based coloring cocomparability graphs. give transparent formulations problems showing problems equivalent optimization problems branchings derived directed acyclic graph. building formulations obtain results problems including strengthening heuristic hujdurovi´c min-max result digraphs generalizing dilworth’s theorem independent interest apx-hardness results problems approximation algorithms exponential-time algorithms solving problems optimality faster na¨ıve brute-force approach. work relates several well studied notions combinatorial optimization chain partitions partially ordered sets laminar hypergraphs colorings graphs. keywords perfect phylogeny minimum conﬂict-free split problem branching acyclic digraph chain partition dilworth’s theorem min-max theorem approximation algorithm apxhardness perfect phylogeny rooted tree representing evolutionary history objects. objects bijectively label leaves tree binary variables called characters labeling exactly edge tree. leaf characters appear unique root-to-leaf path characters taking value object labeling leaf. rows characters columns perfect phylogeny problem asks opposite question given binary matrix correspond perfect phylogeny? perfect phylogeny problem various generalizations extensively studied computational biology. paper study combinatorial optimization problems generalizations perfect phylogeny problem ﬁrst considered hajirasouliha raphael motivated applications cancer genomics. following work hujdurovi´c introduced minimum conﬂict-free split problem informally stated follows given binary matrix split bitwise rows resulting matrix corresponds perfect phylogeny minimum number rows among matrices property. state problem formally need deﬁnitions. deﬁnition given matrix three distinct rows distinct columns denote submatrix formed rows columns columns binary matrix said conﬂict exist rows deﬁnition }m×n. label rows binary matrix }m×n split exists partition rows sets bitwise binary vectors rows said split rows simplicity deﬁned split binary matrix suitable partition rows considering split already equipped arbitrary partition rows satisfying condition. example notions fig. sake clarity omit displaying zeros binary matrices. task compute split number distinct rows minimized. denote minimum number distinct rows conﬂict-free split similarly above consider corresponding optimization problem. connection conﬂict-free matrices perfect phylogenies well known rows binary matrix leaves perfect phylogeny conﬂict-free moreover case corresponding tree retrieved time linear size intuition behind fact conﬂict-free matrix corresponds perfect phylogeny leaf tree column edge exactly columns mapped edges path root leaf corresponding row. forbidden matrix deﬁnition submatrix leads contradiction since distinct edges columns mapped respectively appears before after root-to-leaf path. refer references therein details biological aspects mcrs mdcrs problems. fact binary matrix conﬂict-free sets rows indicating positions ones columns form laminar family. connection exploited section laminar families sets play important role network design problems study packing covering problems several areas combinatorial optimization e.g. mcrs mdcrs problems proved np-hard related characterization transitively orientable graphs given polynomial-time heuristic algorithm proposed mcrs problem based coloring cocomparability graphs equivalencies lead transparent formulations problems. ascertain applicability usefulness novel formulations deriving following results insights mcrs mdcrs problems partitions antichains partially ordered sets. result described section read independently rest paper. result besides interesting generalization classical min-max result connects well mcrs problem problem’s branching formulation. constructive algorithmic proof result shows related problem polynomially solvable problem subset branchings containment digraph examined namely so-called linear branchings approach leads heuristic mcrs problem improving previous heuristic inapproximability results three approximation algorithms -approximation algorithm mdcrs problem approximation algorithms mcrs problem approximation ratios expressed terms parameters containment digraph corresponding height width underlying partial order respectively. comparison related work. hajirasouliha raphael introduced so-called minimum-split-row problem given subset rows input matrix needs split roughly speaking task minimize number additional rows resulting conﬂict-free split. results actually deal variant problem number rows paper lower bound value derived concluding remarks paper study mdcrs problem suggested. subsequent works hujdurovi´c mcrs problem introduced several claims proved incorrect including np-hardness proof minimum-split-row problem however shown mcrs problem indeed np-hard mdcrs problem. moreover polynomially solvable case mcrs problem identiﬁed eﬃcient heuristic algorithm problem general instances proposed based coloring cocomparability graphs. results paper improve previously known results problems np-hardness results strengthened apx-hardness results approximation algorithms problems proposed heuristic algorithm mcrs problem given hujdurovi´c improved. tools leading results newly proposed branching formulations min-max theorem strengthening dilworth’s theorem. min-max theorem constructive algorithmic proof leading polynomial-time algorithm compute chain partition given partially ordered equipped monotone weight function maximum weights chains minimized. result contrasts known results literature implying natural variants problem np-hard variant chains used partition bounded size variant weight function necessarily monotone corresponds variant graph coloring problem known weighted coloring class cocomparability graphs. refer remarks following corollary section details. also figure section summarize relations problems introduced paper several problems studied literature along corresponding complexity results. structure paper. branching formulations problems given section strengthening dilworth’s theorem connection mcrs problem discussed section apx-hardness proofs approximation algorithms presented section conclude paper summary questions future research section remark notation. binary matrix }m×n matrix rows columns entries matrix vector column vector usually denote sets rows columns respectively. entry column denoted mrij appropriate. brevity often write number distinct rows mean maximum number pairwise distinct rows rows considered distinct diﬀer binary vectors. binary matrices paper assumed contain whose entries proofs constructions often simplify binary matrix consideration working instead matrix denoted obtained taking exactly copy identical columns. results directed acyclic graph. given column support deﬁned denoted suppm given binary matrix }m×n containment digraph directed acyclic graph vertex {suppm }m×n binary matrix containment digraph branching vertex denote source vertex entered vertex element said covered respect covered analogously uncovered respect uncovered respect denote b-uncovered pairs ﬁrst coordinate b-uncovered pairs. illustrate notions elaborate example fig. fig. branchings depicted together uncovered pairs respect branchings. figure example binary matrix containment digraph branchings resulting splits split optimal solution mcrs problem given split optimal solution mdcrs problem given pairs underlined element ﬁgure showing exactly uncovered elements respect results presented sections rely theorem giving proof theorem discuss consequence theorem allows development faster exact exponential-time solutions problems compared direct bruteforce approach follows directly problems’ deﬁnitions. consider simple approach number distinct columns input matrix hand time complexity straightforward approach problems based generating possible splits cannot even expressed function only. ones least many splits number partitions k-element quantity counted bell number clearly bounded thus matrix rows least ones total number splits least mn/. theorem proved steps. first show split input matrix conﬂict-free given branching containment digraph; number rows resulting split equals number b-uncovered pairs second show conﬂict-free split reduced possibly deleting rows split obtained branching deﬁnition binary matrix rows columns branching deﬁne b-split denoted matrix rows indexed elements columns follows. suppm vertex denote vertices reachable directed path b-split conﬂict-free split rows splitting rows indexed moreover number distinct rows |i|. proof. clear number rows claim bitwise rows indexed suppose claim exists vertex choose done. case covered hence repeat argument replaced covering in-neighbor. procedure terminate ﬁnitely many steps. hence assume implies suppose therefore every shows bitwise rows indexed therefore split matrix conﬂict. exist indices reachable directed path since branching possible assume without loss generality since follows b+). implies b+). since follows contradicts fact obtained contradiction shows conﬂict-free. remains prove number distinct rows |i|. note diﬃcult rows indexed equal. hence number distinct rows |i|. complete proof construct size pairwise distinct rows every arbitrary element since uncovered respect pair element claim rows indexed pairwise distinct. suppose exist rows indexed equal. since rows therefore since equal infer follows contradiction. shows exactly distinct rows proof. denote rows columns split rows suppm suppm suppose follows follows since elementary exists arcs subset deﬁned elementary claim branching suppose then conﬂict-free follows however since assume exists therefore exists contrary fact next prove obtained removing rows equivalently exists one-to-one mapping assigning identical every indexed element every element form deﬁne mapping above suﬃces show exists equal indexed precisely first observe implies exists since conﬂict-free follows either proper subset therefore exists non-trivial non-empty implies path corresponds non-trivial vk-path therefore since follows however contradicts fact therefore consequently proved implies suppose since follows conclude indexed considerations imply existence mapping assigning identical fact mapping deﬁned also one-to-one seen follows. first rows indexed elements distinct ﬁrst coordinates mapped rows respectively construction sets disjoint. second suppose rows indexed elements identical ﬁrst coordinates distinct second coordinates last part proof lemma implies rows indexed pairs diﬀer values second coordinates identical. consequently images rows indexed also identical therefore correspond diﬀerent rows branching transformed time conﬂict-free split exactly rows exactly distinct rows. }m×n transformed time branching number rows number distinct rows proof. branching lemma suﬃces show b-split computed time achieved follows. first compute reduced matrix time using radix sort. second compute containment digraph time performing pairwise comparisons columns red. third compute time checking vertices elements in-neighbors whether fourth time compute finally time o|n) compute matrix using deﬁnition. note hence o|n) claimed time complexity follows. then conﬂict-free split red. note matrix computed time proportional size plus number columns plus time takes compute done time using radix sort. since without duplicated columns previous case time kω)) branching dred computed number rows number distinct rows since number rows equals number rows immediately implies number rows also construction distinct rows correspond pair distinct rows hence number distinct rows number distinct rows implies number distinct rows total time complexity establishes second part theorem. ﬁrst part theorem exists conﬂict-free split rows therefore conversely conﬂict-free split rows exists branching number rows implies therefore theorem mcrs problem concisely formulated terms problem branchings derived digraph. shown hujdurovi´c mcrs problem np-hard; consequently problem also np-hard. section show related problem examine subset branchings containment digraph input binary matrix polynomially solvable. achieved deriving section min-max theorem generalizing classical dilworth’s theorem partially ordered sets independent interest. resulting heuristic algorithm described section consider pair weight function weight function called monotone every non-trivial path directed path least arc. denote transitive closure vertex vertices sometimes regard vertices vs}. price chain given maxv∈c family vertex-disjoint chains called chain partition time real number exists algorithm multiplying binary matrices notation ignores logarithmic graph vertices. done time using algorithm chain partition computed time o|ω). proof. proof induction clearly statement holds inductive step consider vertex without incoming arcs vertex exists since subgraph induced vertices achieving minimum value acyclic. consider chain partition cwdt)} tower antichains cases possible. wdt) obtained adding chain comprising sole vertex obtained adding antichain nwdt |nwdt| wdt. since |nwdt| wdt) infer nwdt hence vertices non-trivial path vertex notice assume therefore wdt). antichain since antichain source vertex acyclic subgraph width least wdt) since subset vertex set. moreover case path vertices also path choice follows width wdt); ci\\t every wdt)}.) hence inductive hypothesis admits chain partition also acyclic subgraph width wdt); hence dilworth’s theorem {ti} wdt) hence deﬁne chain last vertex ﬁrst vertex note ˜cwdt} chain partition clearly valid tower antichains satisfying constructive turned o|ω+) time algorithm recursive call algorithm compute acyclic subgraph together chain partition step dominated computing theorem done time o|ω). claimed time complexity o|ω+) follows. chain maxv∈c price chain partition equals cardinality. moreover value antichain minv∈n consequently value wdt. since lower bound cardinality chain partition applying theorem gives exactly statement dilworth’s theorem would also like emphasize non-linearity deﬁnitions price chain value antichain theorem incomparable classical weighted generalization dilworth’s theorem frank remarks order here showing result corollary sharp ways. first note variant minimumpricechainpartition problem chains used partition bounded size studied moonen spieksma described practical application encountered bruynzeel storage systems manufacturing company netherlands problem optimally loading pallets truck. moonen spieksma referred problem minimum weight partition b-chains showed problem apx-hard even case unit weights strengthening previous np-hardness result second variant minimumpricechainpartition weight function restricted monotone np-hard. follows fact weighted coloring problem np-hard class interval graphs shown escoﬃer input weighted coloring problem graph weight function maxv∈i weighted coloring problem interval graphs ﬁnds applications distributed computing transportation networks dynamic storage allocation computer processes given interval graph represented interval model weight function weighted coloring problem given equivalent problem ﬁnding chain partition vertex minimum price respect claimed np-hardness follows. branching said linear deﬁnes subgraph maximum inoutdegree disjoint union directed paths. note branchings correspond bijectively chain partitions denote minimum number elements linear branchings introduce following problem referred minimumuncoveringlinearbranching given binary matrix compute linear branching since linear branchings correspond bijectively chain partitions follows minimumuncoveringlinearbranching special case minimumpricechainpartition. using theorem obtain linear branching note theorem yields heuristic polynomial-time algorithm problem consequently mcrs problem. going explain algorithm improves heuristic latter problem hujdurovi´c sake simplicity exposition suppose input matrix pairs identical columns. case algorithm returns split input matrix naturally derived optimal coloring complement underlying undirected graph cocomparability graph thus optimal coloring computed eﬃciently e.g. optimal colorings correspond bijectively minimum chain partitions color class corresponds chain. terminology branchings conﬂict-free split input matrix returned heuristic exactly b-split linear branching corresponding minimum chain partition approach proper coloring could used instead optimal coloring derived cocomparability graph. branching terminology choosing proper coloring derived cocomparability graph number rows output split minimized corresponds exactly minimumuncoveringlinearbranching solved optimally theorem thus heuristic algorithm mcrs problem returns b-split optimal solution minimumuncoveringlinearbranching always returns solutions least good computed algorithm hujdurovi´c moreover note corollary digraph minimum price chain partition also minimum respect size. implies existence optimal solution minimumuncoveringlinearbranching corresponding chain partition size equivalently existence optimal coloring derived cocomparability graph minimizes number rows derived conﬂict-free split proper colorings derived graph. possible mutational history tumor represented rooted tree without going details note output heuristic algorithm mcrs problem given theorem corresponds simplest possible reconstruction mutational history within restricted space rooted trees namely within space rooted trees root node allowed non-leaf child. section discuss approximability properties four problems studied paper giving apx-hardness results approximation algorithms. approximation ratios algorithms described terms following parameters input matrix. recall width maximum cardinality antichain height maximum number vertices directed path contained width height binary matrix denoted respectively deﬁned width resp. height containment digraph result implies none four problems admits polynomial-time approximation scheme unless proving problem apx-hard also provides diﬀerent proof np-hardness. apx-hardness branching problems established developing l-reductions vertex cover problem cubic graphs known apx-hard apxhardness problems follows theorem recall class problems approximable within constant factor polynomial time. problem said apx-hard every problem reduces approximation-preserving reduction. another prove problem apx-hard show apx-complete problem l-reducible sake self-containment recall deﬁnition l-reducibility; background apx-hardness refer deﬁnition np-hard optimization problems. problem said l-reducible problem exists polynomial-time transformation mapping instances instances constants every instance following hypergraph) pair subset power elements vertices elements hyperedges. column hypergraph binary matrix hypergraph rows vertices support sets columns hyperedges. formally vertex hyperedge {suppm cm}. note hyperedges column hypergraph equals vertex containment digraph proposition minimumucoveringbranching apx-hard even instances height consequently minimumconflict-freerowsplit apx-hard even instances height prove inequality branching every source vertex every element holds uncovered since source vertices exactly vertices form exactly uncovered pairs corresponding source vertices. minimality implies arcs form therefore every element possibly uncovered element vertex show assume vertex irreducible elements covered {x}. suppose ﬁrst covered {x}. contain form {x}) therefore minimality contains arcs form y}). replacing arcs {x}) results branching hence optimal branching covering suppose exists {x}). endpoint consider vertex {x}. since covered {x}) optimality implies replace {x}). results branching {x}). moreover since removing ∪{x} e∪{x makes uncovered deﬁne ∪{x} e∪{x}) fact every covered e∪{x} implies vertex cover moreover every element uncovered element vertex e∪{x every elements e∪{x covered. implies total number uncovered pairs equals implying proves claimed inequality l-reducibility satisﬁed second condition deﬁnition l-reducibility states every branching compute polynomial time vertex cover |c|− claim achieved polynomial time branching vertex cover therefore |c|−τ |−|v |−β. shows vertex cover problem cubic graphs l-reducible minimumucoveringbranching completes proof. split proof parts. first show minimum vertex cover deﬁne arcs ﬁrst claim branching indeed case would exist edge distinct vertices would imply consequently claim implies suppose contradiction since deﬁnition implies every particular every element b-covered hence contradiction. shows |c|. together implies |c|. follows claimed. since follows construction every element form b-irreducible unless contains three arcs leading consequently contains three arcs leading similarly result theorem raises question whether four problems admit constant factor approximations. section show case mdrcs problems. achieved proving lower upper bound together imply simple -approximation algorithm. lemma every binary matrix number proof. }m×n. first prove equivalently }m×n split exactly distinct rows. number distinct columns }η×n matrix obtained taking identical rows. diﬃcult conﬂict-free exactly distinct columns. corollary holds hence lemma holds remains show lemma suﬃces show split obtained splitting ones rows exactly non-zero entry. construction exactly columns therefore distinct rows. follows desired. clearly algorithm produces split distinct rows. since follows -approximation. moreover using fact infer total time complexity algorithm stated. question whether mcrs problem admits constant factor approximation algorithm general instances remains open give section partial results direction. show problems admit constant factor approximation algorithms instances bounded height width. mcrs problem given theorem -approximation restricted example positive integer binary matrix rows columns. entries deﬁned {di− di−} supports columns given dh−i−} height matrix conﬂict-free therefore dh−. seen dh−. therefore follows every large enough instances bounded width constant factor approximation obtained considering b-split resulting linear branching consisting paths. note branching computed polynomial time using dilworth’s theorem theorem algorithm that given binary matrix computes linear branching consisting paths returns corresponding b-split wdtapproximation algorithm mcrs problem. coordinate claim every suppose since chain assume without loss generality moreover since follows exists path since follows since exists path follows covered respect contradicts assumption obtained contradiction shows claimed. since easy paper revisited minimum conﬂict-free split problem variant formulated problems optimization problems branchings derived directed acyclic graph building formulations obtained several algorithmic complexity insights problems including apx-hardness results approximation algorithms. moreover proved min-max result digraphs strengthening classical dilworth’s theorem leading heuristic mcrs problem. figure summarize relations several problems discussed paper along known complexity results applications. relations described informally; instance problem reduces problem polynomial-time algorithm problem used develop polynomial-time algorithm problem main problem left open work determination exact approximability status mcrs problem. particular problem admit constant factor approximation? possibilities related future research include study approximability properties closely related minimum-split-row problem iii) study extensions model could relevant biological application case input binary matrix contain errors partially missing data. finally would interesting applications polynomially solvable minimumpricechainpartition problem well branching problems minimumuncoveringbranching minimumirreducingbranching introduced paper. authors grateful anonymous reviewers helpful remarks. work supported part slovenian research agency research programs research projects academy finland grant", "year": "2017"}