{"title": "Decoding of neural data using cohomological feature extraction", "tag": "q-bio", "abstract": " We introduce a novel data-driven approach to discover and decode features in the neural code coming from large population neural recordings with minimal assumptions, using cohomological feature extraction. We apply our approach to neural recordings of mice moving freely in a box, where we find a circular feature. We then observe that the decoded value corresponds well to the head direction of the mouse. Thus we capture head direction cells and decode the head direction from the neural population activity without having to process the behaviour of the mouse. Interestingly, the decoded values convey more information about the neural activity than the tracked head direction does, with differences that have some spatial organization. Finally, we note that the residual population activity, after the head direction has been accounted for, retains some low-dimensional structure which is correlated with the speed of the mouse. ", "text": "introduce novel data-driven approach discover decode features neural code coming large population neural recordings minimal assumptions using cohomological feature extraction. apply approach neural recordings mice moving freely circular feature. observe decoded value corresponds well head direction mouse. thus capture head direction cells decode head direction neural population activity without process behaviour mouse. interestingly decoded values convey information neural activity tracked head direction does diﬀerences spatial organization. finally note residual population activity head direction accounted retains low-dimensional structure correlated speed mouse. neural decoding problem characterizing relationship stimuli neural response. example head direction cells respond elevated activity whenever animal facing speciﬁc direction. able determine relationship however experiment must designed relevant behavior animal properly sampled tracked. accurate tracking animal’s complete behavior including movements eyes whiskers head body limbs extremely diﬃcult freely behaving situation; external cues sounds frequency range animal odors visual cues etc. also similarly diﬃcult account appropriately aspects experiment subset potential features driving activity neurons. process identifying relevant features known model selection typically performed model selection indicates likely feature combination features behind activity neurons. however indicate feature explicitly included. would therefore prefer skip problem devising testing inﬁnite ways tracking processing behavioral data instead allow neural data speak themselves i.e. data-driven model selection. data-driven approaches made possible recent advances recording technology permit simultaneous recordings large number neurons. possible states neurons form high-dimensional space expects neural activity described smaller parameters standard dimensionality reduction techniques principal component analysis factor analysis used obtain low-dimensional version data. however methods give data lying euclidean space often different space would appropriate. instance neurons encode head direction population activity conﬁned points circle corresponding speciﬁc directions room. neurons tuned complex features perhaps combination features spaces richer topology would appropriate. since spaces often non-trivial topology argue topological methods used addition traditional methods. persistent cohomology circular parametrization identify shape underlying space decode time-varying position neural activity figure decoding procedure. start estimated ﬁring rate neuron obtained smoothing spike trains neurons. ﬁring rates sampled ﬁxed time intervals giving point cloud simpliﬁed obtaining reduced point cloud ﬁrst persistence diagram reduced point cloud computed. select longest living feature scale feature exists circular parametrization used obtain circular reduced point cloud color point represents circular value according color wheel upper left corner extended full point cloud giving point value closest point reduced point cloud. show decoded circular value function time ﬁrst minutes recording circular value given time point value corresponding point point clouds displayed projections. procedure quite general qualify called cohomological feature extraction. steps illustrated figure step process removing contribution given feature results data method reapplied similar spreemann order characterize additional features neural activity. example apply method neural data recorded freely behaving mice discover prominent circular feature decode time-varying position circle. demonstrate corresponds well head direction subtle interesting diﬀerences. finally consider remaining features following removal head direction component still structure correlated speed mouse. given neurons neuron spike train neuron shown figure ﬁring rates sampled ﬁxed time intervals length resulting sequence points order reduce noise project point cloud onto ﬁrst principal components resulting sequence care taken here also noted section vejdemo-johansson since projecting dimension small projection could give rise intersections underlying space giving topological artifacts. lies assumptions underlying shape complex puted giving summary -dimensional holes data. interested longest living holes represent stable features. analysis focus longest living hole lifespan want understand hole reﬂected data. this ﬁrst parametrization uses representation dimensional cohomology group space maps space improvement original procedure silva morozov vejdemo-johansson gives better results cases data non-uniformly distributed around hole. improvement described appendix imimprove decoding following tactic. first procedure described using large smoothing width features slow dynamics remain arguably less interesting features local theta phase preferences ignored. decoded feature information theoretic measure determine cells population selective feature procedure spike trains selective neurons. time using smaller smoothing width allow ﬁner decoding. appendix appendix experience shared authors silva morozov vejdemo-johansson picking scale near lifespan selected feature resulted better circular parametrization. residual analysis identiﬁcation single feature neural recording ﬁrst step. single recording however could contain mixture cells responding diﬀerent features even multiple features therefore take iterative approach wherein features identiﬁed using topological methods explained away statistical model reveal additional features similar spreemann generalized linear model predict neural activity given decoded angle. subtract predicted neural activity original spike trains obtaining residual spike trains. apply decoding procedure residual spike trains uncover remaining features data. rediscovering head direction cells applied decoding procedure summarized figure spike train data multielectrode array recordings neurons antero-dorsal thalamic nucleus post-subiculum seven freely moving mice revealed prominent circular feature decoded shown figure resulting -dimensional circular time-dependent value. decoded trajectory corresponded well tracked head direction shown figure video figure decoded trajectories actually convey information neural activity tracked head direction does. able resolve moments drift experiment i.e. moments neural data better explained decoded angle tracked head direction. done evaluating timevarying log-likelihood ratio glms decoded angle second tracked head direction. diﬀerence log-likelihoods shown figure neuron. test found moments drift lasting seconds average dispersed throughout experiment. consistent ﬁndings drift head direction representation previously reported rodents figure shows discrepancy mostly independent speed mouse slight clockwise deviation slow speeds slight counterclockwise deviation higher speeds. figure observe appears spatial dependence deviation decoded angle skewed counter-clockwise parts skewed clockwise parts. suggests diﬀerfigure decoding procedure applied recordings. bottom mouse- mouse- round show persistence diagram decoded circular value reduced point cloud circular value full point cloud. point clouds second third column displayed projections. ence simply random drift network representation rather internal representation occationally distorted environment another possible reason might head direction precisely driving neural activity rather something similar gaze direction direction body facing direction animal attending could also partially trackcapturing speed cells considered residual activity remaining accounting decoded angle applied decoding procedure time additional cohomological features eigenvalues covariance matrix residual point cloud suggest one-dimensional figure result decoding procedure mouse- tracked decoded angle ﬁrst minutes. diﬀerence loglikelihood observed spike trains given decoded angle tracked individual neurons. shaded time intervals represent moments drift. average information rate neurons neurons tracked different time lags decoded angle time lag. average information rate tracked peaked neurons neurons. information rates tracked neurons time neurons time average information rates peaked information rates decoded angle time lag. angular diﬀerence time step drift plotted speed mouse. also display average anguregion). time step drift plot tracked decoded angles shown green arrow deviated clockwise tracked arrows rooted position mouse time step. tracked decoded tuning curves neurons. feature remaining data shown figure possible candidates mouse speed angular velocity figure show candidates correlated neural activity. ﬁtting including speed including angular velocity data figure neurons selective speed angular velocity. finally included decoded speed angular velocity created residual point cloud time eigenvalues closer random. also tried include residual spike trains neurons initial mean ﬁring rate higher certain threshold varying threshold spikes second able uncover structure remaining data illustrated example main beneﬁt using persistent cohomology allows understand shape neural data. statistical methods latent variable methods give good low-dimensional representation neural activity developed characterize shapes underlying data. often diﬃcult even impossible identify shape looking projection seen instance ﬁrst round mouse- would likely even diﬃcult elaborate features. preprocessing step however latent variable methods ﬂexible powerful allowing example known covariates priors included simple straightforward figure residual analysis. largest eigenvalues residual point cloud accounting decoded compared conﬁdence interval largest eigenvalues shuﬄed point clouds ﬁrst principal component residual point cloud speed mouse average values pseudo r-score including speed including angular velocity averaged -fold cross-validation recorded neurons data set. residual point cloud accounting decoded speed angular velocity. speed tuning curves neurons mouse. x-axis tuning curve speed mouse going cm/s cm/s. y-axis average ﬁring rate neuron given speed mouse. note y-axes scaled indepentently tuning curve. emphasize method rely knowing priori looking head direction. analysis tracked head direction used demonstrate method gives expected feature data. practice discovery circular feature together circular parametrization would give researcher useful knowledge kind data encoded. instance circular value instead moving direction circle certain frequency would suggest something periodic encoded. topological data analysis previously applied identify shape underlying space neural data work however ﬁrst develop apply topological methods decoding time-dependent variable. also ﬁrst example using topological methods systematic identiﬁcation relevant parameters i.e. model selection constructed spaces based correlations neuron pairs. work well tuning curves neurons convex assumption might strong. instance neurons figure selective diﬀerent directions. could errors preprocesing activity neurons combined might even property cells themselves. method require assumption. analysis focused longest living -dimensional hole general depend situation. hole considered signiﬁcant would make sense apply circular parametrization respect feature. instance underlying space torus persistent cohomology would detect -dimensional features corresponding orthogonal ways traverse torus well -dimensional feature. -dimensional features would give circular parametrizations together determine timedependent position torus. additional theoretical work perea reveal extent features identiﬁed decoded. ideally performing persistent cohomology real features well separated noise persistence diagram. instance diagrams figure prominent -dimensional hole. cases however instance diagrams figure easy separate features noise. however even cases circular parametrizations could still meaningful method performing decoding procedure neurons selective chosen feature might able remove noise making interesting features prominent. topological data analysis methods developed powerful intuitive tools built mathematical rigor applied large population neural recordings. show clear example methods recover relevant features animal’s behavior essentially performing unsupervised decoding model selection. continued emergence large population neural recordings expect topological methods playing important role exploring neural data trying tell n-dimensional cohomology counts number ndimensional holes space. instance circle connected component -dimensional hole sphere connected component -dimensional hole torus connected component -dimensional holes -dimensional hole. able suitable scale might recover cohomology underlying shape. often however noise data giving rise holes separate noise real features. solution consider scales rather ﬁxing scale. persistent cohomology enters picture. persistent cohomology tracks cohomology space grows ﬁltration. equal large enough space becomes comin topological data analysis persistent homology often used instead need cohomology decoding step. refer ghrist edelsbrunner harer introductions persistence ghrist carlsson introductions applied topology general. figure left ﬁltration together ﬁrst persistent cohomology drawn barcode. -dimensional holes appear disappear ﬁltration reﬂected bars. right first persistence diagram ﬁltration. n’th persistent cohomology gives birth scale death scale n-dimensional features. feature birth scale death scale denoted features drawn barcode alternatively feature drawn point plane obtaining n’th persistence diagram shown figure features away diagonal persist longer ﬁltration considered robust features near diagonal considered noise. persistence diagram computed want relate discovered features point cloud. done using circular parametrization turns chosen -dimensional feature existing mean ﬁring rate neuron circular value overall mean ﬁring rate neuron fraction time points circular value integral estimated partitioning circle bins width degrees assuming mean ﬁring rate constant bin. identify neuron selective information rate larger method without spike trains non-selective neurons. information rates neuron relative tracked shown figure calculated way. figure made follows. line shows largest eigenvalues covariance matrix residual point cloud accounting decoded angle glm. residual spike trains gave rise point cloud shifted time time steps number sampled uniformly range done times resulting point clouds. point clouds largest eigenvalues covariance matrix chosen. blue band figure shows index conﬁdence interval i-th largest eigenvalue sampled empirical distribution. mouse speed equally sized bins range angular velocity equally sized bins range bins deﬁned glms letting functions indicator functions speed bins models cross-validated using folds recorded neuron every mouse data diﬀerent choises number bins average pseudo r-score folds neurons shown figure models diﬀerent values average pseudo rscore folds indivual neuron shown figure models using bins model average pseudo r-scores peaked. distance less predetermined distance point removed. ﬁrst point distance greater point marked point. process repeates point continues reaches point cloud. procedure recalculating mouse speed angular velocity speed mouse calculated ﬁrst smoothing tracked position mouse separately x-axis y-axis gaussian kernel taking central diﬀerence derivative smoothed position time step. similarly angular velocity calculated ﬁrst smoothing tracked head direction mouse gaussian kernel taking central diﬀerence derivative time step. neuron bins size circle angular bins width degrees. indicator function decoded value j’th angular time step otherwise observed spike count neuron time assuming ﬁring neuron inhomogeneous poisson process instantaneous intensity time step given repeated process replacing function indicator function corresponding tracked obtained corresponding values ltracked represents much better neuronal activity time step explained decoded value compared tracked diﬀerence shown neuron figure time intervals diﬀerences certain threshold referred moments drift. n-simplex simplex consisting elements. -simplices -simplices -simplices called respectively points edges triangles. simplicial complexes used method called rips complexes deﬁned follows. topological denoising since point cloud noisy need reduce amount noise look topological features. method topological denoising introduced kloke parameter estimate standard deviation noise parameter determines much points repell other. maximize function iteratively moving point direction gradient starting topological data analysis shapes modeled simplicial complexes. simplicial complex thought space constructed gluing together basic building blocks called simplices shown figure circular maps obtained smooth since points sent point circle. order allow smoother maps consider cohomology real coeﬃcients. consider real cocycle suppose another cocycle tried apply circular parametrization data sets quickly discovered often produces unsatisfactory results. demonstrate using constructed example namely rips complex shown figure ﬁrst cohomology complex integer coeﬃcient generated cocycle value rightmost edge zero edges. color point indicate circular value applying circular parametrization. original smoothing sends points circular values close other. reason behavior edges simplicial complex evenly distributed around circle; edge covering rightmost part circle. since edge gives relatively small contribution squares edge lengths streched around circle edges smaller. problematic want geometry complex preserved. simplicial complex. deﬁne weighting following procedure. first solve original optimization problem obtain cocycle d+α. construct weighted directed graph follows vertices points edge edge denoted edge least squares problem. solving system obtain circular parametrization. result applying procedure rips complex example shown figure rightmost edge given much larger weighting edges since every directed cycle edge. result circular values points evenly distributed around circle. figure compare original improved smoothing circular parametrization done ﬁrst round mouse-. sequence simplicial complexes together maps satisfying conditions called ﬁltration. prime ﬁeld order taking cohomology space coeﬃcients parametrized family vector spaces together induced linear maps every pair parameters sequence vector spaces together linear maps satisfying conditions called persistence module. persistence module obtained taking cohomology ﬁltration called persistent cohomology ﬁltration. another kind persistence modules interval modules. integer cocycle. ﬁrst constructing integer -chain replacing coeﬃcient integer congruence class lying range almost always gives integer cocycle ˆαi\u0001 computations used ripser compute ﬁrst persistent cohomology coeﬃcients giving persistence diagrams associated representative cocycles. procedure described lift cocycle always gave integer cocycles. decoding mouse-. show position lights attached mouse point lights tracked head direction decoded angle decoded using identiﬁed selective neurons. figure supplementary ﬁgures residual analysis figure residual point cloud accounting decoded angle. pseudo r-score including speed including angular velocity diﬀerent number bins averaged -fold cross-validation recorded neurons data set. residual point cloud accounting decoded angle speed angular velocity. figure show threshold ﬁgures. ﬁrst showing resulting point cloud removing contribution decoded angle speed angular velocity second showing largest eigenvalues residual point cloud compared conﬁdence interval largest eigenvalues shuﬄed point clouds. also show threshold number neurons included.", "year": "2017"}