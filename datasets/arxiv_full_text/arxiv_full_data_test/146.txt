{"title": "Fuzzy-based Propagation of Prior Knowledge to Improve Large-Scale Image  Analysis Pipelines", "tag": "q-bio", "abstract": " Many automatically analyzable scientific questions are well-posed and offer a variety of information about the expected outcome a priori. Although often being neglected, this prior knowledge can be systematically exploited to make automated analysis operations sensitive to a desired phenomenon or to evaluate extracted content with respect to this prior knowledge. For instance, the performance of processing operators can be greatly enhanced by a more focused detection strategy and the direct information about the ambiguity inherent in the extracted data. We present a new concept for the estimation and propagation of uncertainty involved in image analysis operators. This allows using simple processing operators that are suitable for analyzing large-scale 3D+t microscopy images without compromising the result quality. On the foundation of fuzzy set theory, we transform available prior knowledge into a mathematical representation and extensively use it enhance the result quality of various processing operators. All presented concepts are illustrated on a typical bioimage analysis pipeline comprised of seed point detection, segmentation, multiview fusion and tracking. Furthermore, the functionality of the proposed approach is validated on a comprehensive simulated 3D+t benchmark data set that mimics embryonic development and on large-scale light-sheet microscopy data of a zebrafish embryo. The general concept introduced in this contribution represents a new approach to efficiently exploit prior knowledge to improve the result quality of image analysis pipelines. Especially, the automated analysis of terabyte-scale microscopy data will benefit from sophisticated and efficient algorithms that enable a quantitative and fast readout. The generality of the concept, however, makes it also applicable to practically any other field with processing strategies that are arranged as linear pipelines. ", "text": "many automatically analyzable scientiﬁc questions well-posed oﬀer variety information expected outcome priori. although often neglected prior knowledge systematically exploited make automated analysis operations sensitive desired phenomenon evaluate extracted content respect prior knowledge. instance performance processing operators greatly enhanced focused detection strategy direct information ambiguity inherent extracted data. present concept estimation propagation uncertainty involved image analysis operators. allows using simple processing operators suitable analyzing large-scale spatiotemporal microscopy images without compromising result quality. foundation fuzzy theory transform available prior knowledge mathematical representation extensively enhance result quality various processing operators. presented concepts illustrated typical bioimage analysis pipeline comprised seed point detection segmentation multiview fusion tracking. furthermore functionality proposed approach validated comprehensive simulated benchmark data mimics embryonic development large-scale light-sheet microscopy data zebraﬁsh embryo. general concept introduced contribution represents approach eﬃciently exploit prior knowledge improve result quality image analysis pipelines. especially automated analysis terabyte-scale microscopy data beneﬁt sophisticated eﬃcient algorithms enable quantitative fast readout. generality concept however makes also applicable practically ﬁeld processing strategies arranged linear pipelines. available prior knowledge often suﬃciently considered automatic processing pipelines great amount potentially useful extra information re∗institute applied computer science karlsruhe institute technology karlsruhe mains unused. particularly domain image processing image analysis visual analysis acquired image data oﬀers large repository usable priori information often easily verbalized experts respective application ﬁeld. examples successful incorporation prior knowledge e.g. approaches described make information expected object number well associated physical size order adjust improve seed point detection algorithms. analogously properties like size shape geometry intensity distributions like used improve algorithmic performance image segmentation algorithms prior knowledge often embedded algorithm shape penalization terms appended energy functional graph-cut level-set segmentation generalized hough transforms detect arbitrary shapes object properties like size shape movement dynamics also used formulate eﬃcient correction heuristics object tracking algorithms great often underestimated potential algorithmic improvements lies estimation uncertainties automatically produced results ideally considered subsequent processing steps pixel level uncertainty used assess information quality single pixel sensor imperfections temperature dependence furthermore localization uncertainty geometric features corners centroids edges lines images assessed approach evaluate quality image registration algorithms presented besides many applications ﬁeld quality quantiﬁcation part research focuses uncertainty quantiﬁcation areas face recognition biometric technologies tracking shapes ultrasound images evaluate impact noisy measurements validity diagnosis results uncertainty formulation based fuzzy theory employed perform pixelobject-based classiﬁcation tasks possibility exploit uncertainty information optimize parameter values respective operator feedback fashion outcome minimizes previously deﬁned optimization criterion demonstrated another example improvement graph-based watershed implementation uncertainties used assess inﬂuence individual edges ﬁnal segmentation outcome hitherto however uniform approach systematically transform embed available prior knowledge improve existing algorithms missing. although sequential arrangement processing operators broadly used concept image analysis results propagated pipelines mostly assessed individual pipeline components respect result quality. thus errors made early processing steps tend accumulate negatively aﬀect ﬁnal result quality. additionally many existing methods processing tasks seed point detection segmentation tracking often directly applicable large-scale data sets enormous memory computation time demands. fect knowledge validity piece extracted information produced respective image analysis operators used derive eﬃcient improvement heuristics enhance image analysis pipelines present apply concept estimation propagation uncertainty involved image analysis operators improves result quality awareness processing operator used trigger adapted processing strategies. foundation previous work fuzzy theory transform available prior knowledge mathematical representation extensively enhance performance image analysis operators data ﬁltering uncertainty propagation explicit exploitation information uncertainty result improvements. particular extend exemplary image analysis pipeline comprised seed point detection segmentation multiview fusion tracking uncertainty handling. introducing general concept demonstrate simple processing operators extended uncertainty handling improve large-scale analyses microscopy images. methods quantitatively validated comprehensive simulated validation benchmark data mimics embryonic development inspired epiboly movements zebraﬁsh embryos. moreover show qualitative results obtained presented framework large-scale light-sheet microscopy data developing zebraﬁsh embryos. image analysis pipelines make multiple processing operators arranged linear processing pipeline perform specialized tasks improving transforming image signal extract information images sequentially connected operators receive either processed version input image extracted features analogous characteristic function classical fuzzy deﬁned associated membership function maps element universe discourse value range degree respective element fuzzy special cases indicate fully included part fuzzy respectively common membership functions used practice trapezoidal membership functions parameterized model singletons triangular rectangular mbfs. trapezoidal membership function formulated parameter vector used control start points respective transition regions. here make standard partition i.e. maximally neighboring fuzzy sets overlap nonzero membership values certain value respective membership degrees input value considering instance detection speciﬁc kind object might make sense size feature object indicator appropriateness. described linguistic terms could case example determined possible outcomes extracted feature acquisition-speciﬁc prior knowledge illumination conditions detection path image resolution physical spacing voxels high-quality image regions point spread function detection path. signal-dependent information like intensity range time-variant characteristics objects signal-to-noise ratio global statistical properties image intensity values. positional information objects object properties absolute image coordinates. furthermore localization extracted properties objects relative used deﬁne neighborhood relations. combination intensity-based geometrical properties e.g. link information patterning texture structure color geometrical properties shape symmetry. figure diﬀerent possibilities partition input space feature using trapezoidal membership functions. linguistic terms separate fuzzy shows reduced version fuzzy sets correspond desired class complement. diﬀerent possibilities summarize correct objects arise. besides restricting class correct done correct fuzzy could extended potentially useful classes however appropriate formulation chosen application dependent. available prior knowledge used determine parameterization associated fuzzy sets exemplary standard partition shown fig. outcome operators importance possible linguistic term aggregate cases complement µaif nfi} linguistic term nl}. thus n-th data tuple produced operator obtains fsmd value µaif fuzzy feature linguistic term fuzzy membership degree values multiple features characterize linguistic term combined using fuzzy pendant logical conjunction conjunction fuzzy membership functions linguistic term deﬁned using minimum operator compared multiplication-based conjunction used minimumbased formulation informative non-zero value directly represents lowest fsmd value considered fuzzy sets. fsmd values associated data tuple perform feedforward propagation reliability extracted data downstream operators. data vector produced operator calculate degree membership respective fuzzy sets append feature classiﬁcation correct incorrect objects needs performed linguistic term described combination diﬀerent fuzzy sets single fsmd value appended data tuple. fsmd values used perform object ﬁltering extended information propagation resolve ambiguities. tainty framework ﬁlter extracted output information produced operator using thresholds according fsmd values µlcail calculated data tuple passed next pipeline component µlcail membership dexi. keep extracted information threshold contrary uncertain information passed operator based application speciﬁc criteria object properties fsmd-based object rejection allows easily ﬁlter false positive detections demonstrated sec. sec. respectively. extended information propagation compensate operator flaws second allow operators fall back information penultimate processing steps predecessors deliver good results. instance operator fails suﬃciently extract information provided input data inform downstream operators characterize information operator might useful later steps correct ﬂawed results operator information information produced operator propagated. current resolve ambiguities using propagated uncertainty addition ﬁltering propagating information operators within pipeline provided uncertainty information explicitly used processing operators improve results. depending degree uncertainty provided information parameters even whole processing methods adapted needed. course adaptions required particular algorithm cannot generalized. however showcase potential applications next sections namely fusion redundant seed points correction under-segmentation errors operators speciﬁcally adjust processing behavior based fsmd values extracted information. solid lines indicate main information dash-dotted lines propagation previously calculated results dotted lines emphasize inﬂuence selection propagated information. addibased general concept presented previous section applied exemplary image analysis pipeline comprised seed point detection segmentation multiview fusion object tracking. operator fsmd values estimated based prior knowledge used algorithmic improvements possible. simulated benchmark data mimics microscopy images containing ﬂuorescently labeled nuclei artiﬁcial embryo. advantages using simulated image data validation possibility single comprehensive data validation pipeline components. instead testing component separately diﬀerent benchmarks allows uncover speciﬁc bottlenecks error sources processing pipelines. furthermore diﬀerent acquisition deﬁciencies diﬀerent pointspread-functions decreasing signal-to-noise ratios multiview acquisition deﬁciencies simulated. immediate availability reliable ground truth enables quantitative validation without bias observed manually annotated benchmark data suﬀers intrainter-expert variability. simulated benchmark close target application pipeline namely quantitatively analyzing terabyte-scale ﬂuorescence microscopy images developed concepts algorithms easily practice e.g. false positive reduction segmentation algorithm segmentationbased multiview fusion details benchmark generation found app. abbreviations diﬀerent algorithms given round brackets quantitative comparison result quality provided sec. blob detection method based laplacian-of-gaussian maximum intensity projection used localize ﬂuorescently labeled cellular nuclei microscopy images. brief input image ﬁltered diﬀerently scaled ﬁlters standard deviations matching expected subsequently maximum object radius using relation projection log-ﬁltered images formed local extrema extracted projection image although proposed method worked well many scenarios frequently missed objects exhibit strict local maximum intensity plateau behavior used detections background regions removed using intensity threshold applied mean intensity small window surrounding potential detection. remaining seed points mostly located properly detected objects remaining false positive detections largely originated objects detected multiple times. combine redundant objects single fusion approach based hierarchical clustering used hierarchical cluster tree computed using ward’s minimum variance method compute distances clusters i.e. withincluster variance minimized obtain equally sized clusters ﬁnal clustering obtained complete cluster tree using distance-based cutoﬀ tdbc smallest expected object radius rmin fuse close redundant detections prevent fusion neighboring objects. single detection object obtained averaging feature vectors detected seeds cluster. seed detection stage usually represents ﬁrst analysis steps preceding uncertainty information considered. inform down-stream operators expected result quality uncertainty detected seed points estimated using window mean intensity maximum seed intensity z-position features extracted objects besides discarding obvious false positive detections background regions fuzzy sets z-position adjusted seed detections contrast regions lower membership degrees class correct objects objects high contrast regions ﬁnal fuzzy membership degree object fuzzy correct objects determined using minimum obtained membership degrees appended feature output matrix seed detection algorithm. ﬁlter false positives forward threshold slightly zero color-coded visualization detected seed points fuzzy sets diﬀerent features shown fig. seed detection stage segmentation operator used extract regions regional properties detected objects simulated image stacks e.g. using algorithms presented demonstration purposes improved algorithm based adaptive thresholding using otsu’s method watershed-based splitting merged objects described therefore propagated information seed detection stage estimated fsmd values extracted segments used improve algorithmic eﬃciency segmentation quality based extracted statistical quantities benchmark images derive parameter vector trapezoidal fuzzy membership function considered feature using minimum maximum values parameters respectively. remaining parameters %-quantile %-quantile. parameterization ensured values smaller larger maximum values obtained membership degree zero data range membership value figure maximum intensity projection benchmark image along axis superimposed detected seed points seed points colored according fsmd class correct detection ranging blue green medium high membership degree respectively. fuzzy sets used individual features depicted min-operator used fuzzy conjunction obtain ﬁnal membership degree. uncertainty gradient along zaxis introduced signal attenuation locations farther away detection objective used later steps resolve multiview fusion ambiguities. assigned. course parameterization application data dependent customized e.g. adjust behavior extrema lower upper spectrum value range. simplicity focus volume size information objects. absence ground truth data transition regions fuzzy sets identiﬁed manual analysis objects deviate expectation lower upper feature value range e.g. using software tools fiji vaad minimum maximum quantile values used formulate fuzzy sets features. individual fuzzy sets combined using minimum operator obtain single membership degree value fuzzy valid object. depicted fig. shapes fuzzy membership functions derived statistical quantities resemble respective distribution observed feature histograms. used min-operator combine individual fuzzy membership degrees single value i.e. combined fsmd value directly corresponded membership degree feature deviated speciﬁed expected range. course size criteria discussed considered exemplary illustration. various features potentially used assess improve segmentation results e.g. integrated intensity edge information local entropy local signal-to-noise ratios principal components weighted centroids many more. furthermore colocalized channels investigated complementary information used formulate complex decision rules. case ﬂuorescently labeled nuclei membranes imaged different channels rules like each cell exactly nucleus formalized using fuzzy membership functions quantiﬁcation available prior knowledge. identiﬁed fsmd values segmented objects used detect under-segmentation errors produced otsu’s method needed split match expected object size. realized investigated otsuww+u implementation using seed points lognsm+f+u method contrast previous approach watershed-based splitting technique applied objects known larger expected. using parallelization strategy similar discussed segments combined fsmd values corresponded objects larger expected distributed among available cores seeded watershed approach used object splitting cropped regions image approach much faster directly applying watershed algorithm entire image uncertainty-guided locally applied processing erroneous objects. splitting merged objects connected components image needed identiﬁed uncertainty values re-evaluated well provide updated information subsequent processing operators. improve results respect false positive detections observed higher noise levels segments combined fsmd values i.e. objects smaller expected object size removed label images. facilitate implementation uncertainty-guided segmentation realized using single fuzzy correct class objects identify objects needed consideration. determine objects fsmd values smaller larger expectation comparison boundaries expected valid range performed threshold values identiﬁed using interactive graphical user interface presented subsequent time points acquired images. illustration purposes used straightforward nearest-neighbor tracking approach implemented open-source matlab toolbox gait-cad object present frame associated spatially closest object subsequent frame. procedure applied every frame data order complete linkage objects. addition tracking results obtained segmentation methods introduced previous section present alternative approach combines ﬂawed segmentation provided seeds inspired conservation tracking methods leave ﬂawed segmentation results produced respective algorithms unchanged additionally provide detected seed points tracking algorithm instead actually using seed points splitting image domain shown tab. segmentation quality achieved otsu principle reasonably usable without watershed-based object splitting. nevertheless tracking algorithm could extended decide information reliable suitable tracking could optionally fall back provided seed points segmentation quality insuﬃcient. therefore used fsmd values provided segmentation stage. using empirically determined threshold objects aggregated fsmd value lower threshold tracked actual segment seed points respective segment contained. forward threshold parameter order report tracking results. functionality proposed approaches validated simulated benchmark images. data sets contained images diﬀerent numbers objects diﬀerent noise levels sequential time points moving interacting objects sbde data additionally included multiview simulation i.e. time point simultaneous images opposite direction generated. overview generated benchmark data sets provided tab. brief description data generation provided app. well fig. fig. validate proposed improvements log-based seed detection algorithm sbde sbde benchmark data sets used parameters listed tab. performance measures described app. obtained values summarized tab. whereas entry table corresponds arithmetic mean value independently obtained results benchmark images sbde. quantitative performance assessment log-based seed detection methods. criteria true positives false positives false negatives recall precision f-score distance reference well achieved time performance measures seconds voxels second values represent arithmetic mean individually processed benchmark images. could improve algorithmic performance respect f-score. logsm false positive detections hand missed many objects strict maximum detection recall could improved value additionally allowing non-strict maxima however adaption concurrently raised number false positives thus lowered precision objects maximum plateaus detected multiple times. multi-detection errors could successfully removed using proposed fusion technique reﬂected f-score value lognsm+f i.e. compared logsm method f-score increased regarding processing times additional eﬀort redundant detection almost negligible non-strict maximum detection simply detected seed points iteration image. seed point fusion performed directly feature space therefore also insigniﬁcant compared preceding processing steps. feature described here using uncertainty-based object rejection slightly improved results compared directly fusing ﬁltering data using hard intensity threshold increased processing time lognsm+f yielded almost identical results required processing time compared logsm. nevertheless objects equipped uncertainty value propagated pipeline proved beneﬁcial ﬁlter fuse correct extracted data subsequent steps. addition noted processing time required image analysis easily exceeds fuzzy calculations soon images larger. furthermore tested performance seed detection different image noise conditions using sbde data contained images diﬀerent settings additive gaussian noise standard devialogsm lognsm lognsm+f lognsm+f+u algorithms intensity thresholds determined noise levels individually using semi-automatic graphical user interface described higher noise levels number detections background regions heavily increased became ambiguous determine true positive detections low-contrast regions. manual threshold therefore adjusted false positive detections minimized unambiguous seeds considered. continuous threshold adaption also reason constant increasing precision easier identify false positives rather false negative detections noisy image regions. objects robustly detected signal-to-noise ratio close visual limit detection emphasized uncertainty-based improvements. figure assessment seed detection performance diﬀerent noise levels sbde data set. performance measures recall precision f-score plotted versus additive gaussian noise level parameter σagn logsm lognsm lognsm+f lognsm+f lognsm+f+u produced identical results respect recall precision f-score plots combined single panel inﬂuence noise level signal-to-noise ratio images plotted segmentation performance validated using sbde sbde data sets addition algorithms described sec. segmentation quality obtained twang method details) added quantitatively compared twang version relied improved seed detection operator introduced previous section respective parameterization brief description algorithm provided tab. validation measures summarized app. tab. quantitative segmentation quality results obtained sbde data summarized. rand index value almost identical algorithms otsu yielded highest value. enhanced adaptive threshold-based techniques yielded better jaccard index value twang+u best normalized distances value obtained otsuww+u. considering results global threshold-based techniques produced slightly accurate results objects still able resolve compared best results twang-based methods. twang-based methods hand produced minimal amount topological errors respect split merged objects compared otsu-based methods. number added objects minimal otsuww+u. twang+u produced slightly added objects twang eﬃciently detected objects. thus f-score values achieved twang+u increased compared twang i.e. twang+u produced best results fewest topological errors amount split merged nuclei twang originate single-cell extraction strategy rather using global threshold performed otsu-based methods. relatively large amount added objects detected twang segmentation mostly real false positive detections segments extracted region intersected image background instead actual object thus considered false positives. regarding processing times otsu fastest approach poor quality without uncertainty-based extension really option reliable analysis image data. twang twang+u times slower plain otsu method times faster otsuww otsuww+u respectively. time twang+u precise approach furthermore otsuww+u times faster otsuww focused object splitting additionally produced better results improved seed detection noise reduction. results conﬁrmed uncertainty information could eﬃciently exploited guide computationally demanding processing operators speciﬁc locations thus speed processing operations result quality preserved even improved. exemplary fsmds ﬁnal segmentation results diﬀerent algorithms depicted fig. provide convenient visualization instantly assess segmentation quality identify potential problems methods even non-experts. algorithms suﬀered light attenuation axial direction. especially techniques relied single global intensity threshold problems identify objects located lowcontrast regions. besides missing many objects otsu additionally merged many high intensity objects single large blob. especially z-direction many mergers occurred lower sampling direction. however merged regions could successfully split large extent using proposed seed-based splitting techniques twang directly operated provided seeds still able extract objects regions yielded even higher recall values using lognsm+f+u seed points. however low-contrast segmentation quality extracted segments regions reduced. tab. reﬂected increased number added objects twang twang+u mostly real false positives described above. arithmeticmeanoftheindividuallyprocessedbenchmarkimages. wasmeasuredinsecondsandvoxelspersecond.allvaluesrepresentthe addednucleiasfalsepositivesandmergedandmissingobjectsasfalsenegativesrespectively.theachievedtimeperformance mergedaddedandmissingobjects.precisionrecallandf-scorearebasedonthetopologicalerrorsbyconsideringsplitand andthehausdorﬀmetricasdescribedin.additionallythetopologicalerrorswereassessedbycountingsplit thecriteriausedtocomparethealgorithmsaretherandindexthejaccardindexthenormalizedsumofdistances figure maximum intensity projections image exemplary volume renderings automatic segmentation results produced otsu otsuww+u twang+u diﬀerent viewpoints fsmd individual detected objects estimated using morphological criteria volume size used coloring investigate impact signal-to-noise ratio images segmentation quality benchmark data sbde processed using algorithms. segmentation quality adaptive thresholding-based methods heavily aﬀected noise level images yielding poor precision recall values even lowest noise levels caused global threshold hand merged objects hand detected high amount false positive segments. uncertainty-based method otsuww+u successfully preserved increased recall otsuww time substantially increased precision almost perfect level noise parameters σagn increasing number small segments observed otsu otsuww could eﬃciently ﬁltered using uncertainty-based object rejection. twang heavily depended quality provided seeds observed curves fig. show high correlation seed detection performance render suitable method even higher noise levels. improved seed detection lognsm+f+u also directly aﬀected quality twang+u segmentation. note seed points adjusted noise levels i.e. subtle variations precision recall values caused subjective manual threshold adaption. figure performance evaluation segmentation methods otsu otsuww otsuww+u twang twang+u images sbde data diﬀerent signal-to-noise ratios. methods based adaptive thresholding suﬀered high noise levels produced successively increased amount false positive detections could eﬃciently suppressed using uncertainty framework-based extension result quality twang versions directly correlated quality provided seed points i.e. twang+u beneﬁted improved detection rate lognsm+f+u. tracking validation performed sbde data consisted frames simultaneously acquired rotation images frame yielding total number frames needed processed. segmentation performed using otsuww otsuww+u twang twang+u separately time points view angles. obtain single objects time point segmentation results diﬀerent view angles fused using segment-based fusion approach described app. centroids detected objects used perform nearest neighbor tracking addition method described sec. applied test data otsu-based threshold applied rotation images independently resulting binary images fused simply using maximum pixel value images. fsmd values estimated connected components fused image using fuzzy sets segmentation step. obtained tracking results summarized tab. fig. pipelines without uncertainty treatment reached lowest tracking accuracy respect tracking quality measure increased number missing objects high number false positive detections course missing objects directly correlated number missing edges explain higher amount missing edges compared best scoring algorithm category furthermore otsuww+nn suﬀered many merged regions also contributed lower recall value compared otsu+f+nn+u. contrast this uncertainty-enhanced methods provided comparable results best results achieved otsu+f+nn+u twang+u+nn. although amount false negatives twang+u+nn almost halved compared twang+nn detection rate still largest problem pipeline resulting higher amount missing edges compared otsu+f+nn+u. hand otsu+f+nn+u still suﬀered under-segmentation tendency observed otsuww+nn otsuww+u+nn consequently missing edges main problem. respect false positive detections twang-based methods provided best results precision values high quality seed detection beneﬁtted simultaneous multiview acquisition. reﬂects improvement precision obtained twang-based methods compared otsuww+nn uncertainty-based object exclusion thus increased amount false positive detections background regions. reason slightly higher number redundant edges observed twang-based methods fully clear. likely seed detection already provided redundant seed segmentation method produced nearby segments turn counted redundant segment tracking evaluation. however even segmentationandtrackingonasingleimageandweremeasuredinsecondsandvoxelspersecond f-scoreandthetrameasurewerecalculatedasdescribedinapp.band.processingtimesareaveragevaluesforapplying negativesredundantedgesmissingedgesandmergedobjects.furthermorerecallprecision manymergedregions).thevalidationmeasurescorrespondtotruepositivesfalsepositivesfalse algorithm.notethatthesegmentationproducedbyotsu+f+nn+uwasnotusableforotherpurposesthantrackingdueto basedsegmentationwithadditionalseedpointsfromlognsm+f+uwasusedwithanadaptedtracking explicitlyincorporatedpriorknowledge-baseduncertaintytreatment.furthermoreanotsutwoalgorithmswithoutuncertainty-basedimprovementswerecomparedtoenhancedpipelinesthat quantitativeperformanceassessmentofanearestneighbortrackingalgorithmappliedondiﬀerentsegmentationresults. worst algorithm category redundant edges observed tracked objects thus play minor role compared tracking errors. shown fig. number false negatives merged objects directly correlated density objects i.e. closer objects other under-segmentation errors occurred. however case twang-based methods explicit prior knowledge object size incorporated algorithm. otsu+f+nn+u method produced best tracking result second fastest method closely followed twang+u+nn compared otsuww+nn twang+u+nn otsu+f+nn+u provide superior quality categories particular increase measure decrease processing times respectively. thus latter methods represent best quality speed trade-oﬀ suitable large-scale analyses. although otsu+f+nn+u provided excellent results comparison noted extracted segmentation masks largely merged object splitting approach performed otsuww would required object properties need known. additional object splitting approach however would eradicate performance beneﬁt method e.g. twang+u+nn pipeline favored case. fall back seed point information beneﬁt segmentation methods like twang algorithmic design already extracts single segment seed point literally merged objects exist. however interesting extension consider upcoming work might combination lognsm+f+u otsu-based segmentation seed detection feed seeds twang algorithm reach reduced amount missed objects reduced amount merged objects. moreover temporal coherence considered investigated framework i.e. additionally allowing nearest neighbor matching multiple frames could potentially also help reduce number missing redundant detections. presented framework successfully used automated analysis large-scale microscopy images developing zebraﬁsh embryos particular used lognsm+u method i.e. seed points detected using non-strict local maximum detection subsequent fusion redundant detections false positive suppression based axial location seeds well ﬂuorescence intensity information seeds provided twang algorithm described segments diﬀerent views combined using segment-based fusion approach finally nearest-neighbor tracking applied detected objects obtain movement trajectofigure quantitative performance assessment nearest neighbor tracking algorithm applied diﬀerent segmentation results obtained sbde data set. algorithms without uncertainty-based improvements described compared enhanced pipelines explicitly incorporate prior knowledge-based uncertainty treatment indicates respective algorithm produce usable segmentation image correction solely performed tracking step. ries million dynamically interacting objects total investigated time period hours post fertilization manual labeling validation impossible. qualitative results seed detection segmentation tracking stage depicted fig. contribution presented general concept mathematical formulation prior knowledge showed image analysis pipelines equipped formalized prior knowledge make elaborate decisions. framework includes propagation estimated result uncertainties able inform downstream pipeline operators validity input data potentially improve results. besides general concepts demonstrated exemplary pipeline consisting seed point detection segmentation multiview fusion tracking could systematically extended proposed uncertainty considerations order ﬁlter repair fuse produced data. performance proposed improvements quantitatively assessed comprehensive validation benchmark inspired light-sheet microscopy recordings live specimen. extensions proofed superior performance compared plain pipelines impact processing times lightweight adaptions propagated feature matrices. thus proposed framework represents powerful approach improve quality eﬃciency image analysis pipelines. several components presented framework successfully used analyze large-scale light-sheet microscopy images developing zebraﬁsh embryos described sec. simplicity used mostly focused simple processing methods illustrate general concepts. however extending complex seed detection segmentation tracking algorithms presented concepts ﬁltering splitting fusion work analogously uncertainty-based corrections considered post-processing strategy processing operator. especially tracking step oﬀers potential improved. uncertainty framework could exploited classify movement events e.g. detect object divisions reconstruct missing objects using temporal coherence objects. however beyond scope paper addressed upcoming work. addition algorithmic improvements showed respective fuzzy sets parameterized based available prior knowledge feature histograms knowledge acquisition deﬁciencies. respective shape fuzzy sets determined based desired outcome. instance false positive suppression seed point detection stage could performed ﬁxed threshold instead explicit usage fuzzy sets intensity-based features. however model increasing uncertainty regions farther away detection objective using trapezoidal shape approprifigure application presented framework light-sheet microscopy images zebraﬁsh embryos. panels show maximum intensity projections planes. seed points extracted using lognsm+f+u method improved seed points used segmentation using twang+u method extracted objects opposite views combined using segment-based fusion approach fused object locations used tracking ﬁrst three columns show results single view approximately hours post fertilization color-code according fsmd values extracted objects last column shows results multiview fusion tracking using cell density coloring. addition embryo oriented along coordinate axes anteroposterior axis aligned axis dorsoventral axis aligned axis data taken previously published work scale provide thorough validation entire pipeline comprised seed point detection segmentation multiview fusion tracking used recently presented approach generating comprehensive validation benchmarks adapted object movement simulation. brief object locations object movements object interactions simulated multiple time points obtain movement behaviors resembled biological specimens. simulated position video snippet containing simulated ﬂuorescent cellular nucleus added artiﬁcial image form data basis time point. simulate acquisition deﬁciencies simulated images disrupted additive gaussian noise poisson shot noise pointspread-function simulation light attenuation multiview acquisition simulation detailed acquisition deﬁciencies added simulated images using xpiwit pipeline pipeline downloaded https//bitbucket.org/jstegmaier/embryomicsbench mark/downloads/acquisitionsimulationpipeline.zip. sake simplicity simulated objects moving spherical surface. instead using object displacements real embryo described simulated objects moved density changes resulting repulsive adhesive forces acting neighboring objects. furthermore simulation constrained spherical surface prevent arbitrary movement simulation space. schematic illustration simulated specimen overview involved simulation steps benchmark shown fig. repulsive adhesive forces well parameterization taken boundary constraint deﬁned spectively ﬁnally controls shape sigmoidal boundary potential function. ∆xbdr contributed displacement simulated object object already boundary. additional displacement component prevented objects entering inner bounding sphere escaping outer bounding sphere simulated embryo analogous formulation used total displacement vector single object given time point summarized figure pipeline schematic benchmark simulation. illustration embryo simulation. starting initial object multiple division cycles simulated including object interaction object divisions morphological constraints. inner outer bounding spheres between-object interactions cells migrated animal pole artiﬁcial vegetal pole produced behavior similar epiboly movement zebraﬁsh embryogenesis. performed steps realistic simulated benchmark. left column reﬂects object simulation returned images contained dynamic objects associated ground truth data. right column contains acquisition simulation distorted simulated images artiﬁcial signal attenuation point spread function simulation dark current image simulation poisson distributed photon shot noise additive gaussian noise. steps shaded gray could optionally consider image rotation multiview experiment simulated output operators indicated dashed edge lines weights adhesive repulsive displacement components default values mentioned wadh wrep moreover weight boundary constraint wbdr manually adjusted interacting objects remained within spherical boundaries. note parameters empirically determined presented model necessarily represent accurate physical simulation interacting objects. however determined parameters produced movement behaviors similar epiboly movements observed early zebraﬁsh development increased object densities boundary constraints caused directed movement sphere surface. exemplary benchmark images shown fig. diﬀerent time points diﬀerent additive gaussian noise levels. availability complete ground truth detailed quantitative analysis involved pipeline steps could performed single benchmark using performance measures described following figure maximum intensity projections simulated benchmark images. maximum projections extracted division cycle simulated nucleus time increases left right bottom. single objects randomly initialized simulated predeﬁned experimental duration. approach yielded simulated embryo including object movement object interaction object divisions available ground truth generated image sequences manipulated simulate various acquisition conditions diﬀerent levels additive gaussian noise ground truth enabled quantitative analysis algorithmic performance realistic image data. seed detection quality evaluated using benchmark datasets sbde sbde intersections detected seeds labeled ground truth image calculated. true positives counted ground truth objects contained least seed point. seed points detected background regions redundant detections ground truth objects considered false positives ground truth objects contain seed point counted false negatives using recall precision f-score calculated. true positives average distance centroids respective ground truth objects additionally calculated. segmentation quality assessed using benchmark datasets sbde sbde provided ground truth benchmark contained complete label images frame detailed quantitative assessment automatic segmentation quality could performed. segmentation validation measures proposed coelho used namely rand index jaccard index normalized distances hausdorﬀ metric detailed description measures found topological errors produced automatic segmentation separated added missing split merged objects. besides error counts topological information used deﬁne number false positives split added cells analogously false negatives merged missing cells. values used calculate recall precision f-score. assess tracking quality sbde dataset used comparison investigated algorithms performed using measure described maˇska measure calculated considering tracking result acyclic oriented graph comparing graph respective ground truth graph. inverted weighted normalized number required changes transform automatically generated graph ground truth graph yielded normalized measure centroids objects complete temporal association object ancestry known simulated sbde dataset required ground truth graph could directly generated using data. obtain detailed view errors made respective tracking algorithms number false positive detections false negative detections incorrect edges missing edges redundant edges merged objects counted. detailed descriptions validation measures provided frequently used approach partly overcome quality deﬁciencies microscopy caused attenuation scattering light along axial direction acquisition multiple views diﬀerent perspectives complementary image stacks specimen obtained either using multiple oppositely arranged detection paths rotation probe using single camera strategies acquisition multiview images require subsequent fusion step information present individual views single consistent representation. benchmark dataset sbde used tracking validation contains simulated multiview acquisition i.e. time point opposite images simulated. fuse complementary views segmentation-based fusion approach combines results separately applied segmentation diﬀerent views single segmentation image. image transformation already known benchmark generation step registration process skipped. corresponding segments identiﬁed using histogram-based approach i.e. label histogram ﬁlled iterating voxels segmentation images successively increasing histogram bins indicated respective image label pairs. segments present image could found searching empty columns rows histogram respectively copying segments without consideration result image. next step assignments remaining segments images identiﬁed searching respective label pair maximum overlap. case segmentation fusion desired perform weighted average segments rather better segment image. accomplished simply selecting segment higher fsmd value desired class objects based fsmd values segments seed points contained information validity segment axial localization extracted objects respectively. ﬁnal segmentation image used tracking. upon request. matlab scripts generating benchmark data sets simulated embryos well xpiwit pipeline used acquisition simulation found https//bitbucket.org/jstegmaier/embryomicsbenchmark furthermore source code well binary packages xpiwit available https//bitbucket.org/jstegmaier/xpiwit/. table benchmark datasets used validation experiments. columns list dataset identiﬁer number images number noise levels number objects image resolution noise parameter ranges σagn dataset description. subsefive pairs quent frames different numbers objects. used seed detection segmentation validation. single frame sbde diﬀerent noise levels. used seed detection segmentation validation. sequential time points containing objects each. images rotated every frame simulate simultaneous acquisition multiview experisegmentation otsu. small noise objects fsmd values rejected processing. merged regions fsmd larger expected split locally parallel using cleaned fused seeds lognsm+f+u method seeded watershed approach small cropped regions. twang segmentation described using cleaned seeds provided logsm method. manually optimized parameter ωkpm yielded better results default value dataset.", "year": "2016"}