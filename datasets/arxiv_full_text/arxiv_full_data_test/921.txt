{"title": "$S$-Leaping: An adaptive, accelerated stochastic simulation algorithm,  bridging $\\tau$-leaping and $R$-leaping", "tag": "q-bio", "abstract": " We propose the $S$-leaping algorithm for the acceleration of Gillespie's stochastic simulation algorithm that combines the advantages of the two main accelerated methods; the $\\tau$-leaping and $R$-leaping algorithms. These algorithms are known to be efficient under different conditions; the $\\tau$-leaping is efficient for non-stiff systems or systems with partial equilibrium, while the $R$-leaping performs better in stiff system thanks to an efficient sampling procedure. However, even a small change in a system's set up can critically affect the nature of the simulated system and thus reduce the efficiency of an accelerated algorithm. The proposed algorithm combines the efficient time step selection from the $\\tau$-leaping with the effective sampling procedure from the $R$-leaping algorithm. The $S$-leaping is shown to maintain its efficiency under different conditions and in the case of large and stiff systems or systems with fast dynamics, the $S$-leaping outperforms both methods. We demonstrate the performance and the accuracy of the $S$-leaping in comparison with the $\\tau$-leaping and $R$-leaping on a number of benchmark systems involving biological reaction networks. ", "text": "abstract propose s-leaping algorithm acceleration gillespie’s stochastic simulation algorithm combines advantages main accelerated methods; -leaping r-leaping algorithms. algorithms known eﬃcient diﬀerent conditions; -leaping eﬃcient non-stiﬀ systems systems partial equilibrium r-leaping performs better stiﬀ system thanks eﬃcient sampling procedure. however even small change system’s critically aﬀect nature simulated system thus reduce eﬃciency accelerated algorithm. proposed algorithm combines eﬃcient time step selection -leaping eﬀective sampling procedure r-leaping algorithm. s-leaping shown maintain eﬃciency diﬀerent conditions case large stiﬀ systems systems fast dynamics s-leaping outperforms methods. demonstrate performance accuracy s-leaping comparison leaping r-leaping number benchmark systems involving biological reaction networks. celebrated gillespie’s stochastic simulation algorithm simulates continuous-time markov chains systems. example system well-stirred chemically reacting system small population reactants exact numerical algorithm. however since allows simulate reaction event time step becomes computationally costly large systems long time scales. years several algorithms proposed accelerate expense sacriﬁcing accuracy. prominent -leaping enhancements r-leaping algorithm accelerated algorithms involve flavor-ssa averaging used accelerate simulation coupling multi-scale frameworks stochastic simulation algorithm adaptive mesh reﬁnement algorithm reaction-diﬀusion systems ﬁnally mention special class algorithms achieve exact ssa-like sampling reaction events computational acceleration initiated exact r-leaping acceleration oﬀered techniques however weaker -leaping r-leaping algorithms. -leaping algorithm accelerates advancing state system larger time step allowing multiple reaction events occur within preselected time step. number ﬁrings reaction channel time step random variable follows poisson distribution. hand r-leaping algorithm preselects total number reaction ﬁrings time step needed reactions events occur follows gamma distribution number ﬁrings reaction follows multinomial distribution eﬃciently sampled correlated binomial distributions. approximate algorithms valid leap condition states propensities must remain approximately constant simulation step. algorithms eﬃcient diﬀerent conditions. nonstiﬀ systems -leaping eﬀective r-leaping algorithm. addition implicit extension -leaping stiﬀ systems reaction channels appear partial equilibrium allows advance system bigger time steps yields signiﬁcant speed-up explicit r-leaping method. however sampling procedure leaping method requires draw random number reaction channel. especially ineﬃcient stiﬀ systems reaction channels ﬁred time step. hand since samples r-leaping drawn correlated probability distribution amount drawn random numbers reduced reordering reaction indices probable reaction channels sampled ﬁrst. yields appreciable computational savings stiﬀ systems. paper present s-leaping algorithm eﬃcient coupling methods. algorithm uses eﬃcient time step selection procedure present -leaping. feature allows s-leaping exploit advantage implicit formulation stiﬀ systems partial equilibrium. addition s-leaping estimates total number ﬁrings within preselected time interval sample poisson distribution. knowledge total number reaction channels allows draw individual ﬁrings correlated binomial distributions optimization reordering reaction channels stiﬀ systems. thus s-leaping algorithm provides eﬀective fusion methods. name method chosen represents position s-leaping r-leaping -leaping method. paper organized follows. section provide brief speciﬁcation -leaping r-leaping algorithms. s-leaping algorithm introduced section section s-leaping method tested four benchmark cases non-stiﬀ stiﬀ fast dynamics large reaction network. conclude summary section consider well-stirred system contains molecular species react chemical reactions channels rm}. follows letter used chemical species e.g. letter chemical reactions e.g. state system characterized state vector denotes number molecules time dynamics reaction channel characterized propensity function state change vector given state vector quantity ajdt gives probability reaction occur next inﬁnitesimal time interval state change vector gives change molecular population caused reaction finally deﬁne propensity functions denote probability distribution function binomial gamma exponential multinomial poisson distribution respectively. notation used denote function produces pseudossa exact algorithm simulating time evolution wellstirred chemically reacting systems. exact algorithm sense generated sample paths distributed according solution corresponding chemical master equation however since simulates reaction event time step becomes ineﬃcient realistic systems. algorithm summarised algorithm several approximate stochastic simulation algorithms introduced accelerate advancing system larger time steps allowing reactions time step. accurate advancement system limited called leap condition states propensities remain approximately constant time interval -leaping algorithm pre-selects deterministic time step much bigger mean stochastic time step ssa. then number times reaction ﬁred time interval sampled poisson distribution parameter since poisson random variables unbounded algorithm might result negative populations. overcome problem non-negative version -leaping algorithm proposed algorithm identiﬁes critical reactions ﬁrings exhausting reactants. critical reaction occur within time leap multiple non-critical reactions allowed. critical reaction handled non-critical reactions modelled -leaping method. several methods introduced computation leap length eﬃcient selects adaptive version -leaping algorithm introduced automatically alternates explicit implicit -leaping algorithm. implicit -leaping algorithm inspired implicit euler method diﬀerential equations. ideally would like compute state avoid diﬃculty partial implicit approach introduced random variable follows poisson distribution mean expressed random variable mean zero mean random variable implicit methods diﬀerential equations unconditionally stable time step implicit leaping methods bounded leap condition computation implicit leap step condition partial equilibrium introduced assumption reaction channels equilibrium close partial equilibrium change propensities would small. thus dynamics system would driven reactions outside equilibrium implicit time step computed general diﬃcult detect reaction channels currently partial equilibrium however easily detected reversible reactions denote pair reversible reactions corresponding propensity functions reaction partial equilibrium propensities must similar r-leaping algorithm instead prescribing time-step imposes total number reactions ﬁred next time interval. leap condition number ﬁrings computed approach requires drawings random numbers since furthermore shown sampling procedure invariant permutation reaction channels indices fact exploited reduce number samples drawn time step reordering reactions indices probable reactions channels sampled ﬁrst. r-leaping algorithm summarised algorithm sampling reaction channels bounded binomial distribution reduces appearance negative species compared sampling unbounded poisson distribution. however systems involving species population close zero taking place fast reactions r-leaping algorithm might also introduce negative population. control appearance negative population additional bounding condition proposed systems high rejection rates proposed state update total number ﬁrings computed given here propose s-leaping algorithm combines advantages -leaping r-leaping algorithms. s-leaping couples eﬃcient time step selection -leaping eﬀective binomial sampling r-leaping algorithm. coupling algorithms achieved following way. first time-step selected according total number ﬁrings take place time interval estimated. since -leaping reaction channel independently knowing number reactions take place ﬁrings channel sampled binomial distribution given sampled zero means system advance time without changes since reaction ﬁred. case system advanced setting proceeding s-leaping algorithm. notice step since distribution parameters equal exponential distribution parameter s-leaping algorithm summarised algorithm control appearance negative species s-leaping algorithm inherit control mechanism -leaping r-leaping. bound similarly r-leaping method. systems high rejections rates total amount ﬁrings computed given chosen time step recomputed thanks coupling algorithms s-leaping performs always well -leaping r-leaping algorithm. non-stiﬀ systems s-leaping beneﬁts eﬃcient time step selection might outperform r-leaping method. hand case stiﬀ systems s-leaping surpasses -leaping eﬀective sampling reaction channels. moreover since behaviour system might change time s-leaping outperform r-leaping leaping. finally since s-leaping uses time-step selection -leaping algorithm easily extended adaptive explicit-implicit version. implicit -leaping algorithm ﬁring independently approximated partially implicit formulation given directly applied s-leaping since sample depends previ partially implicit treatment ously drawn samples s-leaping obtained rather considering distribution whole vector ﬁrings i.e. multinomial distribution j-th entry random vector follows multinomial distribution expressed variable evaluated unknown state varia able evaluated known state partial implicit approximation variables leads following system implicit equations since multinomial random vectors depend known state since j-th element multinomial distribution follows binomial distribution computed however also random variable poisson distribution parameter evaluated unknown state corresponds computation r-leaping method. advantage mean approximation signiﬁcantly reduces numerical complexity implicit system partial implicit approximation provided would increase complexity even more. since dealing stiﬀ system increased complexity could reduce accuracy numerical methods used solving implicit system equations. solution implicit system implicit update obtained means both implicit -leaping implicit s-leaping algorithm solve implicit system computational complexity. however since implicit s-leaping exploit reordering reaction channels might result less random number generations implicit -leaping might allow implicit sleaping outperform implicit -leaping especially large stiﬀ systems reaction channels ﬁred time step. adaptive sleaping method summarised algorithm demonstrate eﬃciency s-leaping algorithm studied comparison -leaping r-leaping methods four reaction networks. ﬁrst non-stiﬀ system simulating decaying dimerization. second system stiﬀ decaying dimerization reversible reaction channels partial equilibrium. third system fast dynamics simulating evolution bacillus subtilis. last lacz/lacy system consists relatively large amount reactions stiﬀness change time. reaction network algorithm measure quantities error execution time algorithm. error measured follows. equally distributed time points species estimate distance distributions tested algorithm since methods advance system ﬁxed time step population given time approximated population closest time algorithm landed. distance distributions approximated estimated histogram size values histogram k-th bin. histogram computed using independent trajectories number bins. finally average error time points species reported. deﬁnition error interpreted global error since accounts temporal interspecies error algorithm. averaging error many time points takes account error equilibrium transient regimes well. histogram self-distance introduced measure accuracy histogram distance estimation. estimate bellow value selfdistance considered inaccurate. bound self-distance execution time averaged independent runs. ratio between execution time execution time algorithm reported speed-up. note used reference order compare relative speed-up three approximate algorithm rs-leaping. execution times three methods compared using reference execution time ssa. hence changing base implementation aﬀect comparisons results. moreover since report speed-up baseline rather time presented results depend type used computer. reaction networks discussed section follow mass action states rate reaction proportional product following test consider non-stiﬀ decaying dimerization system summarised table initial populations system evolved tend using fig. show convergence histograms approximate algorithms second species time approximate methods converge solution accuracy parameter decreases. fig. shows accuracy performance leap methods diﬀerent accuracy parameter system leaping methods comparable accuracy performance. additional speed-up obtained reordering reaction channels r-leaping s-leaping since step simulation reaction channels ﬁred. study eﬃciency adaptive s-leaping method consider stiﬀ decaying dimerization system studied system deﬁned reactions initial conditions section table stiﬀness arises reaction rates vary orders magnitude. behaviour system changes time starting non-stiﬀ phase. however reversible reactions approach equilibrium system becomes stiﬀ. fast variables slow variable. system evolved ﬁnal fig. present accuracy performance adaptive leaping adaptive s-leaping well explicit r-leaping -leaping s-leaping. explicit methods reach comparable accuracy performance. adaptive methods provide signiﬁcant speed-up explicit counterparts. reduced accuracy adaptive methods arise dumping eﬀect implicit methods fast variables. reported implicit schemes capture distribution slow variable correctly. however fast variables mean computed correctly histogram distribution around mean narrow. downshifting strategy proposed restore natural ﬂuctuations fast variables simulating ﬁnal time steps adaptive method explicit method. shown downshifting leads correct histogram distributions variables ﬁnal time. since downshifting procedure corrects dumping eﬀect ﬁnal time global error adaptive method reduced level explicit methods. since report global error downshifting strategy applied here. however downshifting procedure used increase accuracy adaptive -leaping adaptive s-leaping method ﬁxed time point. systems describes cellular diﬀerentiation dynamics bacillus subtilis exhibits stochastic behaviour single-cell level diﬀerentiation dynamics depends expression transcriptional genes s=spoa s=comg s=sini reaction network presented table system evolved ﬁnal time tend initial population fig. shows single realisation bacillus subtilis system computed ssa. system exhibits diverse reaction rates fast dynamics. consequence leap methods strongly restricted leap condition provide additional speed-up ssa. table shows average number steps executed method averaged time r-leaping algorithm advances system reaction time step emulating ssa. moreover -leaping executes times steps ssa. system s-leaping method requires less steps ssa. since case leap methods provide additional speed alone would best choice. example however shows s-leaping maintains performance even fast dynamical systems outperforms leap methods. methods reach comparable accuracy shown fig. section consider lacz/lacy model describes expression lacz lacy genes activity lacz lacy proteins escherichia coli reaction network consists reactions species. present reaction network along reaction rate reaction table propensity functions system vary orders magnitude making system stiﬀ. moreover reaction system considered inside growing cell generation time tgen growing volume changes stiﬀness system time since propensities second higher order reactions rescaled volume. consider diﬀerent initial conditions. ﬁrst case assume small initial population species initially except plac=. second case consider bigger initial populations species initialized plac=. addition number species rnap ribosome small initial population investigate behaviour methods presence negative population behaviour without appearance negative populations studied system bigger initial population. system small initial population simulated tend since none reversible reactions approached partial equilibrium time interval explicit methods reported. control appearance negative species -leaping algorithm used control parameter s-leaping r-leaping used suggested comparison purposes three methods also considered withcontrol mechanism. frequency reordering r-leaping s-leaping proposed fig. shows speed-up leap methods tend single evaluation time tend takes around making evaluation models accuracy time point computationally expensive. instead fig. reports error methods time interval system error averaged species trlacz trrbslacz rbsribsomelacy. -leaping algorithm presented algorithm executes mainly steps provides almost speed ssa. therefore turned execution reported -leaping algorithms. leap methods without control mechanism provide better speed-up however accuracy reduced high rejection rate. sampling reaction channels correlated binomial distribution r-leaping s-leaping leads lower rejection rate comparison -leaping also reﬂected lower accuracy -leaping method. control mechanisms leap methods results high accuracy cost slightly reduced performance. error reported fig. relatively constant scale since accuracy leap methods mainly restricted mechanism preventing appearance negative species. s-leaping reached comparable accuracy rleaping since similar control mechanisms. hand -leaping considers reactions critical thus advance lead higher accuracy. r-leaping s-leaping algorithms beneﬁt reordering reaction channels outperform -leaping. moreover since stiﬀness system changes time s-leaping outperforms methods. system initial population evolved time tend before -leaping steps performs mostly therefore step disabled. since species appear relatively large populations leap methods considered without control negative population. performance accuracy methods shown fig. s-leaping algorithm outperforms -leaping r-leaping method combined advantages inherited methods. ribosome rbslacz rbsribosomelacz rbsribosomelacz ribosome rbslacz ribosome rbslacy rbsribosomelacy rbsribosomelacy ribosome rbslacy rbsribosomelacz trrbslacz rbslacz rbsribosomelacy trrbslacy rbslacy paper introduced s-leaping approximate algorithm accelerating ssa. algorithm combines advantages main approximate algorithms -leaping r-leaping. more s-leaping exploits eﬃcient sampling procedure rleaping reduce appearance negative species. moreover reordering reaction channels inherited r-leaping leads better performance s-leaping compared -leaping stiﬀ systems. hand stiﬀ system involves reversible reactions appearing close equilibrium implicit approach derived -leaping accelerates s-leaping orders magnitude comparison explicit methods. performance proposed algorithm tested several examples including stiﬀ non-stiﬀ system involving slow fast reactions species appearing populations close zero. test cases accuracy s-leaping similar accuracy accelerated methods. performance s-leaping comparable fastest method even outperform both -leaping r-leaping methods. s-leaping thus consider optimal adaptive coupling r-leaping -leaping method. future work directions involve extension s-leaping algorithm systems spatial component using compartment-based approach brownian dynamics models extend simulation framework reaction-diﬀusion processes arise many biological systems. gratefully acknowledge support european research council advanced investigator award authors thank anonymous reviewers insightful comments helped improve content paper.", "year": "2018"}