{"title": "Linking resource selection and step selection models for habitat  preferences in animals", "tag": "q-bio", "abstract": " The two dominant approaches for the analysis of species-habitat associations in animals have been shown to reach divergent conclusions. Models fitted from the viewpoint of an individual (step selection functions), once scaled up, do not agree with models fitted from a population viewpoint (resource selection functions). We explain this fundamental incompatibility, and propose a solution by introducing to the animal movement field a novel use for the well-known family of Markov chain Monte Carlo (MCMC) algorithms. By design, the step selection rules of MCMC lead to a steady-state distribution that coincides with a given underlying function: the target distribution. We therefore propose an analogy between the movements of an animal and the movements of a MCMC sampler, to guarantee convergence of the step selection rules to the parameters underlying the population's utilisation distribution. We introduce a rejection-free MCMC algorithm, the local Gibbs sampler, that better resembles real animal movement, and discuss the wide range of biological assumptions that it can accommodate. We illustrate our method with simulations on a known utilisation distribution, and show theoretically and empirically that locations simulated from the local Gibbs sampler give rise to the correct resource selection function. Using simulated data, we demonstrate how this framework can be used to estimate resource selection and movement parameters. ", "text": "dominant approaches analysis species-habitat associations animals shown reach divergent conclusions. models ﬁtted viewpoint individual scaled agree models ﬁtted population viewpoint explain fundamental incompatibility propose solution introducing animal movement ﬁeld novel well-known family markov chain monte carlo algorithms. design step selection rules mcmc lead steady-state distribution coincides given underlying function target distribution. therefore propose analogy movements animal movements mcmc sampler guarantee convergence step selection rules parameters underlying population’s utilisation distribution. introduce rejection-free mcmc algorithm local gibbs sampler better resembles real animal movement discuss wide range biological assumptions accommodate. illustrate method simulations known utilisation distribution show theoretically empirically locations simulated local gibbs sampler give rise correct resource selection function. using simulated data demonstrate framework used estimate resource selection movement parameters. keywords resource selection function step selection function habitat selection space animal movement markov chain monte carlo utilisation distribution understanding animals landscape response habitat composition crucial question pure applied ecology. insights achievable confronting species-habitat association models usage data collected either transect surveys biologging methods. statistical inference link data environmental variables approached population perspective using resource selection functions alternatively individually referenced data available question addressed viewpoint single animal step selection functions population/individual dichotomy between approaches always clear-cut rsfs applied utilisation distribution single animals ssfs combine joint insights multiple individuals. nevertheless methods roughly fall opposite ends eulerianlagrangian spectrum outlined turchin therefore researchers area tended think habitat preference parameters obtained ssfs microscopic rules movement corresponding parameters implicitly thought macroscopic patterns obtained long term. hence models increasingly concerned geometry movement trajectories predictions often make pseudo-equilibrium assumption biological term reminiscent mathematical idea steady-state distributions. herein lies fundamental problem entire ﬁeld statistical analysis. correctly formulated framework movement must work across scales that microscopic rules individual movement scaled space time give rise expected macroscopic distribution population. however analytical numerical evidence distribution constructed coeﬃcients match spatial predictions ﬁtted data. here explain discrepancy arises propose solution. proportional probability unit habitat used depending type usage data available rsfs derived steps. first model ﬁtted response explanatory data. example point process model use-availability logistic regression used telemetry data log-linear regression used count data regular grids line transects. second irrespective type response data model ﬁtting method linear predictor resulting statistical model transformed non-negative function common exponential functions associate spatial location corresponding covariate values study region. utilisation distribution normalized denominator equation ensure deﬁnes valid probability distribution hence lack intercept linear predictor. although encompass wider range environmental conditions covariates often called resources context. following covariates resources interchangeably. approaches commonly used estimate apparent eﬀect spatial covariate species. resource selection coeﬃcients characterize eﬀect covariates discussion interpretation terms selection strength). however recent work shown interpretations highly sensitive context organisms studied particular availability habitat types animals thus framework deﬁnition habitat availability determined assumptions spatial accessibility important deducing preference observed usage. example using rsfs analyse time series positions ranging animal plausible assume locations home range accessible animal every step approaches often forced treat non-independence statistical nuisance step selection approaches treat asset. forester describes density endpoints step starting absence resource selection. link movement environmental covariates modelled using log-linear link given equation context term step selection function often used however note sometimes used whole numerator right-hand side equation following call ssf. choice function characterizes accessibility hence determines availability step selection model; corresponds distribution feasible steps time interval origin resources aﬀect movement. example uniform distribution disc around current location obtained empirical distributions movement metrics deﬁnes movement model equivalent biased correlated random walk bcrws routinely used ecology ﬂexible basis models individual movement avgar extended step selection approach allow simultaneous inference habitat selection movement process making attractive framework estimate habitat preference movement data step selection models used analyse impact landscape features animal space well animal interactions although typically described notation used purpose estimating habitat preference shown steadystate predictions generally coincide. known utilisation distribution signer showed empirically normalized diﬀered utilisation distribution. particular diﬀerence greater narrow compared scale habitat features. similarly barnett moorcroft showed that step selection model deﬁned equation steady-state distribution animal’s location given steady-state distribution model generally proportional discrepancy crucially depends choice resource-independent movement kernel example earlier result speciﬁc assumptions steady-state distribution approximately proportional square ssf. although seem disconcerting approaches lead diﬀerent estimates cause apparent paradox partly notational misuse symbol eﬀect diﬀerent objects. captures local aspects animal’s movement considers neighbourhood current location animal becomes better approximation scale increases parameters objects coincide limiting case unconstrained mobility i.e. availability assumed methods global. however every case methods diﬀerent. schl¨agel lewis also noted that unlike models standard ssfs scale-dependent habitat selection estimates depend time scale observations several approaches suggested approximate steady-state distribution movement models. particular avgar signer showed simulations ﬁtted could used obtain estimates underlying utilisation distribution. similarly potts described numerical method compute utilisation distribution given equation generally closed form expression. approaches useful predict space ssfs allow steady-state distribution locations modelled simple parametric form equation important consequence that utilisation distribution rather seeking equivalence parameters estimated methods better question assumptions parameters estimated lead movement scales distribution yielded parameters model? section reconcile resource selection step selection conceptually step selection model long-term distribution locations guaranteed proportional rsf. method uses analogy movement animal geographical space movement markov chain monte carlo sampler parameter space. section make concepts applicable practice developing family mcmc algorithms considerable potential encompassing realistic movement assumptions. section illustrate method using simulations known utilisation distribution. verify distribution simulated locations corresponds correct present proof-of-concept analysis demonstrate potential method estimating resource selection coeﬃcients parameters movement process telemetry data. mcmc methods general framework sample probability distribution termed target distribution approach mostly used bayesian inference sample distribution unknown parameters includes wide class algorithms among widely-used metropolis-hastings gibbs samplers. mcmc algorithm describes steps generate sequence points whose long-term distribution target distribution. mcmc algorithm deﬁned transition kernel determines point sampled given example metropolis-hastings algorithm transition kernel combination proposal distribution acceptance probability propose analogy animal’s observed movement n-dimensional geographical space movement mcmc sampler n-dimensional parameter space target distribution utilisation distribution. consider tracked animal samples spatial locations short term movement model long utilisation distribution mcmc algorithm samples points short term transition kernel long term target distribution. mcmc algorithm deﬁnes movement model steady-state distribution known. dynamics movement process described transition kernel algorithm that time point next location sampled properties mcmc samplers steady-state distribution utilisation distribution modelled deﬁned equation link target distribution movement model distribution resources. mcmc algorithm viewed movement model used analyse animal tracking data following steps. although focus step paper illustrate steps simulated example section write likelihood model. mcmc movement model likelihood observed step function resource selection coeﬃcients parameters sampler given transition kernel framework choice mcmc algorithm determines movement model. example metropolis-hastings model diﬀerent proposal distributions might capture diﬀerent features animal’s movement. parameters algorithm usually regarded tuning parameters parameters movement process. example variance proposal distribution thought measure animal’s speed. important make distinction parameters movement parameters target distribution diﬀerent samplers might target distribution rate approached mcmc samples depend choice algorithm. indeed part success mcmc bayesian context ﬂexibility choosing transition kernel given target distribution. suitability mcmc sampler usually assessed speed convergence simulated samples target distribution. however application want algorithm corresponding realistic model movement addition correct target distribution. could happen mcmc algorithm describes animal movement realistically slow rate convergence target distribution. would merely mean animal observed time step observations sample eﬃciently utilisation distribution. case inference utilisation distribution would limited regardless modelling framework used. rejection-based mcmc algorithms metropolis-hastings relocation proposed time step accepted probability. proposed step accepted process remains location. although happen tagged animal immobile several time steps many telemetry data sets include rejections. classic mcmc algorithms might thus seem unnatural choice analyse data animal almost always change position process sampling candidate location. circumvent problem design rejection-free mcmc algorithm section standard metropolis-hastings samplers require rejection step ensure convergence target distribution. viewing movement model would imply unlikely scenario return animal previous position tested rejected relocation. instead natural think tracking data outcome rejection-free sampler. several algorithms possible; discussion. here describe algorithm call local gibbs sampler. classic gibbs sampler ‘step’ involves updating parameters keeping ﬁxed; values chosen systematically randomly. thus step move within one-dimensional subspace parameter space rather whole space. used target distribution one-dimensional space mathematically tractable used transition kernel step acceptance probability guaranteed local gibbs sampler uses idea sampling restricted part target distribution iteration updated parameter sampled directly target distribution truncated neighbourhood neighbourhood selected crucial ensuring algorithm samples required target distribution long run. local gibbs sampler parameter radius relocation disc. here simplicity consider case ﬁxed algorithm would still work generated independently iteration probability distribution. using analogy introduced section animal movement mcmc sampling local gibbs algorithm used basis model animal movement habitat selection call local gibbs model. relies assumption animal samples locations utilisation distribution based step selection rules described above. local gibbs model parameter determines size area available animal time step. step selection analyses region availability simplistic useful model combination animal’s mobility perception. taking normalized local gibbs algorithm deﬁnes step selection model distribution animal’s space guaranteed proportional rsf. indeed satisﬁes detailed balance condition shown follows. given local gibbs model superﬁcially similar availability radius model rhodes ﬁrst introduced arthur model time step next location sampled truncated scaled disc centred step algorithm described above take means mechanism approach guarantee overall distribution sampled locations rsf. speciﬁcally sides detailed balance equation involve diﬀerent normalization constants movement models normalized equilibrium distributions. reason coeﬃcients estimate diﬀer resource selection coeﬃcients estimated approach. distance area absence environmental eﬀects relative probability step proportional a∩dr). construction hence detail derivation given appendix graph density function shown figure transition kernel given equation plotted figure describes distribution steps absence habitat selection case radius parameter ﬁxed. ﬂexible movement model obtained taking time-varying drawn time step probability distribution figure resource-independent transition kernel local gibbs sampler ﬁxed radius parameter axis shows distance origin point axis shows density endpoint xt+. known rsf. truncation disc requires calculation normalizing constant generally possible derive analytically monte carlo sampling used approximate practice sample truncated here illustrate method described section local gibbs sampler. section show algorithm produce movement tracks known utilisation distribution section illustrate local gibbs movement model estimation resource selection movement parameters simulated data. code used simulations available supplementary material figure illustration local gibbs sampler dimensions. background rsf; solid line simulated track time cross current location circle delimits next location sampled black dots probabilities section demonstrate local gibbs algorithm described section used sample given probability distribution. considered utilisation distribution deﬁned section analyse behaviour local gibbs sampler diﬀerent spatial scales three simulations three diﬀerent values radius movement kernel value aﬀects range comparison also illustrate results barnett moorcroft steady-state distribution standard model diﬀers normalized ssf. sampled movement track step selection model uniform sampling deﬁned forester denote ssfunif. simulated locations ssfunif follows. started then time step generated proposed locations uniformly disc radius centred next location sampled proposed locations point probability picked proportional simulate uniform sampling model. here chose gave rise approximately mean step length local gibbs sampler ﬁrst steps simulated track density simulated points shown figure density points simulated local gibbs sampler displays patterns true contrast density locations obtained ssfunif simulation fails capture many features landscape process spends disproportionate amount time areas high values compare empirical distribution simulated points distribution used simulations plotted count locations simulated grid cell corresponding value comparison presented figure alignment identity line indicates similarity empirical distribution three local gibbs simulations points align well identity line particular experiments speed spatial exploration higher conﬁrms local gibbs algorithm sample movement trajectories given target distribution. deﬁnes movement model long-term distribution locations known. however plot ssfunif simulation reveals clearly non-linear relationship density simulated points normalized ssf. conﬁrms results barnett moorcroft avgar signer coeﬃcients step selection function measure underlying steady-state distribution. parameters measure local habitat selection.) illustrated local gibbs sampler generate movement tracks converge distribution underlying rsf. figure simulation using local gibbs sampler radius parameter simulation using step selection function uniform sampling left column displays ﬁrst simulated steps background colour represents utilisation distribution compared distribution used simulations local gibbs simulations denotes ssfunif simulation denotes ssf. represents value associated grid cell. closer dots identity line similar empirical distribution local gibbs simulations empirical distributions similar rsf; similarity increases larger radius leads faster spatial exploration. ssfunif model clear discrepancy empirical distribution predicted barnett moorcroft approach introduced section shows great promise estimation movement resource selection parameters observed animal movement data. considering mcmc algorithm movement model principle straightforward express likelihood observed steps given parameters sampler cases transition kernel chosen sampler calculated likelihood observations section wish demonstrate practical application example local gibbs model. simulated track locations local gibbs sampler deﬁned section then similarly real analysis used local gibbs model recover estimates movement data covariate rasters. likelihood observed track local gibbs model obtained details derivation given appendix likelihood function movement parameter coeﬃcients maximum likelihood techniques used obtain parameter estimates. implemented likelihood function equation used numerical optimiser nlminb maximum likelihood estimates results summarized table figure alignment dots identity line indicates estimated utilisation distribution captures shape true utilisation distribution well. addition parameter movement process successfully estimated figure utilisation estimates obtained simulated track using local gibbs model. corresponds grid cell. axis shows value true utilisation distribution axis shows value estimated utilisation distribution grid cell. presented versatile class models animal movement steadystate distribution locations proportional resource selection function inﬂuences short-term movement. approach reconciles resource selection step selection approaches analysis space data. anticipate resolution discrepancy models important implications study individual movement also species distributions. central point paper idea multiscale modelling dynamic system achieved using stochastic processes short-term transition density long-term stationary distribution explicitly formulated although presented method analysis animal movement resource selection expect underlying idea could ecological applications. example problem reminiscent population genetics microscopic heritability laws macroscopic allele frequencies interest. level individual recognised tendency current literature embed increasingly realistic movement models analyses. hazard subtext trend intuitive notion habitat selection coeﬃcients models stay faithful movement biology automatically correspond estimates models. argued demonstrated here necessarily case coeﬃcients measure local habitat selection rather long-term space use. conversely given population distribution achievable multiple movement models simplest movement models degree population diﬀusivity achieved inﬁnity diﬀerent movement rules simply trading individual speed path sinuosity. although meticulous realism movement turns strict requirement achieving agreement microscopic macroscopic models space paper demonstrates ssfs might future used learn movement biology. manuscript serves proof concept approach stops short describing complete workﬂow analysis animal location data. section using simulated data explained local gibbs model used estimate resource selection movement parameters movement track. real data analysis would necessary investigate goodness-of-ﬁt. possibility would simulate many locations ﬁtted local gibbs sampler compare simulated observed data terms metrics movement discrepancies features true simulated data sets would point possible model misspeciﬁcations. addition diﬀerent models individual movement described diﬀerent mcmc algorithms guaranteed scale long-term distribution allowed compete setting statistical model selection pointing parsimonious explanations movement observations. estimation framework introduced section likelihood-based model selection criteria could used compare several candidate models. likelihood derived mcmc movement model accounts serial correlation found telemetry data. such defensible measure likelihood might obtained approaches modelling framework combines advantages process-based movement models distribution-based resource selection models. addition advantages individual-level inference prospect reconciliation approaches also beneﬁt population-level results. particular problem formally combining major sources space-use information telemetry transect data experience resisted several analytical attempts. approach proposed oﬀers solution problem joint inference. example steady-state distribution implied ﬁtted telemetry data would required coincide utilisation distribution generated ﬁtting independently obtained transect data. described section likelihood track mcmc movement model transition framework likelihood lind isolated survey locations obtained using standard methods types data combined multiplying lmov lind thus enhancing eﬀective sample size resulting estimates. incorporating additional constraints example survey conﬁned subregion also straightforward. builds wide ﬂexible class mcmc samplers various movement rules could considered. slice sampler existing rejectionfree sampler shares mathematical details local gibbs sampler ‘local’ version give additional ﬂexibility movement modelling. models animal movement often incorporate directional persistence discrete-time continuoustime correlated random walks within framework described feature movement could modelled using nonreversible mcmc samplers often display type autocorrelation algorithms could used realistic movement models. although focused case radius parameter local gibbs algorithm taken constant allowing stochastic straightforward mentioned above. ﬂexibility model depends part choice distribution. realistic features animal movement diﬀerent distributions step lengths could thus incorporated local gibbs sampler choosing ﬂexible parametric distribution reﬁnement would combine approach state-space modelling framework state process representing true location thus incorporating measurement error locations giving robustness errors measurement classiﬁcation registration habitat map. present paper therefore opens future research three vital directions exploration wealth biological models implemented mcmc analogues development inferential methods integrated analysis diﬀerent data types investigation population-level space arises individual rules movement. supported centre advanced biological modelling university sheﬃeld funded leverhulme trust award number ds--. thank jonathan potts fruitful discussions earlier version manuscript associate editor reviewers whose suggestions greatly improved presentation work.", "year": "2017"}