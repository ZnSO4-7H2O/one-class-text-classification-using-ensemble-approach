{"title": "Joint Spatial-Angular Sparse Coding for dMRI with Separable Dictionaries", "tag": "q-bio", "abstract": " Diffusion MRI (dMRI) provides the ability to reconstruct neuronal fibers in the brain, $\\textit{in vivo}$, by measuring water diffusion along angular gradient directions in q-space. High angular resolution diffusion imaging (HARDI) can produce better estimates of fiber orientation than the popularly used diffusion tensor imaging, but the high number of samples needed to estimate diffusivity requires longer patient scan times. To accelerate dMRI, compressed sensing (CS) has been utilized by exploiting a sparse dictionary representation of the data, discovered through sparse coding. The sparser the representation, the fewer samples are needed to reconstruct a high resolution signal with limited information loss, and so an important area of research has focused on finding the sparsest possible representation of dMRI. Current reconstruction methods however, rely on an angular representation $\\textit{per voxel}$ with added spatial regularization, and so, for non-zero signals, one is required to have at least one non-zero coefficient per voxel. This means that the global level of sparsity must be greater than the number of voxels. In contrast, we propose a joint spatial-angular representation of dMRI that will allow us to achieve levels of global sparsity that are below the number of voxels. A major challenge, however, is the computational complexity of solving a global sparse coding problem over large-scale dMRI. In this work, we present novel adaptations of popular sparse coding algorithms that become better suited for solving large-scale problems by exploiting spatial-angular separability. Our experiments show that our method achieves significantly sparser representations of HARDI than is possible by the state of the art. ", "text": "diﬀusion provides ability reconstruct neuronal ﬁbers brain vivo measuring water diﬀusion along angular gradient directions q-space. high angular resolution diﬀusion imaging produce better estimates ﬁber orientation popularly used diﬀusion tensor imaging high number samples needed estimate diﬀusivity requires longer patient scan times. accelerate dmri compressed sensing utilized exploiting sparse dictionary representation data discovered sparse coding. sparser representation fewer samples needed reconstruct high resolution signal limited information loss important area research focused ﬁnding sparsest possible representation dmri. current reconstruction methods however rely angular representation voxel added spatial regularization non-zero signals required least non-zero coeﬃcient voxel. means global level sparsity must greater number voxels. contrast propose joint spatial-angular representation dmri allow achieve levels global sparsity number voxels. major challenge however computational complexity solving global sparse coding problem large-scale dmri. work present novel adaptations popular sparse coding algorithms become better suited solving large-scale problems exploiting spatial-angular separability. experiments show method achieves signiﬁcantly sparser representations hardi possible state art. diﬀusion magnetic resonance imaging medical imaging modality used analyze neuroanatomical biomarkers brain diseases alzheimer’s. dmri signals consisting spatial volumes acquired k-space weighted diﬀerent diﬀusion signal measured q-space. voxel brain dmri q-space diﬀusion signals reconstructed estimate orientations integrity neuronal ﬁber tracts vivo. diﬀerent dmri protocols measure q-space diﬀerent ways. example diﬀusion spectrum imaging measures q-space densely grid. alternatively diﬀusion tensor imaging simpliﬁes acquisition modeling gaussian distribution unit q-sphere. high angular resolution diﬀusion imaging also restricts measurements unit sphere increases angular resolution dti. multi-shell hardi expands radial range include multiple spheres shells. since collects fewest number measurements become widely used clinical dmri protocol. however simple tensor model unable capture complex diﬀusion proﬁles voxel. hand protocols like hardi ms-hardi especially collect higher number q-space measurements estimate accurate diﬀusion proﬁles expense longer scan times making currently unsuitable clinical studies. ongoing research goal ways reduce acquisition times hardi mshardi maintaining accurate estimations diﬀusion. avenue hardware perspective maintain dense signal measurement conﬁgurations devising faster physical acquisition techniques like simultaneous multi-slice acquisition simultaneous image refocusing signal processing perspective maintain accurate signal reconstructions devising methods exploit redundancies data reduce number required measurements accelerate acquisition. paradigm known compressed sensing class mathematical results algorithms exploits sparse representations signals discovered sparse coding obtain extremely accurate reconstructions sub-nyquist rates. classical application accelerate structural subsampling spatial frequency domain k-space known k-space k-cs. ideas also previously applied dmri subsampling angular frequency domain q-space recently subsample kq-space commonly called -space increase acceleration. however goal dmri reconstruction estimate diﬀusivity proﬁles voxel dmri signals traditionally represented voxel-wise q-space signals angular domain. spatial regularization important technique used improve estimations entire dmri volume underlying data representation dmri still angular local voxel. therefore applying sparse coding dmri sparsest possible global representation entire volume less number voxels since least dictionary atom would required model q-space signals voxel. overcome fundamental limitation propose global spatial-angular representation dmri allows global sparsity levels fall atom voxel exploiting redundancies spatial angular domains jointly global dictionary. major challenge however optimizing global dictionary computational complexity solving massive global sparse coding problem large-scale dmri data. imposing global dictionary separable spatial angular domains greatly improve computational eﬃciency preserving good sparsity levels typical signals. main contributions paper novel adaptations popular sparse coding algorithms solve general large-scale sparse coding problems using separable dictionaries. experiments phantom real hardi brain data show possible achieve accurate global hardi reconstructions sparse representation less dictionary atom voxel exceeding theoretical limit state sparse coding. sparse coding many important applications like de-noising dictionary learning super-resolution particular applying joint spatial-angular sparse coding framework within application subject future work. remainder paper organized follows section review state-of-the-art sparse coding methods dmri illustrate limitations performance phantom hardi dataset. section present joint spatial-angular dmri representation formalize global spatial-angular sparse coding problem. then section develop compare novel sparse coding algorithms using separable dictionaries eﬃciently solve large-scale global optimization. finally section provide experimental results showing performance method state-of-the-art conclude discussion section common view-point dmri processing analysis voxel-wise i.e.for voxel acquire vector diﬀusion measurements points q-space. latter interpretation common modeling major goal dmri reconstruction estimate probability distribution functions ﬁber tract orientation voxel. accordingly signal vector represented q-space basis atoms vector angular coeﬃcients voxel dmri literature produced wide array dmri reconstruction algorithms diﬀerent acquisition protocols artillery q-space bases varying models estimating orientation distributions. vast majority research reconstructs q-space signals voxel q-space basis comprehensive summary comparison state reconstruction frameworks). enforce exploit desirable properties dmri signals many methods constraints sparse coding reconstruction problem seeks sparse representation i.e. coeﬃcient vector nonzero elements. given sparsifying q-space basis dmri signal voxel expected sparse representation angular sparse coding problem formulated voxel problem known np-hard therefore main methodologies tackle approximate solution using greedy algorithms orthogonal matching pursuit tropp replace semi-norm convex relaxation norm solve either basis pursuit lasso problem given important application sparse coding dmri community angular sparse coding q-cs widely researched dmri reduce long acquisition times. many groups done extensive work choosing sparsifying q-space bases developing dictionary learning methods testing q-space subsampling schemes ms-hardi hardi promising results sparsity measurement reduction clinical tractography however major limitation family methods sparsest possible representation entire dmri dataset fundamental limitations amount subsampling factors achievable q-space. practice spatial-angular sparsity level much greater number voxels account noise. example work report average sparsity level atoms voxel. methods presented next section attempt improve upon results exploiting spatial redundancies reducing measurements k-space. incorporating spatial information voxel-wise reconstruction well utilized technique increasing accuracy reconstruction. following general formulation including spatial regularization angular sparse coding problem rg×v concatenation signals sampled gradient directions voxels rnγ×v concatenation angular coeﬃcients |xij| spatial regularizer depends angular representation ||x||f |xij| -norm taken elements matrix. particular reduces solving voxel. local spatial neighborhood found incorporating angular sparsity constraint λ||a|| spatial coherence spatial regularization within sparse coding prominently used application reducing redundancies example enforce spatial smoothing q-cs combine q-cs super-resolution reconstruction spatial domain. accelerate dmri recent work combines parallel imaging reconstructs signals k-space q-space separately sequence. joint -space reconstruction important maintaining coherence throughout dataset. such works combine kq-cs adding data ﬁdelity term k-space subsampling additional spatial sparsity term. total however works applied diﬀerent diﬀusion models acquisition protocols testing various subsampling schemes sparsifying transforms dictionaries based angular representation dmri data fact stem optimization problem formulation dictionary) applied spatial domain wavelets ﬁnite diﬀerence gradient operator leading usual total variation norm. reconstruction signal based angular representation level still limited size data since ||a|| greater ||ψ|| greater indeed ||a|| must exist voxels leading zero valued signal voxel. likewise ||ψ|| must exist gradient directions signal entire volume equals zero. becomes problem zero valued signals physically representative real dmri data. also becomes heuristic limitation prior methods appropriately choosing trade-oﬀ parameters result physically accurate sparsity level. next section explicitly show limitation sparsity phantom hardi data. table organizes recent literature’s usages sparse coding dmri places proposed work context compared state art. term spatial angular sparse coding emphasize state perform spatial angular sparse coding jointly. important note though frame proposed sparse coding method table backdrop propose implement current manuscript. figure qualitative demonstration state-of-the-art sparse coding limitations spherical ridgelets dictionary diﬀerent spatial-angular sparsity levels compared original signal closeups underneath. high spatial-angular sparsity levels voxels complex signals forced zero regions crossing ﬁbers unable accurately reconstructed even using average atoms/voxel. label i-sr refers identity-sr explained next section. table summary state-of-the-art dmri sparse reconstruction methods organized domains sparsity subsampling literature provided natural extension k-cs using spatial sparse coding q-cs dmri angular sparse coding. however state enforce sparsity spatial angular domains separately purely angular representation. contrast proposed work considers joint spatial-angular representation sparse coding natural model joint -cs. illustrated table work presented paper sparse coding.) shows estimations sparse signal reconstruction various sparsity levels compared odfs estimated original signal well close-ups region interest containing odfs complex crossings ﬁbers. order compare spatial-angular sparsity levels interested average number active dictionary atoms voxels i.e. ||a||/v diﬀerent values voxel. expected ||a||/v many voxels forced zero many complex signals ﬁber crossing pushed zero. model requires close ||a||/v average atoms voxel achieve nearly accurate signal reconstruction fact actual number coeﬃcients voxel accurately represent typical dmri data angular bases substantially higher. illustrate figure shows number atoms used represent hardi signals voxel reconstructions figure bottom right image shows ground truth number ﬁbers crossing voxel. experiment demonstrates voxels containing crossing ﬁbers forced zero atoms average number atoms voxel small tend atoms accurate reconstruction sparsity level decreased. consistent reports dictionary. figure number atoms found voxel corresponding levels spatial-angular sparsity figure bottom right ﬁgure shows ground truth number ﬁbers crossing voxel illustrate complexity angular signal relation many atoms needed sparsely model them. crossing ﬁber signals either forced zero high spatial-angular sparsity levels require atoms single ﬁber signals double triple crossing ﬁber signals label i-sr refers identity-sr explained experiments section data. cases minimal sparsity accurate reconstruction limit atoms voxel. addition increasing relative weight norm spatial regularization actually results increase angular sparsity given reconstruction error. reconstructed signal cannot improve resulting sparsity solution still represented coeﬃcients voxel angular basis goal paper sparse coding ﬁnding sparsest possible representations full hardi data later experimental comparisons using following section present global spatial-angular representation dmri allows spatial regularization possibility achieve accurate reconstruction sparsity levels number voxels unachievable angular representation alone. figure reconstruction error average number angular dictionary atoms voxel using spatial regularization hardi phantom data. relative weight spatial regularization increases average number angular atoms increases given reconstruction error. suggests sparser solutions angular sparse coding achieved without spatial regularization although using adequate spatial regularizers improve qualitative aspect reconstructed signal particular noisy inputs. single global coeﬃcients global dictionary allows global representations sparsity levels number voxels without forcing voxels zero signal. fact sparsest possible representation would absolute limit nonzero coeﬃcient unrestricted setting global sparse coding. spatial-angular sparse coding problem vectorization stack q-space signals vectorization build global dictionary atoms. then globally voxels q-space measurements total million signal measurements since many sparse coding applications often utilize dictionaries over-redundant leads massive matrix rows columns datasets even committing memory prohibitive. therefore solving large-scale global dmri sparse coding problem using traditional solvers like approximate admm fista solve prove intractable. figure separable spatial-angular dictionary composed kronecker product curvelets spherical ridgelets pair spatial angular atoms highlighted zoomed below. bottom example construction single spatial-angular basis atom taking kronecker separable functions namely atoms form {ϕk} {ψj} spatial basis space functions {γi} angular basis space functions kronecker product. discretized form voxels gradient directions rg×nγ matrix table sparse coding variable dimensions number gradient directions q-space number voxels volume number atoms angular dictionary number atoms spatial dictionary figure illustrates kronecker structure spatial-angular atom representing dmri signal type global spatial-angular atom model entire region brain single atom instead angular atoms every voxel. decomposing signals kronecker structures well researched increase algorithmic eﬃciency reducing computations smaller separate domains. many research groups exploited properties kronecker product solving problem types form computational eﬃciency larger sparse coding dictionary learning applications. work applied multi-tensor sparse coding methods dmri data application ﬁber tract data compression. particular kronecker orthogonal matching pursuit utilized solve although kron-omp becomes much eﬃcient classical problem entirely separated smaller domains computationally expensive matrix still built explicitly. large-scale problems like dmri reconstruction solving even kronecker structure dictionary remains largely intractable/expensive memory computation time. figure equivalent vector form matrix form kronecker decomposition signal. propose matrix form provides compact representation signals large size exploits full separability kronecker product reducing matrix multiplication complexity chapter matrix form allows avoid expensive uses fully reduce computational complexity smaller separable basis domains particular develop eﬃcient algorithms solve completely separable spatial-angular sparse coding problems identity choice experiments section comparing performance purely angular sparse coding proposed framework. note optimization problem coeﬃcient matrix size comparison matrix size state-of-the-art sparse coding leads slight increase dimension problem proportional redundancy factor spatial dictionary hand formulation involves single sparsity penalty comparison angular spatial terms thus reducing number weighting parameters select. follows present three novel adaptations existing sparse coding algorithms solving large-scale sparse coding problems kronecker dictionary structure. kronecker extensions admm fista compare existing kronecker sparse coding algorithms kronecker well kronecker dual admm developed prior work derived formulation comparison paper. compare algorithms terms complexity various types bases section show experimental time comparisons section approximate solution problem orthogonal matching pursuit popular greedy algorithm iteratively selects atom correlated signal orthogonalizes previously selected atoms solving least squares optimization selects next atom correlated resulting residual. case kronecker structured basis kronecker algorithm previously proposed reduces computations solving least squares subproblem iteration exploiting properties kronecker product. form kron-omp however represents signal coeﬃcients basis atoms vector form providing solution real improvement complexity memory since built atom atom columns instead storing entire matrix. rank- update remains vector kron-omp. next section present alternative kron-omp algorithm reduces complexity exploiting full separability dictionary. projection sets elements step-size estimated iteration using line search. procedure converged compute residual rkψj|. save signiﬁcantly computation instead precomputed instead maxij respectively access columns rows. maintaining matrix forms throughout allows combine computing residual next atoms large reduction computation iteration proposed kronecker projected gradient descent outlined algorithm signiﬁcantly less even though sub-routine must performed iteration found incorporating nesterov acceleration line search time iteration remains lower kron-omp number iterations increases. greedy algorithms reach atom/voxel atoms greedy algorithms suitable large-scale problems require hundreds thousands iterations. instead optimizing lasso problem accomplished signiﬁcantly less iterations examine following section. γsψ. minimizing respect usual proximal operator norm given shrinkage operator shrinkκ applied element-wise matrix giving shrinkλ/µ. similarly respect usual lagrange multiplier gradient ascent update zk+. works well under-complete eigen-decompositions easily computable. however dictionaries commonly used sparse coding application over-complete i.e. making svds potentially expensive compute. case over-complete traditional vector admm matrix inversion work proposed kronecker dual admm eﬃciently solves spatial-angular sparse coding problem. below give alternative derivation algorithm directly based matrix formulation dual fast iterative thresholding algorithm another well-known method solving lasso. however before applying fista large-scale dmri data largely intractable. adapt fista order exploit separability spatial-angular basis. fista proximal gradient descent maximum eigenvalues respectively. therefore initialize max. kronecker fista presented algorithm natural kronecker extension fista also recently presented adapted tested data scale. evaluate eﬃciency algorithm gains kronecker separability compared original algorithms summarize complexity algorithm general table notice classical lasso algorithms complexity order size matrix including terms multiply four dimensions nγnψ. applying kronecker lasso algorithms complexity reduced summation includes dimensions reduction order regime. next address fact dimensions rg×nγ orders magnitude diﬀerent since consider speciﬁc assumptions case corresponds well-studied transform wavelets fast transform. curvelets etc. fast transform implementations utilized reduce complexity further. complexity multiplication simpliﬁed another degree vein decrease complexity gained using instead matrix multiplication written using n-mode products tensors furthermore consider acquisition q-space measurements acquired grid assume represent measurements separable basis dimension take becomes perform experiments single-shell hardi data though emphasized earlier framework algorithms applied dmri acquisition protocol suitable choice angular basis experimented phantom real hardi brain dataset. speciﬁcally applied methods isbi hardi reconstruction challenge phantom dataset volume consisting phantom ﬁbers crossing intricately within inscribed sphere measured gradient directions initial experiments test slice data simpliﬁcation. real hardi brain dataset consists minimum. figure reports objective value algorithm function computing time various sparsity levels associated choices table gives number iterations completion method sparsity level. experiments kron-fista appears fastest algorithm cases followed kron-dadmm. superior performance dadmm admm consistent ﬁndings results henceforth kron-fista subsequent experiments. experiments section conducted using ﬁxed spatial angular dictionaries. choice angular dictionary consider over-complete spherical ridgelet basis shown sparsely model hardi signals. corresponding dictionary space odfs spherical wavelets order dictionary contains atoms respectively. used amounts atoms small phantom dataset found roughly identical results suggesting basis order contains enough atoms number gradients reduces computation signiﬁcantly. comparison spherical harmonic basis shown prior work exude sparse signals repeat comparison current work. choice spatial dictionary spatial wavelet transform popular sparsifying basis natural images structural volumes. previous work compared performance daubechies wavelets haar wavelets concluded daubechies wavelets resulted smoothing boundaries isotropic anisotropic regions indicative abrupt boundaries real hardi data exhibits. haar wavelets outperformed daubechies wavelets terms reconstruction error arguably fact figure quantitative results residual error spatial-angular sparsity levels i-sr haar-sr curve-sr phantom data various values curve-sr performs haar-sr sparsity levels i-sr high relative reconstruction error. reconstruction i-sr data points displayed figure haar-sr/curve-sr figure ﬁnding i-sr requiring atoms voxel accurate reconstruction consistent previous ﬁndings hardi data exhibits rigid boundaries piece-wise consistencies spatial feature motivated total-variation penalties many reconstruction methods. reason consider daubechies wavelets work. addition haar wavelets consider spatial curvelets dictionary which addition variations position scale oﬀers directional variations useful sparsely modeling naturally directional hardi ﬁber tracts regions. important criteria choosing spatial basis tight frames choice important theoretical implications compressed sensing oﬀers computational advantages additionally fast transform implementations also reduce computational complexity. finally compare formulation state-of-the-art section compare performance spatial-angular sparse coding method state-of-the-art angular sparse coding analyzing reconstruction accuracy using nonzero coeﬃcients. ﬁrst experiment tested phantom data slice. kron-fista ||s∗ sorig||f spatial-angular sparsity levels terms average number atoms voxel ideal reconstruction average number atoms voxel residual error happens lower left-hand corner plot. range curve-sr outperforms haar-sr i-sr unable perform level. reconstruction i-sr various sparsity levels visualized figure comparison figure displays sparse reconstruction haar-sr curve-sr average atoms/voxel. notice curve-sr leads somehow smoother accurate reconstruction expectedly boxy reconstruction haar-sr high sparsity level. regime additional directionality. drastically better reconstruction compared state-of-the-art sparsity level left figure clearly shows achieve accurate reconstruction less atom/voxel. still cases proposed joint spatial-angular sparse coding reconstruct accurate signals much fewer number atoms angular sparse coding seen figure achieved average around atoms voxel. strikingly cases high signal complexity crossing ﬁbers sparse code requires order atoms voxel repeat analysis real hardi data. first investigated phantom data section analyze eﬀect adding regularization angular sparse coding diﬀerent weighting equivalent purely angular i-sr model. algorithm used solve resulting optimization problem split bregman procedure outlined consistent phantom experiment figure observe figure adding spatial regularization increases total number atoms given reconstruction error compared case. reconstructed signals qualitatively spatial regularity result qualitatively better output. comparison joint model propose achieves better sparsity levels comparable reconstruction errors. note also algorithms displayed similar performances terms running time particular experiment. ﬁnally validate approach case full hardi volume sparse number atoms. figure presents reconstruction error sparsity results state-of-the-art framework versus joint haar-sr curve-sr. plot shows curvelets outperforms haar high sparsity levels range atoms/voxel. expected consistent phantom data experiment state-of-the-art i-sr comparable reconstruction error range atoms/voxel. figure shows quality reconstruction i-sr haar-sr curve-sr compared original signal smoother reconstruction preservation smaller detailed ﬁber tract regions. contrast state-of-the-art i-sr unable model intricate ﬁber regions forced voxels zero atoms. using proposed method achieve much higher sparsity levels state-of-the-art accurate reconstructions using less atom/voxel. terms work demonstrated using joint spatial-angular dictionary obtain accurate hardi reconstruction spatial-angular sparsity levels less atom voxel surpassing limitations state-of-the-art angular representations. provides general reconstruction framework achieve sparser dmri representations previously possible optimal choices spatial angular dictionaries. particular shown promising sparsity results hardi combination curvelet spherical ridgelet dictionaries spatial angular dictionaries chosen dmri protocols like ms-hardi. future work optimize sparsity levels learning joint spatial-angular dictionary directly dmri data. furthermore eﬃciently solve large-scale global sparse coding problem proposed three novel extensions popular sparse coding algorithms kronecker dictionary setting. strategies improve upon previously proposed algorithms explicitly exploiting separability dictionary beneﬁcial depending problem regime size data. large-scale hardi data kron-fista leader speed. future work investigate figure comparison spatial-angular sparsity levels achieved proposed joint method haar-sr dictionaries state-of-the-art method diﬀerent spatial regularization parameters applied slice real hardi scan. recall corresponds purely angular sparse coding i-sr. adding regularization results increase number atoms given reconstruction error. joint method achieves better sparsity levels using separate sparsity penalties. figure comparison spatial-angular sparsity level achieved haar-sr curve-sr respect state-of-the-art i-sr entire real hardi volume. curvelets provide good reconstruction error sparsest number atoms range atoms/voxel. state-of-the-art error much larger sparsity range comparable predicted range atoms/voxel consistent previously reported i-sr. addition sparse coding spatial angular representation novel applications areas dmri processing denoising feature extraction global non-negativity ﬁber tract segmentation tractography. however main application spatial-angular sparse coding framework promising improvements acquisition acceleration dmri natural future extension work incorporate joint spatial-angular sparsifying dictionaries within uniﬁed framework subsample signal measurements kq-space. adequate design joint sensing schemes recovery results predict minimum number samples needed stable accurate reconstruction directly linked sparsity signal chosen dictionary argues favor joint representation proposed.", "year": "2016"}