{"title": "Quasi-Monte Carlo methods applied to tau-leaping in stochastic  biological systems", "tag": "q-bio", "abstract": " Quasi-Monte Carlo methods have proven to be effective extensions of traditional Monte Carlo methods in, amongst others, problems of quadrature and the sample path simulation of stochastic differential equations. By replacing the random number input stream in a simulation procedure by a low-discrepancy number input stream, variance reductions of several orders have been observed in financial applications.  Analysis of stochastic effects in well-mixed chemical reaction networks often relies on sample path simulation using Monte Carlo methods, even though these methods suffer from typical slow $\\mathcal{O}(N^{-1/2})$ convergence rates as a function of the number of sample paths $N$. This paper investigates the combination of (randomised) quasi-Monte Carlo methods with an efficient sample path simulation procedure, namely $\\tau$-leaping. We show that this combination is often more effective than traditional Monte Carlo simulation in terms of the decay of statistical errors. The observed convergence rate behaviour is, however, non-trivial due to the discrete nature of the models of chemical reactions. We explain how this affects the performance of quasi-Monte Carlo methods by looking at a test problem in standard quadrature. ", "text": "abstract. quasi-monte carlo methods proven eﬀective extensions traditional monte carlo methods amongst others problems quadrature sample path simulation stochastic diﬀerential equations. replacing random number input stream simulation procedure low-discrepancy number input stream variance reductions several orders observed ﬁnancial applications. analysis stochastic eﬀects well-mixed chemical reaction networks often relies sample path simulation using monte carlo methods even though methods suﬀer paths paper investigates combination quasi-monte carlo methods eﬃcient sample path simulation procedure namely -leaping. show combination often eﬀective traditional monte carlo simulation terms decay statistical errors. observed convergence rate behaviour however non-trivial discrete nature models chemical reactions. explain aﬀects performance quasi-monte carlo methods looking test problem standard quadrature. last decades research molecular biology generated vast amounts quantitative data. growing amount data inspired development variety mathematical modelling simulation techniques aiming support experimental study intricate processes taking place cells molecular systems. result often option perform silico experiments alongside traditional vivo vitro approaches study complex cellular pathways allowing perform model ﬁtting inference thus yielding detailed view diﬀerent components often intricate networks feature nowadays appears prominently many models chemical reaction networks randomness. including randomness mimic eﬀects intrinsic extrinsic noise sources present molecular systems found experiments stochasticity responsible wide variety observed phenomena stochastic focusing resonance-inducing oscillations addition noise however comes price terms silico experiments. single experiments many times using monte carlo methods yield results form summary statistics satisfactory degree certainty. requirement result such component development computational techniques stochastic models ﬁnding ways reduce variance statistics returned simulation algorithms used. ﬁelds rely heavily computations computational ﬁnance commonly applied variance reduction approach involves quasi-monte carlo techniques. changing random number input pseudo-random numbers low-discrepancy numbers gain performance sometimes several orders achieved. context simulation chemical reaction networks idea received little attention. exploration combination methods exact simulation continuous time markov chain models presented shows beneﬁts standard methods. work speciﬁcally look approximate simulation method -leaping allows easier incorporation methods. show beneﬁts using methods case perhaps less striking anticipated based success methods numerical solution stochastic diﬀerential equations give detailed explanation case serves explanation observations made well. outline. start section overview mathematical modelling chemical reactions well-mixed species. models need diﬀerent simulation methods compute summary statistics discussed next section section also includes discussion methods resulting statistical error summary statistics. reduce statistical error explore methods provide practitioners introduction section section show results application methods simulation chemical reaction networks. compare results simple model classical quadrature elucidate diﬀerence performances observed. finally conclude section discussion observations combination methods simulation stochastic biological systems. main part work look models describe temporal evolution molecule copy numbers assume molecules spatially distributed homogeneous i.e. assume systems well-mixed volume note possible include spatial movement molecules framework refer detail. state vector describing evolution species time evolves i.e. number molecules time upon ﬁring reaction number molecules change stoichiometric vector reaction denote change copy number reaction ﬁres i.e. reaction denotes number times reaction channel ﬁres time interval course insightful described means calculate order model counting functions assign every reaction channel propensity function describes probability reaction channel ﬁres inﬁnitesimal time interval note selection function modelling choice. commonly employed choice mass action which essence looks number combinations reactants made using state vector reaction example present inverse historical deﬁne based propensity functions. accurate model counting function would view description ctmc where given current state experience diﬀerent state transitions based various reaction channels. inhomogeneous poisson process describe number times reaction ﬁres. leads kurtz random time change representation independent inhomogeneous poisson counting processes representation ctmc pathwise description dynamics. alternatively describe ctmc chemical master equation dimensional system ordinary diﬀerential equations describes time evolution probability occupy parts state space note solved special cases rtcr form basis many simulation approaches touch upon later. denote independent wiener processes. comparing rtcr equation equation pathwise descriptions dynamics species. case also possible describe dynamics manner akin i.e. terms occupation probability state space approach yields chemical fokker-planck equation system partial diﬀerential equations that general high-dimensional many systems yield exact results known. using formulation ﬁnally derive deterministic reaction rate equations century. take thermodynamic limit letting number molecules volume inﬁnity whilst ratio remains constant. limit random ﬂuctuations become negligibly small compared deterministic terms convert equation constitute relatively smaller system odes rres studied using analytical tools numerical solvers. side however system odes completely deterministic therefore incorporate stochastic eﬀects. thus three diﬀerent mathematical models describing temporal evolution well-mixed molecular species namely rtcr rres respectively. models seen chain approximations going ctmc discrete state space ctmc continuous state space deterministic system. models analysed simulated diﬀerent ways diﬀerent cost. presented three diﬀerent models evolution interacting chemical species preceding section perform mathematical analysis them. deterministic rate equations wide array well-known analytical numerical techniques detail rather refer references therein. however noise non-linear reactions important model yield correct results resort stochastic models mentioned previously investigate system behaviour. formulations using ctmcs incorporate stochasticity therefore often harder interrogate using analytic methods; handful cases proven possible repeated simulation sample paths models therefore crucial order gain insight dynamics species numbers. standard simulation procedures used sdes euler-maruyama milstein methods refer extensive exposition subject. computational techniques sdes generally eﬃcient compared methods rtcr discuss next. however suﬀer numerical error depending integration scheme used bias error approximation rtcr dynamics rtcr generally studied diﬀerent ways. ﬁrst cme. however disadvantages approach dimension system odes; equal size state space. generally high problem becomes intractable refer general overview computational approximations related cme. means often forced rely diﬀerent approach handle model dynamics. instead looking evolution probability whole state space generate single sample paths evolve according rules equation exact algorithm compute sample paths context chemical reaction networks called stochastic simulation algorithm gillespie’s direct method given current state algorithm provides compute time next reaction ﬁres determines reaction progress markov chain reaction time. approach made computationally eﬃcient example using next reaction method gibson bruck modiﬁed next reaction method anderson still methods suﬀer drawback namely computational costs. simulate reaction individually time signiﬁcant many molecules reactions involved. rationale behind development approximate methods simulate sample paths equation widely used methods -leap scheme also developed gillespie back equation time approximate poisson process gaussian random variates yield cle. essence -leap method follows rationale that given small enough propensities reactions change much time interval therefore assumed constant. approach yields discrete-time markov chain discrete state space time state computational gain method order calculate simply generate single poisson random variable parameter ak)τ means multiple reactions therefore progress quicker case ssa. algorithmic representation -leap method depicted algorithm approximate method -leap method come without caveats possibility achieving negative molecule numbers. many possible workarounds avoid negative copy numbers proposed furthermore because -leaping approximate method yields bias depending selection magnitude step size therefore balance eﬀect bias diﬀerent view -leap method variant explicit euler method odes applied equation approximated time integral left riemann sum. method therefore parallels widely used scheme sdes could therefore question whether possible adapt time stepping approaches ctmc simulation case. indeed possible small class methods implicit euler yields implicit -leap approaches methods perform better systems exhibiting e.g. stiﬀ behaviour. monte carlo methods errors. ﬁnal note simulation well-mixed systems reﬂect diﬀerent methods mentioned above. many commonly used methods provide means generate sample paths chemical reaction networks infer information these? many instances interested expressions like function state variable time however random variable often look expectation generate sample paths distribution possible outcomes state space employ methods estimate required statistics. generate independent possibly approximate sample paths construct estimator decomposed separate sources error. first bias. could result modelling choice example related computational methods form biased approximation rtcr derived. alternatively bias could stem algorithm parameters time step -leap method. type error investigated paper assume that speciﬁc computational method given ﬁxed. hand statistical errors form variance estimator controlled. statistical errors therefore form main focus interest manuscript discussed next. goes without saying desirable statistical error small possible; control statistical uncertainty tightly possible given computational resources. standard method given sample variance determined model studied variance estimator given reducing statistical error done ways. firstly taking samples approach requires development eﬃcient algorithms order bring cost simulation down. alternatively could hope reduce sample path variance applying variance reduction technique detail context methods. note employing standard variance reduction techniques results smaller therefore techniques improve constant convergence convergence rate behaviour change. remainder manuscript however look numbers necessary convergence. example deterministic quadrature methods midpoint-rule exist relation lln. turns that virtue koksma-hlawka inequality link rate total variation integrand sense hardy krause. approximation error inequality thought equivalent equation methods. note equation equality holds probability whereas equation deterministic worst-case inequality. comparing error bounds takes place variance quantities depending integrand furthermore that rather error decay like factor determining behaviour increases. discrepancy star-discrepancy particular measures greatest deviation point perfect uniform distribution illustrated figure taking supremum boxes corner origin measure diﬀerence expected number boxes perfect uniform case reality. total variation integrand practical purposes impossible calculate harder estimate actual integral furthermore practical applications encounter functions inﬁnite voids equation comparison random sequence low-discrepancy sequence depicted figure shows low-discrepancy sequence attains much better spread integration domain method replace random sequence deterministic sequence low-discrepancy numbers deterministic construction sequences attain convergence orders like osn−) wide range integrands virtue osn−) convergence rate limit always better attained standard dimension large large clear based theoretical results whether provide improvement. however various reports literature albeit without theoretical justiﬁcation methods seemingly outperforming randomised quasi-monte carlo. weakness methods compared quadrature methods lack measure error. methods estimate variance obtain conﬁdence intervals. however methods points used deterministic therefore allow application lln. koksma-hlawka inequality provide deterministic error bounds cannot calculated computed. furthermore note that low-discrepancy numbers deterministic estimator unbiased. however consider hybrid methods. type approach introduces randomness methods keep good convergence properties whilst time allowing error estimation lln. resulting methods also known randomised quasi-monte carlo methods. common idea rqmc methods take low-discrepancy point apply randomisation {˜v}. good randomisations holds. result randomisation {˜v} unbiased estimator refer note unbiased estimator time estimate variance like methods eﬀectively independent unbiased estimates allows unbiased estimator sample path variance obtain standard simulations result ways reduce variance rqmc estimator either taking samples randomisation taking randomisations always clear choice make regard make general observations. note increasing means within randomisation points low-discrepancy used. therefore take advantage better spread low-discrepancy point sets lowering rqmc possibly rate faster hand controls number randomisations statistical error convergence rmse). however large often already happen note rqmc estimator sample section rqmc introduced variation standard methods adding style randomisations. alternative perspective rqmc starting method adding low-discrepancy points make variance application stochastic simulations. methods introduced previous sections context quadrature framework applies equally well many stochastic simulation approaches. fact object interest often takes form expectation also written integral. therefore suﬃcient quadrature stochastic simulations substitute pseudorandom numbers simulation method low-discrepancy numbers equivalent method. crucial diﬀerence however standard low-discrepancy numbers need know dimensionality problem priori. fact cannot make low-discrepancy point dimensions simply combining onedimensional point sets clearly seen figure diﬀerence types points caused low-discrepancy point sets generated well-deﬁned deterministic manner introduces correlation individual points. figure illustration combination one-dimensional point sets two-dimensional randomised sobol’ sets pseudo random sets approach pseudo random numbers results therefore straightforward combine methods e.g. gillespie’s clear priori many random numbers used simulation single path i.e. dimension unknown possibly inﬁnite. exist ways deal possibly inﬁnite integration problems context using lattice rules sequences example overview software implementation constructions. chemical reactions workaround simulation ctmcs using uniformisation ctmc presented paper however focus instead -leaping method simplest form allow priori determination dimension problem. given reaction channels simulation runs time step random numbers used single path. discrepancy numbers used step algorithm generate poisson random variables applying inverse transformation. note done using fast inverse transform process slower direct methods generating poisson random variables current implementations matlab python test eﬀect combination rqmc -leaping example chemical reaction systems. compare results using -leaping results numerically solving using discretisation methods proven eﬀective numerical simulation sdes past note computational methods based diﬀerent models rtcr respectively. result bias methods diﬀerent therefore directly compare summary statistics computed. instead ignore bias measure convergence rate statistical errors methods. work bias error incurred using -leaping refer numerical results rqmc methods used input sobol’ sequences random linear scramble combined random digital shift create randomised low-discrepancy points. monomolecular reaction networks. first look elementary test systems able closely compare cle-based method -leap method. beneﬁt systems bias ﬁnite step size exactly known. addition ﬁrst moments sample paths calculated analytically -leap method discretisation scheme. models auto-catalytic production degradation species simplicity take reaction rates equal i.e. system exhibit ﬂuctuations around steady state given initial state note identities also hold discretisation -leap scheme applied rtcr computational methods thus unbiased respect ctmc model. figure show convergence results rmse time system euler-maruyama discretisation -leap method time step i.e. take eight steps methods. dimension problem therefore generally thought within realm possibilities methods. clearly rqmc applied -leap gives strong improvement method standard pseudo random numbers. however also clear that contrary method cle-based discretisation -leap show equal convergence terms rmse rqmc method shows diﬀerence performance beneﬁt. based method convergence rate note decrease convergence rate sample paths reaching molecule numbers could result discrepancy cle-based methods discrete molecule number methods -leap method. initial conditions given sample paths unlikely happen observed simulations used produce figure also means strategy prevent negative molecule numbers e.g. needed example. clear diﬀerence -leap method cle-based method stems respective update formulas related equal. therefore results methods diﬀer subtly. increasing reaction rate parameters system poisson updates used -leaping better approximated normal random variables used cle-based methods. furthermore result diﬀerence updates state space variable continuous cle-based methods discontinuous taking integer values rtcr-based -leap method. investigate diﬀerences -leap method clebased method exactly lead contrasting convergence rate behaviours observed figure firstly test whether closeness -leap method equivalent discretisation changes observed behaviour switching convergence regimes. done running similar simulations varying initial conditions therefore molecule number regimes. expect better agreement -leap method method. note vary sample path variance methods form ctε− therefore grows figure show resulting comparison methods rmse rescaled ε−/. done normalise rmse sample path variance changed. note rescaling inﬂuence convergence rate behaviour function figure comparison normalised rmse convergence rate -leap discretisation mean number molecules varying initial condition dotted lines show typical reference convergence rates rqmc. convergence respectively. observe smaller means transition takes place later i.e. higher note varying context system means changing average copy number encountered also average reaction propensities. result toggles good poisson random variables -leap method approximated normal variables therefore good approximation discrete dynamics. might therefore think rqmc performance depends ‘closeness’ discrete rtcr system continuous approximation. show necessarily case. consider additional rescaling reaction rate constant form combination previous rescaling initial condition. note keeps reaction propensities average constant order figure show similar behaviour compared previous example ﬁxed. therefore ‘closeness’ rtcr governs convergence rate determined propensities reaction channels. rather seems copy number molecules crucial system. figure comparison normalised rmse convergence rate -leap discretisation mean number molecules varying initial condition dotted lines show typical reference convergence rates rqmc. reversible isomerisation system. previous example showed case molecule numbers system small rqmc combination -leaping performed well. following example show large molecule numbers species system guarantee good convergence behaviour rqmc combination -leaping. consider species system start initial molecules. deﬁne note simple system closed means number molecules times equal information used decouple dynamics note system ctmc model converges equilibrium state order ignore transient regime system goes equilibrium start simulations α−ε− proportional equilibrium state i.e. discretisation like parameters means copy numbers order might reasonably large. note gain performance terms rmse compare rqmc equivalent method. however observe that despite large copy numbers rmse -leaping quickly goes convergence. figure rmse convergence mean number molecules time step simulations. establish rmse equation used randomisations rqmc methods. dotted lines show rmse attain convergence rate relatively quick number molecules moderate rather large. rmse molecules mimics behaviour coupling reactions molecules therefore also change convergence discrete model. explain observations previous examples consider problem traditional quadrature. consider integration following sdimensional test functions domain regardless note easy test function methods represents linear combination one-dimensional functions methods perform well). eﬀective dimension superposition sense additive funcsuﬃciently many points used rmse convergence test functions dimensions depicted figure shows rqmc indeed good integrating large enough holds terms rmse convergence dependency note chemical test systems previously discussed clear diﬀerence performance rqmc methods continuous discrete rtcr. terms quadrature integrand ﬁrst case continuous whereas second case discontinuous. convergence results rqmc based assumption integrand continuous observed discontinuities adverse eﬀect convergence rate show certain type discontinuity closely resembling chemical reaction system case replicate convergence behaviour observed previous section. figure show eﬀect varying onefunction becomes smoother. dimensional function ﬁlled contour plot note applying transformation create function discontinuities parallel axes integration domain proven axes-parallel discontinuities relatively mild eﬀect convergence rqmc methods. provable results convergence rate randomised sobol’ sequences available owen nested uniform scrambling used rather randomised matrix scrambling used paper. figure result discontinuity transformation onedimensional function plot graph twodimensional function plot ﬁlled contour plot clearly showing discontinuity lines convergence rate. results figure hold wide range dimensions expected results aﬀected fact function transformation still one-dimensional superposition sense. hand eﬀect transformation shows enough points used note that contrast transformation acts upon function output values. result discontinuities introduced necessarily align axes seen figure dimensions. small values convergence rate similar continuous rate becomes rather observed transformation comes back fact discontinuities introduced align axes integration domain understand many rqmc point sets constructed sets points equidistributed respect axes-aligned hyperrectangles. discontinuities integrand align domain axes transformation rqmc points able sample integrand’s diﬀerent contributions uniformly. discontinuities align domain axes also shown detrimental type discontinuity wants rqmc methods shows that even case discontinuous integrand rqmc methods achieve lower function decomposed continuous part discontinuous part relatively smaller magnitude. rqmc performs superiorly continuous component integrand giving fast error decay moderate number points worst-case scenario convergence rate achieved rqmc discontinuous part dominate convergence order large observation linked observations made caﬂisch notes lowdiscrepancy point sets diﬀer subtly pseudo random point sets sense pseudo random point every point independent estimate integral. true low-discrepancy point deterministic structure. point sets initial points sample integration domain coarse scale whereas later points used progressively ﬁner scales. therefore initially rqmc perform well function like coarse scale dominated continuous part points used discontinuous structure starts dominate convergence stalls. note general chemical reaction network clear priori summary statistic interest decomposed continuous part discontinuous part value words clear important coarse scale continuous contributions relation ﬁner scale discrete ones. therefore performance beneﬁt using rqmc methods methods hard estimate priori. however note implementation low-discrepancy point sets often relatively simple need increase runtime simulation procedures result rqmc methods potential provide computational savings methods simulation approaches chemical reaction networks attaining lower statistical errors similar computational time. assume copy numbers constant large. initial condition molecules. non-dimensional parameters given copy numbers taken respectively. system bistable parameters stable states around copy numbers copy numbers simulate system ﬁnal time time step take approach deal sample paths zero fewer molecule numbers given time. look mean number molecules though meaningful summary statistics constructed bistable systems. figure rmse convergence mean number molecules time step simulations. establish rmse equation used randomisations rqmc methods. dotted lines show typical reference convergence figure show results comparing -leap method discretisation using pseudo random points low-discrepancy points. that although rqmc method attain much higher convergence rate standard convergence rate. behaviour likely fact system four reaction channels time steps leading dimensionality speciﬁc problem. number dimensions challenging na¨ıve methods applied here. might beneﬁt applying change variables transforms eﬀective dimension problem therefore improves rqmc convergence. techniques brownian bridge principal components construction available sdes help making rqmc methods eﬀective even high dimensional problems dynamics following rtcr transformations however known leave direction future research. known low-discrepancy numbers instead pseudo random numbers greatly improve convergence speed problems involving traditional quadrature sdes. paper explored application rqmc methods framework simulation stochastic biological systems. particular looked combination low-discrepancy numbers -leap method. simplicity ﬁxed step -leap method considered allow simple implementation low-discrepancy points without negative eﬀects runtime. note question whether good procedure addressed literature paper however focus question whether -leaping forms good approximation ctmc dynamics motivation therein discussion time step selection. rather focus question quick statistical errors desired summary statistics decay function number sample paths simulated. answer question simplest possible case namely using ﬁxed time step -leap though expect conclusions general enough hold large class simulation procedures stochastic biological systems. theory suggests convergence rate rqmc method worse equivalent method reality seems show case chemical reaction networks rqmc superior evidenced numerical experiments section result chooses ﬁxed time-step -leap approach simulate chemical reaction network rqmc methods gives better convergence behaviour compared traditional implementation extra cost. however beneﬁts using low-discrepancy numbers smaller anticipated based results seen simulation sdes. particular chooses model chemical reaction systems sdes form sees greater advantage low-discrepancy numbers. eﬀect caused least factors. firstly inherently discrete nature stochastic simulations chemical reaction networks hinders rqmc convergence. reported literature discontinuous integrands experience less beneﬁt rqmc methods standard methods section showed simpliﬁed test system behaviour observed simulating chemical reactions replicated introducing certain types discontinuity classical quadrature. simple test systems section allow detailed understanding rmse convergence rate observed applying rqmc. however always possible choose biological model parameters eﬀect discontinuities small. would therefore advantageous techniques leave desired summary statistic intact diminish eﬀect discontinuities rmse convergence. smoothing techniques previously considered mitigate eﬀects discontinuity contexts address similar techniques context chemical reaction networks future work. secondly known performance methods strongly depend dimension problem. illustrated last example section higher dimension lead much smaller performance beneﬁt regardless smoothness underlying problem. methods reduce eﬀective dimension problem change variables proven eﬀective ﬁelds open question whether transformations found simulation biological systems. another method proven fruitful simulation dtmcs potentially large dimension array-rqmc method cornerstone known work area stochastic biological systems observations paper eﬀect discrete nature chemical reaction systems support explain observation smaller expected performance gain future work explore eﬀect discontinuities array-rqmc method combination -leaping ﬁxed adaptive time stepping. also point original article introducing methods richtmyer considered discrete linear birth process. observed smaller performance gain expected might impeded exploration methods stochastic simulation decades. richtmyer’s results understood caused unfortunate choice chosen model problem discontinuous nature. topic future research eﬀective dimension simulation rtcr. concept eﬀective dimension techniques reduce said dimension widely studied context ﬁnancial applications future explore implications models interest biology. acknowledgements. authors grateful giles insightful discussions suggestions made throughout work. authors would also like thank anonymous reviewers whose detailed comments improved clarity paper. casper beentjes acknowledges clarendon fund college oxford funding. ruth baker royal society wolfson research merit award holder leverhulme research fellow also acknowledges bbsrc funding grant bb/r/. question whether time taken generate scrambled low-discrepancy sequences rqmc method much longer time needed pseudo-random numbers generated could void observed performance gains. therefore perform small test time generation various random numbers. time long takes generate point length dimensions timing experiments performed using matlab ubuntu desktop intel core random access memory. test standard pseudo-random number generator versus sobol’ points linear matrix scrambling random digital shift. results depicted figure show relatively small point sets generation pseudo-random numbers distinctly faster sobol’ points point sets lengths uncommon simulations diﬀerence negligible. therefore completion time algorithm replaced pseudo-random numbers low-discrepancy numbers diﬀer noticeably. ﬁndings agree practical timing results simulations various ﬁnancial applications figure comparison time taken generate pseudorandom points equal number scrambled sobol’ points. left right results dimensional points respectively. alternative look rqmc variance reduction technique within standard framework noted randomisation low-discrepancy point estimator becomes unbiased estimator integral equation variance estimator linearity written covariances zero. rqmc method however case deterministic construction points used. note remains true despite randomisation point whole still low-discrepancy set. order reduce variance wants contribution covariances negative possible. attempted rqmc methods construction points used quadrature places rqmc methods equal footing with example standard variance reduction techniques antithetic sampling common random numbers", "year": "2018"}