{"title": "Efficient analysis of stochastic gene dynamics in the non-adiabatic  regime using piecewise deterministic Markov processes", "tag": "q-bio", "abstract": " Single-cell experiments show that gene expression is stochastic and bursty, a feature that can emerge from slow switching between promoter states with different activities. One source of long-lived promoter states is the slow binding and unbinding kinetics of transcription factors to promoters, i.e. the non-adiabatic binding regime. Here, we introduce a simple analytical framework, known as a piecewise deterministic Markov process (PDMP), that accurately describes the stochastic dynamics of gene expression in the non-adiabatic regime. We illustrate the utility of the PDMP on a non-trivial dynamical system by analyzing the properties of a titration-based oscillator in the non-adiabatic limit. We first show how to transform the underlying Chemical Master Equation into a PDMP where the slow transitions between promoter states are stochastic, but whose rates depend upon the faster deterministic dynamics of the transcription factors regulated by these promoters. We show that the PDMP accurately describes the observed periods of stochastic cycles in activator and repressor-based titration oscillators. We then generalize our PDMP analysis to more complicated versions of titration-based oscillators to explain how multiple binding sites lengthen the period and improve coherence. Last, we show how noise-induced oscillation previously observed in a titration-based oscillator arises from non-adiabatic and discrete binding events at the promoter site. ", "text": "theoretical division center nonlinear studies alamos national laboratory mexico previous aﬃliation school physics astronomy university manchester manchester single-cell experiments show gene expression stochastic bursty feature emerge slow switching promoter states diﬀerent activities. source long-lived promoter states slow binding unbinding kinetics transcription factors promoters i.e. non-adiabatic binding regime. here introduce simple analytical framework known piecewise deterministic markov process accurately describes stochastic dynamics gene expression non-adiabatic regime. illustrate utility pdmp non-trivial dynamical system analyzing properties titration-based oscillator non-adiabatic limit. ﬁrst show transform underlying chemical master equation pdmp slow transitions promoter states stochastic whose rates depend upon faster deterministic dynamics transcription factors regulated promoters. show pdmp accurately describes observed periods stochastic cycles activator repressor-based titration oscillators. generalize pdmp analysis complicated versions titration-based oscillators explain multiple binding sites lengthen period improve coherence. last show noise-induced oscillation previously observed titration-based oscillator arises non-adiabatic discrete binding events promoter site. gene expression fundamentally stochastic biochemical process arises thermal ﬂuctuations. important source stochastic noise comes discrete random binding unbinding events regulating transcription factors promoter sites regulated genes. conventionally binding unbinding events thought fast compared downstream processes transcription translation degradation separation timescales leads approximation known quasi-steady state adiabatic approximation mean transcription rate simpliﬁes function concentrations protein-dna dissociation constants promoter adiabatic approximation commonly used reduce number dynamical variables gene regulatory networks. however also bold assumption experiments show binding unbinding events transcription factors chromatin promoter take place comparable even slower timescale downstream processes gene expression. observation motivated theoretical studies eﬀects slow non-adiabatic binding gene regulatory networks. consensus non-adiabatic bindmany studies focused system properties stationarity mostly ignored eﬀects non-adiabatic binding non-equilibrium dynamics gene regulatory networks. article address following questions dynamical consequences non-adiabatic binding? kind modeling framework accurately describes nonstationary dynamics gene regulatory networks non-adiabatic regime? answer questions model titration-based clocks illustrate eﬀects non-adiabatic binding dynamics show analytical framework known piecewise deterministic markov process accurately describes stochastic dynamics full model non-adiabatic regime. article organised follows. section introduce idealised models titration-based circuits commonly found circadian clocks immune signaling. prove section limit cycles impossible fast-binding limit. section simulate full chemical master equation demonstrate titrationbased circuits exhibit stochastic cycles slowbinding limit. transform chemical master equation piecewise deterministic markov process transitions between discrete promoter states stochastic rates depend upon faster deterministic dynamics transcription factor concentrations regulated promoters pdmp makes assumptions regarding timescales promoter switching valid slow fast switching. exact formulation chemical master equation thermodynamic limit systems protein numbers large. thermodynamic limit hence pdmp analysis well-suited stochastic gene dynamics eukaryotic cells cell sizes number regulatory proteins large. show pdmp framework accurately describes observed periods coherence stochastic cycles non-adiabatic regime. also demonstrate pdmp readily applied detailed mechanistic models section conclude section discussing results pdmp analysis context previous work non-adiabatic binding oscillation gene networks. begin introducing idealised models titration-based gene regulatory networks commonly found biological oscillators. models ‘idealised’ sense transcription translation lumped single-stage ‘production’ intermediate mrna populations explicitly modelled. simplify cis-regulatory architecture promoter fewest number possible binding states. purpose idealised models illustrate pdmp analysis used understand origin properties stochastic cycles emerge non-adiabatic regime. relax assumptions later sections. idealised models consist genes produce kinds regulatory proteins figure ﬁrst model called activator-titration circuit protein transcriptional activator model increases production rate inhibitor binding cis-regulatory binding sites promoter gene association sequentially binding sites rate production rate gene depends non-linearly number bound promoter production rate binding sites occupied; otherwise production rate activator. gene unregulated thus activator constitutively produced constant rate last inhibitor inhibits activity titration molecule irreversibly binds molecule bimolecular rate association forms non-functional heterodimer. idealised modelled following elementary reactions number bound schematic diagram found fig. elementary rate constants deﬁned sense mass action kinetics denotes concentration thermodynamic limit. stochastic models consider discrete molecules rates properly scaled parameter quantiﬁes system size related cell volume. scaling relationship mass-action rate constants stochastic model rates found appendix second model called repressor-titration circuit transcriptional repressor figure model diﬀers ways. first inhibitor constitutively expressed constant rate secondly negatively auto-regulates decreases production rate binding cis-regulatory binding sites promoter gene association quentially binding sites rate production rate gene depends non-linearly number bound promoters production rate binding sites occupied; otherwise production rate repressor. rest process parameters similarly deﬁned atc. idealised modelled following elementary reactions section show mass action kinetics describing fastswitching limit allow deterministic limit cycles. below generically gene index protein index. discrete switching events variable treated approximately constant. limit birth death rates approximately constant quasi-stationary distribution obtained using detailed balance onedimensional birth-death process thermodynamic limit denote concentrations respectively resulting mass action kinetics described following deterministic diﬀerential equations simplicity uniﬁed expressions idealised constant constant rtc. equations constitute two-dimensional dynamical system. bendixson criterion states limit cycles exist trace jacotrace always negative dβeﬀ trace also always negative dβeﬀ thus deterministic limit cycles idealised adiabatic limit. modify activator also stimulates production dβeﬀ would possible limit cycles adiabatic limit. ﬁrst develop full stochastic model describes dynamics population molecules number bound promoter sites discrete. model show emergence stochastic cycles well-deﬁned periods nonadiabatic regime. state model determined population population bound promoter state gene bound promoter state gene probability time given pijkl. discrete-state stochastic process idealised model imposed. uniﬁed model descriptions rtc; constant similarly nyκy constant {condition} characteristic function equal condition true otherwise diﬀerent rates protein population scale function system size outlined appendix concentrations previous sections interpreted normalised population density discrete populations regulatory proteins refer model full cme. standard continuous time markov chain simulations constructed generate exact sample paths full chose sets parameters listed table source nonlinearity titration chose parameter simple illustrates fundamental ingredients stochastic cycling non-adiabatic regime. consider complicated cis-regulatory promoters later sections. parameter introduce scaling factor binding unbinding rates respectively parametrised λ¯κz λ¯θz. ﬁxed systematically change value order examine dynamics model adiabatic non-adiabatic regime. fig. present sample paths full cme. observe limit cycles idealised fast binding unbinding limit predicted analysis sec. decreased parameter system entered regime timescale binding unbinding gene comparable processes. non-adiabatic regime fig. shows alternating high-amplitude expression appears oscillatory. measured ‘period’ stochastic cycle using protocol detailed appendix figure schematic diagrams derived piecewise deterministic markov process idealised activator-titration circuit idealised repressor-titration circuit models single section develop pdmp framework full analyse understand observed stochastic cycling non-adiabatic regime. idea pdmp re-formulate master equation conditioning discrete promoter ﬁxed promoter states approximate stochastic dynamics population space using ordinary diﬀerential equations thus leaving discrete markovian stochastic switching space. approximation accurate large system size thermodynamic limit pdmp framework makes assumptions regarding relative timescales equally valid adiabatic non-adiabatic regimes thermodynamic limit. derive pdmp ﬁrst deﬁned imposed. note evolution contains parts terms contain describe liouvillian whereas terms contain describe markovian switching discrete promoter states total state follows deterministic liouvillian stochastically switching discrete state resulting process referred piecewise deterministic markov process pdmp rithm described appendix implemented generate sample paths pdmp nonadiabatic regime; fig. pdmp sample paths capture salient features dynamics full fig. example measured distribution stochastic cycle periods using pdmp perfect agreement full cme; fig. numerically advantage pdmp framework kinetic monte carlo simulations faster continuous time markov chain simulations full determined numerically-integrating pdmp numerically simulated given state evolution concentrations described nonlinear ordinary diﬀerential equations allow analytic solutions. nonlinearity comes term describes titration developed linearsation approximation utilises fast titration limit limit molecular species lower production rate relative quickly sequestered converge almost zero concentration. consequence separate promoter states fig. dynamical regimes horizontal markovian transitions diﬀerent dynamical regime inherit random switching present nonlinear pdmp whereas vertical transitions dynamical regimes determined solely faster deterministic process titration. compartments formulate linear ordinary diﬀerential equations allow analytic solutions facilitate quantiﬁcation random switching times. schematic diagrams single promoter site shown fig. shall refer models linearised pdmps. used kinetic monte carlo simulations algorithm described appendix generate sample paths linear pdmp non-adiabatic regime. measured distribution stochastic cycle period using linear pdmp similar full although tended underestimate shorter cycles occur pdmp full cme. strate consider two-state promoter constant transition rates e.g. promoter single binding site ﬁxed concentration regulating transcription factor. trivial two-state promoter system generates stochastic cycles unimodal distribution ‘period’ given hypoexmean period variance /k−. mean variance period mean variance individual transitions two-state cycle waiting times independent. period distribution qualitatively similar fig. suggests stochastic dynamics two-state promoter explain much stochastic cycling observed single-binding site model. non-adiabatic regime faster protein dynamics faithfully track underlying promoter state dynamics generate large amplitude stochastic cycles raises question whether stochastic cycling promoter states called oscillation. diﬃcult answer distinction stochastic cycling oscillation illdeﬁned. example including mechanisms reduce variance timing individual transitions produce cycles coherent. extreme limit transition variance period two-state cycle variance indistinguishable deterministic limit cycle. following section investigate potential mechanisms reduce variance stochastic transition times make stochastic cycles ‘deterministic’. linearised figs. shows system often cycles four discrete states alternate stochastic promoter switching deterministic titration state system ‘option’ transit either dissociation event bound deterministic titration suﬃciently small system favors later route induces ‘full cycle’ four discrete states counterclockwise order described below ‘full cycle’ x-dependence association rate conspire reduce variance produce coherent stochastic cycles. figure waiting time distributions next dissociation binding event linear pdmp. waiting time distribution dissociation event exponential. waiting time distribution binding event derived survival function depends initial concentration distribution binding times uniquely determined survival function plot different initial conditions fig. similar calculation performed linearized rtc; fig. variance binding time reduced initial close zero system must wait population increases value binding likely take place. explains ‘full cycle’ reduces variance total period system always starts previous titration dissociation thus waiting time binds promoter reduced variance. remark binding times exponentially distributed dependent concentration activator general. hence transition markovian ‘memory’ stored space deterministic dynamics describe mean concentrations adiabatic limit eﬀective protein synthesis rates determined stationary distribution promoter states. pdmp framework explicitly models stochastic binding unbinding events valid adiabatic non-adiabatic limits. here consider alternative ‘deterministic limit’ linear pdmp remaining variability stochastic binding unbinding artiﬁcially zero stochastic cycle becomes ‘deterministic’ limit cycle. ﬁrst moments random waiting times deterministic residence time promoter state thus dynamics deterone possible reaction choose reaction minimal deterministic waiting time. analogous gillespie’s ‘ﬁrst reaction’ method parameter idealised figure average time titrate shorter average dissociation time system cycles four states. time series alternative deterministic limit shown fig. pdmp framework applied sophisticated models atc. previous model call model showed multiple binding sites lengthened period improved coherence stochastic cycling. using pdmp show multiple binding sites insuﬃcient improve coherence. rather slow mrna dynamics multiple binding sites conspire push dynamics across promoter states improve coherence stochastic cycling. second model call vkbl model additional positive feedback loop activator activates addition activating inhibitor. authors previously showed vkbl model exhibits excitation-relaxation noiseinduced oscillation beyond hopf bifurcation. pdmp analysis reveal ﬂuctuations random unbinding events bound promoter sites essential inducing transcriptional noise turn drive excitable system away stable ﬁxed point induce large excursions semi-periodic manner. model several additional features compared idealised could explain observed increase period coherence stochastic cycles. first dynamics mrna transcription degradation protein translation explicitly modelled. second activators form homodimers bind promoter sites regulate gene expression. third homodimers bind promoter sites independently longer need bind sequentially last activator inhibitor heterodimer longer irreversible dissociate form monomers. below describe pdmp analysis model shown beginning master equation governing model perform system-size expansion presented sec. arrived following pdmp explanation improved coherence stochastic cycling model coefﬁcient variance total period reduced increasing number steps ‘full cycle’. example independent stochastic steps full cycle means variances step equal magnitude mean variance total period scales decreases test idea simulated idealised multiple parameters listed table before stochastic cycling non-adiabatic limit; fig. strikingly distribution periods similar simulations single bindingsites; compare fig. fig. understand multiple binding sites increase period improve coherence stochastic cycles ﬁrst transformed full pdmp conﬁrmed simulations pmdp accurately reproduced results full cme; fig. reduced pdmp linearised pdmp framework explains multiple binding sites idealised signiﬁcantly alter length period improve coherence. linear pdmp shows system becomes trapped ‘mini-cycle’ promoter states blue boundaries production rate changes instantaneously upon promoter state switching across boundary deterministic titration immediately start pushing system upwards timescale titration typically faster next stochastic binding thus produces stochastic mini-cycle around boundary. minicycle dynamic also reﬂected alternative deterministic limit shown figure numerically measured data model sample path full sample path linear pdmp stochastic cycles model measured using protocol provided appendix full exhibited minor fraction short period cycles genetic states. quantify predominant longer periods period) discarded periods less generate panels panel presents coeﬃcient variation stochastic periods measured full function scaling factor point computed stochastic cycles. larger short-lived mrna. long-lived mrna introduces delay protein production improves panel presents probability distribution stochastic periods scaling factor measured stochastic cycles full pdmp reduced pdmp original paper state variables concentrations activator mrna inhibitor mrna monomeric activators homodimeric activators inhibitors heterodimers. promoter state variable gmax total number binding sites analogous system size. association dismultiple combinations promoters number bound activators distributive binding. reduced pdmp linear pdmp monte carlo kinetic simulation linear pdmp gives similar results full model; fig. cases stochastic cycles exhibit well-deﬁned distribution periods reduced previously observed. schematic linear pdmp fig. suggests period coherence improved mrna dynamics introduce time change mrna production rate resulting protein synthesis rate. thus even though transcription rate changes instantaneously upon crossing respond reach state timescale mrna degradation rate delays process deterministic titration requires inhibitor synthesis reach saturation titrated. consequence model goes largest cycle given importance expect coherence stochastic cycling decrease upon increasing rate mrna degradation thus making mrna responsive changes transcription. tested idea rescaling mrna degradation \u0001¯δm protein translation total protein levels stayed ﬁxed mrna degradation rate could varied results fig. conﬁrm increasing mrna degradation rate larger created shorter less coherent stochastic ‘mini-cycles’ similar idealised measured noticed variance waiting times binding events linear pdmp much less unbinding events. motivated keep stochastic unbinding events whose waiting times exponentially distributed take deterministic waiting time binding events evaluating ﬁrst moment cumulative distribution resulting model summarized fig. referred reduced pdmp. reduced model stochasticity—the random unbinding events—results random duration series promoter states actively produce inhibitor excellent agreement reduced pdmp full model suggests variability stochastic cycle times mostly determined stochasticity unbinding events; fig. although serial nature unbinding events helps reduce overall imfigure slow ﬂuctuations random binding unbinding events induce excitable mode vkbl model column full pdmp vkbl model. ﬁrst dynamics mrnas second dynamics activator inhibitor heterodimer complex insets longer time series. prove coherence stochastic cycling randomness unbinding events propagates nonlinearly contributes overall uncertainty stochastic cycle period. example ‘episode’ serial stochastic unbinding number synthesized inhibitors random quantity subsequently determines time titrate produced back zero promoter state deterministically cycle back actively producing state turned attention model studied vilar whose schematic shown fig. vkbl model activator activates addition inhibitor thus exhibit deterministic limit cycles. however authors deliberately studied vkbl model parameter deterministic limit cycles system exhibited excitation-relaxation noise-induced oscillations. below pdmp analysis show stochastic promoter ﬂuctuations responsible kicking stable ﬁxed point excitable excursion. vkbl model given sample path pdmp faithfully captures signature dynamics full parameter regime noise-induced oscillations; compare figs. pdmp takes account stochasticity binding unprocesses described deterministic evolutionary equations. thus conclude noiseinduced oscillations full discrete binding unbinding events promoter site. full pdmp system conproduces bursty activator mrna population however occasionally unbinding event takes longer usual leads larger-than-average number activator mrnas. larger-than-average number activators titrates inhibitors critical accumulation activator excites system large excursion phase space; fig. alternative deterministic limit vkbl model exhibit excitable excursions shown fig. deﬁnition exhibit variability binding unbinding events. lack excitable excursions consistent idea rare ﬂuctuations unbinding times critical ingredient generating enough activators titrate inhibitors system. dynamical models gene expression often assume switching promoter states takes place much shorter timescale processes model. idealisation known quasi steady-state adiabatic approximation uses eﬀective rate inferred quasi-stationary distribution promoter states. timescale promoter state switching comparable processes typically case natural systems approach fails describe resulting dynamics accurately. article investigated stochastic dynamics biological clocks non-adiabatic regime. previous work demonstrated time delays arise slow promoter switching nonadiabatic regime important emergence deterministic limit cycles. studies modeled transcription rate ensemble-averaged transcription rate discrete promoter states. treatment would precise large copy number independent promoters e.g. models however copy number genomic small many biological systems transcription rate given time discrete values switching timescale fast promoter state goes large numbers cycles consecutive transcription events eﬀective rate transcription converges ensemble-averaged transcription rate. however switching timescale slow averaged transcription rate cannot capture nature alternating rates transcription events. eﬀects non-adiabatic promoter ﬂuctuations investigated mostly numerically literature biological clocks. studies potoyan wolynes gonze reported slower switching rates compromise coherent oscillation seen deterministic limit. slightly diﬀerent model feng observed coherent oscillation binding unbinding events either fast slow last stochastic resonance reported showed exists ‘sweet spot’ promoter switching neither fast slow. above-mentioned studies adopted methods range direct computation eigenvalues truncated chemical master equation direct computation stationary distribution direct continuous-time markov simulations power spectral analyses generated sample paths although straightforward carry analyses reveal little mechanisms stochastic oscillations. example methodologies could answer system promoter binding sites exhibits coherent oscillation quantify impact mrna post-translational reactions e.g. dimerisation. present mathematical framework analyse stochastic dynamics gene expression nonadiabatic regime. framework begin detailed description individual-molecularbased stochastic dynamics chemical master equation systematically construct piecewise deterministic markov processes retains discrete stochastic switching nature genetic states. framework natural generalisation previous work derived pdmp shown powerful mathematical tool model coloured noise stochastic gene expression analyses showed models investigated pdmp faithfully captures dynamical features individual-molecular-based models. proposed scheme construct alternative ‘deterministic description’ dynamics without invoking adiabatic assumption. analytical tools revealed emergent non-equilibrium transitions between discrete genetic states non-adiabatic regime. idealised models exhibited stochastic cycling discrete genetic states. showed robust coherent oscillation occurred regime slower dissociation rate analysis also revealed interactions between population transition discrete genetic states showing necessary consider joint process describing dynamics gene switching dynamics. joint process markovian known dynamics alone non-markovian. work showed gene switching dynamics alone also non-markovian. illustrate practicality analytical tools analysed sophisticated detailed models. interestingly models investigated analysis revealed diﬀerent mechanisms induce oscillations. model found oscillation induced slow-transitions discrete-genetic states similar idealised models. nevertheless contrast idealised model exhibits similar dynamics sion mrna model pushes system transit genetic states. product gene i.e. mrna longer directly regulates production rate delay. since predominant stochasticity system arises random unbinding events ability travel internal stages decreases coeﬃcient variance. consequently coherent oscillations observed model compared idealised models. applying analytical tools vkbl model able show average genetic switching events suﬃcient induce oscillation. instead longer-than-average binding events responsible exciting fitzhugh-nagumo-like system large excursion phase space. biologically longer-than-average binding events called transcriptional bursting noise. straightforward show increasing translational bursting achieved simultaneously scaling translation rate scaling transcription rate also induce similar oscillations ﬁnal note pdmp derived detailed chemical master equation viewed hybrid model combines continuous deterministic dynamics discrete stochastic promoter switching dynamics. pdmp therefore promising ‘bridge model’ connecting detailed mechanistic computational models supported center nonlinear studies alamos national laboratory partially engineering physical sciences research council epsrc supported national institutes health directors innovator award burroughs wellcome fund casi award", "year": "2017"}