{"title": "Optimizing scoring function of dynamic programming of pairwise profile  alignment using derivative free neural network", "tag": "q-bio", "abstract": " A profile comparison method with position-specific scoring matrix (PSSM) is one of the most accurate alignment methods. Currently, cosine similarity and correlation coefficient are used as scoring functions of dynamic programming to calculate similarity between PSSMs. However, it is unclear that these functions are optimal for profile alignment methods. At least, by definition, these functions cannot capture non-linear relationships between profiles. Therefore, in this study, we attempted to discover a novel scoring function, which was more suitable for the profile comparison method than the existing ones. Firstly we implemented a new derivative free neural network by combining the conventional neural network with evolutionary strategy optimization method. Next, using the framework, the scoring function was optimized for aligning remote sequence pairs. Nepal, the pairwise profile aligner with the novel scoring function significantly improved both alignment sensitivity and precision, compared to aligners with the existing functions. Nepal improved alignment quality because of adaptation to remote sequence alignment and increasing the expressive power of similarity score. The novel scoring function can be realized using a simple matrix operation and easily incorporated into other aligners. With our scoring function, the performance of homology detection and/or multiple sequence alignment for remote homologous sequences would be further improved. ", "text": "graduate school information sciences tohoku university sendai japan artiﬁcial intelligence research center national institute advanced industrial science technology tokyo japan proﬁle comparison method position-speciﬁc scoring matrix accurate alignment methods. currently cosine similarity correlation coefﬁcient used scoring functions dynamic programming calculate similarity pssms. however unclear functions optimal proﬁle alignment methods. least deﬁnition functions cannot capture non-linear relationships proﬁles. therefore study attempted discover novel scoring function suitable proﬁle comparison method existing ones. firstly implemented derivative free neural network combining conventional neural network evolutionary strategy optimization method. next using framework scoring function optimized aligning remote sequence pairs. nepal pairwise proﬁle aligner novel scoring function significantly improved alignment sensitivity precision compared aligners existing functions. nepal improved alignment quality adaptation remote sequence alignment increasing expressive power similarity score. novel scoring function realized using simple matrix operation easily incorporated aligners. scoring function performance homology detection and/or multiple sequence alignment remote homologous sequences would further improved. proﬁle comparison alignment method positionspeciﬁc scoring matrix accurate alignment methods. pssm dimensional vector sequence length. element vector consists dimensional numerical vector value represents likelihood existence amino acid position biological sequence. here designed vector inside pssm position-speciﬁc scoring vector proﬁle alignment cosine similarity correlation coefﬁcient generally calculated pssvs calculate similarity dissimilarity sites sequences interest dynamic programming proﬁle alignment methods using functions successful long time although cosine similarity correlation coefﬁcient cannot capture non-linear relationship vectors similarity sites always expressed linear relationships. performance proﬁle sequence alignment improved various studies past decades. example hhalign improved alignment quality using proﬁles constructed hidden markov model provided information pssm muster incorporated protein structural information proﬁle mrfalign utilized markov random ﬁelds improve alignment quality although various methods devised different perspectives studies develop scoring function sophisticated technologies lacking. neural networks computing system mimic biological nervous system animal brains. theoretically approximate function regardless linearity functions neural networks attracting attention various areas research including bioinformatics availability improved computational methods explosive increase available data. recent years algorithms vigorously applied bioinformatics. example several studies applied deep neural network model predict protein-protein interaction protein structure various biological conditions residue contact backbone angles solvent accessibility algorithms basically used backpropagation method requires derivation cost function searching optimal parameters studies implemented derivative free neural network. study utilized neural network optimize scoring function. process ﬁrst combined pssvs derived sites input vector. target vector required implement supervised learning. however case target vector ideal function ideal similarity score site unknown thus scoring function could directly optimized. instead calculated entire table input sequences difference between resultant alignment correct alignment used calculating cost. case could backpropagation method optimal weight search because lacked derivation cost function required search. namely could incorporate idea conventional neural network framework. therefore newly utilized covariance matrix adaptation evolution strategy adaptive optimization method modifying basic evolutionary strategy search method neural network realize derivative free neural network calculation. using framework attempted produce higher performance scoring function remote sequence alignment study. downloaded non-redundant subset scop sequence identity sequence pair less astral selected remote sequence subset since wanted improve remote sequence alignment quality. scop protein domain dataset sequences classiﬁed hierarchical manner class fold superfamily family. notations superfamily dataset sorted alphabetical order superfamilies ordered numbers multiples three classiﬁed learning dataset whereas others classiﬁed test dataset. obtained sequences learning test datasets respectively. next randomly extracted maximum pairs sequences superfamily negate bias induced different volumes superfamily used sequence pairs subsequence construction pssm. conﬁrmed sequences pair family obtain decent reference alignment. finally obtained sequence pairs learning test datasets. figure schematic diagram learning network developed study. upper case letters italics bold face lower case letters italics bold face lower case letters italics represent matrix vector scalar values respectively. activating function represented figure shows learning network computed study. calculated similarity scores pssvs using neural network. ﬁrst summation matrix products neural network calculated. resultant vector transformed activating function finally summation products transformed vector calculated. resultant value used similarity score sites. namely forward calculation computed following equation. here similarity score. complete table calculated using similarity score ﬁnal pairwise alignment produced. pairwise alignment corresponding reference alignment compared alignment sensitivity score described below calculated. subtraction alignment sensitivity score used cost searching optimum weight neural network cma-es. number units middle layer rectiﬁed linear unit utilized activation function. respectively parameters cma-es. here almost equivalent step size gradient descent method indicate number descendant survival individuals evolutional process. actual learning read training datasets batch manner. learning loop stopped using early stopping criteria checking dissociation training validating curves. initial weight derived parameters mimicked correlation coefﬁcient. generate initial weight randomly generated pssm pairs learned using multilayer perceptron hyperparameters identical hyperparameters. addition weights simultaneously optimized open extension penalties. initial values open extension penalties alignment quality evaluated using alignment sensitivity precision alignment sensitivity calculated dividing number correctly aligned sites number non-gapped sites reference alignment. contrast alignment precision calculated dividing number correctly aligned sites number nongapped sites test alignment. relative accessible surface area residues proteins learning test dataset calculated areaimol package version residues rasa less counted interior residue residues counted surface residue according previous study divided ratio interior residues background probability residues calculate residue interior propensity. residue interior propensity likelihood residue existing inside protein. namely propensity greater signiﬁes probability residue inside protein high. functions changing open extension penalties increments respectively. best alignment sensitivity selected optimum combination among combinations open extension penalties. shown table best penalty combination cosine similarity correlation coefﬁcient next conducted optimization scoring function neural network cma-es. learning randomly divided learning dataset subsets namely training validation datasets included pairwise pssv sets corresponding reference alignments targets respectively. since calculation cma-es parameter settings requires times epoch consumption computer resources large calculation time long even threads used program; therefore maximum limit epoch small number selected best scores validation scores last ﬁfth part entire epoch obtained ﬁnal weight bias matrices namely substance novel scoring function optimal penalty combination respectively. result optimal combination open extension penalty ﬁnal weight bias matrix approximately finally implemented pairwise proﬁle aligner weight bias matrices novel scoring function named neural network enhanced proﬁle alignment library aligner scoring function downloaded https//github.com/yamada-kd/nepal. next conducted benchmark test nepal aligners existing functions test dataset. addition proﬁle comparison methods examined performance sequence comparison aligners difference substitution matrices blosum miqs reference. used open extension penalties respectively based previous study calculating alignment qualities test dataset ﬁrst conducted penalty optimization existing scoring functions cosine similarity correlation coefﬁcient learning dataset. computed alignment sensitivity precision aligners using open extension indicate optimized open extension penalties respectively cosine represent aligners cosine similarity correlation coefﬁcient scoring functions respectively. categorized remote medium subset depending pairwise sequence identity reference alignments. remote medium subset includes sequence pairs sequence identity lower less lower less respectively. generally pairwise alignment sequences lower identity twilight zone difﬁcult table shows alignment quality scores method. results show among existing methods including sequence comparison methods method best performance perspectives proﬁle comparison method correlation coefﬁcient scoring function. contrast nepal improved alignment sensitivity precision compared method. actually improvements statistically signiﬁcant according wilcoxon signed rank test bonferroni correction even signiﬁcance level comparison sequencebased methods different substitution matrices miqs blosum showed gain improvement miqs compared blosum signiﬁcant remote subset medium subset. expected since miqs originally developed improve remote homology alignment. trend observed regarding relationship nepal correlation coefﬁcient implemented aligner nepal improved alignment sensitivity precision remote medium subsets respectively. indicated novel scoring function optimized remote sequence alignment. expected sequence alignment sequences closer identities easier remote identities. therefore optimization novel scoring function would optimized naturally advantageous remote sequence alignments. since problem regarding remote relationship holds true sequence similarity search novel scoring function method could useful improving performance remote similarity search methods. finally calculated importance attributes using connection weight method shown figure connection weights attribute namely amino acid distributed various values. indicated developed scoring function discerned importance attributes depending variety amino acids. according results connection weight hydrophobic residues higher value. residues located mostly inside hydrophobic cores proteins. addition shown figure residues also tend locate inside proteins higher importance. contrast residues tend locate protein surface lower importance. spearman’s rank correlation coefﬁinterval second line header represents sequence identity division. methods cosine miqs indicate proﬁle comparison methods cosine similarity correlation coefﬁcient sequence comparison methods miqs blosum. double asterisks score indicate p-value wilcoxon signed rank test bonferroni correction method compared nepal. cient connection weight interior propensity approximately value statistically significant residues exposed protein surface subject higher mutation pressures interior residues less susceptible mutation protein structure disrupted mutations interior residues collapse hydrophobic core scoring function constructed study optimized alignment remote homologous sequences. according previous study based substitution matrices hydrophobicity residues dominant property remote sequence substitution rather simple mutability. fact partially represents remote sequence alignment residues occupying interior locations protein higher order structure less susceptibility mutation pressure considered meaningful. since scoring function also optimized remote sequence alignment property would observed fact paradoxically suggests scoring function optimized remote sequence alignment. collectively property reasons superiority method existing ones. addition although connection weight consisted various values would least contribute increasing expressive power novel scoring function. example wanted calculate similarity score pssv shown figure original scores calculated using correlation coefﬁcient nepal score respectively scores calculated correlation coefﬁcient change sites sites swapped. unexpected since converted pssv obtained swapping identical original one. could drawbacks usoped novel scoring function proﬁle comparison nepal pairwise proﬁle aligner scoring function. large computational resources required learning procedure derivative free neural network; thus could examine whether learning converged enough limited computational environment. nevertheless nepal signiﬁcantly improved alignment quality proﬁle alignment especially alignment remote relationships compared existing scoring functions. nepal improved alignment quality adaptation remote sequence alignment increasing expressive power similarity score. novel scoring function realized using simple matrix operation parameters provided https//github.com/yamada-kd/nepal. future performance distant homology detection method multiple sequence alignment method remote homologous sequences improved scoring function. figure transition similarity scores depending site swapping. panel stand pssv respectively. middle panel represents original pssv similarity scores calculated correlation coefﬁcient nepal. bottom panel stands resultant pssvs similarity scores. figure absolute connection weight attribute corresponds proﬁle value amino acid. filled open represents positive negative sign original connection weight respectively. residue interior propensity whole data study. unweighted linear function cosine similarity correlation coefﬁcient. contrast nepal scores changed swapping varied change pssv. actually overlaps calculated similarity score places decimal randomly generated million pssvs using correlation coefﬁcient whereas approximately overlaps nepal used. overlaps would negatively affect computation higher overlap scores would cause difﬁculty deciding correct path especially during computation maximum three values derived diagonal left side cell. collectively different weights based amino acid variety presented connection weight method reasons nepal score improved alignment quality compared existing scoring functions. grateful kentaro tomii satoshi omori tsukasa nakamura constructive discussion. computations partially performed supercomputer rois national institute genetics. cma-es covariance matrix adaptation evolution strategy; dynamic programming; pssm position-speciﬁc scoring matrix; pssv position-speciﬁc scoring vector", "year": "2017"}