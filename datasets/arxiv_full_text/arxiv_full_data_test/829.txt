{"title": "Model-free inference of direct network interactions from nonlinear  collective dynamics", "tag": "q-bio", "abstract": " The topology of interactions in network dynamical systems fundamentally underlies their function. Accelerating technological progress creates massively available data about collective nonlinear dynamics in physical, biological, and technological systems. Detecting direct interaction patterns from those dynamics still constitutes a major open problem. In particular, current nonlinear dynamics approaches mostly require to know a priori a model of the (often high dimensional) system dynamics. Here we develop a model-independent framework for inferring direct interactions solely from recording the nonlinear collective dynamics generated. Introducing an explicit dependency matrix in combination with a block-orthogonal regression algorithm, the approach works reliably across many dynamical regimes, including transient dynamics toward steady states, periodic and non-periodic dynamics, and chaos. Together with its capabilities to reveal network (two point) as well as hypernetwork (e.g., three point) interactions, this framework may thus open up nonlinear dynamics options of inferring direct interaction patterns across systems where no model is known. ", "text": "topology interactions network dynamical systems fundamentally underlies function. accelerating technological progress creates massively available data collective nonlinear dynamics physical biological technological systems. detecting direct interaction patterns dynamics still constitutes major open problem. particular current nonlinear dynamics approaches mostly require know priori model system dynamics. develop model-independent framework inferring direct interactions solely recording nonlinear collective dynamics generated. introducing explicit dependency matrix combination block-orthogonal regression algorithm approach works reliably across many dynamical regimes including transient dynamics toward steady states periodic non-periodic dynamics chaos. together capabilities reveal network well hypernetwork interactions framework thus open nonlinear dynamics options inferring direct interaction patterns across systems model known. chair network dynamics institute theoretical physics center advancing electronics dresden technical university dresden dresden germany. network dynamics planck institute dynamics self-organization goettingen germany. racah institute physics hebrew university jerusalem israel. department microbiology molecular genetics hebrew university jerusalem israel. school computer science hebrew university jerusalem israel. fakultät technik informatik hamburg university applied sciences hamburg germany. bernstein center computational neuroscience goettingen germany. department physics technical university darmstadt darmstadt germany. correspondence requests materials addressed j.c. m.t. xðtþ xðtþ; xnðtþ state entire system consisting units variables dxðtþ=dt denotes represents ðtþ; temporal derivative ξðtþ external noise acting whole system smooth typically nonlinear function assume unknown. common examples regulation functions models gene regulatory networks rate laws metabolic systems. recorded discrete time points system identiﬁcation aims reveal exact functional form exactly predict systems future. owing high dimensionality networks identiﬁcation typically restricted even impossible. address problem slightly essentially different manner asking only variables directly acts given unit thus explicitly appears right hand side reveal pairwise smooth function speciﬁes represents deterministic evolution component external noise acting explicit dependency matrix selects variables directly control rate change thus going beyond related graph-theoretical notions adjacency incidence matrices thereby emphasizing aspects dynamics ﬁrst offers uniform representation pairwise higher-order interactions; second thus suitable generic dynamical systems representations appears exactly right hand side regulatory circuits metabolic systems– communication distribution supply networks derived direct interactions parts. determining systems connected help understanding controlling function. current nonlinear dynamics approaches recover direct interactions collective dynamics system mathematical model provided advance unknown parameters network links nonlinear terms determined–. models however usually hand experimental conditions thereby constraining applicability methods examples. recent works lowlimited number dimensional systems suggest approximating dynamics expansions basis functions reveal interaction patterns dynamics admits sparse representation proposed basis. recent model-free approach takes account nonlinear network dynamics requires externally drive systems controlled thus enabling reconstruction experimental settings particular settings. common model-free approaches range considering nonlinear system dynamics construct functional links detecting statistical dependencies thus prone recover indirect interactions among common external inputs decorrelating effects induced units network–. although latest efforts pairwise statistical dependencies recent studies show functional links match direct connections speciﬁc homogeneity conditions rarely occur real-world systems. article propose novel concept inferring direct interactions coupled dynamical systems relying nonlinear collective dynamics neither assuming speciﬁc dynamic models known advance assuming dynamics admits sparse representation imposing controlled drivings expecting statistical dependencies faithfully reveal direct physical interactions. achieve goal change perspective units network provide direct physical interactions given unit appear right hand side differential equation rather asking details interaction functions among units. demonstrate problem inferring direct interactions based observed nonlinear dynamics posed multivariate regression problem introducing explicit dependency matrix thereby systematically decomposing units dynamics pairwise three-point higher-order interactions units network. decompositions provide restricting equations mapping collective dynamics direct interactions. validate characterize predictive power approach successfully revealing structure generic well speciﬁc biological model systems. model systems exhibit complex noisy dynamics transient dynamics toward steady states periodic non-periodic dynamics chaos standard pairwise well hypernetwork interactions. interaction networks even revealed units measured results mapping time series direct interactions. understand information time series contains direct interactions networks consider system whose time evolution fig. sampling dynamics spaces reveal network structure. determines mapping state space components rates change deﬁning smooth manifold determined two-stage decomposition unknown functions ﬁrst interactions different orders units network second interaction basis functions thereby resulting linear system restricting connectivity structure. quality inferences versus number measurements continuous sampling takes observed dynamics long trajectory sample time steps; distributed sampling takes short time series sample time steps starting different initial conditions creating longer time series length initial conditions randomly drawn uniform distributions deﬁned interval tions units unit speciﬁcally decomposition separates contributions unit arising different orders e.g. pairwise higherorder interactions units system. deﬁned that j;j;;jk indices disappear right hand side indicates number basis functions employed expansion c.f. ref. thus provided time series sufﬁciently small reliably estimate time derivatives _xi;m revealing direct interactions becomes identifying non-zero coefﬁcients right hand side best estimated _xi;m. expansions differ qualitatively developed refs. since neither require functions represented exactly basis functions chosen condition admit sparse representation basis. instead require functions form basis relevant thereby additionally allowing investigator choose basis functions appearing explicitly particular reduced requirement implies that tinguishable from) zero dependency weaker requirement sufﬁcient impose structure blocks zero non-zero coefﬁcients representing absent existing interactions respectively thereby posing mathematical regression problem grouped variables–. solve structured problems developed algorithm revealing network interactions greedy approach based block orthogonal least squares algorithm. speciﬁcally approach takes time series units network inputs returns ranked list interactions indicating order interactions right hand side identiﬁed strongly lowering cost function remark intend recover actual functional form interactions instead determining existence absence interactions units. even scheme infers optimal model given time series guaranteed model would agree actual model generating dynamics. indeed fact units interacting given unit details coupling functions enables robust performance across systems revealing direct links model systems. demonstrate robustness approach inferred interactions model systems compared results obtained thresholding correlations partial correlations transfer entropy. particular selected quantities model independent traditionally used quantify interactions networked systems. tested framework systems displaying diverse types collective dynamics transient dynamics toward steady states nonperiodic dynamics chaotic noisy dynamics emerging models michaelis menten kinetics gene regulation generic heteroclinic generic chaotic oscillatory dynamics. measured quality reconstruction terms area receiver-operating-characteristic curve score score equals perfect reconstruction equals predictions equivalent random guessing. predictions improve longer time series well composing long time series different short ones illustrated non-periodic dynamics fig. indicates sampling sufﬁcient parts state space essential revealing direct network interactions. generally found long time series available compositions short time series least equally fig. inferring interactions transients steady state non-periodic dynamics. simulated short transient time series time points starting different initial conditions created composite longer time series fig. thus number distinct transient dynamics. revealing interactions transients toward steady state. adjacency matrix network units michaelis–menten kinetics incoming connections. example transient dynamics toward steady states quality inferences respect using approach correlations partial correlations transfer entropy revealing interactions non-periodic dynamics. adjacency matrix network phase-coupled oscillators incoming connections unit. example derivatives several oscillators. quality reconstruction short trajectories respect appropriate reconstruction e.g. fig. exemplary tests demonstrate even time series short time points recorded dynamics different trajectories evolving toward steady state might sufﬁcient. moreover reconstruction quality improves total number available recordings number experiments contrast inferences thresholding correlations partial correlations transfer entropy cannot predict existing interactions minimal sampling conditions moreover time series extracted non-periodic dynamics conﬁrms larger numbers recordings improve quality again correlations partial correlations transfer entropy general less capable capturing intrinsic structure interactions equally minimal conditions interactions still recovered networks higher-dimensional units extending include components number components unit fig. a–c. performance. characterize performance approach carried systematic reconstructions various networks different sizes numbers incoming connections unit noise levels fraction higher-order interactions number hidden units report four classes results. first number time points necessary scores larger threshold scales sublinearly size network fig. linearly number incoming connections unit fig. moreover inferring incoming connections single units large sparse networks conventional hardware takes unit. results highlight potential applicability approach combination parallel computing revealing interactions real-world networks often large size sparsely connected. second depends supralinearly noise level fig. here sampling longer time series improves reconstruction quality. results indicate inference still viable highly noisy dynamics expense recording longer reconstructions fig. inferring interactions noisy chaotic dynamics. reconstruction chaotic oscillator networks incoming interactions. rössler oscillators constitute subnetworks three interconnected units. example noisy derivatives rössler oscillator. quality reconstruction transient trajectories respect using approach correlations partial correlations transfer entropy hypernetwork interactions exemplary models phase-coupled oscillators suggest results independent probability hypernetwork interactions fig. consequence treating pairwise higher-order interactions equally decomposing coupling orders jointly acting units explicit dependency matrices thus approach insensitive appearance higher-order interactions. finally even units network measured existing non-existing links among measured units still reliably inferred fig. compute scores compare predictions existence absence links among measured units actually existing existing among units making statement indirect interactions mediated hidden units. units hidden quality reconstruction decreases hidden units upon measured units unknown way. still sampling longer time series improves reconstruction quality. thereby model-free approach provides accurate predictions even fraction network recorded. proper basis functions learning curves. selecting appropriate class basis functions represent network interactions system vital approach. choosing basis functions capture intrinsic nature interactions construction yields optimal results. however exactly pick correct interaction function requires prior knowledge potential functions involved coupling units system consideration. overcome limitation appropriate classes coupling functions require pick correct function former implies basis functions correct order latter implies unique basis functions capable ﬁtting recorded dynamics remark particularly chosen basis function constitutes representative entire class appropriate functions. instance functions indexed table equally appropriate representatives class pairwise functions selecting different basis functions. example shown fig. studied networks phase-coupled oscillators divided time series training inferring interactions validation evaluating predictions; functional forms cost function depending number interactions considered either l-shaped indicating number incoming connections knee thereby revealing features network simultaneously reveal number incoming connections ﬁrst interactions actually chosen provide full information units directly unit remark that sufﬁciently short sampling intervals ﬁndings conﬁrm basis functions merely capture essential structure interactions necessarily exactly represent reveal network connectivity. consequence reconstruction direct network interactions possible without preknowlegde system model. effects noise hidden units. experimentally relevant biological settings several uncontrolled factors affecting recorded time series. instance gene networks noisy dynamics simultaneously present several different levels fundamentally noise complicates inference process corrupting measurements units dynamics thereby masking network interactions. moreover complete access measure units network. induce correlating decorrelating effects among units thus promoting recovery indirect interactions. test robustness approach combination noise hidden units simulated transients toward steady states external inﬂuence gaussian noise recorded dynamics subset randomly selected units network. results indicate noise hidden units fig. performance networks hypernetworks. minimum length time series required achieving score versus number units logarithmic inset shows data logarithmic scale. number incoming interactions ﬁxed networks. versus linear networks ﬁxed size versus standard deviation noise level exponential inset shows data logarithmic scale. cartoon networks systematic reconstructions hypernetworks phase-coupled oscillators varying ﬁxed systematic reconstructions networks units versus fraction observed units fig. learning curves respect number iterations reveal appropriate expansions. learning curves basis functions shown table indices table equal panel identiﬁcation. training validation sets composed recordings respectively. basis functions chosen appropriate class curve exhibits l-shape clear plateau starting correct number incoming interactions adding interactions reduces ﬁtting costs weakly all. basis functions chosen inappropriate class cost functions decrease mildly exhibit l-shape moderately reduce performance approach fig. however inference quality still increases fig. interaction topology. moreover systematic reconstructions different sets recorded units indicate predictions generally outperform extracted correlations partial correlations transfer entropy. robust inference biological networks. next establish potential framework reconstruct interactions biological system settings. speciﬁcally demonstrate results networked model biological systems glycolytic oscillator yeast circadian clock drosophila. glycolytic oscillator exhibiting classical examples cellular oscillations accounts main reactions glycolysis. fig. reconstructions still viable units hidden measurements noisy. revealing direct interactions within subset units noisy transients toward steady states. network size ﬁxed representation network subset measured units subset hidden units noise-free noisy transients. quality reconstruction versus number measurements employing approach correlations partial correlations transfer entropy subset recorded units. systematic reconstruction different collections subsets. variable indicates fraction recorded units. averages random subsets indicate approach outperforms correlations partial correlations transfer entropy across different values different basis functions employed represent speciﬁc interaction. basis functions correct order likely reveal true interactions functions incorrect order fig. basis function belongs class radial basis functions xijp represent p-th center expansion focus model anaerobic glycolytic oscillations yeast containing inﬂux glucose outﬂux pyruvate and/or acetaldehyde circadian clock underlies biological response day–night cycle oscillations exhibits drosophila driven negative feedback genes complex formed proteins code for. model equations circadian clock based ref. employing approach combining dynamics space representation expanding suitable families basis functions solving resulting linear regression problem orthogonal least squares method reconstructed interactions different components glycolytic oscillator circadian clock transient dynamics toward periodic orbits. systems’ settings results conﬁrm larger number observations improve predictions. moreover reconstruction quality method outperforms resulting correlations partial correlations transfer entropy. discussion proposed model-free framework inferring direct interaction networks time series collective nonlinear system dynamics. first deﬁning notion explicit dependency matrices enabled systematically decompose units’ dynamics pairwise three-point higher-order interactions time treat present inﬂuences unit another footing independently interaction order. second capturing structure dynamical inﬂuences appropriately chosen basis functions posed reconstruction problem based nonlinear dynamics mathematical regression problem grouped variables. given reconstructions sets incoming connections different units network mathematically independent framework scalable computationally parallelizable large networks. reconstruction robust across wide range dynamical regimes combined pairwise hypernetwork interactions noise hidden units. main advantage framework minimal sampling conditions. instance systems transients steady states periodic orbits reconstructed direct interactions without need know actual strength actual distributed patterns perturbations states. contrast several previous studies framework general require apply external driving signals system externally driven e.g. create transients signals need controlled; thus framework might suitable systems easily accessible controlled driving external driving all. moreover collections short time series practice potentially resulting different experiments system sufﬁcient reconstruction. particular collective dynamics transient stochastically driven otherwise sufﬁciently complex helps revealing interactions whereas certain stable dynamics low-dimensional subsets state space dynamics space thus sample limited regions fig. reconstructing biological model systems. revealing interactions glycolytic oscillator yeast. glycolytic oscillator network green links represent network hypernetwork interactions respectively. quality reconstruction transient trajectories function circadian clock network drosophila. quality reconstruction principle provide full information network interactions. lower-dimensional dynamics particular induced symmetries invariants represented algebraic conditions instance systems evolving synchronized states existence directionality interactions impossible extract time series. furthermore number independent measurements required successful reconstruction grows linearly local number interaction partners sublinearly number units network providing advantage reconstructing large systems. illustrated examples framework easily combined learning curves derivable recorded data thus enables researchers determine accuracy inferences ground truth available. previous studies inferring direct interaction structure time series focused reconstruction networks known local dynamics coupling functions–. prior knowledge reduces task standard linear algebra problem solve linear systems equations reveal network connections ref. comprehensive review. recent work low-dimensional dynamical systems based expanding system dynamics basis functions requires dynamics admit sparse representation proposed basis. moreover work applying extension method described ref. models gene regulation also suggests approaches scale supralinearly dimensionality network number candidate coupling functions time points necessary successful reconstruction. theory presented neither require prior knowledge parameters coupling functions involved network dynamics require functions admit sparse representations basis chosen; limited low-dimensional networked systems also number necessary time points successful reconstruction scales sublinearly network size. taken together model-free robust framework based collections short time series noisy data partially inaccessible units essentially arbitrary nonlinear dynamics thus enable reconstruction direct interaction networks dynamical data range times series coupled dynamical systems model known. methods overview. generate dynamical trajectories displaying transients toward steady states simulated dynamical systems employing michaelis–menten kinetics systems frequently used model gene regulation. generate dynamical trajectories exhibiting transients periodic dynamics employed biological model systems glycolytic oscillations yeast circadian clock drosophila possess hypernetwork interactions units jointly directly inﬂuence third interaction function cannot disentangled sums pairwise interactions. study effects non-periodicity simulated networks phase-coupled oscillators whose coupling stems simple model weakly coupled populations biological neurons–. finally test robustness chaos noise simulated networks noisy asynchronous rössler oscillators prototypical systems studying chaos. networks hypernetworks phase-coupled oscillators. generate nonperiodic dynamics simulated model phase-coupled oscillators coupling functions fourier modes data availability. data reported study available corresponding authors upon request. example codes simulating reconstructing network dynamical systems found https//github.com/networkinference/ arni. represents concentration glucose glyceraldehydes-phosphate dihydroxyacetone phosphate pool -bisphosphoglycerate cytosolic pyruvate acetaldehyde pool nadh sthat extracellular pyruvate acetaldehyde pool. quinn coleman kiyavash hatsopoulos estimating directed information infer causal relationships ensemble neural spike train recordings. comput. neurosci. acknowledgements thank fabio schittler neves benedict lünsmann fenna müller useful discussions. m.t. thanks albert laszlo barabasi hospitality useful discussions visit march acknowledge support german research foundation open access publication funds dresden. work supported german science foundation grant toward center excellence center advancing electronics dresden also gratefully acknowledge support federal ministry education research planck society. author contributions authors conceived research contributed materials analysis tools. j.c. m.t. developed theory algorithms designed research. authors provided model systems quality measures. j.c. m.n. s.h. carried numerical experiments. authors analyzed data discussed interpreted results wrote manuscript. open access article licensed creative commons attribution international license permits sharing adaptation distribution reproduction medium format long give appropriate credit original author source provide link creative commons license indicate changes made. images third party material article included article’s creative commons license unless indicated otherwise credit line material. material included article’s creative commons license intended permitted statutory regulation exceeds permitted need obtain permission directly copyright holder. view copy license visit http//creativecommons.org/ licenses/by/./.", "year": "2018"}