{"title": "In Praise of Artifice Reloaded: Caution with subjective image quality  databases", "tag": "q-bio", "abstract": " Subjective image quality databases are a major source of raw data on how the visual system works in naturalistic environments. These databases describe the sensitivity of many observers to a wide range of distortions (of different nature and with different suprathreshold intensities) seen on top of a variety of natural images. They seem like a dream for the vision scientist to check the models in realistic scenarios.  However, while these natural databases are great benchmarks for models developed in some other way (e.g. by using the well-controlled artificial stimuli of traditional psychophysics), they should be carefully used when trying to fit vision models. Given the high dimensionality of the image space, it is very likely that some basic phenomenon (e.g. sensitivity to distortions in certain environments) are under-represented in the database. Therefore, a model fitted on these large-scale natural databases will not reproduce these under-represented basic phenomena that could otherwise be easily illustrated with well selected artificial stimuli.  In this work we study a specific example of the above statement. A wavelet+divisive normalization layer of a sensible cascade of linear+nonlinear layers fitted to maximize the correlation with subjective opinion of observers on a large image quality database fails to reproduce basic crossmasking. Here we outline a solution for this problem using artificial stimuli. Then, we show that the resulting model is also a competitive solution for the large-scale database. In line with Rust and Movshon (2005), our report (misrepresentation of basic visual phenomena in subjectively-rated natural image databases) is an additional argument in praise of artifice. ", "text": "subjective image quality databases major source data visual system works naturalistic environments. databases describe sensitivity many observers wide range distortions seen variety natural images. seem like dream vision scientist check models realistic scenarios. however natural databases great benchmarks models developed carefully used trying vision models. given high dimensionality image space likely basic phenomenon under-represented database. therefore model ﬁtted large-scale natural databases reproduce under-represented basic phenomena could otherwise easily illustrated well selected artiﬁcial stimuli. wavelet+divisive normalization layer sensible cascade linear+nonlinear layers ﬁtted maximize correlation subjective opinion observers large image quality database fails reproduce basic crossmasking. outline solution problem using artiﬁcial stimuli. then show resulting model also competitive solution large-scale database. line report additional argument praise artiﬁce. data think machine learning applied representative databases automatically lead accurate models problem hand. instance problem modeling perceptual diﬀerence between images showed discussion eventual challenges nips- metric learning workshop however despite interesting implications visual neuroscience subjective metric image space dismissed trivial regression problem subjectively-rated image quality databases used training supervised learning. subjective image video quality databases certainly major source data visual system works naturalistic environments. databases describe sensitivity many observers wide range distortions seen variety natural images. seem like dream vision scientist check models realistic scenarios. fact following tradition links image quality assessment problem engineering human visual system models subjectively rated image databases used models coming classical psychophysics physiology given similarity biological models feedforward convolutional neural nets interesting analogy possible. fitting biological models reproduce opinion observers database algorithmically equivalent learning stage deep networks. deep-learning-like databases convenient train physiologically-founded architecture reproduce psychophysical goal using biologically-founded approaches parameters found straightforward interpretation instance frequency bandwidth system extent interaction sensors tuned diﬀerent features. hand pure machine-learning approaches also used predict subjective opinion. case extracting features reasonable statistical meaning perceptual inspiration generic regression techniques applied problem uses naturalistic databases conventional concern training sets machine learning training balanced representation range behaviors explained? case resulting model biased dataset generalization problems. overﬁtting risk recognized authors image quality metrics based generic regression perceptually meaningful architectures impose certain constraints ﬂexibility model opposed generic regressors. constraints could seen sort occam razor favour lower-dimensional models. however even biologically meaningful cases risk model found ﬁtting naturalistic database misses well-known texture perception facts. accordingly used artiﬁcial stimuli learning stage check contrast sensitivity function properties visual masking. message large-scale naturalistic databases used carefully trying vision models. given high dimensionality image space likely basic phenomenon under-represented database. result model forced reproduce under-represented phenomena. work study speciﬁc example generalization risk suggested above. show wavelet+divisive normalization layer sensible cascade linear+nonlinear layers ﬁtted maximize correlation subjective opinion observers large image quality database fails reproduce basic crossmasking. point problem outline solution using well selected artiﬁcial stimuli. then show model corrected account extra artiﬁcial tests also competitive explanation large-scale naturalistic database. line results work namely pointing misrepresentation basic visual phenomena subjectivelyrated natural image databases proposed procedure additional argument praise artiﬁce. paper organized follows section illustrates intuition obtained proper artiﬁcial stimuli opposed not-so-obvious interpretation natural stimuli. section shows sensible psychophysical model tuned maximize correlation subjective opinion largescale naturalistic image quality database fails reproduce basic properties visual masking illustrated simple artiﬁcial stimuli. section propose route solution change formulation model allows intuitive solution failures artiﬁcial stimuli preserving success large-scale naturalistic database. finally suggested failure-and-solution example considered work section discuss opportunities precautions subjectively rated databases vision models. figure shows representative subset kind patterns subjectively rated image quality databases. speciﬁc example comes database databases natural scenes corrupted noise sources diﬀerent nature ratings depend visibility test seen natural background. considered distortions come diﬀerent suprathreshold intensities. cases intensities controlled energy contrast general come arbitrary scales obvious psychophysical meaning. motivation original databases assessment distortions occurring image processing applications necessarily tool vision science. recent databases include accurate control luminance color backgrounds distortions report intensities distortions units perceptual ratings diverse sets certainly provide great ground truth check vision science models naturalistic conditions. however result variety backgrounds tests seen clear interpretation terms speciﬁc perceptual mechanisms controlled statistics representation physiological meaning. even though speciﬁcally directed subjectively rated databases also main drawback pointed generic natural images vision science experiments. work step criticism uncontrolled nature natural scenes somewhat arbitrary distortions found databases diﬀerent aspects speciﬁc perceptual phenomenon fully represented database. therefore databases used carefully training models misrepresentation consequences ﬁtting models. instance let’s consider pattern masking true distortions databases introduce relatively noise high contrast regions seems appropriate illustrate masking. case jpeg jpeg artifacts called masked noise database deviations high contrast regions less visible equivalent deviations energy backgrounds. diﬀerence visibility inhibitory eﬀect surround masking actually perceptual improvements image coding standards critically depend using better masking models allow using less bits regions appropriate prediction visibility distortions database come accurate model texture masking. however systematic examples illustrating diﬀerent aspects masking certainly present databases. therefore phenomenon under-represented database. fortunately basic texture perception facts easily illustrated using artiﬁcial stimuli. artiﬁcial stimuli designed speciﬁc perceptual phenomenon mind using patterns speciﬁc consequences models model/phenomenonbased stimuli standard classical psychophysics physiology. figure example power well controlled artiﬁcial stimuli represents number major texture perception phenomena single ﬁgure. ﬁgure shows basic tests increasing contrast left right. series tests respectively shown background backgrounds controlled frequency orientation. second visibility depend frequency test. note lower frequency test visible high frequency test illustrates eﬀect contrast sensitivity function figure natural scenarios complex distortions. illustrative subset subjectively rated image quality database variety distortions naturalistic environment. pictures right-end). means slope mechanisms mediating response high lower amplitudes saturates afterwards. sort weber-like behavior contrast distinct feature contrast masking finally visibility decreases background energy depending spatio-frequency similarity test background. note instance frequency test less visible frequency background high frequency background. equivalently note visibility high frequency test behaves around bigger frequency test. moreover masking eﬀect bigger bigger contrasts background. adaptivity nonlinearity distinct feature masking eﬀect importantly distinct feature real neurons regard simpliﬁed neurons used deep learning result looking ﬁgure imagine visibility curves versus contrast test series stimuli presented. figure shows experimental example kind response curves versus contrast obtained actual neurons masking situations. even qualitative ideas used discard models figure experimental response neurons masking situations. adapted schwartz simoncelli cavanaugh important stress decay response test mask spatio-frequency characteristics opposed case reproduce expected behavior importantly relative visibility artiﬁcial stimuli also used intuitively tune parameters model better reproduce expected behavior done artiﬁcial stimuli crafted clear interpretation standard model texture vision v-like wavelet neurons interacting cross-inhibitions. figure illustrates fact note test patterns considered ﬁgure mainly stimulate speciﬁc subband -scale -orientation steerable wavelet pyramid commonly used formalism model sensors. result easy select sensors drive visibility descriptor model intuitive energy distribution pyramid true backgrounds stimulate corresponding subband result given distribution test backgrounds pyramid imagine cross-inhibition strategies lead required decays response. intuitions obtained artiﬁcial model-oriented stimuli fundamental criticise results obtained blind learning database propose intuitive improvements model. vision science cascades linear +nonlinear transforms successful modeling number perceptual experiences example perceptions color motion spatial texture tightly related l+nl models similar functional form figure advantages artiﬁcial stimuli. model-related construction stimuli simplify reproduction results form model outputs straightforward interpretation results. spatial vision model based cascade isomorphic l+nl layers addressing turn brightness contrast computation frequency sensitivity energy masking multi-scale oriented analysis frequency masking. presented mathematics required parameters canonical cascade according diﬀerent strategies jacobian transform w.r.t. image allows novel psychophysics based building model-related artiﬁcial stimuli select right parameters architecture e.g. using maximum diﬀerentiation techniques jacobian transform w.r.t parameters allows parameter learning according speciﬁc goal. latter formally similar training phase deep networks fundamental diﬀerence case proposed goal related sensible psychophysical task training physiologically plausible architecture canonical divisive normalization. thanks strategies program suggested became computational model four stages psychophysically tuned work together ﬁrst time. detailed formulation base-line canonical model given methods section layers model namely contrast energy masking determined using model-based artiﬁcial-stimuli strategy; layers namely brightness wavelet divisive normalization determined using natural-database strategy. fact since work focused mathematics strategies arbitrary illustration correctness proposed analytical results. beyond formal correctness results extensively checked diﬀerent ways analyze practical eﬀects eventual limitations strategy based learning natural uncontrolled large-scale databases. that work focus layer wavelet divisive normalization. layer model intended account scale orientation analysis frequency masking pretty standard follows canonical l+nl structure linear stage -scale orientation steerable wavelet transform output previous layer; nonlinear stage divisive normalization transform wavelet coeﬃcients. assuming output wavelet ﬁlter-bank vector assuming vector energies coeﬃcients obtained coeﬃcient-wise rectiﬁcation element-wise hadamard quotient energy linear response divided linear combination energies neighboring coeﬃcients wavelet pyramid. linear combination i-th matrix tells responses neighbor sensors vector attenuate response i-th sensor numerator attenuating eﬀect linear combinations moderated semisaturation constants vector structure vectors matrices relevant understand behavior stimuli. first must consider vectors wavelet-like structure. fig. shows subband structure speciﬁc artiﬁcial stimuli fig. shows natural stimuli. important stress speciﬁc distribution responses natural images subbands response vector critical reproduce good behavior model database. note regular wavelet transform response vector. therefore distribution tells statistics natural images behavior visual system. hand true natural images relatively energy low-frequency end. figure response model natural images. given luminance distribution initial layers model compute ﬁltered version brightness contrast adaptation lower contrasts divisive normalization finally linear part layer computes multi-scale multi-orientation decomposition then responses nonlinearly interact given structure representative vector responses depicted bottom relevant understand assumed interactions eventual modiﬁcations required. usual wavelet literature data vector organized high-frequency low-frequency vertical lines indicate limits diﬀerent scales. within scale dashed lines pink indicate limits diﬀerent orientations. diﬀerent coeﬃcients within scale/orientation block correspond diﬀerent spatial locations. average line green shows average amplitude subband natural images. discussed text speciﬁc energy distribution scale relevant good performance model. hand visually relevant response sensors tuned high frequency details keep certain relation response sensors tuned frequency details. latter line diﬀerent visibility artiﬁcial stimuli diﬀerent frequency shown fig. probably eﬀect ﬁlter earlier stages model. important keeping relative magnitude subbands crucial good alignment subjective opinion large-scale database. assumed gaussian interaction kernels following assumed intraband interactions keep equations simple still illustrating generality analytical results. moreover simplicity reason reports suggest intraband relations relevant interactions terms improving correlation subjective opinion. optimization width amplitude gaussian kernel subband well semisaturation parameter subband results referred model fig. spatial-only intraband relations lead symmetric block diagonal kernels. optimization acted width amplitude kernels subband. similarly optimization lead bigger semisaturation frequencies performance resulting model naturalistic database certainly good compare correlation model subjective opinion fig. opposed widely used structural similarity index included useful reference. given diﬀerence correlation regard ssim certainly model highly successp two-dimensional location modulus spatial frequency orientation. this referred optimization phase even though optimization phase using full variability correlations higher restrict optimization phase want keep number parameters small. phase optimization database used training. despite reasonable formulation base-line model successful performance reproducing subjective opinion large-scale naturalistic databases simple simulation kind artiﬁcial stimuli presented section shows reproduce aspects basic visual masking. speciﬁcally computed response curves highlighted neurons fig. low-frequency high-frequency tests like illustrated fig. function contrast. considered four diﬀerent contrasts background. diﬀerent orientations background also considered. positive side following. first response increases contrast. second response frequency test bigger response high frequency test. third response saturates contrast. also increasing contrast background decreases response. however contrarily looking artiﬁcial stimuli response high frequency test decay high frequency backgrounds. decay behavior roughly lowfrequency test deﬁnitely high-frequency test. compare decays signal circles highlighted fig. response sensors tuned high-frequency test decays amount presented low-frequency backgrounds background also high-frequency. model failing here. stated above beneﬁts artiﬁcial model-oriented stimuli limited identiﬁcation failures. models interpretable model-based stimuli also suggest intuitive ways modify model case shortcomings. section heuristically modify model provided blind optimization applying intuition obtained artiﬁcial stimuli associated simulation response curves. ﬁne-tune artiﬁcial stimuli preserving good performance natural database. figure relative success failures optimized model. model-related construction stimuli simplify reproduction results form model outputs straightforward interpretation results. failure observed fig. consists strong inﬂuence lowfrequency activity response high-frequency sensors. therefore ﬁrst natural idea including extra inter-band relations only-intra-band kernel model following consider interaction mediated gaussian function depends distance location sensors also modulated additional gaussian interactions depending diﬀerence scales orientations model normalization kernel controlled diagonal matrix contains vector normalization constants diagonal. considering symmetry gaussians perceptually appropriate introduce extra matrices break symmetry generalized kernel case detailed control required cint subband-wise full matrix diagonal matrix vector diagonal. note applies column-wise weights ﬁnal kernel equivalently selectively weights energy subbands input vector means used moderate eﬀect low-frequency importantly could speciﬁc block full matrix cint relation speciﬁc subbands modiﬁed. moreover second relevant intuition modiﬁcations kernel ineﬀective semisaturation constants high. note denominator divisive normalization balance linear intuitions start playing however eﬀect low-frequency easy reduce using ideas relative amplitude responses high frequency inputs also easily lost. quickly ruins csf-like behavior reduces performance large-scale database. lose relative amplitudes responses model natural images keep good performance. unfortunately model unstable kind modiﬁcations making diﬃcult tune. order solve scaling problems convenient include global scaling factor sets dynamic range responses particularly relative amplitude diﬀerent scales. term brackets modiﬁed expression refer model response still follows nonlinear divisive normalization input arrives reference value ensure scale output given vector reference value related dynamic range input signal neural layer. global scaling factor related dynamic range want impose output neural layer. detailed formulation layer model namely matrix formulation forward transform jacobian inverse given section interested reader. code matlab implementation model model available http//isp.uv.es/docs/biomultilayer_l_nl_a_and_b.zip. modiﬁcations model kernel general stabilized sensible dynamic range output. then model ready intuitive modiﬁcations considered above. starting point heuristic exploration straightforward translation model model refer model naive. starting point consists importing values parameters model except modulations depending scale orientation. assumed reasonable interaction lengths octave degrees used extra weights break symmetry values also come model parameters model naive shown fig. idea starting point model naive reproducing behavior model build there. figure shows ﬁne-tuned parameters according heuristic described above. note strongly reduced applied bigger reductions high-frequency bands vein increased values global scale kernels high frequencies reducing substantially amplitudes low-frequencies preserve previous behavior finally importantly moderated eﬀect low-frequencies masking using small weights low-frequency scales increasing values high frequency. note reduces columns corresponding low-frequency subbands ﬁnal kernel around high-frequency scales. implies bigger eﬀect high-frequency backgrounds attenuation high-frequency sensors reducing eﬀect low-frequency. figure parameters modiﬁed models. left panel shows interaction matrix semisaturation vector ﬁrst guess model called naive semisaturation amplitudes kernel imported optimized case. panel right shows corresponding parameters ﬁne-tuned version model moreover figure shows ﬁne-tuned version model works better artiﬁcial stimuli also preserves success natural image database. probably positive eﬀect ﬁxing relative magnitude responses model failure model something could relevant question expected? unfortunate answer failure surprising given unbalanced nature large-scale databases. note model somewhat rigid fundamental problem despite speciﬁc phenomenon present database right amount force model reproduce learning stage. true model included intra-band relations note also that even though wanted introduce general kernels model future developments solution problem considered basically came including ingredients already present model course problem hard solve obvious decide advance kind phenomena present database result databases almost necessarily unbalanced biased original intention creators database. made full analysis texture masking note focus masking important arbitrary example stress main message. equivalent limitations aﬀecting parts optimized model come speciﬁc features database. instance luminance-to-brightness transform known strongly nonlinear highly adaptive modeled using canonical divisive normalization also alternative nonlinearities nonlinearity shown relevant statistical eﬀects however ﬁtting layers simultaneously reproduce subjective opinion naturalistic database even though found consistent increase correlation behavior ﬁrst layer turned almost linear. constant controlling eﬀect anchor luminance turned high. again reasons result dynamic range database require stronger nonlinearity front-end incidentally even though deeper philosophical issue still debate case studied praise artiﬁcial stimuli also praise interpretable models. models interpretable easier problems failures synthetic model-related stimuli. example problem solution described limited divisive models adaptation. following also applied interpretable models subtractive wilson-cowan equations tuning parameters describe relations sensors. would diﬃcult possible data-driven methods. criticism naturalistic databases eventual unbalance problem interpreting complicated stimuli terms models mean claim absolute rejection naturalistic databases. all. case studied suggests databases carefully selected artiﬁcial stimuli considered safetycheck biological plausibility. course intention case studied exhausting search possibilities claim obtained sort optimal solution. instead wanted stress fact using appropriate stimuli easy propose modiﬁcations model right direction still represent competitive solution naturalistic database. intuitive jump local minima biologically plausible diﬀerent region parameter space. fact sensible procedure would alternating diﬀerent learning epochs using natural artiﬁcial data large-scale naturalistic databases coming image processing community enforce main trends system speciﬁc small-scale artiﬁcial stimuli coming vision science community ﬁne-tune ﬁrst order approximation resulting model appropriate features revealed speciﬁc experiments. context standardization eﬀorts done organizations standard spatial observer really important make double-check. general perspective feel image processing applications fundamental interest visual neuroscience applications broader context relative relevance diﬀerent phenomena described classical psychophysics physiology. instance check variations performance testing vision models diﬀerent complexity approach oriented check diﬀerent perceptual modules speciﬁc applications applied image quality databases also domains perceptual image video compression perceptual image denoising enhancement diﬀerent applications show relative relevance improvements masking models regard better csfs including sensible motion estimation models front better texture perception models. case analyzed work illustrates eﬀect using database texture masking probably under-represented. lesson learn take account phenomena database created examples illustrate point databases controlled observation distance accurate chromatic calibration appropriate spatial frequency bandwidth models achromatic chromatic channels. databases spectrally controlled illumination pairs appropriate address chromatic adaptation models. databases high-dynamic range appropriate point need nonlinearity brightness perception. finally databases visibility incremental patterns carefully controlled contrast terms best option masking models opposed generic subjectively-rated image distortion databases. previous literature criticised complex natural stimuli vision science experiments statistics stimuli diﬃcult control conclusions biased interaction poorly controlled input complexities neural model consideration. line precautions natural stimuli make diﬀerent point general criticism blind machine learning largescale databases also applies using subjectively rated image databases vision models. using variety natural scenarios distortions cannot guarantee speciﬁc behaviors properly represented thus remaining hidden vast amount data. situation models seem right structure miss basic phenomena. instead easier problems simpler modeloriented artiﬁcial stimuli qualitative illustrative experiments. case study considered suggests artiﬁcial stimuli help stress problems remain models ﬁtted unbalanced natural image databases suggest modiﬁcations models. incidentally also argument favour interpretable parametric models opposed data-driven pure-regression models. sensible procedure general purpose vision models would alternating diﬀerent learning epochs using uncontrolled natural stimuli well-controlled artiﬁcial stimuli check biological plausibility point. section introduce detailed formulation model model provide links general purpose software implements models required stimulus synthesis. addition introduce speciﬁc routines general purpose software generate particular stimuli trial-and-error procedure parameters leading responses right qualitative properties. generation illustrative stimuli proposed require generation random noise accurate control spatial frequency luminance contrast appropriate rendering display hand. done using generic routines basicvideotools order take account sensible sampling frequency corresponding central frequencies orientations selected wavelet ﬁlters model. next subsections detailed information models associated software. speciﬁc software used paper generate stimuli compute response curves available http//isp.uv.es/docs/artificereloaded.zip. starting point analysis illustrative model referred model follows program suggested cascade four isomorphic l+nl layers focused diﬀerent psychophysical factor mathematics model required parameters detailed software implementing model also generalized model available http//isp.uv.es/docs/biomultilayer_l_nl_a_and_b.zip. note software multilayer architecture uses standard spatial observer steerable wavelet matlabpyrtools please cite sources well using code. below reader convenience brieﬂy recall expressions series forward l+nl transforms model represents system depends parameters applies series transforms input radiance vector series intermediate response vectors here layer convolutional ﬁlters linear part canonical divisive normalization nonlinear part. transforms performed speciﬁc layer described below where matrix color matching functions spatial location. particular restricting achromatic information required color matching function would spectral sensitivity wyszecki stiles fairchild leading luminance spatial location. nonlinear part canonical divisive normalization hadamard products quotients expressed using diagonal matrices nonlinear transform weber-like adaptive saturation abrams similar nonlinear behavior assumed opponent chromatic channels fairchild stockman brainard laparra didnt implemented color version model. regard local brightness kernel numerator represents convolution two-dimensional gaussian. kernel denomnormalization inator another two-dimensional gaussian kernel leads standard convolution matrix equivalent application contrast sensitivity function campbell robson rows matrix consist displaced versions center-surround receptive ﬁelds kernel denominator represents convolution another two-dimensional gaussian computes local contrast energy masks responses high-energy environments. matrix gabor-like receptive ﬁelds corresponding v-like sensors simoncelli adelson kernel denominator represents masking interaction sensors tuned diﬀerent space frequency orientation watson solomon focus paper eﬀect training stage large-scale naturalistic databases. despite reasonable formulation base-line model successful performance reproducing subjective opinion large-scale naturalistic databases fails reproducing basic visual masking phenomena. tively; omit superindices indicating layer subsection always referring th-layer. main text also simplicity refer energy linear outputs models provide forward transform also jacobian inverse; matrix notation. simply list results jacobian inverse proof reader convenience. however provided toolbox routine numerically checks jacobian compares inverse actual input. input autonormalization case dynamic range input average value subband averages suubands computed diagonal blocks corresponding subband diagonal matrix divides corresponding dimension wavelet subband thus leading average. apparently complicated matrix expression average simplify derivative regard stimulus depends subband amplitude gaussian kernel also depends subband. given already nonlinear nature input diﬀerence normalization factor mean subbands over-weighted regard others. included matrices compensate eﬀects necessary. note applies column-wise weights ﬁnal kernel equivalently selectively weights energy subbands input vector means used moderate eﬀect speciﬁc subband big. importantly could speciﬁc block full matrix cint relation speciﬁc subbands modiﬁed. work qualitative behavior i.e. cint remained all-ones matrix. finally global normalization controlled vector diagonal matrix contrary case auto-adaptation coming back certain reference unknown. nevertheless inverse still obtained iteratively. starting certain guess obtain ﬁrst guess inverse using n-th guess ·|yn|γ inverse derive guess reference work conceived fabrica hielo reaction c.a. parraga scientists cannot easily substituted machines. work partially funded mineco/feder/eu projects cicyt tec--exp cicyt bfu--r tin-p; european research council starting grant ref. icrea academia award.", "year": "2018"}