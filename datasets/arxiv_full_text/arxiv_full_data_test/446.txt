{"title": "From Correlation to Causation: Estimation of Effective Connectivity from  Continuous Brain Signals based on Zero-Lag Covariance", "tag": "q-bio", "abstract": " Knowing brain connectivity is of great importance both in basic research and for clinical applications. We are proposing a method to infer directed connectivity from zero-lag covariances of neuronal activity recorded at multiple sites. This allows us to identify causal relations that are reflected in neuronal population activity. To derive our strategy, we assume a generic linear model of interacting continuous variables, the components of which represent the activity of local neuronal populations. The suggested method for inferring connectivity from recorded signals exploits the fact that the covariance matrix derived from the observed activity contains information about the existence, the direction and the sign of connections. Assuming a sparsely coupled network, we disambiguate the underlying causal structure via $L^1$-minimization. In general, this method is suited to infer effective connectivity from resting state data of various types. We show that our method is applicable over a broad range of structural parameters regarding network size and connection probability of the network. We also explored parameters affecting its activity dynamics, like the eigenvalue spectrum. Also, based on the simulation of suitable Ornstein-Uhlenbeck processes to model BOLD dynamics, we show that with our method it is possible to estimate directed connectivity from zero-lag covariances derived from such signals. In this study, we consider measurement noise and unobserved nodes as additional confounding factors. Furthermore, we investigate the amount of data required for a reliable estimate. Additionally, we apply the proposed method on a fMRI dataset. The resulting network exhibits a tendency for close-by areas being connected as well as inter-hemispheric connections between corresponding areas. Also, we found that a large fraction of identified connections were inhibitory. ", "text": "knowing brain connectivity great importance basic research clinical applications. proposing method infer directed connectivity zero-lag covariances neuronal activity recorded multiple sites. allows identify causal relations reﬂected neuronal population activity. derive strategy assume generic linear model interacting continuous variables components represent activity local neuronal populations. suggested method inferring connectivity recorded signals exploits fact covariance matrix derived observed activity contains information existence direction sign connections. assuming sparsely coupled network disambiguate underlying causal structure l-minimization known prefer sparse solutions. general method suited infer eﬀective connectivity resting state data various types. show method applicable broad range structural parameters regarding network size connection probability network. also explored parameters aﬀecting activity dynamics like eigenvalue spectrum. also based simulation suitable ornstein-uhlenbeck processes model bold dynamics show method possible estimate directed connectivity zero-lag covariances derived signals. study consider measurement noise unobserved nodes additional confounding factors. furthermore investigate amount data required reliable estimate. additionally apply proposed method full-brain restingstate fast fmri datasets. resulting network exhibits tendency close-by areas connected well inter-hemispheric connections corresponding areas. addition found surprisingly large fraction third identiﬁed connections inhibitory nature. networks brain understanding function dysfunction depending methods employed assess structure record activity networks deﬁned diﬀerent levels resolution. nodes individual neurons linked chemical electrical synapses. alternatively nodes also conceived populations neurons links represented eﬀect synaptic connections exist populations. case deﬁnes structural substrate brain connectivity representing physical basis neuronal interactions. nodes brain network inﬂuence sending signals. example activities nodes network generally independent neuronal dynamics characterized correlations among nodes involved network. suggests alternative perspective active brain networks functional connectivity assigns link pair nodes degree activities correlated. argued concept emphasizes connections matter including possibility substrate give rise diﬀerent networks depending used. consequence functional connectivity structural connectivity equivalent. well-known phenomenon nodes correlated even direct anatomical link them. example shared source input nodes generate correlation correspond direct interaction nodes. apart that correlation symmetric relation nodes whereas physical connection implies cause-eﬀect relation directed. have fact multiple attempts overcome shortcomings functional connectivity especially lack directed interaction. term eﬀective connectivity suggested idea bring networks inferred activity measurements closer structural connectivity inferred anatomical methods. dichotomy structural functional aspects connectivity raises general question whether possible infer brain networks recorded activity. beginning understand forward link structural connectivity functional connectivity. consequence possible compute correlations connectivity certain simpliﬁed network scenarios correspondence connectivity correlation however one-to-one. networks diﬀerent connectivity lead exactly correlations nodes. consequence inverse problem inferring connectivity correlation generally ill-deﬁned. demonstrate paper additional assumptions connectivity help resolve ambiguity. speciﬁcally search network lowest number nonzero edges disambiguate problem. structural functional eﬀective connectivity equally well accessible. aspects anatomical structure assessed post mortem invasive tracing methods non-invasively diﬀusion tensor imaging dti. contrast functional connectivity based statistical relationships activity neuronal populations easily estimated recorded signals. estimating eﬀective connectivity methods like dynamic causal modelling granger causality others methods infer eﬀective connectivity however deal large numbers nodes based zero-lag correlation only. however either limited small networks directed acyclic graphs here proposing method estimation eﬀective connectivity population activity brain especially bold-related signals. method variant procedure described based l-minimization. method proposed suﬃcient zero-lag covariances estimate directed eﬀective connectivity. similarly assuming linear interaction model presence collider structure network produces speciﬁc entries corresponding inverse covariance matrix. shows disconnected network left column network induces covariance matrix links opposite direction middle column. latter case estimation direction impossible simply information covariance matrix. whenever collider structure present however entry inverse covariance matrix source nodes non-zero. fact linear model entry inverse covariance matrix depends connections nodes also whether nodes common target. means presence collider structure allows disambiguate direction particular connection. consider scenario interaction nodes described generic linear model. assuming stationarity neural activity implicitly deﬁned consistency equation figure collider structures encoded inverse covariance matrix. upper three simple network architectures. lower corresponding inverse covariance matrices color represents positive entries blue color stands negative ones. left middle column entries diﬀerence right column middle column connection node ﬂipped nodes form collider structure. although still indirect connection node entry corresponding inverse covariance matrix non-zero. model assume components external ﬂuctuating input pairwise stochastically independent nodes. then diagonal matrix make additional assumption linear model considered here relation covariance connectivity exploited estimation connectivity correlation. case given matrix product last term contributes information collider structures. non-zero oﬀ-diagonal entry corresponding nodes outgoing connections terˆ minating node means nodes form collider. clear unitary matrix product still solution resolve ambiguity minimization known prefer sparse solutions certain conditions order given ﬁrst initial matrix search unitary matrix minimal minimizing variable name node activity network connectivity external inputs cross-spectral density covariance external input unitary matrix l-norm cost function gradient initial matrix wiener process stationary covariance matrix simulation step time constant activity regularisation-controlling parameter regularized icov cost function hermitian matrix unitary. means starting point uact choosing appropriate step size obtain point unew expuact words point smaller l-norm still satisﬁes condition b∗u∗newunewb. iterating procedure convergence leads point locally minimal l-norm. fulﬁlled. values used listed table convergence cost function typically oscillates around certain value. avoid stopping random phase oscillation ﬁnal step apply line-search details supporting information algorithm described gradient descent algorithm provides eﬃcient minimizing calculating gradient neglect diagonal. consequently also neglect diagonal resulting estimated matrix able study self connections nodes. many ways choose property found following choice eﬃcient cross-spectral density positive deﬁnite ˆc−. thus exactly positive deﬁnite square root calculated critical part optimization selection appropriate step size. step size large might miss minimum. step size small optimization converges slowly. gradient descent adaptive scheme inspired step-size depends largest eigenvalue actual gradient λmax largest eigenvalue dact step size given constant. intuition behind that smooth cost functions along geodesic unitary manifold almost periodic. step size fraction period function. achieved scaling largest eigenvalue allows take scale-invariant fraction period. assume interactions among neuronal populations described linear model model allows derive relation connectivity matrix network inverse cross-spectral density matrix measured activity given sampled connectivity matrix calculate inverse covariance matrix directly using simulations half connections negative connections absolute strength connections repetitions simulated. connectivity proﬁles used random erd˝os-r´enyi networks. validate inference procedure applying network inference measurements neuronal activity simulated stationary signals. since gold-standard simulations fmri data based simulations ornstein-uhlenbeck process provides simple linear model neural activity. above. ﬁnal step ﬁlter time series canonical hemodynamic response function match data obtained brain scans sampled temporal resolution used random connectivity proﬁles connection probability negative entries spectral radius parameters used listed more table estimating connectivity simulations known underlying network structure quantify performance estimation. measuring accuracy estimation employ three diﬀerent methods. first area roc-curve curve obtained following possible parameter value number true-positives false-positives used calculate true-positive rate false-positive rate fp/. curve obtained plotting true-positive-rate false-positive rate. secondly average precision score area precision-recall curve. also includes false-negatives equal connections network perfectly estimated. sample curves shown thirdly calculate pearson correlation coeﬃcient contrast measures deﬁned also take strength sign interactions account. also means measure less suited assess whether connection exists not. rather measures whether estimated connections strength original ones. consider three performance measures simultaneously establish quality estimates. seven healthy subjects underwent -minute resting-state fmri experiment siemens prisma scanner. data acquired using mreg sequence yielding high temporal resolution figure networks inferred simulated ornstein-uhlenbeck process.a shows original network. shows network inferred method zero-lag covariances. white black entries indicate true negative true positive connections blue entries indicate false negative false positive connections respectively. example performance measures depicts sample covariance matrix directly estimated data. consequence symmetry number wrongly estimated connections quite high performance measures shows receiver operating characteristic curve precision recall curve networks estimated zero-lag covariance gest blue/orange functional connectivity green/red. areas curves respectively. additionally cardiac respiratory signals recorded abdominal breathing band scanner’s physiological monitoring unit. motion correction done physiological noise correction performed retroicor average white matter signals regressed global signal regression performed. following image normalization space voxels parcellated according atlas mean activity within atlas region calculated. connectivity estimated using zero-lag covariances standardized signals. intrinsic properties estimation procedure identiﬁed studying performance method perfectly estimated covariance matrices. address properties depend particular feature underlying data success measurement process. particular show types networks estimation procedure gives good results technical grounds wide range networks hopefully including arising applications. used random erd˝os-r´enyi connectivity proﬁles simulations. macro-connectivity neuronal populations satisfy certain conditions order tractable methods. conditions concern dynamic stability network strength interactions. trade-oﬀ number physical links resulting strength macro-connections dynamic stability network. study performance method various regimes separately varied network size default values parameters used study time systematically varied. values spectral radius correspond networks weak recurrent interaction high values networks strong interaction respectively. according model network interaction assumed here networks need spectral radius network interaction present dynamics stable. first results indicate certain minimal level interaction necessary able estimate connections reliably. value ρmin inﬂuence spectral radius performance estimation weak larger spectral radius better estimation gets. spectral radius constant according shows estimation works well sparse matrices connection probability range networks higher connection probability equally strong connections performance decreases expected bias associated l-minimization. even connection probability fraction estimated connections false negative false positive. correctly estimated connections correct sign. applications focus estimation often lies strongest connections network. networks background weak connections sparse skeleton stronger connections possible selectively estimate figure eﬀects spectral radius connection probability network size consider case noise-free covariance matrices created based theory underlying model. quantities considered area curve precision recall score pearson correlation coeﬃcient shaded areas indicate mean standard deviation computed realizations. network interaction larger ρmin relatively little eﬀect performance estimation. even extreme case close estimation works well. performance estimation diﬀerent sparsity levels encoded respective connection probabilities expected non-sparse networks performance algorithm degrades dramatically. performance estimation increasing network size. results indicate clearly bigger networks better reconstructed. applicability limited numerical eﬀort associated optimization. performance estitmation presence weak background connections. nevertheless possible infer skeleton strong connections high ﬁdelity. strong links although strictly assumption sparse network violated. shows performance method networks networks consist skeleton strong connections connection probability connection strength derived additionally created second network weaker connections various connection probabilities networks combined adding connectivity matrices. connection strength weaker connections also derived spectral radius background network spectral radius skeleton network. performance estimation calculated respect skeleton strong connections. thirdly applicable broad range data types method connectivity estimation perform stable diﬀerent network sizes common types non-invasive recordings population activity number nodes considered range course possible consider larger networks although estimation becomes computationally expensive. runtime algorithm networks nodes still range seconds state-of-the-art desktop computer even networks nodes tractable. order create surrogate data fast fmri data simulated interacting stochastic processes known ornstein-uhlenbeck processes. case performance network inference depends well inverse covariance matrix basis estimation derived data. addition ﬁnite size eﬀects studied impact observation noise performance used default values parameters. generally seems natural welch’s method calculate cross-spectral densities directly estimate connectivity frequency band separately. data described here however estimate connectivity zero-lag sample covariances time domain. possible mass covariance function concentrated close around contributing integral covariance function corresponds cross-spectral density figure performance network inference based simulated ornstein-uhlenbeck processes. colors performance estimation measurement noise added. performance estimation parts network observable. fraction observed nodes network indicated x-axis. total number nodes network case fmri usually whole brain scanned unobserved nodes network. however data types parts brain observed. question whether sub-network nevertheless reconstructed recorded signals. model scenario took simulated data removed randomly certain subset components dataset. interaction removed nodes part covariance matrix reduced dataset although unobserved nodes course still exert inﬂuence observed ones. performance estimation sub-network based reduced dataset shown analysis shows clearly estimation still leads reasonable results conditions. fact demonstrate inferring causal connections only unconnected observed nodes latent node connected method factor reliable estimation covariance matrix amount data available. depends length measurement simulation sampling rate. since fast fmri time series obtained measuring bold response proxy neuronal activity time scale measured data relatively slow compared time scale underlying neuronal activity. shows performance network inference depending amount data available time-scale neuronal activity. surprisingly voluminous dataset better estimation gets. hand shows estimation generally leads better results slower temporal dynamics. also data suﬃcient length fairly good signal-to-noise ratio estimation connectivity possible even part network observed. allow comparison method known methods network inference applied netsim dataset provided details result this please supporting information. estimated connectivity seven fast fmri datasets details methods section. resulting networks threshold applied consist connections dataset. threshold chosen arbitrarily. supporting information show histogram estimated connection strengths seven reconstructed networks thresholding. threshold derived strongest connections disregarding signs. generally full ground truth connectivity inferred human fmri recordings available cannot deﬁnitely assess degree result inference correct. however establish whether plausible. representative connectivity matrix shown average connections inhibitory negligible variability across subjects. connections found found four subjects more possible connections absent subjects. average connections bi-directional connections identiﬁed direction. general close-by areas likely connected distant ones. fact represented concentration connections along secondary diagonals within-hemisphere blocks. also frequent inter-hemispheric connections corresponding areas. fact represented diagonal entries across-hemisphere blocks. figure left panel directed connectivity estimated method sample mreg data set. voxels parceled using aal-atlas. top-left block connectivity matrix connections within left hemisphere shown lower-right block connections within right hemisphere. oﬀ-diagonal blocks represent inter-hemispheric connections left right hemisphere right left hemisphere strength connections color coded representing positive connections blue representing negative connections. strongest connections shown. right panel functional connectivity matrix derived data. mentioned above diﬀerent heuristics suggested reconstruct networks neuronal signals. compare performance method propose established method regularized inverse covariance based implementation provided https//fsl.fmrib.ox.ac.uk/fsl/fslwiki/fslnets. comparison clearly shows method performs signiﬁcantly better regularized inverse covariance method mainly because latter cannot establish direction connections. superior performance method reﬂected higher values three performance measures particular pcc. regularization parameter required software toolbox used furthermore applied method seven mreg datasets described before. threshold applied strongest connections retained. compare outcome methods condidered existence connections disregarded weights directions representative example comparison methods shown possible connections identiﬁed four subjects seven corresponding number method possible connections. method produced directed networks connection probability random would yield average count less connections agree least four seven independently generated networks. average possible connections identiﬁed methods connections found neither methods. means methods agree connections average. methods disagreed remaining connections. figure comparison performance regularized inverse covariance method based numerical simulations ornstein-uhlenbeck processes. shown results reconstruction diﬀerent networks erd˝os-r´enyi connectivity proﬁles described method method respectively shown side-by-side. figure estimated networks representative mreg dataset. left panel shows symmetrized network reconstructed estimation method middle panel shows network found method. right panel shows connections identiﬁed methods none methods connections found connections found method method described method estimate directed signed eﬀective connectivity neural populations measured brain signals based zero-lag covariances only. investigate reliability estimated connections used simulations ornstein-uhlenbeck processes mimicking bold-related signals generated interacting neuronal populations. method shows good performance enough data available observation noise strong. also even cases relatively poor performance estimated connections correct sign. applying method measured fast fmri data found identiﬁed connections inhibitory eﬀect respective target population. general inhibitory synapses mainly formed within local populations typically project distant targets. inhibitory connection populations however also achieved excitatory neurons preferentially terminating inhibitory neurons target region. comparison regularized inverse covariance method shows good agreement regard existence connections. directions cannot disambiguated method. results based simulated surrogate data reﬂect would expect design estimation procedure. large sparse networks suﬃciently strong interaction network estimation procedure works reliably. however expected network sparse time series short quality estimate drops. nevertheless cases main interest lies strongest connections reliably estimated method even network sparse. experimental data shown individual connections unreliable limited size dataset. also unclear whether biological network analyzed really sparse assumption pairwise independent external input really justiﬁed. hand higher likelihood coupling close-by areas inter-hemispheric counterparts resulting network looks plausible. interpreting individual connections longer recordings would certainly beneﬁcial. also could temporal information additional frequency bands. high interest also comparison structural measures ones obtained diﬀusion tensor imaging. best knowledge authors ﬁrst time eﬀective whole-brain connectivity estimated zerolag covariances. methods rely lagged covariances correct parameter critical needs inferred exponential decay observed auto-covariances. also proposed method detect directed inhibitory connections wholebrain scale. estimation procedure fast easy apply. uses temporal information method also applied data types rely bold eﬀect e.g. fnirs also data types measuring electrical population activity directly. makes good candidate among things studying changing connectivity neurodegenerative diseases like parkinson’s alzheimer’s. presented method estimate directed eﬀective connectivity whole-brain scale. also able detect whether connections excitatory inhibitory. estimation possible based zero-lag covariances also applied frequency-resolved cross spectral densities. figure histogram estimated connection strengths taken reconstructed networks seven subjects. vertical lines show thresholds excitatory inhibitory connections figure performance inference method netsim dataset published methods also tested simulated data sets x-axis represent indices simulated data sets original publication. y-axis shows estimations. estimated connectivity every individual subject applied threshold resulting networks averaged available subjects/trials. although networks considered paper cover range parameters found method performs sub-optimally still performs reasonably well synthetic data. obtained average values respectively. supported facilities funded state badenw¨urttemberg bwhpc grant inst fugg. thank grauer bernstein center freiburg well bernd wiebelt michael janczyk freiburg university computing center assistance issues.", "year": "2017"}