{"title": "Programming Discrete Distributions with Chemical Reaction Networks", "tag": "q-bio", "abstract": " We explore the range of probabilistic behaviours that can be engineered with Chemical Reaction Networks (CRNs). We show that at steady state CRNs are able to \"program\" any distribution with finite support in $\\mathbb{N}^m$, with $m \\geq 1$. Moreover, any distribution with countable infinite support can be approximated with arbitrarily small error under the $L^1$ norm. We also give optimized schemes for special distributions, including the uniform distribution. Finally, we formulate a calculus to compute on distributions that is complete for finite support distributions, and can be compiled to a restricted class of CRNs that at steady state realize those distributions. ", "text": "question primary importance. shown noise functional role cells indeed critical functions depend stochastic ﬂuctuations molecular populations would impossible deterministic setting. instance noise fundamental probabilistic diﬀerentiation strategies organisms factor evolution adaptation escherichia coli randomly independently external inputs small sub-population cells enters non-growing state elude action antibiotics kill actively growing bacterial cells. thus population coli cells treated antibiotics persisted cells survive virtue quiescence before resuming growth example molecular systems compute producing distribution. cases cells need shape noise compute distributions instead simply mean values. example authors show mathematically experimentally microrna confers precision protein expression shapes noise genes decreases intrinsic noise protein expression maintaining expected value almost constant. thus although fundamentally important mechanisms used cells compute stochastic environment well understood. chemical reaction networks mass action kinetics well studied formalism modelling biochemical systems recently also used formal programming language shown physically implemented corresponding strand displacement circuit wellmixed solution dna-based circuits thus potential operate inside cells control activity. winfree qian also shown crns implemented surface nanosabstract explore range probabilistic behaviours engineered chemical reaction networks give methods program crns steady state chosen desired target distribution ﬁnite support moreover distribution countable inﬁnite support approximated arbitrarily small error norm. also give optimized schemes special distributions including uniform distribution. finally formulate calculus compute distributions complete ﬁnite support distributions compiled restricted class crns steady state realize distributions. tructure enabling localized computation engineering biochemical systems molecular interactions occur components. number interacting entities small stochastic ﬂuctuations intrinsic molecular interactions play predominant role time evolution system. consequence programming provide particular probabilistic response subset species example response environmental conditions important engineering complex biochemical nanodevices randomized algorithms. paper explore capacity crns exactly program discrete probability distributions. give methods steady state distribution chosen desired target distribution. characterize probabilistic behaviour obtained exploring capabilities crns producing distributions computing distributions composing them. contributions. show steady state crns able compute distribution ﬁnite support propose algorithm systematically program steady state produces given ﬁnite support distribution. moreover distribution countable inﬁnite support approximated arbitrarily small error norm. resulting network number reactions linear dimension support distribution output produced monotonically allowing composition. since distributions large support result unwieldy networks also give optimised networks special distributions including novel scheme uniform distribution. formulate calculus complete ﬁnite support distributions compiled restricted class crns steady state compute distributions. resulting crns generally compact respect ones derived direct approach. calculus equivalent baricentric algebra presented allows modelling external inﬂuences species. results interest variety scenarios systems synthetic biology. example used program biased stochastic coin uniform distribution thus enabling implementation randomized algorithms protocols crns. related work. shown crns stochastic semantics turing complete arbitrarily small error assume error-free computation computational power decreases decide class semi-linear predicates compute semi-linear functions ﬁrst attempt model distributions crns found problem producing single distribution studied. however circuits approximated cannot composed compute operations distributions. chemical reaction network pair ﬁnite sets chemical species denotes size reactions. reaction triple n|λ| source complex n|λ| product complex coeﬃcient associated rate reaction assume speciﬁed; represent stoichiometry reactants products. given reaction often refer change associated deﬁned assume system well stirred probability next reaction occurring molecules independent location molecules ﬁxed volume temperature. assumptions conﬁguration state system n|λ| given number molecules species. stochastic semantics given terms continuous time markov chain here introduce semantics according representation markov processes proposed ethier kurtz representation equivalent classical model described chemical master equation much compact. allows represent ctmc terms stochastic equations similar structure deterministic rate equations. illustrate semantics help example present poisson processes used semantics paper. building block mathematical models paper counting process. intuitively counting process process counts number times particular phenomenon observed time counting processes count number times particular reaction ﬁred time assume independent unit poisson processes depend propen α)ds) α)ds) unit poisson process α)ds gives time interval counting events unit poisson process. modelling assumptions holds clear context omit superscript indicating simply write instead calculates percentage time long-run spends state ﬁnite limit distribution always exists unique paper focus discrete distributions sometimes conﬂate term distribution probability mass function deﬁned next. proof support size. suppose ﬁnite reachable states ﬁnite construction limit distribution induced ctmc exists. construction initial state reactions type probability speciﬁc ﬁres ﬁrst exactly observe ﬁring ﬁrst reaction uniquely deﬁnes limit distribution consumed immediately reaction race condition consumed. implies steady state λout equal happens probability since proof z|j|}. suppose inﬁnite then always consider arbitrarily large ﬁnite number points support probability mass lost arbitrarily small applying deﬁnition ﬁnite subset support result. call nm|π support always associated discrete random variable whose distribution described pmf. sometimes refer imply associated random variable. given pmfs values deﬁne norm worth stressing that given ctmc random variable deﬁned countable state space. consequence distribution given pmf. likewise limit distribution ctmc exists pmf. show that ﬁnite support always build that steady state random variable representing molecular population given species equal distribution. result allows approximate distribution countable inﬁnite support arbitrarily small error norm. result generalised distributions domain approximation exact case ﬁnite support. deﬁnition given ﬁnite support deﬁne follows. composed reactions species. species then consider species species λout represents output network every following reactions λout λii. prove theorem derive similar uni-dimensional case. ﬁring ﬁrst reaction used probabilistically determine value steady state output species using auxiliary species. present according stochastic semantics λout λout yields joint limit dissteady-state distribution πλout λout tribution λout λout exactly equal λλout λout given following reactions species mapped zero. reachable states ﬁnite limit distribution exists. ﬁring ﬁrst reaction uniquely determines steady state solution. exactly value λout λout steady state ﬁrst reaction happens probability therefore that steady state joint distribution λout λout equals remark practice tuning rates reaction diﬃcult impossible. however possible modify derived using deﬁnition probability value encoded rates require reactions rates. using auxiliary species λc|λc| then reactions become instead original deﬁnition. initial condition z|j|} natural number assuming rationals. remark biological circuits probability distribution species depend external conditions. example lambda bacteriofage decides lyse lyse probabilistic distribution based also environmental conditions programming similar behaviour possible extension theorem instance suppose want program switch rate goes state rate goes diﬀerent state external input. program logic following reactions model logic states initialized initial condition then following reaction easy show desired probabilistic behaviour initial value interest also practical scenarios synthetic biology instance behaviour synthetic bacteria needs externally controlled bacteria endowed similar logic then tuning population level possible control fraction bacteria perform task. given number reactions derived deﬁnition linear dimension support. consequence support large crss derived using theorems unwieldy. following show three optimised crss calculate poisson binomial uniform distributions. crns compact applicable many practical scenarios. however using deﬁnition output always produced monotonically. circuits happen hand gain compactness substantial. ﬁrst circuits derived literature uniform distribution new. main result guarantees crns respect conditions distribution given product poisson distributions. particular case consider following composed species following reactions then steady state poisson distribution expected value implement binomial distribution. combined implement direct competition system bimodal limit distribution initial condition. network surprisingly according next theorem proof consider general initial condition reaction exactly reagents products invariant conﬁguration reachable holds figure plots ctmc semantics system. ﬁxed reachable states initial condition induced ctmc ﬁnite irreducible. therefore steady state solution exists unique independent initial conditions. limit distribution calculate inﬁnitesimal generator ctmc solve linear equations system component vector shown ctmc considering irreducible equivalent solving balance equations constraint. resulting steady state distribution system. case figure states rates follow precise pattern every state directly connected states transition rates depend reactions therefore consider balance equations general state previous section shown crns able program deﬁne calculus compose compute pmfs. show complete respect ﬁnite support pmfs calculus present left-invariant baricentric algebra then deﬁne translation calculus restricted class crns. prove soundness translation thus yields abstract calculus limit distributions crns. simplicity follows consider pmfs support results generalised multi-dimensional case. formula denotes obtained minimum multiplication rational convex combination pmfs zero. given formula variables called environmental inputs model inﬂuence external factors probability distributions system. represents variables environment partial function maps input valuation normalized given formula environment domain deﬁne semantics expresses summation valuations inputs weighted rational probabilities evaluates rational given environment. require that coeﬃcients ensures semantics deﬁned inductively follows operations pmfs deﬁned section illustrate calculus consider bernoulli distribution parameter bernp zero otherwise}. binomial distribution obtained independent bernoulli distributions parameter. given random variable binomial distribution parameters suﬃciently large suﬃciently small approximates poisson distribution parameter show operators calculus realized operators crss. resulting crss produce required distributions steady state terms steady state distribution induced ctmc. thus need consider restricted class crns always stabilize incrementally composed. idea output species cannot reactant reaction hence counts species increase monotonically. implies optimized crss shown section cannot used compositionally. since calculus presented deﬁnition consider ﬁnite support pmfs section limited ﬁnite state ctmcs. important because results valid ﬁnite state ctmcs valid inﬁnite state spaces. moreover inﬁnite support natural numbers always approximated norm note stricter requirement output species produced monotonically allowed catalysts reactions. cannot allow catalyst species inﬂuence value propensity rate reaction probability ﬁres. given call non-reacting species subset species given exist component source complex reaction relative reactant reaction. given also deﬁne subset species output species output species whose limit distribution interest. general nonreacting species; depend observer he/she interested observing. nro-crns crss output species produced monotonically cannot reactant reaction. consequence theorem following lemma shows class crns approximate support natural numbers arbitrarily small error. lemma probability mass function exists nro-crs joint limit distribution output species approximates arbitrarily small error norm. approximation exact support ﬁnite. nro-crs operator nro-crs that given input output certain nro-crss produces output species steady state implement given operation. deﬁne following nrocrs operators show correctness. environmental variables environment dom. then computing operator cone) λout) πλout matter extending preλo vious circuit. first derive compute memorize species. done semilinear then assumption species catalysts determine output value λout previous case. shown sections circuit case external inputs introduces arbitrarily small non-zero error fact know computation terminates. example consider following nro-crss initial condition then consider following functions partial function assigning values assumed then operator cone implements operation πλout given following reactions λcat λcat auxiliary species initial condition reactions implement store values λcat used reactions determine probability steady state value λout going determined reaction prove correctness theorem sake simplicity consider operator operators similar proofs. idea proof make equation show resulting implements desired operation steady state. considering previously need derive operator πλout steady stade λout equals probability done using theorem generate bi-dimensional synthetic coin output species joint limit distribution deﬁne stochastic model number molecules present given time given number molecules produced minus number molecules consumed. consumed reactant reaction have reachable states ﬁnite reachable states ﬁnite assumption ﬁnite time ﬁnite number times. implies reach bottom strongly connected component underlying graph state space probability ﬁnite example consider formula .·c+. example environment suppose show translation deﬁned deﬁnition produces nro-crs output species λout πλout consider following nro-crss deﬁned then time well known result ctmc theory bscc pair conﬁgurations therefore conﬁguration bscc reachable conﬁguration always possible reach conﬁguration reach λout reactant reaction therefore given formula deﬁned deﬁnition associates environment pmf. deﬁne translation class nrocrss guarantees unique output species steady state approximates arbitrarily small error environment dom. order deﬁne translation need following renaming operator. show total error kept arbitrarily small even formula composed unbounded number production rules. requires small modiﬁcations cone operator following ideas observe compositional translation deﬁned deﬁnition generally produces compact crns respect direct translation theorem cases output non-reacting resulting used composition. distribution support direct translation yields reactions whereas instance support cardinality cartesian product supports input pmfs. goal explore capacity crns compute distributions. important goal because molecular interactions number common various experimental scenarios deterministic methods accurate stochasticity essential cellular circuits. moreover large body literature biology stochasticity shown essential nuisance work step forward towards better understanding molecular computation. paper focused error-free computation distributions. would interesting understand characterize would happen relaxing constraint. admit probabilistically small error ability crns compute distributions increase? another interesting topic investigate whether relax constraint output species produced monotonically. fact constraint generally present natural systems species undergo production degradation reactions. speciﬁcally require reach state reactions happen. terms sampling distribution would require sampling ensemble cells since sampling single cell would yield single state. also would like address problem possible implement distributions crns without leaders without knowing precise initial number molecules species. constructions except uniform distribution crucially rely assumptions though challenging obtain technologies strand displacement consequence implementation would become easier constraints removed. however worth noting that practical scenario leaders thought proof proof structural induction. base cases nro-crss deﬁnition. assuming nro-crns application operators cone crss produces nro-crns deﬁnition operators. given formula environment following theorem guarantees soundness respect order prove soundness translation consider measure multiplicative error pmfs values maxn∈nm remark formula ﬁnite deﬁnition theorem valid production rule introduce error case always reaction rates make total probability error arbitrarily small. note that using results would also possible qian winfree parallel scalable computation spatial dynamics dna-based chemical reaction networks surface. computing molecular programming springer soloveichik seelig winfree universal substrate chemical kinetics. proceedings national academy sciences kampen n.g. stochastic processes physics", "year": "2016"}