{"title": "Optimizing colormaps with consideration for color vision deficiency to  enable accurate interpretation of scientific data", "tag": "q-bio", "abstract": " Color vision deficiency (CVD) affects more than 4% of the population and leads to a different visual perception of colors. Though this has been known for decades, colormaps with many colors across the visual spectra are often used to represent data, leading to the potential for misinterpretation or difficulty with interpretation by someone with this deficiency. Until the creation of the module presented here, there were no colormaps mathematically optimized for CVD using modern color appearance models. While there have been some attempts to make aesthetically pleasing or subjectively tolerable colormaps for those with CVD, our goal was to make optimized colormaps for the most accurate perception of scientific data by as many viewers as possible. We developed a Python module, cmaputil, to create CVD-optimized colormaps, which imports colormaps and modifies them to be perceptually uniform in CVD-safe colorspace while linearizing and maximizing the brightness range. The module is made available to the science community to enable others to easily create their own CVDoptimized colormaps. Here, we present an example CVD-optimized colormap created with this module that is optimized for viewing by those without a CVD as well as those with redgreen colorblindness. This colormap, cividis, enables nearly-identical visual-data interpretation to both groups, is perceptually uniform in hue and brightness, and increases in brightness linearly. ", "text": "color vision deficiency affects population leads different visual perception colors. though known decades colormaps many colors across visual spectra often used represent data leading potential misinterpretation difficulty interpretation someone deficiency. creation module presented here colormaps mathematically optimized using modern color appearance models. attempts make aesthetically pleasing subjectively tolerable colormaps goal make optimized colormaps accurate perception scientific data many viewers possible. developed python module cmaputil create cvd-optimized colormaps imports colormaps modifies perceptually uniform cvd-safe colorspace linearizing maximizing brightness range. module made available science community enable others easily create cvdoptimized colormaps. here present example cvd-optimized colormap created module optimized viewing without well redgreen colorblindness. colormap cividis enables nearly-identical visual-data interpretation groups perceptually uniform brightness increases brightness linearly. introduction presenting data quickly interpreted easily understood essential scientific community. often quick view study's results primary source relaying information gaining interest making critical author consider interpreted among components colors chosen relay data must considered applied carefully. here focus using appropriate colormaps arrays colors used pre-defined order representing digitally reconstructed scientific image data someone color vision deficiency affected choice iii) create optimized colormap well without. reduces ability distinguish certain colors affects women known decades colormaps cannot easily interpreted still grossly utilized perhaps often default colormaps data processing software. cause misinterpretation certain types data even normal color vision possible solution representing data simply switch grayscale colormaps. grayscale maps avoid issues associated color perception provide linear luminance relation underlying values. however grayscale suffers viewing condition adaptations small dynamic range lower discernibility shades gray human visual system. humans without distinguish around million different colors versus thirty shades gray limits range colors dramatically even limited color vision make higher dimensionality colorspace available using non-grayscale colormaps optimized correctly. makes color indispensable component colormaps enables ability subtle changes underlying data ceive color differences. represent color red-green-blue values often used changes values linearly proportional perceive color change. srgb colorspace designed employing values common digital displays standard space often used pass color information even though covers limited portion colors visible human normal trichromatic vision wide applicability widespread digital displays viewing scientific data colorspace start return perceptually uniform grayscale appears someone red-green colorblindness viridis current gold standard colormap. nanosims image corresponding ªcolormap-data perceptual sensitivityº plot compares perceptual differences colormap actual underlying data differences. slope fitted line coefficient determination calculated using simple linear regression. example data misinterpreted evident bright yellow spots appear represent significantly higher values surrounding regions. however fact dark dark yellow actually represent highest values. someone red-green colorblind made even difficult interpret broad bright band center colormap values difficult distinguish. cvd-safe colorspace ciecam-ucs. visual limited color vision cvd. drepresentation area colorspace accessible without complete red-green colorblindness function ciecam-ucs parameters fraction srgb colors visible function deuteranomaly severity. severity corresponds normal color vision whereas severity corresponds complete dichromacy methods); however srgb suitable colorspace colormap modification since understanding humans truly perceive difference color essential colormap design. colorspace created international commission illumination colorspace still used today well accepted; however account variable viewing conditions. need color appearance models take viewing conditions account create colorspaces. phenomena dealt using cams include chromatic spatial adaptation changes perception color factors contrast changing based surroundings. image appearance model named icam also created simulate complex viewing conditions cannot achieved traditional cams alone perceive color effectively international gold standard used create colorspace named ciecam-ucs optimized account large small differences color colorspace three values used describe color lightness red-green correlate yellow-blue correlate equal euclidean distances values space leads equal color difference perception enabling straightforward creation perceptually uniform colormaps;ºperceptually uniformº difference color space intended closely correspond monotonically human perception color difference. converting srgb script pipeline. schematic script optimizes colormaps cvd. colorspace either srgb ciecam-ucs operation takes place shown along python packages specifically required step. colorspace ciecam-ucs colorspace ensure colormaps optimized viewing modern monitors cover srgb space. important consideration reading science articles viewing science data using digital displays ubiquitous. quantify perceptual sensitivity colormap introduce ªcolormap-data perceptual sensitivityº plot designed compare perceptual differences actual underlying data differences specifically ªdata calculated taking absolute value difference underlying image data points important note data normalized normalized image used generation overlaid image cdps plot. ªperceptual perceptual difference colored pixels overlaid image normalized dividing distance slope grayscale case. overall slope cdps plot compares greyscale indicates apart colors within colormap are. higher slopes correspond colormaps cycle colors therefore higher sensitivity colors map. coefficient determination calculated using simple linear regression indicates well changes represent true underlying data differences. high show better correlation differences underlying data perceived color differences evolved throughout time increasing awareness effect colormaps data interpretation in-depth review commonly accepted colormap design methods please refer review peter kovesi includes descriptions different colormap types history colorspace design best practices design examples use. important note study focus colormaps applicable typical scalar scientific data assumes need monotonically increasing colormaps. case data. non-monotonically increasing colormaps well accepted specific types data using diverging colormap represent correlation subject reference. kovesi's review others design principles creating modern monotonically increasing colormaps. first linear increase lightness used avoid perception gradients present. example colormaps quickly change brightness causing small changes underlying data seem significant regions values change slowly large changes seem negligible. along avoiding banding effect linear increase brightness makes straightforward interpret values significant others allows direct comparison values within images. second colors colormap equidistance colorspace ensuring colors perceptually change constant rate uniform aspect quantitative preventing regions colormap changing quickly slowly helps truly significant changes data visually apparent. colormaps created using design principles evaluated using test image mentioned kovesi's review. test image works using sine wave iterate colors colormap increasing amplitude toward edge test image. areas sine wave cannot easily seen show presence regions color gradient small properly distinguish different color values. additionally inconsistent presence lack thereof sine wave amplitude shows varying color gradients throughout map. module cmaputil includes function create test image well overlay colormap increasingly popular perceptually uniform colormaps parula matlab cmocean package oceanography applications believe additional critical design principles added. first cover large range possible within bounds dictated order increase perceptual distances points improve correlation brightness higher values. second designs principles completed considering cvd. note still trichromatic vision limited perception colors cone type altered range sensitivity causing overlap another cone type limiting ability distinguish colors detected photoreceptors. complete colorblindness severe form type complete absence cone. knowledge study first mathematically optimize colormap specifically viewing without cvd. below discuss creation module many considerations came along creation. also present cividis explain feel optimal typical scientific data set. materials methods color vision deficiency simulation several simulators readily available within python. among these chose colorspacious which knowledge module also ability convert srgb colorspace ciecam color spaces simulation model used colorspacious machado requires input type well severity easily controlled module. specifically ciecam-ucs used colorspace altering colormap. deuteranomaly chosen type deuteranomaly also referred red-green color deficiency common form severity also controlled adjusting along scale representing colorblindness representing complete dichromacy. chose severity ensure anyone either partial complete red-green color deficiency could benefit optimized colormap. colorspace type severity settings easily changed within code. important note algorithms exist simulating colorblindness including ªcorresponding pair algorithmº account different viewing conditions found model used best purposes since limited dichromatic vision simulation. different design considerations model make useful across many applications also discussed original paper cmaputil python-based colormap utilities scripts referred paper found https//github.com/pnnl/cmaputil downloaded using pypi module capabilities beyond discussed here described previous paper process used testing optimizing colormaps provided example script code. python packages opencv numpy matplotlib colorspacious implemented using winpython ipython enhanced python shell used within scientific python development environment interactively analyzing data creating figures. overview pipeline shown visual example iteration colormap adjusted shown implementation pipeline colormap required input. many colormaps readily available download built-in modules matplotlib. colormaps also created using custom techniques graphical user interface created smiths viscm useful part viscm shows colors within ciecam-ucs color space. colormap adjustment iterations. example viridis colormap taken stage pipeline. bottom image plotted colormap input overlaid test image discussed peter kovesi based method presented smith group show values colormap ciecam-ucs space comparing individual values across showing perceptual deltas point calculated euclidean distance point providing three dimensional view colormap space. type defined module. here values converted ciecam-ucs colormap optimized interpolating generate points equidistance other linearizing maximizing range. complete colormap brought back srgb colorspace easy sharing application within modules. details optimization follow. calculated. value divided calculate desired distance achieved points within final colormap ensure perceptual uniformity. number points common colormaps interpolation function easily changed generating sized colormaps. distance found sets points iterated select points distance apart. important note method used ensure total length space interpolation function original hues used colormap still travels path ciecam-ucs colorspace. linearized using independent methods. first method simply fits line original trend using linear regression. second method point iterated find minimum maximum values matched point create valid value ranges found points line fitted within bounds steepest slope possible. mass spectrometry imaging data yeast images figs collected using mass spectrometry imaging baker's yeast drop cast onto silicon wafer dried performed high-lateral resolution secondary mass spectrometer housed environmental molecular science laboratory. sample preparation analysis performed similarly renslow briefly prior analysis sample coated minimize charging analysis high current sputtering performed primary beam prior collecting data samples dosed ions/cm achieve sputtering equilibrium primary beam used analysis psecondary ions detected simultaneously. data visualized manuscript cnion count data. imaging area acquired pixels pixels ms/pixel nine planes. comsol multiphysics modeling data comsol multiphysics finite element analysis software package used throughout many scientific research areas optimized colormap cividis available comsol higher. here demonstrate cividis displaying velocity simple fluid flow model model available fluid dynamics examples provided software simulates time-dependent flow past cylinder. model examines unsteady incompressible flow past long cylinder placed channel right angle oncoming fluid. cylinder offset somewhat center flow make steady-state symmetrical flow unstable. simulation reynolds number equals gives developed karman vortex street; flow still fully turbulent. results discussion considerations implementation linearizing complex initially predicted values ciecam-ucs always mapping srgb colorspace. therefore introduced ability linearize different ways original line closely possible without considering values back colorspace maximize range based valid mappings. first option ensures colormap returned close possible original whereas second option allows ends colormap apart possible lead larger perceptual differences colors increased ability precisely distinguish them. important note first method fail invalid mappings second method fail inability straight line available range. found maximizing range worked best cases. however user need method appropriate specific use. unavoidable issues cmaputil users made aware. issue arises conversion ciecam-ucs srgb colorspace sets values invalid values noted above. fact ciecam-ucs covers much srgb space since encompass human visible colors mapping invalid errors returned colorspacious conversion. avoid invalid values time color array comes back ciecam-ucs absolute colorimetric rendering intent gamut mapping ensuring values means color values valid changed. outside range replaced depending value closer. absolute colorimetic rendering intent lead large departures intended color especially invalid color values additional reason provide methods linearizing experience linearization method fails method chosen user. optimized constant across colormap. fact cmaputil manipulates colors ciecam-ucs converts back srgb determine values colormap. analyze colormap travels ciecam-ucs values newly optimized colormap converted back ciecam-ucs space rather using original ciecam-ucs values available prior conversion srgb. seem counterintuitive since ciecam-ucs values converted srgb back determining perceptual deltas important since initially change upon first conversion fall outside srgb colorspace. example colormap created step supposed perfectly linear perceptual delta across length however slight bump around value colormap. case value srgb colorspace upon conversion ciecam-ucs srgb following absolute colorimetric rendering intent value gets zero leading slight difference original final value. optimized colormap used cmaputil create several example colormaps. identified colormap particular optimal viewing without name cividis generated optimizing viridis colormap selecting linearization maximizes range chose wide range colors resulting wide range values still changing significantly overall sharpness overlaid onto complex images. optimized colormaps produced using method limited range spanning space. spanning hues preferable well felt colormap best balance lightness range. color values colormap please refer file. colormap also close optimal protanomaly tritanomaly shown file figures plotted forms severity right viridis seen gold standard since follows design principles discussed above; however optimal normal vision cvd. cvd-simulated counterpart close optimal cmaputil helped improve upon forcing perceptual delta close flat possible increasing light range covered. time preferable viridis cividis available scientific community viridis aesthetically pleasing covers colors normal vision allowing greater visual perception sensitivity take time full scientific community aware need choose appropriate colormaps agree preferred colormaps hope code provide help transition allowing others experiment different aspects colormap design various characteristics colormap affect interpretation. code also leveraged creating non-monotonically increasing colormaps adjusting linearization function introducing ability create colormaps datasets optimal choice diverging colormap preferred. team working ensure colormap easily accessible. result comsol openmims plugin imagej fiji adding cividis option among colormaps. already copy imagej version cividis provided file. also reaching software teams increase awareness colormap important considerations colormap design. ideally hope reduce number non-perceptually uniform rainbow-style colormaps used default scientific data analysis software increase availability cvd-friendly colormaps estimated million individuals worldwide interpret perceive data like rest population. monitors screens designed display larger color gamuts i.e. colors outside srgb colorspace module used purpose simply changing srgb colorspace setting modern colorspace viewed future screens additionally could better enable cmaputil create perfectly straight perceptual delta lines even conversion ciecam-ucs colors available srgb color space. future work downside cividis reported colleagues minimal coverage different colors varying straight blue yellow rather cycling colors viridis does. keeps cividis aesthetically pleasing viridis. course form cannot colors normal vision can. however since normal color vision common using colors often desired representation data increasing visual perception precision larger dynamic color range. area research pursuing ability cycle colors still keeping normal color vision deuteranomaly perceptions colormap optimal. furthermore using cdps plots judge success plan maximize slope keeping colormap perceptually uniform viridis already close accomplishing since perceptual delta colormap perceived someone complete red-green colorblindness small imperfection toward center. next version cmaputil hope create ªviridis aesthetically pleasing colormaps perceptually linear people. clear task possible deuteranomaly still trichromatic vision able additional colors varying extents making difficult optimize possible severities. different variations colormap creation optimization find done. supporting information file. colormap results. file example optimization figures multiple colormaps tested. includes iteration image change overlay comparison fits used file. cividis. table colormap values optimal colormap cividis. file. cividis. table colormap values optimal colormap cividis. format matches format required imagej software. copy imagej simply paste imagej/luts. note included upcoming fiji versions. file. cividis overlay examples. three images overlaid cividis colormap would appear three forms severity middle image\"x autofluor.tif\" collected imagej.nih.gov/ij/docs/examples/ ij-m&m-figures.zip. acknowledgments would like thank colleagues expressed need project well provided advice feedback. research partially supported genomic science program office biological environmental research u.s. department energy contribution pacific northwest national laboratory foundational scientific focus area portion research performed wiley environmental molecular sciences laboratory national scientific user facility sponsored office biological environmental research located pnnl. pnnl multi-program national laboratory operated battelle contract de-ac-rlo funders role study design data collection analysis decision publish preparation manuscript. author contributions conceptualization ryan renslow. data curation christopher anderton. formal analysis ryan renslow. funding acquisition jamie nuñez ryan renslow. investigation jamie nuñez ryan renslow. methodology jamie nuñez christopher anderton. resources christopher anderton. software jamie nuñez ryan renslow. supervision ryan renslow. validation jamie nuñez. visualization jamie nuñez ryan renslow. writing original draft jamie nuñez ryan renslow. writing review editing jamie nuñez christopher anderton ryan renslow. laar flavell umbers smalley methodology producing maximally discriminable nameable colours control room displays. dickinson murray editors. john dalton's colour vision legacy. london taylor francis; tion plasma membrane cholesterol nanosims. proceedings national academy sciences. https//doi.org/./pnas. pmid jiang passarelli munro kilburn west dollery high-resolution sub-cellular imaging correlative nanosims electron microscopy amiodarone internalisation lung macrophages uniform colour spaces based ciecam colour appearance model. color research application. https//doi.org/./col. loua atlas statistique population paris. harvard college library. paris dejey; thyng greene hetland zimmerle dimarco true colors oceanography guidelines effective accurate colormap selection. oceanography. https//doi.org/./ oceanog.. machado oliveira fernandes physiologically-based model simulation color vision deficiency. ieee transactions visualization computer graphics. epub https//doi.org/./tvcg.. pmid ulation dichromatic color perception. https//doi.org/./ josaa.. luque acevedo software simulating dichromatic perception video streams. color research application. https//doi.org/./col. walt colbert varoquaux numpy array structure efficient numerical computation. computing science engineering. https//doi.org/./mcse.. renslow ahmed nuñez majors fredrickson modeling substrate utilization metabolite production uranium immobilization shewanella oneidensis biofilms. frontiers environmental science. https//doi.org/./fenvs.. lowry loheide comsol multiphysics novel approach ground water modeling. ground water. https//doi.org/./j.-...x white mathematical modeling lithium battery thermal effects comsol inc. multiphysics software. journal power sources. https//doi.org/. /j.jpowsour.... lecarpentier bhatt bertin deloison salomon deloron computational fluid dynamic simulations maternal circulation wall shear stress human placenta biological implications. plos one. https//doi.org/./journal.pone. pmid comsol multiphysics reference manual version comsol www.comsol.com. openmims. github.com/bwhcni/openmims. schindelin arganda-carreras frise kaynig longair pietzsch fiji open-source", "year": "2017"}