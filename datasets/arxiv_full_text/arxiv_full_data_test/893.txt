{"title": "Extension of the non-parametric cluster-based time-frequency statistics  to the full time windows and to single condition tests", "tag": "q-bio", "abstract": " Oscillatory processes are central for the understanding of the neural bases of cognition and behaviour. To analyse these processes, time-frequency (TF) decomposition methods are applied and non-parametric cluster-based statistical procedure are used for comparing two or more conditions. While this combination is a powerful method, it has two drawbacks. One the unreliable estimation of signals outside the cone-of-influence and the second relates to the length of the time frequency window used for the analysis. Both impose constrains on the non-parametric statistical procedure for inferring an effect in the TF domain. Here we extend the method to reliably infer oscillatory differences within the full TF map and to test single conditions. We show that it can be applied in small time windows irrespective of the cone-of-influence and we further develop its application to single-condition case for testing the hypothesis of the presence or not of time-varying signals. We present tests of this new method on real EEG and behavioural data and show that its sensitivity to single-condition tests is at least as good as classic Fourier analysis. Statistical inference in the full TF map is available and efficient in detecting differences between conditions as well as the presence of time-varying signal in single condition. ", "text": "medicine dresden germany national institute mental health klecany czech republic laboratory brain function disease school life sciences university science technology china hefei anhui people’s republic china anhui laboratory affective computing advanced intelligent machines school computer information hefei university technology hefei anhui people’s republic china oscillatory processes central understanding neural bases cognition behaviour. analyse processes time-frequency decomposition methods applied non-parametric cluster-based statistical procedure used comparing conditions. combination powerful method drawbacks. unreliable estimation signals outside cone-of-influence second relates length time frequency window used analysis. impose constrains non-parametric statistical procedure inferring effect domain. extend method reliably infer oscillatory differences within full test single conditions. show applied small time windows irrespective cone-ofinfluence develop application single-condition case testing hypothesis presence time-varying signals. present tests method real behavioural data show sensitivity single-condition tests least good classic fourier analysis. statistical inference full available efficient detecting differences conditions well presence timevarying signal single condition. introduction test extension fulltime-frequency window research neuroscience analyses oscillations neural activity behaviour across broad range frequencies. synchronization locking oscillatory processes suggested central neural basis cognition parallel studies shown oscillatory measures predictive behavioural processes spanning time-scale chronobiological effects short time-scales visual attention processes studies typically nonparametric cluster-based permutation tests applied testing differences time evolution frequency activity. note argue applicability test full time-frequency window independent analysis time window size wavelet sizes thus allowing researchers infer differences content borders time window. examine evolution frequency content time series time-frequency analyses conducted using wavelet transformations representation signal advantage disassociate changes different frequencies across time require stationarity recorded signal representation data extracted either wavelet sparse decomposition representing signal minimalistic space orthogonal wavelets generally obtaining signal’s convolution predefined wavelets. latter approach interest results interpreted amplitude phase given frequency time point signal. dimensional function ease visualization generally plotted color-coded format where example amplitude color-coded vertical horizontal axes represent frequency time respectively maps extracted different experimental conditions conditions compared a-priori possible strategies. window identified using either hypothesis-driven data-driven strategy clear a-priori assumptions window analysed data-driven strategy needs employed. involves nonparametric cluster-based permutation testing done stages. stage- selects values given amount significant difference; done testing null hypothesis compared conditions’ values equal then stage- tests null hypothesis size cluster contiguous significant bins random realization measurement-analysis method i.e. statistically probable obtain value cluster found data. process corrections multiple comparisons taken account using cluster-based statistics stage-. however procedure applied results obtained within cone-ofinfluence thus contains rarely explicitly stated problems. first issue difficulty infer signal’s content outside cone-of-influence second problem length chosen analysis time window data possibly creating unwanted data overlap overlaps wavelet-signals. points dissociable analysis since fixing data time window wavelet size completely defines cone-of-influence domain. designates window validity within time domain convolution operation wavelet fully contained time window data thus allows amplitude/phase comparisons across time points. figure example wavelet analysis signal giving time-frequency representation appearance cone-of-influence. example wavelet central frequency width time example pure transient signal frequency thick line shows theoretical signal thin line amplitude evolution. result convolving wavelet signal grey shaded areas correspond time locations wavelet fully contained time window. repeating convolution signal wavelets different frequencies gives result depicted colour area grey cone represents cone-of-influence domain results convolution operations comparable shows signal white gaussian noise mean zero standard deviation equal amplitude signal example single simulation signal’s amplitude bump visually present; dashed black lines delineate cluster showing tendency effect wherever present dots depict time discrete version theoretical function example shown figure time window data seconds wavelet extending seconds provide amplitudes phases compared within time window seconds size time-frequency window inferences signal’s content made thus dependent wavelet’s frequency gives structure consequently contentious inferred outside domain statistical method allows make inference data within full window needed. becomes important considers decrease size time window either decreasing measurement time especially important studies measures oscillations behavioural parameters avoiding overlaps signals close together. main interest implementing analysis demonstrate tested condition differs control condition; i.e. show compared conditions show statistical differences maps within chosen window. accomplished stages stage- tests independently whether measures could obtained reference distribution bins marked significant predefined critical level then stage- creates clusters contiguous significant bins compares data cluster reference distribution cluster. achieved using monte-carlo randomization procedure original data overall procedure called non-parametric bump test allows detect presence least amplitude-bump power-bump phase-bump otherwise similar distribution waves conditions. example taking hand made example conditions noise noise added signal amplitude equal standard deviation white gaussian noise test detects presence frequency signal within time window measurement important feature procedure dissociates variable interest e.g. amplitude variable used infer presence effect space. regard stage- independent exact variable obtained stage-. therefore fact outside cone-of-influence convolution operation data gives amplitude/phase parameters comparable values inside relevant any-more. results stage- comparing bin’s data differences reference distribution obtained exactly mathematical operation procedure similarly biased across repetitive computations reference values bin. consequently non-parametric cluster-based test performed bin-wise statistical used full extent borders time window chosen experimentalist. still needs carefully consider time extent wavelets since symmetrically pool measures across time method allows infer presence effects much smaller time windows before. illustrate test works full defined experimentalist. simple case presented test applied data event-related potentials contain separate conditions shown black curves figure together variability. based visual inspection erps look similar despite differences beginning epoch. figure example analysis short time window applied data. mean event related potentials electrode conditions function time onset shaded areas show s.e.m. amplitudes decomposition conditions showing alpha band activity cases. difference amplitudes significant cluster. grey solid lines depict coi. variable second bumps seem show different amplitudes conditions. computing difference statistics conditions strong cluster centred identified significant portion cluster found outside thus would missed short time window analysis. complementary variable describes phase consistency signal given frequency time across repeated measures also analysed provided different picture amplitude. strongly phase locked signals appeared around around around stronger values condition vice versa case. applying permutation statistics showed significant clusters three locations visualised bump around {t=ms location also high frequency localized synchronisation small increase condition compared frequencies later effects correspond weak phase synchronisations clarifications example application apparent nonparametric cluster-based statistical test applied within full window chosen researcher. therefore method applied irrespective cone-of-influence including bins border time window measurement. important cognitive neuroscience research link electrophysiological behavioural data permits analysis small time-frequency windows comparisons behavioural data. maris oostenveld described essential conditions performing cluster-based permutation test. important assumption equality probability distributions obtained data compared conditions important limitation method shown below assume wants compare measures signals noise term affects measures similarly assume want test whether differences amplitudes measures irrespective phase signals repeated measurements performed. null hypothesis states that indicates complex representation measures obtained convolution complex wavelets operator indicates magnitude complex number. permutation test assumes equality probability distributions since noise must structure measures also assumption implies similarity signals probability distributions allows exchange values computing difference permuted values creates reference distribution successive random re-sampling. however importantly probability distributions signals differ sufficiently strong comparison noise probability distributions assumption valid anymore test also valid. easily seen equation simple example takes noise null sufficiently small comparison signal interest method becomes test presence signal however performing permutation measures across data points creates reference distribution mixture dirac distribution zero signal distribution. thus existing test performed signals’ probability distributions similar signals’ probability distributions different noise probability distributions. important point full data systematically different mean obtained randomization procedure. based arguments similarity distributions compared turns method also applicable single condition e.g. oscillatory effect it’s time window idea already tested previously limited classic fourier analysis simple test frequency necessary multiple comparisons adjustments. based argumentations previous sections therefore also possible apply non-parametric cluster-based test single condition measures space. single condition reference distribution data compared must obtained different permutation. given available information data create control data sets randomly permuting time dimension original data i.e. null hypothesis states data pure noise thus data points times equivalently interchangeable. thus compare data reference obtained analysis simulated measures resulting reference distribution used perform test stage- examine bins data significantly different noise map. single bin’s distributions obtained necessarily following well behaved gaussian like distributions therefore care must taken check bin’s distributions. instead transforming z-values also directly pbin values obtained stage- distribution independent. final cluster-based test remains previously described stage-. order know whether reference distribution valid check described previous section whether reference globally similar data map. provides simple check easily perform visualize plotting data mean monte-carlo proportion significant bins found stage-. test implemented follows perform stage- analysis significant bins full map; compute number significant bins across divide total number bins obtain psign; last number represents proportion bins significant effects respectively proportion bins equal reference distribution value psign used variable testing whether randomization procedure created proper reference map. case signal value around αbin case small signal effect value stay relatively range. however remarks necessary. last variable provides decision variable estimating realistic reference data given data distribution anything specific localized effects domain. naturally incorporates time-frequency discretization chosen researcher dependent relative size expected/observed significant cluster size. example signal-to-noise high psign proportion area significant cluster full thus give idea extent effect psign high inspection data’s cluster size expected randomization procedure create proper reference distribution many significant noise bins present. description explains single-condition test appropriate detecting presence relatively small effects noisy conditions localized oscillatory effects noise data. example single-condition test applied cases strong case strong cluster highly significant cluster delineating signal bump shows tendency important note single condition test different application rules non-parametric cluster-based test proposed maris oostenveld essentially created comparing final data measured conditions distributions test reference tested other obtained applying transformation decomposition data shuffled version. original procedure permutation compared conditions single condition test permutation procedure carried data compared conditions. thus care must taken ascertain similarity distributions stage- used carrying cluster-based permutation test stage-. previous paragraphs provide simple description check similarity distributions application cluster-based test. last single-condition test limitations extend comparisons domains example time domain classic fourier analysis furthermore test keeps family-wise error rate appropriate level since based stage cluster-based statistics single-condition validity check concerned stage- distributions. demonstrating applicability test single condition data exogenous attention effect discrimination performance target stimulus target stimulus could appear randomly within window onset measured reaction time subjects giving correct response. mean subjects plotted figure observe typical decrease longer target onset asynchrony frequency component performing classic fourier analysis showed specific frequency content applying single condition test showed that across subjects data strong positive clusters amplitudes around start time zero also seem less fluctuations expected locations example also helps demonstrate sensitivity single condition test despite known asymmetric noise distribution particularity noise distribution creates oscillatory fluctuation amplitudes observed away clearly visible mean reference distribution amplitudes despite known effects dissociation cluster-based test physical variable test remains valid insensitive amplitude oscillations outside coi. figure example analysis short time window applied behavioural data single condition. mean reaction times correct responses function cue-to-target asynchrony mean fourier amplitudes error bars s.e.m. mean amplitudes obtained significant clusters stronger amplitudes expected weaker amplitudes expected mean amplitudes reference distributions obtained single-condition test shows oscillations amplitudes outside σg=./fg used. example gave case single-condition test seemed successfully applied. provide also example demonstrates test easily discarded non-valid reference distribution. purpose data previous section applying stage- analysis single condition test gave proportion bins psign=. data significantly reference map. carries cluster-based test resulting positive negative significant clusters turn large together almost covering entire extreme example data cannot tested single condition test reference distribution individual bins substantially deviated data map. reasons test failure particular case combination data pre-processing peculiarly strong signal around tested combined noise. figure example failure applying single condition test. signal figure applying single condition test created reference distribution made data systematically reference distributions reference distributions sensitivity single condition test application method single-condition seems documented analyzed sensitivity method comparison classic fourier analysis usually applied small window sizes purpose simulations carried investigate sensitivity method detecting theoretical signal embedded noise various signal-to-noise ratios function distance signal’s peak border time window. first asked test performs classic reaction time data typical asymmetric distribution. signal detected main frequency single-condition test performed globally good better than classic fourier analysis higher signal frequencies sensitivity detecting signal embedded noise better classic fourier analysis second simulations repeated normal white gaussian noise. results also showed single-condition non-parametric test outperformed classic fourier analysis figure detection performance single-condition non-parametric cluster-based test fourier analysis methods simulated signal embedded log-normal noise white gaussian noise three possible signal frequencies simulated estimation/symbol obtained simulations. rightmost panel displays legend signal’s peak possible location border middle time window. noted another scientific field researchers proposed single condition tests closely related described above. analysing time series nonlinear dynamic systems people often confronted measurement single condition beginning question appeared assess data obtained non-linear dynamic system instead classical linear dynamics. proposed solution dubbed surrogate data/surrogate time series create monte-carlo samples preserve property original data e.g. probability distribution data across time measures additionally amplitude fourier spectrum time evolution i.e. time points phase randomized asses non-parametric distribution chosen variable interest obtained monte-carlo randomization procedure whether data could simple random realization measurement-analysis method given hypothesis linear system. statistical procedure similar procedure described single condition test. difference analysis proposed work hypothesis tested whether data simply sample random stochastic measures contain specific time varying signal superimposed noise. thus crosscheck proposed whether test applicable seems different instantiation method surrogate data analysis researcher defines a-priori component data surrogates must identical. summary provide advancements time frequency statistical inference analysis. first unveil problem statistical inference outside cone-ofinfluence solved cluster-based statistical procedure extends statistical inference full time-frequency window used analysis. second demonstrated novel method applied short analysis time windows. allows analysis behavioural data short-time series grants advantage close integration different sorts data used cognitive neuroscience. third nonparametric method applied single conditions detecting presence timevarying signal. sensitivity detect presence signal good better than classic fourier analysis. materials methods real data tutorial dataset provided continuously recorded amplified using quickamp system ag-agcl electrodes placed standard scalp positions. prospective study employed visual cued stimulus discrimination task conditions trials selected single subject electrode dataset processed custom written matlab scripts using fieldtrip toolbox eeglab signal processing environment band-pass filter ranging applied dataset irregular technical movement artefacts like grimacing yawning sneezing etc. removed means manual data inspection. then independent component analysis applied discard recurring physiological artefact like blinks horizontal vertical movements well pulse artefacts. components reflecting artefacts discarded reconstructed. data pre-processing step followed data segmentation step. data segmented onset stimulus segment ended onset. within time window target stimulus discriminate appeared randomly. matlab/octave based functions demonstrating application method data http//vision.ustc.edu.cn/packages/tutorialdatasetfunctions_tfanalysis.zip. reaction time data subset full data corresponding condition. subjects discriminate orientation small orientated stimulus surrounded square frame consisting black white checkerboard frame’s contrast abrupt increase randomly trial start used visual exogenous cue. target randomly presented within time window starting onset remained visible subject’s response. subjects indicate orientation target fingers right hand pressing predefined keys standard keyboard. subjects asked respond fast possible also keep high level correct responses. wrong responses well reaction times fast slow discarded. subject least time available mean used obtaining individual subject versus time target onset respect appearance. time sampled written informed consent obtained subject prior study experiment followed tenets declaration helsinki. frequency amplitude standard deviation time deviation centre wavelet. example wavelets main frequencies shown figures theoretical discrete points used convolve measured data. size wavelet defined length time usually represented multiples unless otherwise specified text wavelet values σg=./fg; wavelet window discretized /t=/.=. steps length time window fourier analyses carried purpose demonstrations assess sensitivity single-condition method simulations theoretical fully controlled experiment performed. assumed measures sampled within short time window measurement theoretical oscillatory signal frequency amplitude followed gaussian shape different rise decay slopes simulated within time window represented it’s phase random across repeated measures. noise independent identically distributed random variable. reaction times simulations noise followed log-normal distribution mean standard deviation simulations white gaussian noise mean zero standard deviation one. signal-tonoise ratio defined snr=a/σn. supposed repeated measures performed data remaining time discretizations sampling frequency simulations given signal follows simulate measures given signal-to-noise ratio peak’s position; compute fourier decompositions; create reference distributions perform non-parametric test variable following statistical procedures. peak time position frequency signal simulations experiment carried simulation single-condition test fourier amplitude test applied test presence signal statistical procedures used two-condition comparison based creating monte-carlo permutation distributions represent null hypothesis statistics described detail work nonparametric cluster-based test reference distributions necessary distribution obtained shuffling data conditions nshuffle times; computation distribution cluster variable uses result clusters significant bins shuffled thus permits create reference distribution clusters’ statistics. single-condition procedure simulated measure obtained monte-carlo time permutation randomly shuffling time points repeating nshuffle times providing nshuffle versions original measures then shuffled data representation computed then reference distributions stage- stage- created. final cluster distribution used statistical testing compute probability obtained cluster data given reference cluster distribution. başar schürmann demiralp başar-eroglu ademoglu event-related oscillations ’real brain responses’--wavelet analysis strategies. int. psychophysiol. off. int. organ. psychophysiol. dippel mückschel ziemssen beste demands response inhibition processes determine modulations theta band activity superior frontal areas correlations pupillometry implications norepinephrine system inhibitory control. neuroimage https//doi.org/./j.neuroimage... fiebelkorn i.c. saalmann y.b. kastner rhythmic sampling within objects despite sustained attention cued location. curr. biol. https//doi.org/./j.cub... cknowledgments c.b. supported deutsche forschungsgemeinschaft project t.t. partly supported fundamental research funds central universities grant ustc. work supported project sustainability national institute mental health grant number financial support ministry education youth sports czech republic program", "year": "2018"}