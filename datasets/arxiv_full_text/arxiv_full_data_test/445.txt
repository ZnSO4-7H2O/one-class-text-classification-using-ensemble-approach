{"title": "Low variance couplings for stochastic models of intracellular processes  with time-dependent rate functions", "tag": "q-bio", "abstract": " A number of coupling strategies are presented for stochastically modeled biochemical processes with time-dependent parameters. In particular, the stacked coupling is introduced and is shown via a number of examples to provide an exceptionally low variance between the generated paths. This coupling will be useful in the numerical computation of parametric sensitivities and the fast estimation of expectations via multilevel Monte Carlo methods. We provide the requisite estimators in both cases. ", "text": "number coupling strategies presented stochastically modeled biochemical processes time-dependent parameters. particular stacked coupling introduced shown number examples provide exceptionally variance generated paths. coupling useful numerical computation parametric sensitivities fast estimation expectations multilevel monte carlo methods. provide requisite estimators cases. consider stochastic models intracellular processes whose rate functions perhaps changes temperature volume voltage even external forcing depend explicitly time. speciﬁcally consider standard discrete-space continuous-time markov chain model typically simulated gillespie’s algorithm next reaction method whose propensity functions take form vector whose component gives count species time parameter enumerates reaction channels. model simplest popular models study cell biology. note rate parameters ﬁxed constants model. need case. example perhaps system subject dark-light cycles oscillate hour time-period. case better model change propensity function ﬁrst reaction currently situation time dependent propensity functions basic versions gillespie algorithm next reaction method quite slow generating sample paths even simple models. slowdown occurs calculation time required occurrence next event system becomes hitting time problem following form solving function positive value solving typically requires numerical estimation integral thereby dramatically slowing simulation often factors hundreds thousands around necessity estimating integrals utilize thinning procedures methods shown dramatically reduce cost path simulation present context similar idea using rejection based stochastic simulation algorithm applied save computation cost delaying update propensity functions. applications thinning also appeared literature recently. hybrid simulation schemes proposed simulate jump-diﬀusion processes combine jump process diﬀusion approximation exact trajectories class piecewise deterministic markov processes also simulated using thinning particularly active fruitful area research last decade models time independent parameters focused following question given mathematical models system denote respectively functional model output generate pair small? couple processes. common applications research parametric sensitivity analysis diﬀer perturbation parameters interest multilevel monte carlo exact process tau-leap discretization tau-leap discretizations though diﬀerent step-sizes paper study coupling question context time-dependent parameters. particular provide variety equivalent stochastic equations models consideration develop number reasonable coupling strategies. discover coupling termed stacked coupling eﬃcient others examples considered. speciﬁcally produces pairs paths exceptionally variance often hundreds times lower variance paths produced couplings. include detailed construction couplings case contexts considered here. outline remainder paper follows. section formally introduce models considered paper. stochastic equations diﬀerent produces paths whose distributions agree desired model section provide multiple diﬀerent couplings arise naturally diﬀerent stochastic equations provided section section present applications examples focusing parametric sensitivity analysis multi-level monte carlo. conclusions future directions research section common mathematical model utilized intracellular biochemical processes counts abundances constituent species tracked time-homogeneous discrete-space continuous-time markov process. review model ﬁrst transitioning non-homogeneous case. suppose model includes chemical species whose abundances change diﬀerent possible reactions positive integer. vector whose component gives abundance species time reaction vector reaction channel reaction occurs time conversely specify model specifying counting processes multiple ways this depending probability space choose work with. diﬀerent representations imply diﬀerent algorithms critical relation heart paper. non-exhaustive list diﬀerent possible representations. widely used representation usually called random time change representation developed thomas kurtz utilized widely development computational methods analytical purposes representation start independent unit-rate poisson processes deﬁne process solution second representation begins space-time unit-rate poisson point process region determined poisson random variable parameter equal area region number points non-overlapping regions independent) deﬁnes solution indicator function figure graphical realization representation given three reaction channels. simulation representation equivalent well known gillespie algorithm notice representation equivalent stochastic diﬀerential equation form figure graphical illustration space-time representation x-axis represents time orange marks denote relevant points poisson point process times transitions occurred labeled ﬁrst transition occurred reaction ﬁrst point occurred second transition reaction third transition reaction note intensity functions change reactions occur. figure graphical illustration space-time representation x-axis represents time marks denote relevant points poisson point process ﬁrst transition occurred reaction ﬁrst point occurred second transition reaction well third reaction complete two-step process representations requires solution hitting time problem form example order determine time next transition representations required solve time previous transition unit exponential random variable. representation requires solve equations take minimum determine reaction causes transition. numerically solving hitting time problems often numerically expensive requires signiﬁcant number calculations made transition. well known method avoid numerical estimation integrals utilize thinning methods introduced present context biochemical processes show methods arise naturally representations presented above. able naturally develop coupling methods perturbed processes main contributions paper. determination time next reaction exactly standard gillespie algorithm. extra cost comes however step algorithm determines reaction channel causes transition. possible reaction chosen case update state system order minimize number wasted steps desirable select close sups∈i possible time-frame interest. algorithm numerical implementation either representation following. presented algorithm essentially extrande method note algorithm slightly diﬀerent representations update step. left representations notational clarity. algorithm initialize setting predetermined time. following exceeds generated random variables independent previously generated random variables. occurs algorithm ineﬃcient probability acceptance step occurs simply choose value greater stop step update process setting update state vector adding would return step algorithm. figure graphical illustration extrande algorithm. x-axis represents time marks denote relevant points poisson point process ﬁrst transition occurred reaction since ﬁrst point occurred transition second time point transitions times reactions respectively. motivate idea coupling processes introduce example concerning parametric sensitivities derivatives expectations respect parameters. since population processes modeled reaction networks consider following arises ecological model used investigate persistence pathogen wild mammalian populations. synchrony parameter controls duration birth pulse phase parameter determines timing birth peaks. scaling constant determined mes/ death rate modiﬁed bessel equation ﬁrst kind. transmission rate propensity/rate reaction model quantity interested sensitivity extinction probability pathogens within years parameters model. extinction probability speciﬁcally deﬁne stopping time quantities looking derivatives sets parameters basic reproduction ratio satisfying particular would interested determining parameters dominant factors extinction events. common method calculate parametric sensitivities ﬁnite diﬀerence method. parameter interest model parameterized process denoted suppose expectation interest path functional. utilize approximation leave setting ﬁnite diﬀerences return simply considering processes share reaction vectors diﬀer propensity functions. denote propensity functions propensity functions easiest correct marginal processes simply generate independent realizations example could done implementing algorithm process independent uniform exponential random variables. since processes uncoupled expect coupling provide lower variances requisite monte carlo estimators. natural coupling term extrandecrn utilize seed random number generator implementation algorithm method often termed common random numbers. mathematically coupling equivalent using poisson process uniform random variables representation previous coupling arose generating sources randomness third coupling termed extrande thinning arises generating sources randomness. speciﬁcally satisfy unit-rate poisson point process figure oﬀers graphical illustration. algorithm initialize setting predetermined time. following exceeds generated random variables independent previously generated random variables. remark pointed remark pertaining algorithm satisfying inequality step close value max{λx choose value greater max{λx simply stop step time total intensities goes figure graphical illustration extrande thinning coupling processes reaction channels. dashed green curves determine propensity functions whereas dash-dotted curves determine propensities solid line suppose point point process occurs along vertical dashed line possibilities. point occurs region transition reaction point occurs region transition reaction transition reaction point occurs region transition reaction point occurs region transition reaction transition. point occurs region neither transition. figure graphical illustration stacked coupling processes reaction channels. dashed green dash-dotted blue curves related propensity functions respectively. gives upper bound sups{λx time period interest. solid line suppose point point process occurs along vertical dashed line possibilities. point occurs region transition reaction point occurs region transition reaction transition. point occurs region neither transition. point occurs region transition reaction point occurs region transition reaction transition. point occurs region neither transition. extrandecrn coupled processes general transitions time. hand extrande thinning often yield simultaneous transitions however case even transition time extrande thinning reaction channels responsible transitions diﬀerent ﬁnal coupling stacked coupling improves situation again. coupling processes often transitions time processes transition simultaneously necessarily transition according reaction channel. space-time representation. essentially space-time thinned version coupled ﬁnite diﬀerence method introduced propensity particular reaction channel cause simultaneous transitions minimum respective propensities. figure algorithm initialize setting predetermined time. following exceeds generated random variables independent previously generated random variables. application areas beneﬁt greatly good coupling methods parametric sensitivities multilevel monte carlo. brieﬂy introduced ﬁnite diﬀerence methods parametric sensitivities example section brieﬂy introduce multilevel monte carlo present setting point reader deeper introduction. introduce example models provide numerical tests devised coupling methods. multilevel monte carlo method uses sequences coupled processes order eﬃciently compute expectations path functional interest relevant stochastic process consider problem numerically approximating expectation mlmc estimator built following manner. ﬁxed integer depend upon model path-wise simulation method used terminal time. reasonable choices include integers note even though considering non-homogeneous processes euler approximations intensities constant time-steps size assume current time hence coupled processes eﬃciently generated standard coupling introduced however coupled processes nonhomogeneous therefore utilize stacked coupling. reaction channel parameterize model denoting state system time example ﬁrst interested estimating sensitivity expected number mrna molecules respect centered ﬁnite diﬀerences figure plot estimated sensitivities diﬀerent estimators functions time. note captures overall behavior though extrande thinning stacked coupling signiﬁcantly less variable. finally look long time behavior couplings. analogously expect time gets large variance associated extrandecrn converge variance associated independent samples. however expect variance stacked coupling remain small. test hypotheses simulated model time plotted resulting variances figure simulation agrees intuition. example continue consider example except study eﬀect perturbing degradation rate mrna reaction expected number mrna dimers. parameterize model finally simulated processes time long term behavior couplings. result found figure again extrandecrn coupling decoupled quickly stacked coupling kept variance small throughout simulation. interestingly right image figure extrande thinning coupling perform well decoupled almost immediately. compare direct simulation using extrande method multilevel monte carlo stacked coupling ﬁnest level. simulated method estimator standard deviation fell tolerance table estimates expectations provided. table report time required diﬀerent methods diﬀerent expectations. finally table report number random variables utilized diﬀerent methods diﬀerent expectations. example return mrna-protein-dimer model example depending upon expectation calculated standard implementation mlmc perform well model. reason propensity functions high others quite low. particular rates reactions remain approximately throughout computation. therefore choose diﬀerent approximate model usual euler tau-leap model. particular take approximate process time discretization parameter compare three diﬀerent methods estimation standard monte carlo extrande method standard mlmc mlmc using discretization call last method mlmc. simulated method estimator standard deviation fell tolerance respectively. mlmc methods used time step coarsest level time step ﬁnest level. table estimates expectations provided. table report times required diﬀerent methods diﬀerent expectations. finally table report number random variables utilized diﬀerent methods diﬀerent expectations. tables mlmc mlmc provide improvements direct monte carlo extrande method similar performances calculating expected number mrna protein molecules. however diﬀered factor performance calculating expected number dimers. demonstrates clever choices approximate processes dramatic eﬀect estimator performance. number papers recently eﬃcient simulation biochemical processes time dependent parameters. paper studied eﬃciently couple processes order eﬃciently perform parametric sensitivity analysis multilevel monte carlo. particular diﬀerent mathematical representations models interest developed three non-trivial coupling strategies. number examples demonstrated stacked coupling appears eﬃcient. future work focus providing analytical results related variances diﬀerent coupling strategies.", "year": "2017"}