{"title": "Bayesian Population Receptive Field Modelling", "tag": "q-bio", "abstract": " We introduce a probabilistic (Bayesian) framework and associated software toolbox for mapping population receptive fields (pRFs) based on fMRI data. This generic approach is intended to work with stimuli of any dimension and is demonstrated and validated in the context of 2D retinotopic mapping. The framework enables the experimenter to specify generative (encoding) models of fMRI timeseries, in which experimental manipulations enter a pRF model of neural activity, which in turns drives a nonlinear model of neurovascular coupling and Blood Oxygenation Level Dependent (BOLD) response. The neuronal and haemodynamic parameters are estimated together on a voxel-by-voxel or region-of-interest basis using a Bayesian estimation algorithm (variational Laplace). This offers several novel contributions to receptive field modelling. The variance / covariance of parameters are estimated, enabling receptive fields to be plotted while properly representing uncertainty about pRF size and location. Variability in the haemodynamic response across the brain is accounted for. Furthermore, the framework introduces formal hypothesis testing to pRF analysis, enabling competing models to be evaluated based on their model evidence (approximated by the variational free energy), which represents the optimal tradeoff between accuracy and complexity. Using simulations and empirical data, we found that parameters typically used to represent pRF size and neuronal scaling are strongly correlated, which should be taken into account when making inferences. We used the framework to compare the evidence for six variants of pRF model using 7T functional MRI data and we found a circular Difference of Gaussians (DoG) model to be the best explanation for our data overall. We hope this framework will prove useful for mapping stimulus spaces with any number of dimensions onto the anatomy of the brain. ", "text": "introduce probabilistic framework associated software toolbox mapping population receptive fields based fmri data. generic approach intended work stimuli dimension demonstrated validated context retinotopic mapping. framework enables experimenter specify generative models fmri timeseries experimental manipulations enter model neural activity turns drives nonlinear model neurovascular coupling blood oxygenation level dependent response. neuronal haemodynamic parameters estimated together voxel-by-voxel region-of-interest basis using bayesian estimation algorithm offers several novel contributions receptive field modelling. variance covariance parameters estimated enabling receptive fields plotted properly representing uncertainty size location. variability haemodynamic response across brain accounted for. furthermore framework introduces formal hypothesis testing analysis enabling competing models evaluated based model evidence represents optimal tradeoff accuracy complexity. using simulations empirical data found parameters typically used represent size neuronal scaling strongly correlated taken account making inferences. used framework compare evidence variants model using functional data found circular difference gaussians model best explanation data overall. hope framework prove useful mapping stimulus spaces number dimensions onto anatomy brain. many examples neuronal populations represent stimulus spaces. auditory cortex -dimensional space sound frequencies mapped onto surface brain visual system retinotopic mapping revealed -dimensional plane retina mapped multiple times onto surface visual cortex place cells hippocampus respond maximally specific location -dimensional space conceptual knowledge represented neuronally spaces dimensions populations neurons characterised receptive fields area n-dimensional space maximally respond. paper introduce generic framework mapping stimulus spaces onto brain performing hypothesis testing. illustrate approach context visual population receptive field mapping. enable mapping model parameters required capture response neuronal populations experimental stimuli. spatial distribution parameters across brain reveal large-scale topographic features presence retinotopic maps. mapping therefore seen special case building generative models imaging timeseries. seek understand stimuli cause change neuronal activity turns causes change observations. functional involves modelling neuro-vascular coupling bold response inherently nonlinear mapping. instance bold response refactory period depends interstimulus interval furthermore brain regions differ extent vascularization giving rise regional differences bold response. typically mapping experiments canonical haemodynamic response function determined per-subject basis. here obtain best possible estimators neural activity constructing maps specified estimated nonlinear model voxel’s fmri timeseries included biologically motivated differential equation model neurovascular coupling bold response objective modelling test hypotheses. context mapping hypotheses specified explicitly implicitly. instance tested explicit hypothesis position modulated perceived space. studies exploratory instance examining reorganisation visual field maps lesions disease studies this implicit hypothesis parameters deviate normal range specific areas cortex. despite popularity mapping framework formal hypothesis testing currently lacking. introduce tools probabilistic model fitting inference context mapping could offer several benefits experimenters. optimal method testing hypotheses compare likelihood data model likelihood data another model instance experimenter wish test hypothesis certain brain regions receptive fields excitatory centre inhibitory surround identified hubel wiesel single unit recordings. receptive fields modelled using difference gaussians function also capture neuronal response level voxels fmri data alternatively evidence inhibitory surround lacking simple excitatory receptive field better model kind question regarding several models best normally models assessed based percentage variance explain cannot used hypothesis testing ignores complexity model parameters explain variance added risk overfitting noise failing generalise. framework proposed here approximation model evidence used known negative variational free energy quantity estimated model represents accuracy model minus complexity. comparing models based free energy experimenter select simplest model explains variance. furthermore taking account covariance parameters free energy offers sensitive approximation model evidence approximations bic. well enabling competing models compared framework propose advantages parameter-level inference particular relevance exploratory studies. here parameters prf’s size represented probability distribution expected value variance covariance thus uncertainty parameter estimates expressed visualising making comparisons within subjects. uncertainty parameter estimates arise multiple sources observation noise subjects’ movement well covariance among parameters. also always possible confidently assign variance measured signal either neuronal haemodynamic causes. estimating full covariance among neuronal haemodynamic parameters ensure uncertainty induced ambiguity parameters accounted visualising testing hypotheses. here generalise approach previously introduced context tonotopic mapping making several novel contributions. extend method stimuli dimension demonstrate application context visual mapping evaluate face validity robustness noise method using simulated data evaluate test-retest reliability across scanning runs using empirical data finally demonstrate method hypothesis testing comparing evidence established forms model gaussian response function difference gaussians response function within category model also compared evidence circular elliptical angled receptive fields. methods described evaluated made available experimenters freely available software toolbox participants empirical data acquired part previously reported study data participant included here. participants previous study normal corrected-tonormal vision gave written informed consent. national institutes health institutional review board approved consent protocol data acquisition data acquired using siemens tesla magnetom scanner clinical research center national institutes health campus partial volumes occipital temporal cortices acquired using -channel head coil anatomical weighted volumes acquired experimental runs. standard mprage corresponding ge-pd images collected mprage images normalized ge-pd images high-resolution anatomical data fmri data analysis. task procedure naturalistic scene images presented aperture gradually traversed visual field sweep aperture took evenly spaced steps traverse entire screen eight sweeps formed following order br-tl bl-tr tl-br tr-bl. identical runs participant. scene stimuli covered circular area changed every runs participants performed colour-detection task fixation indicating button press white fixation changed red. colour fixation changes occurred semi-randomly colour changes sweep. figure example stimulus frames used mapping. scene images covering circular area display presented aperture moved gradually visual field. single sweep across visual field took consisted equally timed steps equal width. aperture completed eight sweeps participants required maintain fixation indicate detection colour change fixation button press. adapted silson pre-processing reported silson functional data initially motion-corrected using analysis functional neuroimages software package following removal eight dummy volumes allow stabilisation magnetic field. subsequent analyses conducted using version feature selection reduce computation time bayesian procedure performed initial general linear model analysis pick voxels showing differential response depending location aperture. also enabled model regress nuisance effects first divided stimulus display equally sized squares. frame stimulus identified squares illumination. built regressor square well regressors representing head motion regressor modelling mean estimated parameters model created f-contrast identify positive negative effects first regressors resulting statistical image thresholded family-wise error corrected revealed voxels located primarily occipital lobe extending ventrally posterior fusiform parahippocampal region. voxels taken forward analysis. figure general linear model feature selection. split stimulus space squares constructed general linear model enlarged first columns represent locations stimulus space remaining columns represent subject’s head motion. timeseries extraction modelling performed per-voxel basis. enable this timeseries extracted voxel identified above high-pass filtered remove frequency scanner drift whitened remove auto-correlation time. motion regressors mean regressed out. procedure repeated scanning resulting timeseries averaged runs. data odd-numbered runs used main analysis even-numbered runs kept aside evaluate test-retest reliability model specification specified generative model predicted bold timeseries given visual stimuli. model consisted parts neuronal model describing brain’s response stimuli observation model describing change neurovascular coupling bold response caused neuronal activity. function commonly used mapping although used normalised rather unnormalised density response summed illuminated pixel screen scaled parameter model parameterised 𝑘dimensional vector specified position 𝑘-dimensional stimulus space 𝑘-dimensional covariance matrix specified width rotation receptive field. used stimuli dimension specified cartesian coordinates visual space. neuronal parameters needed certain constraints placed values. instance needed positive whereas constrained within stimulated area visual field. however optimisation algorithm employed expected normally distributed prior distributions parameter constrained variance. overcome this substituted parameter latent variable could freely adjusted optimisation algorithm. within model variables transformed within desired range values used calculate neuronal response equation next detail transformations parameter. constrained centre fall within circular area screen illuminated scanning. approach model influence stimulation beyond stimulated area finding parameters model particularly ill-posed problem constrain location introduced latent variables controlled distance angle location relative centre visual field. variables freely adjusted optimisation algorithm model fitting transformed polar coordinates within model follows ncdf cumulative density function univariate normal distribution. transforms ensured distance centre visual field constrained polar angle constrained radians. second transform converted polar cartesian coordinates entered model equation could therefore guarantee whatever values selected latent variables optimisation algorithm location would fall within circular stimulated area. width parameterised standard deviation constrain width range introduced latent variable latent variable could freely adjusted optimisation algorithm transformed within model give width complete specification neuronal model latent variable assigned prior distribution representing beliefs model fitting. latent variables representing location priors transformation constrain converted normal prior distributions bounded flat distributions values allowed ranges equally likely second transformation polar cartesian coordinates changed peaked distribution around origin. considered reasonable prior given overrepresentation fovea cortex prior latent variable representing width transformation gave equal prior probability widths allowed range. prior distribution translated expected parameter confidence interval large variance reflected uncertainty parameter. found small positive prior value parameter provided reasonable starting point optimisation algorithm. haemodynamic model predicted neuronal activity model extended balloon model series differential equations describing neuronal activity causes change blood flow blood flow causes bold response. parameters model fixed based previous empirical measurements however three parameters estimated voxel-wise basis transit time rate signal decay ratio intraextra-vascular signal certain parameters model field-strength specific adjusted data according recommendations heinzle intravascular relaxation rate frequency offset outer surface magnetized vessels prior distribution normal distribution mean variance free neurovascular haemodynamic parameters concatenated parameters neuronal model estimated simultaneously. model completed setting prior expectations observation noise assumed i.i.d. normally distributed mean zero. prior precision noise variance based values typically used spm’s bayesian modelling framework. model estimation voxel separately model fitted data using variational laplace algorithm implemented matlab function spm_nlsi_gn.m included software package. bayesian estimation procedure provides important estimates. first approximation model evidence probability observing data given model approximation known negative variational free energy expressed follows term distance measure distributions estimated parameters true parameters cannot compute this know true parameters. however model evidence fixed know maximising free energy minimise second term closest approximation model evidence. free energy defined full elsewhere however important recapitulate decomposed parts prior distribution parameters estimated distribution parameters. definition complexity gives free energy advantages approximations rather simply counting number parameters model divergence takes account full covariance among parameters meaning parameters estimated independent contribute complexity term covary. using free energy compared models find accurate least complex explanation data. algorithm also provides estimated parameters maximise free energy. algorithm employs laplace assumption means parameters prior posterior normally distributed. thus parameter whether neuronal haemodynamic expected value uncertainty well estimated covariance among parameters. report parameters uncertainty various forms throughout paper. performed model estimation separately timeseries voxel. improve performance initialized model fitting algorithm parameters identified using grid search canonical haemodynamic response function. reduce total estimation time developed software functions divide voxels across parallel computer cluster combine results following estimation included software implementation divided estimation across -core cluster computer core cluster estimation took average seconds voxel complete around hours minutes whole analysis. parameter generation estimated models voxel generated maps estimated parameters across brain thresholded parametric maps include voxels something learnt parameters seeing data relative priors. perform thresholding compared evidence estimated model nested model parameters fixed prior means. evidence models similar meant knowledge parameters improve result seeing data. hand evidence full model stronger evidence nested model would mean confident parameters seeing data. compute model comparison voxel’s model specified nested model prior variance location width parameters fixed zero. computed ratio evidence full model nested model ratio called bayes factor ratio approximately equal difference free energy model using bayesian model reduction generalisation savagedickey ratio used classical statistics. calculation performed order milliseconds voxel. computed bayes factor voxel computed posterior probability full model plotting haemodynamic response illustrate estimated variability bold response across brain computed impulse response function model averaged responses across voxels response functions computed using volterra kernels described friston plotting prfs plotted receptive field example model fitting data prior receptive field computed taking samples model’s prior multivariate distribution parameters sample computing response neuronal function evenly spaced locations visual field responses averaged. referred prior predictive density point space parameters using approach able plot accounting uncertainty location size. posterior response similarly computed using estimated parameters following model fitting. bayesian parameter averaging order summarise models’ expected values covariance across voxels computed bayesian parameter average average parameters across voxels weighted precision estimate. data entering vector estimated parameters voxel together precision matrix provides probability distribution parameters vector means covariance matrix final line equation states probability given parameter averaged across voxels different zero. 𝑁𝐶𝐷𝐹 normal cumulative distribution function mean variance formulation made simplifying assumption voxel’s data independent. computing correlations entropy maps compute correlation parameters converted covariance matrix correlation matrix normal way. visualise spatial distribution parameter uncertainty created maps entropy defined voxel determinant estimated covariance matrix model voxel entropy multivariate gaussian units nats positive values indicate greater uncertainty parameters. simulation evaluate face validity approach performed simulations. first estimated empirical signal-to-noise ratio data. randomly selected estimated model fitted timeseries voxel right hemisphere near midline integrated model time give predicted bold timeseries computed residual timeseries calculated based standard deviation next chose random voxels empirical data used estimated prfs voxels generate simulated bold timeseries. added five levels observation noise timeseries noisy level noise similar empirical data fitted models simulated timeseries correlated estimated parameters ‘true’ parameters generated data. note validation analyses converted latent variables underlying parameters entered model quantities interest experimenters. alternative models compared models address questions. first whether single gaussian difference-of-gaussians response function would better explanation data. function excitatory centre inhibitory surround. second question asked shape receptive field would best explain data specified models replaced width parameter separate parameters representing horizontal width vertical width enabled take elliptical shape. implemented changing covariance matrix include separate parameters created versions circular elliptical elliptical rotation models used difference gaussians response function existing gaussian distribution complemented second distribution certain constraints ensure would inhibitory surround. basic case circular receptive field modified response function follows here neuronal response difference normal distributions. first represented excitatory response centre prf. parameterised scaling parameter centre location covariance matrix second normal distribution represented inhibitory surround prf. location excitatory centre different scaling covariance difference scaling prfs controlled parameter difference prfs’ widths controlled parameter positivity constraints enforced scaling parameters formulation introduced free parameters compared previous model ensured response centre positive response surround negative. using latent variable constrained parameter fall range flat prior. difference scaling surround relative centre constrained positive using parameter. translated prior expectation confidence interval bayesian model comparison compared evidence data different models using free energy described above. voxel numbers free energy competing model collated matrix. submitted matrix analysis using random effects model typically approach used context studying groups subjects. assumes subject’s data generated models comparison model estimates probability randomly selected subject’s data generated model. known expected probabilities model. additionally gives probability model better others comparison protected exceedance probabilities. here simply used multiple voxels instead multiple subjects model identified best explained data spatially extended regions brain. performing model comparison level included voxels next performed comparisons region interest basis. used anatomical masks supplied anatomy toolbox version defined based cytoarchitectonic observations series studies regions hocd hocd hocv hocv hocla hoclp. closest corresponding functionally defined regions respectively however correspondence cytoarchitecture function exact take account between-subjects variability. made modification masks split mask dorsal ventral parts give hocd hocv situated either side hoc. inverse warped mask space native space subject used custom masks constrain model comparisons. strictly procedure described assumes sources data independent. assumption violated spatial smoothness fmri data nonetheless method allowed provide summary measures completeness repeated analyses model comparison removing issue spatial smoothness assumptions using mean timeseries rather individual voxel. initially found model fits poor. prior observation noise longer realistic averaging voxels essentially eliminated zero-mean gaussian noise therefore increased prior precision noise effectively stating averaged timeseries expect observation noise. results analysis illustrated supplemental figure summarised section results. parameter estimates estimating model voxel produced maps parameters confirmed parameters keeping established properties visual cortex. gradient centre position periphery fovea along midline occipital cortex hemisphere responded contralateral visual field widths estimated smallest early visual cortex becoming larger descends temporal cortex figure parameter maps estimating basic model. left distance centre middle visual field colours indicating degrees visual angle projected onto sagittal slice subject’s structural close midline. middle polar angle within visual field units radians shown axial plane. right width parameter colour indicating degrees visual angle smaller prfs blue larger red. maps thresholded model posterior probability remaining parameters controlled scaling neuronal response transit time rate decay ratio intraextra-vascular signal estimated voxel-wise basis together parameters. investigate whether estimating neurovascular haemodynamic response voxel-wise basis justified i.e. whether variation across voxels calculated estimated bold impulse response function voxel summarised responses mean standard deviation revealed considerable variability height peak across voxels emphasising importance estimating haemodynamic well neuronal parameters model. figure variability estimated bold impulse response function across voxels response stimulus time duration solid line mean across voxels shaded area mean standard deviation across voxels. prior response posterior response fitted timeseries example voxel shown figure figure response model shown point retinotopic space model’s parameters prior means variances. account uncertainty sampled parameters according prior probability distributions generated response based sampled parameters. repeating times averaging responses gave prior predictive density shown. figure shows response model parameters estimated data demonstrating punctate estimate left visual field. plot takes account uncertainty parameters sampling strikingly uncertainty visible diffuse pattern prior explained away seeing data. close data also seen qualitatively modelled timeseries noted post-stimulus undershoot bold response well captured known limitation haemodynamic model applying return issue discussion. figure estimated fitted timeseries example voxel putative right response model position visual space prior bayesian model fitting. prior predictive density uses sampling take account uncertainty parameters. prior model parameters sampled times predicted responses generated averaged. units axes degrees visual angle. posterior estimated response bayesian estimation. modelled timeseries observed timeseries correlation entropy advantage bayesian approach uncertainty parameter estimated covariance among parameters. covariance important parameters strongly covary cannot precisely estimated uncertainty taken account making inferences. investigate covariance among parameters averaged models voxels using bayesian parameter averaging transformed averaged covariance matrix give correlation matrix. shown figure upper left quadrant shows correlations among neuronal parameters bottom right quadrant shows correlations among haemodynamic parameters right quadrant shows correlation neuronal haemodynamic parameters. reassuringly parameters representing location visual space weak correlation parameters. however width parameter strongly correlated scaling parameter practice means could increase width increase scaling parameter extent change predicted timeseries. phenomenon specific bayesian approach proposed here concern estimation method despite correlation generally quantified. correlation matrix also revealed statistical dependencies among haemodynamic parameters well scaling parameter haemodynamic parameters. practice correlations among haemodynamic parameters unlikely problem experimenters rarely need make inferences parameters individually. figure correlation among model parameters averaged voxels. neuronal parameters neuro-vascular haemodynamic parameters values absolute value greater labelled. covariance among parameters induces uncertainty parameter estimates addition uncertainty induced observation noise. next mapped uncertainty computing entropy model positive values indicate greater uncertainty parameter estimates. computed separate entropy maps location width parameters. entropy location showed could certain position early visual cortex moves laterally descends temporal cortex uncertainty increases. less confidence overall width location minimum entropy nats width compared nats location surprisingly early visual cortex would expected certain width fact least certain could smaller prfs typify early visual cortex require higher resolution stimuli order gain confident estimates size. additionally uncertainty width induced covariance scaling parameter identified above. figure entropy maps showing uncertainty location uncertainty width estimation models. positive values indicate greater uncertainty. colours indicate entropy units nats. face validity next performed forms validation used simulations establish face validity approach used empirical data evaluate test-retest reliability across runs. fitted models simulated timeseries ‘true’ parameters generated data known varying levels observation noise. expected values position width neuronal scaling parameters closely matched true parameters width beta parameters dropping markedly accuracy correlations highly significant neurovascular haemodynamic parameters estimated less accurately sensitive parameters. covariance among haemodynamic parameters reducing identifiability expected values. accuracy polar angle parameter slightly lower expected found artefact polar coordinates. prfs parameter close radians test close radians validation vice versa. despite adjacent visual space difference sign reduced test-reliability. corrected converting polar cartesian coordinates accuracy parameter ceiling reducing correlation correlation also investigated accuracy estimated uncertainty parameters anticipated posterior confidence interval parameter would include true parameter generated simulated data approximately time. level parameter computed fraction voxels included ‘true’ parameter estimated confidence interval estimated data confidence intervals behaved expected. reducing accuracy confidence intervals decayed slowly perhaps appearance local optima parameter space coupled correlation among certain parameters. however overall results demonstrate estimates uncertainty robust noise even haemodynamic parameters least accurate expected values. figure accuracy parameter estimates assessed simulation. left pearson’s correlations parameters used simulate data parameters estimated simulated data. vertical axis lists levels observation noise quantified signal-to-noise ratio darker colours indicate lower correlations. parameters figure right percentage voxels estimated confidence interval contained parameter generated data. test-retest reliability next tested consistency parameter estimates across scanning runs empirical data. main analysis above used odd-numbered runs. used even-numbered runs validation correlating parameter estimates half data voxel-wise basis. note made strong assumption success coregistration assumed voxels runs perfectly aligned. nevertheless correlation parameter estimates oddeven-numbered runs strong converting polar coordinates cartesian coordinates raised test-retest accuracy coordinates respectively. model comparison validated modelling framework next used questions. first asked whether neuronal population within voxel excitatory response stimuli within receptive fields whether also exhibited inhibitory response periphery receptive fields. represented alternatives using models single gaussian response function models difference gaussians response function excitatory centre inhibitory surround previously introduced also asked three shapes receptive field would offer best explanation data circular elliptical elliptical rotation formally addressed questions comparing evidence data competing models model wins comparison model strikes optimal balance accuracy complexity. formed model space akin factorial design. first factor response function models either single gaussian response function. second factor shape receptive field specified models estimated free energy within voxel. thus free energies voxel representing relative evidence model pooled across voxels using random effects analysis whole volume analysis figure shows expected probability model. voxel picked random probabilities model generated data. model strongest probability model model circular receptive field excitatory inhibitory dynamics. thus choosing voxel random would chance model would best model next best model single gaussian model remaining models much weaker probability. figure shows protected exceedance probability probability model better models comparison. probability approaching certainty model winning model therefore best explanation randomly chosen voxel’s data. example timeseries fitted model shown figure together comparison demonstrates better explanation single gaussian model overall elliptical angled prfs level whole visual cortex contribute enough model evidence outweigh added complexity induce. figure comparison models across included voxels. models either single gaussian difference gaussians receptive field circular elliptical elliptical rotation shown columns. expected probability model. protected exceedance probability model probability model better others comparison. example timeseries winning model fitted data voxel shown figure regions interest analysis next investigated whether competing models different explanatory power different brain regions. repeated model comparison within regions interest based predefined anatomical masks. regions model rather single gaussian model best explained data single gaussian models preferred right hocv hocd right hocv hocla. result left hocv ambiguous gaussian model model indicate heterogeneous population response region. regards first question whether evidence excitatory-inhibitory receptive field conclude case regions lower visual hierarchy however benefit seen majority highest level regions modelled simpler gaussian model selected winner. second question regarded shape receptive field. regions model simple circular receptive field winner. therefore modelling elliptical shape rotation improve model sufficiently outweigh added complexity. clear exception bilateral hocla strong evidence single gaussian angled model winner. right hocv evidence divided model model identified best model region next visualised extent visual field covered models’ receptive fields. summed receptive field overall winning model across voxels form coverage maps confirmed responded primarily contralateral side retinotopic space dorsal regions responding lower visual field ventral regions responding upper visual field. lateral regions responded preferentially lower visual field strikingly coverage area bilateral hocla models angled towards fovea. quantify angle estimates hocla averaged parameters across voxels using bayesian parameter averaging. gave probability distribution representing average correlation coefficient expected value left hemisphere right hemisphere. probability parameters non-zero respectively. figure results comparing different models regions interest. left columns grid shows factorial model space. models either employed gaussian distribution difference gaussians type three variants circular elliptical elliptical rotation shades grey white labels indicate protected exceedance probability probability model better others tested. right columns summed prfs winning model within region colours scaled within plot individually representing arbitrary units neuronal activity. region identities detailed section finally performed analysis investigate whether similar results would found fitting models mean timeseries region rather fitting model every voxel independently note model best explains average response extended region necessarily model best explains individual voxels’ timeseries variability across voxels response nonetheless analysis using less data every region exception left favoured rather gaussian response function. whereas individual voxels’ receptive fields best described circular model averaged timeseries regions best explained angled rotated receptive field response functions discussion paper introduced bayesian framework specifying estimating comparing models. framework generic applied stimulus spaces dimension; evaluated mapping visual receptive fields. validated method using simulations simple evaluation test-retest reliability demonstrated used test hypotheses neuronal response functions voxel level within predefined regions interest. advantage approach uncertainty parameter estimate estimated computing full covariance matrix parameters. gave rise striking observation strong correlation neuronal scaling parameter width parameter words increasing either parameter would certain extent give change modelled bold response limits precision either estimated. appropriate dealing take account uncertainty making inferences. here plotting prf’s posterior predictive density visualise receptive field represents uncertainty position width. made clear relatively high data used scanned averaged runs receptive field estimated high precision despite covariance parameters. interesting precision parameters vary acquiring empirical data lower field strengths. suggested simulations reduced taking uncertainty account becomes increasingly important. generative model implemented here included established model neurovascular coupling bold response. whereas studies canonical haemodynamic response function tailored subject-by-subject basis estimated parameters haemodynamic model simultaneously parameters voxel-wise basis. comes computational cost estimation takes longer standard approaches estimation. however results demonstrate utility voxel-wise model. considerable variability peak bold response across voxels would modelled using fixed bold response across voxels. reassuringly parameters haemodynamic model weakly correlated parameters representing location width meaning neuronal haemodynamic contributions bold timeseries separated high confidence. demonstrated testing hypotheses response function shape embodying hypothesis model comparing evidence each. previously stated models…are centered statistical hypothesis testing…rather strategy follows constructivist philosophy creating models account increasingly large range stimuli many visual areas. developing models general possible requires identifying offer best trade-off accuracy complexity. penalty complexity required comparing models otherwise complex model always considered best risk overfitting noise failing generalise. finding best several models terms balancing accuracy complexity achieved identifying model highest model evidence procedure referred bayesian model comparison. used approximation model evidence free energy score models. unlike approximations free energy takes account full covariance among parameters reflects fact independent parameters contribute model’s complexity correlated parameters. using bayesian model comparison first asked whether response voxel best described single multivariate normal distribution difference gaussians model excitatory centre inhibitory surround model previously found explain variance offered little improvement higher level regions similarly using bayesian model comparison found models better single gaussian models cytoarchitecturally defined regions roughly corresponding exception right hocv strong evidence basic single gaussian model. higher level regions found strong evidence simpler single gaussian model. case region hocd region hocla fact found strong evidence simpler model higher regions zuiderbaan found little difference explained variance higher regions speaks notion model evidence favour simpler model unless sufficient gains accuracy outweigh added complexity. found single gaussian model coupled balloon model bold response failed capture majority post-stimulus undershoot bold response parts timeseries appear fitted slightly better using model coincide inhibitory activity centre-surround dynamics although noticeable post-stimulus undershoot remains unmodelled. recently proposed upgrade bold response model used offers physiologically plausible representation post-stimulus undershoot could included framework. model comparisons could performed ensure still strong evidence neuronal response function context haemodynamic model better explains bold undershoot. identified model preferred regions second question regarded shape receptive field. compared three receptive field shapes circular elliptical elliptical rotation tested evidence models specifications sub-regions brain. regions simple circular model winner meaning data could support complex explanation involving elliptical shape rotation. could confident complex model winner bilateral vla. coverage maps showed prfs regions covered area contralateral lower visual field angled towards fovea. anatomically defined region proposed correspond functionally defined region closely related region smith defined responding contralateral lower hemifield. detailed discussion definitions regions within refer readers larsson heeger wish draw strong conclusions region-of-interest analyses using data single subject functionally-defined regions demarcated cortical surface. indeed results suggest limitations correspondence anatomically defined retinotopically defined regions. instance hocd suggested align functional region however full hemifield representation whereas results found coverage lower hemifield. uncertainties resolved extending modelling framework operate cortical surface subject-specific visual regions delineated. analyses presented here simply hope demonstrated models formerly compared based model evidence summarised within regions interest address interesting hypotheses. found that models tested parsimonious model explained data difference gaussians model circular receptive field limitation explanatory power model used here models generally phenomenological. effective describing summed receptive field voxel brain region give insight receptive field arises underlying neuronal circuitry. developments modelling neuronal circuitry using functional imaging data dynamic causal modelling come iteratively developing models afford greater model evidence predecessors. providing framework evaluating models hope facilitate development biologically plausible generative models prfs. likely spatiotemporal models explain lateral connections neuronal populations give rise distributed pattern activity across cortical sheet. neural field models applied context magnetoelectro-encephalography recordings offer first step direction. future work several directions. estimation speed models generally seconds voxel such expect framework primarily used voxel-wise manner small regions interest alternatively summary timeseries regions interest although latter guaranteed identical results however opportunities software optimisation instancing removing overhead converting polar cartesian coordinates. meantime addressed performance issue providing software tools distributed model estimation parallel processors future could extended take advantage massively parallel computing already demonstrated context dynamic causal modelling would also helpful develop integration freesurfer software package enable projection results cortical surface. terms applications main focus ongoing efforts model higher dimensional spaces. generality approach makes ideally suited mapping multimodal abstract stimulus spaces onto brain number model parameters. hope tools implemented useful researchers variety fields. appendix software implementation developed suite software tools specifying estimating comparing models. matlab functions depend open-source software package underlying algorithms dynamic causal modelling toolbox forms reference implementation bayesian framework described although hope given sufficient detail manuscript could re-implemented software packages. bayesprf toolbox available https//github.com/pzeidman/bayesprf toolbox structured around series operators upon models. model together timeseries represented matlab structure stored file format prf_<name>.mat. typical workflow proceeds follows. performs initial analysis using general linear model identify voxels take forward analysis timeseries extracted using ‘eigenvariate’ button also performs necessary pre-processing. resulting file contains summary timeseries included voxels individual timeseries voxel. next specifies model using spm_prf_analyse provides options whether summary timeseries individual voxels’ timeseries. averaging runs required performed stage. model evidence parameters estimated using spm_prf_analyse. results estimation reviewed projected onto orthogonal projections brain using spm_prf_review create parameter maps already exist. large number voxels estimated tractable parallel computing estimate models multiple voxels simultaneously. toolbox provides methods this. estimation function option ‘useparfor’ take advantage mathworks parallel computing toolbox available. alternatively function provided take multi-voxel file split multiple files spm_prf_analyse. individual files estimated separate machines instance separate nodes cluster computer merged estimation complete using spm_prf_analyse. results merged file reviewed. within model file stored priors posteriors timeseries data model configuration. summary important fields given table users wishing design models modify current ones wish take advantage spm_prf_editor tool provides manipulating parameters model. description prior mean parameter prior covariance parameters name model function matrix timeseries data estimate model coordinates timeseries brain structure representing stimuli displayed scanning including onsets durations coordinates stimulated pixels estimated parameters voxel estimated covariance parameters voxel estimated precision noise variational free energy model voxel aponte e.a. raman sengupta penny w.d. stephan k.e. heinzle mpdcm toolbox massively parallel dynamic causal modeling. neurosci. methods doi./j.jneumeth... eickhoff s.b. stephan k.e. mohlberg grefkes fink g.r. amunts zilles toolbox combining probabilistic cytoarchitectonic maps functional imaging data. neuroimage doi./j.neuroimage... moerel martino formisano processing natural sounds human auditory cortex tonotopy spectral tuning relation voice sensitivity. neurosci. doi./jneurosci.-. palacci sacanna steinberg a.p. pine d.j. chaikin p.m. yartsev m.m. ulanovsky representation three-dimensional space hippocampus flying bats. science doi./science. silson e.h. chan w.-y. reynolds r.c. kravitz d.j. baker c.i. retinotopic basis division high-level scene processing lateral ventral human occipitotemporal cortex. neurosci. doi./jneurosci.-. figure results comparing different models regions interest data mean timecourse region. regions given cytoarchitectonic name name closest matching functionally defined region brackets. left columns grid shows factorial model space. models either employed gaussian distribution difference gaussians type three variants circular elliptical elliptical rotation shades grey white labels indicate posterior probability model. right columns modelled response winning model within region. colours scaled within plot individually representing arbitrary units neuronal activity.", "year": "2016"}