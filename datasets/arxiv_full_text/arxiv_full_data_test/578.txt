{"title": "Correlation-Compressed Direct Coupling Analysis", "tag": "q-bio", "abstract": " Learning Ising or Potts models from data has become an important topic in statistical physics and computational biology, with applications to predictions of structural contacts in proteins and other areas of biological data analysis. The corresponding inference problems are challenging since the normalization constant (partition function) of the Ising/Potts distributions cannot be computed efficiently on large instances. Different ways to address this issue have hence given size to a substantial methodological literature. In this paper we investigate how these methods could be used on much larger datasets than studied previously. We focus on a central aspect, that in practice these inference problems are almost always severely under-sampled, and the operational result is almost always a small set of leading (largest) predictions. We therefore explore an approach where the data is pre-filtered based on empirical correlations, which can be computed directly even for very large problems. Inference is only used on the much smaller instance in a subsequent step of the analysis. We show that in several relevant model classes such a combined approach gives results of almost the same quality as the computationally much more demanding inference on the whole dataset. We also show that results on whole-genome epistatic couplings that were obtained in a recent computation-intensive study can be retrieved by the new approach. The method of this paper hence opens up the possibility to learn parameters describing pair-wise dependencies in whole genomes in a computationally feasible and expedient manner. ", "text": "learning ising potts models data become important topic statistical physics computational biology applications predictions structural contacts proteins areas biological data analysis. corresponding inference problems challenging since normalization constant ising/potts distributions cannot computed eﬃciently large instances. diﬀerent ways address issue hence given size substantial methodological literature. paper investigate methods could used much larger datasets studied previously. focus central aspect practice inference problems almost always severely under-sampled operational result almost always small leading predictions. therefore explore approach data pre-ﬁltered based empirical correlations computed directly even large problems. inference used much smaller instance subsequent step analysis. show several relevant model classes combined approach gives results almost quality computationally much demanding inference whole dataset. also show results whole-genome epistatic couplings obtained recent computation-intensive study retrieved approach. method paper hence opens possibility learn parameters describing pair-wise dependencies whole genomes computationally feasible expedient manner. inferring interactions multiple sequence alignment emerged recent years important development statistical physics computational biology. main model paradigm data infer terms ising model data boolean infer terms potts model data categorical statistical point view inference problems exponential families physical point view approach called inverse potts/ising problem direct coupling analysis paper latter term abbreviation dca. used predict residue-residue contacts protein structure similar protein sequences reviewed recently exciting perspective opened predicted contacts also leveraged predict complete protein structure silico recent applications predicting structure inter-protein contacts synergistic eﬀects mutations necessaractual comprised parts inference procedure choice consists samples dimension keep subset largest predictions assessment use. refer columns loci variables column alleles rows samples. hence consists samples sample list alleles. alternatively refer data dimension sample size. total number parameters inferred ising potts models proportional exact frequentist bayesian-point estimate methods i.e. maximum likelihood maximum posteriori computationally feasible data dimensions current practical interest many approximate inference methods therefore developed additionally statistical identiﬁability demands ﬁnal note currently best-performing versions protein contact predictions application hybrid schemes rely also information although schemes probably expected outperform pure also applications paper concerned performance dca-like procedures alone. external ﬁelds pairwise couplings; parameter introduced later convenience sets overall scale energy terms. next section simplicity take σi’s boolean variables ising gauge hiσi jijσiσj; focus couplings parameters zero. furthermore diagonal coupling elements zero. part approach introduced pseudo-likelihood maximization method maximizes conditional probabilities variable separately uses individual sample conﬁgurations inference process. statistically consistent i.e. gives almost surely result exact maximum likelihood inﬁnite data weaker procedure meaning scatter around results consistency pertain e.g. pseudolikelihood maximization establish practical superiority approaches combined regularization; conclusion instead relies empirical testing considerably involved arguments given size statistical characteristics initiated recently developed fully. note commonly used rule thumb retain many predictions data dimension statistical point view inappropriate unless square thin matrix i.e. unless least large protein problem usually case genome-scale problems matrix fraction predictions could retained case hence less realistic genome-wide problems fraction retained predictions would similarly small. extreme extrapolation genome every living human earth accurately sequenced would approximately every eighth nucleotide would vary estimated protein-coding part human genome would parameters potts model would large could scenario small fraction predictions retained therefore likely remain relevant. issue address work following. practice cumbersome even approximate inference methods largest datasets interest imagine scaling problems size human genome possible foreseeable future. however discussed above inference used retain small leading predictions conceivable problem dimensionally reduced inference. introduce straight-forward scheme makes possible show works silico real data. section review approach pseudo-likelihood maximization computational scheme section formally introduce correlation-compressed direct coupling analysis inference procedure. test cc-dca silico data models principles discussed section results presented section section present example epistatic couplings inferred collection whole-genome sequences human pathogen streptococcus pneumoniae. show cc-dca ﬁnds essentially leading couplings much demanding dca-based method minimize objective functions simultaneously separately removing constraint asymmetric implemented parallel allows considerable computational speed-up optimization problems also smaller. however sepformally introduce correlation-compressed direct coupling analysis basic motivation although pseudo-likelihood maximization approximate inference methods handle systems much larger full maximum likelihood feasible still cannot applied large systems. therefore approximations and/or simpliﬁcations called for. approach ﬁrst reduce based measured correlations apply method plm. idea hence take direct acronym seriously literally loci strong coupling general highly correlated opposite true loci highly correlated without strong coupling jij. suggests loci involved strong correlations retained loci eliminated resulting smaller data matrix carry enough information determine largest jij’s. principle cc-dca illustrated fig. fig. illustration correlation-compressed direct coupling analysis applied nucleotide sequence data. input multiple sequence alignment dataset matrix total number sample sequences length sequence. entry sequence letter data analyzed section sequence letters also covariance matrix loci computed reading i-th j-th column matrix column pair given score. section score used mutual information column pairs largest scores selected. considering call correlation-compressed data cc-dca. ﬂavor thus alternatively call resulting algorithm correlationcompressed pseudo-likelihood maximization ﬂavor assessed used following sections. study inverse ising inverse potts problems began decade stimulated early results neuroscience widely appreciated success practical data sets rests inference procedure choice retain largest predictions. controlled tests done generating data known distribution checking well parameters could recovered. tests done using root-mean-square criterion -matrices generated variant sherrington-kirkpatrick model early review representative examples time recent comprehensive survey. neither choices however suitable methods currently used. criterion includes predictions j-matrix largest therefore reﬂect well method recovers leading couplings. standard model spins gaussian couplings typical values couplings scale largest values follow gumbel extreme value distribution size couplings similar values fact challenging case possibly much realistic data. completeness back-compatibility also consider model current practice additionally calls model classes evaluation criteria discuss. also consider traditional spin glass model conventional methods extensively tested silico past. section apply cc-plm model data. coupling constants model quenched i.i.d. gaussian random variables mean zero variance coupling constants hence narrowly distributed around zero exceptionally strong interactions. testing procedures silico data natural graphical procedure scatter plot. measure inferred value interaction coeﬃcient given ordinate plotted true value given abscissa inference procedure accurate points along diagonal systematic diﬀerences between large interactions interactions test cases described below show deviations data cloud diagonal. identically distributed random variables characteristics. ising model means coupling coeﬃcients i.i.d. random variables potts models take elements coupling matrix loci general evaluation procedure using real data introduced used since empirical work applications. however equally used testing model classes therefore introduce formally boltzmann distribution model parameters. practice done markovchain monte carlo issues convergence strongly coupled systems tests therefore limit weakly coupled systems section consider real data true couplings unknown. fact known good approximation assume data generated potts model model class describes data all. recent paper couplings inferred modiﬁed procedure discussed view-point plausibility relevance light data obtained known facts pneumoniae biology. work compare results cc-dca visual procedure couplings displayed arcs circular plot darkness proportional coupling strength. strongest inferred couplings thus stand isolated black arcs grey background formed many weaker inferred coupling. circular plots produced circos given list scored couplings evaluation visualization proceeds follows evaluate cc-dca method follows. first generate coupling coeﬃcients/matrices according model test classes section section generate independent samples gibbs-boltzmann distribution. cc-dca method consists reducing smaller data matrix dca. leads couplings obtained cc-dca true positive rates tprb. evaluation data reduction scheme proceeds comparing couplings obtained cc-dca scatterplot comparing tpra tprb. obviously evaluation done relatively small systems otherwise could huge matrix once. works would however support idea procedure large data sets. schematically show results ferromagnetic spin-glass couplings severely undersampled slightly under-sampled problems different levels compression cc-dca step. ferromagnetic case signs ising terms positive spin-glass case random signs. ferromagnetic model critical temperature estimated around spin-glass model estimated around note physical temperature sets overall scale couplings. report results high-temperature regime expect cases considered mcmc converge fast enough sampled conﬁgurations obey gibbs-boltzmann equilibrium distribution. results shown severely under-sampled case conﬁgurations i.e. matrix shape case also under-sampled analogously thin matrix shape settings under-sampled fig. fig. show performance cc-dca scatter plots also performance using bare correlations predictors coupling coeﬃcients. cc-plm similar performance identifying strongest interactions system. number sampled conﬁgurations relatively large quantitative predictions ccplm strongest interactions rather accurate even though subsystem contains loci original system conﬁgurations severely undersampled high danger false positive results even diﬃcult case values strongest coupling constants still predicted relatively accurately cc-plm method couplings instances quite diﬀerent values relations strongly interacting loci naturally quite strong too. indeed strongest couplings spin-glass case figs. scatter plot practically falls single curve though straight line. reafig. scatter-plot inferred couplings true couplings ferromagnetic data. number spins number samples bottom scatter plot covariance elements inferred couplings. ﬁgures scatter plot cc-plm results diﬀerent levels compression inferred couplings. cc-plm subsystem size respectively. cc-plm strongest covariance coeﬃcients alone serve good indicators strongest direct interactions class. additional advantage cc-plm strengths strongest direct interactions also estimated practically straight lines figs. figs. fig. displays data true positive rates. severely under-sampled cases cc-plm basically able retrieve leading couplings well full couplings beyond compression threshold cc-plm falls curves. bare correlation analysis works instances almost well full result also deduced from particular fig. qualitatively behavior also found better sampled data fig. better-sampled spin-glass data correlations alone quite good predictors identity strongest coupled pairs result also read fig. discussed actual values couplings less well predicted bare correlations scatter non-linear deviations away diagonal scatter-plots figs. turn applying cc-plm spinglass model. fig. suggests covariance scales roughly linearly coupling constant high-temperature region high degree dispersion under-sampling equilibrium conﬁgurations sampled conﬁgurations used infer coupling constants qualitative agreement true values better perfect results direction obtained already early literature recently developed apply cc-plm subsystem corresponding strongest covariance elements. inference results subsystem size shown fig. respectively. predicted values coupling constants subsystems good match true values. cc-plm method therefore capable identifying strongest interactions also systems inferred values coupling coeﬃcients less accurate class. section discuss retrieving couplings genome scale real data. general biological term combinatorial eﬀects ﬁtness epistasis settings applied considered special cases epistasis generated physical interactions residues protein mechanism. literature overall assume inferred ising/potts parameters directly measure epistasis. phenomenon correlated variations loci data called linkage disequilibrium epistasis shared ancestry loci close enough genomic positions. following separate long-range couplings shared ancestry unlikely short-range couplings could caused epistasis shared ancestry. recent years datasets obtained whole genomes samples entire bacterial populations. characteristic sizes datasets larger millions larger thousand practice genomes naturally occurring organisms vary subset positions number varying loci larger order hundred thousand. still number potts model parameters describe distribution loci would order learn models directly data challenging. recent contributions used analyze epistasis human pathogen pneumoniae ﬁrst approach pneumococcal genome split chunks locus randomly selected chunk random selection putative interaction scored many times appeared lists sampling required many samplings practice several tens thousands. second approach optimized version loci once inferred potts parameters used standard dca. methods yield similar results also substantial computation time. well cc-dca manages challenging real-world dataset assuming results taken ground truth. evaluation visual comparison described section fig. true positive rates random power-law model ferromagnetic ising data random power-law model spin-glass ising data data dimension power-law exponent left panels show results sample number right panels show results sample number temperatures respectively ferromagnetic case spin-glass case cases well estimated critical temperature. elements coupling matrix ranked either according covariance matrix according predictions whole system according predictions correlation-compressed subsystem constructed using strongest covariance elements. data contains genome alignment isolates pneumoniae downloaded data repository format letters alphabet length thus data severely under-sampled. potts model ﬁtted data would following ﬁrst ﬁlter remove loci lack information loci bi-allelic. locus ignoring denote common letter major second common letter minor. ﬁltering criteria among loci loci bi-allelic loci least remaining loci high uncertainty; after removing additional uncertain loci loci survive. ﬁltering reduce number states states major minor context statistical physics resulting dataset collection conﬁgurations potts model constants. total number independent equilibrium conﬁgurations sampled temperature relation covariance element true coupling constant jij. relation predicted coupling constant true value whole system. relation predicted coupling constant true coupling constant subsystem size respectively. nodes; construction major common symbol loci therefore expect everywhere inferred external ﬁeld favouring state following standard procedures also used apply re-weighting procedure described re-weighting threshold columns order pairs number descending order identify loci members list top-ranking pairs. subset loci dca. asymmetric version plmdca hyper-parameters inferred couplings loci scored modiﬁed frobenius norm state counted i.e. states loci coupling matrix ising gauge procedure analogous plmdca method described residues included scoring shown improve accuracy contact long-range couplings among fig. strongest couplings identiﬁed cc-plm largest correlations. number loci appear endpoints links darkness edges represent strength couplings. positions along outer genomic coordinates units shortrange couplings distance smaller shown ﬁgure indicated figs. coarse-graining used visualisation interactions genes pbpb pbpx pbpa clearly visible. results obtained cc-dca loci involved strongest correlations shown fig. figs. appendix processing steps visualization described section numbering around fig. genomic position units plots hence along whole pneumoniae genome data genomic coordinate evaluate comparing visualization strongest couplings identiﬁed shown also visualization strongest correlations interactions genes pbpb pbpx well pbpx pbpa immediately visible figs. also possible identify links discussed well characteristic absence couplings fig. strong couplings identiﬁed depicted visualisation procedure used fig. long-range couplings displayed. additionally links genes pbpx pbpb pbpa also identify link triad interactions involving diviva site upstream gene fig. long-range correlations among strongest correlations loci used generate data fig. identiﬁed. similarly fig. identify comparatively short-range interaction pbpx pbpa interactions pbpb less evident; additionally observes ﬁgure strong shorter-range inferred interaction positions presumably spurious link absent fig. ferred reduced background density diﬀerent. point fig. emphasizes relatively short-range correlations positions fig. emphasizes long-range interaction positions link found fig. also otherwise figs. clearly similar another. conclusion agreement results obtained cc-dca dca-derived method deemed fair especially given cc-dca represents signiﬁcant simpliﬁcation computational task. although results also identiﬁed directly correlations overagreement cc-dca better. research supported chinese academy sciences presidents international fellowship initiative grant academy finland centre excellence coin national science foundation china thank zhang inspiring discussion marcin skwark discussions valuable comments manuscript. numerical computation carried partly cluster itp-cas. work introduced correlationcompressed direct coupling analysis convenient method detect strongest direct interactions datasets large direct application cumbersome feasible. validated method synthetic data sampled random power-law model standard sherrington-kirkpatrick model well additional planted large couplings. results good good cases tested. also shown cc-dca allows recover computational overhead results wholegenome bacterial population-wide sequence data. methods family quite challenging resourcedemanding full datasets consideration hence compared cc-plm published results results could obtained optimized version recently presented leave future work. work given detailed performance measures since components cc-dca either standard amply documented earlier literature data sizes tested present paper main computational bottleneck cc-dca compute covariance matrix based empirical data. whole-genome dataset section total time used compute correlations single-threaded code hours processor frequency runtime memory less practical applications task simpliﬁed maintaining running list strongest covariance elements discarding elements. further simpliﬁcations improvements future task. section consider simple modiﬁed model planted couplings form chains strongly interacting loci. test well cc-dca recover planted loci. system constructed follows note coupling constants chains strongly correlated. critical temperature conventional model temperature much higher value spins system weakly coupled except chains. spins chains strongly correlated even directly coupled perform analysis sampled equilibrium conﬁgurations plm. much infer coupling constants identify signiﬁcant interactions. latter task construct subsystem retaining spins involved strongest correlations. demonstrated fig. cc-plm model temperature first relation coupling covariance element cij. second third relation predicted coupling true coupling jij; results second obtained regularization parameter results third obtained ﬁrst column corresponds whole system. second column third column fourth column correspond subsystem spins respectively. strongest couplings obtained procedure fig. results cc-plm starting loci involved largest correlations. cases long-range inferred couplings similar fig. short-range couplings additionally displayed around outer rim. fig. ﬁgure fig. strongest couplings identiﬁed cc-plm largest correlations. number loci involved darkness edges represent strength couplings. short-range couplings distance smaller depicted around outer rim; long-range couplings depicted arcs. many short-range interactions appear around pbpa positions around genome. fig. strongest couplings identiﬁed cc-plm retaining largest correlations. number loci involved darkness edges represent strength couplings. visual impression quite similar figs. above. consortium. analysis protein-coding genetic variation humans. nature cordell. epistasis means doesn’t mean statistical methods detect humans. human molecular genetics leonardis lutz ratz simona monasson weigt schug. direct-coupling analysis nucleotide coevolution facilitates secondary tertiary structure prediction. nucleic acids research leonardis lutz ratz simona monasson weigt schug. secondary tertiary structure prediction tracing nucleotide coevolution direct coupling analysis. biophysical journal ekeberg hartonen aurell. fast pseudolikelihood maximization direct-coupling analysis protein structure many homologous amino-acid sequences. journal computational physics figliuzzi jacquier schug tenaillon weigt. coevolutionary landscape inference context-dependence mutations beta-lactamase tem-. molecular biology evolution golkov skwark golkov dosovitskiy brox meiler cremers. protein contact prediction amino acid co-evolution using convolutional networks graph-valued images. sugiyama luxburg guyon garnett editors advances neural information processing systems pages curran associates inc. gueudr´e baldassi zamparo weigt pagnani. simultaneous identiﬁcation speciﬁcally interacting paralogs interprotein contacts direct coupling analysis. proceedings national academy sciences jones buchan cozzetto pontil. psicov precise structural contact prediction using sparse inverse covariance estimation large multiple sequence alignments. bioinformatics jones singh kosciolek tetchner. metapsicov combining coevolution methods accurate prediction contacts long range hydrogen bonding proteins. bioinformatics page krzywinski schein birol connors gascoyne horsman jones marra. circos information aesthetic comparative genomics. genome research michel menndez hurtado uziela elofsson. large-scale structure prediction improved contact predictions model quality assessment. bioinformatics ovchinnikov park varghese p.-s. huang pavlopoulos kamisetty kyrpides baker. protein structure determination using metagenome sequence data. science puranen chewapreecha pesonen turner harris beres musser parkhill bentley aurell corander. interacting networks resistance virulence core machinery genes identiﬁed genome-wide epistasis analysis. plos genet uguzzoni john lovis oteri schug szurmant weigt. large-scale identiﬁcation coevolution signals across homo-oligomeric protein interfaces direct coupling analysis. proceedings national academy sciences weigt white szurmant hoch hwa. identiﬁcation direct residue contacts protein-protein interaction message passing. proc. natl. acad. sci. arxiv.v", "year": "2017"}