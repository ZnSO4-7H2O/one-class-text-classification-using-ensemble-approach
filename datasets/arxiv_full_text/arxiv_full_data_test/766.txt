{"title": "Two-Tier Mapper: a user-independent clustering method for global gene  expression analysis based on topology", "tag": "q-bio", "abstract": " There is a growing need for unbiased clustering methods, ideally automated. We have developed a topology-based analysis tool called Two-Tier Mapper (TTMap) to detect subgroups in global gene expression datasets and identify their distinguishing features. First, TTMap discerns and adjusts for highly variable features in the control group and identifies outliers. Second, the deviation of each test sample from the control group in a high-dimensional space is computed and the test samples are clustered in a global and local network using a new topological algorithm based on Mapper. Validation of TTMap on both synthetic and biological datasets shows that it outperforms current clustering methods in sensitivity and stability; clustering is not affected by removal of samples from the control group, choice of normalization nor subselection of data. There is no user induced bias because all parameters are data-driven. Datasets can readily be combined into one analysis. TTMap reveals hitherto undetected gene expression changes in mouse mammary glands related to hormonal changes during the estrous cycle. This illustrates the ability to extract information from highly variable biological samples and its potential for personalized medicine. ", "text": "swiss institute experimental cancer research bioinformatics biostatistics core facility brain mind institute school life sciences ecole polytechnique f´ed´erale lausanne lausanne switzerland inria saclay france growing need unbiased clustering methods ideally automated. developed topology-based analysis tool called two-tier mapper detect subgroups global gene expression datasets identify distinguishing features. first ttmap discerns adjusts highly variable features control group identiﬁes outliers. second deviation test sample control group high-dimensional space computed test samples clustered global local network using topological algorithm based mapper. validation ttmap synthetic biological datasets shows outperforms current clustering methods sensitivity stability; clustering aﬀected removal samples control group choice normalization subselection data. user induced bias parameters data-driven. datasets readily combined analysis. ttmap reveals hitherto undetected gene expression changes mouse mammary glands related hormonal changes estrous cycle. illustrates ability extract information highly variable biological samples potential personalized medicine. large datasets generated exponentially increasing pace biology medicine development tools analyze data lagging behind. high variability biological particular human samples poses challenge. takes large sample numbers understand distribution data extract statistically signiﬁcant features often choice normalization ambiguous aﬀects outcome analysis topology ﬁeld mathematics devoted study shapes. topological data analysis used reduce dimensions recognize patterns global gene expression data samples instance considered point clouds high-dimensional space. topological methods transform networks; nodes clusters samples edges determined common samples nodes analysis networks enables discovery speciﬁc patterns dataset. topology sensitive scale useful highly variable biological data. approaches applied numerous scientiﬁc domains including biology clustering method based algebraic topology mapper applied analyze large biological datasets global gene expression proﬁles temporal single-cell rna-seq data genomic data viral evolution global gene expression analysis data pre-processed statistical tool combination statistical tool mapper called progression analysis disease since outcome several statistical method depending case linear regression strongly aﬀected outliers control test group large sample numbers critical method render reliable results finding outliers removing troublesome small datasets deﬁnition outliers arbitrary like clustering methods k-means well mapper alone hierarchical clustering depend parameters user choses; modifying parameters changes output signiﬁcantly finally clustering methods k-means verify stability results small perturbations dataset lead diﬀerent clusters diﬀerent conclusions here present topology-based method inspired global gene expression analysis particularly suited small sample numbers called two-tier mapper identiﬁes signiﬁcant variation relatedness datasets used paired analysis takes account batches iii) stable require user choose parameters. global gene expression proﬁle represents high dimensional vector number genes. input two-tier mapper given matrices log- scale control samples test samples batches deﬁned groups samples distinguished technical variation date site analysis technical platform used biological disparity diﬀerent strains mice. ttmap comprises independent parts hyperrectangle deviation assessment global-tolocal mapper ﬁrst characterizes control group adjusts outliers yielding corrected control group serves reference calculate deviation test vector individually. second part uses mapper algorithm parameters carefully chosen; two-tier cover special distance automated parameter closeness. two-tier cover detects global local diﬀerences patterns deviations thereby capturing structure test group. test samples clustered according hyperrectangle deviation assessment compares value feature control sample others batch group diﬀerence absolute value parameter computed using variances genes median others considered outlier replaced number numbers replaced values sample control group represented barplot allows user discern outlier samples standard statistical analyses identify highly variable features control group thus creates matrix describes range expression values expected group corrected outliers. -coeﬃcient matrix corrected control group corresponds feature sample computed test sample decomposed c.tk dc.tk c.tk normal component projection onto hyperrectangle hence closest point inside deviation component remainder projection second step ttmap ﬁrst calculates distances provides visualization distances relations dataset manner analogous mapper forms bins according measure similarity test vectors. default similarity measure glmap mismatch distance given mismatches mismatch deﬁned gene diﬀerentially expressed opposite direction measured deviation component deviation must bigger avoid counting noise mismatch. mismatch distance mismatches deﬁned follows ﬁxed furthermore glmap uses ﬁlter function given properties interest samples. chosen user take account relevant variables patients cohort. default ﬁlter function glmap called total absolute deviation denoted measures overall deviation test vector control i.e. connected components represented spheres diameters increasing number samples component. spheres connected edge whenever i.e. algorithm links clusters share samples every sample assessed twice connectivity globally within quartile links formed local global structures enabling discovery subgroups based ﬁlter function global clusters color sphere output ﬁgure method determined average values ﬁlter function applied samples bin. legend color code provided bottom output ﬁgure size balls right diﬀerent tiers left i.e. overall clustering clustering diﬀerent quartiles list diﬀerentially expressed genes cluster provided. assess theoretical stability ttmap eﬀect modiﬁcations source space ﬁlter function approximations point cloud outputs studied since natural distance outputs ttmap assess stability directly ttmap graphs. therefore information contained ttmap graphs summarized diagram similar persistence diagram natural distance generalizes distance allowing comparison ttmap graphs. forming descriptor denoted space ﬁlter function veriﬁes mild regularity conditions. terms enriched establish following theorems stated informally precisely online methods theorem respectively. ttmap tested simulated data mimics situation standard methods weak i.e. small sample size moreover diﬀerences subgroups arise genes deviating opposite directions. control samples test samples generated composed subgroups given features. subgroups mean gene mean control group except genes mean times higher respectively lower genes true positives whereas features true negatives. accuracy method estimated simulating least datasets condition calculating percentage times ﬁnds right subgroups establishing clustering power method. since ttmap analytical workﬂow also assessed performance ﬁnding genes diﬀerentially expressed. performance ttmap assessed parameter given lowest percentile highest percentile distribution distance random variables variance ranging order measure accuracy ttmap situation ranging variance high variance. number signiﬁcant features test cases i.e. features respectively. ttmap performed correctly variance control group biologically relevant range variances signiﬁcant features respectively method could longer distinguish noise signal classiﬁed samples diﬀerent. chosen higher percentile method less good lower percentile variances much better higher variances moreover higher number signiﬁcant features better ttmap performs ﬁnding subgroups. performance also improved increased contrast standard clustering tool mclust like ttmap need parameter selection unable right groups line fact mclust learns data hence requires bigger sample size able perform properly. moreover dataset running time mclust times longer ttmap assess whether accuracy ttmap relies solely glmap applied mclust data obtained i.e. deviation components. accuracy mclust detecting subgroups improved average thus accuracy mclust improved reach level accuracy ttmap. assess performance ttmap regards genes determining cluster numbers true positives true negatives computed. datasets variance control group ttmap found close true positives true negatives since samples diﬀerentially expressed features expressed opposite directions moderated t-test detect true positives. even right groups provided poorly discovered true positives subgroups sample size together observation moderated t-test ﬁnds close true negatives suggests standard method likely detect signiﬁcant genes situation therefore dominated ttmap. ttmap assessed bigger datasets well consisting simulated samples. method performed well ﬁnding right subgroups case small datasets particular small variances method’s accuracy though decreases higher variances. diﬀerent sizes subgroups generated i.e. samples four respectively. even subgroups composed single sample method accurately distinguishes rest samples validate ttmap biological dataset analyzed atlas dataset comprises replicate samples drosophila tissues pooled males females third instar feeding larvae wandering larvae global gene expression four replicates tissue four replicates whole ﬂies assessed. group tissue compared composed compare ttmap established clustering methods used parallel k-means dbscan compute many organs four replicates cluster uniquely together. parameters standard methods chosen maximize performance i.e. k-means chosen equal minpts dbscan since four replicates. epsilon parameter dbscan chosen according guidelines dbscan k-means clustered four replicates respectively organs uniquely ttmap provided parameter clustered organs uniquely test practical stability ttmap compare dbscan k-means data quantilenormalised dbscan ttmap exhibit stable performance detecting uniquely clustering organs also reﬂected rand index measure similarity clusterings respectively. challenge methods randomly selecting genes observe clustering aﬀected dbscan performance drops uniquely clustering organs whereas ttmap remained stable uniquely clustering organs thus ttmap stable upon normalization random subselection. ttmap computed organ deviates least whole adult whole larva organs deviate testes brain surprisingly four spermatacea replicates clustered three replicates adult thoracic muscle vice versa. might explain missed genes standard tools points potential labelling mistake replicates fatbody wandering larva feeding larvae clustered together globally however three four feeding larvae samples clustered quartile wandering larva samples lowest quartile indicates fatbody feeding larvae wandering larva share diﬀerentially expressed genes comparison whole adult genes deviate diﬀerent extent control. next challenged method asking whether ttmap identify subtle gene expression changes occur intact organ related alterations hormone levels. this recurred rnaseq dataset collected intact mammary glands c/bl- balb-c females staged diﬀerent phases estrous cycle proestrous estrous diestrous based prevalence diﬀerent cell types vaginal smears principal component analysis grouped samples according strains ﬁrst analyzed balb-c samples c/bl separately made three comparisons higher overlap signiﬁcant genes strains found ttmap compared standard analysis increases estrous versus diestrous increase comparison estrous proestrous similar result comparison diestrous proestrous. heatmaps deviation components missed genes samples grouped ttmap analysis revealed genes diﬀerentially expressed signiﬁcantly opposite directions balb-c versus c-bl genes therefore opposite role strains hand looking heatmaps deviation components missed genes samples separated ttmap analyses overlapped discovered genes diﬀerentially expressed direction strains extent hence reach signiﬁcance either balb-c c-bl suggests pool analyses batches analysis gain important information genes vary direction extent loose unwanted features genes vary signiﬁcantly opposite direction. relevance missed genes illustrated pathway analysis common genes revealing positive regulation tumour necrosis factor superfamily cytokine production missed standard tools relevant also increased human menstrual cycle based extent deviation control group ttmap orders subgroups within phase signiﬁcant genes subgroups known previously unreported genes vary throughout mice instance ttmap conﬁrmed interferon signature found illustrated gene detects also missed genes mybpc progesterone target gene also shown diﬀerentially expressed human menstrual cycle lalba milk proteins apparent missed genes signiﬁcant deviation subgroups proestrous phase compared estrous instance lalba deviation representing fold change bigger deviation bigger mybpc fold change bigger contrast missed standard tools least fold change diﬀerence subgroups proestrous. provides explanation missed standard tools. searching ﬁrst overall closest group control ttmap also spots samples in-between phases illustrated four estrous developed topology-based clustering tool two-tier mapper outperforms existing clustering tools especially dealing small sample numbers. ttmap calculates relates individual deviation given control group. method includes improved extended version mapper algorithm. unusual two-tier cover rendered algorithm theoretically stable respect various modiﬁcations data. stability accuracy ttmap validated silico data real data. ttmap gives individual proﬁle deviation compare control relates samples opens perspective personalized medicine. able face highly variable datasets illustrated discovery transcriptomic subgroups outliers three phases estrous cycle relating possible alterations hormone levels rendering reﬁned description previous mapper applications require selection multiple parameters problem dependent hence automated optimized ttmap’s parameter selection made user-independent global gene expression analysis. ﬁlter function provides user additional information composition terms quartiles function global clusters. implemented here ﬁlter function takes account speciﬁc aspect reﬁnement. enhance method could ﬁlter appropriate metadata categorical information numerical data. outputs compared global clusters independent chosen ﬁlter function providing common reference outputs. ttmap applicable types data proteomic metabolomic even neurological data activity measurements brain regions ﬁlter function mismatch distance epsilon parameter changed adapted user cover speciﬁc needs contribution r.j. developed software analyses help supervision j.r. k.h. c.b. j.r. suggested data analyse helped familiarise m.c. s.o. analysed stability method theoretical aspects. authors contributed manuscript. r.j. came original idea. c.b. supervised biological part work k.h. mathematical. number features measured sample written thus element group group vector diﬀerent numbers features measured groups considers features measured across whole data set. feature parameter estimated using data. feature feature probability mismatch calculated. random vector representing gene expressions sample therefore hence probability +pjl) would represent probability gene either control lower control represents mismatch. whereas marginally higher control turn allows determine signiﬁcant number mismatches obtained quantiles poisson law. thus samples linked number mismatches less conﬁdence threshold mismatches samples following distribution. means cases distributed would small number mismatches therefore certain means cases distributed would high number mismatches therefore certain must separated. user therefore choose either cluster samples together sure samples clustered together choose separate samples sure samples need separated ﬁnally user option another value parameter mismatches expected already known. distance alternative distances correlation distance euclidean distance useful control group complete mismatch distance stringent version mismatch distance deﬁned above implemented glmap selected. note cases parameter needs adapted appropriate default value. mismatch distance appropriate gene expression data since captures deviation samples control values orientation regardless magnitude deviation. since microarray gene expression data modelled normal distribution simulated data generated follows. ﬁxed natural number less random lists real numbers generated each controls test samples genes. subgroups mean gene times higher respectively lower mean control genes. hence section functions assumed morse type deﬁned mild assumption purely technical assures mathematical objects deal well deﬁned. assumptions made stability theorems veriﬁed concerning ttmap subsequently section constant equivalence classes induced quotient function morse type reeb graph multigraph whose nodes one-to-one correspondence connected components critical level sets extended persistence given reeb graph so-called extended persistence diagram multiset points euclidean plane computed extended persistence theory points speciﬁc type either ext+ orienting reeb graph vertically height function connected component graph trunk multiple branches oriented upwards others oriented downwards holes. following correspondences obtained vertical span feature span image vertical spans branches oriented downwards given points ord; vertical spans branches oriented upwards given points rel; vertical spans holes given points ext− correspondences provide dictionary read structure reeb graph corresponding extended persistence diagram note bag-of-features type descriptor taking inventory features together vertical spans leaving aside actual layout features. consequence incomplete descriptor reeb graphs persistence diagram isomorphic combinatorial graphs metric graphs. family call result considering class morse-type pairs cover study structure stability respect perturbations within class. note that special case given dc.t corresponding underlying support given given quantiles real line given parameter interval create node point contained entirely lifespan materialized descriptor fact line segment bounded horizontal vertical projections onto diagonal contains ord∪ rel∪ ext+ create vertex also contains mayer-vietoris theorem used spaces ˜f−) ˜f−) theorem used morse-type condition implies deformation retracts neighborhoods deformation retracting onto hence following sequence exact theorem proved using three steps reconstruction scheme detailed statement according one-to-one correspondence connected components points step ensures many super-nodes connected components finally node corresponds connected component preimage interval connected component lies entirely connected component therefore gets connected super-node corresponding type connection matters since every pair intervals empty intersection. since connected component corresponding belongs least feature equivalently persistence pair proves links prescribed step ones same. stability theorems note {∆i}i∈i induces grid r)∪) intuitively distances points grid give amount perturbation allowed preserve structure reciprocally given amount perturbation drawing square radius around diagram point allows diagram points change grid cells structure impacted. proof. decompose various connected components f|xi g|xi note similarly induced maps thus build matching preserves connected components taking matching pair subdiagrams instance take pair matching achieving theorem stability respect perturbations domain. compact riemannian manifolds length spaces curvature bounded above. denote respective convexity radii. lipschitz-continuous morse-type functions lipschitz constants respectively. assume then correspondence proof. one-to-one matching connected components induced correspondence achieving proof follows line proof theorem diﬀerence proof theorem instead stability theorem one-to-one matching exist inﬁnite hence theorem stability respect point cloud approximations. submanifold positive reach convexity radius lipschitz-continuous morse-type function lipschitz constant every point lies within distance min{r/ s/c} minimum distance points diagonal proof. min{kx− belong connected component since belongs medial axis points achieving hence since number connected components. then proof theorem follows line proof theorem diﬀerence proof theorem instead stability theorem order theorems needs verify hypothesis. hence topology induced distance verify equivalent euclidean distance able last theorem. moreover function need lipschitz order theorems lastly needs morse-type order theorems stability implies every moreover since |ti| that|zi |ti|. therefore otherwise |ti| |ti| contradiction. moreover |ti| +|zi| since negative. strictly smaller |ti| otherwise |zi| contradiction. similarly |zi| |ti| strictly smaller |ti|. therefore must signature. clearly morse-type since l-norm. interval pre-image void thickened diamond compact locally connected. since thickening given length interval straightforward obtain needed homeomorphism conclude morse-type.", "year": "2017"}