{"title": "Consistency and convergence rate of phylogenetic inference via  regularization", "tag": "q-bio", "abstract": " It is common in phylogenetics to have some, perhaps partial, information about the overall evolutionary tree of a group of organisms and wish to find an evolutionary tree of a specific gene for those organisms. There may not be enough information in the gene sequences alone to accurately reconstruct the correct \"gene tree.\" Although the gene tree may deviate from the \"species tree\" due to a variety of genetic processes, in the absence of evidence to the contrary it is parsimonious to assume that they agree. A common statistical approach in these situations is to develop a likelihood penalty to incorporate such additional information. Recent studies using simulation and empirical data suggest that a likelihood penalty quantifying concordance with a species tree can significantly improve the accuracy of gene tree reconstruction compared to using sequence data alone. However, the consistency of such an approach has not yet been established, nor have convergence rates been bounded. Because phylogenetics is a non-standard inference problem, the standard theory does not apply. In this paper, we propose a penalized maximum likelihood estimator for gene tree reconstruction, where the penalty is the square of the Billera-Holmes-Vogtmann geodesic distance from the gene tree to the species tree. We prove that this method is consistent, and derive its convergence rate for estimating the discrete gene tree structure and continuous edge lengths (representing the amount of evolution that has occurred on that branch) simultaneously. We find that the regularized estimator is \"adaptive fast converging,\" meaning that it can reconstruct all edges of length greater than any given threshold from gene sequences of polynomial length. Our method does not require the species tree to be known exactly; in fact, our asymptotic theory holds for any such guide tree. ", "text": "common phylogenetics some perhaps partial information overall evolutionary tree group organisms wish evolutionary tree speciﬁc gene organisms. enough information gene sequences alone accurately reconstruct correct gene tree. although gene tree deviate species tree variety genetic processes absence evidence contrary parsimonious assume agree. common statistical approach situations develop likelihood penalty incorporate additional information. recent studies using simulation empirical data suggest likelihood penalty quantifying concordance species tree signiﬁcantly improve accuracy gene tree reconstruction compared using sequence data alone. however consistency approach established convergence rates bounded. phylogenetics non-standard inference problem standard theory apply. paper propose penalized maximum likelihood estimator gene tree reconstruction penalty square billera-holmes-vogtmann geodesic distance gene tree species tree. prove method consistent derive convergence rate estimating discrete gene tree structure continuous edge lengths simultaneously. regularized estimator adaptive fast converging meaning reconstruct edges length greater given threshold gene sequences polynomial length. method require species tree known exactly; fact asymptotic theory holds guide tree. introduction. molecular phylogenetics reconstruction evolutionary history molecular sequences typically sampled present day. common means performing molecular phylogenetics ∗these authors contributed equally work. subject classiﬁcations primary secondary keywords phrases phylogenetics tree reconstruction gene tree species tree maxlikelihood-based gene tree analysis molecular sequence gene assumed evolve according continuous time markov chain along branches unknown phylogenetic tree. likelihood function corresponding ctmc used sole criterion choose best tree. however sometimes insuﬃcient signal gene sequences deliver conﬁdent estimate. happen strong genetic conservation insuﬃcient evolutionary time short sequences processes obscuring tree signal. insuﬃcient signal turn results error-prone high variance estimator small modiﬁcations input data result rather diﬀerent inferred trees. introduction additional penalty parameter optimality function regularization common statistical response ill-posed problems. penalty parameter introduce extra information problem resulting lower variance estimator many cases shown improvement estimator. regularizationtype strategies made recent appearance phylogenetics fact gene trees evolve within organism-level species tree. gene tree history diﬀer species tree processes gene duplications losses horizontal gene transfer however despite processes signiﬁcant signal bringing various gene trees together shared species tree phylogenetic regularization implemented using approaches thus far. model-based approach phylogenetic regularization works model entire process gene species tree development resulting comprehensive joint likelihood function ensemble gene trees either conditioning species tree including part joint likelihood function consistency approaches matter continuing research another approach penalty function describing level divergence given gene tree pre-speciﬁed species tree approach typical regularization approaches common statistics machine learning. relatively simple penalization approach give performance competitive inference full probabilistic model substantially smaller computational cost phylogenetic inference. individual gene tree inference without additional information recently reached high-water mark demonstration accurate maximum likelihood inference done sequences length polynomial number taxa asymptotically tight given previous results however aware work giving proofs consistency penalty-based methods gene tree inference generally giving sequence length requirements gene tree inference presence species tree. addition work done showing polynomial sequence length requirements inference reduced inference problem purely combinatorial discretizing branch lengths rather treating branch lengths continuous parameters. paper propose regularization framework gene tree reconstruction prove consistency estimation method sequence length increases inﬁnity. furthermore provide corresponding sequence length requirements accurate estimation. convergence theory simultaneously continuous branch lengths tree topology. penalty terms distance guide tree often taken paper called species tree although make assumptions gene tree generated guide tree. fact guide tree arbitrarily chosen although course better gene tree reconstructions expected species trees closer correct gene tree. space represents discrete continuous aspects phylogenetic trees ensemble orthants glued together along edges discrete changes induced geodesic distance nearest-neighbor-interchanges subtrees separated zero length branches modeling horizontal transfer lineage sorting deep coalescence gene duplication/extinction distance computed polynomial time contrast distances tree spaces typically np-hard compute. space previously used extend classical statistical methods phylogenetic inference. example proposes algorithm identify principal paths space analogously standard principal component analysis. using framework able prove regularized estimator consistent derive global error various settings. results show polynomial sequence length requirement recover true topology best possible sample complexity tree reconstruction methods. moreover unlike previous algorithms perform poorly trees indistinguishable edges regularized estimator reconstruct edges length greater given threshold. also derive conﬁdence region estimator assess support tree splits data. paper organized follows. section introduces mathematical framework including space phylogenetic trees regularized maximum likelihood estimator tree reconstruction using geodesic distance. investigate properties geodesic distance space likelihood section section respectively. prove regularized maximum likelihood estimator consistent obtain convergence rate section section derives explicit bound convergence rate provides sample complexity method recover true topology jukes-cantor model. apply method reconstruct gene tree eight yeast species section finally section discusses results context related work. phylogenetic tree. throughout paper term phylogenetic tree refers tree leaves labeled taxon names. phylogeneticists often call trees unrooted highlight undirected nature edges. denote edges denote vertices. edge adjacent leaf called pendant edge edge called internal edge. edge associated negative number called branch length. deﬁne diameter maxuv∈v e∈path tree said resolved bifurcating branch lengths positive. speciﬁcally probability ending state time given site started state given xy-th entry matrix valued function matrix instantaneous rate matrix ctmc evolutionary model. branch lengths represent times mutation process operates. assume rate matrix reversible respect stationary distribution explore trees given number taxa describe trees near other class nearest neighbor interchange moves move deﬁned transformation collapses interior edge zero expands resulting degree vertex edge degree vertices trees said nni-adjacent exists single move transform simple visualization part space trees taxa provided figure space manifold equipped natural metric distance shortest path lying space points. points orthant distance space cubical complex orthant corresponds uniquely tree topology coordinates orthant parameterize branch lengths. adjacent orthants represent trees transformed single move. usual euclidean distance. points diﬀerent orthants joined sequence straight segments segment lying single orthant. measure length path adding lengths segments. distance points deﬁned minimum lengths segmented paths joining points. segmented path giving smallest distance points called geodesic. geodesic connecting points space unique computed polynomial time space clearly locally compact. paper beside geodesic distance itself also consider branch-score distance. distance proposed kuhner felsenstein shown amenta approximation distance. bipartition split ranges extensions internal nodes tree denotes assigned state node denotes tree edges probability transition matrix edge arbitrary internal node. also denote refer log-likelihood function given observed sequence. known continuous smooth orthant however general notion diﬀerentiability whole tree space. paper mostly focus case sequence length increases number taxa ﬁxed exception section quantify distance estimate true tree make following assumptions phylogenetic inference regularization. given species tree regularization parameter regularized estimator tree deﬁned minimizer bhv-penalized phylogenetic likelihood function following lemma describes directional derivative along geodesics well function useful later analyzing convergence properties regularization term assumption right hand side bounded above. thus sequence lies inside compact subsequence converges continuity likelihood function implies lemma convergence rate. regularized estimators consistent general well-known without priori information convergence arbitrarily slow uniform error bounds necessarily require regularity assumpsource conditions referred source conditions played central role analyses convergence regularized estimators various settings. recent publications starting hofmann variational inequalities become increasingly popular formulate source conditions especially case non-smooth operators section follow approach hofmann derive variational inequality that obtain global error estimate non-smooth regularization problem. next describe suﬃcient condition achieving minimum show holds everywhere simple phylogenetic models. deﬁne expected fisher information matrix compact neighborhood contained orthant implies column jacobian orthogonal thus case jacobian rank-deﬁcient. hence order verify criteria lemma need prove full rank. condition versection quantify constants deﬁned lemma derive explicit bound rate convergence regularized estimator jukes-cantor model using theorem that obtain sequence length bound recover true tree topology. provide details jukes-cantor model results generalized rstate symmetric models. take information-theoretic perspective working terms divergences rather equivalent formulation using diﬀerences expected per-site likelihood function order quantify constants need derive lower bounds divergence site expected site pattern frequencies trees. underlying ideas behind following somewhat technical proofs lengths become large corresponding point orange moves towards point compact induced independent samples stationary distribution states. reason without bound diameter trees easily construct trees arbitrarily close arbitrarily large rendering bound impossible. branch lengths branch length spectrum. sequence spectrum derived vector single-site patterns leaf nodes summing probabilities site patterns induce identical splits. mapping expected site pattern frequency sequence spectrum invertible transformation call proof. obvious topology following procedure delete edges touching obtain rooted subtrees select leaf closest root within subtree form quartet following notation erdos refer quartet representative quartet tree quartet tree formed four leaves. call associated quartet edges. moreover every edge belongs least lower bound inner edges constants theorem evaluated. hence construct conservative conﬁdence region regularized estimator. enables assess support sample complexity recovering true tree topology. explicit convergence bound derive sequence length requirement recovering true topology. theorem length observed sequence satisﬁes gronau point main drawback fast converging algorithms perform poorly trees indistinguishable/very short edges whereas single short edge aﬀect ability algorithm support long edges generating tree. algorithms share nothing nature failing reconstruct edge algorithms return tree others return tree contain many faulty edges gronau introduce concept adaptive fast converging algorithm refer reconstruct edges length greater given threshold sequence polynomial length construct ﬁrst algorithm property. section illustrate applicability method practical contexts using newly constructed estimator analyze widely distributed orthologous genes genomes eight yeast species. data originally studied rokas later incorporated package phangorn standard data phylogenetic analyses. previous results rokas indicate data sets obtained single gene concatenating small number genes signiﬁcant probability supporting conﬂicting topologies. contrast analyses entire data concatenated genes yield single fully resolved species tree high support. comparable results obtained concatenation minimum genes; substantially genes commonly used. possible explanation success using randomly chosen concatenated sequences recover species tree failure single-gene might suﬃcient information single genes maximum likelihood methods reliably recover correct tree. obtain species tree concatenate genes data infer species tree maximum likelihood using package phangorn explained rokas tree receives strong stable support many standard reconstruction methods. sequence data yklw gene example noting reconstructed maximum likelihood tree diﬀerent species tree gene. note analyses genes data also obtained similar manner incongruence tree species tree greater interest. compute distance using function dist.multiphylo distory package modify likelihood computation sub-routine phangorn package incorporate penalty term optimization procedure. estimator performs tuning parameter chosen datadependent stochastic proper procedure tune parameter. several possible techniques choosing penalty parameter; however recommended technique selecting regularization problems choose estimator minimizes cross-validation estimate risk example follow standard procedure select constant penalty. procedure choosing summarized follows. ﬁrst randomly divide sequence data three parts consider part validation data once remaining parts reconstruct tree various values here corresponds maximum likelihood estimator. process repeated times average log-likelihood site tree validation data used choose constant result summarized figure observe large values preferred small values indicates regularized method better performance compared standard approach. however overpenalizing distance species tree lead better estimates. using value maximizes average log-likelihood reconstruct regularized maximum likelihood tree visualized figure gene tree topology species tree gene tree reconstructed maximum likelihood method diﬀerent topology result illustrates might enough information sequence data reliably estimate correct tree additional knowledge species tree help produce better estimate note consistent ﬁndings rokas whereas adding paper propose tree reconstruction method regularization using geodesic distance analyze asymptotic properties. prove regularized maximum likelihood estimator consistent derive global error estimates estimator various settings. using estimates able provide upper bound sample complexity estimator recover true topology. steel sz´ekely provide bound sample complexity maximum likelihood estimator requires sequence length increase exponentially number species order reconstruct true topology. requirement atteson proves neighbor-joining method recover true topology neyman -state model binary trees transition probability edges bounded above. assumptions atteson erdos prove dyadic closure method needs grow polynomially respect number species order reconstruct true topology. work huson mossel daskalakis gronau extend theorem proves regularized maximum likelihood estimator recovers true topology poly best possible sample complexity methods. however unlike previous algorithms perform poorly trees indistinguishable/very short edges regularized estimator reconstruct edges length greater given threshold sequences polynomial length. moreover information model conﬁguration available derive conservative conﬁdence region estimator assess support tree splits data. also assume lower bound internal edges previous work done. uniform bounds convergence empirical likelihood provided lemma lemma independent interest. results allows consider space phylogenies continuous object instead discretizing branch lengths done previous analyses sample complexity tree reconstruction similar manner assume lower bound pendant edges known impose condition inner edges. minor relaxation allows smooth transition tree topologies enables uses analytical methods analyze phylogenetic algorithms. several venues improvement. first current setting still assume upper bound branch lengths known priori. condition relaxed extending lemma case unbounded edges highlighting fact regularization term already imposes implicit constraints branch lengths. secondly currently geodesic distance penalty regularization. geodesic distance natural distance space strongly convex distance cannot computed linear time. would like extend result distances tree space proposed amenta nonstrongly convex penalties. relating species tree/gene tree problem also worthwhile consider penalty metrics based explicit models discordance-generating events duplication-loss cost investigated acknowledgments. work partially support national institutes health national science foundation research frederick matsen supported part faculty scholar grant howard hughes medical institute simons foundation. references. akerborg sennblad arvestad lagergren simultaneous bayesian gene tree reconstruction reconciliation analysis. proceedings national academy sciences cuong dinh generalization robustness batched weighted average algorithm v-geometrically ergodic markov data. algorithmic learning theory springer. build trees random structures algorithms felsenstein dnaml phylip university washington seattle. felsenstein inferring phylogenies. sinauer associates sunderland. pearl species trees gene trees reconstructing bayesian posterior distributions species phylogeny using estimated gene tree distributions. systematic biology roch warnow robustness gene tree estimation error coalescent-based species tree methods. systematic biology rokas williams king carroll genome-scale approaches semple steel phylogenetics volume oxford university press. steel hendy penny reconstructing phylogenies nucleotide pattern probabilities survey results. discrete appl. math. steel sz´ekely inverting random functions explicit bounds discrete maximum likelihood estimation applications. siam journal discrete mathematics wang maximum likelihood estimation phylogenetic tree evolutionary parameters. thesis ohio state university. https//etd.ohiolink.edu/ etd.send_file?accession=osu&disposition=inline. warnow moret john absolute convergence true trees short sequences. proceedings twelfth annual acm-siam symposium discrete algorithms society industrial applied mathematics.", "year": "2016"}