{"title": "Testing for polytomies in phylogenetic species trees using quartet  frequencies", "tag": "q-bio", "abstract": " Phylogenetic species trees typically represent the speciation history as a bifurcating tree. Speciation events that simultaneously create more than two descendants, thereby creating polytomies in the phylogeny, are possible. Moreover, the inability to resolve relationships is often shown as a (soft) polytomy. Both types of polytomies have been traditionally studied in the context of gene tree reconstruction from sequence data. However, polytomies in the species tree cannot be detected or ruled out without considering gene tree discordance. In this paper, we describe a statistical test based on properties of the multi-species coalescent model to test the null hypothesis that a branch in an estimated species tree should be replaced by a polytomy. On both simulated and biological datasets, we show that the null hypothesis is rejected for all but the shortest branches, and in most cases, it is retained for true polytomies. The test, available as part of the ASTRAL package, can help systematists decide whether their datasets are sufficient to resolve specific relationships of interest. ", "text": "phylogenetic species trees typically represent speciation history bifurcating tree. speciation events simultaneously create descendants thereby creating polytomies phylogeny possible. moreover inability resolve relationships often shown polytomy. types polytomies traditionally studied context gene tree reconstruction sequence data. however polytomies species tree cannot detected ruled without considering gene tree discordance. paper describe statistical test based properties multi-species coalescent model test null hypothesis branch estimated species tree replaced polytomy. simulated biological datasets show null hypothesis rejected shortest branches cases retained true polytomies. test available part astral package help systematists decide whether datasets suﬃcient resolve speciﬁc relationships interest. phylogenies typically modeled bifurcating trees. even evolution fully vertical always bapteste nakhleh binary model precludes possibility several species evolving simultaneously progenitor species hoelzer meinick events could modeled multifurcating tree nodes called polytomies children. true polytomies suggested several parts tree-of-life arntzen polytomies also used analyst unsure relationships lack signal data resolve relationships townsend terms hard soft polytomies used distinguish cases maddison soft polytomy reserved case relationships unresolved estimated tree hard polytomy multifurcations true tree distinguishing types polytomies easy. moreover distinction soft hard polytomies blurred. diﬃculty resolving relationships increases branches become shorter. limit branch length zero equivalent hard polytomy diﬃcult impossible resolve. regardless abstract distinctions major diﬃculty faced systematists detect whether speciﬁc resolutions inferred trees suﬃciently supported data rule polytomy branch given species tree pose null hypothesis length branch zero thus branch removed create polytomy. using observed data reject null hypothesis fail reject replace branch polytomy. resulting polytomy best understood soft polytomy inability reject null hypothesis never accepting alternative hypothesis. inability reject caused real polytomy also simply lack power paper present test polytomy null hypothesis multi-locus datasets. idea testing polytomy null hypothesis rejecting using data applied single-locus data jackman walsh likelihood ratio tests zero-length branch developed implemented popular packages paup* swoﬀord treating polytomies null hypothesis pioneered walsh sought test polytomies also power analysis distinguish soft hard polytomies walsh appraising general framework braun kimball braun kimball showed power analysis sensitive model complexity perhaps relevant work anisimova presented approximate fast likelihood ratio test polytomy null hypothesis anisimova test like present looks branch surrounding branches ignoring rest tree. existing tests polytomy null also bayesian methods modeling polytomies lewis assume sequence data follow single tree. therefore methods test whether gene tree includes polytomy slowinski however species tree diﬀerent gene trees discordance several causes including gene duplication loss lateral gene transfer incomplete lineage sorting degnan rosenberg maddison arguably question interest whether species tree includes polytomies. moreover often interested know whether treat relationship species unresolved given amount data hand. questions cannot answered without considering gene tree discordance observation made previously others well slowinski chubb example chubb chubb analyzing avian dataset genes ﬁrst looked zero-length branches gene trees using sowh test swoﬀord found evidence gene trees include polytomies. also tested pairwise similarity gene trees greater random trees not. test gene tree congruence however respect particular model gene tree evolution. major cause gene tree discordance population-level process called incomplete lineage sorting modeled multi-species coalescent model rannala yang pamilo model tells likelihood causing discordance increases branches become shorter; therefore test polytomies also consider ils. model extensively used reconstructing species trees using many approaches including bayesian co-estimation gene trees species trees heled drummond site-based approaches chifman kubatko bryant popular approach summary method ﬁrst reconstruct gene trees individually summarize build species tree. many approaches model rely dividing dataset quartets species. quartetbased methods mirarab warnow zhang site-based method svdquartets chifman kubatko hybrid method called bucky-quartet larget rely fact quartet species three unrooted tree topologies possible species tree topology highest probability occurring unrooted gene trees model relying known distribution quartet frequencies model previously introduced computing support branch using measure called local posterior probability sayyari mirarab paper extend approach used compute localpp develop fast test null hypothesis branch length zero. null hypothesis expect three unrooted quartet topologies deﬁned around branch equal frequencies allman rigorously tested resulting approach present. similar ideas mentioned passing previously slowinski slowinski allman allman knowledge suggestions never implemented tested. statistical test present implemented inside astral package since version available online https//github.com/smirarab/astral. background unrooted tree deﬁned quartet species three topologies abcd acbd adbc. consider unrooted species tree abcd internal branch length separating species coalescent units number generations divided haploid population size degnan rosenberg multi species coalescent model gene tree matches species tree probability within locus free recombination across loci frequencies gene trees matching topologies follow multinomial distribution parameters number trials equal clearly species tree species results applicable true polytomy mathematically identical bifurcating node least adjacent branch length zero; zero-length branch contracted binary tree introduce polytomy true species tree quartet taxa figure statistical test polytomies. show example true species tree hard polytomy branches lengths expected quartet gene tree fractions three selected quartets based model ﬁrst quartet around true polytomy fraction expected three alternative topologies. estimated species tree estimated branch lengths hypothetical quartet tree frequencies counted hypothetical gene trees quartets show computation test statistic show falls distribution vertical blue line shows computed based given counts shaded areas inside distributions show area distribution corresponding p-value. null hypothesis rejected branch corresponding true polytomy short branch branches replaced soft polytomies. polytomy gene tree topologies equally likely thus true values would immediately know species tree polytomy. however never know true parameters; instead observations luckily multinomial distributions concentrate around mean. number genes increases probability quartet frequencies deviating mean rapidly drops; example according hoeﬀding’s inequality probability divergence drops exponentially e−\u0001n. concentration gives hope even though never know true values limited data design statistical tests null hypothesis. internal branch bifurcating species tree consider following. null hypothesis length internal branch zero; thus species tree polytomy. previously called locality assumption sayyari mirarab somewhat relaxed. bipartition true species tree either bipartition rearrangements present given species tree. read cressie hence assumption smaller exact calculation critical value required simply avoid applying test given chi-squared random variable test statistic simply pearson’s goodness-of-ﬁt statistical test. thus p-value area right test statistic probability density function chi-square distribution degrees freedom integral available various software packages including java package colt hoschek use. branch multiple quartets around branch. quartet species around branch chosen follows select arbitrary leaf subtree left child subtree right child subtree sister branch subtree sister branch parent distribution initially seem computing values requires computing values would require running time. would slow large datasets. computing median quartet score also requires however mean quartet score computed eﬃciently using algorithm previously described localpp sayyari mirarab avoid repeating algorithm note based postorder traversal gene tree computing gene trees missing data deﬁnition naturally discards missing quartets. similarly gene tree includes polytomy quartet counted towards neither three values discarded. then equation eﬀectively assigns quartet missing/unresolved gene tree quartet topology proportionally number present resolved quartets gene tree xijk/mj number quartets present resolved gene tree ﬁnal diﬃculty arises none quartets deﬁned around present present ones unresolved multifurcating input gene tree. happens discard gene tree branch reducing number genes thus eﬀective number genes change branch another based patterns gene tree taxon occupancy resolution. note assumption respect eﬀective number gene trees total number. number species maximum number genes number replicates average astral quartet score measure gene tree discordance; computed using true species tree true gene trees simulated estimated species tree estimated gene trees biological datasets average distance true estimated gene trees super gene trees resulting statistical binning mirarab multi-loci xenoturbella datasets rouse rouse cannon cannon transcriptomic plant dataset wickett since empirical data true branch length whether node polytomy known report relationship estimated branch lengths p-values. also randomly subsample gene trees test amount data impacts ability reject null; this focus selected branches diﬃcult resolve literature. simulated datasets starting ﬁxed species trees species species trees tree height generations population size thus tree height species tree polytomies three children addition short branch length coalescent units. tree polytomy children. simphy mallo used simulate replicates gene trees. generating true gene trees used indelible fletcher yang gtr+γ model sequence evolution simulate sequences gene trees. gtr+γ parameters drawn randomly dirichlet distributions used astral-ii paper used fasttree price estimate gene trees sequence data. datasets around gene tree error measured average distance true estimated gene trees datasets score arbitrary resolution true multifurcating species trees. therefore false positive errors false negative errors vary number genes randomly subsampling examine distribution p-values across replicates interesting branch using true estimated gene trees. -taxon simulated dataset previously generated species trees generated using yule process maximum tree height generations speciation rates population size ﬁxed datasets. thus three conditions replicates tree includes branches branch lengths wide range estimated gene trees dataset relatively high levels gene tree error replicates gene trees also randomly subsample dataset true species trees fully binary therefore null hypothesis never correct. failure reject null hypothesis false negative error. inability reject null hypothesis never taken accepting null hypothesis can. simply indicate available data insuﬃcient distinguish polytomy short branch. ideal test able reject null long branches. however short branches failing reject null would expected behavior. worth contemplating meaning super short branches. haploid population size figure datasets true species trees p-value distributions. show true multifurcating species trees coalescent units arbitrary resolution species tree used test polytomies branches represent arbitrary resolutions null hypothesis correct. branches selected examples null hypothesis incorrect. p-value distributions shown empirical cumulative distribution functions x-axis shows p-value selected branches true gene trees estimated gene trees varying numbers gene trees dashed vertical line shows p-value= boxes intersection vertical line line shows false positive rate. yellow boxes intersection vertical line line shows minus false negative rate. branch length corresponds generations. argue short branches practical purposes considered polytomy. thus false negative errors among super short branches could perhaps tolerated. tree zero-length branches therefore test ideally fail reject null hypothesis them. desired true gene trees used p-values uniformly distributed example null hypothesis rejected replicates gene trees. expected since null correct false positive rate increase increase number gene trees. switching estimated gene trees universally increases false positive errors example reject null hypothesis replicates using gene trees. severe case false positive error rates occurs branch replicates rejected gene trees. thus gene tree errors fact increase false positive error rates extent increase depends length branches surrounding tested branch. tree also examine binary positive-length branches short parent polytomy longer child polytomy. these desire null hypothesis rejected. branch easily rejected replicates using true gene trees. estimated gene trees given genes more null rejected almost cases rejected replicates genes. thus power reject moderate length branch null hypothesis depends number genes similar branches power higher true gene trees. false negative rates decrease number genes increases; using gene trees null rejected replicates true gene trees replicates estimated gene trees. overall false negative rate function number genes length branch gene tree error expected. tree shows broadly similar results diﬀerences noteworthy. zero-length branches desired test fails reject null. however false positives rates lower expected chance true gene trees used. example barely ever reject null hypothesis either three branches. lower expected false positive rates fact branch considered independently test much dependent even using estimated gene trees false positive rate remains low. estimated gene trees reject null replicates gene trees never reject null hypothesis otherwise false positive rates genes. false positive rates remain estimated gene trees rate seems slightly increase increased numbers gene trees. alongside zero-length branches also study branch adjacent polytomy. relatively long branch always reject null hypothesis true gene trees. estimated gene trees false negative rate gene trees gradually drops genes more. datasets false negative errors. branches according length categories compute percentage branches rejected according test false negative rate mostly depends three factors branch length number genes whether true estimated gene trees used. impact three factors consistent would expect reasonable statistical test. longest branches null hypothesis rejected almost always even genes highly error-prone estimated gene trees. using true gene trees instead estimated gene trees increases power universally. example true gene trees branches short almost always rejected. interestingly diﬀerence estimated true gene trees seems reduce number genes increase. datasets thousand genes higher resolution branches estimated length lows datasets except aves ranges branch length able reject null hypothesis branches others. cannot random noise estimated branch length shown branches length identical ni/n values. instead reason eﬀective number genes changes branch another gene trees include enough species deﬁne quartet around branches. eﬀective number genes also decline lack gene tree resolution figure polytomy test results diﬀerent biological datasets using astral species trees available gene trees. internal branch show astral estimated length scale polytomy test p-value points black. dataset number genes reported inside parentheses title. reject null hypothesis. repeat subsampling procedure times show average p-values across runs analyses focus selected branches empirical dataset. note downsampled datasets occasionally branches eﬀective number genes smaller violating assumption exclude branches. avian datasets branches species tree could rejected polytomy even super gene trees mostly belong called wall-of-death joseph buchanan hypothesized rapid radiation base neoaves jarvis swati patel braun subsampling super gene trees highlight seven selected branches shown figure interestingly subsample super gene trees several distinct patterns emerge various branches. branches easily rejected polytomy even small fraction data shorter branches rejecting polytomy requires hundreds super gene trees. others cannot reject polytomy full dataset pattern suggests super gene trees able reject polytomy. finally branches increasing number genes lead substantial decrease p-value suggesting increasing number input trees suﬃcient resolve them. insect dataset focus clades holometabola acercaria+hymenoptera hexapoda orthopteroidea pterygota psocodea+holometabola; classiﬁed fairly strong support literature sayyari indicating enjoy robust support literature analyses reject them. reduce number genes like avian dataset three patterns clades holometabola acercaria+hymenoptera orthopteroidea even fewer genes pterygota around genes. able reject null hypothesis psocodea+holometabola gene trees decreasing p-values suggest resolution could perhaps resolved several hundred loci. support figure polytomy test results avian dataset. astral species tree using binned gene trees. p-values greater zero reported branches branches shown red. change p-value respect number genes selected branches species tree used astral species trees varying number gene trees sampled uniformly repeated times. show average p-values versus number gene trees solid horizontal line shows p-value= hexapoda never decreases genes suggesting relationship insects close relatives remain unresolved simply increase number genes. deep undersampled node p-values fail reduce either true polytomy gene trees estimated high error. remaining datasets important branches studied decreasing p-values number gene trees increase plant dataset around genes seems suﬃcient branches interest including monophyly bryophytes resolution amborella sister remaining ﬂowering plants. branch puts zygnematales sister land plants rejected polytomy genes. however correct relationship chara coleochaetales remains hard resolve. even full dataset polytomy rejected though decreasing p-values point possibility relationship would resolved figure polytomy test results selected branches insects plants xenoturbella datasets. used astral species trees varying number gene trees sampled uniformly random repeated times. show average p-values versus number gene trees solid horizontal line shows p-value= cases eﬀective excluded; plants xenoturbella omit replicates xenoturbella datasets three focal branches surrounding position xenacoelomorpha. branch labeled bilateria xenacoelomorpha nephrozoa daughters branches figure impact number genes p-value p-value computed diﬀerent number gene trees four diﬀerent short branch lengths observed frequencies exactly match expected frequencies given branch length. dashed horizontal line shows p-value= intersects required number genes reject null hypothesis p-value various branch lengths assuming observed frequencies match expected frequencies. note x-axis scales papers resolved gene trees however pinpointing position xenacoelomorpha also depends branch labeled nephrozoa puts xenacoelomorpha sister clade containing protostomia deuterostomia. null hypothesis branch polytomy rejected either dataset pattern decreasing p-values loci discerned. thus datasets best understood leaving relationships protostomia xenacoelomorpha rest deuterostomia uncertain evidence xenacoelomorpha base nephrozoa. remarkably patterns diﬃculty resolving branches similar across independent datasets diﬀerent taxon gene selection. introduced test rejecting null hypothesis branch species tree replaced polytomy. unlike existing tests test considers gene tree discordance modeled model. several simulations showed test behaves expected. null hypothesis often retained true polytomies often rejected binary nodes unless true branch lengths short. power reject null hypothesis binary relationships increases longer branches gene trees reduced gene tree estimation error. gene tree error also cases increase false positive rate. overall even genes rare reject null branches shorter branch length corresponds generations simulations. argue failing resolve branch corresponds short evolutionary times perhaps tolerated. mathematically given suﬃciently large unbiased sample gene trees even inﬁnitesimally short branches distinguished polytomy. practice however extremely short branches treated suspicion input gene trees invariably perfect samples distribution. biological analyses subsampling genes tracking trajectories p-value helpful predicting number required genes resolve branch. approach presented used biological data well. however caution predictions interpreted limitations proposed test mind. many factors gene tree error sources discordance contribute deviations deviations render predictions inaccurate. predictions made natural question arises number genes impact power? easily compute required number genes rejecting null hypothesis assuming expected frequencies match observed frequencies example branch length need genes reject polytomy branch length need genes quartet species tree arbitrarily high probability number genes grows shekhar broadly number genes required correct species tree estimation using astral proven grow proportionally shekhar similarly given branch length numerically compute minimum number required genes obtain given p-value assuming observed frequencies match expectations observe required number genes grows linearly fact figure gives estimate level resolution dataset provide. example genes reject null branches quadruple number genes resolution increased two-folds branches note gene tree error multiple quartets available around branch fraction supporting topology contribution gene thus whether quartet hundred quartets count gene tree observation multinomial distribution. conservative approach deal unknown dependencies quartets. liberal approach would consider quartets fully independent increasing degrees freedom chi-square distribution instead test would powerful would based invalid independence assumptions raise false positive rates. ideal test would need model intricate dependence structure quartets task diﬃcult erdos finally note test polytomy relates branch lengths coalescent units. branch length zero coalescent units length zero unit time keep population size ﬁxed. mathematically population size grow inﬁnitely. mathematical model population size grows asymptotically faster time branches converge zero length even though branch length time goes inﬁnity. mathematical construct biological meaning. nevertheless helps remind short branch coalescent unit short time short population size large. branches rejected polytomy test p-value proposed polytomy test close connection localpp branch support. measures assume model function quartet scores quartet score species tree topology number genes increases localpp p-value increase localpp branch close polytomy null hypothesis always rejected. however measures identical. interestingly conditions localpp higher polytomy null hypothesis rejected level frequencies follow important remember test relies properties model. observed quartet frequencies diverge expectations model systematically behavior proposed test change. example substantially larger rejecting null hypothesis becomes easier come surprise type deviation model makes quartet frequencies even diverged expected model. real data several factors contribute deviations msc. example incorrect homology detection real datasets possible possible homology issues avian dataset) lead deviations. another source deviation gene impact gene tree distributions. sols-lemus identiﬁed anomaly zone conditions species tree topology lower quartet frequencies compared alternative topologies sol´ıs-lemus since localpp measure model gene conditions misled giving posterior probability species tree topology presence gene example branches length shorter localpp zero. presence gene also impacts test polytomy. species tree deﬁned sols-lemus internal branches short enough exist conditions gene combined result quartet frequencies equal three alternatives. clear test able distinguish scenario real polytomy tempted argue perhaps high levels gene sister branches favor outcome null rejected. however argument fails explain observation value null hypothesis retained speciﬁc settings surrounding internal branch lengths thus simply caution reader interpretation gene sources bias suspected. various numbers gene trees show localpp pvalue polytomy test quartet frequencies follow expectations e−x. quartet frequencies diverge expectations e−x. quartet frequencies larger follow msc+gene model analyzed sols-lemus sol´ıs-lemus species tree hybridization base inheritance probabilities following sols-lemus especially transcriptomic datasets lots missing data. exception avian dataset super gene trees always include taxa. second factor reduce eﬀective multifurcations input gene trees. quartets around branch unresolved input gene tree gene tree count towards eﬀective biological datasets binary gene trees. however recently shown zhang removing branches support help addressing gene tree error. demonstrate this revisit avian dataset. purpose using super gene trees instead normal gene trees reduce gene tree estimation error. alternatively simply remove branches support certain threshold gene trees resulting tree input astral zhang procedure support threshold generated astral tree based unbinned gene trees avian dataset jarvis mirarab resulting tree largely congruent astral tree super gene trees reference phylogenies form original publication jarvis tested eﬀective p-values change result contracting support branches. simply contracting branches support reduces median eﬀective contracting branches support gradually reduces eﬀective median p-values tend decrease increase threshold contraction several branches fail reject null hypothesis regardless threshold chosen. others reject null hypothesis lower levels contraction higher levels showing reduced eﬀective reduce power. branch interestingly null rejected contract support contract rejected otherwise. pattern subtle explanation. gene trees include support branches unable reject null hypothesis perhaps gene tree error creates uniform distribution quartets around branch. remove support branches gene trees start quartet frequencies figure eﬀective results unbinned avian dataset. distributions eﬀective across diﬀerent branches empirical dataset show boxplots well mean standard error total number genes shown horizontal line. astral-iii species tree estimated based unbinned gene trees branches support contracted. branch show eight p-values computed respectively respect gene trees branches support contracted. branches values p-values p-values red. also show multifurcating species tree branches p-values< according threshold contracted similar show distributions eﬀective across branches avian species tree original unbinned trees gene tree branches support contracted favor astral resolution perhaps noise removed actual signal discerned. finally aggressive ﬁltering gene tree branches eﬀective becomes test simply power reject null. interesting patterns suggest dealing gene tree error light dependence test properties oﬀer alternative description test. safe interpret results test regardless causes gene tree discordance formulate null hypothesis follows. judicious application test preselect branches polytomy null hypothesis tested examines p-value branches. many branches tested arguably needs correct multiple hypothesis testing reducing power test. corrections bonferroni benjamini hochberg employed however note even though formulate polytomy null hypothesis reality expect cases branch positive branch length. thus expect reject null often contrast usual applications frequentist test. analyst specify advance branches polytomy null hypothesis reasonable. adds subjectivity problems always encountered frequentist tests exception. test also suﬀers various criticisms leveled frequentist hypothesis testing anderson interpretation avoid common pitfalls goodman presented statistical test implemented astral null hypothesis branch species tree polytomy given gene trees. test relies properties multi-species coalescent model performed well simulated real data. expected power function branch length number genes gene tree estimation error. work supported national science foundation grant e.s. s.m. computations performed diego supercomputer center xsede allocations supported grant aci.", "year": "2017"}