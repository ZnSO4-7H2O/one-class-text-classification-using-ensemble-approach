{"title": "Phylogenetic diversity and biodiversity indices on phylogenetic networks", "tag": "q-bio", "abstract": " In biodiversity conservation it is often necessary to prioritize the species to conserve. Existing approaches to prioritization, e.g. the Fair Proportion Index and the Shapley Value, are based on phylogenetic trees and rank species according to their contribution to overall phylogenetic diversity. However, in many cases evolution is not treelike and thus, phylogenetic networks have come to the fore as a generalization of phylogenetic trees, allowing for the representation of non-treelike evolutionary events, such as horizontal gene transfer or hybridization. Here, we extend the concepts of phylogenetic diversity and phylogenetic diversity indices from phylogenetic trees to phylogenetic networks. On the one hand, we consider the treelike content of a phylogenetic network, e.g. the (multi)set of phylogenetic trees displayed by a network and the LSA tree associated with it. On the other hand, we derive the phylogenetic diversity of subsets of taxa and biodiversity indices directly from the internal structure of the network. Furthermore, we introduce our software package NetDiversity, which was implemented in Perl and allows for the calculation of all generalized measures of phylogenetic diversity and generalized phylogenetic diversity indices established in this note that are independent of inheritance probabilities. We apply our methods to a phylogentic network representing the evolutionary relationships among swordtails and platyfishes (Xiphophorus: Poeciliidae), a group of species characterized by widespread hybridization. ", "text": "biodiversity conservation often necessary prioritize species conserve. existing approaches prioritization e.g. fair proportion index shapley value based phylogenetic trees rank species according contribution overall phylogenetic diversity. however many cases evolution treelike thus phylogenetic networks developed generalization phylogenetic trees allowing representation non-treelike evolutionary events hybridization. here extend concepts phylogenetic diversity phylogenetic diversity indices phylogenetic trees phylogenetic networks. hand consider treelike content phylogenetic network e.g. phylogenetic trees displayed network so-called lowest stable ancestor tree associated hand derive phylogenetic diversity subsets taxa biodiversity indices directly internal structure network. consider approaches independent so-called inheritance probabilities well approaches explicitly incorporate probabilities. furthermore introduce software package netdiversity implemented perl allows calculation generalized measures phylogenetic diversity generalized phylogenetic diversity indices established note independent inheritance probabilities. apply methods phylogenetic network representing evolutionary relationships among swordtails platyﬁshes group species characterized widespread hybridization. facing major extinction crisis inevitable loss biodiversity time limited ﬁnancial means biological conservation prioritize species conserve. matter so-called phylogenetic diversity introduced measure biodiversity based evolutionary history species. serves basis biodiversity indices used taxon prioritization e.g. fair proportion index shapley value hartmann fuchs wicke fischer phylogenetic diversity well fair proportion index shapley value based phylogenetic trees thus assume evolutionary history species treelike. however several forms non-treelike evolution hybridization aﬀecting variety species. therefore phylogenetic reticulation networks become important concept evolutionary biology allowing representation non-treelike evolution. here combining approaches i.e. extending concept phylogenetic diversity measures phylogenetic trees phylogenetic networks. phylogenetic diversity shapley value considered so-called split networks used represent conﬂict data volkmann attempts made towards generalization phylogenetic diversity measures reticulation networks. note ﬁrst recapitulate phylogenetic diversity fair proportion index shapley value phylogenetic trees focus generalizing concepts phylogenetic networks. introduce variety deﬁnitions generalized phylogenetic diversity following three main principles calculation spanning arborescences subgraphs network consideration phylogenetic trees displayed network construction so-called lowest stable ancestor tree associated network. turn attention fair proportion index shapley value suggest diﬀerent ways using taxon prioritization tools context phylogenetic networks. generalized measures phylogenetic diversity generalized biodiversity indices develop approaches independent socalled inheritance probabilities well approaches explicitly incorporate probabilities. case former approaches implemented software tool netdiversity made publicly available www.mareikeﬁscher.de/software/netdiversity.zip. moreover test netdiversity recently published phylogenetic network swordtails platyﬁshes whose evolution characterized widespread hybridization ﬁnite species rooted phylogenetic x-tree rooted tree root leaves bijectively labeled called binary internal nodes degree root degree throughout paper refer trees always mean rooted phylogenetic trees. furthermore assume edges tree edge lengths greater zero assigned them denote length edge note edges rooted phylogenetic tree directed away root thus formally treeshape so-called arborescence. deﬁnition directed graph speciﬁed root node arborescence exactly directed path nodes {ρ}. rooted binary phylogenetic network connected rooted acyclic digraph that nodes indegree outdegree called reticulation nodes nodes called tree nodes. furthermore tree nodes outdegree referred leaves. edges directed reticulation node called reticulation edges edges directed tree node called tree edges. refer phylogenetic networks always mean rooted binary phylogenetic networks. moreover refer size tree network mean number taxa i.e. number leaves tree network consideration. additionally assume tree edges phylogenetic network edge lengths greater zero assigned denote length tree edge w.l.o.g. deﬁne edge lengths reticulation edges zero. however assign so-called inheritance probabilities reticulation edges network reﬂecting probability hybrid species inherits genetic material parents. formally phylogenetic network reticulation node i.e. hybrid species parents edge analogously edge denote probability inherits genetic material denote probability genetic material inherited call inheritance probabilities associate edge inheritance phylogenetic network phylogenetic x-tree. embedded displays obtained deleting reticulation edges reticulation node suppressing resulting nodes indegree outdegree denote rooted phylogenetic x-trees displayed note receive edge weights embedded tree follows formerly distinct edges melted edge suppressing nodes indegree outdegree edge lengths edges keep original weights. moreover note reticulation nodes rooted binary phylogenetic network taxon phylogenetic x-trees displayed however bound sharp following also need probability embedded tree calculated follows here scaling factor ensures probabilities embedded trees one. example consider phylogenetic network embedded trees punscaled analogously punscaled thus retrieve following probabilities embedded trees analogously figure rooted phylogenetic network edge lengths associated tree edges inheritance probabilities associated reticulation edges displays phylogenetic x-trees deleting exactly reticulation edge reticulation nodes also obtain tree internal node become leaf. however regard phylogenetic x-tree displayed belong taxon thus case bold edges represent edges contributing phylogenetic diversity calculated example phylogenetic network node root call node lies directed paths root stable ancestor so-called lowest stable ancestor deﬁned last node contained paths root excluding based terminology deﬁne lowest stable ancestor tree tree associated network. rooted phylogenetic network tree tlsa associated rooted phylogenetic x-tree computed follows reticulation node remove edges directed edge lowest stable ancestor repeatedly remove unlabeled leaves nodes inoutdegree removal possible. note tree associated binary rooted phylogenetic network necessarily binary phylogenetic tree note every node phylogenetic network unique lowest stable ancestor lsa. thus tree associated given network regardless order reticulation nodes processed moreover note concept lowest stable ancestor long used theory graphs lowest stable ancestor node called immediate dominator tree called dominator tree graph order tree subsequent phylogenetic diversity calculations infer edge lengths edges tree. tree edges also present tlsa original edge weights. removal nodes in-and outdegree formerly distinct tree edges melted edge tlsa original edge lengths. newly established edges reticulation node lowest stable ancestor suggest length edges average path length path respectively i.e. remark. note instead using average path length reticulation node lowest stable ancestor order infer weight edge could also length shortest path length likely path weighted average path length path weighted according probability figure rooted binary phylogenetic network associated tree tlsa. note reticulation edges weight zero. node lowest stable ancestor reticulation node consider paths calculating length edge length length length thus taking average length analogously node lowest stable ancestor consider paths length length thus length however subsequently edges merged edge length analogously edges replaced edge length ﬁnally yield tree associated note tlsa binary root degree section brieﬂy recapitulate concept phylogenetic diversity phylogenetic diversity indices particular shapley value fair proportion index phylogenetic trees. deﬁnition rooted phylogenetic tree leaf subset taxa phylogenetic diversity calculated summing edge lengths phylogenetic subtree containing root example consider phylogenetic tree depicted figure consider subset taxa. phylogenetic diversity calculates based phylogenetic diversity deﬁne shapley value phylogenetic trees. shapley value phylogenetic trees used diﬀerent versions literature so-called original shapley value throughout paper. deﬁnition rooted phylogenetic tree leaf denote phylogenetic diversity shapley value taxon deﬁned shapley value reﬂects average contribution species overall phylogenetic diversity thus sensible prioritization criterion calculation complicated. therefore another index so-called fair proportion index introduced. deﬁnition rooted phylogenetic tree leaf fair proportion index taxon deﬁned fair proportion index easily calculated lacks biological motivation. however justiﬁed equivalence original shapley value. theorem rooted phylogenetic tree leaf example consider phylogenetic tree depicted figure here note equals total edge lengths also note fair proportion indices equal shapley values position present approaches towards generalization phylogenetic diversity trees networks. introduce three approaches based calculation spanning arborescences subgraphs network based trees displayed network based tree associated network. recall phylogenetic diversity subset taxa phylogenetic x-tree calculated branch lengths subtree containing root. phylogenetic network subset taxa subtree precise arborescence containing root. thus suggest consider arborescence minimum cost i.e. arborescence whose weight larger weight arborescence spanning root introduce so-called phylogenetic diversity. deﬁnition rooted phylogenetic network taxon subset taxa deﬁne phylogenetic diversity branch lengths minimum cost arborescence containing root. note determining minimum cost arborescence containing subset taxa root formally instance so-called directed steiner tree problem steiner arborescence problem which general -hard problem order explicitly incorporate inheritance probabilities network calculation phylogenetic diversity several alterations deﬁnition possible. instead considering minimum cost arborescence spanning taxa root could consider arborescences spanning root weight according probability likely arborescence. denote values dinh i.e. figure rooted binary phylogenetic network arborescences containing root. bold edges depict subgraph n{ab} containing note reticulation edges weight zero. example consider figure depicts rooted phylogenetic network arborescences containing root. weight weight thus minimum cost arborescence containing root retrieve phylogenetic diversity however probability probability i.e. likely arborescence spanning root. thus weight moreover dinh instead using spanning arborescences deﬁne phylogenetic diversity subset taxa phylogenetic network also consider subgraph containing root deﬁne phylogenetic diversity branch lengths deﬁnition rooted phylogenetic network taxon subset taxa consider subgraph containing root taxa deﬁne phylogenetic subnet diversity branch lengths example consider rooted phylogenetic network depicted figure subgraph length thus nucleotide level rather genome level still treelike single nucleotide always traced back parent. therefore suggest consider trees embedded network alternative approach towards generalization phylogenetic diversity trees networks. deﬁnition rooted phylogenetic network taxon rooted phylogenetic x-trees displayed denote embedded phylogenetic diversity subset taxa probability likely embedded tree. argmax unique arbitrarily choose embedded trees maximum probability. note replaced functions phylogenetic diversity above. also note consider phylogenetic x-trees elements discard trees occur decomposing network trees example consider rooted phylogenetic network embedded trees depicted figure moreover thus retrieve diﬀerent values embedded phylogenetic diversity dmin dmax comparing phylogenetic diversity minimum embedded subset taxa phylogenetic diversity dmin similar principle. deﬁned weight minimum cost arborescence spanning root network dmin deﬁned weight minimum spanning tree/minimum cost arborescence spanning root phylogenetic x-trees displayed thus measures related general identical. consider example rooted phylogenetic network depicted figure then dmin however following relationship dmin proposition binary rooted phylogenetic network taxon reticulation nodes phylogenetic x-trees displayed remark. note example holds so-called normal networks proof proposition binary rooted phylogenetic network root taxon reticulation nodes. embedded trees reticulation node reticulation nodes every phylogenetic diversity subset taxa deﬁned branch lengths smallest arborescence spanning taxa root. clearly weight arborescence cannot smaller weight minimum cost arborescence spanning root subgraphs thus smallest arborescence spanning root displayed tree also found particular suppose want show suﬃces dmin show dmin minimum cost arborescence spanning root deﬁnition arborescence exactly directed path root vertex implies contains reticulation edge reticulation node never reticulation edges directed suppress nodes indegree outdegree weights edges merged edge retrieve directed acyclic graph contains taxa whose weight equals weight construction however must sub-arborescence embedded tree embedded trees obtained deleting reticulation edges reticulation node suppressing resulting nodes indegree outdegree every combination results phylogenetic x-tree thus deﬁnition trees weight equals dtas embedded subset taxa ∅inh comparing dinh values again follow related principle. dinh considers ∅inh spanning arborescences network considers spanning arborescences trees displayed values coincide however general dinh particular cannot guarantee dinh ∅inh ∅inh proposition consider example phylogenetic network tree seen summarize treelike content phylogenetic network embedded trees agree without explicitly consider trees. deﬁnition rooted phylogenetic network taxon subset taxa. deﬁne associated phylogenetic diversity dlsa dtlsa phylogenetic diversity tree tlsa associated example consider rooted phylogenetic network associated tree tlsa depicted figure exemplarily retrieve associated phylogenetic diversity dlsa introduced variety ways deﬁne phylogenetic diversity subset taxa network. however information phylogenetic diversity subset taxa useful taxon prioritization decisions. thus turn attention towards generalization phylogenetic diversity indices trees networks. proposing diﬀerent ways generalizing concept phylogenetic diversity trees networks turn attention fair proportion index shapley value prioritization indices used biodiversity conservation. even though fair proportion index shapley value equivalent rooted phylogenetic trees diﬀer signiﬁcantly deﬁnition computation. fair proportion index directly based given rooted phylogenetic tree deﬁnition shapley value based phylogenetic diversity subsets taxa thus indirectly given phylogenetic tree precise calculation shapley value involves steps calculate shapley value based measure reduce network treelike content calculate shapley value based trees. will however start reduction network treelike content also used generalize fair proportion index networks. embedded shapley value fair proportion index similar embedded phylogenetic diversity phylogenetic x-trees displayed network order deﬁne so-called embedded shapley value embedded fair proportion index. deﬁnition rooted phylogenetic network taxon rooted phylogenetic x-trees displayed denote embedded shapley value embedded fair proportion index taxon stands probability likely embedded tree. argmax unique arbitrarily choose embedded trees maximum probability. note shapley value fair proportion index equivalent rooted phylogenetic trees embedded values coincide well i.e. example consider rooted phylogenetic network embedded trees depicted figure taxon moreover thus retrieve diﬀerent versions embedded fair proportion index ditlsa respective diversity index tree tlsa associated obviously values coincide rooted phylogenetic trees thus coincide particular tree. example consider rooted phylogenetic network associated tree tlsa depicted figure taxon associated fair proportion index deﬁnition shapley value indirectly based given phylogenetic x-tree requires measure phylogenetic diversity subsets taxa introduce alternative calculating shapley value taxa phylogenetic network suggest calculate shapley value according deﬁnition measure generalized phylogenetic diversity input. call resulting value generalized original shapley value. deﬁnition rooted phylogenetic network taxon rooted phylogenetic x-trees displayed taxon denote generalized measure phylogenetic diversity subset taxa i.e. dinh dmin dlsa}. dmax deﬁne generalized original shapley value example consider rooted phylogenetic network depicted figure calculate generalized original shapley value taxon choose phylogenetic diversity input. consider following subsets {a}{a b}{a c}{a c}{a d}{a thus compare associated shapley value generalized shapley value dlsa uses associated phylogenetic diversity input calculations based upon tree associated network thus dlsa. turning software tool real data introduce last index concept networks namely fair proportion index. previous sections always reduced network treelike content order calculate fair proportion index taxa directly adapt deﬁnition fair proportion index networks considering paths root taxon. without loss generality assume network come inheritance probabilities idea deﬁne fair proportion index taxon considering paths root calculating value path individually. similar original fair proportion index calculate value weighted branch lengths branch length weighted according number descendants. however additionally weight possible descendants edge probability actually descendant edge. weighted mean values paths path weighted according probability call resulting value fair proportion index. deﬁnition rooted phylogenetic network taxon denote length edge denote leaves descendants leaf descendent calculate order calculate diﬀerent generalized measures phylogenetic diversity generalized diversity indices introduced above developed software tool called netdiversity available www.mareikeﬁscher.de/software/netdiversity.zip. tool written programming language perl uses modules bioperl particular biophylonetwork package program takes networks represented so-called extended newick format input. depending options chosen program either outputs measure generalized phylogenetic diversity subsets taxa generalized diversity index taxa network. however currently tool calculate measures independent inheritance probabilities. apply netdiversity phylogenetic network swordtails platyﬁshes published hybridization networks even though hybridization suspected occurred variety organisms well. xiphophorus hybridization network inferred solís-lemus contains species reticulation nodes exemplarily netdiversity calculate diﬀerent versions fair proportion index xiphophorus species. note possible subsets taxa network species refrain calculating measure generalized phylogenetic diversity subsets xiphophorus generalized shapley value here. table summarizes results. xiphophorus network rankings obtained embedded fair proportion indices associated fair proportion index similar. however striking diﬀerences concerning species xiphidium nezahuacoyotl. xiphidium ranked placed among species indices. diﬀerence indices concerns nezahuacoyotl hybrid species. nezahuacoyotl ranked ﬁrst ranked indices. thus case xiphophorus network diﬀerent versions generalized fair proportion index yield similar results striking differences. particular question whether hybrid species high importance overall biodiversity remains considered biological perspective. paper introduced diﬀerent approaches towards generalization phylogenetic diversity phylogenetic diversity indices trees networks. approaches provide extension existing prioritization tools conservation biology allow consideration phylogenetic networks prioritization decisions. importance evolutionary history species known non-treelike thus cannot represented phylogenetic tree. here mainly focused hybridization networks mathematically approaches also applicable networks representing horizontal gene transfer. applied methods phylogenetic network representing evolutionary relationships among swordtails platyﬁshes whose evolution characterized widespread hybridization. seen diﬀerent biodiversity indices induce striking diﬀerences ranking order taxa conservation. therefore remark research concerning biological plausibility approaches necessary practice. achieved phylogenetic networks diﬀerent groups organisms become available analyzed biological mathematical perspective. decisions biodiversity conservation taxon prioritization gordoni meyeri continens pygmaeus couchianus multilineatus nigrensis birchmanni malinche monticolus clemenciae alvarezi mayae hellerii nezahuacoyotl montezumae signum cortezi variatus xiphidium evelynae milleri andersi maculatus thank volkmar liebscher helpful discussions research project anonymous reviewers helpful comments earlier version manuscript. ﬁrst author also thanks ernst-moritz-arndt-university greifswald landesgraduiertenförderung studentship work conducted.", "year": "2017"}