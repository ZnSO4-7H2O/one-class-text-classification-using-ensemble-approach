{"title": "Automated deconvolution of structured mixtures from bulk tumor genomic  data", "tag": "q-bio", "abstract": " Motivation: As cancer researchers have come to appreciate the importance of intratumor heterogeneity, much attention has focused on the challenges of accurately profiling heterogeneity in individual patients. Experimental technologies for directly profiling genomes of single cells are rapidly improving, but they are still impractical for large-scale sampling. Bulk genomic assays remain the standard for population-scale studies, but conflate the influences of mixtures of genetically distinct tumor, stromal, and infiltrating immune cells. Many computational approaches have been developed to deconvolute these mixed samples and reconstruct the genomics of genetically homogeneous clonal subpopulations. All such methods, however, are limited to reconstructing only coarse approximations to a few major subpopulations. In prior work, we showed that one can improve deconvolution of genomic data by leveraging substructure in cellular mixtures through a strategy called simplicial complex inference. This strategy, however, is also limited by the difficulty of inferring mixture structure from sparse, noisy assays. Results: We improve on past work by introducing enhancements to automate learning of substructured genomic mixtures, with specific emphasis on genome-wide copy number variation (CNV) data. We introduce methods for dimensionality estimation to better decompose mixture model substructure; fuzzy clustering to better identify substructure in sparse, noisy data; and automated model inference methods for other key model parameters. We show that these improvements lead to more accurate inference of cell populations and mixture proportions in simulated scenarios. We further demonstrate their effectiveness in identifying mixture substructure in real tumor CNV data. Availability: Source code is available at http://www.cs.cmu.edu/~russells/software/WSCUnmix.zip ", "text": "computational biology dept. carnegie mellon university pittsburgh statistics dept. carnegie mellon university pittsburgh dept. biological sciences carnegie mellon university pittsburgh correspondence addressed russellsandrew.cmu.edu motivation cancer researchers come appreciate importance intratumor heterogeneity much attention focused challenges accurately proﬁling heterogeneity individual patients. experimental technologies directly proﬁling genomes single cells rapidly improving still impractical large-scale sampling. bulk genomic assays remain standard population-scale studies conﬂate inﬂuences mixtures genetically distinct tumor stromal inﬁltrating immune cells. many computational approaches developed deconvolute mixed samples reconstruct genomics genetically homogeneous clonal subpopulations. methods however limited reconstructing coarse approximations major subpopulations. prior work showed improve deconvolution genomic data leveraging substructure cellular mixtures strategy called simplicial complex inference. strategy however also limited diﬃculty inferring mixture structure sparse noisy assays. results improve past work introducing enhancements automate learning substructured genomic mixtures speciﬁc emphasis genome-wide copy number variation data. introduce methods dimensionality estimation better decompose mixture model substructure; fuzzy clustering better identify substructure sparse noisy data; automated model inference methods model parameters. show improvements lead accurate inference cell populations mixture proportions simulated scenarios. demonstrate eﬀectiveness identifying mixture substructure real tumor data. availability source code available http//www.cs.cmu.edu/~ russells/software/wscunmix.zip tumor heterogeneity recognized pervasive feature cancer biology implications every step cancer development progression metastasis mortality. solid tumors exhibit form hypermutability phenotype leading extensive genomic variability tumor cell populations expand studies single cells ﬂuorescence situ hybridization long revealed extensive cell-to-cell variability single tumors observation since shown single-cell sequencing technologies occur greater scale variety mechanisms previously suspected furthermore studies clonal populations across progression stages revealed often rare cell populations within heterogeneity underlie progression rather dominant clones indeed heterogeneity shown predictive progression patient outcomes observations suggested importance ways accurately proﬁling tumor heterogeneity basic cancer research translational applications. experimental technologies proﬁling tumor heterogeneity constantly improving impractical systematically proﬁling variability genome-wide large patient populations. fish related imaging technologies practical proﬁling many thousands cells limited sets preselected markers single-cell sequencing derive genome-wide proﬁles hundreds cells single tumors cost-prohibitive tiny patient populations. furthermore technical challenges make diﬃcult develop accurate proﬁles structural variations copy number variations major drivers progression solid tumors bulk regional sequencing proﬁle small numbers tumor sites patient large patient populations provides coarse picture heterogeneity within site. technical challenges assessing heterogeneity experimentally enormous interest computational deconvolution methods computationally separating cell populations mixed samples. originally proposed correcting stromal contamination genomic measurements methods later extended reconstructing clonal substructure subclonal evolution among tumor cell populations. past years seen explosion methods deconvolution numerous forms genomic data sources methods however limited accuracy capable resolving best major clonal subpopulations small fraction heterogeneity revealed single-cell experimental studies. limits result inherent diﬃculty separating high-dimensional mixtures especially sparse noisy data. heterogeneity know present resolve deconvolution enormous suggesting need methodological advances. prior work proposed could better resolve genomic mixtures taking account fact would expect mixtures exhibit extensive substructure individual tumor tumor site likely uniform mixture cell types observed across tumors study. rather expect distinct samples group subsets share fewer cells depending closely related another. tumors expected share contamination normal cells tumors common subtypes expected share cell states characteristic subtypes. likewise tumor regions might expected share similarity nearby distant patient. kind substructure principle exploitable improve ability reconstruct accurate mixed membership models. speciﬁcally deconstructing tumor samples subgroups similar mixtures decompose problem reconstructing high-dimensional mixture easier problem reconstructing several overlapping lower-dimensional mixtures. previously showed implement approach adapting earlier deconvolution strategy uniform mixtures based identifying geometric structures tumor point clouds genomic space subdivide point clouds low-dimensional subsimplices collectively constitute higher-level object known simplicial complex. prior work used pipeline several sequential steps transform genomic point cloud structured mixed membership model figure overview full analysis pipeline input samples represented collections copy number call ﬁles converted matrix format. matrix inputs passed simplicial complex inference code infers mixed membership model data associated model likelihood. inference computed using principal components analysis following pre-clustering unmixing substructure using k-nearest-neighbor reconciliation model. inferred mixture components used downstream functional annotation identify dysregulated pathways term associations. resulting pipeline established proof-of-concept approach also introduced several diﬃcult computational challenges. example required accurately pre-specifying number partitions dimensionality partitions diﬃcult inference problems require signiﬁcant knowledge system study. present work improve proof-of-concept method tackling several subproblems path completely automating inference substructured genomic mixtures populations tumor samples. eliminated several nuisance parameters prior work notably introducing methods automated dimensionality estimation subsimplicies automated maximum likelihood inference previously user-deﬁned parameters. introduced fuzzy clustering approach customized simplicial complex decomposition better handle uncertainty substructure decomposition. verify eﬀectiveness methods simulated data sets known ground truth comparison prior work conventional gaussian mixed membership model. demonstrate practicality methods competitiveness related work study ovarian tumor data drawn cancer genome atlas section step improved analysis pipeline followed discussion validation application simulated real tumor data. break full inference problem series sequential steps. figure provides high-level overview process. following subsections provide details component. gene although potentially lower higher resolution). ease exposition refer rows tumors columns genes below. generic matrix format data many sources preprocessed matrix speciﬁcally assume input matrix contains data might derived array comparative genomic hybridization dnaseq read depths. although strategy proposed might applied forms genomic measurement data would expected cleanly modeled convex combinations pure cell types. goal decompose rows approximately convex combination smaller unknown mixture components formally seek decomposition mixture fractions pure subpopulations also called mixing proportions inferred genomic proﬁles pure subpopulations also called mixture components. interpretation vector mean copy numbers gene across samples vector standard deviations copy numbers. next facilitate analysis genomic point clouds reduce dimension data using principal components analysis sophisticated dimensionality reconstruction strategies available favor simple standard method relatively modest data needs. identify total kupper number cell subpopulations infer. present work kupper intended approximately upper limit number distinct mixture components method class might able infer. denote scores corresponding amounts next pre-cluster data identify initial candidate subsets tumors inferred draw mixture components. subset correspond distinct subsimplex full simplicial complex inferred. clustering problem non-standard seek cluster data distinct low-dimensional subspaces contiguous higherdimensional point cloud rather disjoint subclouds conventional clustering. recently developed specialized clustering method purpose based two-stage variant medoidshift clustering initially cluster euclidean space reduce data smaller representative data points. cluster representatives negative-weight exponential kernel function using isomap distance measure form geodesic metric measuring distance data points k-nearest-neighbor graph input point cloud. combination isomap distance negative exponential kernel produces clustering cluster centroids approximately extremal points simplicial complex serve pull apart distinct subspaces point cloud. initial euclidean clustering suppresses noise otherwise makes negative exponential kernel highly sensitive outlier data. refer reader full details. process left small cluster representatives assess uncertainty cluster assignments determining relative statistical weight data point cluster. weight function based folded multivariate normal distribution mean function vector covariance matrix identity multiplied distance cluster center mean cluster centers value density function evaluated distance isomap space. relative weights derived convert probabilities assignment point cluster. denote weight data point vector deﬁne normalized weight vector clustering principle depends chosen neighborhood size although scan possible neighborhood sizes found sensitivity ﬁnal model likelihood parameter. next seek estimate dimension cluster correspond number mixture components inferred cluster. major challenge step distinguishing genuine axis variation random noise particularly working sparse noisy genomic measurements. intuitively identify dimension iteratively adding axes variation longer reject hypothesis variance next dimension distinguishable noise. ﬁrst build model expected noise dimension randomly sampling data points pure gaussian noise mean identity covariance. perform random point cloud estimate mean standard deviation point cloud kupper. identify smallest kupper standard deviation true data smaller deﬁnes signiﬁcance threshold standard deviations. present work yield eﬀectively signiﬁcance threshold rejecting hypothesis next dimension explained gaussian noise. result size data precision increases. found necessary custom-made conservative dimensionality estimator opposed standard technique number data points available application much smaller typically assumed methods problem domain. next seek establish initial mixed membership model separately unmixing cluster using inferred dimension previous step number mixture components. establish model minimizing objective function based noise-tolerant geometric unmixing method regularization penalty based estimated signal-to-noise ratio data source inferred vertices adjacency matrix minimum spanning tree cost relative weight function computed above inferred mixture components data point penalty model complexity distance. ﬁrst term penalizes data points outside bounding simplex exponentially-weighted penalty. term captures form parsimony model simplex intended penalize amount mutation common source needed explain simplex vertices optimize objective function matlab fmincon function ﬁtting assign mixture components mixture fractions cluster independently. next seek join discrete simplices modeling subset tumors uniform mixture uniﬁed simplicial complex. accomplish merging simplex vertices cannot reject hypothesis represent distinct points genomic space. ﬁrst establish probability model using k-nearest-neighbors graph tumors vertices modeling overlapping neighbors vertices hypergeometric distribution. assumption vertices draw neighbor sets independently pool tumors expected number data points common would second vertex. merge vertices number observed overlapping nearest neighbors expectation. empirically determined synthetic data method insensitive chose nearest number nearest neighbors choices neighbors arbitrarily within range real data. approach replaces computationally costly bootstrap estimates used prior work test methods ﬁrst sought determine eﬀectiveness reconstructing series mixed membership models known ground truth. purpose deﬁned seven basic simplicial complex structures varying dimension geometries prior work figure simplicial complex inference problem. illustration tumor phylogeny describing progression cell types realization population tumors drawn distinct lineages phylogeny pair low-dimensional subsimplices model resulting full simplicial complex union simplices across lineages joined shared cell types. illustration seven scenarios tumor phylogeny corresponding simplicial structure used generate synthetic test cases validation. seven models designed encompass wide variety evolutionary scenarios combinations subsimplex dimensions achieveable small number mixture components. simplicial models corresponding tumor evolution scenarios illustrated fig. simulate tumor mixture scenario draw vertices uniformly random among subsimplices. vertex sample statistical weight uniformly random normalize weights across vertices yield uniformly random mixture vertices. gaussian noise dimension standard deviation varied units replicate model generate tumors embedded dimensions yield similar dataset tumor samples real data examine. perform replicates unmixing procedure scenario noise level varying number nearest neighbors also repeat evaluation neighborhood sizes corresponding possible unique integer distance. apply deconvolution method data assess inference accuracy root mean squared deviation mixture components real inferred mixtures normalized product number ambient dimensions number ground truth components. measure evaluates fractional error inferred genotypes unmixed subpopulations. compare measure proposed method earlier version method without fuzzy clustering three variants gaussian mixed membership modeling also using automated dimension estimates supplied true total dimension data another given upper bound dimensions. unlike previous approaches straightforward evaluate mixture proportions derived method comparison ground truth mixture fractions re-weighted inside simplicial complex objective function. next demonstrate method ovarian data cancer genome atlas downloaded level data ovarian cancer accessed july consisting samples. internally represent data maximal blocks ﬁxed copy number along genome previous work although blocks potentially less granular genes method agnostic granularity data. inferred geometric structure loading matrix principal components analysis obtain chromosome coordinates data signiﬁcantly dysregulated regions inferred subtype. full unmixing pipeline using following parameters maximum number table error mixture estimation. column gives mixture component inference error normalized rmsd true components best-matching inferred component each. methods using dimension estimation scwt. also provide diﬀerence number true inferred components parentheses. columns correspond upper bound number components automated dimension estimation given true number components unweighted simplicial complex upper bound components simplicial complex automated dimension estimation dimensions number bootstrapped replicates pre-clustering neighborhood size pre-clustering number nearest neighbors vertex merger cutoﬀ dimensionality estimation standard deviations; maximum number iterations fmincon simplex choice dimensionality reﬂects approximate upper bound number dimensions methods class infer upper bounded needed limit runtime. number bootstrap replicates chosen empiricaly suﬃciently large ensure stable bootstrapped clustering. maximum number fmincon iterations also chosen empirically suﬃcient reach convergence. neighborhood size corresponds well assumptions made medoidshift clustering procedure. full details number nearest neighbors chosen based tests simulated data showing method insensitive parameter approximately neighbors. standard deviations mean corresponds p-value runtime experiments depends largely upon dimensionality clusters number iterations minimization phase assess performance algorithm comparison prior version simplicial complex unixing medoid-shift clustering although without weighting generic gaussian mixture model test value dimension estimation aspect present work speciﬁcally compare versions true dimension upper bound dimension using dimension inferred method simplicial complex approach. table shows results seven scenarios. comparing simplicial complex methods suggests novel methods introduced present work signiﬁcantly improve accuracy relative prior strategy upper-bounding dimension subsimplices. true even though dimension estimates inaccurate tendency either slightly underpredict signiﬁcantly overpredict true dimension methods mixed performance depending number components figure visualization ovarian data inferred components inferred connections black line. interpret geometry terms phylogeny tumors subsimplices tetrahedron triangle joined edge corresponding putative high-level split subtypes common normal ancestor putative early state progression common subtypes there evolutionary trajectories emerge adds leaf node vertex contains vertices phylogenetic intepretation derived minimum spanning tree among vertices edge lengths tree model providing component model likelihood function. inferred. always using upper-bound yields poor performance improved feeding method true number components. suprisingly inferred components yields generally lowest rmsds despite generally signiﬁcantly underestimating dimension rmsd measure good rmsd scores merging multiple true components single inferred component eﬀectively ﬁtting components well losing desired mixture structure. approach subdividing problem smaller low-dimensional subproblems allow substantially better estimation qualitative simplicial structure sophisticated probabilistic models substructures lead better quality decompositions current geometry-based unmixing approach. better illustrate utility approach real cancer data next applied dataset data tumors taken tcga using parameters described section weighted unmixing procedure inferred simplicial structure consisting vertices substructures tetrahedron triangle conjoined line. results illustrated fig. shows true point cloud inferred simplicial structure projected space. ﬁgure shows views capturing ﬁrst three next three pcs. ﬁrst view clearly highlights simplicial complex structure apparent data consisting three arms branching common point. second view shows variability high dimensions presumed explain complex mixture structure inferred seems apparent ﬁrst three pcs. assess functional signiﬁcance inferred mixture components projected back genomic space identiﬁed blocks copy number z-score component resolution identiﬁed genes overlapping elevated blocks using ucsc genome browser obtain list genes associated elevated blocks. identiﬁed statistically signiﬁcant term associations resulting gene lists mixture component using david toolkit table provides signiﬁcant term associations p-value clustered david. term associations associated vertices particular relevance terms associated chromatin structure. vertex distinguishes triangular simplex tetrahedral provided signiﬁcant association terms associated regulation zinc ﬁnger transcription factors. vertex identify inference normal stromal cells shows term associations. also none found vertex indicate reﬂects minor axis variation data. addition pathway results david also found weakly signiﬁcant tissue-speciﬁc expression highlighted genes multiple inferred vertices uterine ovarian carcinoma tissue well lung tissue. direct comparison present method standard genomic deconvolution approaches challenging diﬀering forms input data required leading alternatives. nonetheless compare predictions others performed tumors purpose purity estimation purity estimation purpose method considered subproblem full mixture decomposition. derive comparable measure tumor purity identiﬁed vertex simplicial complex model elevated regions genome detected plausible representative genetically normal contaminating stromal cells. estimated purity tumor inferred fraction non-normal cells subsimplices weighted inferred probability belonging given subsimplex estimates compared aran spearman correlation coeﬃcient giving weakly signiﬁcant p-value showing decomposition concordant prevailing purity estimates large real tumors. table provides confusion matrix comparing method theta leading alternative method concordance tcga purity estimation pipeline aran consensus purity estimates derived combination absolute annotation based immunological staining additional measures calls unavailable treating consensus best estimate ground truth observe weakly signiﬁcant correlation estimates although insigniﬁcant anti-correlation theta. since absolute staining components consensus call high concordance expected. absolute shows signiﬁcant correlation staining data neither method theta shows. suggest absolute method superior task could also reﬂect fact absolute direct karyotyping information input neither method theta does fact absolute designed purity estimation neither method theta are. thus hesitate draw strong conclusions data given wide diﬀerences goals input data types methods nonetheless suggest show method least competitive popular alternative genomic deconvolution method task separating tumor non-tumor subpopulations. developed novel strategies taking better advantage mixture substructure deconvolution mixed genomic data heterogeneous tumor samples. contribution intended advance theoretical method better taking advantage substructure complex genomic gonucleosome* goprotein-dna complex* gochromatin* godna packing/binding kegglupis erythematosis patherhistone reactometelomere maint. gocellular macromolecular component org.* gonucleosome* goprotein-dna complex* gochromatin* godna packing/binding kegglupis erythematosis pantherhistone reactometelomere maint. gocellular macromolecular component org.* godna binding* pantherkrab pantherzf godna binding* panther lactation mammary development pantherlactation mammary development go/kegg olfactory* go/kegg olfactory* panthermhci-mediated immunity panthermhci-mediated immunity pantherkrab pantherkrab go/panther phosphate* mixtures approach might incorporated many existing approaches cell type deconvolution using assorted data types inference models. advances present paper bring closer goal deriving precise models mixture substructure face sparse noisy genomic data without need extensive expert intervention. purpose introduced strategies automated inference subcluster dimensions automated construction global simplicial complex structure better deconvolution submixtures small samples uncertain subclustering. shown automatically learn model structure realistic sizes data without degrading performance model relative methods requiring signiﬁcantly user intervention. focus speciﬁcally deconvolution data believe simplicial complex approach substructured mixture decomposition could adopted variety genomic data types technologies table confusion matrix correlations purity estimates tcga data theta absolute expert annotation immunological staining consensus call derived absolute staining additional estimators calls unavailable. entry presents correlation coeﬃcient shared samples followed statistical signiﬁcance parentheses. ultimate goal present work make sophisticated mixture deconvolution approaches widely accessible non-expert community allowing incorporated broadly variety deconvolution approaches literature. much work still remains though better automating approaches improving inference quality. still several parameters task automated learning remains challenging. automated dimension estimation appears valuable improving simplicial complex models deriving accurate estimates signiﬁcant challenge noisy data integration multiple forms genomic data common mixture framework likewise promising challenging direction improving inference quality. particular single-cell methods become cost-eﬀective combinations bulk single-cell data prove particularly informative. finally simplicial complex models require reﬁnement better capture real sources genomic mixture substructure meant model including substructure imposed common pathways subtype evolution spatial constraints tumor microenvironment sources mixture substructure conform well current simplicial complex model. portions work funded u.s. national institutes health awards carnegie mellon university gush grant carnegie mellon computational biology dept. commonwealth pennsylvania cure grant conﬂict interest none declared.", "year": "2016"}