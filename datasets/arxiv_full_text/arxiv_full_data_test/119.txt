{"title": "Modeling of the contrast-enhanced perfusion test in liver based on the  multi-compartment flow in porous media", "tag": "q-bio", "abstract": " The paper deals with modeling the liver perfusion intended to improve quantitative analysis of the tissue scans provided by the contrast-enhanced computed tomography (CT). For this purpose, we developed a model of dynamic transport of the contrast fluid through the hierarchies of the perfusion trees. Conceptually, computed time-space distributions of the so-called tissue density can be compared with the measured data obtained from CT; such a modeling feedback can be used for model parameter identification. The blood flow is characterized at several scales for which different models are used. Flows in upper hierarchies represented by larger branching vessels are described using simple 1D models based on the Bernoulli equation extended by correction terms to respect the local pressure losses. To describe flows in smaller vessels and in the tissue parenchyma, we propose a 3D continuum model of porous medium defined in terms of hierarchically matched compartments characterized by hydraulic permeabilities. The 1D models corresponding to the portal and hepatic veins are coupled with the 3D model through point sources, or sinks. The contrast fluid saturation is governed by transport equations adapted for the 1D and 3D flow models. The complex perfusion model has been implemented using the finite element and finite volume methods. We report numerical examples computed for anatomically relevant geometries of the liver organ and of the principal vascular trees. The simulated tissue density corresponding to the CT examination output reflects a pathology modeled as a localized permeability deficiency. ", "text": "abstract paper deals modeling liver perfusion intended improve quantitative analysis tissue scans provided contrast-enhanced computed tomography purpose developed model dynamic transport contrast ﬂuid hierarchies perfusion trees. conceptually computed time-space distributions so-called tissue density compared measured data obtained modeling feedback used model parameter identiﬁcation. blood characterized several scales diﬀerent models used. flows upper hierarchies represented larger branching vessels described using simple models based bernoulli equation extended correction terms respect local pressure losses. describe ﬂows smaller vessels tissue parenchyma propose continuum model porous medium deﬁned terms hierarchically matched compartments characterized hydraulic permeabilities. models corresponding portal hepatic veins coupled model point sources sinks. contrast ﬂuid saturation governed transport equations adapted models. complex perfusion model implemented using ﬁnite element ﬁnite volume methods. report numerical examples computed anatomically relevant geometries liver organ principal vascular trees. simulated tissue density corresponding examination output reﬂects pathology modeled localized permeability deﬁciency. keywords liver perfusion porous media darcy ﬂowbernoulli equationtransport equation dynamic contrast-enhanced computed tomography modeling blood perfusion tissues belongs challenging problems biomechanical biomedical research. topic interest especially liver surgery brain neurosurgery neurology although functionality related organs liver brain completely diﬀerent similar aspects both. contrast myocardium another highly perfused tissue organs phenomenon deformation neglected unless special concerns focus e.g. peterlik desirable accurately parts tissue insuﬃcient blood supply localize anomalies blood microcirculation quantify locally perfusion eﬃciency. worth note also kidney belongs highly perfused tissues important role blood circulation system tackle issue present paper. perfused organs blood transported complex hierarchical branching systems vessels various diameters diminish consecutively bifurcation beginning arteries capillaries. ascending system veins arranged reversed sense starting capillary level blood participates metabolism process delivering oxygen tissue collecting waste products. blood circulation tissue represented penetrating mutually separated vascular trees connected capillary level. reality collateralization vessels exist make shunts trees phenomenon usually negligible global hierarchically built system. although modeling approach presented rather general setting paper focus liver tissue special structure. blood ﬂows whole organ separated vascular trees connected hepatic artery portal vein whereby venous supply dominates. branching systems bifurcate generations blood ﬁltered tissue functional units called hepatic units lobules typically considered hexagonal prisms. corner edges hepatic artery portal vein trees terminate blood ﬂows hepatic capillaries constituting sinusoids so-called central veins terminal branches draining hepatic vein located center lobule. proposed model simplicity neglect blood supply minor comparison portal vein. steadily growing body published works related modeling liver perfusion shows importance medical research. obviously relevant computational models used complex simulations involving various parameters require detailed information liver structure. however pertaining diﬃculty describing vascular trees bridging several scales. current standard computed tomography magnetic resonance imaging related image processing techniques provide resolution vascular trees millimeters enough capture details underlying tree generations. therefore various methods algorithms proposed generate artiﬁcial anatomically correct vascular architectures. coupled authentic patient-speciﬁc reconstructed geometry obtain complete vascular trees perfusion model intended estimate volume regeneration capacity liver parenchyma context important capture supply portal vein. concerning perfusion simulation focus second stage contrast bolus arrives inlet ﬁrst stage associated over. figure decomposition blood vessel perfusion system liver higher hierarchy blood described model lower hierarchy blood distribution governed darcy model extended multiple compartments compartment characterized permeability tensor required resolution microvessels. popular approach based constrained constructive optimization e.g. georg schwen preusser however advanced approaches based metabolism driven processes vascular tree reconstruction rather modeling complex branching system many publications devoted detailed studies microcirclation. perfusion characteristics blood hepatic microcapillaries human lobular sinusoids analyzed debbaut using tissue samples processed corrosion casting micro-ct imaging; anisotropic tensors sinusoidal permeability calculated simple averaging ﬁeld obtained using standard simulations. blood circulation liver lobule considered bonﬁglio using newtonian shear-thinning models. liver tissue able adapt rapidly modiﬁed hydraulic conditions; ricken sinusoidal permeability studied terms vascular remodeling process induced outﬂow obstruction. sinusoidal vascular canals assumed align blood pressure gradient. ricken using general framework two-scale approach theory porous media basic coupled transport-reaction mechanisms blood perfusion hepatic cell metabolism described level lobule. lymphatic production liver lobules arranged periodic lattices treated siggers similar approach used lettmann hardtke-wolenski study microcirculation driven transport oxygen cytokine tissue. besides blood healthy liver itself diseased tissue deserve attention medical point view also challenge mathematical modeling; considerable number issues related modeling pathophysiological conditions ﬂuid transport vascular tumors since straightforward mathematical description blood complete vascular trees featured several hierarchies using navier-stokes equations leads prohibitively complicated numerical model convenient model reduction needed. adhere tree constituted larger vessels described geometry using navier-stokes equations. alternatively vessels replaced line segments model obtained using description branching system line segments. describe blood tree resort type darcy model deﬁned bulk liver parenchyma. since part involves vessels associated diﬀerent hierarchies several compartments introduced darcy model used within them. diﬀerent compartments described terms diﬀerence compartmental pressure given location; details given below. remark multicompartment model perfusion used e.g. cimrman rohan jon´aˇsov´a phenomenological model. recently multicompartment model cardiac perfusion presented michler hyde compartments derived using homogenization darcy porous medium large contrasts permeability another derivation based averaging theory slattery whitaker employed hierarchical pores continuously variable cross-sections huyghe campen context multi-porous media employed geophysical research phenomenological approaches based extensions biot model lead multi-compartment models co-existing porosities associated distinct pressures. special case double-porous double-permeability media obtained homogenization approach applied upscale periodic structures large contrasts hydraulic permeability derived model describing ﬂuid double-permeability medium systems periodic channels separated permeable matrix adapted liver parenchyma generated quasi-periodic structure lobules. present numerically tractable model liver perfusion intended real-time simulations based hierarchical decomposition perfusion trees combining approaches multicompartment porous media vascular trees; latter model provides analogous output so-called tissue density obtained medical perfusion examination dynamic contrast-enhanced alternatively magnetic resonance imaging e.g. fieselmann keeling would like stress modeling option important model parameters identiﬁcation thereby also model validation. conception hierarchical modeling reported paper outlined short proceedings paper however give additional details model present results computed anatomically relevant data including anisotropic permeability coeﬃcients estimated analysis perfusion trees. organization paper follows. perfusion model based hierarchical decomposition perfusion trees described section section transport contrast ﬂuid introduced. section present numerical examples illustrate application model describe hierarchical blood liver simpliﬁed geometrical structure created using anatomical data combined approach deﬁne portal hepatic vascular trees. paper conclusions discussion perspectives presented section simulation blood perfusion tissues hepatic cerebral ones belongs problems typically requiring sort multiscale modeling approach term multiscale employed slightly diﬀerent manner formaggia geometrical multiscale modeling introduced context cardiovascular system. diﬃculty blood perfusion modeling arises nature perfusion trees incorporating blood vessels diﬀerent diameters. liver blood conveyed organ portal vein diameter perfusion trees several hierarchies associated bifurcations vessel diameters reduce. tissue parenchyma arranged hexagonal structures characteristic size blood transported capillaries diameter portal compartment hepatic one. thus overall scale change characterized ratio largest smallest diameters vascular trees approximately model develop allow also simulation transport contrast ﬂuid contrast-enhanced dynamic perfusion test. provide computational feedback would enable analyze accurately scans obtained standard dynamic perfusion test patient methods currently used based deconvolution maximum slope techniques. provide local integral characteristics like blood blood volume mean transition times others voxel tissue approach provide alternative detailed interpretation measured scans. proposed strategy announced ﬁrst conference paper based following tasks proposed strategy several diﬃculties arise hand model reﬂect microstructure complex geometry perfusion trees hand parametrized using many parameters prevent conditioning tuning step involving simulations steady blood dynamic tracer transport. therefore tuning parameters must reﬂect important features perfusion system. vein system whereas label stands hepatic vein system). formed vessel segments junctions representing bifurcations. steady trees described model introduced section also jon´aˇsov´a model relevant higher hierarchies vascular trees several diﬀerent pressure values deﬁned associated diﬀerent compartments section point sources sinks deﬁned trees connected parenchyma model. tablished continuum representations connected vascular network restricted given range characteristic vessel cross-sections. denoting total number considered hierarchies range indicated hierarchy index whereby hierarchies correspond precapillary vessels lobular structure. denoting typical vessel cross section given hierarchy holds whenever compartment associated group; typically groups labeled index corresponding portal hepatic vein systems given group hierarchy whereby denotes index compartments. compartment represented subdomain hydraulic permeability tensor introduced using averaging procedure underlying tree segment known. point discussed section given compartment belonging group groups hierarchies volume fractions concept volume fractions natural basis relate model parameters structural features. vessels given group associated hierarchy distributed point volume fractions context present model describe local volume fraction blood denoting vessels comprised compartment since obviously volume fraction parts parenchyma blood vessels thus included compartment partition unity expressed terms volume fractions components reads possible ways approximate lower hierarchies arterial venous trees including perfusion level tissue parenchyma using macroscopic model describing parallel ﬂows deﬁned compartments. model based fundamental principles related homogenization remark section simply justiﬁed phenomenological approach. similar models used works model involves pressures {pi} associated compartment i-th compartment occupying domain saturated external source general deﬁne local source/sink expresses amount ﬂuid supplied drained compartment upper perfusion tree branches represent junctions upper hierarchies perfusion system treated model branching networks section practice formed number small balls mass conservation compartment expressed following equations local permeability tensor associated local perfusion coeﬃcient coupling compartj describes amount ﬂuid transported boundary conditions consider non-penetration depend local volume fractions fact given tree fig. parameters computed point-wise using averaging approach reported vankan hyde based theoretical result describing hierarchical ﬂows following properties guaranteed characteristic usually averaging control volume large enough w.r.t. size vessel segments positive deﬁnite however vessels encountered singular. numerical treatment regularization using modiﬁed permeabilities considered e.g. kiωi relevant permeability value domain small domains exists nonempty overlap domain ωii+. least compartment ωii+ dirichlet boundary nonempty regularized problem replaced yields unique solution announced above upper-level vascular trees arterial venous treated taking account speciﬁc geometry vessels. order obtain eﬃcient numerical model suggested consider simpliﬁed model based bernoulli equation. thus instead full analysis complicated vessel geometries perfusion tree replaced system line segments characterized length cross-section loss parameter related speciﬁc geometry vessel segment. respect tortuosity vascular network lengths associated line segments correspond actual vessel length. consider vascular tree e}e) constituted vessel segments junctions labeled fig. deﬁned spatial position connectivity containing indices segments connected junction. although assumed form graph loops study consider branching trees typically bifurcation. root terminal junctions oneelement sets. number terminal junctions denoted denote root junction whereas terminal branches junctions connected continuum model described section account dissipation viscous pressure loss terms must introduced virtue reynolds number associated segment. line segment featured true vessel length diameter assumed constant along whole segment pressure drop related node pressures vessel end-points related velocity following relationship model coupled model introduced section terminal junctions specify sources sinks considered compartments upper-most hierarchy i.e. i-th compartment saturated tree terminal junction model. pressures junctions represented coupled pressure ﬁelds parenchyma expressed condition practice approximation based upon speciﬁc ﬁnite element discretization replaced nodal value pressure shared. indices denoting quantities associated portal hepatic veins. given values i.e. velocity inlet portal vein pressure hepatic vein computation proceeds repeating following algorithm section explain simulate dynamic perfusion tests used principal method assess blood highly perfused organs e.g. liver brain. based computed tomography scans provide information tissue density. quantity proportional local concentration contrast ﬂuid dissolved blood. relative content expressed saturation quantity deﬁned individual compartments parenchyma treated darcy model also branches upper level vascular trees explained section transport equations resolving saturations compartments derived using pre-computed perfusion velocities mass conservation taking account ﬂuid exchange compartments. thus obtain system hyperbolic equations resolving saturations. tissue contrast deﬁned locally weighted saturations; weights given volume fractions. conservation whenever feasible initial boundary conditions satisfy constraint. introduce tracer partial concentration φisi compartment quantity equivalent tissue density retrieved scans. velocities vessel segment deﬁne depending oriented network topology. call index sources index sinks. worth noting perfusion tree binary bifurcation junction contains index saturating vessel contains children vessels hepatic vein tree analogous property role model introduced preceding sections implemented non-commercial codes. section illustrate model response using numerical examples real geometry human liver perfusion trees portal hepatic veins generated using method presenting particular results serve proof concept explain ﬂowchart currently developed computational modeling tool. scans human liver processed lisa software starting point numerical simulation liver perfusion. lisa code includes semi-automated segmentation method based graph-cut algorithm returns geometrical model liver parenchyma transformed volumetric ﬁnite element mesh. code also used identify position diameter portal hepatic veins point entry liver parenchyma; data necessary generate artiﬁcial vascular trees associated portal hepatic veins part employed directly simulation upper-level using model described section also establish permeabilities perfusion coeﬃcients appearing multicompartment darcy model. hepatic artery considered liver model small contribution overall blood perfusion liver tissue. constrained constructive optimization approach used creation vascular structures reﬂecting main physiological principles georg geometry particular liver. accordance modeling principles described above calculation blood perfusion contrast ﬂuid distribution liver divided stages. ﬁrst includes solution model coupled multicompartment darcy model resulting velocities associated vessel segments model velocity ﬁelds compartments employed second stage compartmental saturations yielding total concentration computed. model implemented python language multicompartment darcy model discretized using method software sfepy simple finite elements python cimrman model describing tracer transport implemented using ﬁnite volume method matlab system. overview simulation process illustrated fig. hepatic capillaries lobular sinusoids therefore perceived ﬁltration part perfusion model. generated artiﬁcial vascular trees representing vascular networks liver depicted fig. properties summarized tab. higher hierarchy trees blood approximated model fig. obtained taking vessel segments horton–strahler number greater equal branching complexity generated portal vascular tree characterized number illustrated fig. well porosities ﬁnite element volume averaging performed corresponding vascular tree given range vessel diameters. anisotropic permeabilities compartments evaluated using expression derived huge campen whereas coupling perfusion coeﬃcients calculated help theory presented hyde values model parameters selected points listed tab. isotropic permeability compartment taken parameters identiﬁed debbaut domain liver discretized ﬁnite element mesh consisting tetrahedrons nodes. rather coarse mesh chosen large computational cost associated tracer transport calculation. model connected multicompartment model junctions sources located compartment remaining sinks located compartment upper-level vascular trees terminal points correspond sources sinks shown fig. fig. input blood velocity figure upper-level vascular trees approximated using model based extended bernoulli equation. terminal points correspond either sources compartment sinks compartment presented fig. ﬁgure shows distribution pressure three compartments well corresponding velocity vectors well illustrate interplay ﬁlling draining functionality portal hepatic compartments respectively. surface volumetric visualizations computed pressure ﬁelds noticed portal hepatic pressures depend strongly structure vascular trees especially upper-level hierarchies; accordance observations made real human liver. better idea diﬀerent perfusion properties three compartments inﬂuence ﬁnal distribution blood within liver also simulate real dynamic perfusion test simulation contrast ﬂuid transport carried using model presented section purpose given external source saturation prescribed form time bolus deﬁned root segment portal vein system fig. fig. obtained portal lobular slob hepatic saturations total apparent concentration shown selected sections liver positions outlined fig. denoted planes timedependent character tracer transport simulation results fig. visualized three time instants note ﬁrst time instants reﬂect time portal lobular slob saturations attain maximum graphs fig. graphs show time development portal hepatic lobular slob saturations points located planes bottom graph depicts evolution total apparent concentration points. saturation isocontours presented fig. clearly demonstrate transport contrast ﬂuid three considered liver compartments. words apparent saturation respective compartment occurs successively—ﬁrst portal vein system time followed lobular concluded hepatic vein system dynamics perfusion also recognized varying grey levels total apparent concentration fig. relatively fast ﬁltration tracer portal compartment contrary ﬁltration compartment characterized relatively high porosity compared ones computed ﬁlling/draining compartments fulﬁlls function ﬁltration system saturation slob decreases slowly time fig. consequence perfusion properties ﬁltration system inﬂuence time development hepatic saturation which compared portal saturation changes much gradually depending tracer transfer ﬁltration system. liver model pathologically changed permeability demonstrate applicability proposed model numerical simulation various liver tissue pathologies simple illustrative example presented. small spherical region depicted fig. permeability parameter compartment locally changed values close zero change permeability mimic pathology lobular structure namely lesion. able quantify introduction lesion within parenchyma aﬀects overall perfusion liver including transport contrast ﬂuid following auxiliary quantities introduced upper index denotes quantity associated pathologically changed liver model. similarly fig. fig. shows distribution ∆slob planes three previously introduced time instants ∆slob isocontours deduced lesion located upper part liver model aﬀects perfusion tracer transport globally. phenomenon particularly observed plane beginning simulation lobular saturation slob original model higher case model lesion presence lesion within liver model inﬂuence overall blood perfusion also reﬂected distribution figure time development portal lobular slob hepatic saturations total concentration plotted points shown fig. dashed vertical lines graphs denote three selected time instants mentioned fig. fig. diﬀerences total concentration apparent planes region left part plane particular importance clearly distinguishable snapshots thus indicating location lesion. assess impact lesion perfusion results time-continuous manner refer graphs shown fig. capture evolution ∆spv ∆shv time points previously introduced. note that comparison fig. graph ∆slob displayed fig. would closely resemble comparing plotted curves observations worth nothing. first although perfusion anomaly located ﬁltration compartment inﬂuences perfusion thereby tracer transport higher hierarchies included portal compartment second curves plotted selected points dissimilar other common features evident. particularly apparent case ∆spv points exhibit completely diﬀerent behaviour hand point graph characterized delayed maximum portal saturation undamaged liver model hand time evolution ∆spv point shows time delay higher portal saturation compared damaged liver model apparent similar observations made case ∆shv curves. paper proposed multicompartment model tissue blood perfusion superimposed time-space distribution contrast ﬂuid. latter feature enables establish modeling feedback necessary tune model parameters according information available standard clinical examination combined essential parameters basic structural morphological data speciﬁc perfused tissue. although model intended currently developed modeling liver perfusion adapted applications namely cerebral perfusion; issue focus future work. perfusion model derived simple idea decomposing perfusion tree number sets compartments hierarchically organized. within compartment governed darcy involving permeability tensors cross links communicating compartments respected locally scalar perfusion coeﬃcients associated cuts perfusion tree bifurcations separating diﬀerent hierarchies. features represent substantial step towards anatomically parametrized porous perfusion model. however issue quantiﬁcation model parameters. exact geometry perfusion tree known case using artiﬁcially generated trees permeabilities determined using geometrical data representative volume averaging following approaches suggested huyghe campen vankan followed hyde following work procedure proposed determine also perfusion coeﬃcients which however would require resolving whole nonreduced problem vessel segments tree. therefore treatment simpliﬁed complex procedure obtain approximate tractable computation perfusion coeﬃcients. model means distributed point sources sinks. iterative algorithm based commuting solvers associated portal hepatic vein trees perfusion solver whereby inlet velocity portal vein increased gradually zero steady state reached. second contribution paper propose model describing contrast ﬂuid dynamic transport hierarchies perfusion trees. superposition local saturation tracer compartments yields local concentration often called tissue density measured perfusion examination. hand option possible patient-speciﬁc images tune model parameters. hand computational tool allow deeper analysis scans accurate localization assessment possible liver pathology. bring modeling approach practical application valuable outputs clinical practice several important issues pursued future work. main purpose using multicompartment continuum model describe approximately complex branching vessel networks like trees avoid direct simulations prohibitively expensive even non-feasible provide real time solutions. verify model performance need check tree decomposition varying number compartments inﬂuences modeling error. numerical experiment requires reference model would provide suﬃciently robust resolution vascular tree branches. purpose shall consider perfusion tree described bernoulli-type model. reference model also used parameters practical model parameters cannot appropriately using direct calculations reason twofold. real data used tree cannot identiﬁed suﬃcient resolution small vessels using imaging techniques currently available. moreover even tree known numerical examples cumbersome direct calculation would necessary parameters therefore intend identify model parameters solving inverse problem. rohan suggested formulation nonlinear least square problem based discrepancy local contrast ﬂuid concentration resolved model corresponding data provided examination. approach seems tuning model. however treatment requires improvements model capture accurately lowermost level parenchyma also account dispersion contrast ﬂuid transport compartments. currently working homogenized model capillary pre-capillary level integrated multicompartment model. liver lobular level vasculature approximated periodic structure featured double porosity context vertex central venules connected hepatic capillaries sinusoids. another issue certainly related deformation parenchyma longer perspective phenomenon must treated model capture processes tissue remodeling. acknowledgements research supported project czech ministry educationyouth sports.", "year": "2016"}