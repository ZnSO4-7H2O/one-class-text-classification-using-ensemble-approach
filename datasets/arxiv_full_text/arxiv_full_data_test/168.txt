{"title": "Inference of epidemiological parameters from household stratified data", "tag": "q-bio", "abstract": " We consider a continuous-time Markov chain model of SIR disease dynamics with two levels of mixing. For this so-called stochastic households model, we provide two methods for inferring the model parameters---governing within-household transmission, recovery, and between-household transmission---from data of the day upon which each individual became infectious and the household in which each infection occurred, as would be available from first few hundred studies. Each method is a form of Bayesian Markov Chain Monte Carlo that allows us to calculate a joint posterior distribution for all parameters and hence the household reproduction number and the early growth rate of the epidemic. The first method performs exact Bayesian inference using a standard data-augmentation approach; the second performs approximate Bayesian inference based on a likelihood approximation derived from branching processes. These methods are compared for computational efficiency and posteriors from each are compared. The branching process is shown to be an excellent approximation and remains computationally efficient as the amount of data is increased. ", "text": "gageldonk-lafeber characterise novel strain determine impact hence inform public health planning studies involve collection data households person conﬁrmed infected. members household surveilled identify time symptom onset study continued ﬁrst hundred cases observed adequate characterisation achieved. households primary unit observation convenient surveil—in contrast general contact tracing—and large fraction transmission occurs within household stochastic models population split households different rates mixing within between households natural framework understand data recent work inferred withinhousehold epidemic parameters type household stratiﬁed data black inference performed using bayesian mcmc framework exact evaluation likelihood returning joint posterior distribution parameters interest hence within-household reproductive ratio. paper present method performing inference markovian household model—that also infers household transmission parameter—and compare standard approach. estimate household mixing turn estimate household reproductive number early growth rate epidemic importance public health response abstract consider continuous-time markov chain model disease dynamics levels mixing. so-called stochastic households model provide methods inferring model parameters—governing withinhousehold transmission recovery between-household transmission—from data upon individual became infectious household infection occurred would available ﬁrst hundred studies. method form bayesian markov chain monte carlo allows calculate joint posterior distribution parameters hence household reproduction number early growth rate epidemic. ﬁrst method performs exact bayesian inference using standard data-augmentation approach; second performs approximate bayesian inference based likelihood approximation derived branching processes. methods compared computational efﬁciency posteriors compared. branching process shown excellent approximation remains computationally efﬁcient amount data increased. first hundred studies data collection exercises carried early stages pandemic inﬂuenza outbreaks households size times symptom onset binned days ﬁrst infected households beginning epidemic outbreak presented. size points corresponds number infections day. lines provide visual reference link infections within household. incide infectiousness; recovery times available. main challenge this many similar models likelihood difﬁcult compute missing data. standard approach sorts problems data-augmentation method approach unobserved events treated unknowns also sampled within mcmc routine; model considered paper would exact infection recovery times individual within household. exact times known likelihood trivial evaluate. data-augmented approach potentially allows great ﬂexibility model choice ﬁtting trade mcmc scheme needed sample joint distribution parameters unknown data quite complex needs longer achieve proper mixing. convergence issue large amount missing data scalability algorithms poor data added mcmc essentially serial algorithm works whole data cannot exploit parallelism easily. develop another approach based approximation original process compare dataaugmentation method. approach carefully consider dynamics structure problem allow derive approximation exact likelihood evaluated using novel combination numerical methods stochastic simulations numerical convolutions). allows simple metropolis-hastings algorithm compute joint posterior parameters interest. dynamics epidemic modelled continuoustime markov chain. individuals grouped mutually exclusive households make effective contact high rate within households rate households. paper simplicity assume households size model disease dynamics. thus individual classiﬁed susceptible infection infectious able infect susceptible individuals recovered immune disease ﬁxed state conﬁguration household note lower dimensional representations household models state vector describes total number households possible conﬁguration however adopt higher dimensional version simpliﬁes inference. dynamics household model deﬁned transitions occur throughout population corresponding rates. infectious individuals make effective contact within household rate household probability effective contact within housej hold leads infection hence rate within household infection infectious individual recovers rate recoveries household occur rate lastly infectious individuals make effective contact individual population outside household rate thus household effective contact results infection household rate total number infectious individuals population. assume ﬁrst infection seeded single household distributed time matrix encoding ﬁrst state ﬁrst rows note that data reveals cases infectiousness daily resolution time ﬁrst infection unknown. fig. illustration data structured inference. outbreak observed days resulting households becoming infected. circles indicate days infections observed size proportional number infections. sets indicate households become infected note indicates houses infected cumulative number observed cases within household days became infected note process observed daily resolution ordering within arbitrary. natural specify data terms quantities days household infected time series cumulative infection counts within household starting infection. precisely labels households became infected vector cumulative number infection events within household recorded households initial infection thus data completely suppose observed start epidemic time period assume data counts cumulative number infections household deﬁned time interval assuming symptoms coincide infectiousness. household labelled order data augmented markov chain monte carlo powerful exact bayesian inference method data missing information. adopt approach similar o’neill roberts infer joint posterior density general approach construct augmented proportional thus sampled randomly choosing following kinds moves according arbitrary probability mass function nonzero components randomly select infection time choose candidate distributed infection time. augmented likelihood corresponding candidate denoted ˆlda. point accepted probability randomly select recovery time choose distributed recovery time candidate uniform time ﬁrst infection within household. point accepted probability iteration mcmc algorithm comprised gibbs samples followed hastings step distribution samples converge posterior distribution though consecutive samples highly correlated. alternative approach inference assume model acts like branching process household level. assume inﬁnite population size hence between-household infection occurs completely susceptible households; assumption reasonable data wish perform inference earliest stages outbreak. households independently initial infection hence consider dynamics likelihood joint density data missing information given model parameters construct single-component metropolis-hastings algorithm. method proves useful study data exact times infection missing number recovery events times occur entirely unknown. although data-augmented approach standard method kind problem aware implemented household model neither recovery infection times observed exactly parameters unknown. example data-augmented mcmc implemented similar model data obtained regular discrete times however parameters associated infectious period distribution assumed known hence outline algorithm used particular problem. transition times corresponding states underlying model unknown number transitions time allowed vary. additionally consider classiﬁcation infection events missing augment data construct sets transition indices correspond within-household infection betweenhousehold infection recovery events respectively. writing expression augmented likelihood function adopt convention quantities evaluated immediately prior transition. hence have denotes indicator function corresponding data could arisen events deﬁned simplicity. note inference could made without labelling kinds infection however explicit representation produces gamma truncated gamma marginal densities uniform gamma inverse uniform truncated gamma priors; hence efﬁciently sampled. branching process likelihood approximation relies expressing likelihood terms data given partitioned newly infected households formerly infected households partition likelihood written note also subtle assumption independence factorisation likelihood even branching process approximation infection households contains information within-household processes least individual still infectious within households easy incorporating likelihood; case contribution likelihood small households become infected. within infected household following initial infection isolation model construct approximate likelihood obtaining accurate estimates joint posterior distribution show section resulting distribution approximates exact distribution well independence assumption allows computational gains inference data grows size. within-household dynamics deﬁned transitions occur within individual household corresponding rates; simply within-household infection recovery transitions rates described section within-household process deﬁned terms inﬁnitesimal transition rate matrix given otherwise ...|s|} bijective map. ﬁrst infection within household moves state point within-household dynamics determine disease spreads within household remainder epidemic. assume between-household infection occurs homogeneous mixing individuals population rate thus rate households infected simply total number infected individuals population time model initialised single infected household distributed time. model identify threshold parameter household reproduction number expected number households infected primary infectious household otherwise susceptible population households; household considered infectious contains least infectious individual household considered susceptible contains susceptible individuals. least reproductive numbers might used assessing controllability disease community households adopt herein relatively easy calculate interpret. {xt}t∈r+ markovian process describes state individual household calculate number ﬁrst generation infected households note ﬁrst epidemic single household infected distributed time. hence exactly infected household ﬁrst generation households consider rate households infect households. model outbreak branching process assume completely susceptible households infected hence instantaneous rate force infection short time period relatively variance thus replacing expectation provide reasonable approximation. section detail conditional expectations calculated using matrix exponential methods. determined initial condition. further households identically distributed absence withinhousehold information. thus labels arbitrary number households relevant hood probability observe |ψt| infected households given data time period households infected decompose components ﬁrst component number newly infected households infected household i.e. household infected second component remaining number newly infected households i.e. infected households become infected observe demarcation data assists evaluation likelihood. start considering calculation probability mass function section then section consider evaluation required subsequently evaluated using efﬁcient methods calculating convolutions. recall number newly infected households number newly infected households infected household i.e. household infected second component remaining number newly infected households i.e. infected households become infected households uniformly distributed since dynamics independent convolution random variables; denote random variables. random variables correspond size household branching process time initialised time. calculation computationally expensive choose estimate distribution using simulation simulating short period time efﬁcient representation minimise computational time large number simulations producing accurate estimate produced computationally efﬁcient manner. vector exception ﬁrst entry. matrix truncated probability needed calculation likelihood lost. calculation expensive even large matrices convolutions done using using discrete fourier transforms paper simply built matlab function conv although methods provide computational gains required. computation expressed terms integrals expected number infectious individuals within household expression independent households simplify exposition detailing calculation single arbitrary household observed data independence also means rescale time within household begin start ﬁrst infection. thus need calculate expected number infected individuals expectation calculated efﬁciently hence integral expectation force infection also calculated efﬁciently accurately simpsons rule say. calculation similar forward-backward algorithm involved need calculate expectations discrete time points observations occur. first deﬁne quantities. total number infections observed household must states states encoded indicator vectors entries corresponding states zeros otherwise; either column vectors required. tial parameter take powers resulting matrix. further numerically integrating using symmetric grid allows take advantage symmetry effectively halving number times need take powers using quantities calculated above also calculate within-household likelihood described denote length note branching process assumption infected households independently other within household dynamics following infection independent. hence within-household likelihood product normalising constants forward probabilities. thus within-household likelihood calculated by-product expectation calculations. inference methods compared simulations true parameter values households size parameters chosen average infectious period three days infection introduced household distributed time infection distribution given probabilities observing remainder data given system state calculated similar recursive forward probabilities working backward ﬁnal observation mcmc algorithm respectively. map’s calculated dimensional kernel density estimates. pairs boxes left right map’s inference based upon data infected households. black dotted lines indicate true parameter values efﬁciency algorithms cannot compared directly terms iterations time samples mcmc highly correlated samples hence algorithms compared terms multivariate effective sample size minute multivariate effective sample size estimate number independent samples dataset vats figure shows mcmc initially much efﬁcient algorithm however scales poorly data obtained less efﬁcient households infected. paper implemented mcmc algorithm exact inference stochastic household model derived method approximate likelihood household branching process. allow perform bayesian mcmc inference compute posteriors importance public health planning. posteriors methods similar showing accurate. posteriors show good convergence true parameter values—this indicates algorithm based upon bayesian markov chain monte carlo framework order estimate joint posterior distribution parameters particular metropolis-hastings algorithm mcmc single-component metropolishastings algorithm. algorithm various stages epidemic order show posterior distributions converge households become infected; inference simulation households become infected. simulation stage epidemic mcmc samples obtained burn-in iterations. mcmc simulation stage epidemic proposal distribution. mcmc implemented proposing moves probabilities respectively. results displayed terms maximum posteriori estimates model parameters estimates epidemiological parameters joint posterior density estimates kernel densities estimated using freely available matlab packages kde.m akde.m figures show great deal similarity approximate exact results mild noticeable difference posterior distributions figure particularly households infected. particular appears results overestimate compared mcmc results earliest stages epidemic. figure observe estimates begin negatively biased parameters converge towards true parameter values data obtained. parameters variability estimates appear decrease data obtained. appears estimates method slightly positively negatively biased respectively. noted plots make correlation structure parameters unclear; presented dimension parameter space makes correlation structure difﬁcult display. figure observe estimated little bias mcmc method slightly positively biased method. variance estimates figures decrease households become infected. posterior density estimates single simulation displayed figure shows using combination numerical techniques; particular matrix exponential methods well stochastic simulations numerical convolutions method appropriate task relatively efﬁcient. example simulation calculate distribution programmed efﬁciently conditioning involved generated realisations used. still method relatively expensive larger data sets room improvement many aspects procedure. particular attempt made parallelise part algorithm. would relatively trivial calculations independent hence would provide large speedup. example simulations calculate expectation calculations within household could parallelised. black also used tree data structure minimise number operations needed calculate within-household likelihood. similar approach could taken minimise cost expectation calculations well casting explicit path integrals typically solved efﬁciently another aspect algorithm tuned time step used numerical integrations. decreasing result faster running time larger error ﬁnal posteriors. mcmc algorithm parallelisable efforts could made optimise move proposal density proposals informed model number extensions could made quite easily methodology. exposed period added model changes processes somehouseholds longer observed time ﬁrst infection ﬁrst individual becomes infectious thus would need track distribution exposed infectious households. aspect becomes easier method addition exposed period longer chains household infections become less likely given day. exposed period sufﬁciently long high enough probability approximate distribution newly exposed households single generation. efﬁciency mcmc method likely scale much worse seir model much missing information sample. another extension would incorporation realistic distribution household sizes within population. expectation calculations would essentially remain same proportions size household would need taken account betweenalgorithm respectively. map’s calculated dimensional kernel density estimates. pairs boxes left right map’s inference based upon data infected households. black dotted lines indicate true parameter values study data highly informative despite amount missing information. particular posterior densities exhibit little variability households become infectious. compared efﬁciency methods found mcmc superior data infected households however poor scaling properties mcmc preferred data infected households. however introduce slight positive bias estimates noted computation time presented results simulations single parameter set. ﬁrst study aware estimate quantities using early epidemic data bayesian framework. another analyse stochastic household model cast multi-type branching process theory well developed hence write equations many quantities need order calculate likelihood actually solving inefﬁcient practical inference likelihood calculation embedded mcmc scheme hence needs repeated many times. indeed equations probability generating function full branching process simply stated solution involves multi-dimensional inversion such approach taken factor likelihood nonstandard using small number well motivated assumptions. factorisation allows calculate parts fig. contour plots joint posterior density single simulation. bottom panels results iterations iterations mcmc algorithm respectively. panels left right posteriors inference based upon data infected households. intersection black dotted lines indicate true parameter values achieved. previous work made perfect detection assumption instead assumed probability case detection many aspects work could extended incorporate partial detection largest challenge modelling distribution currently unobserved households contribute overall force infection. convolution approach appropriate here especially given fast using modern hardware topic research. also becomes challenging mcmc approach missing data high dimensional samples parameter space corresponding observation probabilities. acknowledgements acknowledges support provided michael heather dunne scholarship applied mathematics. acknowledges support supported decra authors also acknowledge support centre excellence mathematical statistical frontiers australian government nhmrc centre research excellence policy relevant infectious diseases simulation mathematical modelling", "year": "2016"}