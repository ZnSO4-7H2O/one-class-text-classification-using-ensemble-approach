{"title": "On the Shapley value of unrooted phylogenetic trees", "tag": "q-bio", "abstract": " The Shapley value, a solution concept from cooperative game theory, has recently been considered for both unrooted and rooted phylogenetic trees. Here, we focus on the Shapley value of unrooted trees and first revisit the so-called split counts of a phylogenetic tree and the Shapley transformation matrix that allows for the calculation of the Shapley value from the edge lengths of a tree. We show that non-isomorphic trees may have permutation-equivalent Shapley transformation matrices and permutation-equivalent null spaces. This implies that estimating the split counts associated with a tree or the Shapley values of its leaves does not suffice to reconstruct the correct tree topology. We then turn to the use of the Shapley value as a prioritization criterion in biodiversity conservation and compare it to a greedy solution concept. Here, we show that for certain phylogenetic trees, the Shapley value may fail as a prioritization criterion, meaning that the diversity spanned by the top $k$ species (ranked by their Shapley values) cannot approximate the total diversity of all $n$ species. ", "text": "abstract shapley value solution concept cooperative game theory recently considered unrooted rooted phylogenetic trees. here focus shapley value unrooted trees ﬁrst revisit so-called split counts phylogenetic tree shapley transformation matrix allows calculation shapley value edge lengths tree. show non-isomorphic trees permutation-equivalent shapley transformation matrices permutation-equivalent null spaces. implies estimating split counts associated tree shapley values leaves sufﬁce reconstruct correct tree topology. turn shapley value prioritization criterion biodiversity conservation compare greedy solution concept. here show certain phylogenetic trees shapley value fail prioritization criterion meaning diversity spanned species cannot approximate total diversity species. keywords phylogenetic tree shapley value shapley transformation noah’s problem shapley value phylogenetic trees frequently discussed prioritization tool biodiversity conservation. ﬁrst introduced haake unrooted phylogenetic trees also considered rooted phylogenetic trees fuchs wicke fischer here focus unrooted phylogenetic trees answer questions posed haake hand consider relationship tree topology so-called split counts tree shapley value. particular show non-isomorphic trees permutation-equivalent shapley transformation matrices consequence identical wicke institute mathematics computer science ernst-moritz-arndt university greifswald germany e-mail kristina.wickeuni-greifswald.de fischer institute mathematics computer science ernst-moritz-arndt university greifswald germany e-mail emailmareikeﬁscher.de hand consider shapley value ranking criterion so-called noah’s problem compare greedy solution concept show shapley value perform badly prioritization criterion certain class phylogenetic trees. fact show diversity shapley species approximate total diversity species total diversity well captured greedy species paper organized follows. introducing basic deﬁnitions notations turn shapley transformation matrix phylogenetic tree recall known results. show non-isomorphic trees permutation-equivalent shapley transformation matrices. conclude paper considering shapley value prioritization criterion noah’s problem preliminaries tree nodes edges leaves nodes degree taxa bijective mapping taxa leaves called phylogenetic x-tree treeshape/topology internal nodes degree call binary phylogenetic x-tree. without loss generality assume denote number leaves tree. write also mean number leaves tree. biology often rooted phylogenetic trees designated root node considered mostly concerned unrooted phylogenetic trees. note throughout paper always mean unrooted binary phylogenetic trees refer trees unless stated otherwise. moreover assume edges tree positive edge lengths assigned denote length edge given weighted unrooted phylogenetic tree subset taxa phylogenetic diversity deﬁned edge lengths smallest spanning tree connects taxa following consider phylogenetic tree game introduced haake cooperative game associated phylogenetic tree. recall game theory cooperative game pair consisting players characteristic function assigns real number every coalition players. given phylogenetic tree deﬁne phylogenetic tree game pair consisting species phylogenetic diversity measure assigns real value subsets species important solution concept cooperative game theory so-called shapley value also used context phylogenetic tree games. given phylogenetic tree game shapley value vector deﬁned denotes subset species containing taxon biologically shapley value given species interpreted average contribution species overall phylogenetic diversity thus suggested prioritization criterion biodiversity conservation note shapley value phylogenetic tree game linear function edge weights tree. linear transformation called shapley transformation haake main focus following section. following notation haake refer weights edges incident leaves leaf weights weights internal edges internal edge weights. recall unrooted binary phylogenetic tree taxa precisely edges whereof edges internal edges deﬁne shapley transformation matrix follows deﬁnition phylogenetic x-tree leaf associated leaf weights internal edges associated internal edge weights αin−. vector consisting edge weights order deﬁne matrix corresponds equation therefore represents shapley transformation shapley value game deﬁnition phylogenetic x-tree leaf edge leaf edge removal splits subtrees. denote leaves subtree contains denote leaves subtree call split counts associated leaf edge note example consider leaf edge phylogenetic tree depicted figure thus moreover following haake call trees isomorphic bijection edges maps tree preserves topological structure tree. note taking account treeshape topology labeling leaves i.e. example regard depicted figure isomorphic topology. still depict different evolutionary relationships species call matrices permutation-equivalent differ permutation rows permutation columns i.e. matrices rm×n permutationequivalent exists permutation matrix rm×m permutation matrix rn×n theorem isomorphic trees induce permutation-equivalent shapley transformation matrices permutation-equivalent null spaces. hence trees shapley transformation matrices null spaces permutationequivalent must isomorphic. theorem follows fact split counts tree depend topological structure tree. precise isomorphic trees induce shapley transformation matrix permutation rows permutation columns note means isomorphic trees also induce permutation-equivalent null spaces null space affected permuting rows permutation columns induces permutation coordinates null space following present main result. show non-isomorphic trees i.e. trees different topology induce permutation-equivalent shapley transformation matrices permutation-equivalent null spaces. implies negate second question. also negate second part ﬁrst question results show split counts sufﬁcient determine topology tree. theorem trees permutation-equivalent shapley transformation matrices permutation-equivalent null spaces necessarily isomorphic. proof consider trees depicted figure clearly isomorphic different topologies. however leaf edge trees exhibit split counts. thus induce permutation-equivalent shapley transformation matrices permutation-equivalent null spaces. note case shapley transformation matrices null spaces permutation-equivalent fact identical. remark pair figure smallest example pair non-isomorphic trees inducing permutation-equivalent shapley transformation matrices permutationequivalent null spaces veriﬁed exhaustive search analysis tree topologies fewer leaves split counts. note also taken account labeling leaves tree topology deﬁning isomorphism trees i.e. regarded isomorphic non-isomorphic would smallest example clearly induce permutation-equivalent shapley transformation matrices permutation-equivalent null spaces remark setting tatc so-called rooted caterpillar tree four leaves tbtd fully balanced tree four leaves coincide depicted figure used proof theorem proof denotes leaf {abcd} different shape different shape. note implies clearly isomorphic since tatb tctd different shapes. order show induce permutation-equivalent shapley transformation matrices permutation-equivalent null spaces show exhibit split counts leaf edge here distinguish different cases leaf edge part subtree. denote leaf {abcd}. exemplarily assume induces split without loss generality leaves still connected rest respectively cases leaf however holds induced tbtc leaf edge part different subtrees. again denote leaf {abcd}. exemplarily assume leaf edge induces split without loss generality leaves still connected rest consider edges depicted figure denote leaf induces split a|bcd induces split b|acd forth. exemplarily consider distinguish cases leaf +|c| +|d|. leaf +|c| +|d| |a|. again holds thus split counts induced leaf edge same. consider edge again denote leaf induces split ad|bc. recall thus cases split counts induced edge leaf coincide since exhibit split counts leaf edge induce permutation-equivalent shapley transformation matrices permutation equivalent null spaces. note theorems show determining estimating split counts data cannot assist determining correct tree topology nonisomorphic trees exhibit identical split counts. neither estimating shapley value data assist determining correct tree topology non-isomorphic trees also identical shapley values. consider example depicted figure edge lengths one. since permutation-equivalent shapley transformation matrices shapley values leaves coincide. turn application shapley value phylogenetic trees namely criterion prioritizing species nature conservation. particular consider simple variant so-called noah’s problem compare shapley value greedy approach introduced steel precise look subset given size maximal score. words given phylogenetic x-tree look maximum-weight subtree leaves. steel showed greedy algorithm solve problem. theorem consists precisely subsets size built follows select pair species maximally apart sequentially elements maximize step increase score. following show certain trees diversity species tends zero diversity species tends inﬁnity. thus species cannot approximate total diversity species. species diversity tends zero diversity species tends inﬁnity. proof depicted figure leaf leaf species following show k+k− species leaves note rooted phylogenetic tree leaves rooted phylogenetic tree leaves. thus edges edges thus diversity spanned leaves calculates develop bounds k+k− recall shapley value phylogenetic tree game calculated multiplying shapley transformation matrix vector edge tree entry shapley transformation matrix given lengths call split factor following develop lower bound considering bounds denote edge connecting derive following lower bound here edge leaf separates edge leaf separates leaves thus conversely edge leaf separates leaves leaves thus compare lower bound upper bound using mathematica solved inequality remark note following greedy approach theorem would ﬁrst select sequentially pair species leaves maximize increase score. recall diversity species given paper considered shapley value unrooted phylogenetic trees answered questions posed haake firstly revisited linear transformation allows calculation shapley value edge lengths trees shown non-isomorphic trees permutation-equivalent shapley transformation matrices permutation-equivalent null spaces. implies neither estimating determining so-called split counts associated tree shapley values leaves sufﬁce reconstruct correct tree topology. note deciding whether non-isomorphic trees permutation-equivalent shapley transformation matrices hard problem related socalled graph isomorphism problem whose complexity known. given ﬁnite graphs graph isomorphism problem asks whether isomorphic. incidence matrix incidence matrix vertex edge incident otherwise isomorphic incidence matrices permutation-equivalent i.e. exists permutation matrix rn×n permutation matrix rm×m even though shapley transformation matrices incidence matrices problem deciding whether permutation-equivalent related problem deciding whether incidence matrices permutation-equivalent thus problem related graph isomorphism problem. direction future research could therefore analyze relationship graph isomorphism problem question whether shapley transformation matrices permutation-equivalent. would also interest assess complexity deciding whether shapley transformation matrices permutation-equivalent not. another direction research could shapley value conservation criterion preservation. manuscript considered application shapley value prioritization criterion simple variant noah’s problem compared greedy algorithm turned shapley value perform badly prioritization criterion meaning diversity species approximate total diversity species all. thus case using shapley value order subset species size maximizes score cannot compete greedy algorithm introduced steel note however class trees diversity species tends zero diversity species tends inﬁnity works less half number species. would interest whether similar construction found order show shapley value fail prioritization criterion would also interest better performance shapley value guaranteed turning unrooted rooted phylogenetic trees. acknowledgements ﬁrst author thanks ernst-moritz-arndt-university greifswald landesgraduiertenförderung studentship work conducted barcelona graduate school mathematics ﬁnancial support attending algebraic combinatorial phylogenetics program barcelona june results presented manuscript obtained.", "year": "2017"}