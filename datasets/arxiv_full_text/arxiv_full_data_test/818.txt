{"title": "Constraint-free Natural Image Reconstruction from fMRI Signals Based on  Convolutional Neural Network", "tag": "q-bio", "abstract": " In recent years, research on decoding brain activity based on functional magnetic resonance imaging (fMRI) has made remarkable achievements. However, constraint-free natural image reconstruction from brain activity is still a challenge. The existing methods simplified the problem by using semantic prior information or just reconstructing simple images such as letters and digitals. Without semantic prior information, we present a novel method to reconstruct nature images from fMRI signals of human visual cortex based on the computation model of convolutional neural network (CNN). Firstly, we extracted the units output of viewed natural images in each layer of a pre-trained CNN as CNN features. Secondly, we transformed image reconstruction from fMRI signals into the problem of CNN feature visualizations by training a sparse linear regression to map from the fMRI patterns to CNN features. By iteratively optimization to find the matched image, whose CNN unit features become most similar to those predicted from the brain activity, we finally achieved the promising results for the challenging constraint-free natural image reconstruction. As there was no use of semantic prior information of the stimuli when training decoding model, any category of images (not constraint by the training set) could be reconstructed theoretically. We found that the reconstructed images resembled the natural stimuli, especially in position and shape. The experimental results suggest that hierarchical visual features can effectively express the visual perception process of human brain. ", "text": "recent years research decoding brain activity based functional magnetic resonance imaging made remarkable achievements. however constraint-free natural image reconstruction brain activity remains challenge specifying brain activity possible images impractical. existing research simplified problem using semantic prior information reconstructing simple images including letters digitals. without semantic prior information present novel method reconstruct natural images fmri signals human visual cortex based computation model convolutional neural network first extracted unit output viewed natural images layer pre-trained features. second transformed image reconstruction fmri signals problem feature visualization training sparse linear regression fmri patterns features. iteratively optimization find matched image whose unit features become similar predicted brain activity finally achieved promising results challenging constraint-free natural image reconstruction. semantic prior information stimuli used training decoding model category images could reconstructed theoretically. found reconstructed images resembled natural stimuli especially position shape. experimental results suggest hierarchical visual features effectively express visual perception process human brain. functional magnetic resonance imaging become effective tool decoding brain activity especially visual decoding. large number studies implemented classification stimulus categories memories imagination even dreams multi-voxel pattern analysis precisely encoding model built identify stimulus studies focused visual image reconstruction. goal reconstruction produce literal picture stimulus image. visual image reconstruction challenging problem needs much decoded information classification identification especially natural images containing infinitely variable complex information. simplify problem stimulus image reconstruction studies focused reconstruction simple images. thirion first implemented image reconstruction based fmri. estimated response model voxel retinotopic mapping experiment reconstructed simple images composed quickly rotating gabor filters passive viewing experiment imagery experiment subject. miyawaki realized reconstruction simple letters graphics solving linear mapping model voxels visual cortex pixel image. schoenmakers introduced idea sparse learning forward linear gauss model reconstruct handwritten english letter brains fmri signals visual cortex. improved results letter reconstruction introducing gauss hybrid model yargholi used gauss network reconstruct nine digital handwritten numerals like problem classification essence. naselaris first implemented reconstruction natural images using priori information combination structural coding semantic coding models. however essentially image recognition problem limited natural image library. basis realized reconstruction video image reconstruction frame frame time deep neural network become focus scholars recent years strong capability feature representation. deep learning achieved breakthrough image detection/classification speech recognition natural language processing research applied fmri visual decoding agrawal first encoded fmri signals using features extracted images convolutional neural network güçlü used tuned object categorization probe neural responses naturalistic stimuli. result showed explicit gradient feature complexity existed ventral dorsal visual pathways human brain. cichy compared temporal spatial brain visual representations representations tuned statistics real-world visual recognition. results showed captured stages human visual processing time space early visual areas toward ventral dorsal streams. horikawa proposed generic decoding model based hierarchical visual features generated dnn. found hierarchical visual features could predicted fmri patterns used identify seen/imagined object categories computed features numerous object images. furthermore found features decoded dream fmri data strong positive correlation intermediate advanced layer features dreamed objects achieved better performance simple images reconstruction deep generation networks method still problems natural image reconstruction. using convolution kernels first layer implemented reconstruction dynamic video frame frame. however results still natural images although position information restored well. word studies suggested could help providing detailed interpretation human brain visual information. constraint-free natural images reconstructed well efficient feature representation dnn. recently mahendran proposed method input image generation layer feature. inspired research paper presents novel visual image reconstruction method natural images based fmri training decoders predict features natural stimuli fmri activity patterns transformed image reconstruction fmri signals problem feature visualization. then iteratively optimization performed find matched image whose unit features became similar predicted brain activity. finally matched image taken reconstruction result brain activity. figure main process visual image reconstruction. subject seeing natural stimuli fmri responses acquired scanner. then features natural stimuli predicted decoder trained training set. predicted features visualized iteratively optimization find matched image whose unit features became similar predicted brain activity. finally matched image taken reconstruction result brain activity. data used paper downloaded online data sharing database data consisted blood-oxygen level dependent activities human subjects acquired using inova scanner eighteen coronal slices acquired covering occipital cortex fmri data acquired using gradientecho pulse sequence randomly selected database. subjects fixated central white square stimuli flashed intervals followed gray background successive trials. validation phase subjects viewed novel natural images presented training phase. training image repeated times test image repeated times. five sessions data collected subjects presented natural images. training test data collected scan sessions. first functional images manually co-registered correct differences head positioning across different sessions. then automated motion correction slice timing applied data acquired within session software. used deep closely reproduced network krizhevsky extract hierarchical visual features stimuli. table details structure caffe–alex model. many similar networks alternately following computational building blocks linear convolution rectified linear unit gating spatial max-pooling group normalization. trained achieve best performance object recognition large scale visual recognition challenge model succinctly divided eight layers first five convolutional layers last three layers fully connected object classification convolutional layer composed following four stages linear convolution relu gating spatial maxpooling group normalization. classification layers fully connected networks rectified linear threshold layer uses softmax function output vector probabilities input image belongs individual categories. image inputted output layer extracted form image hierarchy features. dimensions layer features shown table used matconvnet toolbox implementing cnns. using training images estimated multivariate regression models predict feature maps layers based distributed cortical fmri signals. layer linear model defined distributed fmri signals output features artificial neurons cnn. specific feature particular layer expressed where stands features training images m-by- matrix stands observed fmri signals within visual cortex number training images. m-by- matrix number training images number voxels. constant vector elements equal unknown weighting vector last column solve. -by- matrix. number training samples less number voxels visual field problem actually solution ill-posed equation unique solution found. addition several theoretical studies suggest sparse coding scheme used represent natural images primary visual cortex means small number active neurons special stimulus. contrast small number visual stimuli make neuron active. proxy neural activities expecting responses neurons also reflect sparse property reasonable. thus sparse line visual characteristics. based assumption major problem constructing solve sparse representation problem. traditional sparse recovery formulated general np-hard problem follows approximate solutions could used solve problem. transforming np-hard optimization problem optimization problem. donoho showed measurement matrix l-minimization method provides uniform guarantees sparse recovery. measurement matrix satisfies restricted isometry property condition works correctly sparse signals. paper used yall solve optimization problem. alternate approach sparse recovery problem greedy algorithm. greedy algorithms quite fast computing support sparse signal iteratively although lacks strong guarantees l-minimization provides. considering decoding model must estimated feature approximation method fast enough simple decrease time cost. therefore focused greedy algorithms investigate sparseness decoding model. paper selected regularized orthogonal matching pursuit solve decoding model. finally compared yall romp selected romp solution decoding model. recent study mahendran proposed method reconstruct original images features gradient descent optimization better understand deep image representations. paper used method reconstruct image decoded features. provided used experiments) range image encouraged stay within target interval instead diverging. second richer regularizer total variation encouraging images stay within target interval instead diverging consist piece-wise constant patches. addition extended gradient descent used momentum solve effectively. quantify well voxel responses predicted features defined feature prediction accuracy pearson’s correlation coefficient actual predicted feature values test set. achieve better image reconstruction performance decoded features layer image reconstruction similar features extracted actual natural image possible. layer features mean used express prediction accuracy. solve precisely achieve better image reconstruction compared romp yall prediction accuracy. moreover compared prediction accuracy different layers find suitable layer decode fmri signals reconstruct original image from. finally considering prediction accuracy layer characteristics image reconstruction method selected pool layer image representation reconstruct original image voxel response. given sparsity decoding model decoding process included voxel selection. decoding fmri signals features layer selected frequently utilized voxels significant voxels defined contribution visual area proportions visual area significant voxels. analyzing segmentation significant voxels hierarchical structure similarity visual cortex also verified. used weighted complex wavelet structural similarity metric assess accuracy reconstructions metric used coefficients complex wavelet decomposition images compute single number described degree structural similarity images. figure prediction accuracy pool layer features decoded fmri data feature prediction accuracy defined pearson’s correlation coefficient actual predicted feature values test set. average prediction accuracy romp significantly higher yall t-statistics significance level romp yall used solve decoded model prediction accuracy pool layer features decoded fmri data shown figure average prediction accuracy romp reached significantly higher yall t-statistics significance level finding might indicate romp better reflected sparsity visual perception. furthermore romp much faster yall particularly important tens thousands features. conclusion finally selected romp decoding model solution. calculated prediction accuracy layers based frmi data shown figure higher prediction accuracy obtained pool conv conv conv conv layers whereas prediction accuracy conv relu relu relu relu relu relu relu layers possibly relu function reduced predictability linear decoding model. intuitively image reconstruction performed better utilized features layer higher prediction accuracy image representations. however prediction accuracy reconstruction method used paper better accuracy rate lower layer distortion generated back propagating higher layer features. thus finally selected pool layer image representation reconstruct original image voxel response. figure prediction accuracy layers cnn. show prediction accuracy layers based fmri signals respectively. prediction accuracy levels significantly higher chance prediction accuracy levels pool conv figure visual area assignments significant voxels. show result respectively. total numbers voxels subject voxels highest frequency selected decoding layer feature served significant voxels. visual area assignments significant voxels across layers shown figure results showed assignments significant voxels decreasing trend layer whereas assignments significant voxels increasing trend subjects. significant voxels assigned shallow convolutional layers located early visual areas whereas significant voxels assigned deep convolutional layers located downstream visual areas. know hierarchically organized feature complexity. thus findings provided quantitative evidence thesis visual ventral stream hierarchically organized downstream areas processing increasingly complex features retinal input. image reconstruction implemented test based pool features decoded voxel responses using decoding model trained training set. part original images test corresponding reconstructed images shown figure reconstructed images found clearly capture position shape even texture information object original image case stimuli grayscale. moreover found reconstructed images reproduced foreground objects well less sensitive perceptually less salient objects backgrounds. extent finding showed visual perception brain measured fmri selective image understanding might main reason reconstruction images tended regenerate image parts relevant visual perception. addition accuracy reconstructions assessed cwssim average accuracy reconstructions reached respectively. addition significantly accurate chance computers judge accuracy reconstructions assessed cwssim consistent judgment humans. studies linear model selected paper decode fmri signals features. complex model inspired visual mechanism able improve decoding effect including gabor wavelet pyramid model predict responses voxels early visual areas. compared romp yall select better solve decoding model found sparsity good feature solving algorithms. however compared typical algorithms classes sparse optimization methods. thus better algorithms need explored improve decoding accuracy. existing studies mostly analyzed relationship response visual voxels hierarchical features five convolutional layers three fully connected layers. paper decoding accuracy layers analyzed interesting phenomena discovered found. example prediction accuracy convolutional fully connected layers relatively higher might reason studies analyzed them. found prediction accuracy conv layer next layer pool higher. reason might fmri signals like pool reflected responses group nerve cells rather single nerve cell thus constrained decode fmri signals lowest level sophisticated features first layer cnn. moreover layer features relu relatively prediction accuracy. know relu function originally approximate simulation activation model brain neurons faster better training deeper network model. phenomenon lead characteristics relu layer deviating visual perception process human brain findings based fmri useful improvement cnn. recently several research found similarity visual pathway visual encoding decoding findings verified carefully paper analysis contribution visual area decoding fmri signals layer features another point view cases final process image reconstruction obtained better reconstruction performance inverting pool layer feature decoded fmri signals although prediction accuracy pool highest. tried reconstruct images based high-level layer higher accuracy work well probably ultimate goal identify target images. thus higher layer features contained semantic information less lowlevel features images. case larger distortion reconstructed images inverting higher layer features even features extracted directly original image case similar prediction accuracy better reconstruction could implemented based pool layer could also lead recovered information almost low-level information location edge texture achieve better image reconstruction performance fusion method based multi-layer features rather single-layer features encouraged. details image recovered better using low-level layers whereas semantics image guaranteed high-level features. paper presents novel method reconstructing constraint-free natural images fmri signals based cnn. different direct reconstruction fmri signals transferred understanding brain activity understanding feature representation training mapping fmri signals hierarchical features extracted cnn. thus image reconstruction fmri signals became problem feature visualization. iteratively optimizing find matched image finally achieved promising results challenging constraint-free natural image reconstruction. furthermore homology human machine visions validated based experimental results. semantic prior information stimuli used training decoding model category images could reconstructed theoretically based pre-trained massive samples imagenet. achieve better image reconstruction performance colorful images videos multi-layer features representing different levels image features taken account. t.m. mitchell s.v. shinkareva carlson k.-m. chang v.l. malave r.a. mason m.a. just predicting human brain activity associated meanings nouns science a.g. huth nishimoto a.t. j.l. gallant continuous semantic space describes representation thousands object action categories across human brain neuron zafar a.s. malik kamel s.c. dass j.m. abdullah reza a.h.a. karim decoding visual information human brain activity review fmri studies journal integrative neuroscience thirion duchesnay hubbard dubois j.-b. poline lebihan dehaene inverse retinotopy inferring visual content images brain activation patterns neuroimage miyawaki uchida yamashita m.-a. sato morito h.c. tanabe sadato kamitani visual image reconstruction human brain activity using combination multiscale local image decoders neuron schoenmakers gerven heskes gaussian mixture models improve fmri-based image reconstruction pattern recognition neuroimaging international workshop schoenmakers güçlü gerven heskes gaussian mixture models semantic gating improve reconstructions human brain activity frontiers computational neuroscience yargholi g.-a. hossein-zadeh brain decoding-classification hand written digits fmri data employing bayesian networks frontiers human neuroscience yargholi g.-a. hossein-zadeh reconstruction digit images human brain fmri activity connectivity informed bayesian networks journal neuroscience methods deng j.-t. huang seide seltzer zweig williams recent advances deep learning speech research microsoft acoustics speech signal processing ieee international conference blunsom grefenstette kalchbrenner convolutional neural network modelling sentences proceedings annual meeting association computational linguistics). r.m. cichy khosla pantazis torralba oliva comparison deep neural networks spatio-temporal cortical dynamics human visual object recognition reveals hierarchical correspondence scientific reports horikawa kamitani hierarchical neural representation dreamed objects revealed brain decoding deep neural network features frontiers computational neuroscience shelhamer donahue karayev long girshick guadarrama darrell caffe convolutional architecture fast feature embedding proceedings international conference multimedia d.d. r.l. savoy functional magnetic resonance imaging brain reading detecting classifying distributed patterns fmri activity human visual cortex neuroimage needell vershynin signal recovery incomplete inaccurate measurements regularized orthogonal matching pursuit ieee journal selected topics signal processing needell vershynin uniform uncertainty principle signal recovery regularized orthogonal matching pursuit foundations computational mathematics a.c. brooks zhao t.n. pappas structural similarity quality metrics coding context exploring space realistic distortions ieee transactions image processing n.t. markov vezoli chameau falchier quilodran huissoud lamy misery giroud ullman barone dehay knoblauch kennedy anatomy hierarchy feedforward feedback pathways macaque visual cortex comp neurol d.l. yamins hong c.f. cadieu e.a. solomon seibert j.j. dicarlo performanceoptimized hierarchical models predict neural responses higher visual cortex proceedings national academy sciences s.-m. khaligh-razavi henriksson kriegeskorte fixed versus mixed explaining visual representations fixed mixed feature sets shallow deep computational models biorxiv", "year": "2018"}