{"title": "QuickProbs 2: towards rapid construction of high-quality alignments of  large protein families", "tag": "q-bio", "abstract": " Increasing size of sequence databases caused by the development of high throughput sequencing, poses multiple alignment algorithms to face one of the greatest challenges yet. As we show, well-established techniques employed for increasing alignment quality, i.e., refinement and consistency, are ineffective when large protein families are of interest. We present QuickProbs 2, an algorithm for multiple sequence alignment. Based on probabilistic models, equipped with novel column-oriented refinement and selective consistency, it offers outstanding accuracy. When analysing hundreds of sequences, QuickProbs 2 is significantly better than Clustal Omega, the previous leader for processing numerous protein families. In the case of smaller sets, for which consistency-based methods are the best performing, QuickProbs 2 is also superior to the competitors. Due to computational scalability of selective consistency and utilisation of massively parallel architectures, presented algorithm is comparable to Clustal Omega in terms of execution time, and orders of magnitude faster than full consistency approaches, like MSAProbs or PicXAA. All these make QuickProbs 2 a useful tool for aligning families ranging from few, to hundreds of proteins. QuickProbs 2 is available at https://github.com/refresh-bio/QuickProbs. ", "text": "increasing size sequence databases caused development high throughput sequencing poses multiple alignment algorithms face greatest challenges yet. show well-established techniques employed increasing alignment quality i.e. reﬁnement consistency ineffective large protein families interest. present quickprobs algorithm multiple sequence alignment. based probabilistic models equipped novel columnoriented reﬁnement selective consistency offers outstanding accuracy. analysing hundreds sequences quickprobs signiﬁcantly better clustalω previous leader processing numerous protein families. case smaller sets consistency-based methods best performing quickprobs also superior competitors. computational scalability selective consistency utilisation massively parallel architectures presented algorithm comparable clustalω terms execution time orders magnitude faster full consistency approaches like msaprobs picxaa. make quickprobs useful tool aligning families ranging hundreds proteins. quickprobs available https//github.com/refresh-bio/quickprobs. introduction multiple sequence alignment crucial importance life sciences. ability reveal evolutionary structural relationships sequences makes basic tool number biological analyses including phylogeny structure prediction gene ﬁnding many others. rapid dissemination high throughput sequencing technologies causes sequence databases grow exponentially. face this development alignment algorithms able process thousands sequences reasonable time required. among many proposed heuristics ﬁnding multiple sequence alignments progressive scheme become popular. consists three steps estimating evolutionary distances sequences building guide tree based distances greedy alignment sequences order described tree. classic representative progressive aligners thousand citations clustalw. greatest disadvantage progressive algorithms propagation mistakes bottom levels guide tree ﬁnal result. techniques introduced counter issue. historically ﬁrst approach errors made progressive stage iteratively reﬁning output alignment. idea successfully acquired number algorithms like mafft muscle msaprobs. different iteration scheme introduced clustalω combines recalculations guide tree proﬁle-hmm basis preliminary alignment. results superior accuracy large protein families. alternative facilitating progressive heuristics prevent mistakes alignment construction. achieved various ways. method employ information suboptimal alignments e.g. calculating posterior probabilities basis pair-hidden markov models partition function another incorporating knowledge pairwise alignments processing given pairs sequences/proﬁles. technique known consistency originally used t-coffee. consistency proven signiﬁcantly elevate alignment quality successfully acquired different variants number progressive non-progressive algorithms however substantial drawback consistency-based methods i.e. excessive computational complexity respect number sequences limits applicability families approximately hundred members. consequently algorithms allowing thousands sequences aligned like kalign kalign-lcs clustalω mafft parttree mode consistency. article give insight effect reﬁnement consistency progressive alignment. investigated large sequence sets showing accuracy aforementioned techniques scales unsatisfactorily number sequences. particular sets hundreds thousands sequences interest existing reﬁnement variants little effect alignment quality consistency decreases introducing noise relevant information. present ideas overcome issues. i.e. column-oriented reﬁnement selective consistency. research based quickprobs algorithm successor msaprobs–one accurate multiple sequence aligners. thanks utilisation massively parallel architectures quickprobs order magnitude faster msaprobs preserving quality results. introduce quickprobs signiﬁcant improvement predecessor. column-oriented reﬁnement converges alignments higher quality existing methods selective consistency incorporates relevant information pairwise alignments effectively reducing number mistakes progressive scheme also large sets sequences. moreover selectivity decreases dramatically computational effort needed consistency. this together optimised implementation allows quickprobs produce alignments superior forerunner fraction time. result presented algorithm accurate aligner investigating protein families ranging hundreds sequences. facilities like nucleotide mode bulk processing extend quickprobs usability. methods paper introduce quickprobs novel algorithm multiple sequence alignment. consists four stages calculation posterior probability matrices construction guide tree consistency transformation construction ﬁnal alignment followed iterative reﬁnement. posterior probability matrices calculated sequence pairs basis hidden markov model partition function. matrices employed establish maximum expected accuracy alignments. alignment scores used estimate pairwise distances given input weighted upgma algorithm guide tree construction. order incorporate information pairwise alignments aligning given pairs sequences/proﬁles posterior matrices relaxed sequences consistency transformation. then proteins progressively aligned guide tree order relaxed posterior matrices. followed iterative reﬁnement. important advances respect existing methods achieved stages quickprobs equipped novel column-oriented reﬁnement selective consistency described elaborately following subsections. separate subsection concerns algorithmic improvements facilities introduced presented algorithm. finally describe detail benchmark datasets measures used quality assessment. column-oriented reﬁnement reﬁnement designed overcome important disadvantage progressive algorithms–misalignments caused propagation errors early progressive steps guide tree. usually procedure employs iterative scheme alternate splits realignments incorporates objective function results evaluation. number reﬁnement strategies investigated literature.– amongst random tree-guided approaches become common algorithms. first revision quickprobs similarly probcons msaprobs employs former idea reﬁnement iteration splits alignment randomly horizontal proﬁles realigns removing columns containing gaps. objective function incorporated. substantial drawback procedure larger number sequences smaller chance producing proﬁles gap-only columns. result columns removed majority cases realigned proﬁle likely input one. therefore numerous sets consecutive random reﬁnements give improvement accuracy. alternative approach incorporated e.g. muscle mafft tree-guided reﬁnement. splits alignment breaking randomly selected branch guide tree. gap-only columns likely occur gathering phylogenetically related sequences subproﬁles approach potentially successful large protein families interest. result reﬁnement iteration least proﬁle shortened increasing signiﬁcantly chance rearranging alignment producing higher quality outcome. type reﬁnement referred column-oriented reﬁnement experiments show superior random tree-guided approaches especially large sequence sets. figure presents application column-oriented reﬁnement example alignment. important observation number gaps column according alignment divided affects sizes resulting proﬁles. closer half sequence size balanced division. investigate effect imbalance proﬁle splitting alignment quality columns sorted respect fraction beginning considered random selection reﬁnement often facilitated introducing objective function. usage unsupervised score assumed substitution matrix penalty model amongst popular. nevertheless maximising unsupervised score necessarily converge figure iteration column-oriented reﬁnement candidate columns randomly selected splitter alignment divided proﬁles according presence gaps selected column; gap-only columns removed followed proﬁle realignment. biologically meaningful alignments particularly consistency algorithms. research suggest alignment length used straightforward effective measure reﬁnement supervision. intuitively misalignments consecutive progressive steps accumulate causing blocks conserved symbols shifted respect other. result expect erroneous alignments longer correctly identifying evolution sequences. hypothesis supported observation average alignment length declines quality increases consecutive reﬁnement iterations. therefore introduced reﬁnement acceptance criterion non-increasing alignment length increased convergence. selective consistency opposed reﬁnement consistency aims preventing misalignments introduced progressive scheme rather eliminating afterwards. reduce chance making errors consistency employs information pairwise alignments aligning pair particular sequences. even though approach successfully applied number progressive algorithms excessive computational cost limits applicability sets approximately hundred sequences. knowledge effect consistency larger sequence sets investigated literature. made exhaustive study scalability algorithms examining effect addition homologous sequences reference alignment accuracy. observed methods quality deteriorated sequences added. decay especially steep several consistency-based methods suggesting larger sets sequences noise exceeds relevant information. this however explicitly veriﬁed. quickprobs similarly predecessor consistency relies relaxation posterior probability matrices sequences. computational complexity sequence length makes stage time consuming. nevertheless quickprobs comes fast relaxation algorithm suited graphics processors able investigate effect consistency sets exceeding thousand sequences. presented experimental section procedure decreased alignment quality protein families sizes. challenge naturally arises apply consistency sequences carrying information. particularly examined whether correlation information content evolutionary relationship sequences involved consistency. purpose introduce selective consistency. given sequences distances posterior matrix relaxed sequence assumed function fulﬁlls given condition. research investigated different measures score-based distance calculated stage ranked normalised interval tree-guided distance deﬁned number nodes minimal subtree containing maximum minimum used examples function. selectivity applied either deterministically thresholding arbitrary value applying stochastic ﬁltering. ﬁlter function maps value probability performing consistency sequence shape determines sequences preferred consistency procedure thresholding tree-guided distances rendered superior results explain variant selectivity figure side effect selectivity variability number relaxations performed different posterior matrices. consequently larger number sequences undergoing consistency transformation weaker signal original compared matrices multiplied overcome this additionally analysed effect ampliﬁcation signal figure tree-guided selective consistency posterior matrix threshold triangles represent subtrees sequences node size subtree given. example selectivity procedure accepts relaxation time excludes sequence consistency alignment quality multiplying elements coefﬁcient hxy. value varies relaxations performed maximum number relaxations chosen selectivity settings done allows sets different sizes handled properly. algorithmic improvements spite focusing quickprobs research extending reﬁnement consistency stages calculation posterior matrices also subject modiﬁcations. quality improvements include replacing gonnet matrix partition function calculation vtml proven accurate. followed training partition function parameters i.e. penalties temperature balibase benchmark nomad algorithm optimisation non-smooth functions. another changes introduced order shorten execution time. include redesigning graphics processor calculations handle sequences length optimisation codes using efﬁcient memory allocation model. result posterior calculation stage quickprobs accurate predecessor time several times faster. quickprobs also equipped nucleotide mode hoxd substitution matrix evolutionary model used. accurate mode quickprobs adjusted sparsity coefﬁcient posterior matrices longer supported excessive computation time lack signiﬁcant inﬂuence results. different behaviour consistency depending size number transformations adjusted number sequences also discovered consistency transformations iterations reﬁnement instead default sufﬁcient satisfactory convergence. quickprobs employs opencl executed different massively parallel devices like nvidia gpus. moreover presented software also ability central processor without opencl. convenience quickprobs also equipped bulk mode allowing number sequence sets processed single run. necessity storing posterior matrices pairs sequences causes memory major limiting factor size. reason quickprobs gives opportunity analysis user-speciﬁed amount decreasing sparsity coefﬁcient posterior matrices. naturally adjustment affects quality possible within certain boundaries. accuracy assessment accuracy algorithms assessed several benchmark datasets come reference alignments. balibase prefab extended version oxbench sabmark homfam balifam. four former downloaded standardised fasta format robert edgar’s webpage consist small moderate sequence sets latter constructed enriching respectively homstrad balibase benchmarks full protein families pfam. number sequences balifam sets order homfam contains much larger families even members. benchmarks postprocessed removing duplicated sequences appear numerously generation protocol. motivated fact duplicates negatively affect accuracy analysed algorithms straightforwardly restored alignment ﬁnished. postprocessed balifam contained sets sequences average. major part research focuses scalability presented methods respect number sequences balifam recursively resampled obtain less numerous sets initial benchmark sets sequences sets finally elements level pyramid gathered forming sets referred balifam-x balifam-x balifam-x balifam-x. protocol property smaller sets contained larger ones preserves representativity problem sizes. homfam afetr duplicate removal sets randomly downsampled members guarantee preserving sequences present reference alignments. motivated fact original homfam sets large processed quickprobs memory requirements. sampled benchmark referred homfamk contained families sequences average. detailed histograms familiy sizes balifam homfamk presented supplementary figure quality evaluation performed well established metrics related reference alignments. supervised pairs total column scores deﬁned fraction correctly aligned symbol pairs columns respectively. single quality measure needed e.g. visualisation geometric mean aforementioned scores employed. separate charts measures given supplementary figures. reﬁnement initial experiments investigated random tree-guided reﬁnements together different variants novel column-oriented procedure. reﬁnement acquired alignment algorithms formerly consistency latter disabled experimental part. balifam-x benchmark selected representative large protein families instead balifam contains twice many sets reduces results variability. effect consecutive reﬁnement iterations presented figure scalability reﬁnement respect size iterations observed figure charts show numerous protein families balifam-x consecutive random reﬁnements gave improvement accuracy. moreover random procedure proﬁtable balibase starting balifam-x effect results. performance tree-guided reﬁnement noticeably better however also declined increasing number sequences. opposite situation case column-oriented reﬁnement. superior competing approaches also characterised perfect scalability. namely effectiveness raised balibase almost balifam conﬁrming selection gap-only columns choice large protein families. analysing effect split imbalance alignment quality visible bias towards less balanced columns caused accuracy decay. consequently version without preference chosen investigation. figure effect consistency iterations selected benchmarks. analysis consistency balifam-x effect distance-related ﬁltering selectivity variants closely related sequences weighting original posterior matrices coefﬁcient. alignment qualities charts measured reﬁnements. ﬁnal reﬁnement experiments concerned effect different acceptance rules. non-increasing alignment length non-decreasing entropy score. presented figure former improved reﬁnement convergence larger sequence sets slightly inferior unsupervised variant balibase. contrast entropy scoring performed unsatisfactorily analysed sets. result column-oriented reﬁnement length supervision selected quickprobs charts presenting inﬂuence reﬁnement measures separately found supplementary figure consistency another experimental part concerned analysis consistency. figure shows effect traditional consistency iterations selected benchmarks reﬁnements. smaller sets consistency introduced relevant information elevating result quality. nevertheless time interposed noise accumulated large sets sequences causing accuracy decay even ﬁrst iteration figure proves consistency harmful large benchmarks independently reﬁnement iteration. figure shows noise started exceed positive signal clearly selecting part sequences consistency potentially increase effectiveness procedure. investigate correlation information content evolutionary relationship sequences involved applied triangle stochastic ﬁlters expected acceptance rate low-pass mid-pass high-pass ﬁlters promoted consistency respectively closely mildly distantly related sequences. shapes ﬁlter functions presented supplementary figure distances calculated alignment scores stage ranked normalised used function. figure shows closely related sequences introduce information consistency thus preferred selection. besides stochastic ﬁltering deterministic selectivity based structure guide tree examined. consistency sequence performed maximum tree-based distances smaller assumed threshold comparison selectivity strategies demonstrates deterministic variant maximum function thresholded perform best. superior version without consistency independently reﬁnement iteration exception point no-consistency effect consistency proﬁtable paired reﬁnement observed smaller sets. gain deeper insight phenomenon detailed investigation interdependencies consistency reﬁnement required. next step analysed effect ampliﬁcation original signal multiplying elements coefﬁcient largest improvement alignment quality holds sets table qualitative results benchmark datasets desktop conﬁguration. versions quickprobs radeon incompatibility quickprobs geforce best quality results typed bold. execution times given hhmmss format. dashed lines separates consistency methods. balibase time quickprobs quickprobs-acc quickprobs msaprobs picxaa-pf picxaa-hmm glprobs mafft-auto clustalω-iter clustalω muscle kalign-lcs maftt kalign sequences coincides selectivity conﬁgured threshold maximum function results balibase contains much smaller sets suggest adjusting individually matrix depending number performed relaxations works according expectations. charts presenting inﬂuence consistency measures separately found supplementary figures crucial feature selective consistency computational scalability. approximate number relaxations posterior matrix constant. result time complexity procedure noticeable improvement full consistency variant. comparison execution times shows large sets sequences time overhead related selective consistency negligible compared quickprobs stages. comparison algorithms comparison alignment software benchmark datasets given table algorithms executed desktop conﬁguration software packages suited parallel processing processing threads fully utilise multi-core architecture cpu. small sets sequences quickprobs competes consistencybased algorithms. experiments show quickprobs overcome small margin differences individual protein families sorted plotted independent series. points horizontal axis represent sets quickprobs superior ones correspond opposite situation. exceed percentage point exception sabmark glprobs took lead. explained glprobs equipped local alignment markov models especially proﬁtable distantly related sequences sabmark. picxaa non-progressive algorithm comparison also inferior quickprobs case large sets sequences consistency methods became inapplicable real problems hardware limitations. moreover accuracy consistency deteriorated dramatically giving clustalω conﬁrming latter good choice numerous alignments interest. nevertheless thanks column-oriented reﬁnement selective consistency quickprobs noticeably accurate default mode clustalω large sets. e.g. greatest advantage observed balifam score corresponds almost successfully aligned columns. considers clustalω combined iterations enabled quickprobs still superior fair margin. figure presents detailed comparison presented algorithm clustalω variants balifam homfamk benchmarks. families benchmark absolute advantages quickprobs competing software measures determined. measure differences sorted plotted chart independent series. points horizontal axis represent sets quickprobs superior ones correspond opposite situation. asses portion dataset extent algorithm performed better other. advance quickprobs default variant clustalω clear analysed benchmarks algorithm superior competitor approximately families. also case clustalω-iter homfamk. different situation balifam enabling combined iterations noticeably improved clustalω results. though still clearly inferior quickprobs effect presented algorithm worse clustalω several test cases natural visible also comparing algorithms. instance combined iterations reported signiﬁcantly elevate quality clustalω results. however analyzing differences particular protein families sets default conﬁguration accurate explained high diversity alignment problems hinders development algorithms superior competitors systematically test cases. therefore statistical analysis results necessary properly assess performance investigated methods. signiﬁcance reported differences veriﬁed wilcoxon signed-rank test control family-wise error bonferroni-holm correction applied. p-values balifam homfam give strong evidence quickprobs currently best algorithm alignment large sets sequences also compared clustalω-iter. lack signiﬁcance observed cases concerning small sets figure detailed comparison clustalω-iter clustalω balifam homfamk benchmarks. quality measure differences individual protein families sorted plotted independent series. points horizontal axis represent sets clustalω-iter superior ones correspond opposite situation. table statistical signiﬁcance results. p-values differences quickprobs selected methods measured wilcoxon signed-rank test. insigniﬁcant results given parentheses minus sign indicates advantage competing software. superior accuracy quickprobs large protein families coincides computational scalability. quickprobs comparable default mode clustalω terms execution times orders magnitude faster consistencybased methods quickprobs employs opencl executed different massively parallel devices like nvidia gpus. moreover presented software also ability central processor without opencl. experiments different hardware platforms show variant times slower version though still much faster algorithms based consistency. discussion constantly growing availability genomic proteomic data opens opportunities life sciences. also major challenge facing algorithms sequence analyses including multiple sequence alignment. increasing number sequences important factors determining difﬁculty problem. research conﬁrmed reﬁnement consistency popular quality-aimed techniques employed progressive aligners ineffective even harmful sets hundreds sequences. present quickprobs multiple alignment algorithm equipped novel column-oriented reﬁnement selective consistency. scales well number sequences offering signiﬁcantly better accuracy clustalω—the previous leader analysing large sets sequences. less numerous sets table execution times quickprobs modes. balifam homfamk analysed laptop memory requirements. balibase prefab oxbench sabmark processed bulk mode. methods based full consistency like msaprobs picxaa applicable quickprobs still superior competitors. important outstanding accuracy obtained short time thanks utilisation massively parallel architectures. successfully extending applicability reﬁnement consistency approximately thousand sequences showed sets different sizes require various treatment. open issue though scalability presented ideas families tens hundreds thousands sequences common pfam database. caused memory requirements quickprobs main issue resolved future releases. large sets sequences clustalω mafft still choice. factors contributing complexity multiple alignment problem sequence lengths evolutionary relationship presence long terminal fragments etc. believe future development domain impossible without better understanding inﬂuence elements alignment algorithms. especially light recent discoveries made boyce showed degenerated chained guide trees elevate accuracy selected alignment algorithms large sets sequences investigated. research also leads observations remain explained e.g. effect consistency proﬁtable large protein families paired reﬁnement. deeper involvement biological community deﬁnition major recipient multiple alignment algorithms would considerately facilitate advances area computational biology. quickprobs executables together source code available https//github.com/refresh-bio/quickprobs examined datasets downloaded http//dx.doi.org/./dvn/zix. service remote analyses development. references kahn future genomic data. science thompson higgins gibson clustal improving sensitivity progressive multiple sequence alignment sequence weighting position-speciﬁc penalties weight matrix choice. nucleic acids deorowicz debudaj-grabysz gudy´s kalign-lcs—more accurate faster variant kalign algorithm multiple sequence alignment problem. man-machine interactions vol. aisc edgar quality measures protein alignment benchmarks. nucleic acids valdar scoring residue conservation. proteins sievers dineen wilm higgins making automated multiple alignments large numbers acknowledgements work supported polish national science centre upon decisions dec-//n/st/ dec-//b/st/ silesian university technology bkm-/rau/ project performed using infrastructure supported poig...--/ grant geconii—upper silesian center computational science engineering. wish thank adam adamarek proofreading manuscript. author contributions statement designed algorithm. implemented algorithm. designed carried experiments. performed statistical analysis results. drafted manuscript supplementary material. authors read approved ﬁnal manuscript.", "year": "2015"}