{"title": "Phenotypic switching of populations of cells in a stochastic environment", "tag": "q-bio", "abstract": " In biology phenotypic switching is a common bet-hedging strategy in the face of uncertain environmental conditions. Existing mathematical models often focus on periodically changing environments to determine the optimal phenotypic response. We focus on the case in which the environment switches randomly between discrete states. Starting from an individual-based model we derive stochastic differential equations to describe the dynamics, and obtain analytical expressions for the mean instantaneous growth rates based on the theory of piecewise deterministic Markov processes. We show that optimal phenotypic responses are non-trivial for slow and intermediate environmental processes, and systematically compare the cases of periodic and random environments. The best response to random switching is more likely to be heterogeneity than in the case of deterministic periodic environments, net growth rates tend to be higher under stochastic environmental dynamics. The combined system of environment and population of cells can be interpreted as host-pathogen interaction, in which the host tries to choose environmental switching so as to minimise growth of the pathogen, and in which the pathogen employs a phenotypic switching optimised to increase its growth rate. We discuss the existence of Nash-like mutual best-response scenarios for such host-pathogen games. ", "text": "biology phenotypic switching common bet-hedging strategy face uncertain environmental conditions. existing mathematical models often focus periodically changing environments determine optimal phenotypic response. focus case environment switches randomly discrete states. starting individual-based model derive stochastic diﬀerential equations describe dynamics obtain analytical expressions mean instantaneous growth rates based theory piecewise-deterministic markov processes. show optimal phenotypic responses non-trivial slow intermediate environmental processes systematically compare cases periodic random environments. best response random switching likely heterogeneity case deterministic periodic environments growth rates tend higher stochastic environmental dynamics. combined system environment population cells interpreted host-pathogen interaction host tries choose environmental switching minimise growth pathogen pathogen employs phenotypic switching optimised increase growth rate. discuss existence nash-like mutual best-response scenarios host-pathogen games. outside laboratory conditions microbial cells often subject unpredictable adverse environmental changes. mechanism survive changes understand cells evolved switch stochastically phenotypic states contrast familiar forms resistance caused permanent genetic mutations switches epigenetic nature reversible lead heterogeneity population. microbial cells shown mechanism survival strategy react changing environments example induced administration antibiotics short-term changes environmental conditions continued interest antibiotic resistance understanding phenotypic switching survival strategy essential. paper focuses modelling dynamics phenotypic switching bacterial populations. within population variability cell cell lead ﬁtness advantage. classic study bigger suggests existence subpopulation bacterial resistant antibiotics members population; resilient cells often referred ‘persisters’ diﬀerence ‘normal’ ‘persister’ cells phenotypic rather genotypic. consequently cell switch back forth normal persister states given population contain subpopulations phenotypes simultaneously. heterogeneity population constitutes strategy improve resistance environmental stresses dynamic sometimes described bet-hedging biological systems form risk-balancing number diﬀerent environmental stresses including diﬀerences temperature concentrations nutrients toxins state host immune response thattai example suggest model considering growth cells urinary tract environment relates state urination. eﬀects environmental sources noise biochemical networks important area theoretical research shown modify switching rates induce bistability mathematical models bet-hedging strategies often focus periodically varying environments mainly keep analysis manageable. examples found lesser extent bet-hedging also studied stochastically varying environments paper present mathematical framework model phenotypic switching mechanism persistence ﬂuctuating environment. begin considering individual-based model possible ‘reactions’ include random birth death events stochastic phenotypic switching individual cells periodically stochastically changing environments. recently-developed mathematical approach characterise joint random processes derive formulae ﬁtnesses subpopulations overall growth rate. state environment. rates phenotype environment switches state state rate vice versa rate rates growth rate environmental state higher cells phenotype growth rate environmental state higher cells phenotype typical trajectory populations piecewise-deterministic markov process background shading indicates whether environment state state population phenotype typically greater phenotype environment vice versa environment corresponding trajectory proportion population expressing phenotype environment switches states proportion phenotype alternately tends towards ﬁxed points discussed text. simulations parameter environmental switching rates phenotypic switching rates analysis shows heterogeneity advantageous slowly switching environments whereas homogeneity conveys ﬁtness advantage quickly switching environments. comparing results case periodic environment environmental stochasticity principle lead strategies phenotypic switching diﬀerent periodic external environments. implications analysis twofold. firstly method advances mathematical framework analysing ecological models random environments. provides eﬃcient computational scheme studying growth dynamics direct simulations also oﬀers mechanistic insights problem. secondly method used investigate eﬀective protocols administering treatment antibiotics bacterial infection control-theoretic framework. demonstrate applications idealised scenarios later sections paper. also identify scenario competition switching dynamics host environment phenotypic response pathogen constitute game-theoretic scenario. analysis allows identify optimal control strategy host optimal survival strategy pathogen. show result mutual best responses akin known nash equilibria game theory remainder paper organised follows. sec. individual-based model phenotypic heterogeneity stochastic environment. approximate dynamics model obtain solution average growth rate population cells using solution analyse average growth rate changes parameters sec. speciﬁcally look optimum bet-hedging strategy bacteria maximise growth rate conversely environmental switching strategy best hinders bacteria’s growth rate. sec. summarise results discuss possible directions future work. study individual-based model well-mixed population species phenotypic switching changing environment. figure presents summary model. consider simpliﬁed scenario phenotypes environmental states. cell population expresses either phenotype phenotype representing ‘normal’ ‘persister’ phenotypes respectively. birth death dynamics phenotypes depend environmental state label takes values state represents ‘growth state’; state external stresses population absent normal phenotype outperforms persister phenotype. state hand ‘stress state’ indicates external stress acts population. state persister phenotype outperforms normal phenotype. stress example presence antibacterial agents absence nutrients unfavourable temperatures state host immune response. rates phenotype deﬁne growth rates expressing phenotype better suited environment whereas cells expressing phenotype better suited environment speciﬁcally parameters chosen individuals switch phenotypes stochastically individuals phenotype switch phenotype rate switches opposite direction occur rate rates constitute ‘switching strategy’ population. rates assumed independent environment i.e. cells switch types without sensing state environment. mathematical formalism develop however rely assumption readily extended include environmental sensing considered refs. speciﬁcally equations section modiﬁed consider environmental sensing replacement phenotypic switching rates environment-dependent quantities focus mainly case environmental switching follows markov process i.e. environmental process memoryless. also assume dynamics environment external particular independent population. switches state state occur constant rate switches occur constant rate consequence lengths episodes spent either environment identically independently distributed random variable sampled exponential distributions rate parameters respectively. mathematically environment described asymmetric random telegraph process real-world systems environmental switching process often memory occur constant rates. instead transitions environmental state likely occur certain moments time. extreme case laboratory setting strictly prescribed deﬁnite experimental protocol. case strictly periodic switching environmental states regularly assumed literature mostly mathematical convenience. like markovian case entirely realistic either. main motivation comparing cases markovian environment hand strictly periodic environment other cases serve extremes; delimit regime real-world controlled environmental switching statistics studying extremes shed light realistic scenarios operating in-between. principle model described could simulated using gillespie algorithm practice method slow particular total population grows time. instead therefore approximations allow simulate processes eﬃciently also obtain analytical results. starting master equation model approximate dynamics limit large ﬁnite system size. leads diﬀusion process markovian switching allows perform so-called linear-noise approximation obtain explicit expressions average growth rate population. since model markovian evolution probabilities system speciﬁc state described master equation except special cases however exists analytical solution general master equation. build recent work approximate dynamics systems switching environments perform kramers–moyal expansion limit large population cells maintaining discreteness environment. details found appendix result expansion model coupled stochastic diﬀerential equations number individuals phenotypes respectively. equations limit large populations formerly-discrete numbers individuals approximated continuous variables eqs. quantities independent wiener processes subscript used throughout paper indicate random process. coeﬃcients characterise strength demographic noise arising random birth-and-death process phenotypic switching events provide exact forms appendix equations describe random evolution population bacteria switching events environment particular quantities right-hand side subscript depend current state repeated period /λ+/λ. chosen duration episodes spent environments respectively periodic case match mean episode durations random environmental process. equations provide computational scheme simulating trajectories system. stochastically switching environments environmental switching times generated randomly exponential distribution using rate parameters environments respectively. equations numerically integrated using current next switching time reached. prescribed switching reached switch environmental state repeat process. procedure eﬃcient direct simulations individual-based system especially large populations. particular time simulate eqs. increase increasing population size contrast computing time required gillespie algorithm. virtue central limit theorem strength demographic noise scales inverse square root total size population. hence limit large populations contribution diﬀusive terms sdes becomes negligible. ignoring diﬀusive terms leads so-called piecewise-deterministic markov process process evolves deterministically stochastic environmental switching events occur discrete times. simpliﬁcation allows analytical solutions much analysis carried limit. figure shows typical trajectory phenotypes environment using pdmp method stochastically switching environment. size populations increases approximately exponentially time. provides posteriori justiﬁcation approximation neglect intrinsic demographic noise. note population phenotype tends larger environmental state state phenotype usually abundant least enough time passed since last environmental switch. model deceptively simple. ignoring demographic noise population dynamics linear dynamical system described coupled ordinary diﬀerential equations markovian switching. standard technique solve dynamics coupled linear odes eigenvalues eigenvectors propagating matrix. along eigenvectors growth decay exponential rates equal corresponding eigenvalues. subtleties particular case. first markovian environmental switching time environmental switches random matrix describing propagation population start episode also random. second eigenvectors propagating matrix environment generally align environmental state. result propagation population long described products sequence non-commuting random matrices. makes analysis diﬃcult. progress however made introducing processes describe total number individuals population proportion individuals phenotype respectively. together processes provide alternative coordinate system describing state system; coordinates used previously describe competition growing populations deﬁnitions eqs. become equation describes growth total population; average capita growth rate given expression square bracket. equation describes evolution proportion cells expressing phenotype suppressing demographic noise leads pdmp description valid limit large system. corresponding dynamics given eqs. noise terms removed. interestingly limit evolution fraction decouples evolution total population proportion phenotype population independent size total population follows nonlinear logistic equation obtained important stress decoupling processes consequence linearity model. general dynamics property—for models dynamics growth rate depend population size nevertheless approach still oﬀer insight cases non-linear interactions. standard technique analysing competition laboratory experiments involves successive dilution steps population order limit population size region biological interest experimental practicability dynamics growth rates thus considered limited region only. mathematical framework propose analogous technique potential area future research namely population size speciﬁc study eﬀective growth rate—the contents square bracket technique also compared birth-death model moran process population size ﬁxed paired birth death events interested computing average growth rate system write quantity understood instantaneous growth rate ˙n/n averaged many realisations random processes since process ergodic ensemble average equivalent average long time. furthermore easy show average instantaneous growth rate equivalent average rate exponential growth population long time so-called ‘dominant lyapunov exponent’ proceed useful ﬁrst consider average growth rate given environmental state environmental state order obtain object average intrinsic environmental ﬂuctuations required. note intrinsic ﬂuctuations represented stochastic diﬀerential equations eqs. multiplicative noise. simpliﬁcation achieved linear-noise approximation valid also large ﬁnite populations. consists replacing noise correlators trajectory pdmp. limit ﬂuctuations pdmp trajectory intrinsic noise symmetrical performing average respect intrinsic ﬂuctuations equivalent considering figure shows sample path pdmp proportion population phenotype process tends towards diﬀerent ﬁxed points depending environmental state. analysis shows ﬁxed points environmental state stable fig. panels show stationary distributions φ—the proportion cell phenotype a—for case stochastic environment. distributions obtained left right panels correspond increasing environmental switching rates. orange line shows case slow environment switching distribution sharply peaked ﬁxed points whereas case fast environmental switching distribution peaked central region ﬁxed points. panels show stationary distributions case periodic environment. panels depict positions stable unstable ﬁxed points direction state. parameters along with model since state favours phenotype state favours phenotype environment switches states process alternates tending towards stable ﬁxed points. suﬃcient time passed process conﬁned interval stable ﬁxed points describes single-variable pdmp markovian two-state environment. processes form subject recent studies particularly context gene regulatory networks reference provides general solution stationary probability density distribution process. context present model panels figure show resulting stationary distributions three diﬀerent rates environmental phenotypic switching. panels depict results stochastic environmental dynamics panels environment periodic. calculation stationary distribution periodic case outlined appendix orange line panel shows seen ﬁgure distributions peaked near ﬁxed points environmental switching slow fast fig. distribution instantaneous growth rate case stochastic environmental dynamics periodic environment environmental switching rates increase panels left right. distribution consists distinct components corresponding environments. dashed line indicates average growth rate. parameters fig. distributions eqs. used calculate probability density growth rates case stochastic environments shown fig. proceed study ﬁtness given phenotypic switching strategy focus average growth rate using eqs. therefore closed integral equation average growth rate population. evaluating numerically substituting provides eﬃcient calculating average growth rate terms model parameters. results mean growth rate indicated dashed vertical lines fig. analysis phenotypic switching rates depend state environment. note mathematical formalism applies case environment-dependent switching rates well; calculation average growth rate still carried replace environment-dependent rates dynamics still reducible two-state pdmp single degree freedom stationary distribution obtained. thus theory provides analytical formalism investigate case. following section solution investigate optimum switching strategy i.e. switching rates allows cells best proliferate. conversely also identify optimum environmental switching rates i.e. switching rates best inhibit growth cells. fig. heatmap plot average growth rates diﬀerent values phenotypic switching rates panels show case stochastic environment panels show periodic environment. environmental switching rates increase left right black circle panel indicates switching strategy optimises growth rate. environmental switching rates slow non-trivial maximising growth rate. means heterogeneity ﬁtness advantage. environmental switching fast homogeneity favoured. stochastic case found higher growth rate periodic case every value parameters used along with context model biological strategy bet-hedging refers heterogeneity population increase resilience environmental changes time maintaining capability growth. speciﬁcally quantify ‘temporal’ heterogeneity below—the extent phenotypes present course time necessarily simultaneously. example population largely consist phenotype time environment changes state phenotypes expressed turn. viewed time population would heterogeneous. model absence external stress phenotype higher ﬁtness. hand individuals type population risky phenotype susceptible stresses environment hence hedged maintaining capacity population persister cells establish external stress occur. analysis sec. provides tools necessary investigate mechanics bet-hedging. particular obtained expression average growth rate evaluated numerically single integration. signiﬁcantly reduces computing time required analyse dynamics contrast direct monte carlo simulation individual-based model allows explore wide range parameter space investigate bet-hedging strategies. ﬁrst study dependence average growth rate phenotypic switching rates given environmental switching dynamics. consider diﬀerent regimes environmental dynamics ranging slow fast relative time scale growth population. fig. optimum phenotypic response function environmental switching rates stochastic environment. ratio environmental switching rates ﬁxed vertical axis shows phenotypic switching rates maximise average growth rate. grey dashed lines show environmental switching rates comparison. environment switches slowly optimum strategy given matching environmental rates faster environmental switching rates optimum strategy involves switching slowly environment. fast environmental switching rates best strategy stay particular phenotype optimum phenotypic function environmental switching rates periodic environment. periods environments spends state ﬁxed durations respectively. slow environmental switching rates optimum strategy phenotypic switching rates match environment. faster switching rates optimum strategy stay particular phenotype. intermediate switching rates phenotype switching rates slightly faster environment maximise growth rate. transition heterogeneity homogeneity occurs slower environmental dynamics stochastic case. green dotted lines panels show measure temporal heterogeneity deﬁned text. mean growth rate achieved optimum choice phenotypic switching rates proportionally increase environmental switching rates. markers indicate results monte carlo simulation pdmp periodic process. mean growth rate case stochastic environments found universally larger periodic environments. parameters figure shows average growth rate depends phenotypic switching rates parameters describing growth rates phenotype ﬁxed; panels correspond regimes increasingly fast environmental switching rates environment switches relatively slowly panels non-trivial phenotypic switching strategy maximises average growth rate indicated black circle. environment switches quickly panel optimum strategy found extremes indicating best population express single phenotype results agreement previously reported work similar systems words environmental changes slow heterogeneity conveys ﬁtness advantage whereas homogeneity beneﬁcial face fast environmental changes. behaviour illustrated fig. here show optimum phenotypic switching rates vary increase environmental switching rates keeping ratio ﬁxed identify three regimes. environmental switching slow optimum switching strategy achieved phenotypic switching rates match environmental rates environmental switching intermediate regime optimum strategy involves phenotypic switching rates much slower environmental switching rates. environment switches quickly optimum strategy switch phenotypes discussed above. instead best cells keep expressing whichever phenotype better average. always express phenotype respectively. analytical ﬁndings regime slow environmental process consistent previous results thattai studied periodic stochastic environments numerical simulations. results periodically-switching environments also found refs. kussell leibler report analytical results randomly switching environments using approach based maximising average growth rate minimising transient time takes population reach environment-dependent quasi-stationary state. several quantitative measures heterogeneity principle considered. focus measuring ‘temporal’ heterogeneity i.e. extent phenotypes exist course time. variation simpson’s diversity index deﬁne heterogeneity probability cells selected random population diﬀerent times diﬀerent phenotypes. assuming individuals sampled calculation mean growth rates composition population allows address related question concerning dependence phenotypic heterogeneity optimal phenotypic switching rate ratio environments λ/λ. summarise ﬁndings here rather present details. regime slow environmental switching optimum strategy involves phenotypic switching values ratio λ/λ. enough time passes environmental episode population reach beneﬁt optimising quasi-stationary distribution. intermediate-switching regime however much longer time spent average environment becomes optimal express phenotype performs best frequent environment. perform parallel study model periodic environmental switching described environment switches periodically inﬁnite-population limit taken dynamical system becomes deterministic. long trajectory converges limit cycle. environment phenotype favoured; increases reaches ‘turning point’ φhigh environment switches. then environment phenotype favoured; decreases turning point φlow point environment returns state straightforward numerically evaluate φhigh φlow. trajectory tends limit cycle compute stationary distribution i.e. probability density ﬁnding variable given point interval randomly chosen time. details mathematical method found appendix comparison distributions stochastic periodic switching environments presented fig. ﬁgure shows domain distribution non-zero larger case stochastic switching periodic environments. eﬀect less pronounced slow switching fast switching. environment switches stochastically possible duration episode ﬁxed state last longer periodic case. result trajectory pdmp exceed deterministic extremes φlow φhigh periodic case. diﬀerence signiﬁcant consequences growth rates resulting phenotypic switching strategies. figure shows distribution growth rates cases. distributions broader case stochastic environments periodic environmental changes especially intermediate fast switching. figure shows numerically computed average growth rate periodically switching environments function phenotypic switching rates growth rates generally lower system stochastic environmental dynamics parameters. similarly figure figure shows optimum phenotypic switching strategy case periodically switching environment. superﬁcially ﬁgures look similar. identify extreme regimes behaviour limit slow environmental switching optimum phenotypic strategy switch rates environment fast environmental regime homogeneity preferred. case stochastic environmental dynamics figure intermediate regime detected; however largely absent case deterministic periodic environmental dynamics transition regimes abrupt closer analysis reveals diﬀerences cases stochastic periodic environments. environmental dynamics intermediate rates i.e. regimes optimum phenotypic switching rates diﬀer much order magnitude stochastic periodic cases. also stochastic case favours heterogeneity much higher switching rates periodic case. figure shows average growth rates compare cases markovian environment periodically switching environment optimum phenotypic strategy eﬀect. stochastic switching produces growth rate universally larger periodic switching case. found result tested parameters values phenotypic switching; similar results previously also reported ref. note even small diﬀerences growth rate lead signiﬁcant diﬀerences population size long times growth exponential. explanation enhancement growth rate follows point time instantaneous growth rate given distribution hence directly translates distribution illustrated figs. diﬀerence growth rates stochastic periodic environments pronounced intermediate switching regime; distributions regime shown figs. cases stochastic periodic environments respectively. figs. show corresponding distributions growth rates. periodic switching distribution largely minor peaks near ﬁxed points ﬁeld either environment slow. conversely stochastic environmental dynamics permit long episodes fig. heatmap plot average growth rate function using parameter previous ﬁgures. phenotypic switching rates parameters lowest growth rate achieved permanently stress state quantity parameter phenotypic switching rates ﬁxed growth rate decreases switching rates decreased proportion. given non-trivial value minimises growth rate shown white line. tend towards straight line–a constant ratio given resulting average growth rate heatmap plot optimum average growth rate function environmental switching rates position graph population cells uses optimum phenotypic switching strategy given environmental process. parameters panel switching suﬃciently fast ratio environmental switching rates minimises cell’s best possible growth rate. ratio given time spent particular environment. long episodes variable mostly reside near relevant ﬁxed point generating peaked behaviour seen fig. recalling phenotype grows quickly environment vice versa environment conclude system well-adapted environmental state peaks. leads overall enhanced growth rate relative periodic case. case markovian switching case periodic switching extreme descriptions environmental process; might expect real-world environment change dynamics somewhere in-between analysis suggests that environment dynamics extremes average growth rate would fall somewhere in-between well similarly optimum phenotypic switching rate. environmental switching dynamics used model host immune response switching states assume host aims minimise average growth rate population. another application phenotypes wildtype bacteria antibiotic-resistant strain environmental states represent absence presence antibiotic treatment. goal minimise growth varying environmental protocol. analysis allows investigate dependence growth rate environmental switching rates section investigate environmental switching strategy best inhibits growth population. ﬁgures shown stochastic environmental switching however found qualitatively similar results periodic environments. figure show average growth rate changes vary environmental switching rates ﬁxed phenotypic switching rates panel represents diﬀerent parameters. case shown figure representation bacteria phenotypes disadvantaged presence antibacterial agent persister phenotype aﬀected less external stress normal phenotype. mathematically speciﬁcally parameters used previous studies refer parameter text follows; numerical values found appendix unsurprisingly average growth rate minimised environment stays environmental state seen representing antibiotic state. another trend shown results proportionally increasing environmental switching rates universally decreases average growth rate. proportionally faster switching rates better inhibit growth population. result found tested parameters suggesting best apply antibiotics involve many short periods antibiotic treatment. parameters ref. refer parameter text follows; numerical values given appendix here phenotype performs better environment environment phenotype performs better environment environment case optimum environmental strategy involves non-trivial switching. white line panel fig. indicates optimum choice given large growth minimised non-trivial ratio λ/λ. limit inﬁnitely fast environmental switching characterised analytically. limit dynamics modelled using ordinary diﬀerential equations using eﬀective mean birth death rates minimising growth rate limit leads equation describing optimum environmental strategy inhibit growth population. minimal growth rate found probability environmental state given argument square root indicates necessary condition existence optimum explains non-trivial minimum fast-switching limit parameters used fig. parameters used fig. analytical optimum given agrees results shown fig. interplay growth-maximising strategy cells growth-minimising strategy environment provides interesting scenario. given environmental switching rates phenotypic switching rates maximise average growth rate. conversely given phenotypic switching rates non-trivial environmental switching rates minimise growth rate. suggests possibility combined rates growth rate cannot increased unilaterally changing growth rate cannot decreased unilaterally changing game-theoretic perspective neither player game improve performance changing strategy. viewed nash equilibrium given environmental switching rates optimal phenotypic switching rates found evaluating diﬀerent values identifying maximum. maximum studied function parameter evolutionarily optimising strategy found trivial environment stays stress state cell expresses persister phenotype only leading overall growth rate parameter however results less trivial since phenotypes prefers diﬀerent environment. figure shows average growth rate given optimal phenotypic switching case. ﬁgure constructed follows combination found values maximising growth rate. value maximum plotted ﬁgure. value white line ﬁgure depicts value minimises maximum achievable growth rate; point view hosting environment line shows best choice before growth rate decreases environmental switching rates increased proportionally. hence environment’s best strategy switch states quickly choice switching rates fall white line figure discussed earlier sections maximising phenotypic strategy limit fast environments leads homogeneity i.e. best population express phenotype better average environmental states. gives growth rate greater inspecting expressions ﬁnds changing ratio increases quantities decreases other. follows greater growth rates minimised growth rates equal. case gives proportion environmental state minimises average growth rate limit fast environmental switching given optimally switching population. minimum optimum growth rate given phenotypic switching strategy cell cannot change increase growth rate. similarly environment assumes cell population optimise phenotypic switching strategy environment cannot move minimise growth rate. remark ﬁnal rate independent phenotypic switching rates i.e. environment’s minimisation growth rate removes eﬀect phenotypic switching strategy altogether. analytical result agrees ratio given deﬁned fast-switching asymptote white line fig. minimum growth rate case signiﬁcantly less environmental states switch would result growth rates respectively environmental states. conclusion studied stylised model phenotypic switching strategies face changing environments. focused role time scales phenotypic environmental switching growth population analysis addresses particular case stochastically switching environments. contrast existing work analysis starts explicit individual-based model population dynamics deﬁned birth events death events stochastic phenotypic switching. analysis proceeds formulation piecewise-deterministic markov process. allows derive closed-form solutions resulting growth rates population general environmental phenotypic switching rates. work complements existing literature which mathematical convenience often concentrated strictly periodic environmental dynamics. systematically compare cases periodic versus stochastically switching external conditions. main results summarised follows using theory demonstrated optimal phenotypic switching rates equal rates environmental process slow stochastic environmental dynamics. result previously reported simulations environmental dynamics intermediate regime optimal switching rates markedly lower environment. optimal bet-hedging strategy bacterial population favours heterogeneity slow environments replaced homogeneous strategy fast switching. transition regimes sudden switching rates environmental process increased. stochastic environments favour heterogeneity larger range environmental dynamics strictly periodic environment. instantaneous growth rates universally higher case stochastic environments periodic case. analysis shows possibility spend long periods time either environment environmental process stochastic—a possibility absent strictly periodic environments. combined system population environment interpreted interaction hosting environment pathogen. host tries control environmental switching minimise growth pathogen. pathogen hand attempts maximise growth rate phenotypic switching optimised rates. analysis shows mutual best-response scenarios identiﬁed neither host pathogen improve unilateral changes strategy. akin concept nash equilibria game theory. paper developed mathematical framework analysis phenotypic switching stochastic environments. broadly work applicable ecological models competition dynamic random external conditions. problems widespread theoretical ecology predator-prey models eﬀectively random environments could example account external shocks earthquakes epidemics work provide insights mechanics problems contribution analytical computation average growth rates allows dispense costly monte carlo simulations. stress model focused stylised could naturally extended many diﬀerent ways describe realistic complicated features. include models dynamics environment coupled state population microbial species complications also occur environmental states. chosen stylised scenario binary environment represents situations external stress either absent present. model environmental states phenotypes best environments minimal non-trivial baseline. unsurprising much existing literature focused case models environmental states example studied obtain interesting scenarios also necessary introduce multiple phenotypes. detailed extension analysis cases pending expect many results qualitatively similar case. several recent papers consider role continuous environment would interesting challenging establish exact relation approaches. highlight potential area future research. note particular environmental processes based stochastic diﬀerential equations lead scenarios environment spends signiﬁcant time intermediate states possibility excluded construction model. clear diﬀerences aﬀect response population. phenotypic switching rates treated static model; approximation well bacteria demonstrated sense adapt external conditions incorporating type response another line future work make models phenotypic switching realistic. formalism presented applied study cases. acknowledge engineering physical sciences research council funding form studentship grant ep/k/ supporting thanks center nonlinear studies supporting continuation work. thank stefan kumpp discussions. parameter previously used patra klumpp shown table case phenotypes perform better environment environment persister phenotype grows slowly state also decays less quickly state model classic representation bacteria phenotypes disadvantaged presence antibacterial agent persister phenotype aﬀected less external stress normal phenotype. mathematically second parameters previously used belete bal´azsi table parameters diﬀerent properties phenotype performs better environment environment i.e. pabσ probability random processes values time compactness suppress explicit time dependence probability distribution. notation represents step operators proceed approximate master equation means kramers–moyal expansion i.e. replace step operators ﬁrst non-trivial terms taylor expansion. variables become continuous process valid limit large populations. collecting terms order maintaining discreteness environmental switching probability density ﬁrst terms right-hand side drift terms found fokker–planck equation describing probability along directions next three terms describe diﬀusion ﬁnal terms represent random switching environmental states. fokker–planck equation diﬀusion matrix able make analytical progress changing relative coordinates. introduce random processes at/nt describing total population fraction expressing phenotype respectively. using long trajectory converges limit cycle environmental state phenotype favoured increases ‘turning point’ φhigh point environment switches. environmental state phenotype favoured decreases another turning point φlow point environment switches again. turning points φlow φhigh found numerical integration trajectory tends limit cycle compute resulting distribution i.e. fraction time spends given interval cycle. distribution limited domain period limit cycle. since time spent speciﬁc range given wiuﬀ zappala regoes garner baquero levin antimicrob. agents chemother. levin rozen nature rev. microbiol. smits kuipers j.-w. veening nature rev. microbiol. leisner stingl frey maier curr. opin. microbiol. choi frieda science lewis nature rev. microbiol. balaban merrin chait kowalik leibler science bigger lancet dhar mckinney curr. opin. microbiol. gefen balaban fems microbiol. rev. rainey beaumont ferguson gallie kost libby x.-x. zhang microb. cell fact. grafen proc. natl. acad. sci. u.s.a. acar mettetal oudenaarden nature genet. hallet curr. opin. microbiol. tuchscherr medina hussain v¨olker heitmann niemann holzinger roth proctor shahrezaei ollivier swain molecular systems biology kessler w.-j. rappel levine phys. rev. lett. leisner j.-t. kuhr r¨adler frey maier biophys. samoilov plyasunov arkin proceedings national academy sciences united states caravagna mauri d’onofrio plos patra klumpp phys. biol. belete bal´azsi phys. rev. lachmann jablonka theor. biol. kussell kishony balaban leibler genetics leibler kussell proc. natl. acad. sci. u.s.a. ga´al pitchford wood genetics lohmar meerson phys. rev. patra klumpp plos levins evolution changing environments theoretical explorations haccou iwasa theor. popul. biol. kussell leibler science gander mazza rummler math. biol. visco allen majumdar evans biophys. horvath brutovsky phys. lett. hufton galla mckane phys. rev. nash ann. math. donaldson-matasci bergstrom lachmann oikos rivoire leibler stat. phys. pugatch barkai tlusty arxiv preprint arxiv. ogura wakaiki rubin preciado phys. rev. gardiner handbook stochastic methods gillespie phys. chem. yuan stochastic diﬀerential equations markovian switching kampen stochastic processes physics chemistry risken fokker–planck equation methods solution applications doering phys. rev. galla soc. interface davis roy. statist. soc. ser. faggionato gabrielli crivellari stat. phys. melbinger cremer frey phys. rev. lett. cremer melbinger frey phys. rev. lechner lewis bertram mol. microbiol. biotechnol. wiser ribeck lenski science moran statistical processes evolutionary theory. metz nisbet geritz trends. ecol. evol. bayati phys. rev. crudu debussche radulescu syst. biol. zeiser franz liebscher math. biol. wolf vazirani arkin theor. biol. salath´e cleve feldman genetics simpson nature haseltine rawlings chem. phys. arkin chem. phys. math. anal. appl. nonlinear anal. theory methods appl. yuan nonlinear anal. theory methods appl. assaf roberts luthey-schulten goldenfeld phys. rev. lett. roberts be’er bohrer sharma assaf phys. rev. assaf mobilia roberts phys. rev. lett. d¨orr lewis vuli´c plos genet d¨orr vuli´c lewis plos biol", "year": "2017"}