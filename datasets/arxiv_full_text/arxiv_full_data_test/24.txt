{"title": "Towards Better Understanding of Artifacts in Variant Calling from  High-Coverage Samples", "tag": "q-bio", "abstract": " Motivation: Whole-genome high-coverage sequencing has been widely used for personal and cancer genomics as well as in various research areas. However, in the lack of an unbiased whole-genome truth set, the global error rate of variant calls and the leading causal artifacts still remain unclear even given the great efforts in the evaluation of variant calling methods.  Results: We made ten SNP and INDEL call sets with two read mappers and five variant callers, both on a haploid human genome and a diploid genome at a similar coverage. By investigating false heterozygous calls in the haploid genome, we identified the erroneous realignment in low-complexity regions and the incomplete reference genome with respect to the sample as the two major sources of errors, which press for continued improvements in these two areas. We estimated that the error rate of raw genotype calls is as high as 1 in 10-15kb, but the error rate of post-filtered calls is reduced to 1 in 100-200kb without significant compromise on the sensitivity.  Availability: BWA-MEM alignment: http://bit.ly/1g8XqRt; Scripts: https://github.com/lh3/varcmp; Additional data: https://figshare.com/articles/Towards_better_understanding_of_artifacts_in_variating_calling_from_high_coverage_samples/981073 ", "text": "towards better understanding artifacts variant calling high-coverage samples heng broad institute harvard cambridge center cambridge received xxxxx; revised xxxxx; accepted xxxxx artifacts caused large-scale effects either. better simulation take reads sequenced sample ﬁnished genome another ﬁnished genome call variants compare calls differences found genome-togenome alignment however approach limited small haploid genomes. attempts apply similar idea mammalian genomes mammalian reference genomes frequently incomplete whole-genome alignment imperfect simulation still different realistic scenarios. difﬁculties simulation motivated focus real data. simple approach thoroughly sequence small target region mature technologies sanger sequencing technology take resultant sequence ground truth capture largescale artifacts though. another commonly used method measure accuracy either comparing variant calls different pipelines comparing calls variants ascertained array genotyping another study however array genotyping biased easier portions genome higher error rate assayed site variant calling error rate simply comparing call sets would give estimate relative accuracy pipelines affected artifact third pipeline have third pipeline appear worse even though fact better. addition comparative studies usually measure accuracy summary statistics fraction calls present dbsnp transition-to-transversion ratio. tell wrong sites. many studies also experimentally validated typically hundred variants miseq sanger sequencing sequenom genotyping. nonetheless experiments biased towards easier regions also subjected artifacts on-primer variants non-speciﬁc ampliﬁcation calling heterozygotes sequence data also challenging itself. better evaluate variant calling comparing samples pedigree individual including cancer samples expect tens hundreds somatic mutations mendelian errors abstract motivation whole-genome high-coverage sequencing widely used personal cancer genomics well various research areas. however lack unbiased whole-genome truth global error rate variant calls leading causal artifacts still remain unclear even given great efforts evaluation variant calling methods. results made indel call sets read mappers variant callers haploid human genome diploid genome similar coverage. investigating false heterozygous calls haploid genome identiﬁed erroneous realignment low-complexity regions incomplete reference genome respect sample major sources errors press continued improvements areas. estimated error rate genotype calls high error rate post-ﬁltered calls reduced without signiﬁcant compromise sensitivity. availability bwa-mem alignment variant calls available http//bit.ly/gxqrt scripts miscellaneous data https//github.com/lh/varcmp contact henglibroadinstitute.org introduction since sequencing ﬁrst personal genome particular ﬁrst genomes sequenced illumina technologies resequencing widely used personal cancer genomics discovery novo mutations associated mendelian diseases reconstruction human population history understanding mutation processes studies mapping based snp/indel calling plays central role. accuracy calls fundamental impact biological interpretation. context various research groups attempted evaluate performance variant calling. simplest approach evaluation variant calling simulate variants reads reference genome however unable simulate various artifacts non-random distribution variants dependent errors incomplete reference genome copy number variations. improved version incorporate real variants instead using simulated variants address genome inconsistencies likely errors. however method insensitive systematic errors. locus caller ﬁnds erroneous heterozygotes samples errors wouldn’t identiﬁed. efforts still clear basic question error rate indel calling. although papers give estimate error either estimated easy sites sufﬁciently backed published data addition works attempted identify sources errors. analyzing systematic errors even rarer existing evaluation methods hide them. article exceptional data sequencing data haploid human cell line evaluate accuracy variant calling. vast majority heterozygous calls supposed errors almost know ground truth unbiasedly across whole genome. able pinpoint errors investigate characteristics experiment ﬁlters reasonable estimate error rate limited non-systematic errors. addition unique data study also differs many previous ones multiple read mappers unpublished well developed variant callers caller-oblivious genotyping ﬁltering. data sets data analysis data sets study focused deep illumina sequencing data cell lines chmhtert cell line cell line. crucial unusual feature chmhtert brieﬂy cell line haploid suggests heterozygous variant calls errors. calling method producing fewer heterozygotes theory better. meanwhile avoid overrating variant calling method sensitivity heterozygotes also used positive control. acquired data illumina platinum genomes project. library constructed without ampliﬁcation. using paired-end data yields -fold coverage. alignment post-alignment processing mapped reads bowtie bwa-mem mapped reads addition bowtie bwa-mem. detailed command lines found table except section mapped reads reference genome used genomes project ﬁnal phase. initial alignment picard’s markduplicates data sets. picard identiﬁed reads duplicates. picard reported duplicates false positives library constructed without ampliﬁcation. apply markduplicates subsequent analysis. alignment also tried gatk’s base quality recalibration indel realignment around indel calls genomes project samtools gatk number calls differ much smaller difference caused procedures. thus apply steps alignments additional computational cost. noted although bqsr calling snps short indels called snps short indels freebayes gatk uniﬁedgenotyper platypus samtools gatk haplotypecaller. command lines found table additional details follows. resolving overlapping variants platypus samtools produce many overlapping variants. avoid overcounting variants overlapping variants always keep higher variant quality. repeated procedure overlapping variants remain. re-calling genotypes given genotype likelihood different callers produce different genotypes. example samtools estimates genotypes assuming prior seeing heterozygote gatk apply prior. gatk likely call heterozygote samtools. genotype calling single sample relatively simple. avoid subtle difference simple step complicating ﬁnal results re-call genotypes genotype likelihoods provided callers. multiplied likelihood heterozygotes called genotype maximum likelihood. decomposing complex variants freebayes platypus report variant composed multiple snps and/or indels. decomposed variants individual events results comparable. freebayes uses cigar string describe complex variant aligned reference. extracted snps indels cigar. platypus report cigar. assumed variant allele always left aligned reference allele decomposing complex variant. variant ﬁltering callers used study come ﬁltering programs recommended ﬁlters. however applying caller-speciﬁc ﬁlters complicate comparison obscure artifacts. decided choose several universal ﬁlters applicable callers low-complexity ﬁlter ﬁltering variants overlapping lowcomplexity regions identiﬁed mdust program stand-alone implementation dust algorithm ﬁrst used blast. grch a/c/g/t bases autosomes identiﬁed lcrs. maximum depth ﬁlter ﬁltering sites covered excessive number reads. noted different callers deﬁne depth differently. example platypus apparently counts reads unambiguous realignment. read depth reported platypus noticeably smaller comparison callers. double strand ﬁlter ﬁltering variants either number nonreference reads forward strand reverse strand certain threshold. ﬁlter applicable gatk calls gatk report numbers. identiﬁed effective ﬁlter cancer data ﬁltering sites numbers reference/non-reference reads highly correlated strands reads. precisely counted number reference reads forward strand reverse strand number non-reference reads forward reverse strand. bowtie ref.fa read.fq read.fq read.sai ref.fa read.fq; sampe ref.fa read.sai read.sai read.fq read.fq ref.fa read.fq read.fq freebayes ref.fa aln.bam samtools mpileup -euf ref.fa aln.bam bcftools view java -stand emit conf -glm java -jar genomeanalysistk.jar haplotypecaller –genotyping mode discovery ref.fa aln.bam -stand call conf -stand emit conf platypus.py callvariants –ﬁlterduplicates= –bamfiles=aln.bam –reffile=ref.fa among ﬁlters regional ﬁlter entirely independent alignment variant calling. although computed called variants effect usually greatly dependent mapper caller either. remaining ﬁlters dependent error models used callers. example samtools effectively gives higher weight variants supported strand; freebayes seems require variant supported reads covering site. optimal thresholds ﬁlters caller dependent. measuring accuracy data sets share many properties. sequenced illumina reads similar coverage removal duplicates. number called variants haplotype also close usually within difference according multiple call sets. observation reasonable assume number heterozygous errors also close number heterozygous calls chm. result take nh/nd estimate false positive rate heterozygotes proxy sensitivity number heterozygous calls number might ﬁrst time unbiasedly measure whole genome call set. manual review understand major error modes manually reviewed heterozygous indels called different callers chm. sites displayed alignment samtools’ tview alignment viewer sense alignment quality obvious positional biases complexity reference genome. often extracted reads regions around indels extending ﬂanking regions high complexity eyes. assembled extracted reads fermi version mapped assembled contigs back reference genome bwa-mem. fermi tries preserve heterozygotes. indels truly heterozygous typically contigs covering site allele. used local assembly orthogonal approach validate heterozygous calls. presenting results following applied ﬁlters order ﬁlter applied later depending ﬁlters applied clarity highlight ﬁlters major effects. figure overviews breakdown various ﬁlters across multiple call sets. consider might true heterozygotes potentially somatic mutations call sets generally error rate approximately ﬁltering. checking ploidy although chmhtert cell line supposed haploid still heterozygous variant calls potentially because cell line truly haploid; somatic mutations cell line; library construction sequencing errors ought considered calling algorithms; mapping variant calling algorithms ﬂaws. study focusing ﬁrst make sure heterozygotes resulted occur much lower rate. note sample submitted sequencing haploid either biological artifacts massive somatic mutations large number heterozygotes evident sequencing data called callers. heterozygotes mostly caused sequencing errors algorithm artifacts differences algorithm error modeling callers call subset errors different characteristics result consistency call sets. small call intersection figure suggests latter case. also manually reviewed tens heterozygotes called multiple callers data study illumina data generated libraries mapped original algorithm genomes project analysis group. reviewing read evidence using alignment viewer appears half snps real. snps averaged read depth non-overlap known segmental duplications associated known error-prone motifs illumina sequencing hand many indels low-complexity regions look like systematic errors called callers speculate heterozygotes fig. effect ﬁlters. low-complexity ﬁlter overlapping low-complexity regions identiﬁed dust algorithm. maximum-depth ﬁlter read depth average read depth. miscellaneous ﬁlter includes three ﬁlters allele balance variants supported non-reference reads strands fisher strand p-value filters applied order misc applied variants passing misc applied variants passing call total height gives number variant calls reported quality less note y-axes scaled differently. strong alignment support multiple illumina libraries. hard accurate estimate tell sources heterozygotes data using. writing work paciﬁc biosciences released deep resequencing data cell line. could used isolate errors caused illumina sample preparation sequencing. however mapping variant calling pacbio human data still early phase. decided leave comparison pacbio data now. anyway even assume variant calls intersection present chmhtert cell line still able measure error rate error given times heterozygous calls seems likely heterozygotes likely errors major sequencing/calling artifacts. stringent thresholds reduce sensitivity different aspects call sets amplify subtle differences calling algorithms. addition figure clustering indels within other. increasing distance threshold changed numbers slightly. low-complexity ﬁlter low-complexity regions human genome harbor heterozygous indel calls heterozygous snps recall number heterozygous indels lcrs number heterozygous indels lcrs estimates heterozygotes. lcrs ranged high depending call sets. similar estimator heterozygous indels outside lcrs much lower depending call sets. also tried lobstr called heterozygous indels microsatellites still yielding high fpr. understand models homopolymer indels calling vastly different number heterozygous indels. still clear model errors well. maybe effective solution avoid sample preparation. potential errors error source. pcrfree data call intersection lcrs noticeably smaller high-complexity regions suggests presence error sources lcrs. addition errors introduced sample preparation believed affect snps lesser extend. small intersections heterozygous call sets pcr-free call sets lcrs caused types errors. realignment errors mapping read reference genome read mapper chooses optimal pairwise alignment read independent others. reads mapped region combination optimal pairwise alignments always yield optimal multi-alignment reads. variant caller simply trusts suboptimal multi-alignment produce false variants genotypes therefore recent variant callers including haplotypecaller platypus freebayes study heavily rely realignment indel calling. however manual review found variant callers often failed produce optimal realignment lcrs. reviewed heterozygous indels corrected away better realignment. without thorough understanding details realignment process unable explain callers fail even obvious cases. nonetheless often manually derive better multialignment possible good realignment algorithm replace manual work achieve higher accuracy tools evaluation. process manual review found local assembly fermi frequently effective indel callers independence reference sequence requirement long-range consistency powerful topology based error cleaning difﬁcult errors figure trivial resolve local assembly. maximum read depth ﬁlter effectiveness depth ﬁlter ﬁlters require threshold single value. study ﬁlter effective used roc-like plot figure ﬁgure xaxis number heterozygous snps proportional false positive rate; y-axis difference number heterozygous snps serves proxy sensitivity. similar standard plot curve closer left corner implies better classiﬁer errors. figure implies maximum depth ﬁlter effective false heterozygotes especially found bwa-mem alignment. data depth maximum depth threshold removes many false positives little effect sensitivity. false positives mostly caused copy number variations paralogous sequences present human reference genome. fig. relationship heterozygous call sets. variant calls ﬁltered with variant quality less allele balance fisher strand p-value maximum read depth average read depth. relationship heterozygous call sets. snps considered position. relationship heterozygous indel call sets. ﬁltered indels said linked ’-end indel within ’-end indel vice versa. indel cluster connected component linked indels. possible cluster indels distant overlap third indel. venn’s diagram shows number indel clusters falling category based sources indels cluster. snps indels -way intersections overlap low-complexity regions. potential ampliﬁcation errors errors known responsible many indel errors long homopolymer runs observed many apparent heterozygous indels inserted deleted long poly-a poly-t runs errors. although callers deploy advanced fig. example misalignment around chm. truth allele derived local assembly. three erroneous read alignments correct alignments shown three reads exact substring truth allele alignments different. ﬁrst read ‘errread’ aligned without gaps ’-end read substring deletion. read ‘errread’ aligned insertion alignment better long deletions. read ‘errread’ also aligned without gaps seven mismatches. possible aligner correct alignment given small extension penalty. example bowtie align reads gaps. bwa-mem aligned four reads correctly. except haplotypecaller locally assembled reads callers called multiple heterozygotes around region. existing segmental duplications reference genome. therefore bowtie likely correctly give mapping quality read paralogous sequences. variant callers usually distrust mismatches alignments mapping quality calls bowtie alignment less susceptible cnvs incomplete reference genome. however conservative mapping quality estimate lead false negatives. example found read pair mismatch around .mbp mismatches around .mbp. bowtie bwa-mem mapped ends pair positions. bowtie gives pair mapping quality bwa-mem gives mapping quality similar scenario happens reads mapped region. result called bwa-mem alignment bowtie alignment. variants callers usually call variants bwa-mem alignment many located segmental duplications. another difference relevant mapping quality comes alignment around long indels. haplotypecaller always called indels bwa-mem alignment callers made three times many deletion calls bwa-mem alignment either lcrs called insertions outside lcrs. interestingly except haplotypecaller others called insertions bowtie alignment lcrs instead. found good explanation apparently conﬂictive observations. alternative maximum depth ﬁlter maximum depth ﬁlter effective false heterozygotes applicable high-coverage data uniform read depth. work exome sequencing data powerful data shallow coverage. overcome limitation derived alternative ﬁlter. obtained unﬁltered samtools calls genomes project computed inbreeding coefﬁcient hardyweinberg p-value using genotype likelihoods extracted sites satisfying reported read depth inbreeding coefﬁcient less zero; p-value clustered sites within regions. regions susceptible common cnvs artifacts fig. effect ﬁlters removing variants low-complexity regions. ﬁlter associated value. ﬁlter number heterozygous snps called counted accumulatively stringent threshold ﬁlter value relax threshold. thresholds chosen approximately evenly divide variants bins. chosen threshold yields point plot. arrow points point curve corresponding read depth right mean read depth across called variants. difference bowtie bwa-mem alignment clear bowtie less affected presence cnvs incomplete genome manual review seems comparison bwa-mem bowtie tends give alignment lower mapping quality read suboptimal hits. time missing paralogous sequences reference genome often associated ﬁlter almost effective maximum depth ﬁlter. could valid alternative maximum depth ﬁlter cannot applied. however derivation ﬁlter requires multiple thresholds depends populations mapper caller therefore decided much simpler maximum depth ﬁlter here. ﬁlters remaining ﬁlters including ﬁlter additional false heterozygous called effectiveness varies call sets. optimal thresholds ﬁlters affect false negative rate false positive rate. arbitrarily chose reasonable thresholds based roc-like curves optimal call sets. effect duplicates data discarded analysis duplicates. also tried variant calling memhc without markduplicates step. ﬁltering approach yields heterozygous snps heterozygous indels suggesting indels susceptible artifacts snps. ﬁltering total numbers snps indels without duplicates. fig. relationship heterozygous snps called mappings different reference genomes. reads mapped bwa-mem. autosomal snps called gatk haplotypecaller passed low-complexity ﬁlter. heterozygous calls grch lifted grch liftover tool ucsc default setting. effect reference genome work mapped reads reference genome used genomes project. reference genome contains extra sequences present several novo assemblies likely missing primary assembly grch. sequences supposed attract many mismapped reads called decoy sequences. also mapped reads grch grch primary assemblies called variants. number homozygous non-lc snps called reference close million grch grch respectively. however numbers heterozygous snps/indels distinct called twice many heterozygotes grch comparison hsd. indicates decoy sequences indeed attracted many mismapped reads consequently improves variant calls chromosomal regions. grch resolves heterozygotes called hsd. however also retains heterozygotes called grch hsd. intriguingly grch adds autosomal heterozygotes called grch hsd. unclear source false heterozygous snps. general conclude grch complete grch. discussions conclusions distinct feature works haploid human sample heterozygous calls supposed errors. allows unbiasedly investigate causal artifacts experiment effective ﬁlters diploid data positive control. called snps indels surprised variant calls heterozygotes. honestly immediate reaction truly haploid. however careful analysis convinced heterozygosity order magnitude lower error rate variant calling. vast majority heterozygotes calling errors. call usually error –kb. also surprise low-complexity ﬁlter effective false heterozygotes especially short indels. although knew indel errors introduced sample preparation underestimated substantial effect. also unware realignment indels lcrs remains great challenge even many existing efforts direction without suggestion peter sudmant would tried ﬁlter. understand resolve issues variant calling lcrs might better ﬁlter variants overlapping regions. although single-sample indel calls fall lcrs autosomal indels clinvar database overlap lcrs indels lcrs unknown clinical functionality. certain applications might safe drop downweigh difﬁcult calls. outside lcrs different call sets usually agree well ﬁlters applied based figure estimate caller usually makes wrong call without signiﬁcant compromise sensitivity similar previous estimates many errors likely systematic. context somatic novo mutation discovery sample contrast systematic errors appear samples. lead false mutation calls fortunately. simple method improve variant accuracy distinct pipelines take intersection calls apply caller-oblivious ﬁlters derive ﬁnal call set. callers agree well post-ﬁltered sites badly false positives able remove errors without much sensitivity. consensus approach applied cancer data limited success without subclonal mutations much effective variant discovery normal samples. advances sequencing technologies lead development algorithms. heavily relying mapping based variant calling short reads coverage traditional assembly-and-mapping approach would work. increased read lengths decreased sequencing cost might back novo assembly. assembly encode small variants also retains large-scale structural variations free artifacts reference genome. another possible direction mentioned four years sequence reads ensemble multiple genomes. recently signiﬁcant progress towards goal practical solution concluded. acknowledgement richard wilson team really grateful sequenced cell line granted permission data study. also thank genomes project analysis group helpful comments discussions thank mike anonymous reviewers whose comments helped improve manuscript. statistical framework calling mutation discovery association mapping population genetical parameter estimation sequencing data. bioinformatics depth comparison individual’s lymphoblastoid cell line using whole genome sequencing. genomics o’rawe concordance multiple variant-calling pipelines", "year": "2014"}