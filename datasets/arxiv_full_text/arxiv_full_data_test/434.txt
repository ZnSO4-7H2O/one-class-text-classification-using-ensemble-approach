{"title": "Mean and Variance of Phylogenetic Trees", "tag": "q-bio", "abstract": " We describe the use of the Frechet mean and variance in the Billera-Holmes-Vogtmann (BHV) treespace to summarize and explore the diversity of a set of phylogenetic trees. We show that the Frechet mean is comparable to other summary methods, and, despite its stickiness property, is more likely to be binary than the majority-rules consensus tree. We show that the Frechet variance is faster and more precise than commonly used variance measures. The Frechet mean and variance are more theoretically justified, and more robust, than previous estimates of this type, and can be estimated reasonably efficiently, providing a foundation for building more advanced statistical methods and leading to applications such as mean hypothesis testing. ", "text": "corresponding author megan owen department mathematics lehman college city university york bedford park blvd west bronx usa; e-mail megan.owenlehman.cuny.edu. abstract.— describe fr´echet mean variance billera-holmes-vogtmann treespace summarize explore diversity phylogenetic trees. show fr´echet mean comparable summary methods despite stickiness property likely binary majority-rules consensus tree. show fr´echet variance faster precise commonly used variance measures. fr´echet mean variance theoretically justiﬁed robust previous estimates type estimated reasonably eﬃciently providing foundation building advanced statistical methods leading applications mean hypothesis testing. example might encounter output inference program like mrbayes gene trees given species. paper think sample underlying distribution phylogenetic trees ﬁxed leaf tree consists topology branch lengths. here consider mathematically-founded basis describing mean distribution using representation trees elements continuous geometric space looking fr´echet mean tree minimizes squared distance mean elements sample distribution. formulation also allows identiﬁcation fr´echet variance actual squared distances sample elements fr´echet mean. sophisticated statistical approach analyzing phylogenetic trees variance heuristic computation used compare levels incongruence diﬀerent evolutionary models hypothesis testing validate application data cloning bayesian phylogenetic inference however despite usage literature large-scale analysis perfomance properties fr´echet mean variance. throughout paper iterative algorithm compute approximations fr´echet mean variance known polynomial algorithm computing mean. algorithm fairly eﬃcient show mean close established summary measures like maximum likelihood tree maximum posteriori tree majority-rules consensus tree. mean tree known sticky phenomenon perturbing sample perturb mean caused negative curvature treespace. negative curvature also lead mean tree unresolved although show mean resolved majority-rules consensus tree predicted shorten branch lengths mean. refer overall property mean pulled towards star tree stickiness show even best case biological scenario eﬀect still detectable minimal mean. mean. show experiments sequence length increases information tree reconstructed variance samples trees bootstrap posterior distributions decreases. also show fr´echet variance signiﬁcantly better measure statistical uncertainty simpler measures faster compute pairwise distances trees large trees. finally show variance depend length trees sample needs accounted comparisons variance. originated billera fact used practical applications. ﬁndings fr´echet mean variance make sense biologically well statistically justify usage sophisticated statistical schemes computing conﬁdence sets encourage future applications outlier detection. begin describing treespace working properties space distance measure. also consider ways summarizing collection trees besides fr´echet mean variance properties. equivalently number possible partitions leaves sets size least coordinate corresponds diﬀerent split order splits matter ﬁxed. note allowing partitions size include splits corresponding edges ending leaves. original deﬁnition ignores edges notes included done here. vector every edge length |e|t coordinate corresponding split induced |e|t coordinates corresponding splits induced edges vectors correspond trees described. non-negative vectors correspond trees split incompatibility. splits incompatible cannot induced edges existing tree. example cherry pair adjacent leaves tree corresponding split separates adjacent leaves others. tree cherries corresponding splits incompatible vectors positive values tree. binary tree interior nodes degree contains splits unresolved trees contain fewer splits. trees correspond splits vectors exactly non-zero coordinates take positive values. thus number non-zero coordinates trees corresponds d-dimensional euclidean orthant non-negative part tree topology binary binary tree topologies leaves thus top-level orthants. top-level orthants share boundary dimension less corresponding topologies diﬀer single nearest neighbour interchange move. figure details combinatorics geometry treespace billera distance geodesic distance also deﬁned billera trees topology distance euclidean distance corresponding vectors shared orthant. trees diﬀerent topologies distance length shortest path remains treespace. length path computed calculating euclidean distance path restricted orthant passes though summing lengths. shortest path called geodesic pass orthant next orthant lower-dimensional boundaries corresponding trees fewer splits. treespace. ease visualization dimensions corresponding leaf edges included. thus binary tree topology represented quadrant quadrant axes corresponding lengths interior edge splits. axis quadrants corresponds unresolved tree topology. geodesic trees shown dashed line pass diﬀerent orthants depending branch lengths endpoint trees shown non-positively curved implies geodesics unique. owen provan gave polynomial time algorithm computing geodesic distance trees runs time number leaves largest subtree formed decomposing trees along common splits. euclidean space fr´echet mean centre mass point minimizing squared distances sample points equivalent coordinate-wise average sample points. fr´echet mean similarly deﬁned treespace miller baˇc´ak independently. sample trees section details proofs. mean tree necessarily reﬁnement majority-rule consensus tree split appears mean tree appears least sample trees split appears sample trees appears mean tree. finally mean tree sticky perturbing sample trees always change mean tree. stickiness happens mean lower-dimensional orthant treespace corresponds unresolved tree topology. thus mean unresolved often might expect wish similar majority-rule consensus tree. stickiness caused non-euclidean nature treespace also causes binary mean trees pulled towards lower-dimensional orthants. example suppose wish mean trees sampled uniformly ball radius around centre tree figure folding orthants other limit sample size increases computing mean equivalent computing weighted euclidean mean centre gravity disk section corresponding part ball orthants twice density rest disk mean closer shared axis original centre tree. behaviour also component stickiness mean. figure three neighbouring quadrants treespace labelled uniformly sample ball radius around centre tree quadrant shown flattening quadrants gives shows computing mean distribution equivalent computing weighted euclidean mean disk twice density region radius ball intersects orthants showing distribution sample means converges certain gaussian distribution. central limit theorem used willis construct conﬁdence sets treespace. consensus phylogenetics topology others topology edge lengths. ﬁrst majority-rule topology topology containing exactly splits appearing majority input trees majority-rule consensus topology fr´echet mean general reﬁnements maximum likelihood bayesian inference. tree search procedures produce distribution trees along likely probable tree acts like centre. speciﬁcally maximum likelihood search produces distribution bootstrap trees maximum likelihood tree bayesian inference produces posterior distribution maximum posteriori topology rannala yang measure summary tree. often visual representation splitstree densitree used represent diversity trees. unfortunately methods cannot assessed compared quantitatively. instead compare fr´echet variance several quantitative measures variance namely number diﬀerent tree topologies number diﬀerent splits squared geodesic distances pair trees set. later measure proposed chakerian holmes closely related leading relationships measures centre involving distances. distance trees deﬁned number splits plus number splits size symmetric diﬀerence split sets note deﬁnition uses tree topologies edge lengths trees. weighted robinson-foulds distance lengths splits trees plus diﬀerence lengths common splits. metric also known manhattan taxicab metric used orthant treespace instead euclidean metric length geodesic trees weighted distance good summary). distances diﬀer whether metric used orthant pairs trees close close other. thus results validating distance biological application likely carry distance. distance expensive compute treespace mathematical properties like uniqueness geodesics means make appropriate developing statistical tools analyzing trees. recall median tree tree minimizing distances instead squared distances mean tree sample trees. majority-rule consensus tree median tree robinson-foulds distance pattengale showed weighted majority-rule consensus tree median weighted robinson-foulds distance. closely related work benner investigated behaviour mean median summarizing posterior distributions returned bayesian tree reconstruction methods. authors simulated sequences lengths using -taxa tree plants evolutionary model show mean median estimates comparable majority-rule consensus estimate instances perform better also investigate fr´echet variance changes sequence length. same scope experiments much broader considering tree distributions generated maximum likelihood bayesian methods; general evolutionary model; trees taxa; stickiness mean practice; comprehensive look fr´echet variance including relationship tree length. paper focuses fr´echet mean variance trees mean point summary data. work looked -dimensional summaries best lines treespace extensions multi-dimensional summaries generalization principal components analysis trees. holder showed majority-rules consensus tree optimal tree report summary bayesian posterior using loss function linear number incorrect clades estimated number true clades missing estimate treats incorrect split serious error omitted split. huggins continued line investigation showing using path diﬀerence distance trees loss function bayes estimator applied posterior distribution sample improved accuracy reconstruction tree. loss function bayes estimator distance computing bayes estimator becomes equivalent computing median. variety lengths using tree mammals murphy shown figure reference tree. sequences simulated seq-gen version using model following parameter settings proportion invariable sites equilibrium frequencies respectively; rate matrix entries transition rate parameter values estimated hillis reference tree. used sequences produced generating reference trees using adjusted ultrametric edge length scaled tree height value. sequences base pairs simulated rose using gamma model either short medium long gaps. replicates reference tree seven sequences dataset raxml version compute maximum likelihood tree bootstrap sample trees. raxml settings used gamma evolutionary model. conducted full analysis using rapid bootstrapping recommended raxml user manual computing large number bootstrap replicates since every bootstrap tree used starting point tree search. sequences also mrbayes compute tree sample trees posterior distribution. mrbayes settings used gtr+i+gamma evolutionary model iterations sampling every generations. used last sampled trees posterior distribution. veriﬁed convergence comparing likelihood values chains. three measures variation sample number diﬀerent tree topologies sample number diﬀerent splits sample squared distance pair trees sample. compared mean tree corresponding reference majority-rule consensus trees using distance distance trees meaningful branch lengths. mean trees trees reference trees meaningful branch lengths majority-rule consensus tree trees not. distance tree treespace origin. investigate stickiness mean compare length mean tree sample average length trees sample mean much shorter component trees. also compare lengths mean average lengths trees posterior bootstrap distributions generated sequence set. cases wilcoxon ranked signed test test hypothesis distributions lengths same. finally conducted mean hypothesis test bootstrap posterior samples ﬁrst repetition base pairs mammal. recall mean hypothesis test type two-sample test tests means samples same. rejecting hypothesis implies samples diﬀerent distributions. computed distance means bootstrap posterior samples compared distance means random partition samples. random partition made combining bootstrap posterior trees randomly partitioning equal parts. since full permutation test feasible estimated using randomly chosen permutations. note following method performing two-sample hypothesis testing trees suggested feragen lung-airway tree data. compute approximation mean tree using iterative implementation described miller implementation approximation mean tree returned iteration approximations converge true mean tree number iterations grows. decide stop iterative algorithm program option check convergence using cauchy sequence length epsilon mammal sate. words stop iterative algorithm pairwise distances last mean approximations less equal epsilon. experiments means converged within iterations. also random permutation heuristic selects tree used iteration randomly without replacement instead replacement. heuristic improves convergence time algorithm practice. validated choice epsilon mammal choosing repetition sequence length computing mean corresponding posterior distribution sample times using chosen parameters. epsilon average distance pairs approximate means sample order considered acceptable. nature iterative approximation algorithm causes estimated mean trees binary. declared estimated mean tree unresolved internal edges less epsilon length. computing mean variance mammal took minutes -core intel xeon processor. program source code available http//comet.lehman.cuny.edu/owen/code/sturmmean.tar.gz. visualize trees repetition mammal dataset look like ﬁrst repetition base pair sequence length experiment computed distance trees bootstrap posterior samples reference tree tree mean trees. classic multi-dimensional scaling reduce dimensions means tree middle respective samples. samples separated space reference tree closer posterior sample near centre. reference tree means tree trees samples topology. common topologies appear bootstrap posterior samples suggesting diﬀerence clusters figure primarily branch lengths distance takes account instead topology. first compare mean trees reference trees summary trees showing close. four plots figures distances compare fr´echet mean bootstrap posterior sample corresponding majority-rule consensus tree reference tree either tree appropriate. mammal sate mean tree closer majority-rule consensus tree reference tree. mammal dataset distance mean trees decreases sequence length increases three trees almost always topology sequences length base pairs longer. sate dataset diﬀerence scale edge lengths reference trees results large diﬀerences distance trees. figure sample trees ﬁrst repetition base pair sequence length mammal dataset embedded dimensions using classic multi-dimensional scaling. trees bootstrap posterior samples form clusters likely diﬀerences branch lengths instead topology. combined previous figures show reconstructed trees closer reference tree. mammal expected trees become closer reference tree sequence length increases since gives information reference tree improving reconstruction. interestingly distance bootstrap distribution mean tree closer reference tree tree figure sample generated mammal dataset distances calculated mean tree majority-rule tree tree reference tree. distribution distances shown using plots. mean tree approaches consensus trees sequence length increases three trees usually sharing topology sequence lengths base pairs. compare diﬀerent measures variance trees namely number diﬀerent topologies number diﬀerent splits fr´echet variance squared distance pairs input trees figures mammal dataset sequence length increases information underlying tree expect raxml mrbayes better inferring tree certain increased certainty figure sample generated sate dataset distances calculated mean tree majority-rule tree tree reference tree. distribution distances shown using plots. mean tree much closer tree consensus tree reference tree. variation distance models diﬀerence scale edge lengths reference trees translates longer edge lengths higher tree models. reﬂected decrease variance bootstrap posterior distributions thus samples sequence length increases figure sate dataset variance decreased amount edge lengths scaled decreased. model pairs diﬀerent lengths edge lengths scaled amount. however change length appear aﬀected variance. datasets measures expect possibly figure sample generated mammal dataset distances calculated reference tree sample’s mean tree majority-rule tree tree. distribution distances shown using plots. three reconstructed trees approach reference tree sequence length increases mean tree slightly closer average tree distance measure. distance reference mean trees posterior distribution shown lower-right graph figure number diﬀerent topologies sate posterior samples lower variance bootstrap samples. lower variance matches previous observations posterior probabilities higher bootstrap frequencies well-supported clades since trees lower variance sample spread thus fewer diﬀerent splits trees figure sample generated sate dataset distances calculated reference tree mean tree majority-rule tree tree. distribution distances shown using plots. three reconstructed trees similar distances reference trees distances variation distances model variation tree height. distance reference mean trees posterior distribution shown lower-right graph figure squared distance pairs ﬁrst suggested measure variance. large input sets faster compute fr´echet variance distance pairs. discussion below details. figure variance mammal dataset samples bootstrap posterior distributions measured using number diﬀerent topologies number diﬀerent splits squared distance pairs fr´echet variance. measures posterior samples lower variance average bootstrap samples. squared distance pairs fr´echet variance similar scaling. note axis number diﬀerent splits squares fr´echet variance scale. figure variance sate dataset samples bootstrap posterior distributions measured using number diﬀerent topologies number diﬀerent splits squared distance pairs fr´echet variance. measures except possibly number diﬀerent topologies posterior samples lower variance average bootstrap samples. squared distance pairs fr´echet variance similar scaling. note axis number diﬀerent splits squares fr´echet variance scale. also looked average tree lengths many mean majority-rules trees unresolved determine eﬀect mean stickiness. figure shows number unresolved mean majority-rules trees bootstrap posterior samples figure mammal dataset number fewer unresolved mean tree majority-rules trees bootstrap posterior samples sequence lengths. number unresolved mean trees decreases sequence length increases reaching base pairs. sequence lengths mammal. number unresolved mean majority-rules trees decreases sequence lengths increase mean trees base pair sequence length binary. always fewer unresolved mean trees unresolved majority-rules trees sequence length. however even mean trees fully resolved stickiness property could still cause closer origin sample expected. terms measurable eﬀects closer origin translates mean trees shorter average trees computed. bootstrap posterior samples length mean tree strictly less average length corresponding sample trees. mean trees shorter length might expected noticeably aﬀect quality summary averaged sequence lengths bootstrap posterior mean trees respectively average lengths respective samples. also compared lengths trees bootstrap samples corresponding mean trees mammal dataset. samples length tree greater length corresponding mean tree. p-value length tree greater average length trees corresponding bootstrap sample. posterior sample always less average length trees corresponding bootstrap sample generated sequences. diﬀerence suggests bootstrap samples spread could also reﬂect posterior probabilities higher well-support clades bootstrap probabilities. unsurprisingly mean tree posterior distribution sample always length less mean tree corresponding bootstrap sample. ﬁrst repetition base pair sequences performed two-sample hypothesis test compare samples bootstrap posterior distributions using means. null hypothesis stated means bootstrap posterior distributions same. tested hypothesis using approximate permutation test. cases distance means random partition samples strictly less distance means samples themselves. thus reject null hypothesis estimated p-value conﬁdence interval therefore assume distributions mean thus same. result expected previous work showing bootstrap posterior probabilities diﬀerent expected biological data. shown mean samples bootstrap posterior distributions comparable accuracy trees respectively well majority-rule consensus topology. furthermore mean tree likely binary majority-rules consensus topologies. mammal dataset original reference tree closer mean tree however reverse true sate dataset. leads open question whether characterize fr´echet mean performs better tree summary bootstrap samples. possible gain enough warrant cost computing mean results conclusively demonstrate mean valid summary method sample trees. believe value mean comes sound mathematical backing enables sophisticated statistical tests like mean hypothesis testing. results variance experiments clear fr´echet variance faster precise measure variance existing alternatives. variability number topologies tree samples sequence length high comparison variance measures. although variability decreases measuring number splits tree sample still higher squared pairwise distances fr´echet variance. sate dataset variances tree length possibly overwhelming factor value variance. however mammal dataset experiments show tree samples comparable length variance provides means diﬀerentiating sample variability. thus variance useful comparing samples similar average tree length. example comparing bootstrap posterior samples number genes taxa high variance relative average tree length sample could indicate outlier. proﬁles scaling justifying squared pairwise distances measure variance literature. however large sample sizes fr´echet variance faster compute. compute squared geodesic distances trees involves calculating geodesic distance iteration algorithm. number iterations required depends desired precision mean. however often obtained good results iterations suggesting computing variances approximately trees fr´echet variance calculation faster sum-of-squared-distance calculation. average length sample trees less average. demonstrates stickiness leads shorter mean trees diﬀerence lengths likely signiﬁcant ignored. importantly showed mean tree less sticky majority-rules topology fewer unresolved edges. euclidean median sticky euclidean mean since majority-rules topology median distance likely sticky mean tree. thus using mean instead majority-rules topology summarize trees gives resolution albeit higher computation cost. note iterative algorithm approximating mean works almost always produces binary trees edges length less approximation amount trimmed. gene trees even restrict coalescent model explaining gene tree diversity estimation still problematic regards. coalescent model pendant edges gene trees must least long pendant edges species tree usually longer. since pendant edge mean tree computed averaging length edge input trees pendant edges mean gene trees least long usually longer pendant edges true species tree. possible topology mean tree might still match species tree conjectured preliminary experiments suggest stickiness greatly limits amount information mean tree compared methods. preliminary experiments mean tree simulated gene trees became essentially unresolved gene trees still away anomalous zone common gene tree topology still species tree topology. essentially unresolved mean approximated mean tree within small distance unresolved. possible exact algorithm computing mean would give binary mean tree topology even cases iterative algorithm certain mean unresolved even would informative. biological data. shown mean likely resolved majority-rules tree variance stable reliable measure amount variability sample trees. validation opens door applications quantities. markov chain monte carlo algorithms converge. preliminary experiments mrbayes runs data paper show comparing variance sliding windows sampled trees identify burn-in variance trees sliding window remains roughly period. however datasets variance continue decrease burn-in indicating lack convergence. iterative algorithm computing mean easily adapted online algorithm iteration instead choosing tree random input trees next tree generated mcmc chain. unfortunately clear take advantage online algorithm computing variance requires computing distance current mean approximation sample trees seen far. however algorithms computing geodesics dynamically might help. would like thank anonymous reviewers comments suggestions greatly improved quality paper. also thank katherine john tandy warnow derrick zwickl lior pachter aasa feragen helpful discussions. acknowledges support fields institute. work partially supported grant simons foundation work supported nserc discovery grant.", "year": "2017"}