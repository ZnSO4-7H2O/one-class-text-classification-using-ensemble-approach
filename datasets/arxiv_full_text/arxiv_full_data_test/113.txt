{"title": "Flux-dependent graphs for metabolic networks", "tag": "q-bio", "abstract": " Cells adapt their metabolic fluxes in response to changes in the environment. We present a framework for the systematic construction of flux-based graphs derived from organism-wide metabolic networks. Our graphs encode the directionality of metabolic fluxes via edges that represent the flow of metabolites from source to target reactions. The methodology can be applied in the absence of a specific biological context by modelling fluxes probabilistically, or can be tailored to different environmental conditions by incorporating flux distributions computed through constraint-based approaches such as Flux Balance Analysis. We illustrate our approach on the central carbon metabolism of Escherichia coli and on a metabolic model of human hepatocytes. The flux-dependent graphs under various environmental conditions and genetic perturbations exhibit systemic changes in their topological and community structure, which capture the re-routing of metabolic fluxes and the varying importance of specific reactions and pathways. By integrating constraint-based models and tools from network science, our framework allows the study of context-specific metabolic responses at a system level beyond standard pathway descriptions. ", "text": "cells adapt metabolic ﬂuxes response changes environment. present framework systematic construction ﬂux-based graphs derived organism-wide metabolic networks. graphs encode directionality metabolic ﬂuxes edges represent metabolites source target reactions. methodology applied absence speciﬁc biological context modelling ﬂuxes probabilistically tailored diﬀerent environmental conditions incorporating distributions computed constraint-based approaches flux balance analysis. illustrate approach central carbon metabolism escherichia coli metabolic model human hepatocytes. ﬂux-dependent graphs various environmental conditions genetic perturbations exhibit systemic changes topological community structure capture re-routing metabolic ﬂuxes varying importance speciﬁc reactions pathways. integrating constraint-based models tools network science framework allows study context-speciﬁc metabolic responses system level beyond standard pathway descriptions. metabolic reactions enable cellular function converting nutrients energy assembling macromolecules sustain cellular machinery cellular metabolism usually thought collection pathways comprising enzymatic reactions associated broad functional categories. metabolic reactions highly interconnected enzymes convert multiple reactants products metabolites acting co-factors; enzymes catalyse several reactions reactions catalysed multiple enzymes enmeshed reactions thus naturally amenable network analysis approach successfully applied diﬀerent aspects cellular molecular biology e.g. protein-protein interactions transcriptional regulation protein structure tools graph theory previously applied analysis structural properties metabolic networks including degree distribution presence metabolic roles community structure central challenge however multiple ways construct network metabolic model example create graph metabolites nodes edges representing reactions transform metabolite another graph reactions nodes edges corresponding metabolites shared among even bipartite graph reactions metabolites nodes importantly conclusions graph-theoretical analyses highly dependent chosen graph construction feature metabolic reactions directionality metabolic networks contain irreversible reversible reactions reversible reactions change direction depending cellular environmental contexts many existing graph constructions however lead undirected graphs disregard directional information central metabolic function furthermore current graph constructions usually derived whole metabolic reactions organism thus correspond generic metabolic ‘blueprint’ cell. however cells switch speciﬁc pathways ‘on’ ‘oﬀ’ sustain energetic budget diﬀerent environments hence blueprint graphs might capture speciﬁc metabolic connectivity given environment thus limiting ability provide biological insights diﬀerent growth conditions. paper present ﬂux-based approach construct metabolic graphs encapsulate directional metabolites produced consumed enzymatic reactions. proposed graphs tailored incorporate distributions diﬀerent environmental conditions. introduce approach proceed steps. ﬁrst deﬁne probabilistic flux graph weighted directed graph reactions nodes edges represent supplier-consumer relationships reactions weights given probability metabolite chosen random produced/consumed source/target reaction. graph used carry graph-theoretical analyses organism-wide metabolic organisation independent cellular context environmental conditions. show formalism adapted seamlessly construct metabolic flux graph directed environment-dependent graph weights computed flux balance analysis widespread method study genome-scale metabolic networks. formulation addresses several drawbacks current constructions metabolic graphs. firstly graphs edge indicates metabolites produced source reaction consumed target reaction thus accounting metabolic directionality natural chemical mass reactants products. secondly probabilistic flux graph discounts naturally over-representation pool metabolites nicotinamide adenine dinucleotide protons water co-factors) appear many reactions tend obfuscate graph connectivity. construction avoids removal pool metabolites network change graph structure drastically finally metabolic flux graph incorporates additional biological information reﬂecting eﬀect environmental context graph construction. particular since weights correspond directly ﬂuxes diﬀerent biological scenarios analysed using balanced ﬂuxes diﬀerent carbon sources environmental perturbations introducing mathematical framework showcase approach examples. firstly absence environmental context analysis core model escherichia coli metabolism reveals importance including directionality appropriate edge weights graph understand modular organisation metabolic sub-systems. solutions computed several relevant growth conditions coli show structure changes dramatically case thus capturing environment-dependent nature metabolism. secondly study model human hepatocyte metabolism evaluated diﬀerent conditions wild-type mutation found primary hyperoxaluria type rare metabolic disorder show changes network structure mfgs reveal information complementary analysis ﬂuxes predicted fba. stoichiometric coeﬃcients species reaction denote concentration metabolite time deﬁne n-dimensional vector metabolite concentrations xn)t reaction takes place rate measured units concentration time compile reaction rates m-dimensional vector vm)t molecules produced consumed j-th reaction. figure shows example metabolic network including nutrient uptake biosynthesis metabolic intermediates secretion waste products biomass production fig. graphs metabolic networks. metabolic network describing nutrient uptake biosynthesis metabolic intermediates secretion waste products biomass production biomass reaction shared metabolites among reactions. probabilistic flux graph metabolic flux graphs constructed consumption production stoichiometric matrices note reversible reaction unfolded nodes. directed graph weights representing probability source reaction produces metabolite consumed target reaction. mfgs constructed diﬀerent flux balance analysis solutions obtained optimising biomass objective function diﬀerent constraints representing diﬀerent environmental cellular contexts weighted edges mfgs represent mass source target reactions units metabolic ﬂux. computed solutions translate diﬀerent connectivity resulting mfgs. irreversibility reactions furthermore structure dominated large number edges introduced pool metabolites appear many reactions water ions enzymatic cofactors. computational schemes introduced mitigate bias caused pool metabolites follow biophysical considerations need manual calibration. finally construction graph easily extended incorporate eﬀect environmental changes. address limitations reaction adjacency graph propose graph formulation follows ﬂux-based perspective. construct graph unfold reaction separate directions redeﬁne links reaction nodes reﬂect producer-consumer relationships. speciﬁcally reactions connected produces metabolite consumed other. shown below deﬁnition leads graphs naturally account reversibility reactions allows seamless integration biological contexts modelled fba. non-negative vectors containing forward backward reaction rates respectively. matrix diag contains main diagonal m-dimensional reversibility vector components reaction reversible irreversible. deﬁnitions rewrite metabolic model within directional framework natural consider purely probabilistic description producerconsumer relationships reactions follows. suppose given stoichiometric matrix without additional biological information metabolite concentrations reaction ﬂuxes kinetic rates. absence information probability metabolite produced reaction consumed reaction total number molecules produced consumed reactions. unlike models rely stochastic chemical kinetics probabilities contain information kinetic rate constants typically available genome-scale metabolic models formulation relevant probabilities contain stoichiometric information included matrix confused reaction propensity functions gillespie-type stochastic simulations biochemical systems. thus deﬁne weight edge reaction nodes probability metabolite chosen random produced consumed summing metabolites normalizing obtain edge weights adjacency matrix pseudoinverse. figure illustrate creation network. weighted directed graph encodes blueprint whole metabolic model provides natural scaling contribution pool metabolites transfer. remark distinct directed analogues constructed boolean production consumption stoichiometric matrices shown sec. cells adjust metabolic ﬂuxes respond availability nutrients environmental requirements. flux balance analysis widely used method predict environment-speciﬁc distributions. computes vector metabolic ﬂuxes maximise cellular objective solution obtained assuming steady state conditions subject constraints describe availability nutrients extracellular compounds core elements brieﬂy summarised section incorporate biological information aﬀorded solutions structure metabolic graph deﬁne graph edges terms production consumptions ﬂuxes. similarly unfold solution vector forward backward components positive entries solution correspond forward ﬂuxes negative entries solution correspond backward ﬂuxes. unfolded ﬂuxes construct graph deﬁne weight edge reactions total metabolites produced consumed assuming amount metabolite produced reaction distributed among reactions consume proportion metabolite reaction given provides versatile framework create environment-speciﬁc metabolic graphs solutions. figure illustrate creation mfgs network diﬀerent biological scenarios. case solution computed ﬁxed uptake remaining ﬂuxes constrained account diﬀerences biological environment scenario ﬂuxes constrained strictly positive larger nutrient uptake scenario impose positive lower bound reaction note scenario displays extra edge reactions well distinct edge weights scenario diﬀerences illustrate changes solutions translate diﬀerent graph connectivities edge weights. illustrate framework construct analyse graphs well-studied core metabolic model coli model contains metabolites reactions grouped pathways describe main biochemical routes central carbon metabolism provide supplemental spreadsheet full details reactions metabolites model well results presented below. fig. graphs core metabolism escherichia coli. coli core metabolic model created online tool escher standard reaction adjacency graph given nodes represent reactions; reactions linked undirected edge share reactants products. nodes coloured according pagerank score measure centrality proposed probabilistic flux graph metabolic model figure graph nodes undirected edges whereas graph nodes directed weighted edges. graph edges represent shared metabolites reactions directed edges graph represent eﬀect directionality becomes apparent comparing importance reaction nodes graphs measured pagerank score node centrality overall node hierarchy maintained across graphs exchange reactions tend pagerank centrality scores core metabolic reactions high scores biomass reaction highest scores graphs. also observe substantial changes speciﬁc reactions. example reactions maintenance phosphoenolpyruvate synthase abc-mediated transport l-glutamine formate lyase reaction highly connected rest network. importantly reversible reactions synthase wide pagerank forward backward reactions suggesting marked asymmetry importance metabolic ﬂows. community detection frequently used analysis complex graphs nodes clustered tightly related communities reveal coarse-grained structure graph potentially diﬀerent levels resolution community structure metabolic graphs subject multiple analyses however community detection methods applicable undirected graphs only thus fail capture directionality metabolic graphs propose here. account graph directionality markov stability community detection framework uses diﬀusion graphs detect groups nodes ﬂows retained persistently across time scales. markov stability ideally suited multi-resolution community structure deal directed undirected graphs case metabolic graphs markov stability reveal groups reactions closely interlinked metabolites produce consume. figure shows diﬀerence community structure undirected directed core metabolism coli. graph markov stability reveals partition seven communities largely dictated many edges created shared pool metabolites. example community mainly composed reactions consume produce water. biomass reaction member because standard graph construction connection involving equal weight. communities also determined pool metabolites e.g. dominated dominated nad+ nadp+ illustrated word clouds relative frequency metabolites reactions within community. community structure thus reﬂects limitations construction absence biological context large number uninformative links introduced pool metabolites. graph found robust partition communities comprise reactions related consistently biochemical pathways. community contains reactions community contains main reactions produce substrate level well oxidative phosphorylation biomass reaction. community includes core citric acid cycle anaplerotic reactions related malate syntheses well intake cofactors community contains reactions finally community contains reactions part pyruvate metabolism subsystem well transaltogether communities graph reﬂect metabolite ﬂows associated speciﬁc cellular functions consequence including directionality graph construction. seen fig. communities longer exclusively determined pool metabolites reactions core model coli metabolism grouped eleven biochemical pathways graphs edges shown. sankey diagrams show correspondence biochemical pathways communities found graph. word clouds contain metabolites participate reactions community word size proportional number reactions metabolite participates. incorporate impact environmental context construct metabolic flux graphs using solutions core model coli metabolism four relevant growth conditions aerobic growth rich media glucose; aerobic growth rich media ethanol anaerobic growth glucose; aerobic growth glucose phosphateammonium-limited. results figure show changes metabolite ﬂuxes diﬀerent biological contexts direct eﬀect mfg. note that cases mfgs fewer nodes aerobic growth d-glucose found robust partition three communities intuitive biological interpretation carbon-processing community comprising reactions process carbon d-glucose pyruvate including glycolysis pentose phosphate pathways together related transport exchange reactions. harbours bulk reactions related oxidative phosphorylation production energy cell including electron transport chain nadh dehydrofig. metabolic flux graphs escherichia coli diﬀerent growth conditions. mfgs computed solutions four diﬀerent environments aerobic growth d-glucose aerobic growth ethanol anaerobic growth d-glucose aerobic growth d-glucose limited ammonium phosphate. subﬁgure shows obtained escher increased colour arrows indicates increased ﬂux; metabolic flux graph nodes coloured according pagerank community structure computed markov stability method together sankey diagrams showing correspondence biochemical pathways communities. genase cytochrome oxidase synthase well transport reactions phosphate oxygen intake proton balance. also includes growth reaction consistent main substrate maintenance requirement biomass reaction growth condition. finally contains reactions related citric acid cycle production nadh nadph together carbon intake routes strongly linked cycle starting phosphoenolpyruvic acid aerobic growth ethanol robust partition three communities found scenario resembles structure mglc subtle important diﬀerences salient diﬀerences carbon-processing community reﬂects switch d-glucose ethanol carbon source. contains gluconeogenic reactions reversal induced change carbon source well anaplerotic reactions reactions related glutamate metabolism. particular reactions community related production precursors pyruvate -phospho-d-glycerate glyceraldehyde--phosphate d-fructose--phosphate d-glucose-phosphate substrates growth. consequently biomass reaction also grouped within increased metabolic precursors relative production biological scenario. reaction communities citric acid cycle display less prominent diﬀerences relative mglc graph additional pyruvate metabolism anaplerotic reactions well subtle ascriptions reactions involved nadh/nadph balance source acetyl-coa. anaerobic growth d-glucose profound impact absence oxygen metabolic balance cell reﬂected drastic changes connectivity reaction communities starkly diﬀerent aerobic scenarios much diminished presence oxidative phosphorylation absence ﬁrst steps electron transport chain found manaero robust partition four communities. still contains carbon processing decoupled pentose phosphate pathway. includes pentose phosphate pathway grouped citric acid cycle biomass reaction well growth precursors including alpha-d-ribose--phosphate d-erythrose--phosphate -oxalacetate nadph. communities speciﬁc anaerobic context contains conversion formate includes nadh production consumption reactions linked glyceraldehyde--phosphate dehydrogenase aerobic growth d-glucose limited phosphate ammonium growth-limiting conditions found robust partition three communities community structure reﬂects overﬂow metabolism occurs cell takes carbon process. consequence excess carbon secreted cell leading decrease growth partial shutdown citric acid cycle. reﬂected reduced weight pathway grouping secretion routes acetate formate within hence comprises reactions strongly coupled favourable growth conditions linked together metabolic responses limited ammonium phosphate. furthermore carbon-processing community contains glycolytic pathway detached pentose phosphate pathway highlighting role precursor formation. bioenergetic machinery contained community includes pentose phosphate pathway smaller role electron transport chain addition eﬀect community structure figure also shows changes induced environment connectivity relative importance reactions measured pagerank score. provide global snapshot eﬀect growth conditions cellular metabolism figure shows cumulative pagerank pathway mfgs. cumulative pagerank quantiﬁes relative importance pathways importance changes upon environmental shifts. aerobic growth shift glucose ethanol importance pentose phosphate pathway. shift aerobic anaerobic growth glucose sees large reduction importance oxidative phosphorylation citric acid cycle coupled large increase importance gluconeogenesis pyruvate metabolism transport exchange reactions. eﬀect pyruvate metabolism reduction importance oxidative phosphorylation citric acid cycle pentose phosphate pathway. importance transport exchange reactions also increased limiting conditions. qualitative relations growth conditions importance speciﬁc pathways highlights utility mfgs characterise systemic metabolic changes response environmental conditions. fig. pathway centrality computed diﬀerent growth conditions. cumulative pathway pagerank reﬂects relative importance metabolic pathways mfg. changes pathway centrality indicate overall rearrangement ﬂuxes within pathways response environmental shifts aerobic glucose-rich aerobic ethanol-rich; aerobic glucose-rich anerobic glucose-rich; aerobic glucose-rich similar medium limited phosphate ammonium. variations cumulative pagerank highlight changes across cellular pathways deﬁnition mfgs directed graphs opens application network-theoretic tools detecting modules reaction nodes hierarchical relationships among them. contrast methods undirected graphs markov stability framework used detect multi-resolution community structure directed graphs thus allowing exploration multiscale organisation metabolic reaction networks. modules detected reﬂect subsets reactions metabolic ﬂuxes tend contained. figure illustrates multiscale analysis mglc coli aerobic growth glucose. varying markov time parameter markov stability method scanned community structures diﬀerent resolutions. results show that ﬁner coarser resolution partitioned communities high persistence across markov time high robustness optimisation details section refs. sankey diagram fig. visualises pathway composition graph partitions relationships across diﬀerent resolutions. decrease resolution reactions diﬀerent pathways assemble split diﬀerent groupings reﬂecting speciﬁc relationships general organisation principles associated growth condition. general observation glycolysis grouped together oxidative phosphorylation across scales underlining fact pathways function cohesive metabolic sub-units aerobic conditions. contrast exchange transport pathways appear spread among multiple partitions across resolutions. expected exchange/transport enabling functional pathways reactions interact amongst rather feed substrates pathways. reaction groupings reﬂect speciﬁc relationships. example citric acid cycle appears cohesive unit across scales splits ﬁnal grouping reﬂecting global role cycle linking glycolysis oxidative phosphorylation. pentose phosphate pathway hand split groups across early scales merging community towards ﬁnal groupings. suggests interconnected relationship diﬀerent steps penthose phosphate pathway rest metabolism. figure present multiscale analyses reaction communities three growth scenarios showcase applicability framework larger metabolic models analyse model human hepatocyte metabolism metabolites reactions extends widely used hepatonet model fig. community structure graphs across diﬀerent scales. applied markov stability method partition metabolic graph coli aerobic growth glucose across levels resolution. panel shows number communities optimal partition measures robustness function markov time markov times selected correspond robust partitions graph communities signalled extended values values sankey diagram visualises multiscale organisation communities graph across markov times relationship communities biochemical pathways. bottom panel shows partitions selected markov times. partition communities corresponds figure additional reactions metabolites. extended model used ref. compare wild type cells cells aﬀected rare disease primary hyperoxaluria type lack alanineglyoxylate aminotransferase genetic mutation. enzyme found peroxisomes mutation decreases breakdown glyoxylate subsequent accumulation calcium oxalate leads liver damage. following ﬁrst obtain solutions diﬀerent sets metabolic objectives wild type model model lacking generate corresponding mfgs obtain averages ensemble mph. reactions model forward reverse reactions present least solutions. hence average mfgs nodes fig. analysis model human hepatocyte metabolism genetic condition average wild-type hepatocytes cells metabolic objectives. reaction nodes coloured according communities -way partition obtained markov stability. sankey diagramme shows consistency communities wild type communities independently found mutated cells. word clouds frequent metabolites reactions communities reveal functional groupings mutation large change relates metabolites join community comparison pagerank percentiles mfgs reactions whose rank changes percentiles labelled. diﬀerence diﬀerence pagerank percentile reactions whose diﬀerence greater mmol/gdw/h whose change pagerank percentile greater labelled. diﬀerences centrality provide complementary information revealing additional important reactions aﬀected mutation knocks reaction figure shows wild type coloured according robust partition communities obtained markov stability. seven communities broadly linked amino acid metabolism energy metabolism glutathione metabolism fatty acid bile acid metabolism cholesterol metabolism lipoprotein particle assembly expected network community structure largely preserved mutation sankey diagramme fig. shows remarkable match partitions found independently markov stability. despite similarity method also identiﬁed subtle important diﬀerences healthy diseased networks. particular receives reactions almost taking place peroxisome linked mevalonate iso-pentenyl pathways well highly central transfer reactions peroxisome cytosol overall centrality reactions relatively unaﬀected mutation shown good correlation pagerank percentiles figure notable exceptions reactions exhibit largest change pagerank centrality provide biological insights disease state. speciﬁcally four reactions undergo largest increase centrality related transfer citrate cytosol exchange oxalate pep; whereas largest decrease pagerank related vldl-pool reactions transfers hydroxypyruvate alanine peroxisome cytosol worth remarking although oxalate citrate reactions directly linked metabolic changes associated diseased state none exhibits large changes predicted show large changes pagerank centrality. observations underscore information provided network analysis provides complementary information analysis ﬂuxes alone. shown figure group reactions exhibit large gains decreases mutation undergo relatively small changes pagerank scores. closer inspection reveals reactions close reaction pathway involve conversion glycolate pyruvate glycine alanine serine. hence changes follow local rearrangement ﬂows consequence deletion reaction hand citrate oxalate reactions large changes centrality undergo small changes thus reﬂecting global changes structure network. importantly transport reactions serine hydroxypyruvate cytosol peroxisome undergo large changes centrality highlighting importance peroxisome transfer reactions provide full spreadsheet analyses supplementary material interested reader. metabolism commonly understood terms functional pathways interconnected metabolic networks i.e. metabolites linked arrows representing enzymatic reactions figure however standard representations amenable rigorous graph-theoretic analysis. fundamentally diﬀerent graphs constructed metabolic reactions depending chosen representation species/interactions nodes/edges e.g. reactions nodes; metabolites nodes; reaction metabolites nodes graphs directed undirected weighted links computed according diﬀerent rules. choices subtleties graph construction crucial capture relevant metabolic information interpret topological properties here presented ﬂux-based strategy build graphs metabolic networks. graphs reactions nodes directed weighted edges representing metabolites produced source reaction consumed target reaction. principle applied build ‘blueprint’ graphs summarise probabilistically ﬂuxes whole metabolism organism well context-speciﬁc graphs reﬂect speciﬁc environmental conditions. blueprint probabilistic flux graph edge weights equal probability source/target reactions produce/consume molecule metabolite chosen random absence information thus used stoichiometric matrix information available. construction naturally tames over-representation pool metabolites without need remove graph arbitrarily often done literature context-speciﬁc metabolic flux graphs incorporate eﬀect environment e.g. edge weights corresponding total metabolites reactions computed flux balance analysis solutions diﬀerent environments used build diﬀerent metabolic graphs diﬀerent growth conditions. proposed graph constructions provide complementary tools studying organisation metabolism embedded fba-based modelling pipeline. speciﬁcally relies availability wellcurated stoichiometric matrix produced metabolic reconstruction techniques typically precede application fba. hand explicitly uses solutions construction. methods provide systematic framework convert genome-scale metabolic models directed graph analysis tools network theory applied. exemplify approach built analysed mfgs core metabolism coli. analysis topological properties community structure graphs highlighted importance weighted directionality metabolic graph construction revealed ﬂux-mediated relationships functional pathways diﬀerent environments. particular mfgs capture speciﬁc metabolic adaptations glycolytic-gluconeogenic switch overﬂow metabolism eﬀects anoxia. proposed graph construction readily applied large genome-scale metabolic networks illustrate scalability analyses larger metabolic models studied genome-scale model large metabolic model human hepatocytes around reactions compared wild type mutated state associated disease metabolic conditions network analysis mfgs revealed consistent organisation reaction graph highly preserved mutation. analysis also identiﬁed notable changes network centrality score community structure certain reactions linked biological processes importantly network measures computed mfgs reveal complementary information provided sole analysis perturbed ﬂuxes. graphs provide systematic connection network theory constraint-based methods widely employed metabolic modelling thus opening avenues towards environment-dependent graph-based analyses cell metabolism. area interest future research mfgs study network measures graphs help characterise metabolic conditions maximise eﬃcacy drug treatments diseaserelated distortions e.g. cancer-related metabolic signatures particular mfgs quantify metabolic robustness graph statistics upon removal reaction nodes proposed graph construction framework extended diﬀerent directions. core idea behind framework distinction production consumption ﬂuxes encode links graph. general principle also used build potentially useful graphs. example graphs describe relationships reactions approach could also extended include dynamic adaptations metabolic activity using dynamic extensions incorporating static time-varying enzyme concentrations; considering kinetic models generate probabilistic reactions ﬂuxes sense stochastic chemical kinetics particular interest metabolic modelling envision mfgs could provide novel route evaluate robustness solutions exploiting non-uniqueness solution space graphs. results could enhance interface network science metabolic analysis allowing systematic exploration system-level organisation metabolism response environmental constraints disease states. flux balance analysis widely-adopted approach analyse metabolism cellular growth. calculates reaction ﬂuxes optimise growth speciﬁc biological contexts. main hypothesis behind cells adapt metabolism maximise growth diﬀerent biological conditions. conditions encoded constraints ﬂuxes certain reactions; example constraints reactions import nutrients necessary compounds exterior. stoichiometry matrix model vector ﬂuxes indicator vector biomass reaction zero everywhere else) biomass reaction. constraint enforces mass-conservation stationarity lower upper bounds reaction’s ﬂux. vectors encode variety diﬀerent scenarios biomass reaction represents widely-used optimised although others used well simulations individual carbon intake rate mmol/gdw/h every source available scenario. allowed oxygen intake reach maximum needed consume carbon except anaerobic condition scenario upper bound oxygen intake mmol/gdw/h. scenario limited phosphate ammonium intake levels phosphate intake ﬁxed mmol/gdw/h mmol/gdw/h respectively extract communities network using markov stability community detection framework framework uses diﬀusion processes network groups nodes retain ﬂows longer would expect comparable random network; addition markov stability incorporates directed ﬂows seamlessly analysis diﬀusion process continuous-time markov process network. adjacency matrix outg gij. node outgoing edges simply kouti general directed network strongly-connected thus markov process unique steady state. ensure uniqueness steady state must teleportation component dynamics random walker visiting node follow outgoing edge probability jump entry measures likely random walker started process community ﬁnds community time stationarity. diagonal elements thus record good communities retaining ﬂows. markov stability partition deﬁned time obtain optimised partition optimisation np-hard; hence guarantees optimality. louvain greedy optimisation heuristic known give high quality solutions node community; grows obtain larger communities random walkers time explore network scan range values explore multiscale community structure network. code markov stability found github.com/michaelschaub/partitionstability. identify important partitions across time criteria robustness firstly optimise times value assess consistency solutions found. relevant partition robust outcome optimisation i.e. ensemble optimised solutions similar measured normalised variation information louvain runs return similar partitions small indicating robustness partition optimisation. hence select partitions values secondly relevant partitions also optimal across markov time indicated values cross-time variation information m.b.d. acknowledges support james mcdonnell foundation postdoctoral program complexity science/complex systems fellowship award oxford-emirates data science lab. g.b. acknowledges support spanish ministry economy program d.o. acknowledges support imperial college research fellowship human frontier science program young investigator grant j.p. acknowledges support spanish ministry economy feder synbiofactory project m.b. acknowledges funding epsrc grants ep/i/ ep/n/. production comes mostly oxidative phosphorylation substrate level phosphorylation reactions phosphofructokinase phosphoglicerate kinase succinil-coa synthase reactions consume include glutamine synthetase maintenance equivalent reaction reactions l-glutamine transport system acetate transport form phosphotransacetilase acetate kinase also part community. additionally contains also reactions involve normal conditions water assumed abundant cell thus biological link groups reactions together tenuous. community includes reactions nadh dehydrogenase cytochrome oxidase transport exchange reactions. reactions involve pool metabolites create large number connection. members include fumarate reductase succinate dehydrogenase couple cycle electron transport chain reactions include export transport secondary carbon sources included community well. reactions included community inﬂuence proton balance cell. reactions occur normal circumstances. community highlights fact absence biological context many reactions normally interact grouped together. community contains reactions produce consume nicotinamide adenine dinucleotide nicotinamide adenine dinucleotide phosphate reduced variants nadh nadph. main reactions community transhydrogenase nad+ transhydrogenase also reactions related production nadh nadph cycle isocitrate dehydrogenase -oxoglutarate dehydrogenase malate dehydrogenase community also includes reactions frequently active malic enzime malic enzime nadh acetate dehydrogenase ethanol dehydrogenase pentose phosphate shunt. reactions found community metabolites involved reactions d-erythrose--phosphate found reactions. community includes biomass reaction number connections created growth precursors. fig. community structure template networks communities plot variation information best partition found markov time every partition time bottom plot number communities ensemble solutions found markov time. robust partition seven communities found communities robust partition oxidative phosphorylation metabolites among reactions community includes pool metabolites phosphate. however connections created metabolites appear handful reactions adenosine monophosphate whose sole producer phosphoenolpyruvate synthase sole consumer atpsr. community also contains biomass reaction. hydrogenase pyruvate formate lyase acetaldehyde dehydrogenase addition also includes tranport reaction common secondary carbon metabolites lactate formate acetaldehyde ethanol. function reactions community consists carbon intake processing glucose phosphoenolpyruvate community produces essential biocomponents cell alpha-d-ribose -phosphate d-erythrose -phosphate d-fructose--phosphate glyceraldehyde--phosphate -phospho-d-glycerate reactions produce energy reductive capabilities catabolism. core coli metabolic model chain represented reactions nadh dehydrogenase cytochrome oxidase synthase community also contains associated reactions electron transport phosphate intake pit) oxygen intake proton balance community also includes reactions represent energy maintenance costs growth consistent biological scenario main substrate atpm biomass reaction. nadh nadph. contrast precursor formation here. beyond cycle pyruvate kinase phosphoenolpyruvate carboxylase pyruvate dehydrogenase appear community. reactions highlight main carbon intake routes cycle oxalacetate phosphoenol pyruvate carboxylase citrate acetyl coenzyme citrate synthase furthermore routes begin natural belong community along rest cycle. likewise production l-glutamate -oxoglutarate glutamate dehydrogenase strongly coupled cycle. example reactions charge glucose intake glcpts) longer part network reactions malic enzyme napd phosphoenolpyruvate caboxykinase appear network belong community. change network reﬂect cell’s response biological situation. carbon intake ethanol changed direction glycolysis gluconeogenesis fig. operating reverse direction fig. main role reactions community production bioprecursors pyruvate -phospho-d-glycerate glyceraldehyde--phosphate d-fructose--phosphate d-glucose--phosphate substrates growth. reactions ppck also belong community production pep. reactions diﬀerent community mglc gludy icdhyr produce precursors l-glutamate nadph respectively part community also includes reactions produce inorganic substrates growth however subtle diﬀerences reﬂect changes scenario. ethanol intake transport reactions etohtr) appear community inﬂuence proton balance cell. addition contains nadp transhydrogenase charge nadh/nadph balance. reaction present consumption involved reactions acald ethanol dehydrogenase belong community well. acetyl-coa extracted acetaldehyde reaction acetaldehyde dehydrogenase reaction instead classical pyruvate glycolysis. glycoxylate cycle reactions isocitrate lyase malate synthase appear network also belong community. reactions tightly linked cycle appear carbon intake acetate ethanol prevent loss carbon reaction represents cellular maintenance energy cost maintenance requirement included community increased strength connection substrate-level phosphorilation reaction phosphoglycerate kinase also note reactions pentose phosphate pathway belong community glycolysis reactions strates. reactions include pentose phosphate pathway produce essential growth precursors alpha-d-ribose--phosphate d-erythrose--phosphate cycle present well production growth precursors -oxalacetate nadph. finally reactions charge acetate production also members community ability ackr produce atp. glutamate metabolism reaction gludy also included community. worth mentioning reverse synthase present community here unlike mglc atpsr consumes instead producing reversed atpsr part responsible homeostasis. occurs glyceraldehyde--phosphate dehydrogenase nadh consumption occurs consecutive steps ethanol production acald alcdx. phosphate intake transport reactions expi pitr belong community phosphate consumption takes place gapd. interestingly core reaction around community forms present community. included earlier markov times communities start larger role gapd becomes relevant part glycolysis role nadh hub. good example graph structure clustering method able capture diﬀerent roles metabolite. scenarios electron transport chain smaller role production substratelevel phosphorylation becomes important. mlim electron transport chain responsible total produced cell mglc produces reactions charge intake transport inorganic ions phosphate pitr) ot)and belong community well. community includes reactions pentose phosphate pathway produce precursors growth transketolase produces ribose--phosphate isomerase produces community gathers reactions normal circumstances would strongly related limited availability ammonium phosphate forced together; members include reactions cycle pentose phosphate pathway nitrogen metabolism by-product secretion. core feature community carbon secretion formate acetate. reactions malate dehydrogenase reverse channel carbon secretion routes form formate acetate. production l-glutamine seems attached subsystem production nadph consumption glutamate dehydrogenase napd fig. community structure mfgs. number communities mfgs four biological scenarios. graph mglc robust partition three communities metoh partition three communities manaero four communities mlim three communities berg tymoczko stryer biochemistry fifth edition. freeman; thomas cannings monk cannings structure protein–protein interaction networks. biochemical amor yaliraki woscholski barahona uncovering allosteric pathways caspase- using markov transient analysis multiscale community detection. molecular biosystems. aug;–. available from http //www.ncbi.nlm.nih.gov/pubmed/. newman networks introduction. york oxford university press inc.; jeong tombor albert oltvai barab´asi large-scale organization metabolic networks. nature. ravasz somera mongru oltvai barab´asi hierarchical organization modularity metabolic networks. science aug;–. available from http//science.sciencemag.org/content// /.abstract. zhou nakhleh convergent evolution modularity metabolic networks diﬀerent community structures. evolutionary biology. jan;. available from http//bmcevolbiol.biomedcentral.com/articles/. /---. zhao yuan zeng decomposition metabolic network functional modules based global connectivity structure reaction graph. bioinformatics aug;–. available from http//www.ncbi.nlm.nih.gov/pubmed/. inﬂuence metabolic network structure function enzyme evolution. genome biology. jan;r. available from http//genomebiology.biomedcentral.com/articles/./ gb----r. samal singh giri krishna raghuram jain degree metabolites explain essential reactions enhance modularity biological networks. bioinformatics. jan;. available from http//www.pubmedcentral.nih. gov/articlerender.fcgi?artid={\\&}tool=pmcentrez{\\&}rendertype=abstract. smart amaral ottino cascading failure robustness metabolic networks. proceedings national academy sciences united states america. sep;–. available from http//www.pnas.org/ content///.full. sauer lasko fiaux hochuli glaser szyperski metabolic ratio analysis genetic environmental modulations escherichia coli central carbon metabolism. journal bacteriology. nov;–. available from http//www.ncbi.nlm.nih.gov/pubmed/http//www.pubmedcentral.nih.gov/articlerender. fcgi?artid=pmc. zeng reconstruction metabolic networks genome data analysis global structure various organisms. bioinformatics. available from http//bioinformatics.oxfordjournals.org/content/ //.abstract. orth fleming palsson reconstruction microbial metabolic networks core escherichia coli metabolic model educational guide. ecosal plus. ;available from http//www.asmscience.org/content/ journal/ecosalplus/./ecosalplus.... pagliarini castello napolitano borzone annunziata mandrile silico modeling liver metabolism human disease reveals enzyme histidine histamine homeostasis. cell reports. available from http//dx.doi.org/./j.celrep.... srinivasan cluett mahadevan constructing kinetic models metabolism genome-scales review. biotechnology journal. sep;–. available from http//www.ncbi.nlm.nih.gov/pubmed/http//doi. wiley.com/./biot.. king dr¨ger ebrahim sonnenschein lewis palsson escher application building sharing embedding data-rich visualizations biological pathways. plos comput biol. available from http//dx.doi.org/.%fjournal.pcbi.. schuster fell dandekar general deﬁnition metabolic pathways useful systematic organization analysis complex metabolic networks. biotechnol. mar;–. available from http//dx.doi.org/ schilling letscher palsson theory systemic deﬁnition metabolic pathways interpreting metabolic function pathway-oriented perspective. theor biol. apr;–. available from http //dx.doi.org/./jtbi... schaub delvenne yaliraki barahona markov dynamics zooming lens multiscale community detection clique-like communities ﬁeld-of-view limit. plos one. available from http //arxiv.org/abs/.. delvenne schaub yaliraki barahona stability graph partition dynamics-based framework community detection. mukherjee choudhury peruani ganguly mitra editors. dynamics complex networks volume modeling simulation science engineering technology. springer york; beguerisse-d´ıaz gardu˜no hern´andez vangelov yaliraki barahona interest communities roles directed networks twitter network riots. interface. dec;. available from http //rsif.royalsocietypublishing.org/content///. vemuri eiteman mcewen olsson nielsen increasing nadh oxidation reduces overﬂow metabolism saccharomyces cerevisiae. proc natl acad feb;–. available from http//dx.doi.org/ ./pnas.. bacik schaub beguerisse-d´ıaz billeh barahona flow-based network analysis caenorhabditis elegans connectome. plos comput biol. available from http//dx.doi.org/.%fjournal. pcbi.. gille b¨olling hoppe bulik hoﬀmann h¨ubner hepatonet comprehensive metabolic reconstruction human hepatocyte analysis liver physiology. molecular systems biology. available from http//msb.embopress.org/content///. csermely ´agoston pongor eﬃciency multi-target drugs network approach might help drug design. trends pharmacological sciences. available from http//www.sciencedirect.com/science/ article/pii/s. chang bourne palsson drug oﬀ-target eﬀects predicted using structural analysis context metabolic network model. plos comput biol. available from http//dx.doi.org/./ journal.pcbi.. waldherr oyarz´un bockmayr dynamic optimization metabolic networks coupled gene expression. journal theoretical biology. nov;–. available from http//www.sciencedirect.com/science/article/pii/ r¨ugen bockmayr steuer elucidating temporal resource allocation diurnal dynamics phototrophic metabolism using conditional fba. scientiﬁc reports. jan;. available from http//www.pubmedcentral. nih.gov/articlerender.fcgi?artid={\\&}tool=pmcentrez{\\&}rendertype=abstract. colijn brandes zucker weiner farhat interpreting expression data metabolic flux models predicting mycobacterium tuberculosis mycolic acid production. plos comput biol. available from http//dx.doi.org/.%fjournal.pcbi.. blondel guillaume lambiotte lefebvre fast unfolding communities large networks. journal statistical mechanics theory experiment. available from http//stacks.iop.org/-// i=/a=p.", "year": "2016"}