{"title": "Weighted Statistical Binning: enabling statistically consistent  genome-scale phylogenetic analyses", "tag": "q-bio", "abstract": " Because biological processes can make different loci have different evolutionary histories, species tree estimation requires multiple loci from across the genome. While many processes can result in discord between gene trees and species trees, incomplete lineage sorting (ILS), modeled by the multi-species coalescent, is considered to be a dominant cause for gene tree heterogeneity. Coalescent-based methods have been developed to estimate species trees, many of which operate by combining estimated gene trees, and so are called summary methods. Because summary methods are generally fast, they have become very popular techniques for estimating species trees from multiple loci. However, recent studies have established that summary methods can have reduced accuracy in the presence of gene tree estimation error, and also that many biological datasets have substantial gene tree estimation error, so that summary methods may not be highly accurate on biologically realistic conditions. Mirarab et al. (Science 2014) presented the statistical binning technique to improve gene tree estimation in multi-locus analyses, and showed that it improved the accuracy of MP-EST, one of the most popular coalescent-based summary methods. Statistical binning, which uses a simple statistical test for combinability and then uses the larger sets of genes to re-calculate gene trees, has good empirical performance, but using statistical binning within a phylogenomics pipeline does not have the desirable property of being statistically consistent. We show that weighting the recalculated gene trees by the bin sizes makes statistical binning statistically consistent under the multispecies coalescent, and maintains the good empirical performance. Thus, \"weighted statistical binning\" enables highly accurate genome-scale species tree estimation, and is also statistical consistent under the multi-species coalescent model. ", "text": "weighted statistical binning enabling statistically consistent genome-scale phylogenetic analyses shamsuzzoha bayzid siavash mirarab bastien boussau tandy warnow∗ department computer science university texas austin austin texas laboratoire biom´etrie biologie ´evolutive universit´e lyons france department computer science university illinois urbana-champaign urbana biological processes result different loci different evolutionary histories species tree estimation requires multiple loci across multiple genomes. many processes result discord gene trees species trees incomplete lineage sorting modeled multi-species coalescent considered dominant cause gene tree heterogeneity. coalescent-based methods developed estimate species trees many operate combining estimated gene trees called summary methods. summary methods generally fast become popular techniques estimating species trees multiple loci. however recent studies established summary methods reduced accuracy presence gene tree estimation error also many biological datasets substantial gene tree estimation error summary methods highly accurate biologically realistic conditions. mirarab presented statistical binning technique improve gene tree estimation multi-locus analyses showed improved accuracy mp-est popular coalescent-based summary methods. statistical binning uses simple heuristic evaluate combinability uses larger sets genes re-calculate gene trees good empirical performance using statistical binning within phylogenomic pipeline desirable property statistically consistent. show weighting re-calculated gene trees sizes makes statistical binning statistically consistent multispecies coalescent maintains good empirical performance. thus weighted statistical binning enables highly accurate genome-scale species tree estimation also statistically consistent multi-species coalescent model. data used study available http//dx.doi.org/./m.figshare. software available https//github.com/smirarab/binning. estimation phylogenetic trees whether individual loci genomelevel basic step many biological analyses however estimating gene trees species trees high accuracy difficult many reasons including computational issues dataset issues. example highly accurate gene trees computed loci locus limited phylogenetic signal gene tree estimated partial accuracy. species tree estimation also difficult different loci different phylogenetic trees phenomenon occurs several different biological processes. particular many groups species evolve rapid speciation events process likely produce conflict gene trees species trees incomplete lineage sorting furthermore occurs standard methods estimating species trees concatenation consensus methods statistically inconsistent produce highly supported incorrect trees standard methods estimating species trees multiple loci positively misleading presence gene tree heterogeneity statistical methods developed estimate species tree assuming gene tree heterogeneity particular poor phylogenetic signal. describe recent approaches estimating species tree multiple sequence alignments different loci species. assume input sequence data generated multi-step process define definition gtr+msc model gene trees evolve within species tree multispecies coalescent model sequences evolve gene tree general time reversible model different gene trees equipped model thus gtr+msc model method estimating species tree begin sets sequences different loci infer species tree. many different types methods estimate species trees sets sequence alignments multiple loci refer methods phylogenomic pipelines. definition phylogenomic pipeline statistically consistent gtr+msc model number loci number sites sequence alignment locus increase infinity estimated species tree converges probability true species tree. many phylogenomic pipelines statistically consistent gtr+msc model study focus pipelines operate first estimating gene trees combining estimated gene trees using summary method. specifically restrict discussion pipelines coalescent-based summary methods follows definition coalescent-based summary method method estimates species tree combining gene trees converges probability true species tree number true gene trees sampled distribution defined species tree increases. examples coalescent-based summary methods include mp-est astral star njst coalescent-based analyses biological datasets typically kind pipeline since computationally efficient types coalescent-based analyses co-estimate gene trees species tree). many studies explored statistical properties coalescent-based summary methods given true gene trees focus input sequence alignments multiple loci. context proofs statistical consistency gtr+msc phylogenomic pipelines taken following form first gene trees estimated using statistically consistent method maximum likelihood assume sequences locus long enough true gene tree computed high probability. then species tree estimated using coalescent-based summary method. thus proofs statistical consistency gtr+msc model common coalescent-based summary methods explicitly implicitly assumed true gene trees given input summary method. little mathematical theory proven impact gene tree estimation error coalescent-based summary methods; example known whether standard summary methods converge true species tree given large enough number gene trees gene tree estimated bounded length sequences furthermore empirical studies suggest summary methods impacted gene tree estimation error produce less accurate estimated species trees concatenation gene tree estimation error high enough examples studies summary methods discussion). genome-scale analysis unlikely loci substantial phylogenetic signal vulnerability gene tree estimation error means coalescent-based summary methods highly accurate techniques estimating species trees genome-scale data. particularly problematic sequences locus kept short diminish probability intra-locus recombination since short sequences tend insufficient phylogenetic signal provide full resolution gene trees; discussion important issue. developed technique called statistical binning improve species tree estimation using phylogenomic pipelines based coalescent-based summary methods. statistical binning partitions genes sets based heuristic evaluate combinability concatenates gene sequence alignments within supergene alignment estimates supergene tree supergene alignment using fully partitioned maximum likelihood analysis. newly estimated supergene trees used preferred coalescent-based summary method compute species tree dataset. shown statistical binning improved estimation gene trees gene tree distributions resulted improved estimates species tree topology branch lengths species trees computed using mp-est multi-locus bootstrapping furthermore used statistical binning mp-est almost always least accurate concatenation finally mp-est used statistical binning used compute species tree avian phylogenomic dataset mp-est* tree nearly identical concatenation analysis obtained; mp-est* concatenation trees presented major hypotheses avian phylogeny. thus mirarab proposed type phylogenomic species tree estimation pipeline four steps instead pipeline referred statistical binning showed promising results used mp-est. however address theoretical properties pipelines examined model trees species analyzed coalescent-based summary method mp-est. unweighted statistical binning technique) biological simulated datasets gtr+msc model. examine pipelines using coalescent-based summary methods astral mp-est. include results simulated biological datasets studied also additional simulated datasets taxa. study shows weighted unweighted statistical binning similar results across datasets also astral mp-est tend improve accuracy used binning. however condition statistical binning reduced accuracy mp-est astral. thus study shows binning often beneficial also conditions binning increase rather decrease species tree error. finally conclude suggestions research. statistical binning technique presented operates follows. input multiple sequence alignment given genes user-specified threshold support value role threshold specify branches gene trees considered reliable ones support branches estimation error. therefore trees genes differ support edges differences considered potentially consistent estimation error genes considered combinable compatible. statistical binning computes maximum likelihood gene trees bootstrap support branches gene uses simple heuristic based bootstrap support values genes gene trees conflicting branches bootstrap support least combinability test genes considered combinable highly supported conflicting branches otherwise considered combinable. finally pairwise compatibility ensures setwise compatibility gene trees tree combines highly supported branches trees set. first step statistical computing using incompatibility graph genes. binning creates graph based input uses graph-theoretic optimization genes subsets. gene represented single vertex graph edge placed genes gene trees combinable based heuristic described above. determining genes combinable computed linear time graph call incompatibility graph computed time linear number taxa quadratic number genes. since longer sequences tend produce accurate gene trees bins large possible desirable; accomplished indirectly seeking coloring colors possible np-hard problem however summary methods mp-est distribution gene trees estimate species tree. assuming gene tree reconstruction error results low-support branches binning genes bins nearly size means supergene tree frequency close true gene tree distribution note also constraint frequent true gene tree topologies represented several bins rarest gene trees represented smaller number bins therefore objective coloring vertices using small number colors every color class contains number colors. achieve coloring modified br´elaz heuristic minimum vertex coloring greedy coloring node added smallest conflicts. coloring produces partitioning vertices graph subsets based color classes; thus vertices color bin. computing supergene tree bin. vertex coloring computed genes given color class form alignments concatenated supergene alignment. then maximum likelihood tree computed supergene alignment. estimating supergenes fully partitioned analysis gene assigned separate partition numeric model parameters allowed differ partitions. call trees computed supergene alignments supergene trees. using fully partitioned analysis theoretical guarantees statistical binning specifically discuss step pipeline. concatenated analyses alignments different loci performed many ways theoretical properties depend details performed particular whether performed using unpartitioned analysis partitioned analysis. unpartitioned analysis sites concatenated alignment assumed evolve single model tree model tree maximizing likelihood sought matrix. contrast fully partitioned analyses concatenated alignments assume different loci evolve tree topology allow different parts within concatenated alignment different values numeric parameters model. context model fully partitioned maximum likelihood analysis would allow locus substitution matrix topology returned also different lengths branch different substitution matrices. fully partitioned unpartitioned maximum likelihood analyses result different trees analyses different theoretical properties; example provided methods section below. applying summary methods supergene trees. supergene trees used coalescent-based summary method estimate species tree. words recalculating gene trees statistical binning changes input coalescent-based summary method. hence statistical binning technique re-estimate gene trees used within coalescent-based pipeline species tree estimation shown fig. theoretical properties pipelines based statistical binning. theorem shows statistical binning within phylogenomic pipeline statistically consistent gtr+msc model. failure statistically consistent occurs require bins equally sized; hence distribution supergene trees different true gene tree distribution. however simple variation technique suggested corrects problem. keep first step statistical binning compute supergene trees. however point replicate every supergene tree appears many times number genes bin. example begin genes obtain bins original statistical binning technique would produce supergene trees would given mp-est analyze. modified technique begin genes supergene trees call technique weighted statistical binning refer original technique proposed unweighted statistical binning. prove weighted statistical binning statistically consistent theorem fig. describes three possible pipelines summary method. unbinned analysis gene analyzed independently gene tree estimated gene summary method mp-est uses gene trees estimate species tree. weighted unweighted binned analyses gene trees computed independently incompatibility graph formed vertex gene. shown example genes graph vertices. vertices incompatibility graph assigned colors vertices colored purple three vertices colored green three vertices colored four vertices colored blue. note vertices color edge them. color class sequence alignments associated genes concatenated long supergene alignment supergene tree computed supergene alignment using fully partitioned maximum likelihood analysis. point weighted unweighted binning methods different strategies. unweighted binning method exactly copy supergene tree given input summary method weighted binning method multiple copies supergene trees given input. hence example mp-est analyzes four supergene trees unweighted binning pipeline analyzes supergene trees weighted binning pipeline. design sizes exactly same statistical binning pipelines produced using weighted unweighted statistical binning produce results; hence approaches produce different results binning unbalanced. datasets. avian mammalian simulated datasets studied collections simulated datasets taxa. simulated datasets range moderately extremely high conditions range terms average gene tree bootstrap support thus simulated datasets provide range conditions explore impact statistical binning. also analyzed biological datasets studied used biologically-based simulated datasets studied based species trees estimated using mp-est avian dataset mammalian dataset avian simulation markers vary sequence length order produce bootstrap support values similar observed biological dataset. mammalian simulation explored impact phylogenetic signal varying sequence length markers. cases three levels simulated multiplying dividing internal branch lengths model species tree also explore various numbers genes. mammalian datasets range level relatively branch length level relatively high branch length level average bootstrap support estimated gene trees ranges shorter sequences moderately high longest sequences. avian datasets higher levels mammalian datasets range moderate branch length condition high branch length condition. estimated gene trees range average bootstrap support shortest sequences moderate longest sequences. also used -taxon model species tree caterpillar-like topology short internal branches succession condition gives rise high levels ultrametric gene trees simulated tree using multi-species coalescent process unlike biologically-based model conditions transformations branch lengths used therefore gene trees follow strict molecular clock. sequence data simulated gene tree built four model conditions trimming gene data sites using genes. dataset homogeneous since replicates simulated based species tree gene trees differ topology branch length coalescence process. -taxon datasets high levels represent rather extreme condition. gene trees estimated shorter sequences average bootstrap support combination high average bootstrap support represents challenging condition. gene trees estimated longer sequences better average bootstrap support represent somewhat easier condition. also generated -taxon simulated datasets using simphy simulation protocol simulated different species tree replicate simulated gene trees species tree using multi-species coalescent process. simulated model conditions high another somewhat lower ils. simphy procedure uses host various distributions make gene trees heterogeneous various aspects sequence lengths deviation branch lengths strict molecular clock rate variation across different genes. used gene trees simulate sequence data sites using indelible therefore -taxon datasets heterogeneous different replicates different species trees within replicate various genes different rates evolution. levels -taxon datasets range moderately high lower condition extremely high higher condition. average bootstrap support estimated gene trees ranged higher condition lower condition poor average bootstrap support. thus -taxon -taxon datasets short sequences represent hardest model conditions high average bootstrap support. simulated datasets studied varied many respects table presents data level reflected average topological distance true gene trees true species tree. note model conditions extremely high reflected average topological distances true gene trees species tree. fact model conditions high levels model condition levels likely levels mammalian avian simulated datasets larger levels respective biological datasets since model trees used generate data based mp-est analyses datasets results suggest mp-est estimations tend under-estimate branch lengths hence inflate estimated levels. table topological discordance true gene trees true species tree. collection simulated datasets show average topological distance true gene trees species tree. methods. computed coalescent-based species trees using summary methods mlbs gene trees three ways without binning weighted statistical binning unweighted statistical binning. main focus mp-est explore results astral subset data. astral estimates species trees given unrooted gene trees analyze large datasets hence astral analyze larger datasets mp-est understanding impact binning astral’s accuracy practical importance. perform statistical binning using weighted unweighted pipelines using support thresholds extremely large computational effort involved large biologically-based simulated datasets explore threshold results; follow protocol used avian datasets mammalian datasets. however also study impact model condition avian mammalian datasets. lengths across genes) smaller simulated datasets biological analyses. however since partitioned analyses expensive unpartitioned analyses compute supergene trees studies avian mammalian simulated datasets compare results using coalescent-based summary methods concatenation also using unpartitioned maximum likelihood. note binned methods concatenation analysis would potentially become accurate fully partitioned analyses employed. measurements. simulated datasets explore species tree accuracy respect true species tree topology branch lengths also examine branch support true positive false positive branches. also explore error estimated gene trees gene tree distribution estimated using binning compared unbinned analyses. analyze simulated datasets using weighted statistical binning mp-est astral determine differences weighted unweighted statistical binning. since astral produce branch lengths mp-est evaluate branch length estimation. addition examine bootstrap support branches estimated species trees produced using mp-est false positive edges support deleterious false positive edges high support. bootstrap support estimated species trees studied study provides first analysis bootstrap support mp-est datasets well impact binning bootstrap support values. aspects phylogenomic estimation important different reasons. species tree topologies indicate species closely related others estimating accurate species tree topologies important aspect phylogenomic estimation. however improvement species tree branch length estimation also biologically relevant since lengths related effective population sizes generation times ancestral species also used estimate amount data. bootstrap support important since support branches often ignored high support branches generally assumed correct; hence understanding whether method returns high support false positive branches particularly important. improvements estimating gene tree distribution matter accuracy summary methods depends input captures correct gene tree distribution. gene tree estimation error reduced substantially gene tree estimation error reduced slightly even less hence gene tree estimation error high insufficient sequence length binning reduces gene tree estimation error binning little impact gene tree estimation error sequences long enough. measure error estimated gene tree distributions using deviation triplet frequencies triplet frequency distribution computed using true gene trees express results using cumulative distribution possible triplets replicates; hence curve method lies curve another method first method strictly improves second method respect estimating gene tree distribution. fig. show results avian genes default levels vary sequence length. fig. show results genes length varying level. cases weighted unweighted binning nearly identical. weighted unweighted binning also show nearly identical gene tree distribution errors conditions binning improves accuracy estimated gene tree distributions general longest sequences also improvement unbinned analyses highest lowest level high even highest level explored. fig. shows results species tree topology estimation error analyses avian genes different length default level using mp-est astral varying number genes default using mp-est genes varying using mp-est. weighted unweighted statistical binning essentially identical mp-est astral reduce species tree estimation error compared unbinned analyses table statistical significance test results choice binning method mp-est. performed anova test significance choice methods weighted unweighted compared bootstrap support threshold avian mammalian -taxon datasets. p-values corrected multiple hypothesis testing using correction n.a. stands available. largest improvements shortest gene sequences error reduced using mp-est using astral. difference binned unbinned analyses lower sequences noteworthy differences sequences number genes changed impact binning mp-est ranges neutral highly positive largest improvements datasets large numbers genes weighted unweighted compared bootstrap support threshold avian mammalian -taxon datasets. p-values corrected multiple hypothesis testing using correction n.a. stands available. statistically significant; table impact binning also significantly impacted levels largest improvements obtained lower levels ils. general binning helps astral mp-est mp-est tends helped astral. example genes error mp-est reduced using binning error astral reduced table statistical significance test results interaction effects mp-est. performed anova test significance whether interaction choice method variable changed dataset. weighted unweighted compared bootstrap support threshold avian mammalian -taxon datasets. p-values corrected multiple hypothesis testing using correction n.a. stands available. fig. shows impact binning species tree branch length estimation error biologicallybased simulations using mp-est; fig. shows results genes default levels varying gene sequence length fig. shows results genes varying levels. branch length estimation accuracy reported using ratio estimated branch length true branch length true branches recovered method. thus values equal indicate perfect accuracy values indicate under-estimation branch lengths values indicate over-estimation branch lengths types binning produce nearly identical results respect species tree branch length estimation unbinned analyses substantially under-estimate branch lengths sequence length increases branch length table statistical significance test results interaction effects astral. performed anova test significance whether interaction choice method variable changed dataset. weighted unweighted compared bootstrap support threshold avian mammalian -taxon datasets. p-values corrected multiple hypothesis testing using correction n.a. stands available. estimations produced unbinned analyses improve accurate markers. accurate species tree branch length estimation obtained using true gene trees. using binning improves branch length estimation estimated gene trees improvement large shorter sequences levels changed weighted unweighted binning close show little change branch length estimation changes levels; however unbinned analyses substantially under-estimate branch lengths lowest model condition become accurate increases level. hence biggest improvement obtained binning lowest less improvement highest level likely explanation trend mp-est interprets discord produces model tree considers likely generate observed discordance. hence mp-est tree branch lengths closer correct lengths level high. explore bootstrap support trees estimated simulated avian datasets follows. assign relative quality edge estimated tree taking bootstrap support account. highest quality edges true positive branches highest bootstrap support lowest quality edges false positive branches highest bootstrap support edges fall between. order edges quality true positive branches come first followed false positive branches given ordering create figures x-axis indicates edge quality y-axis indicates fraction edges least quality indicated x-axis. thus higher curve better overall quality species tree. fig. shows results avian genes default varying sequence length also genes varying levels. types binning nearly identical terms impact bootstrap support improve bootstrap support; particular using binning increases number highly supported true positive branches decreases number highly supported false positive branches. however sequence length modulates impact binning bootstrap support largest impact shortest sequences discernible impact longest sequences levels also impact binning affects bootstrap support biggest improvement bootstrap support obtained lowest level number genes also impacts bootstrap support biggest improvement bootstrap support obtained largest number genes furthermore weighted unweighted binning produce similar bootstrap support values. shortest sequences concatenation matches accuracy weighted unweighted binned mp-est methods slightly less accurate binned astral trees sequence length increases types binning using either astral mp-est become accurate concatenation. unbinned analyses less accurate concatenation shorter sequences accurate longer sequences binned analyses accurate concatenation unbinned analyses levels thus compared concatenation binned analyses largest advantage longer gene sequences higher levels higher number genes. results simulated mammalian datasets similar analyses avian datasets. nearly every condition weighted unweighted binning show similar results statistically significant differences using either astral mp-est before evaluated impact statistical binning gene tree estimation error model condition varying sequence lengths observed binning substantially reduces gene tree estimation error short sequences little impact longer sequences binning improves gene tree distributions generally large improvements improvements decrease sequence length level binning also improves species tree topology estimation impact appears depend sequence length number genes choice summary method level also seems impact relative accuracy binning seems helpful levels less helpful high levels however effects number genes sequence length level statistically significant dataset observed avian simulations unbinned analyses substantially under-estimate species tree branch lengths fig.). weighted unweighted binning produce nearly identical branch lengths sequence lengths number genes levels types binning come closer true branch lengths unbinned analyses. finally weighted unweighted binning produce nearly identical species tree branch support values match improve unbinned analyses tested numbers genes sequence lengths levels however improvements increase number genes decrease sequence length level. addition varying model conditions single avian single mammalian model condition study impact support threshold binning mixed model condition genes genes mammalian dataset model condition genes avian dataset mammalian mixed data binning beneficial cases however extent impact depends substantially threshold summary method. astral high accuracy even without binning binning either threshold small impact accuracy. mp-est used binning leads relatively small improvements accuracy whereas results much larger improvements. thus choice threshold impact model conditions studied choices threshold beneficial. explored impact statistical binning gene tree estimation error using sequence lengths values bootstrap support threshold parameter shorter sequence lengths binning increases gene tree estimation error longer sequence lengths binning impact gene tree estimation error using increases error thus statistical binning increases gene tree estimation error high -taxon datasets amount increase depended parameter sequence length fig. shows impact weighted unweighted statistical binning species tree accuracy -taxon dataset. apply statistical binning support thresholds mp-est astral summary method. cases weighted unweighted binning similar accuracy statistically significant differences relative accuracy unbinned binned analyses depends support threshold statistically significant differences binning significantly improves accuracy extent improvements seems larger genes smaller alignments impact factors statistically significant mp-est impact sequence length significant astral biggest gains obtained threshold used genes binning reduces error mp-est thus choice threshold matter dataset effects binning range neutral highly beneficial depending threshold used number genes gene sequence length. fig. shows impact binning species tree accuracy -taxon datasets choices threshold statistical binning pipeline choices summary method levels statistically significant differences observed data weighted unweighted binning weighted binning unbinned analyses nevertheless patterns observed terms average error weighted unweighted statistical binning close neutral applied threshold. threshold used impact binning depends level binning improves accuracy levels reduces accuracy high levels especially mp-est used differences statistically significant results mp-est datasets showed following trends. first avian dataset topological differences mp-est trees estimated using weighted unweighted statistical binning extremely small differences branch support thus although explored unweighted statistical binning mp-est main conclusions drew evolutionary history modern birds also found weighted statistical binning analysis using mp-est. unbinned mp-est analysis violates several subgroups established avian phylogenomics project studies binned mp-est analyses violate subgroups. violated subgroups failure unbinned mp-est analysis recover australaves significant since recovered many prior analyses mammalian dataset weighted unweighted mp-est produce exact tree small differences support unbinned mp-est tree however topological difference binned analyses discussed results astral biological datasets show generally similar trends. unbinned astral avian dataset recovers australaves hence line prior literature unbinned mp-est; however like unbinned mp-est unbinned astral recover clades recovered concatenation analyses reported using weighted unweighted statistical binning astral avian dataset produces almost identical results also almost identical binned mp-est tree mammalian dataset trees produced binned astral analyses weighted unweighted binning pipelines topologically identical other tree produced unbinned analysis rather small differences bootstrap support binned unbinned astral analyses binned mp-est analyses treeshrews sister glires unbinned mp-est puts sister primates. placement treeshrews substantial debate differential placement considerable interest mammalian systematics. overall results biological datasets show weighted unweighted statistical binning analyses produced identical species trees nearly identical branch support values; furthermore binned analyses congruent established subgroups unbinned analyses. across analyses results astral mp-est similar respect responded statistical binning. weighted statistical binning produces nearly identical results unweighted statistical binning biologically-based simulated datasets topologically identical results biological datasets explored study study generally supports conclusions statistical binning addition weighted unweighted statistical binning produce topologically identical trees avian dataset study supports findings avian phylogeny reported fact weighted unweighted binning typically produced similar results surprising since unweighted binning technique strives create balanced bins much possible largely achieves datasets explored. furthermore bins produced statistical binning exactly size pipelines based weighted unweighted statistical binning produce species tree since distributions gene trees produce identical. since sizes produced using heuristic balanced minimum vertex coloring close balanced explains observed small differences weighted unweighted statistical binning analyses. model conditions studied weighted unweighted statistical binning improved estimation gene tree topologies gene tree distributions species tree topologies branch lengths bootstrap support compared unbinned analyses. impact statistical binning -taxon datasets somewhat different biologicallybased simulations. gene tree estimation accuracy reduced sequence lengths nevertheless impact species tree estimation data tends neutral also conditions binning beneficial. lower -taxon datasets statistical binning reduces gene tree estimation error weighted unweighted binning reduce species tree estimation error however species tree estimation error unchanged results higher -taxon datasets stand analyses statistical binning slightly increases gene tree estimation error substantially increases gene tree estimation error b=%. furthermore species tree estimation error increased error increases. difference impact statistical binning case interesting points significance set. understand this note small sizes tend small since pair incompatible branches support considered evidence statistically significant discord; thus small settings produce results similar unbinned analyses. conversely large settings likely genes together since strongest supported conflicting branches prevent genes binned. therefore gene trees support statistical binning could tend produce results similar concatenation. thus choice threshold matters. better understand difference impact statistical binning simulated datasets helpful consider levels gene tree bootstrap support values data. shown table average distance true gene trees species trees ranges datasets fig. shows effect statistical binning used mp-est impacted level avian datasets statistical binning provided improvement levels largest improvement lowest level smallest improvement highest level figs. evaluate issue mammalian datasets shows large improvements provided statistical binning lowest level smaller improvements middle level improvement highest level. thus statistical binning provided improvement except small number model conditions -taxon conditions higher -taxon conditions highest mammalian condition table shows average bootstrap support higher -taxon datasets quite thus statistical binning seems beneficial level gene tree bootstrap support high neutral bootstrap support values high detrimental levels extremely high gene tree bootstrap support enough binning occurs. thus consequence study suggestion levels high average gene tree bootstrap support either statistical binning used used conservative fashion parameter low. species trees gene trees differ estimation species trees requires multiple loci. approach estimating species trees multiple conflicting loci seeks restrict loci using principled arguments approaches explicitly model discordance also developed. gene tree discord incomplete lineage sorting summary methods mp-est astral used estimate species tree combining gene trees. however study well others demonstrates gene tree estimation error impacts species tree estimation species trees estimated using summary methods poorly estimated gene trees accuracy. statistical binning technique proposed improved accuracy estimated gene trees shown improve accuracy mp-est applied mlbs gene trees. however proved here using unweighted statistical binning within phylogenomic pipeline statistically inconsistent gtr+msc model. significant issue. study described simple modification statistical binning obtained replicating supergene tree number genes modification call weighted statistical binning statistically consistent gtr+msc model addresses drawback. however current mathematical theory suggest advantage gained using within phylogenomic pipeline compared unbinned analysis gene sequence length unbounded unbinned analyses using summary methods also statistically consistent. indeed current mathematical theory standard coalescent-based summary methods establish guarantees presence gene tree estimation error limitation applies theory established wsb. hence theoretical standpoint benefit obtained using least according current mathematical theory. reason within phylogenomic pipeline empirical impacts accuracy estimated species trees study focused whether tends increase decrease accuracy summary methods model conditions impact relative performance binned unbinned analyses. biologically-based simulated datasets weighted unweighted statistical binning generally improved estimated gene tree distributions improvements mp-est astral estimations species tree topologies. statistical binning mp-est also improved estimated species tree branch lengths increased bootstrap support true positive edges reduced number highly supported false positives compared unbinned mp-est analyses. improvements increased gene sequence alignments phylogenetic signal species tree many genes. estimation species tree branch lengths biologically significant since lengths used infer amount data. unbinned mp-est analyses tended substantially underestimate branch lengths weighted unweighted binning reduce problem produce branch lengths much closer true lengths. since mp-est tends over-estimate presence gene tree estimation error means predictions levels biological datasets over-estimated. another consequence observation biologically-based model species trees used inflated levels since used mp-est construct model species tree. performance lower levels might closer biological dataset conditions default condition higher conditions. improvement branch support biologically relevant especially since unbinned mp-est analyses sometimes produced highly supported false positive branches presence poorly estimated gene trees levels binning reduced incidence false positive branches high support. results small numbers species particular higher -taxon datasets show somewhat different trends. results -taxon datasets showed binning generally helpful neutral statistical binning ranged neutral detrimental higher -taxon datasets higher -taxon -taxon datasets extremely high levels given statistical binning ranged neutral highly beneficial model conditions data suggest statistical binning suitable datasets extremely high levels. clearly research therefore needed understand conditions binning beneficial binning reduce accuracy. study also examine model conditions gene tree estimation error model misspecification biological causes gene tree discord gene duplication loss horizontal gene transfer. furthermore examined sequence datasets varying numbers sites locus even shorter sequences needed avoid loci include recombination study mainly examined impact statistical binning mp-est examined impact astral subset data respect species tree topology estimation thus important direction future study consider coalescent-based methods estimating species tree multiple loci. simple example mirarab showed accuracy mp-est species trees depended whether mlbs best maximum likelihood gene trees used mp-est trees based bestml gene trees generally produced accurate species tree topologies datasets large numbers genes explanation offered bestml gene trees generally closer true gene tree mlbs gene trees helps coalescent-based species tree estimation. hence evaluation impact binning mp-est bestml gene trees also needed. also possible better results would obtained using bayesian methods rather mlbs generate distribution gene trees since posterior distribution produced bayesian mcmc methods closely centered around true gene tree mlbs sample. study suggests substantial improvement species tree estimation could obtained develop accurate methods gene tree estimation. example methods co-estimate gene sequence alignments trees bali-phy sat´e pasta might provide improved gene tree estimation accuracy compared standard two-step procedures estimating trees indeed another challenge loci restricted ultra-short sequences decrease probability intra-locus recombination approaches based combining estimated gene trees able provide highly accurate results matter techniques used estimate gene trees. hence also possible methods construct species trees directly sequence data rather combining gene trees best accuracy since avoid analytical empirical challenges caused gene tree estimation error. however observed studies concatenation often produces accurate trees even best coalescent-based methods level enough. therefore important question whether given biological dataset sufficiently high level coalescent-based analysis needed. conversely coalescent-based methods accurate concatenation conditions high also comparably accurate even levels would helpful tools. finally since statistical binning reduce accuracy data examined small numbers species highest levels important question needs addressed whether high simulation conditions explored elsewhere represent realistic levels whether represent extreme conditions unlikely observed nature. accurate estimations levels biological data would enable research community direct efforts developing methods would greatest utility practice. overall study confirms general finding highly accurate coalescent-based species tree estimation possible statistical binning used good coalescent-based methods provide improved accuracy relative concatenation many conditions. recall gtr+msc model gene trees evolve within species tree multi-species coalescent model sequences evolve gene tree general time reversible model. different gene trees equipped model parameters main results section given theorem theorem prove using weighted statistical binning phylogenomic pipeline statistically consistent gtr+msc model replacing weighted statistical binning unweighted statistical binning statistically consistent gtr+msc model respectively. statistical binning algorithm uses heuristic color vertices describe. since gene associated vertex describe heuristic terms genes. algorithm stages. first stage heuristic find large clique incompatibility graph assign gene clique different bin. then greedy stage genes processed turn gene placed smallest number genes strongly supported conflicts exists created gene placed bin. bins smallest number genes gene placed broken randomly. genes processed based dynamic ordering next selected gene always incompatible largest number existing bins therefore assume branches bootstrap support user-provided bootstrap support threshold. then statistical binning different estimated gene tree topologies every every genes trivially true. suppose inductive hypothesis holds genes consider happens gene placed. recall algorithm operates stages first finds clique graph places genes within clique different bins enters greedy phase. consider genes within clique arbitrarily ordered placed bins using order. cases consider depending whether part initial clique found algorithm. part initial clique placed separate itself different topology genes preceded part initial clique placed greedy stage algorithm. inductive hypothesis algorithm placed first genes bins single different estimated gene tree topologies observed among first genes every genes estimated contains genes topology added bin. note inductive hypothesis bins contain genes different estimated gene tree topologies furthermore assumption edges gene trees bootstrap support hence cannot bin. therefore seen before genes tree topology case seen before. case different every previously seen gene tree created. result bins satisfies inductive hypothesis every estimated gene tree topology genes different estimated gene tree topologies. theorem species tree branch lengths coalescent units rooted gene trees sampled distribution defined multi-species coalescent model. numeric model parameters model tree tp}. sequence dataset evolve model tree bootstrap support threshold given. then sequence length least sites evolve gene tree probability least following true trees sequence length given sequence dataset least sites generated maximum likelihood tree topology bootstrap support greater probability least letting maxi{li} probability least therefore thus denotes model parameters parts within concatenated alignment refer tree topology achieves optimal score fully partitioned analysis solution fully partitioned maximum likelihood analysis concatenated matrix understanding numeric parameters estimated independently part alignment hence differ arbitrarily parts. lemma taxa sequences suppose tree topology optimal solution maximum likelihood optimal solution fully partitioned maximum likelihood analysis concatenation proof recall fully partitioned maximum likelihood analysis maximum likelihood score given candidate tree respect matrix fully partitioned analysis given equation suppose tree topology optimal solution maximum likelihood optimal solution fully concatenated maximum likelihood analysis. then optimal maximum likelihood tree topology contradicting assumption. therefore maximum likelihood analysis performed fully partitioned manner tree topology optimal solution maximum likelihood analysis. comments fully partitioned analysis enables different parameters different partitions critically important proof. consider example result would obtained given sequence alignments species constant sequence alignment obtained evolving sequences gene tree fully partitioned maximum likelihood analysis multiple sequence alignments exhibit changes impact solution maximum likelihood score every possible tree topology. therefore outcome fully partitioned maximum likelihood analysis concatenated alignment simply maximum likelihood tree topology however unpartitioned maximum likelihood analysis result quite different alignments without changes drive estimated branch lengths held common across sites. analysis theoretical properties unpartitioned maximum likelihood context multi-species coalescent model. consider result applying weighted statistical binning within phylogenomic pipeline. parameters user provided bootstrap support value. assume gene sequence alignment evolves model tree sequence lengths genes increase probability converging produced statistical binning analysis estimated gene trees true gene trees genes estimated true gene tree supergene trees produced converge probability common true gene tree genes bin. proof theorem sequence length increases probability converging genes share common true gene tree topology estimated gene trees topologically identical true gene tree bootstrap support greater lemma conditions fully partitioned maximum likelihood analysis concatenated alignment genes produce true gene tree topology genes bin. theorem phylogenomic pipeline uses maximum likelihood estimate gene trees uses weighted statistical binning compute supergene trees combines supergene trees using coalescent-based summary method statistically consistent gtr+msc model. proof begin proof statistical consistency weighted statistical binning. corollary true gene tree probability converging supergene trees produced converge probability common true gene tree. weighted statistical binning common true gene tree topology replicated many times number genes hence distribution produced using weighted statistical binning identical distribution unbinned true gene trees. therefore increase gene tree distribution produced weighted statistical binning converges true gene tree distribution. statistical consistency theorem phylogenomic pipeline uses maximum likelihood estimate gene trees uses unweighted statistical binning compute supergene trees combines supergene trees using coalescent-based summary method statistically inconsistent gtr+msc model. proof proof theorem shows sequence length increases bins produced statistical binning converges probability true gene trees converges probability possible gene trees hence multi-set supergene trees produced unweighted statistical binning converge possible gene tree appearing exactly once. flat distribution possible reconstruct species tree flat distribution. hence unweighted statistical binning phylogenomic pipeline statistically consistent. explored performance mp-est astral weighted unweighted statistical binning also without binning. also examine concatenation entire gene sequence alignments using unpartitioned maximum likelihood analysis using raxml. explore performance collection simulated biological datasets originally studied applied mp-est astral raxml gene trees computed bootstrap replicates gene sequence alignment. bootstrap gene trees gene summary methods applied site-only multi-locus bootstrapping procedure implemented follows. gene supergene replicates bootstrapping performed using raxml. next replicates input datasets summary methods created contains bootstrap tree across genes/supergenes. summary methods input replicates species trees estimated. finally greedy consensus tree estimated species tree computed support values drawn branches greedy consensus tree counting occurrences bipartition species trees. mp-est computes species trees using estimated distribution rooted triplet trees defined input gene trees. therefore evaluated impact binning estimated gene tree distribution measuring divergence triplet distribution estimated gene trees triplet distribution true gene trees. represent gene tree distribution frequency three possible true triplet distributions. hence triplet taxa estimated triplet distributions triplet distributions showed empirical cumulative jensen-shannon divergence thesen compared estimated species trees model species tree scientific literature measure topological error using missing branch rate rate) proportion branches true tree missing estimated tree. also reported error species tree branch lengths estimated mp-est using ratio estimated branch length true branch length branches true tree appear estimated tree; thus indicates correct estimation values indicate lengths long values indicate branch lengths short. note species tree branch lengths reflect expected amount under-estimation species tree branch lengths means over-estimation over-estimation branch lengths means under-estimation ils. also computed branch support false positive true positive edges false positive edges present estimated tree true tree edges present estimated true tree true positive edges. studied four collections simulated datasets based biological datasets generated prior study collections smaller numbers species. briefly describe simulation protocol biological datasets direct reader full details. dataset generated studied also describe procedure followed generate data. first species tree computed full biological dataset using mp-est tree topology branch lengths used model tree. thus mammalian simulation model tree level based mp-est analysis biological mammalian dataset. gene trees simulated within species tree multi-species coalescent model branch lengths gene trees defined using gene trees estimated biological dataset. variants basic model condition generated varying amount number genes sequence length gene; modifications also impact amount gene tree estimation error average bootstrap support estimated gene trees modified produce datasets resemble biological data. amount varied adjusting branch length model condition reduced created uniformly doubling branch lengths model condition higher generated uniformly dividing branch lengths amount obtained without adjusting branch lengths referred default estimated mp-est biological data. average bootstrap support biological data generated sequence lengths produced estimated gene trees bootstrap support bracketing value alignments produced estimated gene trees average alignments produced estimated gene trees also generated model conditions short sequence lengths average here varied number genes explore smaller larger numbers genes biological dataset total generated different model conditions specified level number genes sequence length. model conditions created replicates. mirarab used species tree estimated mp-est subset avian dataset species loci studied simulated gene trees varying different parameters three types genomic markers studied exons uces introns. average bootstrap support gene trees based exons uces introns respectively; longest introns highest average mirarab varied sequence lengths produce four model conditions patterns average bootstrap support resemble four marker types. mirarab varied number genes here augmented dataset also look fewer genes mirarab varied amount using technique used generating mammalian simulated datasets. simulated collection -taxon datasets. model species tree caterpillar-like ultrametric tree taxa; hence leaves siblings tree. lengths internal branches branches incident leaves substitutions site; note assumption ultrametricity defines remaining branch lengths. population size parameter branches results short internal branches succession. ultrametric gene trees simulated tree using mccoal commands given fig. sequence data simulated gene tree using bppseqgen according gtr+γ parameters given fig. built four model conditions trimming gene data sites exploring genes. used simphy simulate species trees using yule process different maximum tree length settings generations resulting short trees high levels generations resulting relatively longer trees lower levels ils. generated species trees model condition used simphy simulate gene trees species trees using multi-species coalescent process gene trees deviate strict molecular clock rates evolution vary across genes. used indelible simulate gtr+γ sequence evolution gene trees sites parameters given fig. supergene tree estimation biological datasets -taxon simulated datasets used fully partitioned maximum likelihood analysis. analyses based unpartitioned maximum likelihood analysis using command given gene tree estimation. fully partitioned analysis used following command concatenation concatenate alignments genes supermatrix estimate tree supermatrix using unpartitioned maximum likelihood. computed parsimony starting tree using raxml version raxml-light version following commands used mp-est used version mp-est. mp-est times different random seed numbers selected species tree best likelihood score using custom shell script. mp-est using site-only multi-locus bootstrapping using mlbs replicates returning greedy consensus mp-est mlbs species trees output. branch support edges tree represent frequency bipartition sample species trees. greedy consensus greedy consensus trees leaves obtained ordering bipartitions appear trees order frequency then tree built beginning first bipartition modifying tree include next bipartition list addition bipartition possible. used dendropy version compute greedy consensus trees running mp-est astral mlbs gene trees. datasets used study available prior publications. datasets generated study available figshare http//dx.doi.org/./m.figshare.. weighted statistical binning software available github https//github.com/smirarab/binning", "year": "2014"}