{"title": "Multiscale modeling via split-step methods in neural firing", "tag": "q-bio", "abstract": " Neuronal models based on the Hodgkin-Huxley equation form a fundamental framework in the field of computational neuroscience. While the neuronal state is often modeled deterministically, experimental recordings show stochastic fluctuations, presumably driven by molecular noise from the underlying microphysical conditions. In turn, the firing of individual neurons gives rise to an electric field n extracellular space, also thought to affect the firing pattern of nearby neurons.  We develop a multiscale model which combines a stochastic ion channel gating process taking place on the neuronal membrane, together with the propagation of an action potential along the neuronal structure. We also devise a numerical method relying on a split-step strategy which effectively couples these two processes and we experimentally test the feasibility of this approach. We finally also explain how the approach can be extended with Maxwell's equations to allow the potential to be propagated in extracellular space. ", "text": "neuronal models based hodgkin-huxley equation form fundamental framework ﬁeld computational neuroscience. neuronal state often modeled deterministically experimental recordings show stochastic ﬂuctuations presumably driven molecular noise underlying microphysical conditions. turn ﬁring individual neurons gives rise electric ﬁeld extracellular space also thought aﬀect ﬁring pattern nearby neurons. develop multiscale model combines stochastic channel gating process taking place neuronal membrane together propagation action potential along neuronal structure. also devise numerical method relying split-step strategy eﬀectively couples processes experimentally test feasibility approach. ﬁnally also explain approach extended maxwell’s equations allow potential propagated extracellular space. neurons responsible encoding information central nervous system. lower level functions many times gathered speciﬁc parts brain ∗pavol bauer stefan engblom aleksandar senek division sciprocessing information received neurons throughout body often means signaling nerves bundles axons reach neurons. higher level functions depend remarkably larger complex networks neurons various types feedback loops. chemical connections neurons handled synapses neurotransmitters extruded extracellular space presynaptic neuron. neurotransmitters form part chemical process initiate potential wave postsynaptic neuron wave known action potential. action potential membrane potential quickly rises falls resulting signal propagates along cell process underlies propagation regulation concentrations intracellular cytoplasm extracellular space caused integral membrane proteins called channels. many variants channel proteins whose functions recently better understood studies using experimental techniques x-ray crystallography current understanding channels reside many conformal states either closed open conformal state open ions allowed pass pathways called pores extraintracellular space opposite direction. conformal state closed ions blocked entering channel channels become activated either response chemical ligand binding response voltage changes membrane so-called voltage-gated channels. work focus voltagegated channels important initiation propagation action potentials along neuronal ﬁber. mathematical models neurons initially formed measuring electrically induced responses neuron using techniques voltagecurrent clamp. experiments transition properties parameters single channel gating could identiﬁed historically models ﬁring neurons formulated ordinary diﬀerential equations however speciﬁc cases experimental well theoretical ﬁndings suggest gating channels accurately described stochastic process. variance gating process also known channel noise thought important information processing dendrites explain diﬀerent phenomena regarding action potential initiation propagation example shown intrinsic noise essential existence subthreshold oscillations stellate cells contributes irregular ﬁring cortical interneurons explain ﬁring correlation auditory nerves another important aspect neuronal modeling investigation action potentials propagating outward neuron extracellular space. simulations extracellular ﬁelds important methods used computational neuroscience common usage includes validation experimental methods extracellular spike recordings modeling physiological phenomena easily investigated empirically paper present novel three-stage multiscale modeling framework consisting following components microscale gating process channels governed continuous-time discrete-state markov chain intermediate scale current-balance cable equation responsible action potential initiation propagation integrated time macroscale propagation trans-membrane current electrical ﬁeld extracellular space achieved using partial diﬀerential equations three modeling layers explained detail. numerical method split-step modeling summarized also explain relevant examples oﬀer concluding discussion describe modeling framework individual scales including associated modeling assumptions. microscale physics form continuous-time markov chains channels associated currents discussed ode-model action potential along neuronal geometry pde-model extracellular electric ﬁeld maxwell’s equations convenience schematic explanation figure schematic overview proposed multiscale modeling framework. ctmc solution microscale depends membrane voltage computed mesoscale. coupling bidirectional; mesoscale solution depends microscopic stochastic current. macroscopic solution considered depends solely mesoscopic membrane current. gating voltage-dependent ion-channels modeled markov process. hodgkin huxley ﬁrst proposed gating governed gating variables. assume gating variable takes values discrete state space single combination gating variables corresponds open conducting channel gating states transitions written form kinetic scheme. example voltage-gated sodium channel depicted figure notation channel states indicates involved gating variables variable takes four states independently variable takes states. total thus arrive states total reversible transitions figure total number channels open state implies certain conductivity detailed below. transition rates states depend membrane voltage state itself. transitions take place microscopic environment molecular noise present continuous-time markov chain suitable model. rewrite schemes general manageable notation follows. assign diﬀerent combinations gating variables individual state mstates. sodium scheme figure states state corresponds open conducting channel. resulting equivalent scheme shown figure exemplary rates originally obtained empirical ﬁtting experimental data formulated relative resting potential particular neuron model. consider small neural compartment obtained discretization neuronal ﬁber small enough segments potential approximately constant within compartment. total channels considered type compartmental surface. instant time number channels state mstates. scheme figure directly translates markovian transition rules states i.e. ion-channel counts thus deﬁning ctmc model electrophysiological properties channel deﬁne single open channel conductance well neuronal membrane area area density channels a/aa. count open channels e.g. example arrive total conductance concrete example sodium channel depicted figure gated gating variables macroscopic formulation exponent three respectively. relation means symbols denoting concentration gating variables. ratio open channels approximated voltage dependent transition rates deﬁned solving using thus constitutes classical hodgkinhuxley model ionic current. rather evolving markov chain deﬁned implicitly figure using stochastic current deﬁned. stochastic model result microphysical assumption discrete states obeying markovian transition rules. large enough numbers channels transition corresponding deterministic model expected rather broad conditions enough compartmentalization particular neuron made however stochastic model expected realistic sense eﬀects missing corresponding deterministic model ignored. current sources. ﬁrst take ionic current sources microscale account. next model capacitance membrane so-called passive neuronal property. neuronal morphology divided several compartments also include term propagation voltage compartments resembling cable equation. deviate slightly discussion ﬁrst consider spacecontinuous solution obtained solving propagation potential line oriented along x-axis. adding axial current iaxial total trans-membrane current possibly additional external current source iinj gives summarize intermediate scale insert stochastic conductivity computed solve current-balance equation neural compartments. simultaneously solve trans-membrane current deﬁned coupled macroscopic ﬁeld next discussed. simulate spatially non-homogeneous distributions electrical ﬁelds produced single neurons neuronal networks electrostatic formulation maxwell’s equations discretized ﬁnite elements. solve electric ﬁeld intensity terms electric scalar potential rewriting electric charge density using gauss’ together constitutive relation ﬁnally applying gauge condition twice arrive time-dependent potential formulation boundary conditions homogeneous neumann conditions everywhere except single point take ground simulations point placed axis rotation enclosing cylindrical extracellular space directly underneath neuronal geometry. procedure ensures formulation unique solution; without speciﬁcation otherwise speciﬁed constant. processes three scales microphysics channel gating neuron current intermediate scale propagation electric ﬁeld take place continuous time. also processes formally aﬀect eachother two-way couplings. potential extracellular space summarized also explain often rather complicated neuronal geometry handled. simplify matters disregard usually much weaker coupling external electric ﬁeld back gating process. grip details coupling channel gating process propagation action potential along neuron need compact notation follows. compartment denote gating state number channels diﬀerent states time sodium channel example ctmc written compactly mcompartments mstates ntransitions matrix integer transition coeﬃcients. dependency state implicit random counting measure associated ntransitions-dimensional poisson process. concrete example transition understanding transition according given ordering. since process poisson process expresses independent exponentially distributed waiting times intensity eqs. form coupled ctmc-ode model falls scope piecewise deterministic markov processes numerical methods investigated highly accurate implementation possible event-detection traditional ode-solvers. this however performance drawback since ode-solver must continuously determine suﬃcient accuracy micro-event happens when. experiments evolves ctmc keeping voltage potential ﬁxed value previous time-step similarly evolves keeping state channels ﬁxed time-step tn+. importantly usually expensive stochastic simulation fully decoupled depends state compartment global step achieved separately solving connected usually quite fast. although appears diﬃcult increase stochastic order approximation accuracy likely going increase turning symmetric strang-type splitting methods stochastic part possibly also adopting higher order scheme ode-part. however eﬃciency approach ultimately depends strength nonlinear feedback terms diﬃcult analyze priori. present proof-of-concept context convergent consistent coupling suitable starting point. thus postpone investigation advanced integration methods another occasion. spatial extension ﬁring process modeling take account possible free-space potential vext external cell. necessary modiﬁcations incorporate follows. vext given external potential denote membrane transneuronal conductivity. modiﬁcation propagates eﬀect given external ﬁeld vext along neuron. discussed eﬀect trans-membrane current propagates extracellular space electric potential previous discussion mind following two-way coupling thus emerges solution current-balance equation yields current source feeds turn implies external potential vext obtained solving ﬁnally inserted above. full model coupling thus arrived takes schematic form assumption valid whenever simulation consists small number neighboring neurons becomes inaccurate large number nearly parallel neurons considered. discussion. follows solution ﬁeld potential done oﬄine. problem solved isolation using pre-recorded current source obtained split-step method described three-dimensional neuronal geometry constructed comsol multiphysics help interface matlab morphological additions boolean uniﬁcation simple geometric objects representing neuronal compartments. trees toolbox used conveniently access geometrical properties single compartments matlab interface. initial attempt aimed represent geometry exact counterpart compartmental model compartment understood cylinder certain length diameter. direction main axes joining cylinders diﬀered sphere added cylinders followed removal interior boundaries. although created direct volumetric representation neuronal compartments approach diﬃcult generalize neuronal branches complicated connectivity. reason triangulation ﬁnal object becomes extremely diﬃcult achieve mesh engine insists fully resolving curvature. figure example problematic mesh emerging intersection cylinder sphere. second successful attempt made three-dimensional curves made line segments compartment constructed. simpliﬁes meshing process immensely since extracellular mesh constrained high-curvature cylindrical boundaries. implicit assumption neuron thin compared external length-scale practical interest. valid diameter dendritic structure also part widely used benchmark neuronal simulators model includes types voltage-gated channels ions case modeled continuous-time markov processes kinetic gating scheme channel shown figure channel follows similar scheme four discrete gating states state open. transition rates case voltage-dependent follows channels respectively single channel conductance equals reversal potentials brane capacitance resting potential cytoplasm resistivity speciﬁc leak conductance cylindrical geometry length diameter cylinder compartmentalized mcompartments sub-cylinders equal length diameter. root node ignited current injection figure show numerical solution coupled model overlaid deterministic solution channels described odes show three traces membrane voltage neuronal compartment time injected current varied lower value larger value dynamics stochastic model initial current injections clearly diﬀer dynamics deterministic single spike train spikes triggered stochastic representation spike obtained deterministic one. higher amount current injection observe trace similar characteristics model representations increasingly diﬀerent phase shift. figure show numerical convergence study coupled model concerning method parameters. show interspike interval changes function coupling time step well discretization geometry deﬁned duration peaks spikes. neuronal ﬁring stochastic process distribution hence present ﬁrst second moments. that study coupling time step appears well resolved spatial discretization presented. spatial discretization distributions signiﬁcantly diﬀer voxel length figure membrane voltage behavior around threshold current. accuracy deterministic solver veriﬁed reference solution rallpack cases discretization upper injected current iinj middle injected current iinj lower injected current iinj function time step compartment length bottom function compartment length time step line represents interspike interval rallpack reference solution number trajectories runs example took morphological description pyramidal neuron contains compartments. re-sampled geometry order aggregate short compartments sizes less larger compartments leading ﬁnal representation consisting approximately compartments. although reduction might alter properties model evolved protocols compartment reduction could used ignore induced discretization error since purpose model demonstrate overall numerical method. mapped corresponding curve segment current source noted passing assume transmembrane currents cause change extracellular potential case real neuron example synaptic calcium-mediated currents suspected contribute large fraction extracellular signature equipped source currents formulation eﬃciently solved comsol’s time discrete solver based observation variable satisﬁes simple ode. solving independent manner time straightforward solve single static arrive potential itself. time discrete solver time-step used split-step method thus ensuring correct transition macroscopic scale. result simulation visualized figure inserted four point probes radial distance neuron measuring extracellular voltage single points. electric potential thus monitored probes shown figure paper proposed model framework neuronal ﬁring processes consisting three layers microscale channel gating modeled continuous-time markov chain. intermediate scale currents produced open channels integrated current-balance equation proposed hodgkin huxley. finally macroscale outward current neurons propagated extracellular space simulating emission extracellular potential. also described numerical approach coupling diﬀerent scales indicated computational results feasibility overall approach. date several exact approximate simulation methods stochastically gated channel models proposed. however knowledge coupling microscopic gating layer mesoscopic layer describing action potential initiation propagation rigorously studied. paper provide formulation coupling split-step method moreover numerically observe convergence method respect size coupling time-step well spatial discretization. show distribution interspike intervals signiﬁcantly aﬀected choice coupling time-step appear depend strongly spatial discretization. finally discuss theory praxis incorporating macroscopic scale model including spatial representation neuronal compartments appropriate numerical procedures simulation local ﬁeld potential propagation. often taken granted channel gating occurs deterministically accumulating research evidence indicates presence stochasticity signiﬁcantly inﬂuences neuronal behavior turn neurons respond high level variability repeated presentation equal stimuli. leads remarkable diﬃculties studying link single cell biophysical properties function larger neuronal networks health disease. additionally recent study shown stochastic channel gating largely diﬀers diﬀerent neuronal cell types also locally diﬀerent parts neuron. given technical diﬃculties assessing signal channel properties smaller neuronal compartments axons dendrites developing reliable mathematical models essential tackle problem. several studies demonstrated incorporation channel noise hodgkin huxley equations could resemble multiple realistic neuronal behaviors. although scope work mimic particular experimental problem rather provide modeling framework could used diverse group scientists future foresee multiple interesting applications. example shown previously stochastic nature voltage-gated channels medial entorhinal cortex stellate cells crucial generating subthreshold stellate cells suggested generate theta oscillations vivo well established theta oscillatory activity vivo provides temporal window spatial declarative memories formed thus framework could used test link stochastic nature single channels speciﬁc cell types eﬀect cellular network level.", "year": "2016"}