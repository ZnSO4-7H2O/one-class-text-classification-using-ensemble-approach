{"title": "DeepIso: A Deep Learning Model for Peptide Feature Detection", "tag": "q-bio", "abstract": " Liquid chromatography with tandem mass spectrometry (LC-MS/MS) based proteomics is a well-established research field with major applications such as identification of disease biomarkers, drug discovery, drug design and development. In proteomics, protein identification and quantification is a fundamental task, which is done by first enzymatically digesting it into peptides, and then analyzing peptides by LC-MS/MS instruments. The peptide feature detection and quantification from an LC-MS map is the first step in typical analysis workflows. In this paper we propose a novel deep learning based model, DeepIso, that uses Convolutional Neural Networks (CNNs) to scan an LC-MS map to detect peptide features and estimate their abundance. Existing tools are often designed with limited engineered features based on domain knowledge, and depend on pretrained parameters which are hardly updated despite huge amount of new coming proteomic data. Our proposed model, on the other hand, is capable of learning multiple levels of representation of high dimensional data through its many layers of neurons and continuously evolving with newly acquired data. To evaluate our proposed model, we use an antibody dataset including a heavy and a light chain, each digested by Asp-N, Chymotrypsin, Trypsin, thus giving six LC-MS maps for the experiment. Our model achieves 93.21% sensitivity with specificity of 99.44% on this dataset. Our results demonstrate that novel deep learning tools are desirable to advance the state-of-the-art in protein identification and quantification. ", "text": "abstract. liquid chromatography tandem mass spectrometry based proteomics well-established research ﬁeld major applications identiﬁcation disease biomarkers drug discovery drug design development. proteomics protein identiﬁcation quantiﬁcation fundamental task done ﬁrst enzymatically digesting peptides analyzing peptides lc-ms/ms instruments. peptide feature detection quantiﬁcation lc-ms ﬁrst step typical analysis workﬂows. paper propose novel deep learning based model deepiso uses convolutional neural networks scan lc-ms detect peptide features estimate abundance. existing tools often designed limited engineered features based domain knowledge depend pretrained parameters hardly updated despite huge amount coming proteomic data. proposed model hand capable learning multiple levels representation high dimensional data many layers neurons continuously evolving newly acquired data. evaluate proposed model antibody dataset including heavy light chain digested asp-n chymotrypsin trypsin thus giving lc-ms maps experiment. model achieves sensitivity speciﬁcity dataset. results demonstrate novel deep learning tools desirable advance state-of-the-art protein identiﬁcation quantiﬁcation. outstanding performance deep learning object recognition opens frontier domain bioinformatics. continuation that research solving peptide feature detection problem using convolutional neural network ﬁrst attempt knowledge. image processing pioneered yann lecun hand written digit recognition. however became popular revolutionary breakthrough imagenet object recognition competition. hand proteomics based liquid chromatography tandem mass spectrometry well established technology discovery disease biomarkers drug target identiﬁcation mode action studies safety marker identiﬁcation drug research protein identiﬁcation quantiﬁcation fundamental tasks proteomics peptides building block protein. therefore typical analysis workﬂows lc-ms/ms data include peptide feature detection quantiﬁcation lc-ms peptide identiﬁcation ms/ms spectra protein proﬁling ﬁrst step peptide feature detection quantiﬁcation lcms target problem. lc-ms protein sample plot three dimensions mass-to-charge retention time intensity peptide ions sample. peptide feature multi-isotope pattern formed different molecular isotopes e.g. carbon- carbon- peptide. detecting multi-isotope patterns lc-ms challenging task overlapping peptides several charges molecule intensity variation. moreover single lc-ms gigapixel dimension containing thousands millions peptide features. however found effective similar pattern recognition problems example detecting cancer metastasis gigapixel pathology images therefore address target problem propose model deepiso based slides window detector lc-ms spot multi-isotope patterns. goal detect peptide features along charge states estimate intensities. latest advanced types lc-ms technologies generate huge amounts analytical data high scan speed high accuracy resolution almost impossible interpret manually. existing methods automate data handling applies different heuristics none relies deep learning appropriate parameters automatically available lc-ms data. example maxquant peaks detected ﬁtting gaussian peak shape peptide feature found employing graph theoretical data structure. ﬁrst roughly picks local maxima whose intensity larger given threshold candidate peaks entire lc-ms map. applies iterative algorithm process neighboring peaks candidate peak form peptide feature. recall varies precision varies based different datasets. msight generates images data adapting image-based peak detection. centwave uses pre-scan ﬁrst identify regions interest composed centroids centroids collapsed onedimensional chromatogram wavelet-based curve ﬁtting performed separate closely eluting peaks. f-score varies based different dataset. tracmass massifquant uses kalman filter peaks highly complex samples. massifquant’s existing algorithms many parameters based experience empirical experiments whose different settings large impact outcomes. contrast existing works research aims systematically training using real dataset automatically learn characteristics data without human intervention. last least even model makes wrong predictions correct results back training data model learn mistakes. believe models shall superior performance existing techniques shall become method choice near future. explain method using block diagram shown figure method divided three steps. first step train second step scan test lc-ms detect peptide features using trained model ﬁrst step third step process detections produce list peptide features. first steps involve deep learning third step applies heuristics. testing phase involves step step following sections discuss steps detail. step training intuition ﬁrst step that takes dimension image input outputs ‘yes’ ‘no’ based whether sees peptide feature image not. output ‘yes’ also needs identify charge feature. values therefore indication ‘no’ feature seen input image. training step basically supervised category classiﬁcation problem using category charge step supposed learn following basic properties peptide feature besides many hidden characteristics training data. intensities isotopes form bell shape within retention time range. isotope highest intensity peptide feature called precursor usually ﬁrst isotope feature. instance isotope listed feature table shown figure dataset wigg monoclonal antibody sequence including light chain heavy chain perform experiment. generated lc-ms/ms analysis intact mass check standard purchased waters. intact mouse antibody puriﬁed proteinknown molecular weights amino acid sequences light heavy chains. since chain digested asp-n chymotrypsin trypsin therefore total lc-ms maps experiment. produce list peptide features using peaks studio consider ground truth. apply -fold cross validation lc-ms maps. time keep testing remaining training. holds peptide features. consider resolution along horizontal axis minute along vertical axis. based resolution lc-ms dimension around pixels. scale pixel intensities clariﬁcation please refer lc-ms shown step figure consider features charge positive samples negative samples features training lc-ms maps considering block/window size appendix discuss block size good enough cover feature take decision existence charge feature. positive features feature placed pixel block shown figure features wider isotopes instance bottom right feature shown ﬁgure. amount features charge higher positive samples dataset. therefore make dataset balanced synthetic data charge procedure synthetic data generation explained appendix generate negative samples select features blocks surrounding region satisfying condition feature starts within pixels block shown figure positive samples negative samples fold giving million features training percentage features respectively. select validation that validation dataset contain synthetic positive samples. ratio negative samples kept higher lc-ms sparse spaces hold feature. fig. generation training data generate positive samples placing window feature that ﬁrst isotope feature centered pixel window; generate negative samples translating window around features that feature starts within pixels window boundary location peptide features want property ‘equivariant translation’ generalize edge texture shape detection different locations ‘invariant translation’ causes precise location detected features matter less. therefore avoid using pooling layer. google developed tensorﬂow library implement model. apply stochastic optimization using tensorﬂow provided ‘adamoptimizer’ learning rate rectiﬁed linear unit activation function neurons sparse softmax cross entropy error function output layer. dropout layer ﬁnal convolution layer fully connected layer value increases validation accuracy minibatch size considered ensure enough weight update epoch. check accuracy validation training minibatches. perform data shufﬂing epoch helps achieve faster convergence. converges within epochs. pixel column major order bottom top. coordinate window block dimension starting fetched input image cnn. produces output indicating whether sees feature starting coordinate not. keep nine hash tables recording detection coordinate classes features scan. values features used hash tables ranges isotopes feature inserted values keys. example figure step feature detected starts ﬁrst isotope range interested readers requested look details scanning procedure appendix step process hash tables using heuristics designed based common peptide feature properties produce complete list peptide features showing range isotopes intensity feature shown figure step simplicity skip explaining detailed procedure processing hash tables include later appendix clarify intuition test phase show counter example figure small region lc-ms holding feature charge shown result detection scanning region corresponding records hash table shown well. records presenting feature shown using plot applying step peptide feature listed shown feature table fig. visualization step step sample lc-ms detection step scanning sample lc-ms corresponding records hash table scanning plot detected multi isotope pattern step pattern listed peptide feature feature table unlike related research works kind ﬁlter remove noises lc-ms detecting features. want well learns avoid noises detects peptide features. therefore perform experiments data. apply -fold cross validation lc-ms maps. time keep testing remaining used training. fold training three times choose model giving best validation accuracy category classiﬁcation problem. average training validation accuracy folds respectively. class accuracy presented table although peptide features training lc-ms maps training however novo database sequence them. existence peptide feature supposed accurate peptide feature novo database sequence. existence features wrong. however since ground truth know accurate existence. therefore evaluation testing phase arrange features present test lc-ms following types testing phase would feature detected proposed model deepiso feature proﬁle reported method matches feature proﬁle provided peaks. speciﬁc compare following three points decide whether feature detected. charge feature matched. value starting isotope feature reported deepiso matches peaks result within tolerance level ﬁrst matches remaining isotopes’ match well since equidistant. like existing works literature evaluate true positive rate model test lc-ms using metric sensitivity recall. denote test lc-ms folds respectively. report sensitivity fold average sensitivity well data type table data type table detection features higher intensity important workﬂow lc-ms/ms analysis prepare statistics model sensitivity different intensity range starting average result -fold cross validation presented table data type data type performs well intensity higher expected. order evaluate model terms false positives related works literature metric precision instead speciﬁcity methods deﬁning true negative cases. however works people deﬁned true negative cases based processing strategy. example conley deﬁne true negative cases terms unused centroids report model speciﬁcity. since model ﬁnds features lc-ms scanning using therefore evaluation metric speciﬁcity seems appropriate measure performance cnn. counter example explain deﬁne true negatives terms pixels. consider detections scanning small area lc-ms dimension shown figure says ‘yes’ pixels shown black green. pixels says ‘no’. black pixels belong true positive features. green pixels represent false positive feature pixels represent false negative feature. white pixels represent true negative cases. according ﬁgure calculate speciﬁcity region follows statistical analysis biological experiments feature intensity interest calculated data technique ﬁrst apply curve ﬁtting bell shaped intensities isotopes feature. area curve isotopes feature calculated added intensity feature. pearson correlation feature intensity calculated model peaks type data type data proportion type features charge test lc-ms usually shown table result sensitivity charge shown table reﬂect well learns detect them. plan test lc-ms type charge features evaluate model future. sensitivity type data usually higher type reported table table sensitivity type data signiﬁcance type data contain wrongly detected features however type data supposed accurate since novo database sequence identiﬁed. therefore higher sensitivity model type data indicates proper learning model. average sensitivity folds type data considered model sensitivity. next point limitations deepiso model propose potential solutions well. based observations limitations scanning process step first last isotope feature recorded all. second ending values isotopes feature lc-ms recorded correctly. reasons limitations discussed appendix since intensity last isotope around ending trail isotope usually limitations affect signiﬁcantly intensity calculation. however propose potential solutions overcome problems would need combine detections produce ﬁnal list features. another problem high tolerance level might reduced considering resolution along axis finally discuss potential future scopes. current method using basic output existence feature along it’s charge. cannot directly output region feature lies. thus process detections applying heuristics produce ﬁnal list features. therefore interesting investigate whether suitable deep neural network detects also outputs boundary feature avoid heuristics completely. probable solutions r-cnn mask besides using intend experiment integrating recurrent neural network dynamic detector data-driven predict variable size patterns accurately size ﬁlter. type models also solve limitations discussed. therefore next concern design suitable deep neural network learns detect peptide features also boundary correctly lc-ms without applying heuristics. designing model would like perform comparison existing software tools evaluate performance gain deep learning terms accuracy efﬁciency. however believe current research reveals capability domain clearly understand it’s limitations well would help design powerful deep learning model automate peptide feature detection future. aoshima kentaro takahashi masayuki ikawa takayuki kimura mitsuru fukuda satoshi tanaka howell parry yuichiro fujita akiyasu yoshizawa shin-ichi utsunomiya simple peak detection label-free quantitation algorithm chromatography-mass spectrometry. bioinformatics jing zhang baozhen shan weiwu chen mingjie denis yuen weiming zhang zefeng zhang gilles lajoie peaks novo sequencing assisted database search sensitive accurate peptide identiﬁcation. molecular cellular proteomics marc sturm andreas bertsch clemens gr¨opl andreas hildebrandt rene hussong lange nico pfeifer schulz-trieglaff alexandra zerck knut reinert openms–an opensource software framework mass spectrometry. bioinformatics krishna gadepalli mohammad norouzi george dahl timo kohlberger aleksey boyko subhashini venugopalan aleksei timofeev philip nelson greg corrado detecting cancer metastases gigapixel pathology images. arxiv preprint arxiv. j¨urgen matthias mann. maxquant enables high peptide identiﬁcation rates individualized ppb-range mass accuracies proteome-wide protein quantiﬁcation. nature biotechnology patricia palagi daniel walther manfredo quadroni s´ebastien catherinet jennifer burgess catherine zimmermann-ivol jean-charles sanchez pierre-alain binz denis hochstrasser appel. msight image analysis software liquid chromatography-mass spectrometry. proteomics erik tengstrand johan lindberg magnus ˚aberg. tracmass modular suite tools processing chromatography-full scan mass spectrometry data. analytical chemistry christopher conley smith ralf torgrip ryan taylor ralf tautenhahn john prince. massifquant open-source kalman ﬁlter-based xc-ms isotope trace feature detection. bioinformatics salvatore cappadona peter baker pedro cutillas albert heck breukelen. current challenges software solutions mass spectrometry-based quantitative proteomics. amino acids ross girshick jeff donahue trevor darrell jitendra malik. rich feature hierarchies accurate object detection semantic segmentation. proceedings ieee conference computer vision pattern recognition pages hight block chosen pixels since seems enough discover bell shaped intensity isotopes. hand width block considered pixels sufﬁcient detect equidistant property charges. isotopes features apart other. usually peptide features isotopes. look three consecutive isotopes feature charge window width pixels enough. charges isotopes closer other. therefore block size look sufﬁcient area peptide features take decision it’s existence charge. model trained step used scan given test lc-ms pixel pixel column major order left right bottom top. scanning produces output value indicating absence presence feature clariﬁcation scanning procedure please refer figure small region demo lc-ms containing features shown. outputs area shown arrow sign since feature. figure position starts detecting feature keep nine hash tables recording coordinate detection. record starting point hash table note that value value value key. scanning outputs successive scans along edge feature shown curly brace. therefore indicate continuation feature. insert successive values instead keep track recent values wait says last point says position bell shape property and/or equidistant property isotopes lost. inserted ending value feature. result ending values isotopes feature recorded correctly. continues scan another feature detected it’s range inserted corresponding hash table before. process continues entries hash tables scanning area done shown figure please note that last isotope feature detected well scanning window going along edge last isotope shown figure window isotopes following cannot decide charge visualize detections color green blue indigo lavender brown orange yellow maroon respectively charge detections presented figure scans test lc-ms detections recorded hash tables processed using heuristics based common feature properties produce complete list peptides showing range isotopes intensity feature. please refer figure small region lc-ms holding feature charge shown result detection scanning region corresponding records hash table shown well. records presenting feature shown using plot select center wider isotope although peaks reports single value isotope isotope width. isotope span multiple pixels along axis. therefore also produces wide detection visible figure however pick value isotope. adjacent traces representing isotope calculate intensity terms area curve them select gives highest shown figure please refer figure feature charge ﬁrst isotope/trace extent. it’s next isotope overlapping extent satisfying condition shown ﬁgure. found experiment cases relation holds consecutive isotopes within feature. allow pixels distortion extreme points. also experiment based. isotopes holding conditions grouped feature inserted ﬁnal list detected peptide features. example isotopes shown figure grouped feature listed shown figure please refer figure understand process synthetic data generation. window position shown arrow sign usual position cutting positive samples. consider feature charge based assumption detect feature window observing bell shaped intensity equidistant properties isotopes slide window upward direction along edge ﬁrst isotope feature images associated respective window positions able detect feature additional images long bell shape equidistant properties lost therefore generate synthetic positive samples starting usual window position slide window pixels upward direction associated images lcms label feature charge training dataset. please note that validation contain synthetic image.", "year": "2017"}