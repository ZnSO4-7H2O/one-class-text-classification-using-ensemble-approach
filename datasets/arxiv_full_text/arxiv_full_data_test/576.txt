{"title": "A probabilistic view on the deterministic mutation-selection equation:  dynamics, equilibria, and ancestry via individual lines of descent", "tag": "q-bio", "abstract": " We reconsider the deterministic haploid mutation-selection equation with two types. This is an ordinary differential equation that describes the type distribution (forward in time) in a population of infinite size. This paper establishes ancestral (random) structures inherent in this deterministic model. In a first step, we obtain a representation of the deterministic equation's solution (and, in particular, of its equilibrium) in terms of an ancestral process called the killed ancestral selection graph. This representation allows one to understand the bifurcations related to the error threshold phenomenon from a genealogical point of view. Next, we characterise the ancestral type distribution by means of the pruned lookdown ancestral selection graph and study its properties at equilibrium. We also provide an alternative characterisation in terms of a piecewise-deterministic Markov process. Throughout, emphasis is on the underlying dualities as well as on explicit results. ", "text": "abstract reconsider deterministic haploid mutation-selection equation types. ordinary diﬀerential equation describes type distribution population inﬁnite size. paper establishes ancestral structures inherent deterministic model. ﬁrst step obtain representation deterministic equation’s solution terms ancestral process called killed ancestral selection graph. representation allows understand bifurcations related error threshold phenomenon genealogical point view. next characterise ancestral type distribution means pruned lookdown ancestral selection graph study properties equilibrium. also provide alternative characterisation terms piecewise-deterministic markov process. throughout emphasis underlying dualities well explicit results. faculty technology bielefeld university bielefeld germany ellen baake e-mail ebaaketechfak.uni-bielefeld.de fernando cordero e-mail fcorderotechfak.uni-bielefeld.de sebastian hummel e-mail shummeltechfak.uni-bielefeld.de major lines research devoted deterministic stochastic models respectively. deterministic mutation-selection equation describes action mutation selection genetic composition eﬀectively inﬁnite population; ﬁrst version goes back crow kimura deterministic mutation-selection equations formulated terms discretecontinuous-time dynamical systems treated forward time throughout well-developed methods dynamical systems; comprehensive overview research provided monograph b¨urger stochastic mutation-selection models moran wright-fisher models mutation selection additionally capture ﬂuctuations random reproduction long time scales; ﬂuctuations absent deterministic dynamics. stochastic models roots seminal work fisher wright mal´ecot feller moran formulated terms stochastic processes discrete continuous time often made tractable diﬀusion limit. modern treatment relies crucially genealogical point view lines descent traced backward time help ancestral processes ancestral selection graph overviews area found monographs ewens durrett wakeley last decades deterministic stochastic population genetics largely separate lives. purpose article bring research areas closer together working backward point view reserved stochastic models population genetics deterministic mutation-selection equations. ﬁrst step direction taken cordero starting point. work simplest model namely haploid individuals types selection mutation pursue major aims. first obtain representation solution deterministic mutation-selection equation equilibrium state terms ancestral process termed killed ancestral selection graph. second characterise type distribution ancestors today’s individuals distant past call pruned lookdown ancestral selection graph. throughout emphasis underlying dualities well explicit results worked details. paper organised follows. section introducing moran model types selection mutation. stochastic model ﬁnite population leads deterministic mutationselection equation large numbers. next graphical constructions required trace back ancestral lines introduced; namely ancestral selection graph killed ancestral selection graph pruned lookdown ancestral selection graph deterministic limit. special case unidirectional mutation results shed light bifurcations related so-called error threshold phenomenon. finally characterise ancestral type distribution ways ﬁrst consider two-type moran model mutation selection described follows. haploid population ﬁxed size individual population type either individuals type reproduce rate whereas individuals type reproduce rate refer type beneﬁcial type whereas type unﬁt deleterious. individual reproduces single oﬀspring inherits parent’s type replaces uniformly-chosen individual population thereby keeping population size constant. individual mutates rate type event probability assume throughout positive non-negative moran model well-known graphical representation interacting particle system fig. here individuals represented pieces horizontal lines. time runs left right ﬁgure. reproduction events depicted arrows lines. individual places oﬀspring arrow oﬀspring inherits parent’s type replaces individual tip. decompose reproduction events neutral selective ones. reﬂected neutral selective arrows graphical representation. neutral arrows appear rate ordered pair lines; selective arrows appear rate ordered pair. neutral arrows used types; selective arrows used individuals type mutation events depicted crosses circles lines. circle indicates mutation type means type line mutation. occurs rate line. types mutation events independent type line event; particular silent events included type event. arrows crosses circles appear independently. given realisation particle system initial type conﬁguration read types lines later times distribution initial types independent graphical elements particular certain properties ancestral processes determined graphical elements alone irrespective initial types. convergence uniform compact sets time probability special case dynamical large numbers kurtz also ethier kurtz neither parameters time rescaled. corresponds strong mutation–strong selection setting. convergence carries sense stationary distribution moran model converges distribution point measure stable equilibrium ode. initial value problem classical mutation-selection equation population genetics riccati diﬀerential equation constant coeﬃcients hence solution known explicitly equilibrium points solutions equation relevant equilibrium. furthermore limt→∞ equilibria reduce min{u/s max{ u/s}. particular still relevant equilibrium limt→∞ equilibria unit interval. particular limt→∞ fig. shows depend increasing eﬀect selection decreases sense increases; converges also equilibrium frequency selection absent. case deserves special attention. surpasses critical value equilibrium attracting phenomenon known error threshold means selection ceases operate extending yields transcritical bifurcation equilibria former unstable latter stable; vice versa baake wiehe details. equilibrium classical mutation-selection equation used estimate ﬁtness landscapes molecular data appropriate averaging ancestral selection graph krone neuhauser tool study genealogical relations sample taken population present. done three steps ﬁrst describe ﬁnite-n moran model. starts untyped sample taken refer present. ﬁrst step goes backward time constructs branching-coalescing graph whose lines correspond potential ancestors decorated mutation crosses circles anticipated fig. graph constructed backward time time samples types line without replacement initial type distribution. last step propagates types forward time taking account mutation selection events. think time sampling denote backward time backward time corresponds time point backward time corresponds time point anticipated fig. describe steps detail. branching-coalescing graph constructed graphical representation forward process fig. choose lines time follow back time. time lines currently graph selective arrows inoutside current lines. since untyped scenario possible decide whether arrows used not. idea therefore keep track potential ancestors sample. given line call descendant line selective arrow splits continuing line incoming line incoming line ancestor type thus used selective arrow whereas continuing line ancestor incoming line type selective arrow thus used fig. call rule pecking order. neutral arrow potential ancestors lets lines merge one; implies coalescence common ancestor. coalescence event reduces number lines one. coalescence event. rate sn/n selective arrow joins potential ancestors currently graph. call collision event. collisions change number lines. mutation circles crosses occur line rates respectively. branching-coalescing graph constructed time sample type line without replacement initial population type distribution propagates types forward time taking account pecking order mutations. proceeding types determined along true genealogy. deterministic limit turns following construction details). branching deleterious beneﬁcial mutations occur rate line respectively. since collisions coalescences occur moran model rates order types events vanish consequence deterministic limit individuals sample remain independent backward process. therefore suﬃces consider sample size every ﬁnite time horizon number lines remains bounded. typing potential ancestors done independently identically according initial distribution ﬁrst recover solution deterministic mutationselection equation genealogical means. recall solution gives frequency type time deterministic limit therefore appropriate tool. recall also that independence sampled individuals suﬃcient consider single one. starting point well-known observation athreya swart mano holds diﬀusion limit carries deterministic setting absence mutations single individual time type potential ancestors type easily veriﬁed pecking order namely every branching event type either continuing incoming line suﬃces descendant individual type iterating branching events gives statement. mutations information types determine type sample even sample initial types. precisely mutation type determines type line occurs line need traced back past; pruned. next ﬁrst mutation type decides sampled individual type potential ancestor must considered process killed. motivates following deﬁnition. deﬁnition killed deterministic limit starts line emerging individuals sample. every line branches rate every line pruned rate rate line process killed sent cemetery state events occur independently every line. fig. depicts realisations killed asg. there adopt convention incoming line always placed immediately beneath continuing line. line-counting process killed asg. transition continuous-time markov chain values rates states absorbing; states transient. state reached lines pruned deleterious mutations. state reached upon ﬁrst beneﬁcial mutation. absorption implies individuals sample type process also grow function returns sampling probability individuals type setting accordance interpretation impossible sample unﬁt individual beneﬁcial mutation relevant ancestry. function serve duality function. theorem provides stochastic representation solution deterministic mutation-selection equation. tells killed indeed right process determine current type distribution. this note right-hand side indeed equals probability single individual time type case either lines pruned time lines still alive time assigned type sampling initial distribution weights fig. remark theorem amounts weak duality forward backward process. expect also holds pathwise corresponding notions). order establish strong kind duality would need particle construction forward process deterministic limit). beyond scope article. proof conditional non-absorption always least line killed asg. time ﬁrst beneﬁcial mutation given line exponentially distributed parameter therefore ﬁnite almost surely. hence proves hence argument used leads second statement note conditional non-absorption transient hence apply karlin mcgregor cases follow classical absorption criterion since proposition accordance corollary thus found desired genealogical interpretation solution deterministic mutation-selection equation particular stable equilibrium explicitly describe happens special case brings bifurcation corresponds error threshold. case cannot accessed birth-death process birth rate death rate corresponds extinction probability. namely process dies almost surely whereas survives positive probability grows inﬁnite size almost surely. classical result theory branching processes indeed ﬁxed point equation generating function oﬀspring distribution binary galton-watson process probability oﬀspring oﬀspring individuals. connection sheds light bifurcation observed section fig. namely consider killed starting single individual sampled equilibrium population converges limr→∞ sampled individual type whereas results individual type hand conditional eventual absorption limr→∞ renders type sampled individual. type distribution forward process must identify parental branch every branching event requires nested case distinctions. furthermore ancestral lines must traced back beyond ﬁrst mutation. nevertheless mutations still rule certain potential ancestors. describe this cordero extended pruned lookdown lenz framework deterministic limit. recall idea behind process. pld-asg starts single individual. lines graph correspond potential ancestors assigned consecutive levels starting level line selective arrow level increased time lines shifted level; thereby making space incoming line occupies former level line hit. ﬁrst event line occupy level mutation type conclude ancestral since will later time play role unsuccessful incoming line type mutation. hence away line. line occupying level exempt pruning since regardless type line ancestral lines non-ancestral. line line mutation type away lines line will stage incoming line will mutation succeed lines line mutation type eﬀect. motivates following deﬁnition. deﬁnition pruned lookdown deterministic limit starts time proceeds direction increasing time graph consists ﬁnite number lines. lines numbered integers refer levels. process evolves following transitions. fig. pruned lookdown pruning deleterious mutation line pruning lines beneﬁcial mutation deleterious beneﬁcial mutation line aﬀect number potential ancestors every line branches rate line namely incoming branch inserted level lines levels pushed level upward particular continuing branch shifted level increases every line experiences deleterious mutations rate nothing happens. line level pruned lines slide ‘ﬁll gap’ rendering transition every line experiences beneﬁcial mutations rate lines levels pruned resulting transition thus pruning happens beneﬁcial mutation occurs level remark later insist starting single individual; keep mind start process lines correctly describe ancestry individuals. example assume ﬁrst event beneﬁcial mutation line induces pruning lines incompatible ancestry individuals. given hierarchy construction imposed lines graph line lowest line occupied type individual true ancestral line. particular ancestor time type lines occupied individuals type line true ancestral line ancestor time type ﬁnite moran model diﬀusion limit line ancestral potential ancestors type called immune deterministic limit immune line always line. rationale used determine ancestor’s type time explicit results require limit therefore consider asymptotic behaviour recall assume throughout. proof proposition case trivial. cases straightforward applications karlin mcgregor case note stochastically dominated yule process branching rate yule process non-explosive. easily checks claimed geometric distribution invariant. every process nonexplosive invariant distribution positive recurrent norris uniqueness stationary distribution follows norris proof proposition give direct proof graphical construction coeﬃcients tail probabilities stationary distribution satisfy boundary conditions. look last events backward time; correspond ﬁrst events forward time. times last selective beneﬁcial deleterious mutation event respectively occurred time ﬁrst levels. positive recurrent denote random variable distributed according stationary distribution line-counting process. directly solving recurrence relation leads geometric distribution here take diﬀerent route. derive memoryless property conclude distribution geometric since discrete distribution without memory. recursion looks like ﬁrst-step decomposition absorption probabilities process. indeed diﬀusion limit baake connect tail probabilities absorption probabilities another process siegmund duality. establish similar con∆ \u0006∪{∆} nection deterministic limit. process transition rates given remark process exhibits interesting connection line-counting process killed asg. previously deﬁned given rates furthermore processes rates interchanged. write line-counting process killed beneﬁcial deleterious mutation rate respectively selection rate note rate mutation events occur similarly given mutation occurs probabilities beneﬁcial deleterious mutations respectively. comparing immediately yields particular asymptotic behaviour follows means lemma absorbs probability addition absorbs probability absorbs probability absorbs probability conditional non-absorption probability remark analogous result diﬀusion limit proven baake cliﬀord-sudbury ﬂights proof leads pathwise duality relies particle representation forward process. expect similar argument apply also setting noted remark would require ﬁrst establish particle representation forward process deterministic limit. result gives alternative recover ﬁrst-step decomposition absorption probabilities remark absorption probability given equals absorption probability given particular ˘¯yn consistent remark recursion absorption probability obtained interchanging roles fearnhead’s recursion. hence interchanged; note implies replacement hand consequence corollary proposition similar derive moran model diﬀusion limit individuals present originate single individual distant past cordero krone neuhauser respectively. individual called common ancestor distribution type common ancestor type distribution. diﬀusion limit fearnhead derived distribution terms coeﬃcients characterised recursion deterministic limit coalescence collision events notion common ancestor make sense. instead cordero introduces representative ancestral type type ancestor generic individual population denoted earlier ancestral type typical individual. general concept developed jagers context branching processes. case type backward time denoted takes values representative ancestor lives population type distribution deﬁne conditional consistent graphical picture type backward time lines type corresponding probability given alternatively partition event beneﬁcial representative ancestor according ﬁrst level occupied type- individual. namely probability least lines present line type ﬁrst lines type summing probability gives probability type complementary probability leads right-hand side proof case absorbs hence together result follows. case ﬁrst treat subcase there transient hence almost surely. hence result follows bounded particular theorem consistent graphical picture. case corresponds neutral situation individual exactly potential ancestor times; representative ancestor single draw initial distribution. particular bias towards types. case positive probability bias towards beneﬁcial type. reason single beneﬁcial potential ancestor suﬃces type type manifests factor case depending whether null recurrent transient. cases number potential ancestors limit inﬁnite bias towards type taken extreme positive proportion beneﬁcial types suﬃces ensure ancestor type beneﬁcial types population type probability proof furthermore clearly coupling argument similar lenz write pldasg selection rate mutation rate beneﬁcial mutation probability deleterious mutation probability line-counting process write another pld-asg line-counting process couple almost surely start assume constructed {gq}q<r ¯gq}q<r ¯lr− almost surely. line level ¯lr− branches time also line ¯gr− level branches. line level ¯lr− beneﬁcial mutation time line ¯gr− level beneﬁcial mutation. line level deleterious mutation time toss coin. probability ¯ν/ν deleterious mutation line ¯gr− level probability ¯ν/ν beneﬁcial mutation line ¯gr− level cases almost surely. constructing inductive manner leads pld-asg selection rate mutation rate beneﬁcial mutation probability deleterious mutation probability desired property. particular using consider namely distribution type lives stable equilibrium population call type distribution equilibrium characterise follows. first note functions order stress dependence write also write instead recall section that min{u/s theorem counterpart transcritical bifurcation equilibrium frequency forward process. probability unﬁt type equilibrium exhibits even drastic behaviour jump surpasses critical value fig. positive recurrent almost surely ﬁnite. moreover case particular el∞] hence compare figs. seem surprising ﬁrst sight that even though switching beneﬁcial mutations leads increase values decreases probability deleterious type ancestral increases reason that ﬁnally give alternative representation conditional probability unﬁt ra-type. motivated taylor baake diﬀusion limit consider piecewise-deterministic markov process generator limy→ limy→ latter means absorbs process follows dynamics mutation-selection equation random jumping time. time process jumps boundaries absorbed. existence uniqueness markov process corresponding follow proving jump rates diverge boundary fact bounded along trajectories process ﬁnite time interval. never hits boundary since hits respectively. cases possibly diverging jump term absent either respectively. show dual remainder paper provide heuristic explanation duality relation theorem simplicity treat case here argument easily adapted arbitrary sample individual time construct pld-asg time type distribution number lines pld-asg time then fig. type along ancestral line depends pld-asg initial assignment types. solid ancestral line corresponds unﬁt type. type assignment left leads type change beneﬁcial mutation. type assignment right lead type change ancestral line. extracted type evolution along ancestral line depicted grey below. theorem would direct consequence result. note every realisation pld-asg initial conﬁguration extract type evolution along ancestral line partition pieces type constant; fig. given pld-asg given assignment types type along ancestral line changes mutations. keep track kind mutation induces last type change along ancestral line time random variable values encodes this. symbols represent beneﬁcial deleterious type-changing mutation; symbol indicates type change clearly function pld-asg initial assignment types. type change ancestral line i.e. type sampled individual ancestor time coincide therefore type probability particular type-changing mutation ancestral line desired probability evolves proportion deleterious individuals population explains drift term generator process event implies type ancestor time deleterious therefore must explains jump process event implies ancestor time beneﬁcial type explains jump process summarising also fig. remains explain rates type changes appear ancestral line. explain jump rate jump rate follows analogous way. rate deleterious type change time occurs ancestral line therefore jump given limε→ means condition type distribution backward time equal note fig. type change ancestral line either mutation type type rate either depends type distribution time type change. bold solid line corresponds whereas thin solid line corresponds acknowledgements pleasure thank anton wakolbinger lenz stimulating fruitful discussions. furthermore grateful anton wakolbinger taylor unknown referee helpful comments manuscript. project received ﬁnancial support deutsche forschungsgemeinschaft", "year": "2017"}