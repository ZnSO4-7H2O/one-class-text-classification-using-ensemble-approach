{"title": "An approach to periodic, time-varying parameter estimation using  nonlinear filtering", "tag": "q-bio", "abstract": " Many systems arising in biological applications are subject to periodic forcing. In these systems the forcing parameter is not only time-varying but also known to have a periodic structure. We present an approach to estimating periodic, time-varying parameters that imposes periodic structure by treating the time-varying parameter as a piecewise function with unknown coefficients. This method allows the resulting parameter estimate more flexibility in shape than prescribing a specific functional form (e.g., sinusoidal) to model its behavior, while still maintaining periodicity. We employ nonlinear filtering, more specifically, a version of the augmented ensemble Kalman filter (EnKF), to estimate the unknown coefficients comprising the piecewise approximation of the periodic, time-varying parameter. This allows for straightforward comparison of the proposed method with an EnKF-based parameter tracking algorithm, where periodicity is not guaranteed.  We demonstrate the effectiveness of the proposed approach on two biological examples: a synthetic example with data generated from the nonlinear FitzHugh-Nagumo system, modeling the excitability of a nerve cell, to estimate the external voltage parameter, and a case study using reported measles incidence data from three locations during the pre-vaccine era to estimate the seasonal transmission parameter. The formulation of the proposed approach also allows for simultaneous estimation of initial conditions and other static system parameters, such as the reporting probability of measles cases, which is vital for predicting under-reported incidence data. ", "text": "department mathematical sciences worcester polytechnic institute worcester department mathematics north carolina state university raleigh center quantitative sciences biomedicine north carolina state university raleigh biomathematics graduate program north carolina state university raleigh many systems arising biological applications subject periodic forcing. systems forcing parameter time-varying also known periodic structure. present approach estimating periodic time-varying parameters imposes periodic structure treating time-varying parameter piecewise function unknown coeﬃcients. method allows resulting parameter estimate ﬂexibility shape prescribing speciﬁc functional form model behavior still maintaining periodicity. employ nonlinear ﬁltering speciﬁcally version augmented ensemble kalman ﬁlter estimate unknown coeﬃcients comprising piecewise approximation periodic time-varying parameter. allows straightforward comparison proposed method enkf-based parameter tracking algorithm periodicity guaranteed. demonstrate eﬀectiveness proposed approach biological examples synthetic example data generated nonlinear fitzhugh-nagumo system modeling excitability nerve cell estimate external voltage parameter case study using reported measles incidence data three locations pre-vaccine estimate seasonal transmission parameter. formulation proposed approach also allows simultaneous estimation initial conditions static system parameters reporting probability measles cases vital predicting under-reported incidence data. keywords time-varying parameter estimation; periodic structure; nonlinear ﬁltering; ensemble kalman ﬁlter fitzhugh-nagumo; measles transmission. many systems arising biological applications subject periodic forcing seasonal forcing seen epidemiological systems daily forcing circadian rhythms types systems forcing parameter time-varying nature also known periodic structure. possible periodic functions approximate temporal behavior parameters structural restrictions often adequately capture true time evolution parameters. illustrates need methodology estimate time-varying parameters able maintain known structural characteristics without imposing restrictive evolution models. work present approach estimating periodic time-varying parameters using nonlinear ﬁltering. particular impose periodicity treating time-varying parameter piecewise function unknown coeﬃcients repeated period course time series estimate coeﬃcients using version ensemble kalman ﬁlter formulating problem allows resulting time-varying parameter estimate maintain periodic structure without imposing restrictions shape. proposed approach also permits simultaneous estimation unknown time-invariant parameters associated system including initial conditions needed certain applications. parameter estimation methodology available literature traditionally aimed estimating time-invariant parameters. classical deterministic techniques solving static parameter estimation problem typically rely least squares optimization routines bayesian approaches include markov chain monte carlo methods nonlinear ﬁltering methods particle ﬁlters ensemble kalmantype ﬁlters nonlinear ﬁltering algorithms static parameters artiﬁcially evolved time converging constant value. true parameter values change slowly time allowing parameters evolve random walk capture drift parameter tracking nonlinear ﬁltering used estimate periodic parameters however least structurally restrictive method parameter tracking random walk evolution guarantee resulting time series estimate maintain periodicity known structural characteristics inherent parameter. further special care must taken choosing variance random walk parameter tracking algorithms order avoid ﬁlter divergence obtain useful parameter estimate. unlike parameter tracking algorithms periodicity imposed formulation proposed work directly imposes periodic structure throughout estimation process without forcing parameter sinusoidal shape. coeﬃcients relating piecewise formulation could estimated using various techniques nonlinear ﬁltering provides natural framework accommodate sequential nature data time-varying behavior parameters estimate. moreover nonlinear ﬁltering estimate coeﬃcients allows straightforward comparison proposed approach parameter tracking algorithms described. paper organized follows. section review standard static parameter estimation inverse problem solution bayesian statistical framework nonlinear ﬁltering methods particular focus augmented enkf. describing proposed method estimating periodic time-varying parameters section demonstrate eﬀectiveness numerical examples section compare proposed method enkf-based parameter tracking algorithm periodicity guaranteed using synthetic data generated fitzhugh-nagumo system describes spiking dynamics neurons. demonstrate proposed method estimating seasonal transmission parameter epidemic model spread measles. results obtained using time-series data measles case reports three locations pre-vaccine speciﬁcally weekly reported cases england wales monthly reported cases york city baltimore proposed approach able well-capture periodic time-varying behavior seasonal transmission simultaneously estimating static parameters representing initial conditions system reporting probability measles cases vital predicting under-reported incidence data. setting static parameter estimation problem assume ordinary diﬀerential equation model involving states parameters whose values uncertain completely unknown describe system dynamics i.e. approach solution inverse problem bayesian perspective unknowns treated random variables. particular focus nonlinear ﬁltering algorithms provide natural setting time-varying parameter estimation considered work. section review nonlinear ﬁltering algorithms augmented ensemble kalman ﬁlter combined state parameter estimation utilize compute results section bayesian framework model states parameters treated random variables probability distributions joint posterior density assembled using bayes’ theorem filtering methods rely discrete-time stochastic equations describing model states observations sequentially update joint posterior density. assume time discretization observations occurring possibly subset discrete time instances. avoid double indexing time discretization propagaf known propagation model innovation process allows compute forward time propagation state variables given parameters work computes numerical solution model time tj+. observation equation ﬁrst step uses state evolution equation predict values states time without knowledge data second step uses observation equation correct prediction taking account data tj+. note data observed variety nonlinear ﬁltering algorithms state parameter estimation available literature including particle ﬁlters ensemble kalman-type ﬁlters; e.g. work employ augmented enkf style accommodates systems possibly stiﬀ diﬀerential equations. algorithm implemented follows. assume methods time integration systematically assign model error covariance sequentially using higher order method error control. parameter values updated prediction step j+|j forecast error covariance observation prediction ensemble observation noise covariance. formulation kalman gain straightforwardly allows nonlinear observations opposed familiar formula linear observation models artiﬁcial observation ensemble ensures resulting posterior ensemble variance posterior means covariances states parameters computed using posterior ensemble statistics process repeats. treatment parameters assumed static i.e. dθ/dt artiﬁcially evolved time. parameter values changed prediction step updated analysis step data arrival cross-correlation parameters model states encoded kalman gain parameter values thought change slowly time drift added parameters prediction step modeling change parameter values random walk thereby replacing priori application considered order avoid ﬁlter divergence obtain useful parameter estimate. filter divergence situation enkf becomes overconﬁdent incorrect estimate ignores subsequent data. occur either ensemble spread becomes small large details e.g. nonlinear ﬁltering methods augmented enkf reviewed section typically used estimate static parameters assuming dθ/dt artiﬁcially evolving parameter time converge constant value. case time-varying parameter changing rate slower dynamics system parameter tracking employed estimate change parameter time given appropriate drift covariance selected capture drift however parameter tracking account known structural characteristics time-varying parameter throughout estimation process. particular using augmented enkf parameter tracking guarantee periodic variation parameter fully captured maintained resulting time series estimate. possible model periodic parameters using periodic functions sinusoids structural restrictions often adequately capture true time evolution parameters goal work instead approach retain periodic structure without imposing sinusoidal shape. propose model periodic time-varying parameters piecewise functions unknown coeﬃcients repeated period course time series nonlinear ﬁltering estimate coeﬃcients. ease illustration work choose piecewise functions comprising sequence constant parameters constant sequence representing average value time-varying parameter speciﬁed time segment. generally written denotes time varying parameter known period number constants sequence. interpretation allows employ nonlinear ﬁltering estimate individual constant parameters time segment freeing shape constraints time-varying function. approach straightforwardly extended treat e.g. piecewise linear spline ﬁltering estimate spline coeﬃcients spirit freeing shape constraints resulting time-varying function. note proposed approach restricted nonlinear ﬁltering methods estimate coeﬃcients; e.g. least squares optimization mcmc-type sampling could used estimate parameters. however using nonlinear ﬁltering methods allows straightforward comparison proposed approach parameter tracking algorithms utilized setting. comparison proposed method changes rate slower dynamics system possible select appropriate drift covariance augmented enkf parameter tracking able capture change parameter value time. case discrete ensemble time given represents estimate prediction step ﬁlter parameter ensemble drifts according random walk prescribed variance demonstrate careful selection allows parameter tracking capture time-varying behavior parameter method guarantee underlying periodicity parameter maintained resulting time series estimate. note many applications parameter vector deﬁned inverse problem generally contain combination static time-varying parameters. case considered subset formulations augmented enkf straightforwardly extended incorporate simultaneous estimation static time-varying parameters. demonstrated results. section demonstrate eﬀectiveness proposed approach estimating periodic time-varying parameters biological examples. ﬁrst consider synthetic example data generated nonlinear fitzhugh-nagumo system models excitability nerve cell estimate external voltage parameter compare results proposed method parameter tracking algorithm. perform case study using reported measles incidence data three locations pre-vaccine estimate seasonal transmission parameter. commonly used simpliﬁed version hodgkin-huxley system model spiking dynamics neurons. state variable represents measurable membrane potential neuron represents unobservable combined eﬀect diﬀerent ionic currents. figure states voltage parameter fitzhugh-nagumo system. noisy observations component fitzhugh-nagumo system along unobserved state external voltage parameter panel x-axis shows time units. generate synthetic data letting negative absolute value cosine function additive constant frequency varies slowly system dynamics; similar function used measurements taken equidistant time instances interval covers three full periods shown figure observations corrupted gaussian noise zero mean standard deviation assigned standard deviation component. since observed observation function piecewise constant parameter estimation treat sequence constant parameters course period repeated across periods augmented enkf nens ensemble members estimate initial ensemble parameter values drawn uniformly assuming true initial conditions system unknown draw initial state ensemble uniformly times ﬁrst observation point initial state zero. time integration prediction step ﬁlter computed using adams-moulton methods orders figure shows enkf time series estimates constants comprising piecewise constant voltage parameter figure shows resulting estimate using posterior estimates repeated three periods. note parameters converge constant values sequential manner course period little uncertainty. plot figure demonstrates using posterior mean estimates deﬁne piecewise constant function provides fairly accurate estimate underlying figure parameter estimates piecewise constant voltage parameter. enkf time series estimates constants comprising piecewise constant voltage parameter fitzhugh-nagumo system panel x-axis shows time units y-axis shows value voltage parameter estimated enkf mean plotted solid credible intervals plotted dark light grey respectively. comparison figure shows time series estimate using augmented enkf parameter tracking parameter tracking estimate well-captures overall behavior voltage function time. however estimate phase maintain known periodicity underlying function. although shown methods able well-recover blind system component initial conditions system could also estimated demonstrated next example. figure piecewise estimate voltage parameter. posterior estimate piecewise constant voltage parameter fitzhugh-nagumo system repeated three periods. posterior enkf mean shown solid connected linear spline. true sinusoidal voltage function used generate synthetic data plotted dashed black. figure parameter tracking estimate voltage parameter. enkf parameter tracking estimate voltage parameter fitzhugh-nagumo system estimated enkf mean plotted solid credible intervals plotted dark light grey respectively. true sinusoidal voltage function used generate synthetic data plotted dashed black. demonstrate eﬀectiveness proposed methodology perform case study estimate seasonal transmission parameter epidemic model spread measles using reported incidence data three locations pre-vaccine era. data sets obtained particular data comprise weekly reported measles cases aggregate cities england wales monthly reported measles cases york city monthly reported measles cases baltimore maryland shown figure onset widespread vaccine usage measles outbreaks york city occurred every years even numbered years. estimates show measles cases reported york city time measles outbreaks baltimore much sporadic occurring every three years less clear periodic pattern. approximately measles cases reported baltimore time measles outbreaks england wales occurred regularly figure reported measles cases three locations pre-vaccine era. weekly reported measles cases england wales monthly reported measles cases york city monthly reported measles cases baltimore nearly annual pattern following bi-annual pattern. reporting probability cases england wales time period found relatively high greater cases reported details data four compartment susceptible-exposed-infectious-recovered model predict epidemic system dynamics application. review sir-type models epidemiology e.g. standard seir model comprises following system odes birth rate susceptible individuals death rate individuals compartment per-capita rate exposed individuals become infectious per-capita recovery rate infectious individuals unknown seasonal transmission parameter varies time course year. assuming constant population size system reduced impose annually-varying periodic structure seasonal transmission parameter modeling sequence constant parameters representing transmission parameter given month i.e. addition several static system parameters need estimated application. birth/death rate exposed-to-infectious rate recovery rate population size fairly well estimated literature demographic data initial model states remain uncertain. further estimates reporting probability obtained parameter also uncertain. therefore unknown parameter vector estimated synthetic validation performed measles application prior using real data; results obtained using synthetic data provided supplementary material appendix. results using real data obtained using similar procedure synthetic examples incorporating details speciﬁc data ﬁlter setup. simulation regional population sizes assumed constant approximated available demographic data prior ensembles initial model states drawn assuming population location initially comprises susceptible individuals exposed infected sampling uniform distributions times values. prior ensembles reporting probabilities drawn using available reporting information location figure piecewise estimates transmission parameter location. posterior estimates piecewise constant transmission parameters corresponding reported measles cases england wales york city baltimore. ﬁgure posterior enkf mean constant corresponding month year shown solid connected linear spline. corresponding posterior estimates static parameters location listed table figure shows resulting piecewise constant estimate three respective locations using posterior estimates estimated constants data connected linear splines. table lists corresponding static parameter estimates location. resulting shapes transmission parameters reﬂect annual pattern might expect lowest value location occurring summer months corresponding summer holiday break school-aged children. summer break united kingdom typically begins later united states minimum value transmission parameter shown figure england wales data occurs later cities reported measles cases england wales york city baltimore respectively correspond estimated transmission parameters shown figure parameter values listed four signiﬁcant ﬁgures. baltimore). transmission parameter noticeably rises fall months children return school decreasing winter holiday break. also clear spring coincide midsemester break. gradual drop seen certain times course semester result imperfect mixing; e.g. work present approach estimating periodic time-varying forcing parameters nonlinear systems nonlinear ﬁltering methodology. demonstrate eﬀectiveness approach using applications life sciences namely estimating external voltage parameter fitzhugh-nagumo system neuronal spiking seasonal transmission parameter epidemic model spread measles. treating forcing parameters applications piecewise constant functions using nonlinear ﬁltering methodology estimate coeﬃcients able incorporate periodic structure parameters estimation process without prescribing restrictive evolution models. also able simultaneously estimate time-invariant parameters associated system measles example includes initial conditions model states reporting probability cases data considered. approach presented work meant step towards better estimating time-varying parameters incorporating known structural characteristics particular periodicity. applications hand treating forcing parameter periodically repeating piecewise constant function middle ground approach assigning strict functional shape letting parameter drift guaranteed structure. assigning e.g. sinusoidal function necessarily represent true behavior time-varying parameter interest applications real data. seen results figure measles data seasonal transmission parameters corresponding real data sets analyzed work noticeably follow strict sinusoidal patterns course year. piecewise constant approach requires constant parameters estimated provides enforce periodicity full time series data without imposing restrictive functional form. parameter tracking approach requiring fewer parameters estimated ﬁltering process constants) introduces additional nuisance parameter much carefully chosen priori application considered order avoid ﬁlter divergence obtain useful estimate. parameter tracking approach also guarantee resulting time-series estimate maintain periodic structure parameter full time series seen fitzhughnagumo external voltage parameter figure future work include combining approaches better incorporate known structural characteristics parameter tracking-type ﬁltering algorithm allow freedom shape resulting time-varying parameter estimate. indeed possible variety parameter estimation techniques least squares optimization mcmc sampling estimate constant coeﬃcients piecewise constant approach. work highlight nonlinear ﬁltering algorithms speciﬁcally augmented enkf since methods amenable time-series data often available life sciences applications resulting posterior distributions contain measure uncertainty parameter estimates. focus work posterior parameter distributions used model prediction uncertainty quantiﬁcation would require additional variational techniques deterministic setting further using nonlinear ﬁltering estimate coeﬃcients proposed method allows straightforward comparison parameter tracking algorithm described. augmented enkf obtain results variety sequential ﬁltering algorithms could also employed e.g. particle ﬁlter dual ﬁlter either heuristic bayesian-consistent previously noted proposed method restricted piecewise constant functions straightforwardly extended treat time-varying parameter e.g. piecewise linear spline nonlinear ﬁltering estimate spline coeﬃcients. piecewise constant interpretation used work meant simple example general framework estimating periodic time-varying parameters nonlinear systems. work consider time-varying parameter system estimate additional model parameters reporting probability measles application could treated time-varying assuming known structural characteristics taking account added computational cost.", "year": "2017"}