{"title": "Inferring collective dynamical states from widely unobserved systems", "tag": "q-bio", "abstract": " When assessing spatially-extended complex systems, one can rarely sample the states of all components. We show that this spatial subsampling typically leads to severe underestimation of the risk of instability in systems with propagating events. We derive a subsampling-invariant estimator, and demonstrate that it correctly infers the infectiousness of various diseases under subsampling, making it particularly useful in countries with unreliable case reports. In neuroscience, recordings are strongly limited by subsampling. Here, the subsampling-invariant estimator allows to revisit two prominent hypotheses about the brain's collective spiking dynamics: asynchronous-irregular or critical. We identify consistently for rat, cat and monkey a state that combines features of both and allows input to reverberate in the network for hundreds of milliseconds. Overall, owing to its ready applicability, the novel estimator paves the way to novel insight for the study of spatially-extended dynamical systems. ", "text": "assessing spatially-extended complex systems rarely sample states components. show spatial subsampling typically leads severe underestimation risk instability systems propagating events. derive subsampling-invariant estimator demonstrate correctly infers infectiousness various diseases under subsampling making particularly useful countries unreliable case reports. neuroscience recordings strongly limited subsampling. here subsampling-invariant estimator allows revisit prominent hypotheses brains collective spiking dynamics asynchronous-irregular critical. identify consistently monkey state combines features allows input reverberate network hundreds milliseconds. overall owing ready applicability novel estimator paves novel insight study spatially-extended dynamical systems. infer properties high-dimensional dynamical system observe small part problem spatial subsampling common almost every area research spatially extended time evolving systems investigated. example many diseases number reported infections much lower unreported ones ﬁnancial system subset banks evaluated assessing risk developing system wide instability spatial subsampling particularly severe recording neuronal spiking activity number neurons recorded precision vanishingly small compared number neurons brain area here show subsampling leads strong overestimation stability large class time evolving systems include epidemic spread infectious diseases cell proliferation evolution references therein) neutron processes nuclear power reactors spread bank-ruptcy evolution stock prices propagation spiking activity neural networks however correct risk prediction essential timely initiate counter actions mitigate propagation events. introduce novel estimator allows correct risk assessment even strong subsampling. mathematically evolution systems often approximated process order autoregressive representation e.g. branching kesten process processes derive ﬁrst origin estimation bias develop novel estimator analytically prove consistent subsampling. apply novel estimator models realworld data disease brain activity. assure reasonable approximation complex system study exclude contamination potential non-stationarities included automated data-driven tests. par† activity next time step depends linearly current activity addition incorporates external input e.g. drive stimuli brain areas mean rate yielding autoregressive representation denotes conditional expectation. stability solely governed e.g. mean number persons infected diseased person activity stationary grows exponentially state separates stable unstable regime. especially close transition correct estimate vital assess risk develops large potentially devastating cascade avalanche events either generically minor increase conventional estimator uses linear regression activity time slope linear regression directly returns owing autoregressive representation estimation consistent full activity known. however subsampling strongly †for mathematically inclined reader recommend figure spatial subsampling. complex networks brain often small subset units sampled ﬁgure created using trees branching network active unit activates neighbors next time step. thereby activity spread system. units also activated external drive. subsampled activity signiﬁcantly diﬀer actual activity spatial subsampling impair inferences dynamical properties full system. recurrent networks conventional estimator substantially underestimates branching ratio less units sampled theoretically predicted novel multistep regression estimator always returns correct estimate even sampling units. conventional estimator infers sampling units respectively. kalman ﬁltering based estimation returns approximately correct values slight subsampling biased strong subsampling. contrast estimation returns correct subsampling. estimation exempliﬁed subcritical branching process active units observed probability subsampling regression slopes smaller full sampling conventional estimation relies biased show here. derive bias quantitatively model subsampling generic manner stochastic framework assume subsampled activity random variable expectation proportional kalman ﬁltering state-of-the-art approach system identiﬁcation cannot overcome subsampling bias either assumes gaussian noise evolution sampling process generating assumptions violated typical subsampling conditions values become small central limit theorem applicable hence kalman ﬁltering fails thus applicable much narrower subsampling problems addition requires orders magnitude longer runtime compared novel estimator novel estimator takes diﬀerent approach instead directly estimators using biased regression activity time perform multiple linear regressions activity times diﬀerent time lags kmax. return collection linear regression slopes full sampling expects exponential relation subsampling however showed regressions slopes at+k biased factor αvar hence exponential relation generalizes subsampling. factor general known thus cannot estimated alone. however constant need know estimate regressing collection slopes exponential model according result serves heart multiple regression estimator fact estimation equivalent estimating autocorrelation time subcritical pars autocorrelation regression equal showed subsampling decreases autocorrelation strength autocorrelation time preserved. system evolves independently sampling process. subsampling biases regression decreasing mutual dependence between subsequent observations temporal decay remains unaﬀected almr estimator consistent subsampling system evolves independently sampling process subsampling biases regression decreasing mutual dependence between subsequent observations temporal decay remains unaﬀected. here refers autocorrelation time stationary processes autocorrelation regression equal time scale investigated process. thus subcritical pars subsampling decreases autocorrelation strength autocorrelation time preserved. making result allows consistent estimate even sampling single unit pars typically ﬁrst order approximation real world event propagation. however mathematical structure allowed analytical derivation subsampling bias consistent estimator. show estimator returns correct results also complex systems applied complex simulated systems branching network non-linear bak-tang-wiesenfeld model contrast generic pars models recurrent networks ﬁnite size. addition second model shows completely deterministic propagation activity instead stochastic propagation characterizes pars activity unit depends many past time steps one. models approximate neural activity propagation cortex models numerical estimates precisely biased analytically predicted although models approximated bias considerable example sampling neurons resulted estimates even respectively. thus process fairly close instability mistaken poissonlike sampling conmr estimation readily applicable subsampled data requires suﬃciently long time series assumption expectation proportional hence general suﬃces sample system randomly without even knowing system size number sampled units moments underlying process. importantly obtain consistent estimate even sampling small fraction system homogeneity even sampling single unit figure disease propagation. epidemic models reproductive number serve indicator infectiousness disease within population predict risk large incidence bursts. estimated incidence time series measles infections countries worldwide well noroviral infection measles invasive meticillin-resistant staphylococcus aureus infections germany. estimation shown measles infections three diﬀerent countries. error bars following ﬁgures indicate corresponding conﬁdence intervals asymmetric. reproductive numbers decrease measles mrsa germany. reproductive numbers infections. artiﬁcially subsampling measles recording conventional estimation underestimates estimation still returns correct value. estimator return full sampling. robustness makes estimator readily applicable system approximated par. demonstrate bias conventional estimation robustness estimation example real-world applications. application disease case reports. used estimator infer reproductive number incidence time series diﬀerent diseases disease propagation represents nonlinear complex real-world system often approximated here determines disease spreading behavior deployed predict risk epidemic outbreaks however problem subsampling ascertainment always posed challenge ﬁrst step cross-validated novel conventional estimator using spread measles germany surveyed robert-koch-institute chose reference case expected case reports almost fully sampled owing strict reporting policy supported child care facilities schools clarity symptoms. indeed values inferred conventional novel estimator coincided contrast applying artiﬁcial subsampling case reports thereby mimicking infection diagnosed reported probability conventional estimator severely underestimated spreading behavior estimation always returned consistent values shows estimator correctly infers reproductive number directly subsampled time series without need know degree underascertainment second evaluated worldwide measles case vaccination reports countries provided since vaccination percentage diﬀers country expected impact spreading behavior reproductive numbers ranged line prediction clearly decreased increasing vaccination percentage respective country measles invasive meticillin-resistant staphylococcus aureus figs. quantiﬁed propagation behavior. estimation returned highest norovirus compliant high infectiousness measles found intermediate reﬂecting vaccination rate mrsa identiﬁed conﬁrming transmission still minor germany however future increase transmission feared would pose major public health risk reverberating spiking activity vivo applied estimator cortical spiking activity vivo investigate contradictory hypothesis collective spiking dynamics. hypothesis suggests collective dynamics asynchronous irregular i.e. neurons spike independently poisson manner reﬂect balanced state hypothesis suggests neuronal networks operate criticality thus particularly sensitive state close phase transition. diﬀerent hypotheses distinct implications coding strategy brain criticality characterized long-range correlations space time models optimizes performance tasks proﬁt long reverberation activity network contrast typical balanced state minimizes redundancy supports fast network responses analyzing vivo spiking activity macaque monkey prefrontal cortex memory task anesthetized visual cortex stimulus hippocampus foraging task returned corresponding autocorrelation times clearly suggests spiking activity vivo neither ai-like consistent critical state reverberating state shows autocorrelation times hundred milliseconds. call range dynamical states found vivo reverberating because input reverberates hundred millisecond network therefore enables integration information thereby reverberating state constitutes speciﬁc narrow window state perturbations ﬁring rate quenched immediately critical state perturbations principle persist inﬁnitely long demonstrate robustness subsampling activity visual cortex chose random subsets neurons total recorded single units. subset even single neurons estimation returned median contrast conventional estimator misclassiﬁed neuronal activity strongly underestimating instead returned activity neurons. underestimation gets even severe considering stronger subsampling ultimately single neuron activity conventional estimator returned namics close instead reverberating state underestimation present experimental recordings figure animal spiking activity vivo. neuroscience denotes mean number spikes triggered spike. estimated spiking activity recorded vivo monkey prefrontal cortex visual cortex hippocampus. raster spike plot population rate single units illustrated visual cortex. estimation based exponential decay autocorrelation inset comparison conventional estimation results single units estimated subsampled recordings estimated conventional estimator. error bars indicate variability randomly subsampled recorded channels. avalanche size distributions visual cortex networks reverberating near-critical dynamics panel simulations estimation monkey clearly diﬀered critical states opaque symbols indicate estimation rejected green yellow arrows indicate dynamic states shown panel population activity raster plots activity reverberating vivo-like near critical networks. three networks match recording visual cortex respect number recorded neurons mean ﬁring rate. titative estimation provided evidence vivo spiking population dynamics reﬂects stable fading reverberation state around universally across diﬀerent species brain areas cognitive states. because broad applicability expect besides questions investigated here estimation substantially contribute understanding realworld dynamical systems diverse ﬁelds research subsampling prevails. ﬁrst sight appear close critical state particularly physiologically difference small terms eﬀective synaptic strength. however seemingly small difference single unit properties large impact collective dynamics makes reverberating critical states clearly distinct. distinction readily manifest ﬂuctuations population activity furthermore distributions avalanche sizes clearly diﬀer power-law scaling expected critical systems well captured matched reverberating model large diﬀerence network dynamics estimator distinguish reverberating critical states necessary precision. fact estimator would allow times higher precision distinguishing critical non-critical states assuming vivo-like subsampling mean ﬁring rate larger discrimination becomes even sensitive number neurons given brain area typically much higher simulation ﬁnite size eﬀects likely account vivo supporting monkey brain operate critical state. still additional factors like input refractory periods limit maximum attainable quasi-critical dynamics widom line could principle conform results. real-world systems including disease propagation cortical dynamics complicated simple par. cortical dynamics example heterogeneity neuronal morphology function nontrivial network topology complexity neurons likely profound impact onto population dynamics order test applicability approximation deﬁned conservative tests included time series approximation considered appropriate. example excluded recordings showed oﬀset slopes oﬀset strictly speaking explained might indicate non-stationarities even conservative tests found exponential relation expected pars majority real-world time series shows reasonable approximation dynamics complex cortical activity disease propagation. using pars draw powerful advantage analytical tractability allowed valuable insight dynamics stability respective system. logical next step reﬁne model including additional relevant parameters however increasing richness detail typically comes expense analytical tractability. analytically derive novel estimator branching processes expect analogous derivations apply process ﬁrst order autoregressive representation processes fulﬁll beside pars include autoregressive processes integervalued autoregressive inar processes rounded integer-valued autoregressive rinar processes kesten processes emphasize estimator requires subsampled recording system full activity conforming deﬁnition below. necessary know either full system size number subsampled units moments full process branching process immigration unit produces random number units subsequent time step. additionally time step random number units immigrates system mathematically deﬁned follows independently identically distributed non-negative integer-valued random variables following mean variance var. further shall non-trivial meaning satisﬁes likewise independently identically distributed non-negative integer-valued random variables following mean rate variance var. evolution given asymptotically exhibits linear growth supercritical state grows exponentially. ﬁrst show results specify mean variance subcritical branching processes. result follows easily. stationarity second result observe theorem total variance varat+ denotes expected value conditioning random variable independent random variables variances also using result thus subsample constructed full process based three assumptions sampling process interfere itself change time. hence realization subsample time inﬂuence realization subsample another time conditional distribution shown later novel estimator applicable time series acquired conforming deﬁnition subsampling. demonstrate possible applications hand examples diagnosing infections probability example represents spread infections within population infection diagnosed probability depending sensitivity test likelihood infected person consults doctor. infections diagnosed independently others number diagnosed cases follows binomial distribution bin. at|at given expected value binomial distribution. sampling subset system components. diﬀerent application assume high-dimensional system interacting units forms substrate activation propagates. often states subset units observed continuously example placing electrodes record activity neurons entire recording implementation subsampling ﬁnite size systems mathematically approximated follows model units sampled probability sample active units actual active units follows hypergeometric distribution hyp. representation satisﬁes def. choosing special implementation subsampling allows evaluate terms expression precisely determines variance subsampling properties full process parameters subsampling using could predict linear regression slopes subsampling detail term var) constant subsampling given system quantiﬁes factor biased using conventional estimate depends ﬁrst moments thus known relation used fig. ﬁrst prove estimator consistent fully sampled case show consistency subsampling. first need following result individual linear regression slopes full sampling proof. construct random process starting time taking every ai+k·t index k-th time step original process process given hence time process relates time process time series length least square estimator slope least square estimator intercept linear regression pairs derive consistent estimator according suﬃcient show evolution rewritten estimated standard deviations ˆσat ˆσat+k at+k respectively. subcritical state σat+k stationarity. thus estimating linear regression slope equivalent estimating pearson correlation coeﬃcient ˆρat at+k ˆρat following calculate pearson correlation coeﬃcient subsampled time series evaluating at+k. total expectation order express at+k dependence terms inner expectation value taken respect joint distribution at+k outer respect joint distribution at+k conditioning at+k become independent def. hence joint distribution factorizes expectation value factorizes well. deﬁnition hence hence bias conventional estimator precisely given factor αvar var. however importantly relation still holds subsampled given collection multiple linear regressions ˆrkmax least square estimation minimizing residual yields consistent estimator mean oﬀspring even subsampling requires knowledge case contrast strictly requires stationarity existence ﬁrst moments expect estimator also consistent subcritical process started stationary distribution results show converge stationary distribution furthermore numerical results suggest estimator also consistent many types analyses non-stationarities time series lead wrong results typically overestimation developed tests exclude data sets signatures common non-stationarities. diﬀerent non-stationarities impact rules rejection time series outlined below. first transient increases drive e.g. response stimulus lead transient increase transients induce correlations anti-correlations prevail long time scales oﬀset coﬀset. exp) data rejected. factor punishes diﬀerences degree freedom residuals model free parameters instead smaller. second ramping drive lead overestimation comparison models without oﬀset introduced serves consistency check able identify ramping data captured models infer identical thus diﬀerence ˆmexp moﬀset hints invalidity estimation. instead compared autocorrelation times ˆτoﬀset −∆t/ ˆmoﬀset ˆτexp obtained models logarithmic scaling increases sensitivity. relative diﬀerence large data inconsistent estimation invalid experience sudden jumps. lead spurious autocorrelation identify trends resulting non-stationary input choosing short data sets tested whether sequence better linear regression pairs exponential relation residuals apart non-stationarities even poisson activity stationary rate lead spurious overestimation well subsampled branching processes ﬁnite duration poisson case processes close criticality show similar autocorrelation results sequence table consistency checks estimation. order assess results obtained estimation consistent stationary parameters perform tests discriminate following cases order considered explain data four tests hoﬀset hlin h¯r≤ negative hoﬀset hlin positive data cannot explained regardless tests estimation invalid. h¯r≤ positive additional test becomes relevant negative data cannot explained also positive data consistent poisson activity expected absolutely almost respectively. moreover solution manifold minimizes residuals hence estimator yield value depending initial conditions minimization scheme. distinguish used fact slopes expected distributed around zero contrast processes slopes expected larger zero thus identify stationary larger zero yielding p-value p¯r≤ following test h¯r≤ choice signiﬁcance level guided severity type errors here liberal poisson activity mistaken correlated activity potentially even close-to-critical. hand signiﬁcance level conservative activity long autocorrelation times spuriously considered poissonian strong subsampling study chose signiﬁcance level p¯r≤ order underestimate risk large activity cascades. conﬁrm candidates poisson activity identiﬁed positive h¯r≤ assured show systematic trend i.e. linear regression function yielded slope zero according signiﬁcance level sided test given discriminate following cases order indicated tab. obtained estimation valid none tests positive. positive result hoﬀset hlin indicates non-stationarities data explained stationary estimation invalid. h¯r≤ positive data potentially consistent poisson activity case also positive. otherwise negative poisson hypothesis also rejected estimation invalid. strategy correctly identiﬁed validity estimation investigated cases stationary accepted nonstationary transient changes ramping sudden jumps drive excluded centered around true mean oﬀspring depends branching ratio mean activity mainly changing eﬀective length time series i.e. number non-zero entries |{at thus regardless actual time series length mean activity variance scales power-law exponent i.e. larger beneﬁt longer time series length found performance estimator principle independent mean activity small aﬀect highly depends speciﬁc choice parameters varied either keep constant time. mean activity ﬁxed choosing variance process scales activity inevitably criticality least orders magnitude standard deviation also decreases approaching criticality classical bootstrapping methods underestimate estimator variance treating slopes independently fact dependent. found model based approach constructs conservative representative conﬁdence intervals. simulations simulated independent copies investigated model applied estimation experimental time series length mean activity number sampled units estimation yields estimate simulated copies branching networks units inferred estimation length rate match data. rate matched setting drive n/n. thereby subsampling units mean activity resulting time series matched original time series procedure gives copies match terms mean activity collection independent estimates ˆm}b independent gaussian random variables constant real numbers. assuming kalman ﬁltering infers original time series given measured time series known model based iterative expectation maximization algorithm incorporates kalman ﬁltering model parameters estimated time series used algorithm infer mutual dependence model parameters also needed infer order reduce dimensionality maximization step disregarded inﬂuence initial value decreases time series considered termination criteria algorithm first recommended restrict algorithm cycles order avoid overﬁtting common problem likelihood-based ﬁtting methods multidimensional model parameters. therefor considered inferred cycles. second considered results subsequent cycles diﬀer used publicly available python implementation kalman algorithm pykalman. parameters chosen detailed above. analysis performed computer cluster reached runtimes several days projected runtimes weeks. fact computational demand limiting factor terms widespread application. contrast estimation terminated within half second cpus. distributions allow non-trivial oﬀspring distributions easy control branching ratio parameter. brain might assume neuron connected postsynaptic neurons excited probability motivating binomial oﬀspring distribution mean cortex typically large typically small poisson limit reasonable approximation. performance estimator limit behavior particular form important special choice made restrict generality results. mean rate depends simulation varied ﬁxed probability distributed following binomial distribution subsampling implemented drawing time step. implementation subsampling branching network. addition classical branching process also simulated branching network model mapping branching process onto fully connected network neurons. active neuron activated postsynaptic neurons probability m/k. here activated postsynaptic neurons drawn randomly without replacement step thereby avoiding diﬀerent active neurons would activate target neuron. similar critical inﬁnite size limit subcritical detailed note choice change activity model convenience. model neurons arranged lattice neuron connected locally four nearest neighbors coupling strength denotes spike times neuron poisson drive neuron mean rate deﬁned above. note neurons edges corners grid neighbors respectively. model equivalent well-known bak-tang-wiesenfeld model stated otherwise simulations time steps exceeded parameter choices. i.e. approximately half integer range. stated otherwise conﬁdence intervals estimated samples simulation experiments. data measles worldwide. time series yearly case reports measles diﬀerent countries available online world health organization years estimation applied time series. contain data points potential long-term drifts applied consistency checks detailed every country checks surveyed countries accepted analysis included analysis. yearly information approximate vaccination percentages countries time span also available online who. data norovirus measles mrsa germany. germany robert-koch-institute surveys range infectious diseases weekly basis including measles norovirus invasive meticillin-resistant staphylococcus aureus case reports available survstatrki server possible changes report policies beginning surveillance omitted data ﬁrst months recording. moreover omitted incomplete week turn year thus evaluating full weeks year. mrsa recording showed slow small variation case reports attributed slow changes drive rates. compensate slow drifts corrected time series subtracting moving average years applied estimation obtained time series. recordings measles norovirus showed strong seasonal ﬂuctuations case reports resulting baseline oscillation autocorrelation function. therefore used modiﬁed model order obtain naive estimates using conventional linear regression estimator used following correction seasonal ﬂuctuations. incidence count normalized incidence fig. subsampling applied original time series assuming every infection diagnosed reported probability yielding binomial subsampling described supp. estimates obtained subsampled time series according conventional estimator subsampled time series processed described above. evaluated spike population dynamics recordings rats cats monkeys. experimental protocols approved institutional animal care committee rutgers university experiments performed accordance guidelines established canadian council animal care monkey experiments performed according german protection experimental animals approved regierungspr¨asidium darmstadt. procedures also conformed regulations issued society neuroscience. spike recordings rats cats obtained nsf-founded crcns data sharing website rats spikes recorded right dorsal hippocampus open ﬁeld task. used ﬁrst data sets recording group data-sets provided sorted spikes shanks shanks channels. used both spikes single multi units knowledge identity precise number neurons required estimator. details experimental procedure data-sets proper found spikes neural data recorded blanche laboratory nicholas swindale university british columbia used data i.e. recordings area contain sorted single units used part experiment stimuli presented i.e. spikes reﬂected spontaneous activity visual cortex anesthetized cat. potential non-stationarities beginning recording omitted data recording. details experimental procedures data proper found arranged square grid inter electrode distances either monkeys performed visual short term memory task. task experimental procedure detailed analyzed spike data experimental sessions comprising almost trials sessions recorded tetrodes. spike sorting tetrode data performed using bayesian optimal template matching approach described using spyke viewer software single electrode data spikes sorted multi-dimensional method reﬂecting propagation time spikes neuron next. note scales size corresponding autocorrelation times invariant size changes. figs. investigated single neuron activity applying similar binning spike times neuron individually. time series estimated using estimator kmax recordings kmax recording kmax monkey recordings assuring kmax always order multiple autocorrelation times. experiments excluded tests according supp. detected potential nonstationarities.", "year": "2016"}