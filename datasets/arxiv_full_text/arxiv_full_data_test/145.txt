{"title": "Bayesian uncertainty analysis for complex systems biology models:  emulation, global parameter searches and evaluation of gene functions", "tag": "q-bio", "abstract": " Background: Many mathematical models have now been employed across every area of systems biology. These models increasingly involve large numbers of unknown parameters, have complex structure which can result in substantial evaluation time relative to the needs of the analysis, and need to be compared to observed data. The correct analysis of such models usually requires a global parameter search, over a high dimensional parameter space, that incorporates and respects the most important sources of uncertainty. This can be an extremely difficult task, but it is essential for any meaningful inference or prediction to be made about any biological system. It hence represents a fundamental challenge for the whole of systems biology.  Results: Bayesian statistical methodology for the uncertainty analysis of complex models is introduced, which is designed to address the high dimensional global parameter search problem. Bayesian emulators that mimic the systems biology model but which are extremely fast to evaluate are embedded within an iterative history match: an efficient method to search high dimensional spaces within a more formal statistical setting, while incorporating major sources of uncertainty. The approach is demonstrated via application to two models of hormonal crosstalk in Arabidopsis root development, which have 32 rate parameters, for which we identify the sets of rate parameter values that lead to acceptable matches to observed trend data. The biological consequences of the resulting comparison, including the evaluation of gene functions, are described. ", "text": "bayesian uncertainty analysis complex systems biology models emulation global parameter searches evaluation gene functions. vernon* junli liu† michael goldstein james rowe topping keith lindseyˆ background many mathematical models employed across every area systems biology. models increasingly involve large numbers unknown parameters complex structure result substantial evaluation time relative needs analysis need compared observed data various forms. correct analysis models usually requires global parameter search high dimensional parameter space incorporates respects important sources uncertainty. extremely diﬃcult task essential meaningful inference prediction made biological system. hence represents fundamental challenge whole systems biology. results bayesian statistical methodology uncertainty analysis complex models introduced designed address high dimensional global parameter search problem. bayesian emulators mimic systems biology model extremely fast evaluate embeded within iterative history match eﬃcient method search high dimensional spaces within formal statistical setting incorporating major sources uncertainty. approach demonstrated application model hormonal crosstalk arabidopsis root development rate parameters identify sets rate parameter values lead acceptable matches model output observed trend data. multiple insights model’s structure analysis provides discussed. methodology applied second related model biological consequences resulting comparison including evaluation gene functions described. conclusions bayesian uncertainty analysis complex models using emulators history matching shown powerful technique greatly study large class systems biology models. provides insight model behaviour identiﬁes sets rate parameters interest. background fundamental challenges facing systems biology recent advances genome sequencing techniques variety ‘omic’ techniques bioinformatic analyses explosion systems-wide biological data. thus identiﬁcation molecular components genome scale based biological data become possible. however major challenge *correspondence i.r.vernondurham.co.uk department mathematical sciences durham university south road durham full list author information available article †joint corresponding author junli.liudurham.ac.uk ˆmichael.goldsteindurham.ac.uk j.h.rowesheﬃeld.ac.uk j.f.toppingdurham.ac.uk keith.lindseydurham.ac.uk. biology analyse predict functions cells emerge interactions molecular components. computational mathematical modelling provide compelling tools study nonlinear dynamics complex interactions particular example kinetic modelling kinetics biological reaction described accordance corresponding biological process properties whole system described using diﬀerential equations common tool analysing biological systems models often contain large numbers uncertain parameters cases kinetic parameters cannot directly measured experiments typically measure concentrations rather rates. even parameters measured ‘directly’ usually experimental conditions signiﬁcantly diﬀerent cellular environment wish study. therefore compare mathematical model’s outputs experimental observations often form measured concentrations trends determine values input rate parameters achieve acceptable match model reality. involves consideration several sources uncertainty including observation error biological variability tolerance place model’s accuracy known model discrepancy. vital perform global parameter search input parameter settings achieve acceptable match. single solution rate parameter values suggest certain biological implications give particular predictions future experiments could gravely misleading explore parameter space several alternative solutions give radically diﬀerent implications predictions. mistake disturbingly common. unfortunately performing global parameter searches high dimensional spaces extremely challenging several reasons notably complex structure model hence complex imposes constraints parameters substantial model evaluation time relative needs analysis need careful assessment acceptable match incorporates appropriately complexities uncertainties comparison model real system high dimensional spaces extremely large require vast numbers model evaluations explore. example spatial models root development require least several minutes single evaluation. worth considering large high dimensional spaces evaluate model question corners initial input space dimenwould take approximately years model took second evaluation. however global parameter searches essential meaningful inference prediction made biological system. therefore represents fundamental challenge whole systems biology. article describes practical methodology address problem based bayesian statistics methodology uncertainty analysis complex models bayesian emulation uncertainty analysis issues surrounding analysis complex models uncertainty speciﬁcally global parameter search problem unique systems biology encountered many diﬀerent scientiﬁc disciplines. area bayesian statistics arisen meet demand analyses. area sometime referred uncertainty analysis computer models centres around construction bayesian emulators emulator statistical construct mimics scientiﬁc model question providing predictions model outputs associated uncertainty unevaluated input parameter settings. emulator however extremely fast evaluate provides insight model’s structure thanks speed used help perform global parameter search eﬃciently approaches comparatively slow scientiﬁc model many analyses corresponding parameter searches still fail appropriate measure acceptable match model reality deﬁned. lead badly behaved objective functions properly capture desired match criteria often harder explore high dimensions increased numbers ridges spikes local minima. bayesian emulation methodology introduce naturally incorporates detailed statistical models diﬀerence between model outputs observed data allow inclusion important sources uncertainty observational error model discrepancy later upfront acknowledgement limitations current model. various structures increasing complexity available representation uncertainties depending requirements importance study examples discussion). worth noting speed emulators would greatly improve eﬃciency many forms analysis modeller wish perform e.g. fully bayesian mcmc analysis direct global parameter searches however high dimensional models particular strategy chosen parameter search vital. many approaches struggle trapped local minima chase scientiﬁcally spurious best match parameter setting. here describe eﬃcient global parameter search method known bayesian history matching proved successful across wide range scientiﬁc disciplines including cosmology epidemiology reservoir utilises bayesian emulators reduce eﬃciently input parameter space iterations waves identifying regions implausible matches observed data objective identifying acceptable input parameter settings. careful approach avoids many traps common parameter search techniques. hormonal crosstalk network arabidopsis root development understanding hormones genes interact coordinate plant growth major challenge developmental biology. activities auxin ethylene cytokinin depend cellular context exhibit either synergistic antagonistic interactions. previously three authors developed hormonal crosstalk network single arabidopsis cell iteratively combining modelling experimental analysis kinetic modelling used analyse network regulates auxin concentration arabidopsis root controlling relative contribution auxin inﬂux biosynthesis eﬄux; integrating auxin ethylene cytokinin signalling although parameters model based experimental data parameters chosen adjusting experimental data. conditional somewhat choices shown hormonal crosstalk network quantitatively describes three hormones interact polaris peptide regulate plant root growth work demonstrate power bayesian emulation methodology applying hormonal crosstalk network arabidopsis root development. speciﬁcally explore model’s dimensional parameter space identify acceptable matches model outputs experimental data taking account major sources uncertainty. provides much insight model’s structure constraints imposed rate parameters current observed data. apply methodology second competing model hence able investigate gene functions robustly. example analysis suggest that context hormonal crosstalk network polaris peptide must role positively regulating auxin biosynthesis. methodology linking model reality bayesian emulation history matching going compare strengths weaknesses bayesian history matching standard approaches. results discussion section describe detail application methodology full dimensional arabidopsis model discuss relevant insights biological implications obtained. methods simple -dimensional exponential example introduce simple -dimensional exponential model example illustrate deﬁnitions parts typical systems biology analysis example model input rate parameters observations errors model discrepancy bayesian emulators implausibility measures history matching. speciﬁcally -dimensional example used throughout methods section demonstrate three main parts approach temporarily assume initial conditions system runs ﬁrst interested value mathematical model features input rate parameter wish learn about. using measurement real biological system denote corresponds model output ft=.. note usually models realistic complexity would analytic solution given equation instead would resort numerical integration method solve equation might require signiﬁcant time model evaluation ranging less second hours days even weeks depending full complexity model computational cost single evaluation model means full global parameter search computationally infeasible especially model many rate parameters therefore high dimensional input space require vast numbers evaluations explore fully. typically begin analysis exploring model’s behaviour several diﬀerent values unknown rate input parameter figure shows evaluations model diﬀerent values coloured purple respectively time x-axis. measurement system denoted represented resenting observational error deﬁned precisely below. measurement made shown vertical dashed line. important questions biologist point model match observed data entire input parameter choices give rise acceptable matches model output observed data? figure represents question shows ft=. represented purely function input parameter x-axis purple points consistent left panel. observed data represented solid black horizontal line general complex model possesses large number input rate parameters possibly several outputs full analysis model’s behaviour encounters following issues comparing model observed data real biological system adequate statistical description link model reality covering major uncertainties required. model discrepancy linking model reality systems biology models developed help explain understand behaviour corresponding real world biological systems. essential part determining whether models adequate task process comparing model experimental data. comparison kind involves several uncertainties cannot ignored therefore vital develop clearly deﬁned statistical model link systems biology model reality allows meaningful deﬁnition ‘acceptable’ match model observed data. describe simple extremely useful statistical model link biological model reality successfully applied variety scientiﬁc disciplines example climate cosmology reservoir modelling epidemiology recognisable source uncertainty observational experimental error. represent uncertain quantities interest real biological system vector measure vector errors give vector observations represent errors additive although complex forms could used. note represent vectors random quantities reduce scalar random quantities quantity interest. common speciﬁcation employ judge errors independent unbiased expectation scalar case important distinction make model biological system represented vector system represent difference using model discrepancy term follows. even evaluate model best possible choice input output would still agreement real biological system value many simpliﬁcations approximations model. hence state that model discrepancy vector uncertain quantities represents directly diﬀerence model real system. treat vectors random quantities. simple popular speciﬁcation would judge independent scalar case multivariate setting describes vector outputs vector intricate structure possessing non-zero covariances components could capture related deﬁciencies model across diﬀering time figure left panel evaluations model diﬀerent values coloured purple respectively time x-axis. measurement real system denoted represented black point error bars representing observational error. right panel model curved dashed line gives ft=. represented purely function input parameter x-axis purple points consistent left panel. observed data given solid black horizontal line error bars explicit inclusion model discrepancy term unfamiliar standard practice statistical literature complex models furthermore analysis performed without term implicitly conditioned statement given model perfect representation reality value inputs statement rarely true. model discrepancy allows perform richer analysis include extra knowledge model’s deﬁciencies improve modelling reality joint structure especially important prediction simple example model undershot every auxin output measured suspect undershoot future measurements auxin also wish build prediction future specify probabilistic attributes priori learn comparing observed data. direct speciﬁcation often various simple experiments performed model obtain assessments aspects necessary. example often models exact initial conditions performing exploratory model evaluations initial conditions appropriately perturbed would provide lower bound several assessment methods demonstrated details. figure shows case simple -dimensional exponential example model observation error model discrepancy ignored. model given purple line observed data given horizontal black line. value viewed acceptable others unacceptable particular value unique perform measurement again measurement error would diﬀerent value hence importantly model second output corresponding diﬀerent time also depended input would extremely unlikely able match outputs measurements would obtain exact matches simultaneously precisely value inferences predictions biological system made case using value trustworthy. taken account major types uncertainty range acceptable values borderline/unacceptable points yellow/red. consider additional outputs model still chance match simultaneously data subset currently acceptable points. hand cannot figure left panel unrealistic case observation error model discrepancy ignored. model given purple line observed data horizontal black line. value viewed acceptable others unacceptable however repeat experiment would yield slightly diﬀerent hence right panel realistic situation include observation error evaluated input point additionally provides associated uncertainty prediction critically emulator extremely fast evaluate requires matrix multiplications hence used explore input space fully example global parameter search. acceptable points even given uncertainties represented state model inconsistent observed data therefore likely based incorrect biological principles. further inclusion observation error model discrepancy terms often aids global parameter search tend smooth likelihood surface making easier explore simultaneously robust. also help reduce temptation chase often scientiﬁcally misleading global minimum lone green point ﬁgure instead suggesting identiﬁcation acceptable input points appropriate goal search bayesian emulation systems biology models many complex mathematical models developed employed within area systems biology. often models high dimensional input spaces posses several input parameters example reaction rate parameters must speciﬁed order evaluate model. represent list inputs vector individual inputs model number outputs denoted vector individual outputs behaviour want investigate possibly comparing observed data. example index label diﬀerent times interested diﬀerent chemical outputs model both. ﬁrst term right hand side emulator equation regression term known deterministic functions common choice order polynomials unknown scalar regression coeﬃcients. second term gaussian process means choose ﬁnite emulator given equation possesses various desirable features. regression term given βijgij often chosen represent third order polynomial active inputs. would attempt mimic large scale global behaviour function many cases capture large proportion model’s structure. function sensible ﬁrst step attempts construction full emulator form given equation second term gaussian process mimics local behaviour speciﬁcally local deviations third order polynomial given regression terms. choose list active inputs using various statistical techniques example classical linear model ﬁtting criteria list active inputs particular output means reduced input dimension dimensions result large eﬃciency gains. small remaining eﬀect inactive inputs captured third term equation proceed performing initial carefully chosen model evaluations often picked ‘space ﬁlling’ i.e. well spread input space. example maximin latin hypercube design approximately orthogonal design attempts ensure large holes in-between locations point latin hypercube design created dividing range input sub-intervals placing points ensure ever point sub-interval function many latin hypercube designs generated maximum minimum distance points chosen. emulator given equation model runs using favourite statistical tools guided expert judgement. speciﬁcally would prefer fully bayesian approach required full probability distributions bayes linear approach describe below required purely expectations variances covariances make certain pragmatic choices emulator construction process example keep regression coeﬃcients uncertain rectly specify priori suitable plugin estimates emulators provide expectation variance value unexplored input point test emulators using series diagnostics example checking prediction accuracy batch runs introduction detailed descriptions emulator construction. several approaches emulator construction preferred choice bayes linear methods tractable version bayesian statistics requires simpler prior speciﬁcation analysis deals purely expectations variances covariances uncertain quantities uses following update equations adbeliefs light data. performed initial wave runs input locations giving column vector model output values fi))t labels model output. obtain adjusted expectation variance input point using figure maximum minimum distance latin hypercube designs size blue points represent locations rate input parameter space would full systems biology model. designs space ﬁlling approximately orthogonal desirable features ﬁtting emulators. note construction process latin hypercube ensures blue point within subintervals inputs ensuring excellent coverage. instead equations speciﬁed complex multivariate emulator edi) vardi) used directly implausibility measures used global parameter searches described below. figure shows output emulator simple model deﬁned equation suppose runs model performed locations shown purple points therefore model output values simplicity treat constant term known hence choose prior expectation value expect function outputs approximately centred around. specify parameters covariance function given equation representing curves moderate smoothness process discussed detail full arabidopsis model. simpliﬁed form emulator given equation choose polynomial terms βjgj represent constant term input variable distinction between inactive active variables also figure left panel emulator simple exponential model. purple points show evaluations model rate parameter locations coloured points ﬁgure blue line represents emulator’s deﬁnes region lines believe highly likely contain true function note evaluation emulator extremely fast requires matrix multiplication. right panel emulator complex function given equation true function shown black line lies within emulator credible intervals points. figure shows function blue line. precisely interpolates known runs outputs desirable deterministic function. blue line also gives satisfactory estimate true function exp. pair lines give tion deﬁnes region lines believe highly likely contain true function another desirable feature emulator credible intervals decrease zero width known locations appropriate deterministic function precisely know value therefore close known certain possible values compared runs. functions true function given solid black line seen lies within credible region getting close boundary demonstrates power emulation process points emulator accurately mimics reasonably complex function turning points. demonstrate eﬀectiveness emulators higher dimensions main arabidopsis model example. history matching eﬃcient global parameter search bayesian emulation useful variety situations. emulators extremely fast evaluate replace original model larger calculation example designing future experiments also provide much structural insight behaviour model. important applications emulation problem performing global parameter search. section describe powerful iterative global search method known history matching successfully employed variety scientiﬁc disciplines including galaxy formation epidemiology reservoir modelling climate modelling environmental science traﬃc modelling many applications involved models substantial runtime process emulation vital. history matching designed answer questions. proceeds iteratively employs implausibility measures determine parts input space discarded investigation. question unexplored input parameter setting would emulator’s expected value individual function output corresponding observed value could deem highly unlikely give acceptable match evaluate function value implausibility measure captures concept given numerator equation gives distance between emulator expectation edi) observation denominator standardises quantity relevant uncertainties regarding distance emulator variance vardi) model discrepancy variance observation error variance var. structure direct consequence equations large value particular implies would unlikely obtain acceptable match model there. hence discard input parameter search cutoﬀ refer input implausible. choose cutoﬀ appealing pukelsheim’s -sigma rule powerful result states continuous unimodal distribution probability must represents collection outputs important subset robust approach would consider second third maximum implausibility hence allowing inaccuracy emulators also multivariate implausibility measures available details) require detailed prior speciﬁcation example requires covariances diﬀerent components note value implausibility imply input point ‘good’ ‘plausible’ still lead poor outputs included yet. also implausibility occur because high emulator variance vardi) resolved following runs model lead high implausibility hence refer implausibility inputs non-implausible consistent literature proceed iteratively discarding regions input parameter space waves refocussing search remaining ‘non-implausible’ inputs wave. prior performing wave deﬁne current non-implausible input points check informative outputs emulated accurately previous deﬁne runs construct accurate emulators deﬁned region implausibility measures recalculated using emulasources uncertainty model discrepancy observation errors entire input space deemed implausible return step true generate large number possible acceptable runs ﬁnal nonent locations within corresponding biological implications. entire input space deemed implausible step imply model inconsistent observed data respect speciﬁed uncertainties. could biological principles underlie model’s structure incorrect hence remodelling required. underestimated observation errors model discrepancy even emulator uncertainty although emulator diagnostics combined choice fairly conservative cutoﬀs make latter unlikely. note concluding larger model discrepancy needed essentially stating model highly inaccurate example judged unﬁt purpose. volume region input space interest expect function become smoother hence accurately approximated regression part emulator βijgij often composed order polynomials demonstrate history matching process applied simple -dimensional exponential example. figure shows emulator expectation credible intervals ﬁgure however observation plus observed error included horizontal black solid dashed lines respectively. model discrepancy zero reduced size observation errors clarity. also given implausibilities represented colours x=axis yellow green high borderline implausibility respectively. plying runs little reduce non-implausible region further. note providing enough runs wave would often create emulators wave deﬁned current green non-implausible region instead updating emulators previous waves ﬁgure supplementary material code reproduce example model output discrepancy emulation history matching plots ﬁgures respectively. history matching bayesian mcmc discuss standard form full bayesian analysis compare history matching approach highlighting relative strengths weaknesses method. history matching attempts answer eﬃciently important questions modeller have identifying model match data input space acceptable matches found. requires limited speciﬁcation related uncertain quantities terms means variances covariances. fully bayesian approach goes delivers posterior distribution across uncertain quantities beneﬁt providing probabilistic answers scientiﬁc figure left panel emulator expectation credible intervals ﬁgure however observation plus observed error included horizontal black solid dashed lines respectively. implausibilities represented colours x-axis yellow green high borderline implausibility respectively green interval deﬁning non-implausible region second wave. right panel second wave performed evaluating runs located within emulator becomes accurate implausibility strict hence deﬁning smaller non-implausible region given green interval. emulator accurate observed errors within additional runs signiﬁcantly reduce further hence history match complete. questions e.g. context gives posterior distribution location true input however requires detailed prior speciﬁcation joint probability distributions across quantities critically also assumes existence single true judged appropriate example situation diﬀerent found gave good matches different subsets observed data. detail fully bayesian speciﬁcation context equations requires multivariate distributions π)|x) collection inputs prior distribution true input meaningful speciﬁcations form diﬃcult make example often familiar distributional forms assumed multivariate normal distribution choices often made mathematical convenience computational tractability. really choices kind demand careful justiﬁcation without results posterior rapidly lose meaning. example fully bayesian approach will substantial calculation return posterior quite narrow even model cannot observed data all. history matching however quickly discover mismatch waves making analysis unnecessary. required popular mcmc mcmc enjoyed much success issues still remain convergence mcmc algorithm even modest dimensional problems often likelihood highly multimodal therefore vast numbers model evaluations usually required reach convergence making mcmc prohibitively expensive models even moderate evaluation time. contrast calculations history matching relatively fast simple. third issue robustness small changes full bayesian speciﬁcation especially involving likelihood lead substantial changes posterior. sensitivities unnoticed hard analyse call question resulting scientiﬁc conclusions. issues support fully bayesian approach cases detailed calculations warranted well tested accurate biological model possesses well understood model deﬁciencies combined data trusted observation error structure critically full probabilistic results deemed essential. instead main concern check whether model data; regions input parameter space give acceptable matches used model development history match appropriate analysis. even wishes forecast results future experiments make subsequent decisions history matching suﬃcient either re-weight appropriately samples generated ﬁnal wave done stated step history matching algorithm sophisticated sampling non-implausible region depending scientiﬁc question. emulators course facilitate large number model evaluations required bayesian mcmc algorithms admittedly expense increased uncertainty however serious problem encountered. likelihood function core component bayesian calculations constructed outputs interest hence need able emulate suﬃcient accuracy outputs including possibly complex joint behaviour. extremely challenging often especially early waves exist several erratically behaved outputs extremely diﬃcult emulate dramatically fail emulator diagnostics unfortunately likelihood hence posterior highly sensitive poorly constructed emulators. therefore purely practical perspective employing full bayesian paradigm using inadequate emulators constructed wave unwise history matching precursor mcmc wish perform fully bayesian analysis well tested biological model would usually recommend performing history match ﬁrst note history match cuts space eﬃciently based small numbers easy emulate outputs early waves designs appropriate runs next wave good coverage properties current non-implausible region. alternative iterative strategies using mcmc wave generate samples current posterior model runs next wave highly ineﬃcient could series diﬃculties. strategies would fully exploit smoothness model output tend cluster points together around current posterior mode leading poor coverage full non-implausible space. strategies also highly misled inaccurate emulators subsequent posterior sensitivity combined multimodal likelihood issues leading clustered designs wrong parts input space cases lack convergence. conclude really desires fully bayesian analysis performing history match ﬁrst greatly improve eﬃciency. view history matching straight competitor alternative approaches instead complimentary technique many beneﬁts right. extended discussion details argument. history matching another bayesian technique developed recently compared history matching example approximate bayesian computation approaches seem share superﬁcial similarities fundamentally diﬀerent goal principled approach implemented. example attempts approximate full bayesian inference hence obtain approximate bayesian posterior distribution history matching inference procedure simply attempting rule input space clearly inconsistent data given model discrepancy observation error worth noting attempts specify meaningful minimum size tolerance arguably really employing anymore instead back using bayesian inference form sampling-resampling algorithm history matching attempt probabilize remaining input space result increased eﬃciency parameter search. directly compared contrasted approaches demonstrated powerful version failed part parameter space matched observed data -dimensional stochastic epidemiology model history matching found correct evaluated represented table parameters rate parameter exception control parameter represent wildtype represent mutant hence included parameter search leaving free parameters. compare model output data equilibrium perform substantial dimensional reduction input space. referring model equations given table equilibrium derivative left hand side equation equal zero right hand side hence rearranged terms less rate parameter. example equation d/dt becomes results application hormonal crosstalk network arabidopsis root development model describe relevant features hormonal crosstalk arabidopsis root development model preparation application bayesian emulation history matching processes introduced above. hormonal crosstalk arabidopsis model constructed basis known molecular interactions experimental evidence models crosstalk auxin ethylene cytokinin gene arabidopsis root development. network model shown ﬁgure displays main modules auxin ethylene signalling. full description model along justiﬁcations various modelling choices employed found mathematical representation arabidopsis model given table ordinary differential equations describe evolution time diﬀerent biological quantities. note analogy equation describing simple exponential model. arabidopsis model requires speciﬁcation input rate parameters depends ratio hence data equilibrium inform ratio cannot provide constraint upon original parameters individually therefore remove total parameters reduce dimension input space choosing work appropriate rate parameter ratios. speciﬁc rate parameter ratios well unaltered rate parameters given table also shown consider ranges rate parameters ratios always positive span orders magnitude choose convert scale. hence deﬁne -dimensional vector input parameters model corresponds ﬁrst column table withinclusion control parameter vector inputs used emulator equations directly analogous -dimensional input simple model given equations arabidopsis model also requires initial conditions model outputs values used given table table hormonal crosstalk arabidopsis root development model diﬀerential equations. details. also table supplementary material dimensions units rate constants. symmetries model equilibrium ratios certain parameters constrained hence choose work directly ratios given left column. note control parameter used deﬁne wildtype mutant hence included parameter search. table list original model outputs initial conditions whether measurements available. simplicity terminology exogenous application cytokinin referred feeding auxin cytokinin ethylene.the values cytokinin correspond feeding feeding auxin cytokinin ethylene respectively. details. model). measured following cases wild type mutant wild type auxin wild type ethylene wild type cytokinin mutant ethylene critical behaviour want arabidopsis model capture trends exhibited certain pairs measurements. example auxin level seen decrease mutant compared wild type seen increase ethylene wild type compared wild type feeding. summary experimental trends used analysis given table details). diﬀerent experimental scenarios correspondingly represented model choosing certain values control parameter initial conditions cytokinin represent concentration feeding chemicals present. wild type mutant cases correspond setting respectively feeding implies iaa=acc=cytokinin= iaa= acc= cytokinin= corresponding feeding auxin ethylene cytokinin respectively introduced control parameter represents combined choice plant type feeding action subscript indexes four measurable chemicals vector represents vector rate parameters represents time. mainly interested matching observed trends often speciﬁed ratios wild type. therefore choose work ratio model outputs robust allow multiplicative error statements. also equate trends output model equilibrium matches found unrealistic concentrations auxin cytokinin. note bayesian emulation history matching methods propose could applied outputs time point equilibrium points primary interest primary question modeller point whether outputs model form match observed trends given table within acceptable level tolerance rate input parameters corinitial input space choose perform global parameter search history match deﬁned table constructed specifying ranges inputs covered least order magnitude single input parameter setting found ranges parameters particular interest subsequently increased allow wider exploration. means explore biologically plausible space covers least orders magnitude every dimension centred around original parameter linking arabidopsis model reality next task link arabidopsis model formally reality bayesian paradigm allows represent scientiﬁc judgements probabilistic speciﬁcations follow bayes linear approach expectation variance statements access precise quantitative values observations feature equation instead propose values observations observation errors model discrepancy consistent observed trends given table expert judgement concerning accuracy model relevant experiments. reasons ﬁrstly demonstrate approach reasonably applied situations qualitative data available secondly highlight kinds analysis possible quantitative measurements actually available across outputs interest hence motivating detailed future data collection. several possible ways assess table summaries direction observed trends four measurable chemicals relative wild type four types experiment mutant feeding auxin ethylene cytokinin respectively ﬁnal column gives trend case feeding ethylene mutant relative mutant feeding. text also detail size related uncertainties measured trends. represent increase fold trends decrease also fold down trends interval decrease increase change trend. intervals assumed symmetric scale formulated answering natural question would model output avoid violating trends given table considering relevant observational model uncertainties? speciﬁcation captures main features trend data suﬃcient purposes demonstrating bayesian history matching methodology. obviously detailed treatment would involve information regarding observations themselves associated measurement errors represented var. also consider detail known deﬁciencies model could give detailed speciﬁcation model discrepancy would likely include correlations diﬀerent outputs exploited joint structure suggested choice chemical choice mutant choice feeding regime even including simple dependence certain input parameters. examples detailed model discrepancy speciﬁcations alternative applications discussions. given black error bars scale. also shown additional non-ratio wildtype outputs auxin cytokinin given reasonably wide intervals plus minus order magnitude speciﬁcation equivalently used deﬁne ‘acceptable match’ model output observed data implausibility measures equation model evaluation satisﬁes cutoﬀ common choice based pukelsheim’s sigma rule impose constraint simultaneously across outputs shown ﬁgure demanding maximum implausibility deﬁned equation could impose less stringent criteria constraining second third maximum implausibility instead would allow model runs deviate outputs respectively. bayesian emulation arabidopsis model proceed ﬁrst wave emulation arabidopsis model follows. note several packages available perform standard gaussian process emulation gpﬁt packages python) uninitiated alternative slightly sophisticated emulators describe here. percube design using example function runs speciﬁes distinct values rate parameters therefore differential equations given table solved numerically using lsoda function initial conditions given table seconds ensure equilibrium reached took approximately second real time evaluate implying although relatively fast model still slow exhaustively search full dimensional input space figure wave outputs outputs considered shown purple lines observed data given black error bars best previously found shown light blue line. give substantial insight broad behaviour model initial search region would likely require vast number runs. emulators develop turn orders magnitude faster model hence allow much detailed eﬃcient exploration. ratio emulator speed versus model speed actually improves model complexity increases speed emulator function number runs used construct note choosing number wave runs computer model literature tentatively suggests least required emulator construction dimension input space. course depending complexity model needed. here arabidopsis model reasonable speed could aﬀord runs wave allows ﬁtting higher order polynomial terms cubics restricted active inputs identiﬁed. also given black error bars best previously found discussed shown light blue line. runs generated space ﬁlling design give substantial insight broad behaviour model initial search ingly constrained give positive negative trends many runs target ranges also individual wave passes every target intervals. suggests volume nonemploy general emulator structure represented equation output identify list active input parameters ﬁtting ﬁrst order polynomials selecting active inputs based criteria step functions choose deterministic functions selecting terms complete third order polynomials active inputs discarding terms based criteria details). show structure wave emulators terms deterministic functions choice active variables supplementary material. large number runs absence strong prior information take large limit. terms hence behave bayes linear update represented equations approximately like ordinary least squares linear model details). note linear models formed point withinclusion gaussian process part below would already give reasonably eﬀective emulators choose combination gaussian process nugget variances equal residual standard error linear model parameter governing proportion variance explained inactive variables taken checked emulator diagnostics described below. note could design runs vary inactive variables assess accurately done utilise argument presented full choosing correlation lengths emulators contain order polynomials states ﬁtting third order polynomials active inputs expect residual surface look approximately like fourth order surface hence choose correlation length accordingly. hence correlation lengths required equation agreement inputs scaled range note estimate individual correlation lengths using maximum likelihood improve emulators accuracy provided polynomial surface ﬁtting well judged adjusted linear model improvement would modest. finally constructed emulators using bayes linear update equations obtain edi) vardi) output detailed emulator diagnostics). ﬁrst wave found outputs straightforward emulate emulators suﬃcient accuracy allow reasonably large parts input space removed simultaneously satisfying emulator diagnostics. remaining outputs left considered later waves. outputs required between active inputs total full reduced input parameters represents substantial dimensional reduction hence large beneﬁt emulator construction process subsequent parameter search discussed addition speed increase using emulators case times faster evaluate full arabidopsis model. note inputs featured least emulators. well maximised implausibility deﬁned equation also robust second third maximum implausibilities denoted respectively deﬁned using outputs considered wave implausibility measures robust emulator failure. ﬁrst wave used conservative cutoﬀs imposed reimplausibilities projected dimensions minimising implausibility remaining dimensions. partition dimensional vector representing inputs wish project onto remaining inputs minimised implausibility deﬁned middle right columns respectively). gives minimised implausibility dark grey regions imply matter values chosen remaining inputs model still poor match data settings kvauxin/ka kveth/k. bottom gives optical depth shows thickness depth non-implausible region remaining input dimensions proportion depth original space plot following interpretation red/dark grey regions correspond high implausibility imply matter values choose remaining inputs arabidopsis model give good matches data regions space. green/yellow regions imply somewhere within -dimensional space implausibility points values kvauxin/ka kveth/k. therev{.} denotes -dimensional volume remaining space. therefore show large small amounts non-implausible points found conditioned providing insight structure genproceeded total waves emulation history matching. summaries waves’ properties terms outputs emulated numbers active inputs used cutoﬀs implausibility measures employed found table ﬁnal column gives proportion non-implausible space remaining terms original input space wave. wave emulator diagnostics performed evaluating another model runs current non-implausible space checking emulators predict runs appropriate accuracy details emulator diagnostics). table summary waves emulation. col. outputs emulated col. active inputs used; col. implausibility thresholds; col. proportion parameter space deemed non-implausible. wave performed emulated. kvauxin/ka kveth/k highlight progression history match sequential reduction non-implausible space. minimised implausibility plots also show sensitivity size location non-implausible region choice cutoﬀ motivated pukelsheim’s rule given table note optical depth plot wave depth nonimplausible region small. even inputs kvauxin/ka kveth/k values corresponding largest depth chances ﬁnding non-implausible point randomly choosing inputs apaverage total runs chosen random obtain single acceptable requiring approximately hours processor time. contrast history matching approach generated hundreds acceptable runs using model evaluations requiring approximately hours processor time. expensive model terms evaluation time efﬁciency gains would even dramatic describe results paramdiscussion results parameter search figure shows wave minimised implausibility optical depth plots informed input rate parameters labelled along diagonal. example right panel gives optical depth plot kveth/k x-axis ka/ka y-axis bottom left plot gives corresponding minimised implausibility plot xy-axis swapped. input location parameter space previous best described shown single white point panels corresponds single light blue ﬁgure along main diagonal -dimensional optical depth plots given showing learnt inputs ka/k k/ka kvauxin/ka kveth/k. inputs shown plot either constrained loosely constrained observed data. often pairs plot shown ﬁgure provide much insight structure model complex constraints placed upon input rate parameters data. example instantly input ka/k highly constrained must close value value precisely balances ﬁrst terms right hand side diﬀerential equation dx/dt obtains maximum value ka/ka panel shows linear relationship ka/ka high values require high values ka/ka compensate them vice versa. input large range explored constrained lower values subtle relationships inputs ka/ka important consequences discussed below. also although previous best close acceptable input point actually contained within wave non-implausible volume seen plot. implies large number wave runs superior data previously found. minimised implausibility plots ﬁgure also provide implausibility cutoﬀ insight sensitivity size location non-implausible region original speciﬁcation size trend intervals given equation example regions ruled intervals judged moderately less conservative. error bars previous best found shown light blue line. note ﬁrst error bars correspond extra ouputs auxin wildtype feeding remaining trend data table horizontal black line zero represents trend. history match proceeded expected runs subsequent waves getting closer closer target data. wave none runs simultaneously passed targets figure wave minimised implausibility optical depth plots informed input rate parameters labelled along diagonal. note input rate parameters scale given equation ranges consistent table input location previous best described shown single white point. along main diagonal -dimensional optical depth plots given. figure also informs class possible observed data sets model could matched hence gives insight model’s ﬂexibility. trend outputs could predicted either positive negative trends hence could possibly ﬁtted many diﬀerent data sets although investigation joint structure outputs would required conﬁrm this. example outputs found vary independently could adjusted combination positive negative trends. however remaining trend outputs restricted giving ‘correct’ trend hence seem ﬂexible all. general concerned overly ﬂexible model possessing high number rate parameters speciﬁcally claims validated based purely comparison data would surprise observed data well therefore contain much inherent biological structure all. clearly case arabidopsis model considered here. performing global parameter search described here guard issues. gain insight model’s structure plotting pairs outputs other wave shown ﬁgure colour scheme consistent ﬁgure wave runs purple green points respectively target intervals represented shown light blue line. horizontal black line zero represents trend. history match proceeded expected runs subsequent waves getting closer closer target data resulting large number acceptable wave runs possess better match quality previous best run. boxes previous best given light blue point. right panel example shows auxin output mutant strain y-axis plsm output auxin feeding x-axis. suggests large negative trends auxin output occur plsm trend close zero. similarly high plsm trend implies auxin must also close zero. plots also highlight previously unknown model constraints outputs e.g. auxin panel shows trends satisfy strict inequality space bisects target box. similar strict constraints seen auxin auxin plsm panels. onto discuss detail implications gene functions parameter search results. discussion evaluation gene functions using bayesian emulation methodology previous sections shown bayesian emulation history matching methodology allows extensive exploration input rate parameter space giving multiple insights model’s structure constraints placed upon observed data corresponding biological consequences. demonstrate methodology used evaluate regulatory relationships gene functions hormonal signalling systems examining results results obtained second history match alternative model. figure gain insight model’s structure plotting pairs outputs other wave. colour scheme consistent ﬁgure wave runs purple green points respectively outputs labelled along diagonal. target intervals represented boxes previous best given light blue point. hence several hard constraints model’s outputs example auxin therefore increasing decreases regulatory strength. thus values indicate regulatory relationship ethylene inhibiting plsm production required. optical depth minimised implausibility plots corresponding figure show high values ruled out. analysis suggests acceptable parameter combinations large found consistent target data hence results strongly support assertion inhibition plsm production ethylene required predicting known experitherefore case implies gene direct function auxin biosynthesis case would imply does. however several outputs considered also tend zero implying limit given equation uniquely deﬁned original model continuous hence answer questions regarding role gene auxin biosynthesis cannot simply examine values case eﬀectively deﬁnes distinct model perform wave history match acceptable matches observed data following methodology described above. results history match given ﬁgure notably found several acceptable wave runs shown lines agreement observed trends. acceptable runs found comparing results case results case immediately important diﬀerences models. auxin mufe output model always returns correct negative trend. contrast model returned incorrect positive trend vast majority wave runs implying small region input space returns correct negative trend region located history match analysis explored wave runs. without analysis would easy incorrectly conclude model inconsistent data. demonstrates perhaps important diﬃculty exploring high dimensional models extremely small regions input space scientiﬁc interest conventional optimisation techniques easily stuck local minima away regions. bayesian history matching approach however speciﬁcally designed combat diﬃculties carefully exploring space using eﬃcient emulator based global search methods demonstrated here. considering gene required response ethylene downstream based experimental observations ethylene) previous research deduced gene indeed function auxin biosynthesis. however history match model suggests that given speciﬁcation trends relevant uncertainties model consistent observed data hence essential gene play role auxin biosynthesis. however examining diﬀerences models reveals interesting results. figure summarises history match results models. shows comparison spread input parameter locations acceptable runs found model model terms individual input rate parameters labelled along x-axis. note sets acceptable runs compared correspond lines ﬁgures respectively. y-axis scale grey rectangles show initial ranges deﬁne original search region given table light blue horizontal lines show input parameter values previous best found main diﬀerences models’ acceptable runs exhibited following parameters ratios parameters k/ka k/ka ka/ka ka/k k/k. best knowledge biological signiﬁcance many diﬀerences cannot judged using current biological insight. however ratios k/ka ka/ka reveal important results. maximal rate transporting auxin shoot root; background auxin biosynthesis rate; rate constant describing control ethylene downstream auxin transport root shoot. first biologically k/ka must small. background auxin biosynthesis rate must small usually biologically negligible represents non-enzymatic process auxin biosynthesis. moreover auxin transport shoot root whose maximal rate important process evidenced experimentally therefore large. however model match target data majority acceptable runs relatively large k/ka model much smaller realistic values preferred. second biologically ka/ka small. known auxin predominantly transports shoot root form auxin concentration maximum root however model match target data acceptable runs suggest relatively large ka/ka required. therefore diﬀerences models’ parameter ratios highlight that although found acceptable matches model matches found biologically realistic parameter values. must cautious conclusions based ﬁnite sampling non-implausible regions generated hundreds approximately uniformly sampled acceptable runs model indeed exhibit features discussed. therefore results suggest biological insight clearly favours model i.e. gene function auxin biosynthesis. detailed measurements outputs restrict k/ka ka/ka would course further clarify issue. figure results history match model showing waves runs purple green lines respectively model outputs interest. large number acceptable wave runs found match target data hence reduced model still consistent speciﬁed observational data within small region input space. comparison ﬁgure shows main diﬀerences models noticeably auxin mufe output vast majority input space returns incorrect positive trend model seen large number wave lines zero small hence hard region returning correct negative trend. model conversely always returns correct negative trend. results show bayesian emulation history matching methodology used evaluate regulatory relationships gene functions hormonal signalling systems. improve accuracy results methodology following aspects considered. first experimental data quantitatively measured deﬁne accurate trends. example trends used work summarised table associated discussion mainly formulated based qualitative semi-quantitative experimental data combined scientiﬁc judgement. second model development include components better describe experimental systems. third bayesian emulation methodology used study eﬀects additional experiments response ethylene downstream feeding ethylene mutant etr-pls double mutant evaluation regulatory relationships gene functions. fourth bayesian emulation methodology also used explore eﬀects uncertainty quantitative trends evaluation regulatory relationships gene functions cases trends biological data suﬃciently quantitative. conclusions provided introduction study complex systems biology models using bayes linear uncertainty analysis. represents possible solution fundamental challenge faces systems biology terms necessity global parameter searches figure comparison spread input parameter locations acceptable runs found model model terms individual inputs labelled along x-axis. note sets acceptable runs compared correspond lines ﬁgures respectively. y-axis scale grey rectangles show initial ranges deﬁne original search region given table light blue horizontal lines show input parameter values previous best found inputs example either unconstrained observed data possibly changes inputs compensated appropriate changes inputs. inputs ka/k highly constrained others k/ka k/ka ka/ka show clear diﬀerences models latter model preferring higher values k/ka ka/ka lower values k/ka. ment model case identiﬁed small region input space containing scientiﬁcally interesting matches. models biological implications compared robust manner used discuss gene functions. found although acceptable matches speciﬁed trends could found model found parameter settings violated known biological evidence whereas model’s acceptable matches seemed realistic. implied indeed play role auxin biosynthesis. results also strongly supported assertion inhibition plsm production ethylene required consistency known experimental trends. would stress searching acceptable matches model output observed data vital several reasons. avoids danger false conclusions made based analysis single consistent data conclusions could easily change alternative found instead also matched data provided diﬀerent biological implications. want model make predictions results future biological experiments acceptable matches must found corresponding range predictions examined. narrow range predictions acceptable runs particular proposed future experiment example would imply would good test model could possibly rule large range implies experiment would likely informative model’s rate parameters. model predictions using acceptable runs used design efﬁcient sets future experiments likely realise particular scientiﬁc goals learning subsets rate parameters testing model distinguishing certain biological hypotheses. would assert design problem also fundamental challenge area systems biology leave detailed exposition future work since plant root development regulated multiple hormones coordinated unravelling regulatory relationships gene functions root development diﬃcult task requires investigation biological information spatiotemporally integrated communicated modelling hormonal crosstalk integrative system important aspect integrating information plant root development work demonstrates combination experimental data model hormonal crosstalk arabidopsis root development bayesian emulation history matching methodology able evaluate regulatory relationships gene functions hormonal signalling system. particular bayesian emulation history matching methodology useful method performing global parameter search attempt input parameter settings achieve acceptable match. funding work initiated part epsrc seed corn grant administered durham university. addition gratefully acknowledge biotechnology biological sciences research council funding support study. receipt bbsrc studentship. gratefully acknowledge epsrc funding. author’s contributions conceived idea. designed research carried data analysis. developed performed bayesian emulation uncertainty analysis. authors established links bayesian emulation methodology hormonal crosstalk plant development. wrote manuscript. acknowledgements gratefully acknowledge biotechnology biological sciences research council funding support study. receipt bbsrc studentship. gratefully acknowledge epsrc funding. author details department mathematical sciences durham university south road durham department biosciences durham university south road durham department biosciences durham university south road durham current address department molecular biology biotechnology university sheﬃeld firth court western bank sheﬃeld", "year": "2016"}