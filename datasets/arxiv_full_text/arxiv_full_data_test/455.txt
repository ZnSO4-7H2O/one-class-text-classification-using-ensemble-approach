{"title": "The auxiliary region method: A hybrid method for coupling PDE- and  Brownian-based dynamics for reaction-diffusion systems", "tag": "q-bio", "abstract": " Reaction-diffusion systems are used to represent many biological and physical phenomena. They model the random motion of particles (diffusion) and interactions between them (reactions). Such systems can be modelled at multiple scales with varying degrees of accuracy and computational efficiency. When representing genuinely multiscale phenomena, fine-scale models can be prohibitively expensive, whereas coarser models, although cheaper, often lack sufficient detail to accurately represent the phenomenon at hand. Spatial hybrid methods couple two or more of these representations in order to improve efficiency without compromising accuracy.  In this paper, we present a novel spatial hybrid method, which we call the auxiliary region method (ARM), which couples PDE and Brownian-based representations of reaction-diffusion systems. Numerical PDE solutions on one side of an interface are coupled to Brownian-based dynamics on the other side using compartment-based \"auxiliary regions\". We demonstrate that the hybrid method is able to simulate reaction-diffusion dynamics for a number of different test problems with high accuracy. Further, we undertake error analysis on the ARM which demonstrates that it is robust to changes in the free parameters in the model, where previous coupling algorithms are not. In particular, we envisage that the method will be applicable for a wide range of spatial multi-scales problems including, filopodial dynamics, intracellular signalling, embryogenesis and travelling wave phenomena. ", "text": "auxiliary region method hybrid method coupling pdebrownian-based dynamics reaction-diﬀusion systems cameron smith∗ christian yates∗∗ centre mathematical biology department mathematical sciences university bath claverton down bath united kingdom e-mail c.smithbath.ac.uk e-mail c.yatesbath.ac.uk reaction-diﬀusion systems used represent many biological physical phenomena. model random motion particles interactions systems modelled multiple scales varying degrees accuracy computational eﬃciency. representing genuinely multiscale phenomena ﬁne-scale models prohibitively expensive whereas coarser models although cheaper often lack suﬃcient detail accurately represent phenomenon hand. spatial hybrid methods couple representations order improve eﬃciency without compromising accuracy. paper present novel spatial hybrid method call auxiliary region method couples brownian-based representations reaction-diﬀusion systems. numerical solutions side interface coupled brownian-based dynamics side using compartment-based auxiliary regions. demonstrate hybrid method able simulate reaction-diﬀusion dynamics number diﬀerent test problems high accuracy. further undertake error analysis demonstrates robust changes free parameters model previous coupling algorithms not. particular envisage method applicable wide range spatial multi-scales problems including ﬁlopodial dynamics intracellular signalling embryogenesis travelling wave phenomena. reaction-diﬀusion models important mathematical tools used represent understand complex biological physical behaviours. model random movement particles interactions particles giving wide array applications across multiple spatial scales. applications range large-scale representation striped vegetation patterns semi-arid landscapes spread epidemics smaller-scale studies pattern formation embryogenesis even smaller scales study actin dynamics inside cell’s ﬁlopodia intracellular dynamics reaction-diﬀusion models speciﬁed diﬀerent levels detail depending temporal spatial concentration scales involved application ﬁnest scale consider microscopic dynamics. models methods green’s function reaction dynamics reaction-diﬀusion systems) amongst detailed representations systems consequently relatively computationally expensive. require knowledge location particles times case secondhigher-order reactions pairwise distances particles requires large memory expensive calculate many time-steps. case diﬀusionlimited reactions time-steps must taken extremely small ensure reactive particles jump past attendant reaction events missed. update steps also require production normally distributed random number co-ordinate particle computationally expensive depending reaction system modelled. however expensive steps accelerated considering event-driven algorithms employing approximate algorithms longer time-steps. gfrd event-driven algorithm diﬀers standard method simulating brownian motion. uses maximum time-step single particles pairs particles need considered. utilises exact solution smoluchowski equation order combine movement interactions between particles. particles apart event-based time-steps large. smoldyn uses relatively long time-steps accounts error causes making eﬀective particle sizes larger. micro-scale modelling particularly useful scale detail required example considering binding particles receptors even ﬁner scale representation atomistic dynamics represented available required. typically modelling scale known molecular dynamics direct reader holley dürr information modelling scale. coarser scale compartment-based mesoscopic models. like ﬁne-scale microscopic models also account stochastic variation however particles considered belong compartments rather exact locations tracked. particles either react another within compartment jump adjacent compartments given rates simulating diﬀusion. compartment-based models simulated using either exact computationally expensive inexact computationally cheaper stochastic simulation algorithms exact methods eﬀectively assign exponential waiting times every possible event choose event shortest waiting time enact. general faster microscopic methods since pairwise reaction distances need calculated bi-molecular reactions individual particle identities tracked less accurate since record particle’s location accuracy compartment size generally particles allowed react others compartment finally coarsest scale continuum macroscopic models. commonly employed macroscopic models reaction-diﬀusion systems comprise partial diﬀerential equations methods generally valid high particle numbers. stochastic variations considered small enough neglected high copy numbers play pivotal role dynamics copy numbers leading solutions diverge true underlying dynamics. wealth well established numerical methods quickly simulate approximate solution pde. include ﬁnite-diﬀerence methods ﬁnite-volume methods ﬁnite-element methods often though important biological physical phenomena genuinely multiscale spatial reactiondiﬀusion systems concentration vary orders magnitude. regions concentration often important employ detailed individual-based models order correctly represent disadvantages slow compute reactions. impractical large numbers particles. slow large copy numbers. retain precise location particle identity. inaccurate copy numbers. mean-ﬁeld models diverge individual dynamics higher-order reactions. dynamics. models employed indiscriminately throughout domain however regions high concentration many individual particles evolved might render system computationally intractable. regions might acceptable employ coarser less computationally expensive model. canonical example phenomenon stochastic fisher wave wave speed determined stochastic activity pulled front important employ accurate individual-based representation dynamics region. conversely behind wave front detailed dynamics little importance. possible therefore employ coarser cheaper representation dynamics region. spatially coupled hybrid methods developed precisely purpose simulate spatially inhomogeneous domains accurately eﬃciently. general methods designed accelerate expensive computations whilst maintaining reasonable levels accuracy. majority spatially coupled hybrid methods divide computational domain distinct regions using interfaces. dynamics adjacent regions represented using diﬀerent methods. regions detailed representations dynamics required accuracy simulated using ﬁne-scale method whereas regions less detail required modelled coarser less computationally expensive method. reasons this. ﬁrst order resolve particular region spatial domain detail looking behaviour ions around gated channels building model energy liquid crystal examples prohibitively slow accurate model required certain regions space computationally expensive used everywhere. second reason simply segregate region domain particle numbers. regions coarse method inaccurate. exist hybrid methods couple diﬀerent scales described another comprehensive review methods). macroscopic-to-mesoscopic methods proposed employ averaged ﬂuxes order calculate appropriate boundary conditions regime interface well using extra compartment within macroscopic region mesoscopic-to-microscopic methods also employ extra compartments time microscopic regime developed class methods using adapted rates diﬀusion mesoscopic microscopic domains proposed successfully applied represent biological processes fewer macroscopic-to-microscopic hybrid methods literature. macro-to-micro methods allow mass interface directions order initialise particles average solutions either side interface found literature. detailed review spatially extended hybrid methods above-mentioned hybrid methods particular relevance purposes paper. pseudo-compartment method presented yates flegg macroscopic-to-mesoscopic method coupling achieved using extra compartment known pseudo-compartment adjacent interface within macroscopic domain. compartment mass represented using solution compartment-based method particles allowed cross interface directions using compartment-based method. give schematic representation method figure figure schematics pseudo-compartment method ghost cell method. green line represents solution blue boxes number particles mesoscopic region respective hybrid methods yellow dots denote brownian particles. particles shown volume simulations mass volume. scenario illustrated particles reside one-dimensional line illustrated plane order show directions magnitudes next movement clearly green boxes denote number particles pseudo-compartment similarly yellow boxes number particles ghost cell representing single particle. case line denotes point interface regimes. ghost cell method proposed flegg mesoscopic-to-microscopic method uses extra compartment microscopic domain. number particles ghost cell simply number brownian particles reside region. again particles allowed jump across interface using compartment-based mesoscopic method. schematic representation method given figure paper employ methods order couple macroscopic description reaction-diﬀusion systems corresponding microscopic brownian dynamics representation auxiliary regions. regions compartments either side interface allow mass pass regimes mesoscopic jump process within auxiliary regions mass simultaneously represented using description region reside mesoscopic description. changes implemented modelling paradigm simultaneously implemented interface divides modelling paradigms either static case remains initial position adaptive case moves density proﬁle order ensure regions space particles simulated using ﬁnest scale. series test cases demonstrate algorithm accurate robust model parameters previous pde-to-brownian coupling algorithms. section previous attempt hybridising brownian dynamics model corresponding mean-ﬁeld description evaluated detail description novel auxiliary region method presented section alongside relevant justiﬁcations pseudocode. numerical results verifying accuracy hybrid method presented section numerical error analysis conducted section also discuss restrictions model parameters eﬀective functioning coupling algorithm. conclude discussion eﬀectiveness hybrid method suggest avenues exploration section section summarise pioneering work franz among ﬁrst couple brownian dynamics representations reaction-diﬀusion. replicating results demonstrate pde-assisted brownian dynamics algorithm robust simulation parameter choice even simple diﬀusive processes. motivates need robust coupling method provide form section hybrid methods couple description reaction-diﬀusion system corresponding brownian dynamics representation relatively poorly investigated comparison pde-tocompartment-based compartment-based-to-brownian couplings. part result fact hybrid algorithms neglect meso-scale representations particle dynamics meaning must bridge greater scale separation either hybrid paradigms. mainly though absence many examples pde-to-brownian hybrid methods inherent diﬃculty converting mass individual particles coupling brownian dynamics models continuum representations. below describe algorithms proposed franz focus ﬁrst method interfacial coupling. choose focus coupling coupling method described section also utilises interface. franz present related algorithms. ﬁrst non-overlapping brownian domains separated interface brownian representations updated using time-driven algorithm time-step much smaller brownian timestep. discretised evolved using centred ﬁnite-diﬀerence scheme implicit euler time-stepping mass allowed cross interface regimes. provided brownian time-step suﬃciently small amount mass crosses interface brownian time-steps gives probability particle placed within brownian domain. uniformly distributed random number used determine whether particle initialised brownian regime not. particle’s position randomly initialised according normalised density proﬁle mass crossed interface previous brownian time-step. brownian particle crosses domain particle’s worth mass added solution location δ-function individual particle removed. illustrated method schematically figure franz found variance particle numbers brownian region hybrid domain altered comparison variance would expected fully brownian simulation. order counteract problem introduced second algorithm overlap region replaces figure schematic method proposed franz descriptions figure mass labelled density mass ﬂowed interface brownian update-step. peak curve near interface represents addition δ-function corresponding brownian particle crosses interface. interface. within overlap region mass simulated either brownian particles part pde. coupling works interfacing algorithm however brownian particles subsumed crossed boundary overlap region closest fully-pde domain. similarly mass converted brownian particles ﬂowed overlap boundary adjacent fully-brownian domain. brownian time-step algorithm required small order total probability initialising particle brownian regime less one. however algorithm runs diﬃculties time-step chosen small. speciﬁcally amount mass ﬂows interface updates brownian dynamics small comparison would predicted theoretically using exact diﬀusion kernel. gives rise inaccuracies algorithm particularly long simulation times required. sensitivity choice brownian time-step restricts physical scenarios algorithm applied. ﬁgure present three snapshots evolution ﬁrst version algorithm illustrate problem. time figure clear disparity hybrid method mean ﬁeld solution disparities nature acceptable modelling real reaction-diﬀusion systems irrespective computational savings algorithm able produce. figure evolution particles worth mass initialised single point position times ﬁrst hybrid method franz green line part hybrid method yellow bars represent brownian dynamics hybrid method line interface black dashed line solution mean-ﬁeld diﬀusion equation results shown averaged repeats. section present novel auxiliary region method coupling brownian representations reaction-diﬀusion. simplicity present version method single interface separating regimes. however method easily generalised multiple interfaces separate alternating brownian regions. sequentially describe composition domain models employ region; nature auxiliary regions; implementation movement mass across boundary; implementation reactions; ﬁnally speciﬁc details required simulation algorithm including pseudocode implementation. code written matlab found electronic supplementary material online. recall that coupling method space partitioned regions within diﬀerent modelling paradigms simulate underlying reaction-diﬀusion system. separating regions point interface particles jump according compartmentbased method. particles move domains auxiliary regions ωba; subsets respectively width within regions mass/particles simultaneously represented according default methodology domain also well-mixed particles respective auxiliary regions ωba. figure schematic auxiliary region method descriptions figure interface line centre auxiliary regions shown blocks indicate number particles residing within them. brownian auxiliary regions block represents particle compartment-based representation number blocks determined integrating auxiliary region counting number brownian particles respectively. justify brownian auxiliary region following methodology flegg entire brownian domain simulated using mesoscopic compartment-based regime equivalently using microscopic simulation. absence reactions particles microscopic simulation binned compartments mesoscopic simulation expected numbers compartment simulation would same. scale methods equivalent ways simulating diﬀusive process justify auxiliary region appeal arguments yates flegg note density thought probability ﬁnding particle particular position time scaled number particles within domain. provided auxiliary region suﬃciently narrow density within auxiliary region thought approximately uniformly distributed across region appropriate number particles. precisely interpretation contents compartment within mesoscopic compartment-based framework. here ck)t denotes density species position time diagonal matrix containing fickian diﬀusion constants species function encapsulates eﬀect reactions species. also notation represent boundary initial condition. simulations presented paper employ ﬁnite-diﬀerence θ-method although crank-nicolson method second-order accurate unconditionally stable since crank-nicolson method give rise spurious oscillations implemented step-function initial conditions sort consider denotes location particle species within time-step brownian dynamics simulators number particles species time again reﬂective boundary conditions ends ensure particles leave domain brownian diﬀusion event. zero-ﬂux boundary conditions interface brownian regimes ensure mass cross interface according compartment-based method. since domains zero-ﬂux boundaries interface particles cross interface auxiliary regions. eﬀect regions comprise two-compartment reaction-diﬀusion master equation model. particle auxiliary region jumps neighbouring region side interface rate related macroscopic diﬀusion coeﬃcient note requirement brownian time steps same. many situation useful signiﬁcantly ﬁner brownian time-step time step order accurately resolve individual-based dynamics. employ time-step simulations simplicity. particle numbers allow deﬁne propensity functions corresponding diﬀusive jumps between reactions within auxiliary regions. diﬀusive jumps auxiliary regions propensity functions species within brownian auxiliary regions note prevent possibility negative density. problem scenario occurs persistently practically speaking choose position interface density always large enough happen. adaptive interface allow satisfy criteria hence problem would occur using interface. particle jumps particle within brownian auxiliary region chosen uniformly random removed particle’s worth mass added solution uniformly across species changed throughout reactions implemented using reaction operator method employ implement reactions within depends location reactant particles. denote reaction pathways deﬁne subset reactions time follows reactions molecules least reactive molecules lies within ωb\\ωba implemented using appropriate microscopic approach method however least participating particles care needs taken interaction particles mass side interface explained implement reactions reactant particles using compartment-based method. method later modiﬁcation forward reaction particle species particle species required within distance another order react. react rate function reaction radius reaction rate imagine particle close enough interface reaction radius larger distance interface. consistency brownian representation particle allowed react particle region. implementation reactions would extremely diﬃcult. instead ensuring bimolecular reactions within auxiliary region implemented according mesoscopic compartment-based method avoid issues according backwards reaction particles created reaction occurred. particles placed certain distance away order achieve speciﬁed probability geminate recombination radius intersects regime potential individual particles initialised within employing mesoscopic representations reactions resolve issue. product particles assumed placed uniformly throughout brownian auxiliary region. particles products backwards dissociation reaction ωb\\ωba extremely unlikely placed reasons reactions implemented using compartment-based method reactions incorporated events associated markov chain according rdme. write following propensity functions reactions within reaction channel order corresponding reaction rate appropriate number possible combinations reactants reaction particles within ωba. recall however ωb\\ωba reactions implemented according chosen microscopic reaction method gillespie used simulate above-described reactions well diﬀusive ﬂuxes interface. requires computation exponential random variable gives time next event found transforming uniform random variable unif following equation solutions brownian dynamics implemented using discrete time-step diﬀusive jumps across interface implemented event-driven manner according gillespie ssa. event-driven time-steps implemented putative time next event passes next brownian/pde update time point brownian dynamics updated. pseudocode given algorithm initialise time ﬁnal time pde/brownian update time-step discretisation grid size auxiliary region spatial step initialise particles required. calculate time next brownian update step auxiliary regions species using formulae consequently calculate corresponding propensity functions equations sums according equations calculate using equation ﬁnally compute according equation implement reactions using appropriate method note production reactions implemented degradation reactions order prevent particles created destroyed time-step. within section present four test problems used demonstrate correctly simulates reaction-diﬀusion systems. problems models pure diﬀusion diﬀerent initial conditions demonstrate ﬂuxes interface consistent expected behaviour fully brownian simulations. third problem formation morphogen gradient demonstrates successful implementation reactions arm. despite fact method valid higher-order reactions ﬁrst three test problems consider reactions ﬁrst order. systems moment closure assumptions required deriving mean-ﬁeld reactiondiﬀusion hence behaviour agrees mean behaviour individual-based models. allows eﬃciently verify accuracy comparing mean behaviour hybrid method known mean-ﬁeld behaviour. finally test problem four implement second-order reaction system higher dimensions indicating applicability method complicated examples. ﬁrst three test problems meaning interface single point take value ﬁxed brownian update steps auxiliary regions width diﬀusion constant quantify qualitative comparisons presented density comparison snapshots section simulations comprise single species henceforth subsuper-scripts pertaining species removed. ﬁrst test problem simulate pure diﬀusion form simple brownian motion reﬂecting boundary conditions fokker-planck equation given diﬀusion corresponding boundary conditions denotes initial condition. note represents mean-ﬁeld solution across whole domain whereas represents solution hybrid method. initialise particles uniformly across computational domain number particles system. figure shows passes basic test maintaining figure evolution test problem times green line part hybrid method yellow bars represent brownian dynamics hybrid method line interface black dashed line solution mean-ﬁeld model given initial condition. results shown contain particles averaged repeats. solve θ-method value parameters given within text. steady state without causing accumulation mass either side interface. test problem also include plot displays variance density particles order calculate variance binned spatial domain onto mesh size calculated variance density number identically initialised repeats. demonstrates problem occurs hybrid methods contain interface coupling stochastic deterministic region. variance damped close interface stochastic part domain deterministic nature solver opposite side. speciﬁcally eﬀectively stochastic boundary condition interface caused diﬀusive jumps auxiliary regions. causes higher level variance would expected purely deterministic regime. however particle jumps brownian dynamics auxiliary region since region mostly deterministic contributes less variance would expected stochastic method employed across entire domain. methods used order problem overlap region replacing appropriate spde explored detail discussion second test problem stress test interfacial ﬂux. part hybrid method solve diﬀusion equation section however time initialise placing particles uniformly within domain results figure plot variance density particles time parameter values used produce figure spatial domain partitioned series bins width particle density variance calculated repeats. blue line variance hybrid method black dashed line expected variance fully brownian model line position interface. variance seen damped stochastic domain close interface discussed text. results simulation displayed figure uniform initial condition test problem figure hybrid method agrees solution mean-ﬁeld model indicating method simulates interface accurately. also tested hybrid method mass initialised uniformly across found similarly good agreement hybrid method mean-ﬁeld solution third test problem investigate formation morphogen gradient uniform initial condition. gradient formed allowing particles diﬀuse throughout domain well degrade rate also particles entering left-hand boundary rate zero-ﬂux condition thus half hybrid domain governed mean-ﬁeld model representing expected behaviour fully brownian dynamics corresponding microscopic dynamics implement brownian motion diﬀusion particles time-based method order enact degradation reactions. note production particles implemented within microscopic domain since occurs particles initialised uniformly across domain. figure evolution test problem times value diﬀusion coeﬃcient production rate degradation rate time-step ﬁgure descriptions parameter values figure takes place three-dimensional cuboid volume split domain ﬁrstly deﬁning position adaptive planar interface implemented test problem analogous one-dimensional case deﬁne time-dependent individual-based subdomains volumes respectively. subdomains volumes depend adaptive interface position. interface move according local density proﬁle within brownian dynamics auxiliary regions explicitly deﬁned ﬁrstly dimension form deterministic part domain. considering reaction system forming simulate system three dimensions. include isotropic diﬀusion obtain three-dimensional ﬁnally impose constraint initial condition simplify one-dimensional pde. brieﬂy describe process evolve individual-level behaviour introducing adaptive interface. ﬁnish subsection results simulations system. note drop dependence subdomains volumes interface position brevity unless explicitly needed. currently exact depends second moment furthermore every moment depends higher moments still system closed. order close system follow erban chapman apply poisson moment closure implies enforce initial condition translationally invariant co-ordinates means dynamics remain translationally invariant time. such simply function dynamics represented one-dimensional equivalent implementing zero-ﬂux boundaries boundaries using transformation turn attention individual-based system. order simulate three-dimensional individual-based model follow method context system whenever particles within reaction radius react probability function kinetic rate time-step diﬀusion coeﬃcient information chosen refer reader erban chapman zeroth-order reaction completed initialising particle uniformly throughout individual-based domain probability κ∆tvb ensure choosing suﬃciently small. test problems simulated using static interface. however requires priori knowledge interface time. ﬁner scale modelling regime required order resolve speciﬁc area space detail interface position known. however purpose interface split regions space high particle numbers diﬀerent approach required. case interface need move density particles maintain computational savings designed provide. describe method adapted robinson allows interface move adaptively. interface time shall denote moves according local particle numbers auxiliary regions around thresholds move interface towards subdomain towards individual-based subdomain threshold values designed prevent interface rapidly oscillating values possibility stochastic nature system. enforce interface moves moves distance width auxiliary region chosen direction. interface moves towards subdomain convert auxiliary region particles initialising uniformly. necessarily integer treat fractional part probability initialising extra particle within newly formed individual-based region. scale rest subdomain ensure conserve mass. interface movement towards individual-based subdomain brownian auxiliary region converted mass initialising density nba/ha uniformly across mesh points created moving interface. detailed description similar method direct interested reader robinson consider particles initialised throughout constant negative gradient density particles position equal zero. ensures interface move dynamics progress. results seen figure hybrid method averaged repeats. hybrid density case moving interface represented yellow bars throughout domain. interface position changes repeat regions space solely represented modelling paradigm repeats. good agreement hybrid method fully individual-based method throughout domain discrepancy close left hand boundary caused difference individual-based methods moment closure. compare hybrid method fully individual-based method here contrast solution used test problems inaccuracy introduced moment closure required second order reaction. figure evolution test problem times yellow bars represent hybrid solution binned onto mesh width black outline bars fully individual-based solution binned onto mesh hybrid solution. vertical line average position interface repeats. parameters table seen section solutions provided hybrid method visually match mean-ﬁeld solution. within section quantify diﬀerence solutions test problems. compare mass brownian regions domain methods. separately compare density proﬁle across whole domain using histogram distance error proceed investigate dependence accuracy hybrid method free simulation parameters order evaluate accuracy test problems compare mean behaviour mean-ﬁeld model compute analytical solution across entire domain test problems. figure contains nine plots demonstrate error ﬁrst three test problems above; test problem test problem test problem ﬁrst second columns show particle number comparisons hybrid analytical solutions. speciﬁcally ﬁrst column compare expected number particles hybrid method. here before represents mean-ﬁeld solution position time represents part solution hybrid method repeat explicitly plot /nmp shows bias around zero three test problems. completeness second column also compare expected number particles hybrid methods. here number particles brownian region hybrid method time repeat explicitly plot /nmb shows bias around zero three test problems. cases relative errors mean-ﬁeld hybrid methods figure discernible bias zero. similarly plots figure majority simulations. demonstrates numerically hybrid scheme presented paper correctly figure error plots test problems ﬁrst column contains relative errors /nmp second column contains relative errors /nmb third column contains comparison using equation fourth test problem diﬀerent error measurement disparity mean-ﬁeld individual-based systems. consequently choose compare number particles ﬁnal compartment hybrid method individual-based method. motivate ways. firstly using measure error able minimise inﬂuence extra error caused diﬀerence mean-ﬁeld individual-based method. secondly several biological systems require detailed knowledge particle concentrations domain. apical growth ﬁlamentous cells fungi example. deﬁne average number particles region relative error shows long-term bias either direction oscillates around zero indicating close agreement hybrid method ground truth individual-based method. hybrid method completed repeats seconds fully individual-based method took seconds. within free parameters need chosen width auxiliary regions time-step brownian updates need chosen quantity d∆t/h remains small enough particle numbers auxiliary regions become overly equilibrated pde/brownian update steps. gradient across interface small enough closed system auxiliary regions reach steady state pde/brownian update steps. number particles auxiliary regions combined mean number particles brownian auxiliary regions respectively time number brownian auxiliary regions respectively time represent beginning time-step. then equation mean number particles auxiliary region calculated simple probability master equation require change number particles small time-step small would like thus need choose parameters quantity d∆t/h small. elucidates important relationships ﬁxed free parameters model. diﬀusion coeﬃcient large must choose small update time-step larger auxiliary region length compensate. figure shows large region space histogram distance error meaning method robust parameter change breaks value d∆t/h becomes large. plot also shows that given choice width auxiliary regions value time-step give level error. also depending choice adjust make simulation accurate. presented spatially coupled hybrid method coupling brownian dynamics representation reaction-diﬀusion system corresponding mean-ﬁeld description. bridging spatial scales intermediate auxiliary regions produced algorithm accurate also robust choice free parameters within problem namely width auxiliary regions ﬁxed time-step used update brownian dynamics. direct contrast previously presented pde-to-brownian hybrid demonstrated extremely parameter-sensitive. order make even robust applicable eﬃcient discuss several areas possible extension addressed future works. figure contour plot time series simulations initialised particles uniformly distributed within region domain. dark colours indicate error. line representative contour d∆t/h averaged repeats. suﬃcient step function corresponding mass particle removed uniformly across auxiliary region. lead diﬃculties situations particle numbers around interface. arguably though employ hybrid methods situations particle density around interface poor model true stochastic microscopic dynamics regions. possible solution inconvenience incorporation adaptive interface employed test problem interfaces evolve simulation dynamics ensuring appropriate model used corresponding particle density related issue multiple interfaces. multiple interfaces allow eﬃcient simulation stochastic reaction diﬀusion systems multiple regions high concentration expected. patterns require interfaces dynamic number transient nature. although implemented interfaces work expect relatively straightforward extension. presented example system simulated cuboid planar interface non-planar interfaces corners curved complex domain geometries present deeper challenges hope address future publication. failing maintain stochastic variation problem common amongst many spatially coupled hybrid methods. result deterministic nature noise brownian dynamics region domain damped comparison fully microscopic model literature approaches used order rectify this. ﬁrst overlap region employed several papers methods introduce region space lies intersection domains. regions mass simultaneously represented using scales description. second replace deterministic appropriately chosen stochastic partial diﬀerential equation alexander consider coupling demonstrate indeed discrepancy using spde continuum macro-scale model. address spdes overlap regions fisher waves oscillatory dynamics excitatory dynamics applications embryogenesis intracellular dynamics pattern formation amongst others. also worthwhile interface methods presented commonly used brownian dynamics simulation software packages smoldyn cameron smith supported scholarship epsrc centre doctoral training statistical applied mathematics bath project ep/l/. christian yates would like thank cmb/cncb preprint club constructive helpful comments preprint paper. within section apply parameter values used section order demonstrate accurately simulate problem assisted brownian dynamics could recall interface placed additional parameter deﬁned auxiliary region width results seen figure seen ﬁgure agreement mean-ﬁeld hybrid solutions much closer assisted brownian dynamics indicates improvement previous method. also present error plots described section namely relative errors particle numbers histogram distance errors. figure error plots example figure ﬁrst panels show relative errors particle numbers brownian dynamics subdomains. histogram distance error displayed", "year": "2017"}