{"title": "A generalised framework for detailed classification of swimming paths  inside the Morris Water Maze", "tag": "q-bio", "abstract": " The Morris Water Maze is commonly used in behavioural neuroscience for the study of spatial learning with rodents. Over the years, various methods of analysing rodent data collected in this task have been proposed. These methods span from classical performance measurements (e.g. escape latency, rodent speed, quadrant preference) to more sophisticated methods of categorisation which classify the animal swimming path into behavioural classes known as strategies. Classification techniques provide additional insight in relation to the actual animal behaviours but still only a limited amount of studies utilise them mainly because they highly depend on machine learning knowledge. We have previously demonstrated that the animals implement various strategies and by classifying whole trajectories can lead to the loss of important information. In this work, we developed a generalised and robust classification methodology which implements majority voting to boost the classification performance and successfully nullify the need of manual tuning. Based on this framework, we built a complete software, capable of performing the full analysis described in this paper. The software provides an easy to use graphical user interface (GUI) through which users can enter their trajectory data, segment and label them and finally generate reports and figures of the results. ", "text": "morris water maze commonly used behavioural neuroscience study spatial learning rodents. years various methods analysing rodent data collected task proposed. methods span classical performance measurements sophisticated methods categorisation classify animal swimming path behavioural classes known exploration strategies. classiﬁcation techniques provide additional insight diﬀerent types animal behaviours still limited amount studies utilise mainly highly depend machine learning knowledge. previously demonstrated animals implement various strategies classifying whole trajectories lead loss important information. work developed generalised robust classiﬁcation methodology implements majority voting boost classiﬁcation performance successfully nullify need manual tuning. based framework built complete software capable performing full analysis described paper. software provides easy graphical user interface users enter trajectory data segment label ﬁnally generate reports ﬁgures results. morris water maze designed richard morris ﬁrst described back study regarding spatial localisation rats quickly became popular eighties large number published work using reported instance review work d’hooge deyn mentions publications related task within decade recently virtual forms used directly human subjects generalisation made possible comparatively assess human rodent place navigation compare spatial learning sexes directly study certain factors aﬀect spatial navigation certain areas brain perform eﬀects typical experiment rodent placed inside circular pool ﬁlled water tasked hidden platform placed four quadrants pool. since animal unable platform rely external visual cues order navigate inside pool platform. number trials expected animal learned location platform therefore able less time beginning trials studies using experiment utilise several measurements performance order assess learning memory. many measurements also used ensure animal groups equal skills abilities notable measurements include time animal spends inside quadrant pool latency ﬁnding platform trial directionality total swimming distance trial also number sophisticated measurements body temperature animals throughout experiment cumulative distance platform distance animal location platform location calculated number times speciﬁc sampling rate simplistic measurements statistics criticised insuﬃcient capture diﬀerent animal behaviours present experiments reason researchers started study various behaviours animals expressing inside pool known exploration strategies. notable studies wolfer computed large amount measures animal swimming path inside maze order categorise various animal strategies studies include automatic classiﬁcation procedures graziano garthe speciﬁed regions interest inside arena categorisation method graziano based number path measures work garthe hierarchical classiﬁcation algorithm used categorisation swimming path mainly based amount time animal spent region. latter method also used recent studies point criticism aforementioned studies classiﬁcation procedure requires prior knowledge animal behaviour strategies manual classiﬁcation trajectory subject bias thus study illouz attempted minimise human error create unbiased analysis automatic classiﬁcation procedure based support vector machines work extracted features coordinates animal trajectories using database labelled data able automatically classify large amount full animal trajectories performing series hierarchical decisions. previous work argued animals employ several strategies trial order platform assigning whole animal trajectories single behavioural classes results loss important information. reason proposed sophisticated automatic quantiﬁcation methodology capable classifying presenting various animal behaviours much detail trial. according approach animal swimming path ﬁrst split segments segments classiﬁed behavioural strategies. changes animal behaviour within trial detected animal swimming path whole falls strategies revealing animal behaviour involved within trial. classiﬁcation segments used semi-supervised classiﬁcation procedure requires manual classiﬁcation small amount data. advantage procedure classiﬁcation based clustering algorithm able detect patterns data. therefore behavioural classes didn’t necessarily deﬁned priori. hand method developed previous study required certain degree knowledge machine learning methods prevented direct application methodology datasets. work present automatic boosted classiﬁcation procedure based majority voting improves classiﬁcation error validation framework leads conclusions high degree conﬁdence. finally software tools implemented previous work re-engineered order produce fully working software capable performing analyses without requiring machine learning knowledge user. software called roda focused experiment. provides easy graphical user interface loading data deﬁning experimental speciﬁcations. also supports automatic segmentation semi-automatic classiﬁcation produces quality ﬁgures exported various image formats. software available github repository https//github.com/rodentdataanalytics/mwm-ml-gen general public license version proposed analysis method swimming paths animals inside morris water maze divided segments approximately equal length certain overlap percentage. segment eight features computed. features used classiﬁcation procedure. finally small portion segments needs also assigned manually speciﬁc strategy information used prior knowledge guide classiﬁcation procedure. classiﬁcation procedure assigns segments classes behaviour based semi-supervised clustering algorithm called metric pairwise constrained k-means algorithm incorporates main approaches semi-supervised clustering metric learning constrained-based learning turn algorithm classiﬁer labelled data used guide clustering process also assign clusters classes however common issue many clustering algorithms including mpckmeans predeﬁned number target clusters needs provided; number indicates amount clusters data partitioned. determining optimal number target clusters challenging although many diﬀerent quality measures proposed time value depend speciﬁc clustering method data hand. work instead searching optimal number clusters attempting generate optimal classiﬁer select generate pool ‘strong’ classiﬁers whose ‘goodness’ assessed based -fold cross validation error. strong classiﬁers generated used form ‘ensemble’ uses majority voting reach classiﬁcation decision. conditions strong diverse classiﬁers essential majority voting order reach optimal classiﬁcation solution discussed detail later. order assess labelling procedure criterion minimum strong classiﬁers added prior majority voting. finally classiﬁcation result ensemble expected percentage unclassiﬁed segments because since classiﬁers diverse diﬀerent errors fail classify diﬀerent segments. thus work together form ensemble individual errors compensated correct responses members ensemble diagram procedure illustrated ﬁgure assign trajectory multiple classes earlier proposed division full animal swimming paths segments method segment overlaps signiﬁcantly previous make sure important information lost unfavourable segmentation. segment length empirically selected equal slightly longer arena diameter. segment length short might diﬃcult identify class segments belong; it’s long might happen class behaviour represented. latter case seen results large segment length causes classes overshadowed common classes figure workﬂow diagram illustrating analysis procedure. cyan boxes indicate automatic process; orange boxes indicate objects importance results; partial labelling implies extensive user interaction process; grey boxes group processes taking part classiﬁcation procedure. trajectories segmentation eight trajectories features segment computed certain number segments manually labelled. afterwards pool classiﬁers generated. ‘strong’ classiﬁers selected pool work together team produce classiﬁcation results. throughout process labelling quality constantly assessed case weak classiﬁcation results back labelling stage. labelled roughly total segment number exact value depends greatly dataset investigation. rule thumb fewer labels provided classiﬁcation results poor sense segments remain unclassiﬁed fall wrong class. since labelling procedure prone error subjectivity number validation criteria implemented throughout analysis classiﬁcation boosting ensemble technique based idea many weak learners converted strong learner machine learning terms ensemble weak classiﬁers used form strong classiﬁer combining individual’s opinion approach used various classiﬁcation tasks survey) addressing complex real-world problems single algorithmic classiﬁcation solutions unable achieve high performances perform classiﬁcation boosting majority voting many classiﬁers form ensemble vote class datapoint class votes wins. output ensemble expected improved accuracy since individual errors classiﬁer compensated correct responses members ensemble however order achieve outcome classiﬁers need diverse fact according diversity enough ensure randomly selected classiﬁers achieve high classiﬁcation accuracy scenario classiﬁers arbitrary week. classiﬁers also strong meaning suﬃciently accurate indicate accuracy least framework need classify diﬀerent trajectory segments animal behavioural classes partial labelled data. classiﬁcation parametrized target number clusters clustering algorithm value diﬃcult estimate priori. order overcome problem therefore generate number classiﬁers providing diﬀerent numbers target clusters succession; process pool classiﬁers generated. -fold cross validation process evaluate diﬀerent number target clusters classiﬁers validation error lower used form ensemble minimum amount required classiﬁers fulﬁll criteria reasoning behind process require suﬃcient number ‘strong’ classiﬁers. majority voting consider simple scheme vote classiﬁer weight case draw datapoint marked unclassiﬁed. figure validation stage. cyan boxes indicate automatic process; orange boxes indicate objects importance results; grey boxes indicate classiﬁcation procedure. diﬀerent segmentation conﬁgurations tested order prove conclusions consistent deﬁne bounds segment length analysis conclusions. refer table properties conﬁguration. non-parametric friedman test used analysis variance strategy animal groups. test selected data normally distributed ability control variability among subjects diﬀerent observations analysis null hypothesis diﬀerence animal groups strategies well number times animals change behaviour within single trials small p-values generated friedman test lead discard null hypothesis results identical diﬀerences chance addition friedman test conﬁdence intervals binomial distribution used signiﬁcance speciﬁc classiﬁcation judged classiﬁers form ensemble viewed random process generating zero detail conﬁdence intervals indicate conﬁdence classiﬁers forming ensemble average pointing conclusion ensemble given friedman test outcomes hypothesise outcomes result binomial distribution. require conﬁdence intervals clearly order conﬁdent result chance evaluate diversity classiﬁers assess percentage agreement class segment. result symmetric matrix rows columns representing classiﬁers element shows percentage segments classiﬁers agree assigned class. diagonal values matrix equal classiﬁer agreement overall agreement computed averaging upper lower triangular matrix. addition consider average cross validation error classiﬁers. order classiﬁers diverse strong expected average percentage agreement well cross validation error previously reported ensembles less variance comparison classiﬁers thus expected much higher agreement. demonstrate observation generated number ensembles picking classiﬁers random pool. afterwards performed statistical measurement agreement ensembles similar described classiﬁers. contrast classiﬁers ensembles high agreements among nearly nullify cross validation error classiﬁers however since method cross validation used tuning testing additionally manually assess error ensembles four segmentations useful measure quality classiﬁcation percentage unclassiﬁed segments. certain segments expected none classiﬁers ensamble able determine class could draw segments transit classes this however impact results consistency ﬁrst approach considered classiﬁed segments continuous parts trajectories ignoring overlap percentage. method provides consistent results signiﬁcant diﬀerences strategies fails detect diﬀerences strategies transition groups reason sparse segments within swimming path fall diﬀerent classes thus viewing sequence leads overestimation transitions address limitation smoothing technique parameters independent segmentation choices. done following reason avoid subjective conclusions based speciﬁc segmentation conﬁguration able directly compare diﬀerent segmentations. detail given equals radius arena swimming paths divided intervals length intervals assigned certain class based weighed voting overlapping segments. mathematical expression operation shown equation cutoﬀ segments away centre interval. parameter controls weight vote segment based distance interval analysis equal order achieve proportionality arena dimensions finally class weight deﬁned percentage segments belonging class intuition setting class weights inversely proportional amount segments fall class prevent rare classes overshadowed common ones. prevent small large class weights bounds means less segments fall certain category class receive weight equal respectively. roda software implements framework consists series graphical user interfaces oﬀer straightforward analysis trajectory data extracted noldus ethovision system every stage process tuned meet user’s need. generated ﬁgures exported variety diﬀerent image formats numerical data depicted ﬁgures also saved comma separated values format case user wishes generate ﬁgures using diﬀerent software figure screenshots software. window numbered denote separate stage workﬂow consists data input used load trajectory data extracted ethovision select speciﬁc tracks used analysis; segmentation panel oﬀers fully control segmentation options; labelling oﬀers visualisation whole trajectories segments allowing easy labelling segments; classiﬁcation contains options tune various parts classiﬁcation process; results panel; generates analysis results. results generated graphical well text format. user also control output format image ﬁles well elements generated ﬁgures text size line width etc. arrow connecting indicates analysis results consistent need back labelling stage provide better labels. data collected experiments performed laboratory behavioural genetics epfl lausanne switzerland. procedures conducted conformity swiss national institutional guidelines animal experimentation approved license swiss cantonal veterinary oﬃce committee animal experimentation. water maze diameter submerged platform diameter recordings animals trajectories performed using tracking software noldues ethovision version dataset contains rats inducted stress peripubertal control group. total trials performed animal divided consecutive days trials day. timeout trial seconds animal failed platform within time limit guided inter-trial interval trials minutes. starting position animals altered trials. choice classes behaviours analysis motivated previous studies observed reported stereotypical animal behaviours inside thigmotaxis. animal moves exclusively periphery arena time touches walls arena. incursion. animal starts distant arena periphery visible inward movements. scanning. behaviour associated random searches focused centre pool. another characteristic behaviour animal rapidly turns away arena walls touches focused search. behaviour also associated random searches animal actively searches particular small region arena. chaining response. behaviour ﬁrst observed study wolfer animal appears memorised distance platform arena wall swims circularly order self orienting. animal performs loop orients inside arena scanning surroundings. animal crosses region close platform arena moves away scanning target. animal actively searches arena swapping paths around direct finding. animal navigates straight platform. response self orienting scanning surroundings target scanning direct finding addition analysed number times animals change behaviour within single trials methodology ﬁnds quantitative behavioural diﬀerences comparison standard metrics full swimming paths animals. able detect additional signiﬁcant diﬀerences strategies employed animal groups comparison categorisation whole animals trajectories. detail report animal groups diﬀer strategies thigmotaxis incursion chaining response strategies transitions favour stress group meaning stressed animals implement strategies transit diﬀerent strategies often control animals commonly used measurements learning suggest signiﬁcant diﬀerence among animal groups sense stress animals faster swap longer paths within trials still fail platform less time control animals analysis suggests reason phenomenon stressed animals tend level strategies lower chances ﬁnding platform since spent time close arena periphery. high level cognitive strategies scanning target show signiﬁcant diﬀerence groups except chaining response strategy. latter implies stress animals haven’t memorised exactly location platform distance wall; swim distance hope chance. stressed animals also change strategy often non-stressed animals. results relevant studies suggests high levels stress lead weak attention frequent behavioural switches. categorisation full animal swimming paths failed detect distinctive strategies chaining response; manages capture diﬀerences thigmotaxis strategy figure full swimming path standard metrics stress control animal groups. animals tested trials divided sessions bars represent ﬁrst third quartiles data; grey line splits bars represents median crosses outliers whiskers indicate minimum maximum values. friedman test p-value trials shown right plot. stress animals platform fast control group couldn’t identiﬁed. signiﬁcant diﬀerence detected thigmotaxis strategy. white bars control group; black bars stress group. groups compared complete trials using friedman test figure percentage segments falling strategy stress control animal groups trial. animals tested trials divided sessions segment considered length equal length arena radius transitions bars represent ﬁrst third quartiles data; black white horizontal lines median crosses outliers whiskers indicate minimum maximum values. results generated using segmentation length overlap; classiﬁcation ensemble classiﬁers created using classiﬁers validation error less equivalent results three segmentations found appendix section. friedman test p-value used compare animal groups complete trials. according plots thigmotaxis incursion strategies show clear diﬀerence favour stress groups along chaining response. number transitions strategies shows stress animals change behaviour ofter control animals within single trials. four diﬀerent segmentations performed segmentation generate pool classiﬁers consisted classiﬁers cross validation error lower classiﬁers used form ensemble ﬁnal classiﬁcation result computed based majority voting within ensemble three four segmentation conﬁgurations conclusion animal groups signiﬁcant diﬀerence strategies thigmotaxis incursion chaining response strategies transitions favour stress group meaning stress animals implement strategies transit diﬀerent strategies often control animals four segmentations fail capture signiﬁcant diﬀerence chaining response strategy probable reason segment length large thus strategies rare signiﬁcantly smaller overshadowed common ones issue introduced already labelling procedure. segmentation samples single-labelled chaining response segmentations correspondingly. larger segment makes diﬃcult human expert distinguish rare classes adjoint frequent ones. order validate results four segmentations chose form ensembles consisted classiﬁers. also allowed compare agreement among classiﬁers among ensembles classiﬁers used form ensemble picked random time. compared performance classiﬁers ensemble multiple ensembles formed random sample classiﬁers. table shows relevant results last stage analysis smoothing function applied segments mapped full swimming paths; detail important smoothing procedure increases performance classiﬁers expected ensembles higher accuracy lower percentage unclassiﬁed segments higher percentage agreement among comparison classiﬁers. however since method cross validation used tuning testing additionally manually assess error ensembles four segmentations table parameters classiﬁcation four diﬀerent segmentation conﬁgurations variable segment lengths overlaps. segmentation pool classiﬁers generated varied number classiﬁers depending cross-validation error percentage manually labelled segments multiple labels could given segment; study labels given simultaneously segment. figure conclusive results classiﬁcation segmentation plot shows binomial conﬁdence intervals classiﬁers segmentation regarding agreement signiﬁcant diﬀerence animal groups strategy strategy transitions. squares indicate mean classiﬁers; errorbars represent conﬁdence intervals; dashed line indicates threshold interest conﬁdence intervals clearly conﬁrm indeed signiﬁcant diﬀerence animal groups strategies strategy transitions. three cases animal groups show signiﬁcant diﬀerences strategies thigmotaxis incursion chaining response transition strategies. segmentation failed capture signiﬁcant diﬀerence chaining response lengthy segments caused strategy overshadowed strategies disappear table plots shows friedman test p-values classiﬁcation result ensembles. segmentation conﬁgurations arranged columns strategies rows; element relevant p-value grey cells indicate signiﬁcant diﬀerence table classiﬁcation statistics four segmentation conﬁgurations table beneﬁts majority voting. error -fold cross validation used order select ‘strong’ classiﬁers based validation error. -fold cross validation also used compute average accuracy ‘strong’ classiﬁers accuracy ensemble ensemble signiﬁcantly beneﬁts classiﬁcation accuracy. since method cross validation used tuning testing manually assess error ensembles four segmentations percentage unclassiﬁed segments computed separately; since classiﬁers ‘strong’ segments remain unclassiﬁed nevertheless ensemble almost totally nulliﬁes unclassiﬁed segments. average agreement classiﬁers computed ﬁrst calculating percentage agreement within pair averaging agreements together order perform statistical measurement ensemble domain ensembles created picking random sample ‘strong’ classiﬁers pool. agreement classiﬁers better moderate expected agreement ensembles high. table percentage segments falling class four segmentation conﬁgurations table diﬀerences among four segmentations visible although based results ﬁgure consistency conclusions preserved segmentations regarding segmentation indication diﬀerence animal groups regarding chaining response strategy;more segments identiﬁed thigmotaxis scanning surroundings. indicates possibility segments transit chaining response strategies classiﬁed either thigmotaxis scanning surroundings. methodologies classify swimming paths behavioural classes reveal diﬀerent stages learning animal groups. however examples earlier research made machine learning techniques automatically detect animal behaviours. proposed methods diﬃcult generalise require machine learning knowledge. previous study addressed limitations previous techniques focusing fact forcing whole swimming paths single class behaviour suboptimal trajectory incorporates number diﬀerent behaviours. methodology detailed trajectory classiﬁcation reveal additional behavioural diﬀerences groups animals used even small amount trajectory data available since segmentation process overlapping typically creates signiﬁcant amount data. nevertheless previously proposed method segmented trajectories classiﬁcation required decent amount machine learning knowledge used correctly allowed amount subjectivity choosing classiﬁers. work address issues proposing improve robustness technique majority voting. results longer based single classiﬁcation tuning agreement many. technique alleviated subjective assignment swimming path segments classes since practice many classiﬁers seemingly perform equally well validation relatively high disagreement best chose among might unclear. here systematically investigate diﬀerent segmentations identify bounds method produce meaningful results furthermore binomial conﬁdence intervals ensemble classiﬁers informative regarding quality results. methodology leads results diﬀer earlier work detect signiﬁcant diﬀerence scanning strategy. number factors classiﬁer results higher error merging three diﬀerent segmentations resulted classiﬁcations didn’t fully agree other. base conclusions majority voting many classiﬁers shown improved performance versus single classiﬁers therefore lead reliable results. important point mentioned despite fact segmentation ensemble formed extremely zero error largest segmentation failed indicate diﬀerence chaining response strategy. identiﬁed cause issue diﬃculty involved labelling large segments; case chaining response masked dominant classes thigmotaxis. worthy noting smoothing function used segments back whole trajectories aﬀect conclusions formed based strategies. even without smoothing function again three segmentations agree diﬀerences animal groups thigmotaxis incursion chaining response strategies segmentation lengthy segments cannot capture diﬀerence chaining response reason criterion correct classiﬁcation cannot based classiﬁcation error alone. also require consistent results within reasonable variation segmentation length case i.e. radius maze. facilitate methodology scientiﬁc community provide complete software incorporating framework includes graphical user interface guide user throughout analysis stages allows manual conﬁguration procedure. finally noted work present generalise species rodents inside well experiments similar main signiﬁcant changes made strategy deﬁnitions case tasks involving navigation trajectory features. recent work addressed issue pre-deﬁned strategies using fully unsupervised procedure patterns behaviour active allothetic place avoidance task. experiment previous knowledge animal behaviours thus supervised semi-supervised techniques cannot applied. however mentioned classiﬁcation depends trajectory features used. combined work classiﬁcation boosting technique unsupervised methodology engineering trajectory features linked speciﬁc experiment potential lead robust generalised framework trajectory analysis many diﬀerent animal species used experimental procedures zebraﬁsh e.v. acknowledges grant number ec-fp-people namasen marie-curie initial training network. c.s. acknowledges grant number swiss national science foundation project. k.l. acknowledges grant number w/.pr/ polish ministry science education grant number fp-health project t.v.g. e.v. designed initial methodology. t.v.g. developed original software tools. k.s. a.j. k.l. w.k. validated tested analysis software. m.c. contributed software development. c.s. provided experimental data. z.t. tested alternative classiﬁcation methods. authors provided feedback manuscript.", "year": "2017"}