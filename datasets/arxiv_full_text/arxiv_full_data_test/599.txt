{"title": "Tree-based networks: characterisations, metrics, and support trees", "tag": "q-bio", "abstract": " Phylogenetic networks generalise phylogenetic trees and allow for the accurate representation of the evolutionary history of a set of present-day species whose past includes reticulate events such as hybridisation and lateral gene transfer. One way to obtain such a network is by starting with a (rooted) phylogenetic tree $T$, called a base tree, and adding arcs between arcs of $T$. The class of phylogenetic networks that can be obtained in this way is called tree-based networks and includes the prominent classes of tree-child and reticulation-visible networks. Initially defined for binary phylogenetic networks, tree-based networks naturally extend to arbitrary phylogenetic networks. In this paper, we generalise recent tree-based characterisations and associated proximity measures for binary phylogenetic networks to arbitrary phylogenetic networks. These characterisations are in terms of matchings in bipartite graphs, path partitions, and antichains. Some of the generalisations are straightforward to establish using the original approach, while others require a very different approach. Furthermore, for an arbitrary tree-based network $N$, we characterise the support trees of $N$, that is, the tree-based embeddings of $N$. We use this characterisation to give an explicit formula for the number of support trees of $N$ when $N$ is binary. This formula is written in terms of the components of a bipartite graph. ", "text": "abstract phylogenetic networks generalise phylogenetic trees allow accurate representation evolutionary history present-day species whose past includes reticulate events hybridisation lateral gene transfer. obtain network starting phylogenetic tree called base tree adding arcs arcs class phylogenetic networks obtained called tree-based networks includes prominent classes tree-child reticulation-visible networks. initially deﬁned binary phylogenetic networks tree-based networks naturally extend arbitrary phylogenetic networks. paper generalise recent tree-based characterisations associated proximity measures binary phylogenetic networks arbitrary phylogenetic networks. characterisations terms matchings bipartite graphs path partitions antichains. generalisations straightforward establish using original approach others require different approach. furthermore arbitrary tree-based network characterise support trees tree-based embeddings characterisation give explicit formula number support trees binary. formula written terms components bipartite graph. classically evolution species assumed branching process represented phylogenetic tree. however reticulate evolutionary processes hybridisation endosymbiosis horizontal gene transfer represented appropriately using phylogenetic networks represent reticulate processes take rooted binary phylogenetic tree called base tree sequentially arcs subdividing branches course phylogenetic networks obtained however phylogenetic networks arise form rich class networks called tree-based networks include well-studied classes tree-child tree-sibling reticulation-visible networks. biological emphasis distinction determine whether evolution groups mainly tree-like reticulations branches whether reticulation entangled tree-like description reasonable well viewpoints emphasised paper tree-based networks studied variety ways. example anaya francis hayamizu semple zhang binary tree-based networks mathematically characterised number different ways. characterisations terms bipartite matchings others based antichains path partitions characterisations allowed development computationally efﬁcient indices measure ‘close’ arbitrary binary phylogenetic network tree-based applied phylogenetics binary phylogenetic trees networks often overly restrictive reason vertices out-degree greater used represent uncertainty precise order speciation events indicate rapid species radiation might occur arrival species island leading near-simultaneous evolution several species also reticulation events best represented vertices parents simultaneously summary divergence reticulation events result phylogenetic networks vertices either in-degree out-degree greater nonbinary phylogenetic networks. notion tree-based extended binary non-binary networks jetten iersel allowing addition arcs branches vertices base tree jetten iersel also deﬁned investigated restrictive class phylogenetic networks referred ‘strictly tree-based’ allow addition arcs branches ﬁrst part paper generalise tree-based characterisations binary phylogenetic networks derived deviation indices given francis arbitrary phylogenetic networks. tree-based network support tree embedding base tree second part paper consider problem counting number support trees introduce bipartite graph associated characterises support trees characterisation used determine number binary. moreover show determined number equates upper bound number base trees binary tree-based network established jetten counting number support trees non-binary setting left future work. throughout paper denotes non-empty ﬁnite set. given taxa phylogenetic network rooted acyclic digraph parallel arcs satisfying following properties additionally allow consist single vertex vertices called leaves vertices in-degree out-degree least tree vertices vertices in-degree least out-degree reticulations. furthermore vertex omnian non-leaf vertex whose children reticulations. ending reticulation reticulation arc; arcs tree arcs. binary phylogenetic network tree vertex out-degree reticulation in-degree two. phylogenetic x-tree phylogenetic network contains reticulations. thus binary phylogenetic x-tree phylogenetic x-tree root out-degree either non-leaf vertices in-degree out-degree two. arbitrary directed graph subdividing operation replacing arcs vertex. subdivision directed graph obtained sequence subdivisions. conversely suppressing vertex in-degree out-degree operation replacing arcs incident single ﬁnally delete vertex phylogenetic x-tree. following francis steel jetten iersel phylogenetic network tree-based base tree obtained following way. first vertices called attachment points taking subdivision arcs either attachment points non-leaf vertex attachment point. additional arcs referred linking arcs. subdivision called support tree note vertices support tree also vertices also observe even binary construction lead tree-based network reticulations parents tree vertices children. illustrate fig. shows three phylogenetic networks. ﬁrst networks tree-based third network tree-based. given phylogenetic networks binary reﬁnement obtained sequence contractions. next lemma describes alternative equivalent ways viewing notion ‘tree-based’. equivalence noted jetten iersel equivalence immediate deﬁnition. although lemma says least binary reﬁnement tree-based network tree-based possible binary reﬁnement tree-based. example illustrate provided tree-based network fig. binary reﬁnement tree-based another not. tree-based networks characterised variety ways particularly binary setting. describe characterisations terms matchings bipartite graphs. ﬁrst zhang restricted binary setting. recall omnian non-leaf vertex whose children reticulations. arbitrary phylogenetic network denote omnians denote reticulations note sets necessarily disjoint omnian also reticulation. bipartite graph vertex bipartition {or} theorem extend directly arbitrary phylogenetic networks consider phylogenetic networks shown fig. fig. phylogenetic network shown fig. tree-based network. however reticulate vertices tree-vertex parent namely matching covers reticulation. moreover theorem phylogenetic network shown fig. tree-based exist matching covers however shown fig. matching reticulation matched maximal path starts ends reticulations. subsection show many characterisations binary tree-based networks francis extended arbitrary tree-based networks. characterisations terms antichains path partitions well matchings bipartite graphs. several characterisations strengthen so-called antichain-to-leaf property necessary sufﬁcient condition phylogenetic network tree-based antichain directed graph subset vertices property that distinct directed path phylogenetic network satisﬁes antichainto-leaf property every antichain vertices exists vertex-disjoint paths elements antichain leaves binary phylogenetic network shown fig. francis satisﬁes antichain-to-leaf property tree-based. formally state characterisations directed graph. denote bipartite graph whose vertex bipartition {vv} copy whose next theorem extends characterisations binary tree-based networks theorem francis arbitrary tree-based networks. proof consists straightforward modiﬁcations proof theorem francis appendix. noted above general setting graph longer provides direct characterisation tree-based networks terms matchings. antichain-to-leaf property sufﬁcient characterise tree-based networks. however theorem francis shows property sufﬁcient characterised binary temporal tree-based networks. section generalise result arbitrary temporal tree-based networks. proof generalisation uses different approach taken establishing theorem francis latter relies equivalence theorem which discussed section generalise arbitrary tree-based networks. phylogenetic network temporal exists called temporal tree reticulation arc. words temporal ‘time stamp’ assigned vertex time increases along tree arcs remains constant along reticulation arcs. establish converse statement temporal network satisﬁes antichain-to-leaf property tree-based. induction number vertices consists single vertex tree-based. assume every temporal network vertices satisfying antichain-to-leaf property tree-based. temporal mapping denote root ={uu denote children follows tree vertex. therefore reticulation least parent particular also reticulation. follows parent reticulation. since acyclic process eventually terminate. happen reticulation whose parent contradiction. thus element tree vertex. particular follows every subset antichain. contains leaf denote phylogenetic network obtained deleting incident arc. then temporal antichain-toleaf property immediately follows temporal antichain-to-leaf property. therefore induction assumption tree-based vertices. turn implies tree-based. thus assume every vertex tree vertex. without loss generality assume −{ρuu rooted acyclic digraph obtained ﬁrst contracting arcs repeatedly deleting non-trivial parallel class suppressing resulting non-root degree-two vertex. next show temporal network satisfying antichain-to-leaf property. begin determining arcs deleted obtaining first observe deleted process obtaining reticulation arc. moreover temporal mapping vertices assigned value reticulation reticulation parents satisfy antichain-to-leaf property parent reticulation remaining parents implies unique ancestor possibly itself reticulation every parent easily seen that choosing arcs delete non-trivial parallel class possible arcs deleted obtaining arcs form reticulation particular reticulation parent arcs form deleted reticulation parent parents arcs except deleted. denote rooted acyclic digraph obtained deleting arcs determined last paragraph. note obtained contracting suppressing non-root degree-two vertices. viewpoint easily seen indeed phylogenetic network. furthermore mapping vertices inherited temporal mapping vertices temporal. lastly satisﬁes antichain-to-leaf property observe subset vertices antichain antichain therefore considering satisﬁes antichain-to-leaf property satisﬁes antichain-to-leaf property. hence induction tree-based least less vertex base tree complete proof extending base tree support tree note seen embedding view arcs arcs obvious root corresponding unique directed denote arcs denote subset whose children reticulations subset omnians then vertices incident edge vertices non-root degree-two vertices suppressed constructing possibly root reticulations whose parents entirely vertex child ∪{o} antichain. however every child reticulation ancestor follows ∪{o} satisfy antichain-to-leaf property. thus vertex least child extend arcs support tree since antichain disjoint paths that path starting ending tree vertex intermediate vertex reticulation. assume second vertex paths vertex suppose assumption possible. then hall’s theorem subsets follows that reticulation unique ancestor union antichain satisfy antichain-to-leaf property; contradiction. hand extend taking union following sets arcs remark nonbinary temporal network need binary temporal reﬁnement. example nonbinary tree-based network shown fig. temporal none three binary reﬁnements temporal. means cannot establish non-trivial direction theorem simply applying corresponding result binary networks francis nonbinary setting notion tree-based all-or-nothing approach formalising extent phylogenetic network underlying phylogenetic tree. certain nontreebased phylogenetic networks nevertheless ‘close’ tree-based. example adjoin single leaf phylogenetic network shown fig. subdividing vertex adding construct tree-based network motivated examples francis considered three efﬁciently computable indices measuring closeness binary phylogenetic network tree-based. section interpret indices arbitrary phylogenetic networks. phylogenetic network operation adjoining leaf subdividing vertex adding called attaching leaf note tree vertex resulting phylogenetic network. three indices follows measures well-deﬁned non-negative equal zero tree-based. relies lemma consider equivalence theorem well deﬁned proceed attaching leaf reticulation particular means resulting phylogenetic network omnians therefore bipartite graph empty edges case tree-based applying theorem note that since implies theorem enough attach leaf reticulation maximal path starts ends vertex instead making attachment every reticulation ‘break’ unwanted paths produce tree-based network. surprisingly three indices identical binary phylogenetic networks turns arbitrary phylogenetic networks. moreover francis measures computable polynomial-time size written terms size maximum matching bipartite graph proof next theorem essentially analogous result francis omitted. phylogenetic network following theorem expresses three measures terms maximum-sized matchings thus providing alternative viewpoint. theorem phylogenetic network {or} vertex bipartition sets omnians reticulations proof maximum-sized matching denote subset vertices unmatched theorem sufﬁces show |ou|. ﬁrst establish |ou|. proof induction size |ou|. |ou| then theorem tree-based inequality holds. assume |ou| inequality holds phylogenetic networks property that relation maximum-sized matching number unmatched vertices omnians |ou|− child note phylogenetic network obtained attaching leaf denote parent since neither omnians bipartite graph obtained deleting incident arcs. since unmatched follows matching moreover maximum-sized matching maximum-sized matching number unmatched omnians |ou|− induction assumption |ou|− particular |ou|. next establish inequality |ou|. proof induction tree-based theorem |ou| particular inequality holds. suppose inequality holds phylogenetic networks since adjoin leaf subdividing vertex obtain phylogenetic network note attachment preserves reticulations reduce number omnians one. maximum-sized matching subset unmatched vertices induction assumption easily checked obtained follows. omnian identical. otherwise vertex arcs children obtain consider maximumsized matching construction maximum-sized matching size least |m|. thus tree-based network embedding phylogenetic x-tree displayed support tree precisely every vertex vertex note every embedding phylogenetic x-tree support tree moreover ﬁxed base tree least distinct support trees corresponds denoting support trees goal section enumerate size determine |sup|. motivation addressing question counting number displayed trees general binary phylogenetic network known p-complete holds even networks constrained temporal treebased. however binary tree-based networks results show counting support trees carried polynomial-time. note counting support trees different counting displayed trees. number support trees network also provides measure ‘complexity’ network many support trees allows numerous possible evolutionary scenarios combine ‘tree-like’ evolution reticulation events. begin characterising arcs support tree tree-based network. reticulations reticulation parent vertices child note disjoint consists tree vertices. bipartite graph vertex partition tree-based network. subset edges supporting omnian incident least edge reticulation incident exactly edge note support necessarily matching. illustrated fig. tree-based network arboreal either reticulation tree vertex leaf. observe support tree arboreal arcs subset arcs also arboreal {uv} edge purposes next theorem without ambiguity view edge corresponding theorem tree-based network. subset arcs support tree union arboreal arcs supporting proof first suppose support tree subset arcs arboreal. establish necessary direction sufﬁces show supporting then arboreal tree vertex reticulation. thus {uv} edge unless parent reticulation. arboreal which together implies support tree contradiction. {uv} edge since arcs support tree reticulation reticulation parent exactly directed furthermore omnian tree vertex least directed follows supporting suppose union arboreal arcs supporting show arcs support tree sufﬁces show that every non-root vertex exactly directed least directed tree vertex leaf unique directed arboreal exactly arc. furthermore tree vertex directed omnian. also tree-based easily seen least child property parents tree vertices. since support follows contains directed assume reticulation. reticulation parent then tree-based exactly reticulation parent unique arboreal directed furthermore deﬁnition directed hand reticulation parent vertex case exactly directed arboreal directed follows arcs support tree completes proof theorem. remainder section restrict attention binary tree-based networks. purposes proof next lemma rest section component graph consists cycle refer component cycle component proof since binary vertex degree component either cycle path. since vertex corresponding reticulation degree follows degree-one vertex tree vertex. note vertex degree zero. maximal path path component vertices correspond tree vertices vertices correspond reticulations assume omnians denote reticulation child denote reticulation child note otherwise vertex parents tree vertices. furthermore maximality neither corresponds reticulation denote reticulation parents respectively observe omnians. therefore omnians follows corresponds maximal path bipartite graph deﬁned section binary maximal path begins ends omnians follows theorem tree-based; contradiction. thus omnian. lemma immediately follows. number cycle components path components terminal vertices number vertices theorem provide exact expression |sup| turns equivalent right-hand-side thereby showing actually equality. relating connected components lemma number cycle components path components without omnian terminal vertex number vertices path component particular |sup| computed time polynomial size this enough independently consider component contributes supporting fixing component subset edges component contained supporting set. component cycle tree vertices component omnians follows exactly choices suppose component path qk+. analogous conclusion holds contains edge {qk+rk}. furthermore easily checked contains neither {qr} {qk+rk} exactly omnian incident edges particular contains edges {qiri−} {qiri} consists edges thus number possibilities number tree vertices second assume exactly omnian. without loss generality assume omnian case must contain edge {qr} precisely choice multiplying number choices contributing component gives count time polynomial size simply constructs graph determines number cycle components path components; path component counts number vertices insert quantities expression theorem simple application theorem biological example network marcussen involving three ancient hybridization events evolution bread wheat fig. gives rise bipartite graph consists three disjoint paths length counts number support trees lemma binary tree-based network {or} vertex bipartition sets omnians reticulations respectively. following hold proof observe cycle component vertex out-degree vertex tree vertex. turn implies vertex property parents tree vertex. part easily deduced observation. proof observe path component terminal vertices vertex tree vertex vertex property parents tree vertices. note that terminal vertex property parents reticulation. omnian vertex contradicting assumption component. using observation easily checked holds. paper shown recent characterisations properties treebased networks well proximity measures extended binary phylogenetic networks arbitrary phylogenetic networks. instances extensions possible adapting approach used binary case. however results example theorem concerning antichain-to-leaf property characterisation tree-based temporal networks seem require completely different approach. second part paper investigated problem determining given tree-based network number support trees introduced bipartite graph showed one-to-one correspondence supporting sets support trees restricted focus binary networks enabled determine number support trees binary. questions immediately arise. number necessarily binary distinguish support trees result base tree that instead counting support trees count number base trees leave questions future work. acknowledgements would like thank momoko hayamizu helpful comments concerning theorem anonymous reviewers suggestions. thanks biomathematics research centre university canterbury hosting visit collaboration. thank allan wilson centre zealand marsden fund funding support project.", "year": "2017"}