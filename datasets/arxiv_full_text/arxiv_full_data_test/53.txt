{"title": "Synthesising Executable Gene Regulatory Networks from Single-cell Gene  Expression Data", "tag": "q-bio", "abstract": " Recent experimental advances in biology allow researchers to obtain gene expression profiles at single-cell resolution over hundreds, or even thousands of cells at once. These single-cell measurements provide snapshots of the states of the cells that make up a tissue, instead of the population-level averages provided by conventional high-throughput experiments. This new data therefore provides an exciting opportunity for computational modelling. In this paper we introduce the idea of viewing single-cell gene expression profiles as states of an asynchronous Boolean network, and frame model inference as the problem of reconstructing a Boolean network from its state space. We then give a scalable algorithm to solve this synthesis problem. We apply our technique to both simulated and real data. We first apply our technique to data simulated from a well established model of common myeloid progenitor differentiation. We show that our technique is able to recover the original Boolean network rules. We then apply our technique to a large dataset taken during embryonic development containing thousands of cell measurements. Our technique synthesises matching Boolean networks, and analysis of these models yields new predictions about blood development which our experimental collaborators were able to verify. ", "text": "abstract. recent experimental advances biology allow researchers obtain gene expression proﬁles single-cell resolution hundreds even thousands cells once. single-cell measurements provide snapshots states cells make tissue instead population-level averages provided conventional high-throughput experiments. data therefore provides exciting opportunity computational modelling. paper introduce idea viewing single-cell gene expression proﬁles states asynchronous boolean network frame model inference problem reconstructing boolean network state space. give scalable algorithm solve synthesis problem. apply technique simulated real data. ﬁrst apply technique data simulated well established model common myeloid progenitor diﬀerentiation. show technique able recover original boolean network rules. apply technique large dataset taken during embryonic development containing thousands cell measurements. technique synthesises matching boolean networks analysis models yields predictions blood development experimental collaborators able verify. biological data becomes accurate becomes available larger volumes researchers increasingly adopting concepts computer science modelling analysis living systems. formal methods successfully applied gain insights biological processes direct design experiments single-cell resolution gene expression measurement technology provides exciting opportunity modelling biological systems cellular level. single-cell gene expression proﬁles provide snapshot true states cells reach real experimental system level detail available major challenge researchers move beyond established methods analysis population data techniques take advantage single-cell resolution data cell biology. grns control self-renewal diﬀerentiation capabilities stem cells maintain adult tissues become perturbed diseases cancer. also specify complex developmental processes lead initial formation tissues embryo. understanding eﬀectively control grns lead important insights programmed generation clinically-relevant cell types important regenerative medicine well design molecular therapies target cancerous cells. biological systems modelled diﬀerent levels abstraction. molecular level biochemical events occur inside cell captured stochastic processes given chemical master equations chemical events fundamentally stochastic driven random ﬂuctuations molecules present concentrations brownian motion. asynchronous boolean networks abstract away details transcription translation molecular binding reactions represent status modelled substance either active inactive using non-determinism capture different options arise stochastic behaviour cell gene activity controlled combinatorial logic proteins called transcription factors cooperate physically bind regulatory region gene trigger transcription. target genes turn code transcription factors forming complex grn. asynchronous boolean networks particularly well suited modelling grns combinatorial logic regulating gene activity expressed boolean function. example gene activated either presence gene presence genes presence repressor prevent becoming triggered presence activating genes. modelling diﬀerentiation cell using asynchronous boolean network dynamics proceed series single–gene changes. mature diﬀerentiated cell types correspond stable attractor states model. predictions modes interaction genes resulting computational analysis tested experimentally range assays. example analysis model predicts gene activated gene chip assay used assess whether protein coded binds regulatory region then perturbations prevent binding region introduced eﬀect expression examined. state–space analyses hand–built asynchronous boolean network models based literature–derived gene regulatory interactions successfully applied model cell fate decisions reproduce known experimental results address problem automatically constructing models directly data. think single-cell gene expression proﬁles state space asynchronous boolean network identify underlying gene regulatory logic could generated data? encode matching asynchronous boolean network state space synthesis problem constraint solving techniques answering synthesis problem. synthesised network match data aspects. first resulting network minimise transitions expression points part sampled data. second resulting network allow progression state space matches time diﬀerent experiments produced data. direct encoding problem satisﬁability problem scale well. suggest modular search handles parts state space network need reason entire network once. consider test cases. first reconstruct existing asynchronous boolean network state space. able reconstruct boolean rules original network. second apply technique experimental data derived blood cell development. network produced technique matches known dependencies suggests interesting novel predictions. predictions validated collaborators. paper describes algorithm used obtain results recently published biological paper single-cell resolution study embryonic blood development biological paper includes full details experiment generated data biological validation resulting synthesised model. here cover algorithmic aspects method. single-cell gene expression experiments produce gene expression proﬁles individually measured cells. gene expression proﬁles vector element gives level expression gene cell. figure plots level genes runx cells. experimental collaborators performed gene expression proﬁling batches cells taken four sequential developmental time points mouse embryo. time point experiment aimed capture every cell potential develop blood cell providing comprehensive single–cell resolution picture developmental timecourse blood development. resulted data cell measurements. full details experiment analysis found data ﬁrst kind attempting capture entire tissue’s worth progenitor cells across developmental time course. level coverage potential cell state space required approach accurately recover gene regulatory networks requires measurement thousands cell proﬁles. later introduce fig. state graph. node colours correspond time point state measured. states earliest time points coloured blue states last time point coloured red. synthetic data hundred cell states order illustrate approach works would like stress usable real experimental data algorithm needs able scale thousands cell states. cells level expression transcription factor genes measured. expression levels non-negative real numbers value indicates given gene unexpressed cell idea introduced paper view gene-expression data sample state-space asynchronous boolean network. past manually curated boolean networks successfully used recapitulate experimental results boolean networks hand–constructed biological knowledge accumulated literature many years. here produce boolean networks automatically directly gene expression data employing synthesis techniques. produce boolean network explain data used inform biological experiments uncovering nature gene regulatory networks real biological systems. order convert data format viewed boolean network state space ﬁrst discretise expression values binary assigning value non-zero gene expression measurements. value zero corresponds discovery threshold equipment used produce data. discretising expression proﬁles yields unique binary states every state vector boolean values corresponding activation/inactivation level genes given cell. asynchronous boolean network transitions correspond change value single variable. hence next look pairs states diﬀer gene analysis strongly-connected components graph shows strongly connected component contains states. note random sample plot graph largest strongly connected component given figure edge every hamming–distance pair cluster together highly connected nodes. colours nodes correspond developmental time measurements taken. note clear separation earliest developmental time point latest one. representation already suggests clear change states development embryo separate clusters identiﬁable obvious fate transitions clusters. wish asynchronous boolean network matches graph. impose several restrictions boolean network. connections states correspond change value gene however know direction change. thus search simultaneously directions update functions diﬀerent genes satisfy following conditions states earliest developmental time point able evolve series single–gene transitions states latest developmental time point. secondly update functions must minimise number transitions lead additional unobserved states measured experiment. ﬁrst illustrate synthesis method using example. take existing boolean network construct associated state space state space input synthesis method order reconstruct boolean network started with. krumsiek introduce boolean network model core regulatory network active common myeloid progenitor cells network based upon comprehensive literature survey. includes boolean variables boolean update function variable model given well-deﬁned initial starting state representing expression proﬁle common myeloid progenitor computational analysis reveals acyclic hierarchical state space states four stable state attractors stable attractors agreement experimental expression proﬁles megakaryocytes erythrocytes granulocytes monocytes; four mature myeloid cell types develop common myeloid progenitors. also reachability constraints restrict edges included orientation. since state space constructed starting welldeﬁned initial state would like enforce constraint non-initial state ought reachable directed path initial state. since cell development proceeds hierarchically unidirectionally favour short paths long paths. eliminates routes seem biologically implausible example routes cross fate transition return began. also reduces space paths search through. increasing lengths allowed paths increase number considered solutions. results applying technique shown figure method reconstructs boolean update functions gene cases uniquely identifying original function. note multiple solutions found update function solutions exact provide useful regulatory information could veriﬁed experimentally. example solutions successfully predict activation gata although solutions omits repression pu.. gata∧¬) gata∧¬) gata∧¬ gata∧¬) gata∧¬) ∧¬pu. ∧¬pu. ∧¬pu. ∧¬pu. functions form∧¬pu. eklf gata∧¬fli gata∧¬eklf gata∧¬pu. cebpa cebpa∧¬ cebpa∧¬) cebpa∧¬) cebpa∧¬) cebpa∧¬) cebpa∧¬ cebpa∧¬ cebpa∧¬ pu.∧¬gata ∧¬gata pu.∧¬ functions form pu.∧¬ pu.∧¬ pu.∧¬ cebpa∧¬ cebpa∧¬ functions form∧¬ functions form∧¬ functions form∧¬ pu.∧¬gﬁ cebpa∧¬egrnab asynchronous boolean network variables u={u boolean update functions. every ui∶{ }n→{ associated variable state system update function enabled state i.e. applying update function state state successor state enabled next state non-deterministically selecting dn). update function enabled system remains current stable state remain induces labelled transition system states successor relation. transition labelled variable undirected state space undirected graph vertex uniquely labelled state boolean network edge diﬀer value exactly variable edge labelled general induces directed state space undirected state space consider transition system then induced directed state space where∈ implies variable that∈ that compatible every synthesis problem stated follows given undirected state space given variables would like extract boolean update functions induce directed state space states reachable given initial states. also want ensure additional undesired states reachable ruling transitions ‘exit’ state space. formally given variables undirected state space initial vertices. would like update function ui∶{ }n→{ variable following conditions hold. u={ui\u0000 every non-initial vertex reachable initial vertex directed path directed state space induced every variable states without outgoing vi-labelled arc. every require since intend apply method experimental setting incomplete sample possible states system relax deﬁnition extend partial data. instead requiring every state reachable initial states measured require ﬁnal states reachable. instead requiring every undesired transition ruled seek maximise number transitions eliminated. formally stated next. before given variables undirected state space designated initial vertices. addition given designated ﬁnal vertices along threshold variable threshold speciﬁes many would like update function ui∶{ }n→{ variable following conditions hold. u={ui\u0000 every ﬁnal vertex reachable initial vertex directed path directed state space induced every variable states without outgoing vilabelled arc. every number states restrict search update functions form f∧¬f monotone boolean formula. inputs activating inputs gene inputs repressing inputs. restriction chosen discussion biologist colleagues consultation literature start direct encoding search matching boolean network. search parameterised shape update functions length paths initial states ﬁnal states thresholds variable. increasing ﬁrst parameters decreasing last explore possible boolean networks. order represent boolean update function gene f∧¬f bitvectors{a ∪{∨∧} bitvector represents example formula represented solution restrict syntactic form possible update canonical representation. example function) included search space not. search encode application function state implilogical operators; substituting values variables directly example application function state mapped s)∧¬s. recall require every ﬁnal vertex reachable initial vertex directed path directed state space induced boolean network. require every ﬁnal vertex reachable directed path every vj-labelled edge along path compatible associated update function enforce constraints track compatibility edges update functions deﬁne reachability recursively. consider reachability paths maximum length recall consider shorter paths biologically likely. iteratively increasing length paths considered obtain satisfying models. rected edge{si sj}∈ track value application ui). true bitvector encodes fact node reachable initial node steps maximum encodable value \u0000rn\u0000− bitvector initial nodes reachable zero steps every edge another node reachable fewer steps. every that{si sj}∈ eij→ also non–initial nodes cannot reached zero steps every rn=−∨ finally constraint every ﬁnal node reachable initial node rn≠−. consider update function node negatively matched using update variable node record whether negatively matched nodes greater equal threshold∑s∈ni mis≥ search satisfying assignments constraint variables encoding representation boolean update functions resulting synthesised boolean network combination update functions. introduce compositional algorithm scales better direct encoding given above. problem synthesising boolean network data partitioned three stages. crucially avoid searching complete boolean network consider parts network constructed independently. considering underlying directed edges consider underlying directed edge vi-labelled undirected edges{s independently. pose decision problem directed edge whether dition encoded boolean satisﬁability compatible function found quickly evaluated problem adding constraints represent encoding update function threshold condition evaluation function speciﬁc edge consideration. satisfying function compatible come part algorithm considers edges variables together order enforce global reachability condition phase require solving boolean satisﬁability problem result eﬃcient. edge pruning previous phase algorithm path ﬁnal node implies satisfying models otherwise reachability condition enforced ﬁxing directed edges variable search update function variable independently variables. vi-labelled edges computed previous phase encode search boolean satisﬁability problem. search satisfying assignments constraint variables encoding using allsat procedure extract possible update functions variable gives rise update functions variable boolean networks product update functions variable. note ﬁnal phase algorithm fail update functions variable possible update functions compatible path edges computed previous phase. edge individually compatible update function update function compatible every edge order cope limitation extract minimal unsatisiﬁable core boolean formula search replacement paths exclude incompatible combinations edges. step iterated satisfying solutions found variables path found implying valid models. extending search shortest paths initial ﬁnal node pairs directed graph k-shortest paths pairs incremementally increasing increase number possible update functions consider. limit obtain satisfying models. implementation algorithm written uses satisﬁability solver available https//github.com/swoodhouse/ scns-toolkit. figure present experimental results running implementation direct encoding section compositional algorithm four data sets small synthetic data section large embryonic experimental data section second experimental data covering blood stem cells. also show results rerunning embryonic data third states removed. experiments performed intel core .ghz using single thread. direct encoding synthesised matching boolean network small synthetic data faster compositional algorithm cannot scale real experimental data sets quickly running memory. compositional algorithm hand scale handle real data sets sort produced experimental collaborators. experiments terminated within hours running single thread. compositional algorithm easily parallelised variables would increase eﬃciency. recall cell measurements taken four sequential developmental time points state graph resulting discretisation data exhibited clear separation earliest developmental time point latest applied synthesis technique data taking initial states states ﬁrst time point ﬁnal states states latest time point. complete details direct reader result synthesis possible boolean update functions genes several genes uniquely identiﬁed update function. applying standard techniques analysis boolean networks found stable state attractors performed computational perturbations. synthesised network along subsequent computational analysis predictions tested experimentally. found results robust performing bootstrapping removing third data random rerunning synthesis algorithm. experimental collaborators able validate predictions made analysis. update function genes core network directly activates many genes tested experimentally range assays. evidence found activators speciﬁed gene’s synthesised update function indeed activate expression gene furthermore fashion consistent boolean logic synthesised update function. could regarded local validation model testing directed edges network. computational perturbations another gene core network indicated forced always expressed stable states corresponding cells ﬁnal developmental time point longer exist. cell diﬀerentiation assays conﬁrmed prediction experimentally ﬁnding gene forced expressed number cells normally emerge ﬁnal time point signiﬁcantly reduced. thought global validation model prediction behaviour whole network certain perturbation. previous analyses single-cell gene expression data mostly based statistical properties data viewed whole correlation level expression pairs genes analysis cannot recover mechanistic boolean logic infer direction interactions cannot easily distinguish direct indirect inﬂuence. boolean networks introduced kauﬀman order study random models genetic regulatory networks since applied range contexts modelling blood stem progenitor diﬀerentiation yeast apoptosis network network regulating pluripotency embryonic stem cells bdd-based algorithms state-space exploration ﬁnding attractors boolean networks introduced synthesis problem producing programs designs speciﬁcations. recent years much progress made usage solvers synthesis. essentially existence program solves certain problem posed satisﬁability query. then solver tries search solution query corresponds program. example srivastava show capabilities solvers solve quantiﬁed queries enable search conditions code fragments match given speciﬁcation. similarly solar-lezama build framework writing programs holes letting search algorithm proper implementations them. approach reactive synthesis similar type artefact produces. however techniques using related explained above. recently beyene shown constraint solving used also context reactive synthesis. synthesise state-machine-like models gene mutation experiments using novel counterexample-guided inductive synthesis algorithm approach uses constraint solvers search program completions match given speciﬁcations explained above. data type model diﬀerent dealt here called approach. recently several applications synthesis boolean networks. dunn show existing static topological regulatory network embryonic stem cells gene expression data order obtain executable boolean network assumption experimentally measured data represent stable states system. assumption appropriate cell lines maintained culture adapt well developmental processes ours cells transiting intermediate states order develop particular lineage. recent work karp sharan shows synthesise boolean networks given topological network perturbation experiments reduction integer linear programming. paoletti synthesise related class models perturbation data reducion smt. best knowledge approach ﬁrst synthesise gene regulatory network models directly gene expression data without need either genetic perturbation data a-priori information topology network. presented technique synthesising boolean networks single–cell resolution gene-expression data. exciting type data allows consider state cell separately giving rise state snapshots treat states asynchronous boolean network. insight update functions variable sought separately giving rise reasonably sized satisﬁability queries. combine single gene update functions considering time included data. able reconstruct rules manually curated boolean network produce possible boolean networks given experimental data similar curated boolean network available. discussion biologists boolean network predictions experimentally validated lab. awaiting similar data additional experiments apply technique time considering usage advanced search techniques used paper analysis types highthroughput data. future work experimental domain includes validation links synthesised network design gene perturbation experiments motivated results computational perturbations. interesting question future research whether techniques like ours achieve scalability treating diﬀerent aspects graph data structure seperately applicable domains graph–like data generated. acknowledgements. thank gottgens moignard wilkinson sharing biological data discussing biological signiﬁcance discussions resulting boolean network meaningfulness. thank bodik srivastava hall helpful discussions.", "year": "2015"}