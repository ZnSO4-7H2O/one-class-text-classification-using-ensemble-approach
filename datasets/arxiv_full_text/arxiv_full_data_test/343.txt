{"title": "Ancestral inference from haplotypes and mutations", "tag": "q-bio", "abstract": " We consider inference about the history of a sample of DNA sequences, conditional upon the haplotype counts and the number of segregating sites observed at the present time. After deriving some theoretical results in the coalescent setting, we implement rejection sampling and importance sampling schemes to perform the inference. The importance sampling scheme addresses an extension of the Ewens Sampling Formula for a configuration of haplotypes and the number of segregating sites in the sample. The implementations include both constant and variable population size models. The methods are illustrated by two human Y chromosome data sets. ", "text": "consider inference history sample sequences conditional upon haplotype counts number segregating sites observed present time. deriving theoretical results coalescent setting implement rejection sampling importance sampling schemes perform inference. importance sampling scheme addresses extension ewens sampling formula conﬁguration haplotypes number segregating sites sample. implementations include constant variable population size models. methods illustrated human chromosome data sets. paper study aspects ancestral history random sample sequences conditional features haplotype conﬁguration obtained present time labeled initially assume inﬁnitelymany-sites mutation model constant population size sites completely linked region recombination. begin theory describes eﬀects mutations time time past. describe distribution quantities results describe eﬀects variation arising present time time past. describe eﬀects standing variation providing simulation approach studying joint distribution number segregating sites haplotypes sample time resp. number segregating sites haplotypes resp. ancestors formed standing variation arising time past. approach allows variable population size well essentially arbitrary binary branching models yule process. full haplotype conﬁguration number segregating sites available many questions asked ancestral history current sample. sequential importance sampling algorithm studying ancestral history sample genes conditional haplotype conﬁguration number segregating sites developed. complete pattern mutations haplotypes known perfect phylogeny genetree could constructed ancestral inference ages mutations time recent common ancestor made conditional genetree topology. example appears analysis consider case haplotype frequencies number mutations known. theory computational algorithms much simpler. implementation computes inter alia probability sample conﬁguration haplotypes segregating sites stationary population average coalescence times mutation times allele loss times allele ages back time conditional current haplotype conﬁguration number segregating sites conditional average allele conﬁguration distribution ancestors time past. inﬁnitely-many-sites model haplotype conﬁguration follows inﬁnitely-many-alleles model haplotype conﬁguration sample allele conﬁguration probability distribution ewens sampling formula. number haplotypes ancestors arise mutations number mutations sample arising time coalescence times events denoted constant size coalescent model independent exponential random varitime appropriate lineages lost either mutation coalescence. times events denoted constant population size case independent exponential random variables reader referred ewens distribution haplotypes sample ewens sampling formula; griﬃths original derivation distribution looking back time diﬀusion process; tavar´e original derivation connections kingman coalescent review ancestral lineage distributions; tavar´e introduction ancestral lineage distributions ancestral inference population genetics; griﬃths review representations ancestral distributions. number mutations arising joint probability ancestors time qlgl number segregating sites sample population initial time. stationary population deﬁned considers standing variation stationary population well mutations distribution number mutations stationary population time conditional distribution number ancestors given number mutations easier. pgf/probability number mutations number ancestors time past method computing stationary joint distribution derived exploiting diﬀusion generator model alleles letting found numerically joint distribution strongly diagonal that approximately also shown proper limit distribution even though total coalescence rate total mutation rate process counts mutations alleles arrive back time sample ancestors considering groups lines a−aθ groups mutations coalescences occur. slightly diﬀerent approach described equation griﬃths consider sample paths mutations alleles starting ﬁxed stationary distributions satisfy following recursive system want computed equations argued probabilistic perspective though diﬀerent approach taken griﬃths identiﬁcation made. analogous complex similar recursion number mutations could written section develop theory used rejection sampling importance sampling schemes. begin recalling simulation method generates stationary samples haplotype counts together number mutations tree. works constant population size coalescent models. useful simulate ancestral history haplotype conﬁgurations order together mutations condensation algorithm growing gene tree whose nodes mutations. algorithm tree described ethier griﬃths theorem griﬃths following. look haplotype frequencies order oldest keep track number accumulated mutations state space transitions markovian. condensed algorithm following. joint distribution studied innan derived equation essentially authors recursive equations derive exact probabilities small sample sizes. section importance sampling technique based allows calculation much larger sample sizes possible exact calculation also carry ancestral inference back time. simplest ancestral question distribution conditional segregating sites sample size rejection algorithms work well problems like this illustrated tavar´e balding griﬃths donnelly took general bayesian approach considered random variable times come variable population size coalescent model. combinatorics general binary coalescent tree studied sample frequency spectrum mean mutation known descendents sample genes calculated. illustrate describing generate observations conditional distribution conditional +tn− ·+tn−j+ +·+t. height coalescent tree. deﬁne total length tree form bins follows also note rejection approach used approximate conditional distributions many ancestral variables. example study distribution number mutations present ancestors time measure standing variation time following. blum rosenberg construct rejection algorithm maximum likelihood estimation number ancestral lineages time back based sample frequency spectrum. algorithm constructed diﬀerently algorithms tmrca ages mutations ancestral tree shown figure segregating sites haplotypes observed data. unconditional expected height coalescent tree time units expected height conditional segregating sites units latter found method table result runs constant population size coalescent model sample size segregating sites. table shows average value given righthand columns give mean. simple rejection schemes illustrated useful considering complicated summaries data. next section show exploit importance sampling approach derive conditional distributions given haplotype frequency distribution number mutations. sequential importance sampling ancestral inference population genetics long history illustrated griﬃths tavar´e felsenstein stephens donnelly griﬃths iorio griﬃths technique described constructing proposal distribution events back time simulating back time correcting approximate proposal distribution calculating exact probability path forward time taking ratio probability forward path divided approximate probability backward path importance weight. simulation runs empirical choosing proposal distribution art. principal choosing lineage involved transition back time uniformly. theoretical justiﬁcation described sequential importance sampling haplotype conﬁguration regarded simpliﬁcation technique used complete genetree constructed perfect phylogeny pattern mutations sequences. simpler scheme counts diﬀerent haplotypes sequences extra information number mutations back recent common ancestor. time information coalescence times ages mutations time recent ancestor included. details include time importance sampling algorithm griﬃths tavar´e develop importance sampling approach kingman coalescent models conditional observed conﬁguration program also implements variable population size option exponential growth. coalescent times distribution depends time occur. detail here refer reader griﬃths tavar´e analogue ewens sampling formula case derived griﬃths lessard approximately satisﬁed number alleles suitable upper bound. simulation variance starting diﬀerent seeds observed small sample sizes example follows. continue example started section haplotype data sequences hammer haplotypes segregating sites. continue value illustration. haplotype frequencies runs diﬀerent seeds gave identical output three signiﬁcant places showing conﬁdence output. probability obtaining sample conﬁguration segregating sites comparison probability sample conﬁguration calculated ewens sampling formula mean tmrca conditional data coalescent units compared value obtained section given time past distribution conﬁguration number mutations number ancestral lineages conditional current conﬁguration number mutations calculated importance sampling program. illustrate considering time points taking averages times. results second third columns compared table show qualitatively results. table shows relative errors estimates example letting superscripts denote estimates tables relative error table gives number haplotype counts diﬀerent times past. haplotypes decrease coalescence types eventually lost deﬁning mutation takes place. table give distribution number ancestral lines diﬀerent times past table result runs constant population size coalescent model sample size segregating sites haplotype frequencies given above. table shows average values conditional haplotype frequencies conditional current haplotype conﬁguration number segregating sites. interesting time conﬁgurations afterwards number lineages number haplotypes decrease rapidly. constructed. paper concludes data show evidence expansion. example approach consider subset data consisting sequences haplotype groups. three oldest groups phylogeny composed sequences. explanations expansion data conﬁguration non-random choice individuals however assume random sample example analysis. illustration focus tbly gene composed containing biallelic snps. haplotype conﬁguration equal number alleles multiplicity given table data suggests exponential growth population. growth produces star shaped coalescent tree leads greater number singleton sequences. mean number singletons constant size population setting average number pairwise diﬀerences unbiased estimate used test population growth departures coalescent model growth. large negative values indicate population growth. data consistent expansion. appendix describe another statistic testing no-growth model based frequency spectrum particularly number singletons large. achaz develops neutrality tests based frequency spectrum generalize tests based number segregating sites tajima’s large data diﬃcult obtain precise estimate growth rate large amount variation importance sampling scheme number length sequences. much importance sampling issue size structure data. random subsets data could chosen main feature data large number singletons. ancestral inference number ancestral lines back would also diﬃcult interpret subsamples. large value diﬀerent growth rates growth decreases variation sample increases proportion singletons coalescent lengths shortened tree star shaped. increasing growth keeps variation well increasing number singletons. likelihood allele conﬁguration number segregating sites calculated several values growth rates diﬀerent replicates million runs gave results table scale modern molecular datasets points diﬃculty exact inference techniques highlights need alternative approaches. among approximate bayesian computation advanced simulation methods paul joyce made several contributions. examples paul’s research estimating evolutionary rates trait evolution perfect simulation method simulation non-neutral high dimensional distribution allele frequencies motivated discussion section discuss behaviour ewens sampling formula large values ewens sampling formula gives distribution number haplotypes frequencies sample taken constant-size population. writing number haplotypes frequency distribution α+α+· ·+nαn formula shows that condition α+α+· ·+nαn would independent poisson random variables mean θ/j. indeed ﬁxed known total variation distance distribution independent poisson random variables arratia barbour tavar´e theorem practice diﬀerent limit laws obtained depending varies example approximately poisson distribution mean data section number singleton haplotypes mean since probability observing singletons conclude constant-size model provide adequate similar spirit approximately poisson distribution mean observed probability larger value more suggests constant-size model good", "year": "2017"}