{"title": "Probabilistic models of individual and collective animal behavior", "tag": "q-bio", "abstract": " Recent developments in automated tracking allow uninterrupted, high-resolution recording of animal trajectories, sometimes coupled with the identification of stereotyped changes of body pose or other behaviors of interest. Analysis and interpretation of such data represents a challenge: the timing of animal behaviors may be stochastic and modulated by kinematic variables, by the interaction with the environment or with the conspecifics within the animal group, and dependent on internal cognitive or behavioral state of the individual. Existing models for collective motion typically fail to incorporate the discrete, stochastic, and internal-state-dependent aspects of behavior, while models focusing on individual animal behavior typically ignore the spatial aspects of the problem. Here we propose a probabilistic modeling framework to address this gap. Each animal can switch stochastically between different behavioral states, with each state resulting in a possibly different law of motion through space. Switching rates for behavioral transitions can depend in a very general way, which we seek to identify from data, on the effects of the environment as well as the interaction between the animals. We represent the switching dynamics as a Generalized Linear Model and show that: (i) forward simulation of multiple interacting animals is possible using a variant of the Gillespie's Stochastic Simulation Algorithm; (ii) formulated properly, the maximum likelihood inference of switching rate functions is tractably solvable by gradient descent; (iii) model selection can be used to identify factors that modulate behavioral state switching and to appropriately adjust model complexity to data. To illustrate our framework, we apply it to two synthetic models of animal motion and to real zebrafish tracking data. ", "text": "recent developments automated tracking allow uninterrupted high-resolution recording animal trajectories sometimes coupled identiﬁcation stereotyped changes body pose behaviors interest. analysis interpretation data represents challenge timing animal behaviors stochastic modulated kinematic variables interaction environment conspeciﬁcs within animal group dependent internal cognitive behavioral state individual. existing models collective motion typically fail incorporate discrete stochastic internal-state-dependent aspects behavior models focusing individual animal behavior typically ignore spatial aspects problem. propose probabilistic modeling framework address gap. animal switch stochastically different behavioral states state resulting possibly different motion space. switching rates behavioral transitions depend general seek identify data effects environment well interaction animals. represent switching dynamics generalized linear model show that forward simulation multiple interacting animals possible using variant gillespie’s stochastic simulation algorithm; formulated properly maximum likelihood inference switching rate functions tractably solvable gradient descent; model selection used identify factors modulate behavioral state switching appropriately adjust model complexity data. illustrate framework apply synthetic models animal motion real zebraﬁsh tracking data. fascinating topics interdisciplinary research understand complexities animal behavior naturalistic settings. many essential questions explored previously either direct observations qualitatively using mathematical models remain unanswered quantitative level connect large scale data predictable individual behavior moment-by-moment basis factors inﬂuence behavioral decisions? coordinated collective motion realistically emerge groups interacting animals? include existence different cognitive behavioral states mathematical descriptions animal motion? recent progress automated recording techniques opened door addressing questions making possible track single multiple interacting animals extended periods time buhl ballerini gautrais robinsin lukeman nagy katz peshkin traditional models animal motion constructed favor simplicity provide qualitative match observed collective aggregate behaviors today revisited carefully ﬁtted extensive data provide predictive quantitative models ballerini lukeman katz addition revisiting existing models wealth data also provides motivation devise models remove previously-made restrictions assumptions least test rigorously whether essential. central assumption underlies many models animal motion behavior animal continuously performs universal computation determine next action movement direction huth wissel vicsek couzin animals however often exhibit discrete stereotyped behaviors behavioral switches result apparently different modes motion space much like kinematic proxies different cognitive behavioral states described harpaz individual animal states extracted data using various approaches low-dimensional reduction complex behavior stephens berman girdhar fragmentation trajectories segments based functionality space shemesh machine learning-based detection behavior types branson data mining methods nathan moreover states deﬁned also whole animal groups tunstrøm consider here. switches indidivual’s behavioral modes seem occur stochastically rate could principle affected many factors spatial preferences various environmental signals motion conspeciﬁcs within group etc. question therefore arises combine single tractable model hand kinematic description individual’s motion space other existence different discrete behaviors behavioral states. behavioral states indeed present important ignoring existence—which happens e.g. classic zonal force-ﬁeld models—will enable learn laws behavior motion averaged over various behavioral states. would thus fail capture observed heterogeneity stochastic discrete nature individual animal behaviors consequently motion trajectories. combination stochastic state transitions deterministic laws motion space distinguishes model classical models behavioral rules assumed ﬁxed time. traditionally rules inferred ﬁtting available data resulting simulated trajectories tend much smoother real data. approach also differs population dynamics models capturing proportions animals different tasks behaviors. instance seely camazine sneyd study behavioral states honeybees multiple food sources present distinguish proportion population feeding different sources. similarly beckers detrain deneubourg sumpter pratt distinguish behavioral states foraging either multiple food sources recruiting resting ants. works describe different behavioral states terms population averaged quantities goal incorporate different behaviors individual level individual trajectory data. propose class probabilistic models sufﬁciently rich capture wide variety complex individual collective behaviors ﬂexible external factors modulate focal animal’s behavior. despite expressive power proposed models remain easy simulate given parameters support tractable maximum likelihood parameter inference trajectory data. described following section models technically hybrid models combine deterministic dynamics animal motion discrete behavioral states; stochastic transitions states described generalized linear model framework. paper structured follows. next section introduces rationale behind modeling approach propose speciﬁes model mathematically discusses forward inverse approaches. second half paper focuses three examples synthetic models animal behavior showcase validate inference well illustrate interesting extension coarse-grained behavioral states real data example illustrate inference without prior knowledge laws motion well model selection identify explanatory variables affect behavioral state switching. construe behavior broadly spanning range occurrence stereotyped events identiﬁed body pose speciﬁc interactions environment vocalization production etc. internal behavioral states manifest animal adopting particular center-of-mass motion space. assume animal switches possible behaviors stochastic fashion rates depend general seek identify animal’s current behavioral state location location animals group. expressive power model stems combination stochastic deterministic components schematized described detail section formally model belongs class hybrid models pola davis ghosh stochastic discrete states deterministic continuous dynamics typically called piecewise-deterministic markov processes switching behavioral states stochastic within behavioral state animal follows certain motion governs kinematics speciﬁed system ordinary differential equations. powerful generalization traditional models schematized comparison either zonal force ﬁeld models focal animal always follows single universal motion cannot depend behavioral state. similarly frameworks model switching behavioral states individual animals often ignore fact behavior plays physical space modulated ever-changing spatial relationship focal animal conspeciﬁcs environment. model brings together analysis discrete behavioral states motion space single probabilistic framework. figure models animal motion inference model parameters. hybrid model consists stochastic switching behavioral states combined deterministic laws motion state. behavioral states laws motion state transition rates among known sample trajectories obtained stochastic simulation algorithm however measured animal trajectories classiﬁed known behavioral states laws motion transition rates unknown leads inference problem unknown transition rates. standard models e.g. zonal models lukeman force-ﬁeld models katz capture discrete stereotyped behaviors assume single universal computation carried animal every instant determine animal’s motion. bottom subpanel reproduced katz supporting information. given general notion constitutes behavior exists method automatically detecting annotating behaviors independent animal species experimental setup biological question asked. example describing ants coarse-grained easily observable behaviors might modes locomotion however experimental setups might want sidestep motion details instead focus anntenation grooming behaviors triggered exposure speciﬁc pathogens. absence generic algorithms behavioral annotation start assuming already given individual animal motion trajectories annotated behaviors interest; input data obtained observations problem-speciﬁc address here. starting input data framework proceed identify animals switch identiﬁed behaviors using generic problem-independent inference procedure. complex problem modeling animal behavior motion broken manageable pieces admit generic solutions thus need studied once. even though generic mechanism identifying behaviors currently reach several examples animal motion section show identiﬁcation attempted practice speciﬁc cases kinematic proxies exist behavioral states. three examples include case simulated motion bacterial chemotaxis case real zebraﬁsh data. modeling framework probabilistic naturally captures stochastic nature animal decision-making tolerate degree noise data. show section structure model permits straightforward tractable forward simulation stochastic animal trajectories group using variant gillespie’s stocahstic simulation algorithm gillespie conversly given data standard statistical tools solve inverse problem model inference model comparison identify environmental group factors modulate behavioral transitions. importantly since model derivative well-studied generalized linear models statistics neuroscience guarantee maximum likelihood inference convex. means identiﬁable models single best ﬁtting parameters dependence behavioral switching rates animal solved sequentially animal-by-animal standard gradient descent show section taken together methodological properties framework ensure remains practically applicable inference simulation even maintains large ﬂexibility expressive power. model’s main components schematically displayed consider population animals size n-th individual characterized position dimensions. position complemented physically relevant kinematic measurements instance velocity orientation etc; simplicity nevertheless refer simply position. addition individual internal behavioral state chosen available states individual every time follows deterministic motion describes rate change position depending current position state animal stochasticity motion arises random switching internal states transition rates transition rates depend states relevant transition also position animals important dynamic environmental factors captured central assumption model concerns mathematical form switching rates characterized parameters animal positions relationship serve stimulus drives changes state modulating transition rates dependence made tractable choosing particular representation positions essentially discretizes space positions discussed below. example representations parametrize dependence switching rates position coordinates individual animals pairwise spatial relationships animals excluding interactions individuals. formally rates instantaneous rates inhomogeneous poisson point processes describing behavioral state changes approximated inﬁnitely fast. dependence rates position state variables generalized linear model form nelder wedderburn mccullagh nelder transition rates speciﬁed nonlinear function acting summation representations position linear sought-for parameters statistical literature inverse nonlinear function also known link function. sensory motor neuroscience similar models used analyze dependence poisson spiking neurons stimulus output other simultaneously recorded neurons neural circuit pillow applied animal behavior easiest understand model animals second term argument interacting. vanishes behavioral transition rates decomposed coefﬁcients multiplicatively modulated representation animal’s position choice representations ﬁxed prior model inference provide ﬂexibility well regularization parameters parameters inferred data using maximum likelihood inference. animals interact pairwise fashion second term parametrized also inferred maximum likelihood added argument nonlinear function. typical example choice case could function depends distance center-of-masses interacting animals exist many possibilities representation kinematic variables choice problem-speciﬁc. absence prior information animal position could affect transition rates choose tiling functions schematized tiling functions represent nothing else particular discretization continuous domain e.g. bins; note bins nonuniform choice tiling functions particularly useful positions individuals measured limited resolution. domain discretized bins dependence switching rates position simply represented point-wise values speciﬁed bin-by-bin. representation functions therefore thought basis expand dependence switching rates positions coefﬁcients expansion chosen basis. beneﬁt tiling functions simplicity interpretation implementation. follows tiling functions sufﬁcient statistics maximum likelihood inference simply contingency tables counting number behavioral transition events type occurring every bin. drawback tiling functions curse dimensionality absence smoothness regularization. dimensionality kinematic space larger typically naive discretization along dimension result high dimensional histograms poorly sampled hence transition rates many values kinematic variables unconstrained data. tiling functions also permit rates depend position arbitrary possibly non-smooth way. however smoothness expected basis choices offer better generalization performance even basis lower dimensionality. ultimately choice position representation possible inference remaining convex tractable long dependence argument nonlinear function linear parameters inferred; link function chosen convex logconcave paninski convenient choice satisfying conditions adapt number individuals dimension space motion kinematic variables n-th individual kinematic variables individuals number behavioral states space available behavioral states internal state n-th individual internal state individuals log-likelihood function generalized linear model parameters ﬁrst order parameters second order time indices trajectories sampled time indices state transitions occurred stochastic process described non-homogeneous continuous-time markov chain since transition rates n-th individual depend current state external time-dependent input individuals. therefore probability density occupying state obeys master equation disjoint sets behavioral states reached state differing state n-th component. ﬁrst components represent changes behavioral state individual last term accounts continually changing position individuals. crucial assumption motion deterministic i.e. stochastic inﬂuences characterized random transitions suitably deﬁned behavioral states. total number states large discrete position space continuous. stochastic simulations animal motion performed variant gillespie algorithm gillespie exact algorithm generating realizations process given system starts initial state characterized initial time states positions individuals. undergoes series transitions states transition times indexed transition times states change individual follows continuous laws motion determined state individual currently resides figure dependence behavioral transition rates using different representations position. simplest approximate transition function without assumptions shape discretize using equidistant binning. represents rates using linear combination tiling functions value narrow region position space otherwise. multiplicative constants inferred approach determine shape transition rate function. choose non-overlaping tiling regions cover whole position space. smaller size tiling regions leads accurate approximation transition rate dependence position variables requires data inference. example rates expanded linear combination gaussian bump functions tile domain. enforces smoothness rate spatial scale corresponds width gaussians. example tiling functions representing rate domain. contrast sizes chosen uniformly. transition realized ﬁrst choosing individual changes state selecting particular transition. true following factorization transition probability stochastic simulation algorithm uses distribution waiting times next transition given probabilistic rule picking transition summarized following steps inference uses experimental data annotation behavioral states obtain transition rates states. denote data index used specify sampling times furthermore transition occurred time principle deterministic laws motion known advance would sufﬁcient record times transition occurs since rest trajectory calculated known laws motion. practice however laws motion often known system sampled ﬁnely even transition times. regime assume here. thus case multiple animal recordings arrays differ component corresponding single animal changing state given transition time. simplicity assume animals identical i.e. parameters equal among individuals. assumption necessary tractability inference data sufﬁcient parameters inferred per-animal basis questions animal-to-animal heterogeneity. express probability observing sequence transitions used denoted constant independent analogous log-likelihood function also written group individuals pairwise interactions. here prior parameters take uniform. intuitively ﬁrst term favors higher rates transitions observed second term favors lower rates integrated transition probabilities intervals become large. ﬁrst term depends observed transitions whereas second term depends trajectory them accounting transitions could happened not. dynamical laws priori unknown sampling trajectories sufﬁciently obtain good quadrature approximation integral terms. demonstrate three applications inference simple models animal behavior. studied examples schematized figure differ number interacting animals spatial dimension motion unfolds complexity animal motion seek describe. examples considered simpliﬁed models whose purpose provide quantitative match particular dataset; rather showcase versatility modeling framework application inference simulation methodology. figure examples animal motion studied paper. examples vary complexity dimension physical behavioral space number interacting individuals. single several interacting ants three behavioral states moving bacteria climbing chemical gradient using run-and-tumble motion. position space three dimensional tumble state bacteria perform directional random walk compound state constructed quick random switches tumble right tumble left states deterministic laws motion. tracked interacting zebraﬁsh moving shallow water tank. rates switching three kinematic states assumed depend three explanatory variables. ﬁrst example consider simplest model single moving along line. motion represented three behavioral states {xstop xdown} correspond motion constant velocity available directions resting state. equations motion perceived stimulus modulated weight tiling functions position space i.e. characteristic functions non-overlapping intervals equal size covering position space figure long stochastic trajectory motion following simulated chosen transition rates depended position ant; fraction trajectory transition rate details shown figure trajectory used infer transition rates considered unknown inference step. choice tiling functions {ϕi} inference decouples independent likelihood optimizations bin. crucially inference require knowledge detailed trajectories sufﬁcient statistics figure motion single line. animals switch three behavioral states stop transition rates form short segment sample stochastic trajectory following shown together instantaneous transition rates current state. tiling functions used represent position sufﬁcient statistics inference conditional histograms. first shows histograms position given behavioral state whole simulation. second shows number transitions given behavioral state bin. since state transitions happen states panels second shows histograms correspond different color-coded target states. inferred transition rates simulated stochastic trajectories compared exact transition rates since state transition states inference provides separate estimates transition shown sets dots different color. true rates target states equal. inferred rates shown figure closely captured true rates space well sampled. choice transition rates sampling coverage decreases exponentially increases rate estimates higher values less reliable; nevertheless sample numbers affect accuracy estimate bins. generally quality inference limited available data. ability sample many long motion trajectories clearly leads better parameter estimates. less obvious factor also inﬂuences results sampling frequency sets limit temporal precision behavioral transitions estimated quality approximation integral term explore consequences undersampling appendix single model extended multiple interacting ants. case transition rates n-th depend position also distance ants illustrated model interaction pair ants introduced interaction kernel depended mutual distance ants |∆z|. smaller distances lead larger additive contribution argument nonlinear function since model exponential function interaction modulated transition rates multiplicative factor. effect ants close transition rates increased leading fast switching among behavioral states. perform inference case interacting ants optimized likelihood written terms summary statistics results shown summary statistics case joint distribution time spent position separation zn−zn n-the n-th marginal distributions transition counts functions position distance case many interacting ants summary statistics become high-dimensional prompting revert likelihood evaluated directly trajectories. many bacteria ability climb gradients chemoattractant chemicals instance searching food. strategy climbing gradients so-called run-and-tumble motion berg here periods motion straight line nearly constant velocity called runs interspersed tumbles events bacterium randomly reorients itself. motion bias towards gradient source ensues rate tumbles initiated depends whether bacterium recently moving along against gradient. run-and-tumble paradigm directly framework dynamics tumble state stochastic approximated directional diffusion random walk orientation. however propose three-state model able capture stochastic tumble state show appendix three behavioral states introduce purpose state bacteria move constant speed direction; left/right tumble states bacteria stationary rotate left right constant angular velocity. bacterial motion described three variables position figure ants follow dynamics stochastic switching states follows transition rates intersingle interaction strength action kernel modulates rates multiplicatively factor increases transition rates ants close leaves unchanged sufﬁciently distant. short stochastic simulation interacting ants showing also instantaneous transition rates current state. interaction modulating factor exp) shown together transition rates using axis. ﬁrst second rows show inferred transition rates parameters respectively compared exact rates inference based simulated trajectories used tiling functions space penalizaj enforce vanishing interaction outside range |∆z| penalization term also avoids degeneracy rates ensuring existence unique solution inference problem. speed bacterium state angular velocity tumble state assumed constant. since transitions states stochastic length trajectory state well rotation angle tumble phase random variables. idea behind three state model {xrun xleft xright} switching rates tumble left tumble right states fast rapid succession random switches deterministic left/right tumble states generate random walk orientation effectively simulating single stocahstic compound tumble state equivalent described chemotaxis. consider example transition rates state tumble states depend position bacterium orientation displayed rate exiting state bacterium oriented parallel chemoattractant gradient high bacterium antiparallel. simulated trajectories shown show bias gives rise motion gradient direction. perform inference discretized kinematic variables bins inferred transition rates bin-by-bin simulated stochastic trajectories. approach made priori assumptions rates varied coordinates. shown representative cross-sections inference good estimate rates parameter regime sampled sufﬁciently simulated trajectories. real-world application further assumptions smoothness rate dependence either proper choice position representations explicit smoothness regularization adaptive discretization selected e.g. cross-validation could boost performance inference given limited data. real observations bacterial chemotaxis differentiate deterministic tumble left tumble right states limit fast transitions tumble states tumble states merge single stochastic tumble state bacterium performs directional diffusion. therefore asked coarse-grain framework analytically infer dependency transition rates state compound tumble state directly. appendix show indeed possible moderate assumptions. direct inference two-state coarse-grained model tends give superior performance compared three-state model shown coarse-graining acts implicit regularization integrates parameters three-state model. hand coarse-grained model applicable time-scale separation microscopic details behavioral transitions tumble left tumble right states well information angular velocity states lost poorly constrained data. using coarse-graining deﬁne compound behavioral states stochastic laws motion performing inference corresponding coarse-grained models directly demonstrated chemotaxis example signiﬁcantly expand modeling domain framework. last example show proceed data true model unknown infered models compared using model selection techniques. construct perfect model animal motion; rather goal practical demonstration applicability approach real data. data collected harpaz tracked zebraﬁsh swimming shallow water tank circular shape roughly meter diameter. duration recordings performed replicates minutes sampling rate provides enough data extract basic features motion. figure bacterial chemotaxis. bacteria execute run-and-tumble motion climb chemoattractant gradient starting random position within region. assume following transition rates exp) constants represent strength chemical gradient speed bacterium phase angular velocity bacterium tumble state respectively. transition rate state depends internal angle bacteria response function simplicity take maximal angle antiparallalel determines unobserved location source chemoattractant. individual trajectories run-and-tumble bacterial motion chemical gradient simulated random switching three deterministic behavioral states following dynamics right exact transition log-rates shown three different cross-sections position space transition rates inferred simulated trajectories assuming model three deterministic states. inferred transition rates coarse-grained model bacterial chemotaxis stochastic compound tumble state. regions poorly sampled simulated trajectories shown white. colorscale ranges minimum maximum true log-rates. figure motion circular shallow water tank. characterized position velocity orientation acceleration diagram behavioral state transitions interaction. time window length shows velocity orientation data harpaz trajectory shows alternating regions acceleration deceleration consistent states marked velocity traces accelerating phase shifted initial value sigmoidal functional form. acceleration ﬁtted empirically quadratic function d|v|/dt −a|v| b|v| accelerating window ﬁtted separately shifted rescaled normal form −|v| passive state shows exponential decay velocity friction evident rescaling decelerating trajectories initial value plotting log-linear scale. identiﬁcation states laws motion. basic physical laws dictate natural minimal kinematic variables i.e. position velocity acceleration animal. motion shallow water tank essentially two-dimensional position index that figure shows typical segment trajectory particular highlights repeated ﬂuctuations velocity magnitude consistent ﬁndings harpaz ﬂuctuations generated stereotypical force caused tail beats ﬂips ﬁsh. notice also acceleration event accompanied dynamic adjustment angle measures orientation deceleration phase orientation stays unchanged. data thus indicate individual characterized distinct behavioral states correspond increase decrease velocity ﬁsh. call states either active motion results positive acceleration change orientation passive dynamics caused water friction without active passive deceleration figure indicates exponential decay velocity magnitude passive state. dynamics consistent passive motion exerts force decelerates solely friction. captured dynamical magnitude velocity indicated e-f. here initial exponential increase speed force generated body motion followed saturation frictional dissipation energy. orientation changes active state approximately exponential relaxation target initial value dynamics approximated linear mean-reverting process dynamics obviously differ passive active states formally differ also within active state. dynamics active states fully speciﬁed event-speciﬁc parameters i.e. known. data suggest parameters relatively narrow distributions. principle states parametrized parameters yielding large total number total behavioral states disregard dependence three behavioral states passive active left/right shown figure dynamics would approximated typical values parameters alternatively values generated stochastically suitable distribution. data suggest behavioral states alternate active states separated passive state. inference behavior. identifying three behavioral states laws motion turn attention factors modulate behavioral state transitions. ﬁrst goal identify suitable explanatory variables transition rates. account behavior focal inﬂuence environment also interaction ﬁsh. spend signiﬁcant amount time close proximity tank walls also often swim short distance apart other. reﬂect select following explanatory variables wall distance sign σ|wn|. quantity capture wall distance derived vector leading focal position closest point tank wall. wall distance |wn| provides information proximity wall independent orientation ﬁsh. encode also direction swimming along wall multiply |wn| sign positive/negative swims anticlockwise/clockwise along wall. sign expressed vector product wall direction direction swimming i.e. sgn. mutual alignment ρdnm. interaction depends mutual distance alignment. deﬁne distance between modulated sign distance positive directed angle zero perfectly aligned negative otherwise i.e. sgn. quantity ρdnm measuring alignment between orientation asymmetric quantity i.e. changing reference changes sign magnitude speciﬁed kinematic variables number discretization bins each. approach assume particular decomposition rates unlike no-interaction terms interaction terms assumed additively exponent transition rates. thus ansatz general synthetic example motion. indices indicate identity focal non-focal respectively summation goes perceived stimuli captured kinematic variables functions position focal non-focal ﬁsh. basis functions chosen tiling functions joint -dimensional space single-ﬁsh position coordinates also pairwise-interaction term. summary consider three explanatory variables evaluate importance variables systematically construct hierarchy seven models picking different combinations independent variables inferred rates model shown systematic dependence rates explanatory variables suggests following interpretable behaviors qualitatively consistent previous reports harpaz speed dependence. passive likely transition active state speed active likely transition passive state speed high. ﬁrst statement correlation speed amount time spent passive state since decelerate time. collision avoidance. last columns suggest fast moving active tendency exit current active turning state second travels direction. interpreted mechanism avoiding collision since applies large speeds only depend distance wall. wall asymmetry. passive within body lengths wall tends turn direction avoid collision wall. evident contrast intensity rates ﬁrst panels middle swimming right/left wall tend turn right/left. away wall effect vanishes. observe similar effect active ﬁsh. figure transition rates inferred tracked zebraﬁsh data model three explanatory variables. transition types indicated column headings. transition type state rates shown color intensity function mutual distance velocity magnitude wall distance used centers velocity magnitude centers mutual distance wall distance split three bins rates inferred jointly experiments ﬁsh; rates assumed ﬁsh. fish alignment. asymmetry transition rates passive active state alignment ﬁsh. observe large transition rate passive→right similarly large transition rate passive→left implies passive gets recruited neighboring become active align neighbor. probabilistic models amenable systematic model comparison shown evident variable individually largest explanatory power inclusion variables also leads better generalization performance. given data best model complex three-variable model includes self-interaction effects environment interaction ﬁsh. figure model comparison. seven models variables each complexity models variable each) compared terms log-likelihood training testing data. data used split segments containing average state transitions total segments. segments randomly assigned training testing probabilities transition rates inferred training tested testing set. generated total random assignments. bars averages sample sets standard error. introduced novel approach understanding behavior individual animals groups interacting animals. probabilistic model animal behavior combines deterministic dynamics describe motion animals possible behavioral states stochastic switching states. models ﬂexible terms behaviors being tracked terms motions animals execute terms variables inﬂuence behavioral state transitions despite ﬂexibility illustrated several synthetic real examples forward problem inverse problem remain tractable primarily models inherit favorable properties generalized linear models framework. framework therefore opens possibility carry theoretical explorations e.g. collective behavior using forward simulation within model class inference data possible bringing together approaches past interacted rather sparsely. models probabilistic rigorous tools perform inference also select classes models different complexity identify biologically relevant variables modulate animal behavior. ability particular prove attractive biological applications. practical method consist several steps described detail. first laws motion unknown usually case motion animals needs recorded enough sampling rate. second distinct behavioral states interest must identiﬁed every tracked trajectory. third list candidate explanatory variables transition rates behavioral states depend selected. fourth rates decomposed linear combination coefﬁcients inferred position basis functions following rates found solving convex maximum likelihood optimization problem. fifth model selection performed relevant explanatory variables possibly also best choice basis functions. finally look biological interpretation switching rates perform forward simulation inferred model examining changes rates affect emergent animal behaviors. approach contrasted standard approaches postulate constant behavior time. single behavior complex e.g. represent complex computation determine animal’s movement based position neighbors computation usually assumed static time also deterministic. model seen extension standard approach multiple behaviors possibly different other animal stochastically switch between inﬂuenced external internal variables. relevant describing motion space—especially accurately capture abrupt changes velocity direction—there also exist many behaviors interest play physical space extend beyond motion computation. behaviors often consist stereotyped discrete events poorly described continuous averaged response models. proper choice behavioral states model ability capture broad range biological phenomena either level isolated individual moving space interacting within group. experimental trajectories contain measurement noise also ﬁnite resolution minimal sampling frequency practical experiments. sampling frequency large long enough trajectory contains enough information resolve transition rates accurately. however sampling frequency large even transitions captured inference inaccurate resolution integral important understand sampling frequency affects quality inference. test chose interacting ants example simulated stochastic dynamics ﬁxed period time resampled trajectory taking every k-th datapoint consideration. since simulation adaptive time step report average time step throughout full simulation results shown figure compare accuracy inferred transition rates function average sampling step data important note resampling always reduce number observed transitions reduces number data points them. figure accuracy inference sampling frequency. interacting ants simulated according model figure numerical integration dynamical equations uses adaptive time step mean data resampled taking every k-th datapoint purpose error sensitivity analysis. error deﬁned mean difference real inferred coefﬁcient average taken enough data available. error coefﬁcients inferred simulation different sampling rates error coefﬁcients inferred simulation different sampling rates expected inference error grows sampling frequency decreases. phenomenon simply reﬂection decreased number data points? study running sets stochastic simulations different sampling frequencies number datapoints total. done running coarser trajectories longer time time intervals used panel figure shows loss accuracy smaller time coverage density smaller number datapoints figure keeps number datapoints constant thus reﬂecting density data points. despite inference done number data points error still grows time linear rate decrease sampling frequency. study example hybrid system subset behavioral states distinguishable experiment. refer microscopic states whereas states observable macroscopic deﬁnition. ideally want infer rates full model given information macroscopic system. possible assume microscopic states identical i.e. transition microstate given accesible macrostate same. similarly transition macrostate allowed microstate same. idea replace identical microstates summary state macroscopic. however state longer deterministic; laws motion randomly switching laws motion corresponding microstates. thus approach extension hybrid model described section chose tumble-and motion prototype demonstration. tumble left tumble right form great example unobserved internal states clumped together observed tumble state. state contain unobserved microstates transitions states experimentally observable. thus levels tumble model macroscopic level internal states microscopic level microstates tr}. models differ replacing microstates summary tumble state. states follow different laws motion transitions assumed constant i.e. independent position angle first note compute probability realized microscopic path using transition points also compute coarse-grained version using transition points microscopic transition indices macroscopic indices subset coarse-grained expression leads log-likelihood involves transitions among observable states. infer macroscopic rates needs access trajectory tumble state. unobserved stochastic process random transitions left/right motion thus seek statistical description terms probability density function position elapsed time transition tumble state. problem formulated coupled advection-reaction equations probability densities system entered composite tumble state time tumble left right state time respectively angle system form reaction terms capture changes state constant rate advection terms capture change angle motion angular velocity system deﬁned complemented periodic boundary conditions figure shows solution coupled system times function combine density function orientation time short times system carries information entrance angle shorter transitions times give rise positive correlation entrance exit angles. correlation disappears exit distributions become close uniform distributions. figure solution system times parameters used upwind method replaces spatial derivatives using backward forward ﬁnite differences respectively temporal derivative forward difference. method stable observing system’s macroscopic states positions transition times leads statistics obtain statistics needs approximate amount time organism spent domain. calculated list entrance angles tumble state corresponding duration leaving state. event list compute numerically density function angle time spent coarse-grained macrostate entrance value microscopic transition rates proxy much time system spends given ϕ-bin time. note parametric dependence suppressed translational symmetry answer depends parameters thus solution computed once. given values entrance angles macrostate time spent state sample statistics state every dijk chosen time step evaluate composed summands every pair adding contributions time discretized ∆t-sized intervals. function characteristic function results argument true zero otherwise. long enough data sampling bulk part distribution coarse-grained log-likelihood close actual one. practice parameters known. therefore formulate composite log-likelihood including also microscopic parameters maximum function macroscopic parameters appended explore details method readers access implementation matlab part supplemental information. contains examples simpliﬁed motion ants bacteria chemical gradient code contains stochastic simulator motion organisms assuming known transition rates. simulated trajectories used input inference problem transition rates reconstructed. used decomposition signal using tiling functions exclusively. single inference performs optimization bin-by-bin matter multiple interacting ants inference global uses whole trajectories. bacterial chemotaxis section implemented scales microscopic states assumed observable; macroscopic states tumble observed. detail found appendix library minfunc containing l-bfgs method compute optimum loglikelihood since recommended method large parameter unconstrained optimization information theory. obtain good enough approximation transition rates follow numbers sections", "year": "2017"}