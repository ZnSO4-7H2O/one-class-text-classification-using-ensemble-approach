{"title": "Detecting Epistatic Selection with Partially Observed Genotype Data  Using Copula Graphical Models", "tag": "q-bio", "abstract": " Recombinant Inbred Lines derived from divergent parental lines can display extensive segregation distortion and long-range linkage disequilibrium (LD) between distant loci. These genomic signatures are consistent with epistatic selection during inbreeding. Epistatic interactions affect growth and fertility traits or even cause complete lethality. Detecting epistasis is challenging as multiple testing approaches are under-powered and true long-range LD is difficult to distinguish from drift.  Here we develop a method for reconstructing an underlying network of genomic signatures of high-dimensional epistatic selection from multi-locus genotype data. The network captures the conditionally dependent short- and long-range LD structure and thus reveals \"aberrant\" marker-marker associations that are due to epistatic selection rather than gametic linkage. The network estimation relies on penalized Gaussian copula graphical models, which accounts for a large number of markers p and a small number of individuals n.  A multi-core implementation of our algorithm makes it feasible to estimate the graph in high-dimensions also in the presence of significant portions of missing data. We demonstrate the efficiency of the proposed method on simulated datasets as well as on genotyping data in A.thaliana and maize. In addition, we implemented the method in the R package netgwas which is freely available at https://CRAN.R-project.org/package=netgwas. ", "text": "recombinant inbred lines derived divergent parental lines display extensive segregation distortion long-range linkage disequilibrium between distant loci. genomic signatures consistent epistatic selection inbreeding. epistatic interactions aﬀect growth fertility traits even cause complete lethality. detecting epistasis challenging multiple testing approaches under-powered true long-range diﬃcult distinguish drift. develop method reconstructing underlying network genomic signatures high-dimensional epistatic selection multi-locus genotype data. network captures conditionally dependent shortlong-range structure thus reveals aberrant marker-marker associations epistatic selection rather gametic linkage. network estimation relies penalized gaussian copula graphical models accounts large number markers small number individuals multi-core implementation algorithm makes feasible estimate graph high-dimensions also presence signiﬁcant portions missing data. demonstrate eﬃciency proposed method simulated datasets well genotyping data a.thaliana maize. addition implemented method package netgwas freely available https//cran.r-project.org/package=netgwas. recombinant inbred lines study design popular tool studying genetic environmental basis complex traits. become valuable resource biomedical agricultural research. many panels rils exist variety plant animal species. rils typically derived divergent inbred parental strains multi-parental rils recently established thaliana drosophila mouse originating four eight inbred parents construction rils always straightforward fertility even complete lethality lines inbreeding common particularly natural outcrossing species severely bias genotype frequencies advanced inbreeding generations. genomic signatures indicative epistatic selection acted entire networks interacting loci inbreeding combinations parental alleles strongly favored others. recently colom´e-tatch´e johannes studied two-loci epistatic selection rils. however reconstruction multi-loci epistatic selection network received little attention experimentalists. important reason large numbers potentially interacting loci methodologically computationally difﬁcult. intuitive approach problem perform exhaustive genome scan pairs loci show signiﬁcant long-range pair-wise segregation distortion build larger networks overlapping pairs. t¨orj´ek instance employed idea detection possible epistasis testing pairwise segregation distortion. drawback approach hypothesis testing genome-scale heavily underpowered weak long-range undetected especially adjusting multiple testing. furthermore pair-wise tests statistically speaking consistent conditionally independent loci mutually dependent loci therefore lead incorrect signatures. order overcome issues shall argue detection epistatic selection genomes achieved inferring high-dimensional graph conditional dependency relationships among loci. technically requires estimating sparse adjacency matrix large number discrete ordinal marker genotypes number markers exceed number individuals estimated conditional independence graph captures conditionally dependent shortlong-range structure genomes thus provides basis identifying associations distant markers epistatic selection rather gametic linkage. paper introduce eﬃcient method perform estimation. propose regularized latent graphical model involves determining joint probability distribution discrete ordinal variables. genotype data contain information measured markers genome generally coded number paternal maternal alleles instance heterozygous population diploid species. sklar’s theorem shows p-dimensional joint distribution decomposed marginal distributions copula describes dependence structure p-dimensional multivariate random variable various statistical network modeling approaches proposed inferring high-dimensional associations among non-gaussian variables above-mentioned models limitations; ﬁrst methods cannot deal missing data last computationally expensive since inference based bayesian approach. studying conditional relationships ordinal discrete variables complicated since faced challenges. first general dependence structure complicated beyond pairwise dependencies normal variate. second univariate marginal distributions cannot adequately described simple parametric models. handle ﬁrst challenge used gaussian copula; eﬀectively transforming marginal distributions standard gaussian distribution. address second challenge treat marginal distributions nuisance parameters estimate non-parametrically. paper organized follows. section describe genetic background epistatic selection. section explains model introduces gaussian copula graphical model connecting observed marker data underlying latent genotype. addition explain infer conditional dependence relationships multi-loci genome-wide association studies using regularized gaussian copula framework. section investigate performance proposed method terms precision matrix estimation. also compare performance proposed method alternative approaches terms graph recovery. implemented method package netgwas section reveal genomic regions undergoing selection alleles locations said additively eﬀect ﬁrst allele phenotype depend state second allele vice versa. hand epistasis refers interaction alleles diﬀerent loci phenotype. epistasis occurs joint eﬀect particular pair loci diﬀerent would expected additivity. section provide sexual reproduction involves meiosis. meiosis form cell division produces gametes process arms homologous chromosomes recombine involves sequential alignment genetic material maternal paternal chromosomes. result oﬀspring diﬀerent combinations alleles parents. genetic markers regions physically located close together chromosome tendency transmitted together meiosis. tendency called linkage. loci diﬀerent chromosomes linkage assort independently meiosis. statistically speaking genetic linkage means observing dependence markers physically close together chromosome. linkage disequilibrium refers co-inheritance alleles diﬀerent functionally related loci. loci linkage equilibrium means inherited completely independently generation. loci linkage disequilibrium means certain alleles loci inherited together less often would expected chance. actual genetic linkage loci located chromosome. however loci located diﬀerent chromosomes form functional interaction certain combinations alleles loci aﬀect viability potential oﬀspring. recombinant inbred lines typically derived crossing inbred lines followed repeated generations selﬁng sibling mating produce inbred line whose genome mosaic parental lines. instance diploid allele parent labeled labeled generation generation alleles recombine produce diﬀerent genotypes. example inbreeding homozygous genotype locus homozygous genotype locus. crossing produces generation genotype locus. subsequent followed repeated selﬁng results genome obtained oﬀspring mosaic parental allele combinations pure would result genotype locus either b/b. however practice two-way genotype state oﬀspring given loci comes either parent parent small fraction cases parental alleles. instance diploid organism genotype states chromosomal position either deﬁnes heterozygous genotype complete genome consist billions loci many vary individuals population. clearly loci inherited without change generation generation unless mutation occurs. single nucleotide polymorstudies measure thousands snps along genome resulting individual partially ordered vector markers genotype within chromosome markers ordered chromosomes natural ordering. component individual indicates ancestral genotype value marker i.e. either homozygous populations heterozygous diploid populations. genome-wide association studies designed identify genetic variations associated complex trait. gwas typically small number individuals genotyped hundreds thousands snps. markers naturally ordered along genome respect physical positions. nearby loci highly correlated genetic linkage. moreover linkage groups typically correspond chromosomes. figure cartoon representation markers diﬀerent chromosomes belong chromosome belong chromosome conditional independence relationships markers absence epistatic selection words markers diﬀerent chromosomes segregate independently presence epistatic selection. markers epistatic interaction resulting long-range linkage disequilibrium. epistasis typically deﬁned respect explicit phenotype shape comb chicken ﬂower color peas rils phenotype consider however explicit implicit viability particular genetic recombination parental lines results presence absence recombination progeny. construction rils divergent parents certain combinations genotypes function well brought together genome progeny thus resulting sterility fertility even complete lethality lines inbreeding. result recombination distortion within chromosomes shortrange linkage disequilibrium segregation distortion across chromosomes also called long-range linkage disequilibrium thus genomic signatures epistatic selection appear interacting loci inbreeding whereby combinations parental alleles strongly favored others. long recognized detecting genomic signatures highdimensional epistatic selection complex involving multiple loci detection high-dimensional epistatic selection important goal population genetics. propose model detecting genomic signatures high-dimensional epistasis selection inbreeding. meiosis sequential markov process absence epistatic selection genotype represented graphical model conditional independence graph corresponds linear representation chromosome structure however presence epistatic selection conditional independence non-neighboring markers become undone. could result example underlying conditional independence graph shown figure relation true latent values observed variable here corresponding distinct genotype states tetraploid species contain four copies chromosome. next section deﬁne convenient semi-parametric model easily generalized large sets markers. assume known genetic denote genotype individual marker. observations values. genetic set-up number possible distinct genotype states locus instance tetraploid species takes either value homozygous population heterozygous population. copula multivariate cumulative distribution function uniform marginals. sklar’s theorem shows p-dimensional joint distribution decomposed marginal distributions copula. decomposition suggests copula captures dependence structure multivariate data. collection measured genetic markers across genome. genetic marker i.i.d sample values gaussian copula distribution. copulas allow learn marginals separately dependence structure p-variate random variables. proposed copula modeling estimate correlation matrix–the parameter interest–with gaussian copula treat marginals nuisance parameters estimate non-parametrically empirical distribution function precision matrix gaussian copula parameter estimate impose sparsity penalty elements precision matrix using -norm penalty genetically speaking sparsity sensible expect priori small number pairs markers beyond neighbouring markers. penalized log-likelihood function genetic markers written equation still need evaluate following approaches. monte carlo gibbs sampling latent covariance. gibbs sampling technique randomly generate sample number gibbs samples p-variate truncated normal distribution whose boundaries come cut-points implemented package tmvnorm estimate take average individual expectation remark positive deﬁnite matrix probability long matrix probability therefore full rank strictly positive deﬁnite probability one. practice noticed gibbs sampler needs burn-in samples sweeps suﬃcient calculate mean conditional expectation accurately approximation conditional expectation. alternatively eﬃcient approximate estimation algorithm variance elements implementation glasso method optimization multi-core implementation proposed methods speeds computational challenge penalized optimizations performed parallel across available nodes multi-core computer architecture. feature proportionally reduces computational time. performing simulations noticed algorithm converges quickly within iterations. penalized log-likelihood method guarantees probability precision matrix positive deﬁnite. addition method leads sparse estimator precision matrix encodes latent conditional independencies genetic markers. sparsistency refers property parameters zero actually estimated zero probability tending one. grid regularization parameters controls level sparsity precision matrix. since interested graph estimation approach subsample data measure instability edges across subsamples choose whose instability less certain point value however high dimensional settings approach time consuming. alternatively compute various information criteria convergence based observed log-likelihood written figure curves comparing diﬀerent methods recovering true graph data simulated gaussian copula graphical model copula graphical model. method consistency outperforms methods. classical likelihood-based method estimate uncertainty inverting fisher information matrix directly apply penalized likelihood approaches instead compute uncertainty associated estimation precision matrix penalized gaussian copula graphical model non-parametric bootstrap. penalized likelihood bootstrap replicate datasets created sampling replacement samples table comparison performance proposed regularized approximated regularized gibbs sampler nonparanormal skeptic kendall’s nonparanormal normal-score. means f-score sensitivity speciﬁcity replications represented. high value f-score indicator good performance. best model column boldfaced. bootstrap take account uncertainty arising empirical estimation marginals selection tuning parameter. thus mentioned non-parametric bootstrap procedure adequately reﬂects underlying uncertainty estimation procedure proposed epistatic interaction graph. implemented procedure evaluate uncertainty associated estimation epistatic interactions arabidopsis thaliana experiment section study performance proposed method simulation study mimicking small-sized genotyping study involving arabidopsis medium-sized study involving maize. dimension consider diﬀerent scenarios scenario latent variables satisfy multivariate gaussian distribution scenario not. latter consider t-distribution degrees freedom. simulated data obtained diﬀerent scenarios ﬁxed genotype state simulated graphs mimic true underlying epistasis selection network. first partition variables linkage groups within linkage group adjacent markers linked edge genetic linkage. also probability pair non-adjacent markers chromosome given edge. trans-chromosomal edges simulated probability low-dimension case created chromosomes high-dimension case chromosomes. corresponding positive definite precision matrix zero pattern corresponding non-present edges. iteration simulations random precision matrix generated. latent variables simulated either multivariate normal distribution multivariate t-distribution degrees freedom covariance matrix generate random cutoﬀ points uniform distribution. discretize latent space disjoint states. compare proposed method approaches terms performance. also compare model methods terms graph recovery. curves figure show performance diﬀerent graph estimation methods. area curve used measure quality methods recovering true graph. here compare following methods figure shows average false positive true positive rates repeated simulations grid points tuning parameter. figure latent variable satisfy gaussian distribution latent variable nongaussian. figure shows proposed method particularly employing gibbs sampler outperforms nonparanormal approaches. true scenario model misspeciﬁcation i.e. data simulated gaussian copula graphical model case model misspeciﬁcation i.e. data simulated copula graphical model. method combined approximation approach performs somewhat better nonparanormal approaches true model case model misspeciﬁcation. based simulation studies performance npn-tau npn-ns similar absence outliers discussed furthermore measure methods’ performance terms graph accuracy closeness true graph. penalized inference methods pathestimation procedures however practice particular network selected. table computational cost comparison proposed method nonparanormal skeptic method. larger nonparanormal skeptic method faster proposed method. however neither npn-tau npn-ns deal missing values proposed approximation approach developed able deal missing genotypes commonly occur genotype data. interested global true interaction structure individual parameters extended bayesian information criterion particularly appropriate. evaluate accuracy estimated graph compute f-score speciﬁcity numbers true positive true negative false positive false negative values respectively identifying nonzero elements precision matrix. note high values f-score sensitivity speciﬁcity indicate good performance proposed approach given combination however natural trade-oﬀ sensitivity speciﬁcity focus particularly score evaluate performance method. simulated dataset apply four methods. table compare four methods low-dimensional case mimicking arabidopsis dataset consider later high-dimensional case mimicking maize genotype data. scenario latent variable satisﬁes gaussian distribution scenario overdispersed according report average values -score independent simulations. value oracle indicates best values obtained selecting best tuning parameter optimization. table shows proposed method either using gibbs sampling approximation method within performs well selecting best graph. scenarios dimension case npn-tau chooses better graph compared npn-ns. however high-dimension case neither chooses best graph. fact select empty graph. measurement namely sensitivity indicates true edges recover inferred network. high value speciﬁcity shows zero entries precision matrix i.e. absent edges network accurately identiﬁed. results suggest that though recovering sparse network structure discrete data challenging task proposed approaches perform well. perform computations cluster intel xeon cores processor ram. proposed method possible estimate figure inferred network genotype data cross a.thaliana accessions columbia- cape verde island color corresponds diﬀerent chromosomes thaliana. nodes similar colors belong chromosome. diﬀerent edge colors show positive negative partial correlations. represents zero pattern partial correlation matrix. recommended excessive computational costs. however approximation approach able handle situations. computational costs nonparanormal skeptic normal-score methods similar other. thus table report computational cost proposed approximation method non-paranormal skeptic method versus number variables sample size ﬁxed methods roughly similar increase computational time seems larger quadratic method roughly constant factor slower nonparanormal skeptic. iterations. advantages however method able deal missing genotype values common practice. however programming multi-core signiﬁcantly reduced computational costs. improvement achieved programming interfacing apply proposed gibbs sampling approach detect epistatic selection arabidopsis thaliana genotype data derived cross columbia- cape verde island individual plants genocol- cvi- deﬁnes heterozygous genotype markers missing genotypes results analysis presented figure ﬁrst thing note gaussian copula graphical model groups together markers belong chromosome genetic linkage. diagonal figure chromosomes arabidopsis clearly identiﬁable. linkage disequilibrium markers diﬀerent chromosomes segregate independently; words conditional dependence relationships markers diﬀerent chromosomes. existence trans-chromosomal conditional dependencies reveal genomic signatures epistatic selection. figure shows method ﬁnds trans-chromosomal regions interact. particular bottom chromosome chromosome segregate independently other. beside this interactions tops chromosomes involve pairs loci also segregate independently. genotype studied extensively bikard reported ﬁrst interaction found causes arrested embryo development resulting seed abortion whereas latter interaction causes root growth impairment. furthermore addition regions discovered transchromosomal interactions arabidopsis thaliana genome. particular bottom chromosome sign conditional correlation score negative indicating strong negative epistatic selection inbreeding. markers therefore seem evolutionarily favored come diﬀerent grandparents. suggests positive eﬀect interbreeding parental lines could paternal-maternal combination loci protects underlying disorder actively enhances ﬁtness resulting progeny. estimated covariance matrix calculated either gibbs sampling approximation approaches sections table shows well proposed model a.thaliana data. test degrees freedom gives p-value indicating proposed model data adequately. non-parametric bootstrapping approach determine uncertainty associated estimated edges precision matrix a.thaliana. generate independent bootstrap samples described section genotype data col- cvi- cross. bootstrap samples apply proposed gaussian copula graphical model described section furthermore calculate frequency entry sign report corresponding relative frequencies sign match link across bootstrap samples. figure shows uncertainty associated epistatic interactions markers chromosomes particular bootstrap samples infer positive epistatic interaction markers also neighboring markers interact epistatically. another region a.thaliana genome contains epistatic interactions chromosomes figure uncertainty associated estimation precision matrix a.thaliana using nonparametric bootstrap. oﬀ-diagonal elements represent probability positive negative epistatic interactions markers diﬀerent chromosomes bootstrap versions data whereas thick diagonal elements show relative frequency links neighboring markers within chromosomes bootstrapped data. bootstrap samples infer positive epistatic interaction markers including neighboring markers. bikard show regions cause arrested embryo development root growth impairment a.thaliana respectively. addition conﬁrmed regions found trans-chromosomal regions potential epistatic interactions. example neighboring markers chromosomes namely quite consistent negative epistatic interactions neighboring markers chromosome namely nested association mapping initiative maize populations designed reveal genetic structure underlying complex traits maize part study inbred maize line crossed reference line. genotype data contains markers interact epistatically lead maize disease e.g. growth impairments lower fertility sterility. exploring genomic signatures high-dimensional epistatic selection left unexplored previous analyses essential crop. figure shows certain loci diﬀerent chromosomes segregate independently other. instance marker chromosome interacts markers chromosome marker chromosome interacts three adjacent markers chromosome existence trans-chromosomal conditional dependencies indicates marker-marker associations possibly epistatic selection. statistically speaking conditional dependence relationships physically unlinked pairs genetic regions contribute disorders crop epistatic selection involves simultaneous selection combinations genotypes loci. epistatic selection create linkage disequilibrium loci within across chromosomes. distortions point genomic regions undergoing selection. epistasis widespread often undetected lack statistical power testing multiple hypotheses possibly high-dimensional setting experimental challenges large sample sizes required order detect signiﬁcant interactions computational challenges relate dealing missing genotypes large number tests evaluated. paper introduced eﬃcient alternative method based gaussian copula graphical models models phenomenon epistasis sparsely highdimensional setting. important remember model simplest possible multivariate ordinal model uses least number parameters symmetric diagonal constrained describe full multivariate dependence structure. proposed method handle missing genotype values captures conditional dependent shortlong-range structure genomes thus reveals aberrant marker-marker associations epistatic selection rather gametic linkage. polygenic selection loci additively easily detected basis strong allele-frequency distortions individual loci. epistatic selection contrast produce strong locus-speciﬁc distortion eﬀects instead leads pair-wise allele frequency changes. proposed method explores conditional dependencies among large numbers genetic loci genome. obtain sparse representation high-dimensional genetic epistatic network implement penalized likelihood approach. extensions gaussian graphical models also proposed. vogel fried extend gaussian graphical models elliptical graphical models whereas finegold drton provide latent variable interpretation generalized partial correlation graph multivariate t-distributions. also employ em-type algorithm ﬁtting model high dimensional data. application method arabidopsis discovered regions interact epistatically prior shown cause arrested embryo development root growth impairments. addition employed method reveal genomic regions maize also segregate independently lead lower fertility sterility complete lethality maize diseases. although arabidopsis thaliana maize diploid species nothing method limited diploids. triploid species seedless watermelons even degibbs sampler samples accepted except obtained burn-in period. many iterations need discarded perform heidelberger-welch test convergence test cramer-von-mises statistic used test null hypothesis sampled values derived stationary distribution. first test performed whole chain ﬁrst chain either null hypothesis accepted chain discarded. output test either failure meaning longer iteration needed pass reports number iterations needed discarded. implementation method took burn-in samples order generate randomly truncated normal distribution. show amount burn-in period suﬃcient. example apply test arabidopsis genotype data check number needed burn-in samples calculate conditional expectation. table shows many variables need iteration pass stationary test. variables need either iterations pass stationary test. furthermore compare derived pvalues test randomly generated values uniform distribution table figure conclude need many burn-in samples; ﬁxing suﬃcient. furthermore address suﬃcient number samples needed calculate mean expectation. address issue simulations real data implementation study autocorrelation samples within variable. figure show results autoregressive plot ﬁrst variables a.thaliana genotype data. figure shows obtained samples variable almost independent. thus need samples calculate mean expectation.", "year": "2017"}