{"title": "Distortion Distribution of Neural Spike Train Sequence Matching with  Optogenetics", "tag": "q-bio", "abstract": " This paper uses a simple optogenetic model to compare the timing distortion between a randomly-generated target spike sequence and an externally-stimulated neuron spike sequence. Optogenetics is an emerging field of neuroscience where neurons are genetically modified to express light-sensitive receptors that enable external control over when the neurons fire. Given the prominence of neuronal signaling within the brain and throughout the body, optogenetics has significant potential to improve the understanding of the nervous system and to develop treatments for neurological diseases. This paper primarily considers two different distortion measures. The first measure is the delay in externally-stimulated spikes. The second measure is the root mean square error between the filtered outputs of the target and stimulated spike sequences. The mean and the distribution of the distortion is derived in closed form when the target sequence generation rate is sufficiently low. All derived results are supported with simulations. This work is a step towards an analytical model to predict whether different spike trains were observed from the same stimulus, and the broader goal of understanding the quantity and reliability of information that can be carried by neurons. ", "text": "help improve understanding nervous system develop treatments neurological diseases. prominent example emerging ﬁeld optogenetics; optogenetics uses relatively simple genetic modiﬁcation induce neuron express light-sensitive receptors membrane. light-gated receptors used adjust current across membrane enables light source alter membrane’s electrical potential control ﬁres. experiments identiﬁed opsin-based receptors channelrhodopsin particularly suitable optogenetic studies simplicity compatibility implanting living animals ﬁrst demonstrated worm elegans communication perspective nanoscale stimulators proposed control neurons interface neural network. proposed stimulators could implemented using optogenetics implanted long term use. generally notion precise neural control raises questions quantity reliability information carried using neurons. information-theoretic analysis single receptor showed remarkable capability receive information. however information propagated neurons typically observed pulses behavior individual receptors. researchers typically measure number timing ﬁred pulses spikes; importance timing demonstrated neural spike timing patterns songbirds manipulated millisecond-scale variations control respiratory behavior. described timing spikes need perfect carry information correctly; external stimulus result timing patterns different neurons. experimental data showed timing patterns individual spikes deviated tens milliseconds. furthermore spike timing patterns change propagate along connected neurons; interested statistical modeling deviations spike sequences assess likely different sequences carrying information. ﬁrst step paper measure effectively could externally stimulate spike train match desired target spike train. consideration optogenetics model ideal neuron charged light source integrate-andﬁre model described although integrate-and-ﬁre neuron model realistic robust models reviewed good starting point simplicity lends analytical tractability. adapt metrics-based approach natural responses external stimuli compare target generated abstract—objective paper uses simple optogenetic model compare timing distortion randomlygenerated target spike sequence externally-stimulated neuron spike sequence. optogenetics emerging ﬁeld neuroscience neurons genetically modiﬁed express light-sensitive receptors enable external control neurons ﬁre. methods different measures studied measure timing distortion. ﬁrst measure delay externally-stimulated spikes. second measure root mean square error ﬁltered outputs target stimulated spike sequences. results mean distribution distortion derived closed form target sequence generation rate sufﬁciently low. derived results veriﬁed simulations. conclusion proposed model distortion measures used measure deviation neuron spike sequences prescribed achieved external stimulation. signiﬁcance given prominence neuronal signaling within brain throughout body optogenetics signiﬁcant potential improve understanding nervous system develop treatments neurological diseases. work step towards analytical model predict whether different spike trains observed external stimulus broader goal understanding quantity reliability information carried neurons. nervous system complex system human body understanding considered biggest challenges biology; neural network creates connections within brain controls bodily functions muscle contraction. transfer information entirely internal; sensory neurons retina generate propagate signals response external stimuli. manuscript received august revised february accepted march preliminary version work presented ieee globecom work supported part natural sciences engineering research council canada postdoctoral fellowship. asterisk indicates corresponding author. process receptor opening stochastic detailed analytical models assume overall current equal expected plateau value light order more; assumption appropriate number receptors neuron sufﬁciently large. neuron uses integrate-and-ﬁre model capacitance threshold typical parameter values integrate-and-ﬁre model provides analytical simplicity expense ﬁdelity. alternative models including reviewed capture membrane potential dynamics greater detail e.g. modeling refractory period neuron ﬁres. continuous time minimum ﬁring time tmin nmin∆t order less using aforementioned parameter values. analytical convenience apply continuous time model analyzing delay-based distortion section discrete time model analyzing ﬁlter-based distortion section based assumptions model follows represent neuron potential function time. assumptions light neuron behaves ideal capacitive circuit current ion. thus light time change potential future work could also consider optical wavelengths used; opsins different excitation spectra identiﬁed could used create orthogonal signaling channels; sequences measuring distance them. context work distance sequences distortion train generate target train. practice certain distortion metric threshold distortion exist pertinent information spike train recovered i.e. nonzero level distortion acceptable. consider generation spike train sensory neuron; model propagation spikes along neuron re-generation adjacent neurons. recent works directions include respectively. since different ways encode information spike train sequence interested studying different types distortion metrics. however facilitate statistical analysis assume timing spikes target spike train memoryless process i.e. homogeneous poisson process continuous time. spike trains modeled compared homogeneous poisson processes spike trains also modeled non-homogeneous poisson processes arrival rate time-varying focus homogeneous poisson process ease analysis. perspective make following contributions study classes distortion metrics. first consider simple delay-based metric measure delay individual spike total delay entire target spike train. second consider ﬁlter-based metrics measure timing distortion norm ﬁltered output target generated sequences. focus root mean square error norm) derive distortion target spike train. derive mean distribution distortion assumptions memoryless target spike timing target spike generation rate. analytically derive distribution delay individual spike rmse ﬁlter tap. normal approximations distributions cumulative delay rmse ﬁlter taps. verify derivations comparing analytical results simulated spike train sequences. generally derivations accurate target spike generation rate relative charging time. work extends preliminary results presented measured rmse distortion expected value ﬁlters taps. consider arbitrary ﬁnite number ﬁlter taps delay distortion distortion distributions paper. rest paper organized follows. section describes neuron ﬁring model. analyze delay distortion metric section iii. analyze ﬁlter-based distortion metrics section verify derivations simulations section conclude work section fig. example target sequence matching discrete time generated sequence constrained charging time nmin slots. slots labeled chronologically colored spike start slot. target sequence pulses generated sequence match ﬁrst pulses ﬁnal pulses delay slot. goal paper measure distance sequence sequence subject distance distortion measure obviously spikes separated least nmin slots tmin seconds generate make formulation general possible always precisely describe generate usually assume write ﬁring time spike max{ui nmin} discrete time sequences length replace nmin tmin continuous time. initial spike always alternative approach deﬁning would consider candidate sequence wn}. sequences necessary sufﬁcient condition spikes separated least tmin nmin could optimize ﬁnding closest sequence i.e. section assume measure distortion delay target spikes corresponding generated spikes thus distortion increases linearly delay. distortion spike fig. illustration neuron model integrate-and-ﬁre. example nmin i.e. spikes must separated least interval light source voltage increases threshold reached neuron ﬁres resets even though model hold charge indeﬁnitely unrealistic feature critical paper stimulate neuron continuously resting potential ﬁres. light source finally since nmin∆v light must nmin slots order neuron ﬁre. depicted fig. analogously continuous time light must tmin seconds neuron ﬁre. work interested using light source generate train spikes match target sequence given constrained time neuron charge ﬁre. matching problem demonstrated fig. assume target spike train deﬁne timing individual spikes i.e. time slot spike ﬁres. without loss generality ﬁring times nondecreasing order. assume known priori. able generate perfectly instead light source generate sequence vn}. constraint neuron ﬁring times consider time needed neuron charge threshold voltage since known priori turn light source begin charging neuron corresponding target ﬁring time. long given target spike occurs least nmin slots previous spike generate corresponding spike precise target time. thus sequence maximum spike generation frequency whose period greater tmin generate sequence perfectly. simpliﬁed ideal generation model facilitates tractable analysis paper. unable generate target sequence perfectly imply physically unrealizable contain biologically relevant information. speed charge neuron function overall current constrained intensity light source number light-sensitive receptors; furthermore common neurons multiplex signals multiple input neurons ﬁrst consider delay associated individual spike then derive total delay. assume spikes target sequence follow poisson process continuous time constant rate target generation rate sufﬁciently delay generating current pulse function generation time immediately previous pulse. thus target pulses within time interval length tmin range delay spike approximated time separating consecutive target pulses ui−ui− exponential random variable mean /λt. e{·} expectation accounts fact tmin approximation remaining equations section comes assumption small. properties conditional expectation integration parts write assumptions write distribution properties conditional expectation exponential random variables shown cumulative distribution function distortion distribution total delay readily tractable distribution single spike. assume delays independent delays still combinatorial problem piecemeal behavior delay’s distribution instead convenient consider normal approximation assume independent delays number spikes sufﬁciently large apply central limit theorem. first need second moment single spike’s delay i.e. section present ﬁlter-based metric model comparing spike trains apply measure norm timing distortion target sequence generated sequence tractability discrete time model. focus rmse timing derive mean distribution distortion ﬁnite ﬁlter lengths. label terms comprise energy terms describe energy ﬁltered sequences. density terms describe proximity individual spikes sequence spikes sequence. overlap measure describes proximity individual spikes spikes shown expected distortion minimized overlap measure maximized i.e. placed constraints forms kernel simpliﬁcation impose generate sequence length target sequence i.e. write timing spike offset generated spike target time. still general generation model sufﬁcient combine sequence energy terms write distortion notion proximity spikes measuring overlap density sequences particularly sensitive length kernel i.e. number ﬁlter taps. explore further consider kernel length discrete time slot generalizing ﬁnite length ﬁlter. furthermore assume spike times target sequence unique practical given also assume target spike generation rate. delay distortion rather simple metric distinguish pairs spike sequences. example delay distortion increases linearly length delay. enable discretion measure distortion consider ﬁlter-based metrics presented metrics spike trains onto vector space functions ﬁlter kernel choose kernel. length structure kernel controls sensitivity distortion metric. also presented edit distance metrics operations convert spike sequence other. additional alternatives include pairwise correlation hunter-milton similarity event synchronization stochastic event synchrony summarized focus ﬁlter-based metrics performance experimental data analytical tractability. begin mapping spike trains onto vector space functions. discrete time model norm distortion ease analysis interested kernels ﬁnite number taps. kernels considered include gaussian ﬁlter exponential ﬁlter outside scope work. exponential ﬁlter also used shown stimuli could classiﬁed reasonable accuracy even though average rmse sequences stimulus dozens spikes could high focus analyzing norm i.e. euclidean distance root mean square error sequences vector space sensitive timing individual spikes distortion written know sufﬁcient separation current previous target spikes i.e. nmin. analogy poisson process continuous time assume number slots separating consecutive target spikes follows geometric distribution probability also assume small since assumed earlier target sequence sparse. thus estimate probability approximation assumption probability bernoulli random variable success probability nmin−. furthermore number target spikes generate delay binomial random variable trials value using properties functions random variables write expected distortion degree overlap within sequence occur pair spikes cannot simplify exact expression distortion without approximations. assume target sequence sufﬁciently sparse overlap occur consecutive spikes i.e. spike overlap spike target density term must i.e. partial overlap ﬁltered spikes sequence. every spike either perfectly matches misses target spike; partial overlap sequences possible. relative kernel lengths overlap term minimized. perspective matching distortion measure discards every generated spike align perfectly target spike. true. form readily evaluate given speciﬁc target sequence offset sequence am}. emphasize makes assumptions offset value accounts generated spikes align target spike however neuron must re-charged every spike generation thus indicator function true value every value consider distribution distortion measure tractability make additional assumptions target sequence offset sequence. impose offset must delay i.e. ﬁring times follow also assume target sequence sparse spikes within interval nmin slots nmin minimum number slots spikes thus depend values corresponding never waiting generate spike time. imposing assumptions generated spike occurs time target spike must intended target approximate distortion imposed must non-negative consider recent case could satisfy indicator function would ai−. however nmin timing spikes violates assumption target spikes within interval nmin slots. consequently need look cases leads approximate expected distortion. difference case must determine joint dependent binomial random variables derive joint using multiplicative rule joint probabilities i.e. binomial trials success probability given knowledge fewer trials success probability increases generally given knowledge xi−} trials success probability however given knowledge xl−} value depend relative values ﬁlter length minimum charging time nmin. trials success probability nmin−l. expected distortion written located following page. nmin precisely known since already know number spikes separated less minimum charging time write spikes separated slots. analogous expression written density consecutive spikes generated sequence though applies kernel length longer minimum charging time i.e. nmin. furthermore sparsity assumption assuming generation model slots overlap ﬁltered sequences spike generated time corresponding target delay i.e. finally also repeat assumption number slots separating consecutive target spikes follows geometric distribution probability applying assumptions leads spikes generated sequence separated tractability statistical analysis useful assume i.e. ignore density generated sequence assumption enables simplify unlike case cannot readily write distribution distortion analytically tractable form. however determine expected value normal approximation distribution. write expected value need consider random variables. random variables form number target spikes slots previous spike i.e. expected distortion simpliﬁes expression shown following page. evaluations combinatorial complexity dependent length ﬁlter need account combinations partial overlap pairs consecutive target spikes simplifying special case consider ﬁlter length whose mean considered case assumptions always true consecutive target spikes overlap nmin density generated sequence furthermore nmin unless nmin write number target spikes immediately uses fewer approximations case general expected distortion approximate distribution distortion normal approximation need identify variance also evaluate using second moment distortion found evaluating removing square root. square expected distortion found squaring writing distortion random variable value form normal approximation total delay distortion comparison demonstrates increase complexity partial overlap ﬁltered spikes. approach suitable inﬁnitelylong kernels. asymptotic analysis discrete model becomes continuous time slot goes interest nevertheless. leave considerations future work. sections generate target sequences poisson process continuous time geometric process discrete time. make time models analogous discrete time slots length consider target spike probability every slot. since ∆tλt corresponds target spike generation rate range simulations average distortion averaged sequences simulated distortion generated simulating sequences. conﬁrmed numbers realizations sufﬁcient conﬁdence intervals much smaller displayed marker size clarity plot conﬁdence intervals. unless otherwise noted consider minimum charging time tmin within range values discussed section also comparable typical neuron refractory period; plot average delay distortion fig. log-log scale function target sequence generation rate plot delay pulse total delay sequence pulses. simulated distortion found evaluating pulse. difference individual total delay average total delay times greater individual delay expected analytical distortion delay individual spikes cumulative delay plotted fig. calculated using closed form expressions given respectively. observe analytical expressions fig. average delay distortion function target generation rate target sequence length spikes minimum time must wait generating another spike tmin total delay given sequence individual delays. fig. distribution delay distortion different values target generation rate target sequence length spikes minimum time must wait generating another spike tmin accurate i.e. assuming generation rate valid. within range average delay increases linearly probability pulses within interval tmin becomes non-negligible delay given spike likely depend timing multiple previous spikes. thus expected delays assume single spike’s delay within lower bounds become less accurate increases. asymptotically shown average simulated delay individual spike approach tminm/ similarly expected delay individual spike approaches tmin plot versus delay distortion fig. selection target generation rates expected distribution single spike’s delay calculated using cumulative delay calculated using unlike fig. observe meaningful difference fig. individual total delays. distribution single spike’s delay relatively narrow high probability delay generation rates considered. however total delays easier distinguish. also observe normal approximation suitable expected total delay part long length target sequence although accuracy limited increases. overall observed charging time places constraint ability generate spikes arbitrary times also ultimately limits amount information neurons carry. general result intuitive delay-based distortion measure presented analytical model enables make predictions distribution distortion. assess ﬁlter-based distortion consider rmse metric norm). combinatorial complexity calculating expected distortion using i.e. reduce target sequence length spikes. ﬁlter consider kronecker delta kernel apply results section iv-c. ﬁlter number taps consider coefﬁcient coefﬁcient weighted equally squares coefﬁcients equal kronecker delta. fig. measure average rmse function target spike generation probability ﬁlter length ﬁlter length methods calculate simulated distortion. true simulated distortion measured using ﬁlters length respectively. approximate simulated distortion using assume sufﬁciently i.e. sparse. expected analytical curves plotted using also assume sparse. observe fig. three curves agree well timing given generated spike primarily depends timing previous spike often spikes within interval nmin slots i.e. spikes occur sufﬁciently often multiple previous spikes affect timing spikes generally leads expected distortion acting lower bound. however high spike generation probabilities i.e. true distortion becomes lower predicted expected curve. many target spikes delayed spikes likely occur time future spikes i.e. examples shown fig. occurrences accounted fig. distribution rmse metric kernel length target ﬁring probabilities considered. target sequence length spikes constrained charging time nmin slots generating spikes bound true distortion side effect longer ﬁlter; non-zero overlap occurs target spike corresponding spike latter generated one-slot delay. imperfect overlap reduces measure distortion calculated using accounted approximate expected distortion. assessed average rmse distortion consider distribution. plot distribution rmse ﬁlter length fig. consider three values target spike generation probability i.e. simulated distortion distributions generated equations used observe average distortion fig. i.e. used measure true approximate distortions respectively. expected calculated using fig. observe good agreement true rmse distribution observed calculated assuming slight deviations true distribution observed larger deviations observed overall accuracy approximations consistent observed average distortion fig. also included distortion cdfs would observe step functions transition corresponding average distortions fig. target sequence becomes deterministic case spike ﬁrst time slots. fig. plots distribution rmse ﬁlter length target generation probabilities simulated distortion distributions generated equations used observe average distortion fig. i.e. used measure true approximate distortions respectively. expected calculated using mean standard deviation calculated using deviations simulated expected distributions larger fig. average rmse function target ﬁring probability time slot ﬁlter kernel length target sequence length spikes constrained charging time nmin slots generating spikes fig. example target sequence matching discrete time target sequence high spike generation probability generated sequence constrained charging time nmin slots. slots labeled chronologically. pulses match ﬁrst pulse spikes slots match future spikes corresponding target spikes. spike slot match target spike. spikes match occur slot shown. derivations approximations spikes must align corresponding spikes asynchronous overlaps lead smaller true distortion saturates thus expected distortion lower bound density regime upper bound high density regime. also note approximate simulated distortion converges expected distortion every spike generated initial overlap corresponding target spike distortion measures maximized value i.e. expected distortion lower bound approximate simulated distortion distortions saturate lower bound accurate converges however unlike case expected distortion upper fig. distribution rmse metric kernel length target ﬁring probabilities considered. target sequence length spikes constrained charging time nmin slots generating spikes fig. average rmse function ﬁlter length target ﬁring probability considered. target sequence length spikes vary charging time tmin. minimum wait times tmin correspond nmin slots. actual simulated decreases increasing whereas approximation increases increasing case result less accuracy average rmse also normal approximation. analogously discussion fig. distortion cdfs would appear step functions corresponding average values fig. consider longer ﬁlter lengths fig. plot average rmse function ﬁlter length different minimum charging times tmin correspond discrete time nmin slots. target ﬁring probability sparse relatively values nmin. expected analytical points calculated using expected points calculated using respectively. actual simulated distortion calculated using approximate simulated distortion calculated using respectively. tmin expected distortion good agreement approximate simulated distortion veriﬁes interestingly observe actual simulated distortion decreases increasing whereas expected approximate simulated distortion increases increasing longer ﬁlter leads greater chance ﬁltered sequences partially overlapping also imposes greater separation pulses sparsity assumption valid. finally fig. measure rmse function target spike generation probability various minimum charging times ﬁlter lengths. speciﬁcally consider charging times tmin correspond nmin slots test ﬁlter lengths facilitate comparison plot true rmse ﬁlter fig. lower target ﬁring probabilities i.e. rmses ﬁlters fig. average observed rmse function target ﬁring probability time slot. vary number nmin slots takes charge neuron consider metric kernels lengths slots. minimum wait times tmin correspond nmin slots. approach length ﬁlter nmin increases. surprising since relative length ﬁlter decreases nmin increases deﬁned square coefﬁcients ﬁlter. range rmse also decreases increasing ﬁlter length observed fig. reason reason expected distortion upper bound observed distortion fig. partial overlap spikes reduces measure distortion partial overlap cannot occur ﬁlter length slot. interestingly nmin beyond rmses ﬁlter lengths become larger ﬁlter length understand partial overlap spikes reduces distortion becomes less likely increasing nmin whereas density increases distortion increases thus rmses ﬁlter lengths continue increase increasing whereas rmse ﬁlter length saturates. ﬁlter-based distortion results give insight importance ﬁlter length. sufﬁciently target spike generation rate longer ﬁlter places less emphasis precise timing spikes. however observation reﬂected simpliﬁed distortion model analytical results work required effectively account dynamics. also delaybased distortion observe impact charging time constraint matching target sequences. paper used simple optogenetic model externally stimulating neuron generating spike trains. given constraint neuron’s charging time measured distortion spike train target train. measured distortion either delay generating spike ﬁltered train’s rmse ﬁltered target sequence. derived mean distribution distortion assumption spike generation rate target sequence sufﬁciently low. preliminary work understand information carried externally-generated sequence neuron pulses. seek model well pulse sequences sufﬁciently small deviations carry information. example experimental neuron ﬁring data appropriate distortion measure distortion threshold might become able predict likelihood given neuron pulse sequences response stimulus. also number opportunities expand analysis. example adopt biologically plausible membrane potential models including reviewed realistic optogenetic models consider alternative metrics compare sequences reviewed analysis considered stimulation sensory neuron approach comparing sequences could also applied study propagation spikes either along neuron neurons. nagel ollig fuhrmann kateriya musti bamberg hegemann channelrhodopsin- light-gated proton channel green algae science vol. jun. nagel szellas huhn kateriya adeishvili berthold ollig hegemann bamberg channelrhodopsin- directly light-gated cation-selective membrane channel. proc. natl. acad. sci. u.s.a vol. nov. nagel brauner liewald adeishvili bamberg gottschalk light activation channelrhodopsin- excitable cells caenorhabditis elegans triggers rapid behavioral responses curr. biol. vol. dec. balasubramaniam boyle della-chiesa walsh mardinoglu botvich prina-mello development artiﬁcial neuronal networks molecular communication nano commun. net. vol. jun. klapoetke murata pulver birdseybenson morimoto chuong carpenter tian wang zhang chow surek melkonian jayaraman constantine-paton k.-s. wong boyden independent optical excitation distinct neural populations nat. methods vol. feb. proakis digital communications mcgraw-hill dauwels vialatte weber cichocki similarity measures spike trains proc. iconip nov. ross introduction probability statistics engineers abramowitz stegun handbook mathematical functions formulas graphs mathematical tables united states department commerce national bureau standards", "year": "2017"}