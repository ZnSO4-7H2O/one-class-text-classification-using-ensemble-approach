{"title": "Network reconstruction from infection cascades", "tag": "q-bio", "abstract": " Accessing the network through which a propagation dynamics diffuse is essential for understanding and controlling it. In a few cases, such information is available through direct experiments or thanks to the very nature of propagation data. In a majority of cases however, available information about the network is indirect and comes from partial observations of the dynamics, rendering the network reconstruction a fundamental inverse problem. Here we show that it is possible to reconstruct the whole structure of an interaction network and to simultaneously infer the complete time course of activation spreading, relying just on single epoch (i.e. snapshot) or time-scattered observations of a small number of activity cascades. The method that we present is built on a Belief Propagation approximation, that has shown impressive accuracy in a wide variety of relevant cases, and is able to infer interactions in presence of incomplete time-series data by providing a detailed modeling of the posterior distribution of trajectories conditioned to the observations. Furthermore, we show by experiments that the information content of full cascades is relatively smaller than that of sparse observations or single snapshots. ", "text": "accessing network propagation dynamics diﬀuse essential understanding controlling cases information available direct experiments thanks nature propagation data. majority cases however available information network indirect comes partial observations dynamics rendering network reconstruction fundamental inverse problem. show possible reconstruct whole structure interaction network simultaneously infer complete time course activation spreading relying single epoch time-scattered observations small number activity cascades. method present built belief propagation approximation shown impressive accuracy wide variety relevant cases able infer interactions presence incomplete time-series data providing detailed modeling posterior distribution trajectories conditioned observations. furthermore show experiments information content full cascades relatively smaller sparse observations single snapshots. much eﬀort devoted recently inverse problem reconstructing topology network time series dynamical process acting methods proposed literature heavily rely complete knowledge dynamical trajectories spreading process. certain cases information timeseries process available problem been cast relatively simple terms since sequence time-consecutive states pair nodes gives direct information potential interaction them. many cases however available observations much sparser possibly much slower timescale dynamics often skipping initial stages propagation would give precious information initial condition. particular observation consisting single snapshot system direct information interaction nodes evidence interaction indeed comes variation state nodes time. take example second messenger cascades cell suppose experimenter access expression proﬁle huge number proteins diﬀerent cascades. monitoring exact time course concentration protein currently challenging unfeasible observes concerted downregulation number proteins naturally follow complex time course network reciprocal protein-protein interactions. confronted similar information shortage context epidemic spreading network individuals information ﬁrst contract disease little known underlying networks contacts individuals even dynamically changing time. even though direct experimental data contact networks diverse contexts collected fast rate strong experimental technical limitations collection sometimes privacy protection regulations concerns. however knowledge propagation networks would large list beneﬁts. first allow understand propagation process better including ﬁnding entry-points ongoing epidemic. second allow devise strategies control process various ways example hindering propagation favoring respect number computational studies introduced optimization methods based message-passing address problem containing maximizing spreading series based naive bayes approach eﬃcient computations based dynamic message-passing equations compressed sensing schemes genetic dynamic programming algorithms tensor decomposition monte carlo sampling methods share need observations consecutive epochs. despite recent progress contexts available observations cascade sparse noisy discontinuous time. situations none methods proposed literature applied. example problem inferring functional contacts signaling pathways interacting proteins generate cascades phosphorilation eventually transmit signals cell membrane nucleus. observations come general gene expression data network inferred subnetwork large-scale proteinprotein interaction network also known interactome. although several experimental computational approaches able identify candidate links networks lack distinguishing false positive true positive links seems challenging task. social science epidemiology oﬀer another interesting domain application generally tries infer network social contacts limited amount sparse noisy observations propagation histories. present bayesian technique allows uncover complete functional structure network limited amount single snapshots state network cascades. starting functional parametrization posterior probability distribution propagation trajectories technique builds message passing procedure allows compute maximize likelihood given network structure. computation performed eﬃciently thanks belief propagation proven exact tree graphs successfully used variety problems general graphs loops. upon convergence parameters allow identify network sources infection cascade great accuracy. method eﬀective progressive propagation models like susceptible-infected susceptible-infected-removed independent cascades variants including models hidden variables called method gradient ascent belief propagation although proposed inference machinery general focus well known susceptible-infectedrecovered model describes diseases infected individuals become immune future infections recovery generally constitutes good model spreading rumor information network interaction dynamics among proteins. minimal model activity propagation network simple node active time ﬁnite probability activate neighbors turn active time active node recover time-step recovery probability recovered individuals sick anymore able infect nodes. result propagation throughout network call cascade. suppose number independent realizations dynamics observed. independent cascades mean realization stochastic process aﬀect dynamics cascades. identical realizations obviously strongly correlated limit applicability method process independent another. prototypical situation complete history propagation available observe number frozen snapshots wave-front activity given time states nodes network assessed reasonable extent accuracy. identify hidden network structure transmission probabilities link. fig. shows cartoon representation problem. reconstructing unknown connectivity structure network inevitably coupled tracing back time entire history spreading process cascade turn results identiﬁcation sources diﬀusion. approach builds computing joint posterior probability distribution cascades compatible observations maximizing likelihood interaction parameters network time. notation consider weighted undirected graph number nodes {λij}ij∈e play role edge-dependent infection probabilities stochastic model also equipped {µi}i∈v site-dependent recovery probabilities. directed graphs allow parameters λji. focusing moment single cascade point time node three possible states susceptible infected recovered/removed state node time cascade represented variable discrete figure cartoon representation network reconstruction problem independent cascades starting diﬀerent sources represented time ﬂowing downward. infected nodes susceptible nodes blue recovered nodes purple. gabp algorithm provided snapshots taken time steps cascade onset goal reconstruct functional interactions network well identify source cascade. set. time step stochastic dynamics infected node ﬁrst spread disease susceptible neighbor given probability recover probability cascade deﬁned vectors labeling cascade assume cascade initial state composed infected node nodes network susceptible state. assume access state nodes networks steps initiation cascade. consider node gets infected infection time since ﬁnite probability pass disease neighbor time step results stochastic transmission delay sij. addition individual recovers time stochastic recovery delay. owing irreversibility spreading process cascade fully speciﬁed quantities gi}i∈v {sij}∈e node link network. possible construct simple static graphical model representation dynamical process cascade grounds following simple observation time given node gets infected depends infection times neighbors infection delays nodes. infection times related deterministic equations constraints encoding infection dynamics involving local quantities node. initial condition stochastic quantities thrown independently distributions infection times given deterministically virtue equation observation exploited series works develop fully bayesian method approximating whole probability distribution time evolution system conditioned observations originally used identify origin epidemic outbreak similar models. method built belief propagation approximation exact tree graphs proven successful general networks loops. underlying network unknown epidemic parameters {λij µi}? maximum likelihood approach needs deﬁne quantity }|{λij} {µi}) namely likelihood epidemic parameters respect observations able maximize relevant parameters. note fully bayesian framework incorporating priori information network topology epidemic parameters straightforward would lead log-prior term log-likelihood obtain logposterior. log-likelihood parameters coincides so-called free-entropy system }|{λij} {µi}) computed consistently approximation method marginal distributions infection times interleaved simple loglikelihood climbing steps gradient ascent scheme leading unique equations solved iteration. setting computation gradient log-likelihood relies local updates involving cavity messages. ultimately information processed locally node. that addition simpliﬁcations entails huge reduction computational time making analysis large-scale networks feasible eﬃciently starts assignment parameters initial fully connected network gets progressively pruned means updates eventually leading reconstructed network strongly resembling real one. start investigating three basic random network structures namely random regular erdos-renyi barabasi-albert scale-free networks impressive level accuracy reached small number observations. network node connected random ﬁxed number neighbors networks whereas graph number neighbors poisson distributed. scale-free networks hand possess power degree distribution known capture ingredients many real networks encountered practical applications ﬁrst step random graph constructed cascades simulated independent realization stochastic process random initial source gabp parameters reach stable value. since goal inference two-fold diﬀerent measures inference performance. cascade nodes network ranked decreasing order respect estimated probability origin observed epidemic ability identify sources spreading easily quantiﬁed rank hand simple method quantifying accuracy network reconstruction receiver operating characteristic curve namely plot true positive rate false positive rate binary classiﬁcation problem. constructing curve present case easy inferred values ranked decreasing order step upward taken link present original graph step rightward link absent area curve good indication discrimination ability areas close signal good discrimination true links existent links. reconstruction performances compared empirical correlations based method. possible couple nodes compute time observation probability edge mutual information node details calculations reported section case parameters construct curves compute areas correlation measures mij. report fig. systematic investigation reconstruction performances gabp three types random networks increasing number cascades parameters infection experiments. values gabp outperforms method areas associated gabp predictions notably greater obtained case graphs notice smaller values areas because values parameters dynamics observe huge epidemies time almost nodes infected recovered. eﬃcient spreading caused presence hubs easily infect good portion network time-step. regime even large value suﬃcient information fully recover true links graphs. true patient high enough enough information conveyed underlying zero network structure gabp able successfully identify true initial spreaders cascade. seen fig. shows distribution value three types random networks considered here fairly concentrated values reconstruction performance expected substantially related density network. investigated systematically varying degree connectivity network shown fig. performance gabp assessed graph size increasing connectivity degree accurate reconstruction denser networks requires consequently larger number cascades seen fig. distribution inferred values true links rapidly separates non-existent ones concentrates around vanishing values even small number observations. strict separation distributions conﬁrms results area curve. figure reconstruction accuracy three types random networks using gabp curve average random instances area curve function number observed cascades time epidemic parameters three type networks. size network blue curve random regular graphs degree curve barabasi-albert networks average degree yellow curve erdos-renyi graphs average degree triangular circular marks show gabp results respectively. identiﬁcation initial spreaders. ﬁlled curve histogram rank true patient zero three types network. histograms refer random instances thus considering total independent cascades. reconstruction accuracy versus connectivity. blue curve area curve diﬀerent instances random regular graphs size increasing degree case cascades observed time recovery rate ﬁxed toµi scaled degree increases order keep size epidemics roughly constant. inset area curve function number observed cascades random regular graph degree figure gabp rapidly identiﬁes true links. average value true links versus existent ones function number observed cascades random regular graph size shaded areas correspond intervals percentile distribution. thin lines represent theλij values random subset links case cascades function iterations gabp algorithm; black thick line area curve. dynamics inferred function iterations algorithm exempliﬁed fig. even small number iterations true links clearly distinguished existent ones seen steep rise area curve function iterations observe kind behavior quite general restricted case tested gabp algorithm diﬀerent real interaction networks information contacts available validation purposes. ﬁrst dataset consists networks twitter retweets networks figure reconstruction performance gabp network retweets increasing number independent cascades epidemic parameters observation time gold curve area curve case state networks fully observed time cascade blue curve area curve case network observed time cascade. inset average value true links versus existent ones function number observed cascades standard case shaded areas correspond intervals percentile distribution. figure pictorial representation gabp performance zachary’s karate club network increasing number cascades edge thrown node node zero width edge proportional value λij. true links colored black links present original network. composed nodes represent twitter users linked edges corresponding retweets average degree node network minimum degree maximum degree figure shows reconstruction performance retweet networks using diﬀerent observation paradigms single-observation-per-cascade paradigm nodes state available cascade whereas wholecascade paradigm nodes observable times. apparent extremely accurate reconstruction achievable number cascade quite small compared |g|. another illustrative example fig. show pictorial representation reconstruction zachary’s karate club network small social network consists nodes edges documenting pairwise interactions course three years among members university-based karate club. case simulated cascades investigated performance inference method homogeneous parameters increasing fig. links present actual graph colored appear clearly distinguished true ones even small values thorough representation reconstruction process karate club network show fig. color intensity plot dynamics inference number cascades increased true links immediately identiﬁed area indicates interesting note that observing cascades entirety clearly conveys information network structure total number observations full state network constrained distributing observations apart time pays better. clearly shown fig. diﬀerence area curve whole cascade scenario single-observation-per-cascade paradigm. figure left reconstruction performance gabp zachary’s karate club network diﬀerent numbers independent cascades. axis. links axis ordered ﬁrst true links original graph. color intensity proportional value putative link increasing values right area curve increasing total observations entire networks blue curve corresponds single ﬁnal observations cascade time gold curve shows case cascades fully observed. challenging problem reconstructing protein-protein interaction networks consists discriminating true positive false positive links. show section gabp algorithm used post-processing method tackle issue. experiments consider ground-truth networks giant components interactomes psicquic dataset available software cytoscape contact cascades synthetically simulated infection parameters true networks α|e| extra edges mimic presence false positive interactions. step performed scale-free fashion ﬁrst pick node probability proportional degree connect randomly uniformly chosen node simulate cascades true network ﬁnal observations infer transmission parameters associated true false positive edges extended graph that diﬀerently cases examined before fully connected graph. compare reconstructions ones obtained based method. fig. plot table containing areas curves function number cascades interaction networks. main ﬁgure corresponds organism columns organisms areas curves gabp results signiﬁcantly larger reconstructions reach values even cascades available i.e. quite surprisingly performances seem independent number extra-edges suggesting method quite robust detecting false positive links extended graph pruned reasonable large number edges. underline performances gabp show fig. musculus interactome containing true positive false positive edges retrieved network increasing number cascades plotted fig. edges thickness proportional inferred values gabp worth noting that cascades gabp able recognize almost true links gabp misclassiﬁes fewer false positive increases gabp detects true edges associated signiﬁcantly increase incorrectly classiﬁes false positive edges that case exhibit values infection parameters close zero negligible compared ones associated links. contrary distributes weights edges large able sharply distinguish sets links edges comparable values links. figure plots areas gabp interactomes predictions. table corresponds studied interactomes column diﬀerent fraction extra edges. subplots show areas curves function number cascades gabp mouse interactome nodes edges ﬁrst shows networks reconstructed gabp thickness edge proportional infection parameters gabp mutual information among couples nodes edges weights smaller shown. brieﬂy consider slightly diﬀerent application general formalism presented far. suppose underlying network structure known little information available transmission probabilities general case inhomogeneous. method easily accommodated provide maximum likelihood estimation quantities λij. starting initial assignment coupling parameters deﬁned known topology seeks ﬁxed point coupled gradient equations using gabp. example consider random regular graph size degree evaluate inference performance increasing number cascades figure shows value mean square error better appreciate presented method allows reconstruct hidden network limited information activity propagations showed reconstruction performance extremely accurate even number snapshot observations small. scheme eﬀectively applied detection false positive links protein-protein interactions networks even number candidate false edges comparable eﬀective number true positive contacts. particular case suﬃces independent cascades correctly classify great majority links. several advantages approach existing ones. main several inference problems treated unique formulation. technique easily extended incorporate eﬀects unreliable observations taking account situations noise enters measurements cases susceptible nodes cannot distinguished recovered ones complete list contact times nodes available construction equivalent network timely dependent infection probability straightforward current approach proven eﬀective. owing generality bayesian method described technique capable dealing wide variety irreversible spreading processes networks. possible simple generalization bootstrap percolation case node gets activated aggregated input neighbors overcome intrinsic stochastic activation threshold node. models widely used describe features dynamical processes neuronal figure reconstructing spreading couplings inhomogeneous networks. mean squared reconstruction error random regular graph size degree function number observed cascades network structure known advance. spreading couplings λtrue extracted randomly homogeneous distribution interval state network observed time cascade. scatter plot reconstructed transmission probabilities versus true spreading couplings λtrue cases corresponding golden green points left plot respectively. ﬁrst consider single cascade network ﬁxed topology. ﬁxed initial conﬁguration realization stochastic process generated drawing randomly infection transmission delay pairs recovery times node recovery times {gi} independent random variables extracted geometric distributions delays {sij} conditionally independent random variables distributed according truncated geometric distribution note concentrate value mass distribution beyond hard cut-oﬀ imposed recovery time. joint probability distribution infection recovery times conditioned initial state easily written note assuming could also rewritten equivalently ski}) introduce observational weights observation together posterior distribution initial states conditioned observations priors priors assumption independence proportional product single probability weights tmgm gm)p taking factors labeled extra cascade index )m=...m. since runs possible pair meaning always work setting fully connected network weights {λij}. number cascades large enough zero elements matrix {λij} signal upon convergence gabp algorithm true links original graph value informative heterogeneity infection probabilities. holds recovery parameters {µi}. note imposes condition meaning ignored eﬀectively pruning link equations. given high dimensional probability distribution locally factorized interaction structure computing marginals aggregated quantities addressed message passing procedure built cavity approximation locally tree-like graphs present problem obtain full marginal probabilities possible cascades compatible observations. proven exact tree graphs successfully employed general loopy graphs mild regularity conditions brieﬂy describe essence method consider probability distribution variables {zi} following factorized form called compatibility function factor. write {zi}i∈∂a variables depends subset indices variables factor accordingly subset factors depend belief propagation equations self-consistent equations so-called cavity messages single-site probability distributions associated directed link graphical model representing terms local partition function serving normalizers. solve equations iterative procedure typically used cavity messages initialized uniform distributions asynchronously updated convergence ﬁxed point introduction). equations thought local update rules messages so-called factor graph bipartite graph term associated factor node connected variable nodes depends naive implementation scheme level equation would simply work since corresponding graphical model loopy structure local global scale. however possible construct disentangled factor graph means re-parametrization cavity messages. provide brief description procedure supplementary methods. thorough discussion refer reader previous works want stress modiﬁed factor graph enriched dual version original graph whence particular appeal method. particular implies belief propagation provides exact bayesian solution underlying network acyclic. computation equation straightforward equation generally involves number steps growing exponentially size eﬃcient implementation equations posterior distribution given supplementary methods. belief propagation converges equation used compute marginal probability brings posterior estimation probability node active time cascade. employ alternating optimization scheme belief belief propagation coupled maximum likelihood strategy implemented gradient ascent method. phase network parameters {λij kept ﬁxed solution searched iteratively equations stage source located independently cascade looking single-site marginals |{xm maximum likelihood phase log-likelihood network parameters maximized means simple gradient ascent procedure. gradient computed eﬃciently approximation. likelihood }|{λij} {µi}) respect network parameters logarithm quantity corresponds negative free energy model expressed local terms depending messages updates distribution equation coupled gradient ascent updates respect network parameter take form small multiplier parameter results presented work obtained interleaving step step simple scheme suﬃces provide good joint estimates patient zero cascade together remarkably good reconstruction underlying network. alternative would consist applying expectation maximization scheme alternatively equations iterated convergence parameters fully optimized ﬁxed messages however step requires maximization high order figure disentangled factor graph representation graphical model. white round nodes correspond variables gray rectangle nodes correspond factors topology disentangled factor graph follows original contact network. polynomial must solved numerically case obtained faster convergence alternating single steps rather alternating full convergence cycles steps. comparison tried reconstruct networks interest using correlation based measures. observation time computed probabilities observing edges mutual information nodes would like factor graph representation maintains topological properties original graph contacts order guarantee exact original contact graph tree. following approach developed previous works proceed disentangle factor graph grouping pairs infection times variable node. convenience keep variable nodes {ti} also introduce edge emerging node copies infection time forced since function messages would argue messages depend model parameters every step algorithm. actually need consider implicit {λij dependence reached ﬁxed point equations satisﬁed messages nothing else lagrange multipliers respect constraint minimization bethe free energy functional present parametrization explicit dependence free energy epidemic parameters factor node terms fa’s involving compatibility functions gradient computed easily. please note formulas show derivative free energy updates log-likelihood diﬀer minus sign. nodes have marcel salathé maria kazandjieva jung philip levis marcus feldman james jones. highresolution human contact network infectious disease transmission. proceedings national academy sciences doi./pnas.. lorenzo isella juliette stehlé alain barrat ciro cattuto jean-françois pinton wouter broeck. what’s crowd? analysis face-to-face behavioral networks. journal theoretical biology february issn doi./j.jtbi.... xiang jiming william cheung tiejun tong. inferring epidemic network topology surveillance data. plos june issn doi./journal.pone.. http//journals. plos.org/plosone/article?id=./journal.pone.. yang chen xia. characterizing discovering spatiotemporal social contact patterns healthcare. ieee transactions pattern analysis machine intelligence august issn doi./tpami... xiang reconstruction stochastic temporal networks diﬀusive arrival times. nature communications june issn doi./ncomms. https//www.nature.com/articles/ ncomms. peer bork lars jensen christian mering arun ramani insuk edward marcotte. protein interaction networks yeast human. current opinion structural biology issn doihttps//doi.org/./j.sbi.... http//www.sciencedirect.com/science/article/pii/ alfonso valencia florencio pazos. computational methods prediction protein interactions. current opinion structural biology issn doihttps//doi.org/./s-x-. http//www.sciencedirect.com/science/article/pii/sx. jingkai farshad fotouhi. computational approaches predicting protein–protein interactions survey. journal medical systems issn doi./s---. https//doi.org/. /s---. fabrizio altarelli alfredo braunstein luca dall’asta alejandro lage-castellanos riccardo zecchina. bayesian inference epidemics networks belief propagation. physical review letters march ./physrevlett... ryan rossi nesreen ahmed. network data repository interactive graph analytics visualization. proceedings twenty-ninth aaai conference artiﬁcial intelligence http//networkrepository.com. issn shannon markiel ozier baliga wang ramage amin schwikowski ideker. osgi alliance cytoscape software environment integrated models biomolecular interaction networks. genome sandra orchard mais ammari bruno aranda lionel breuza leonardo briganti fiona broackes-carter nancy campbell gayatri chavali carol chen noemi toro margaret duesbury marine dumousseau eugenia galeota ursula hinz marta iannuccelli sruthi jagannathan rafael jimenez jyoti khadake astrid lagreid luana licata ruth lovering birgit meldal anna melidoni mila milagros daniele peluso livia perfetto pablo porras arathi raghunath sylvie ricard-blum bernd roechert andre stutz michael tognolli roey gianni cesareni henning hermjakob. mintact project–intact common curation platform molecular interaction databases. nucleic acids research january issn doi./nar/gkt. uniprot consortium. uniprot universal protein knowledgebase. nucleic acids research january issn doi./nar/gkw. https//academic.oup.com/nar/article//d/d/ jonathan yedidia william freeman yair weiss. exploring artiﬁcial intelligence millennium. chapter understanding belief propagation generalizations pages morgan kaufmann publishers inc. francisco isbn ---.", "year": "2016"}