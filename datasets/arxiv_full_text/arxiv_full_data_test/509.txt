{"title": "A variational approach to moment-closure approximations for the kinetics  of biomolecular reaction networks", "tag": "q-bio", "abstract": " Approximate solutions of the chemical master equation and the chemical Fokker-Planck equation are an important tool in the analysis of biomolecular reaction networks. Previous studies have highlighted a number of problems with the moment-closure approach used to obtain such approximations, calling it an ad-hoc method. In this article, we give a new variational derivation of moment-closure equations which provides us with an intuitive understanding of their properties and failure modes and allows us to correct some of these problems. We use mixtures of product-Poisson distributions to obtain a flexible parametric family which solves the commonly observed problem of divergences at low system sizes. We also extend the recently introduced entropic matching approach to arbitrary ansatz distributions and Markov processes, demonstrating that it is a special case of variational moment closure. This provides us with a particularly principled approximation method. Finally, we extend the above approaches to cover the approximation of multi-time joint distributions, resulting in a viable alternative to process-level approximations which are often intractable. ", "text": "approximate solutions chemical master equation chemical fokkerplanck equation important tool analysis biomolecular reaction networks. previous studies highlighted number problems momentclosure approach used obtain approximations calling ad-hoc method. article give variational derivation moment-closure equations provides intuitive understanding properties failure modes allows correct problems. mixtures product-poisson distributions obtain ﬂexible parametric family solves commonly observed problem divergences system sizes. also extend recently introduced entropic matching approach arbitrary ansatz distributions markov processes demonstrating special case variational moment closure. provides particularly principled approximation method. finally extend approaches cover approximation multi-time joint distributions resulting viable alternative process-level approximations often intractable. solution chemical master equation chemical fokker-planck equation chemical reaction network typically obtained closed form numerical approaches computationally infeasible larger systems. established technique obtaining approximate solutions linear noise approximation however assumes suﬃciently large system sizes. biological systems abundance certain chemical species linear noise approximation might become inappropriate. main alternative moment equations combination moment closure method also employed many ﬁelds. moment closure approximations often referred ad-hoc approximations shown exhibit unphysical behavior. another approximation recently proposed relies information-theoretic considerations entropic matching. employs gaussian approximating distribution. article unify extend approaches. provide variational derivation moment closure exhibits principled approximation helps understand failure modes typically observed. also extend entropic matching general markov processes arbitrary approximating distributions show special case variational moment closure. variational moment closure principled approximation subset possible closure schemes justiﬁed hand demonstrate subset suﬀer problems often attributed ad-hoc closure schemes. purpose introduce mixtures independent poisson distributions general useful class closure distributions. hand problems attributed moment closure resolved variational approach however variational interpretation moment closure provide intuitive explanation failure modes. present results context chemical kinetics valid generally approximations markov processes. begin deriving connecting variational moment closure entropic matching section demonstrate methods several examples section iii. section analyze deﬁciencies moment closure also suggest possible solutions. finally section generalize variational moment closure entropic matching approximation multi-time joint distributions. established stochastic process model reaction network taking account discreteness molecule counts continuous-time markov chain. marginal prob describing molecule counts cfpe. derivations presented following notation fact valid markov processes. reason consider cfpe generality also because shall moment-closure scheme used adapted equation considering. derive usual moment closure equations which apart principled clearly shows signiﬁcance. goal approximate solution time member parametric family probability distributions parameter vector ranges open subset since solution depends time full approximate solution given curve thus time-dependence solution contained time-dependence parameters course exact solution general member chosen parametric family require means measuring approximation error order deﬁne sense approximation performed. obtain moment-closure equations done following begin choosing collection moment functions φk). example obtain usual moment equations second order would choose monomial moment functions derive ordinary diﬀerential equation parameter vector this assume time-point approximation solution available. allowing distribution evolve short time using evolution operator markov process result moment-closure equations seen evident derivation ‘greedy’ algorithm parameter vector evolves minimize approximation error inﬁnitesimal time-step irrespective eﬀect might approximation quality later time. property help understand failure modes momentclosure approximations section note diﬀerent variational justiﬁcation moment closure given eyink. ingredients moment-closure approximation thus choice parametric distribution choice moment functions stress space deﬁned adapted markov process investigation. thus considering moment functions ansatz distribution deﬁned section demonstrate least problems usually attributed moment-closure techniques explained failure take account choosing distributional ansatz. purpose article call momentclosure approach seen instance variational moment closure principled. thus moment closure scheme principled ansatz distribution moment functions deﬁned correct state space number moment functions number ansatz distribution parameters equal matrix invertible. approach cannot justiﬁed called principled although course might exist justiﬁcations note also moment closure justiﬁable variational approach provides approximation full solution cfpe. merely provide lower-order moments often asserted ad-hoc moment-closure approximations. derivation make fact probability distribution. thus possible allow take negative values one. using parametric families become negative part state space provides ﬂexibility choosing appropriate ansatz. also note derivation remains valid moment functions depend variational parameters i.e. necessary establish connection entropic matching. case error functions deﬁned using parameter value deriving evolution equation time approach described section ﬂexible provide indication choose ansatz distribution moment functions extend entropic matching approximation method based informationtheoretic considerations arbitrary ansatz distributions processes. entropic matching turns special case variational moment closure provides natural choice moment functions choice distribution relationships various approximations derive following sections depicted graphically fig. idea underlying entropic matching demonstrated derivation moment-closure equations fact inspired entropic matching. diﬀerence lies distance measure used. information-theoretic point view strong arguments using relative entropy general-purpose distance measure distribution approximating distribution follow approach derivation variational moment closure using relative entropy distance measure. approximate solution within parametric family assume that time approximating distribution available speciﬁed parameters small time later distribution given entropic matching proceeds approximating distribution chosen minimize fig. relation general moment closure variational moment closure entropic matching zero-information moment closure. dashed arrows indicate building blocks approximation variational moment closures based choice moment functions choice ansatz distribution entropic matching requires choice ansatz distribution moment closure requires choice moment functions. sense entropic matching moment closure dual other. full arrows indicate type approximation provided approximation method ad-hoc closures provide approximations low-order moments whereas variational moment closures provide approximations full distribution. however ad-hoc closures provide approximations full distributions minimum relative entropy. equations agree. note that general require general form variational moment closure moment functions depend variational parameters also worth noting that although relative entropy nonsymmetric arguments ﬁnal evolution equation parameters would turns appeared literature previously derived directly deﬁning projection using fisher information metric. done context stochastic ﬁltering equations considered generalization markovian evolution equation observations stochastic process included. arguably derivation could considered principled postulate fisher information rather starts minimization relative entropy explained strong arguments. also mention generally context ﬁltering equations moment closure approximations well-known name ‘assumed density ﬁltering’. also interesting connect entropic matching advanced informationtheoretic approximation stochastic processes. instead approximating marginal distributions solution forward equation possible approximate distribution trajectories stochastic process. done minimizing relative entropy approximating stochastic process relative process interest space trajectories. appoach carried number processes– would expect approximation perform better entropic matching. latter understood ‘greedy’ algorithm time point chooses parameters minimize relative entropy inﬁnitesimally later time point taking account later time points. additionally entropic matching produces approximations single-time marginal distributions provide information multi-time correlations. latter deﬁciency addressed section advantage entropic matching requires computations using marginal distributions given variational approximations process level hand presumably tractable small number processes. normalization constant. approach termed zero-information closure. additionally introduced ‘background’ measure useful since inﬁnite state space entropy general replaced relative entropy respect background measure. equation distribution minimum relative entropy note maximization entropy replaced minimization relative entropy relative entropy deﬁned inverse sign. entropic matching moment closure seen somewhat dual other illustrated fig. entropic matching starts choice ansatz distribution supplies natural choice moment functions whereas closure starts choice moment functions supplies natural choice parametric distribution. nevertheless entropic matching generalization closure ﬁrst noticed case stochastic diﬀerential equations. this check entropic matching applied distribution form result equivalent moment closure. variational moment closure produces approximation distribution solution opposed approximations number moments. ad-hoc moment-closure schemes hand usually considered produce approximations moments. explained above well-known method reconstruct full probability distributions moments maximum entropy approach used previously context moment equations. here brieﬂy point approach remains meaningful even variational moment-closure scheme employed. consider reaction network polynomial reaction kinetics assume standard monomial moment functions high-order analogues. choosing variational ansatz moment equations ever require ﬁnite number relations moments certain order. thus distributional ansatz uniquely speciﬁed moment-closure equations derived implies priori clear approximate solution reconstructed variational parameters obtained solution minimum relative entropy provides possible answer. minimum relative entropy distribution form parameters moment equations moment closure mention explicit minimization relative entropy necessary diﬀerential equations parameters minimum relative entropy distribution derived. equations solved simultaneously moment equations section demonstrate approximations derived section several examples. since standard moment equations using monomial moment functions well-known focus cases interesting connections existing approximations established. approximately solve mass-action kinetics entropic matching. product-form ansatz might seem restrictive shown certain class networks actually product-form distributions stationarity. using backwards evolution operator implies macroscopic rate equations meaning even arbitrary system sizes. product-poisson entropic matching instance moment closure however choose non-trivial background measure systems certain molecular species might exist zero copy gene either active inactive state. case analogous result obtained using bernoulli distribution instead poisson distribution species question. recovers ﬁnite state projection algorithm numerical solution ﬁnite subset states. made fact within variational moment closure framework necessarily one. required ﬁnite state projection approach ‘leaks’ probability part state space outside generally moment functions could replaced general basis functions leading galerkin-type approximations. gaussian distributional ansatz however diﬀusion matrix assumed depend state using formula extend result state-dependent diﬀusion matrices beginning fokker-planck equation corresponding stochastic diﬀerential equation details computation provided interesting note result agrees process-level approximation mentioned section however since results obtained using complex form relative entropy involving auxiliary variables clear whether result would also agree proper probabilistic approach using usual real relative entropy. vector write note express entropic matching equations terms modiﬁed coeﬃcients expectations computed respect gaussian distribution parameters even though parameters govern log-normal distribution. employ mass-action kinetics resulting expectations closed form expressions. general ad-hoc moment-closure schemes shown exhibit unphysical properties attempts understand pathologies unsuccessful. section variational interpretation moment closure section analyze moment-closure schemes failure modes. ﬁrst observation recall ﬁnite state projection algorithm shown instance variational moment closure section simple observation important implication moment-closure concept leads unphysical behavior resulting approximation. ﬁnite state projection algorithm mild conditions produce approximation exact solution whose error made arbitrary small. thus ﬂexibility approximating ansatz distribution determines whether moment typical failure mode ad-hoc moment closures divergence solutions especially copy-number regime. order address problem recall that explained section distributional ansatz supported depending whether considers cfpe. diﬃcult achieve cfpe obvious many closure schemes introduced previously cme. might conjecture divergences observed copy numbers might related failure choose ansatz distribution correct support. order investigate this ﬁrst introduce suﬃciently ﬂexible family distributions support following section. approach present allows turn existing closure methods principled closures sense section property makes particularly convenient compare ad-hoc closure methods principled counterparts. exact approximate solution wellknown approach. deﬁne ﬂexible family distributions moment closure. log-normal mixture poisson distributions used within eyink’s variational framework proposed previously motivated using ideas statistical physics. however important realize approach simply moment closure using log-normal-poisson mixture ansatz. distribution previously directly employed moment closure. case example gamma multivariate log-normal distributions since support thus serve mixing distributions. also case implies moment-closure equations using distribution poisson mixture mixing distribution additionally order moments moving closure using poisson–p mixture nounced copy numbers chemical species. indeed many moment-closure schemes known diverge regime. following section empirically demonstrate problem explained failure take account discreteness molecule counts choosing moment-closure scheme. non-centered moments order three system size deﬁned moment closure scheme given specifying third-order moment function ﬁrstsecond-order moments focus three popular ad-hoc closures zero-cumulant closure fig. moment closure predictions mean abundance various system sizes zerocumulant log-normal gamma closures poisson-corrections. solutions given comparison. abundances shown units exact means obtained stochastic simulation algorithm realizations. parameters initial conditions correspond poisson distribution mean moment closures show result applying moment closures system shown fig. without poisson correction ad-hoc closures diverge suﬃciently small system sizes. happen poisson correction. however quality poisson-corrected closures breaks suﬃciently small sizes. ﬁndings support hypothesis verify three ad-hoc closures correspond distributions deﬁned closures deﬁned distributions remember specify relation form might exist distributions relation holds. show extent case. interested following questions given pair conditions exist distribution moments ﬁrst second order? deﬁnes domain moment closure scheme ideally deﬁned. also corresponds domain valid initial conditions moment equations fact often neglected previous studies. assuming correspond distribution addition given conditions exist distribution moments orders three given existence questions type recently answered. obviously distribution degenerate concentrated thus following assume turns real write greatest integer smaller equal fractional part assume holds addition given order exist distribution moments necessary suﬃcient condition proceed apply results three ad-hoc closure schemes presented above. regions satisﬁed satisﬁed) shown fig. zero-cumulant closure inequality constraint satisﬁed pairs region log-normal gamma closures hand pairs region shown satisfy would expect reﬂected behavior moment closures veriﬁed fig. show phase plots moment equations region copy numbers. zero-cumulant closure shows pathological behavior wide range initial conditions whereas log-normal gamma closure well-behaved large sub-domain initial conditions. however even closures unphysical behavior occur. understand this take account equality constraint pairs equality holds investigate extent pathologies removed applying poisson correction. ﬁrst determine whether three ad-hoc closures would compatible distributions play role mixing distributions clear log-normal gamma closures. zerocumulant closure instance truncated stieltjes moment problem check relation compatible distribution long relatively small domain behavior visible fig. compatible ﬁndings poisson-correction remove divergences fig. phase-plot zero-cumulant log-normal gamma closures poisson-corrected versions point moments exact stationary distribution. black point stationary solution moment equations. grey area region shown better visibility trajectories. orange area region violated. area region valid violated. blue area region valid distribution sub-poissonian. white area corresponds valid initial conditions moment equations. poisson-corrected closures green phase curve runs along domain boundary preventing phase curves entering orange region ad-hoc closures. parameters ﬁndings suggest failure choose distributions support adapted moment closure provides good explanation divergences often observed copy-number regime poisson correction prevents happening. observation fig. stationary points poissoncorrected closures show larger error ad-hoc closures. explained fact system stationarity sub-poissonian distribution property cannot realized mixture poisson distributions. this also unphysical behavior equations hand approximation quality hand necessarily correlated. completeness note opposite case distributions heavier tails poisson distribution realized using appropriate mixing distribution. apart divergences important failure modes moment closures. brieﬂy indicate variational derivation moment closures makes failure modes least plausible. mild conditions unique stationary distribution would hope approximation retain property. however observed moment closures posses either multiple stationary states show sustained oscillations thus fail converge stationary state certain initial conditions. however using derivation variational moment closures properties surprising intuitive explanation. since approximations seen ‘greedy’ algorithms choosing best approximation locally inﬁnitesimal time-step guarantee eﬀects lead single stationary distribution captured approximation. thus instance system oscillatory trajectories fact unique stationary distribution exists consequence fact diﬀerent trajectories stay phase time progresses. approximation performed inﬁnitesimal time-step however eﬀect necessarily captured. section extend variational moment closure entropic matching multi-time joint distributions investigate conditions resulting approximation self-consistent single-time approximations derived section variational derivation moment-closure approximations extended approximation joint probability distributions multiple time points. focus two-time joint distributions although approach extends higher-order joint distributions. initial time-point consider two-time joint distribution order derive variational want obtain approximation approximation choose ansatz distribution depend arguments. example poisson-mixture distributions introduced section could used deﬁned space dimension similarly choose moment functions moment-closure approximation proceeds analogously case single-time marginal distributions. assuming available approximation evolution distribution short time-interval given respectively marginal conditional distributions corresponding subscript operator indicates acts argument approximate distribution member chosen parametric family minimizing distance functions writing resulting equations minima moment-closure equations two-time joint probability distributions completely analogous case single-time distributions reasoning applied obtain multi-time joint distributions entropic matching. derivation proceeds along similar lines state resulting equation completeness note computer implementations solution easily reused solution reaction system modeled cfpe multi-time moment closure equations fact equivalent corresponding single-time equations applied augmented system addition species reactions original system introduce species participate reactions. single-time equations applied -dimensional system using ansatz distribution moment functions equivalent two-time equations. proceed demonstrate two-time moment closure equations numerically. interesting case multi-time correlations oscillatory systems. lotka-volterra model important question arises whether equations produce selfconsistent approximations applied jointly single-time approximations following condition satisﬁed starting single-time marginal distribution time produce approximations single-time marginals also produce approximations two-time joint distributions implies marginal distribution time marginal distributions time agree. course hold chosen ansatz distributions moment functions compatible sense deﬁned below. general moment functions grouped functions depending arguments columns left right) function time system size approximation error lower system size presumably inadequateness second-order closure regardless whether poisson correction employed not. parameters values initial conditions moment functions depend marginal distribution depends closed equation parameters marginal distribution moment functions single-time moment equations also obtain thus two-time moment equations using parametric family consistent single-time moment equations using parametric family required. similarly self-consistency property explained above variational approximation viable alternative process-level variational approximations mentioned section approximation tractable wide variety ansatz distributions whereas closedform process-level approximations presumably obtained restricted class ansatz stochastic processes. article derived moment-closure equations variational approximation solution cfpe explaining well-known problems moment-closure approximations either solved least understood approach. generalized entropic matching arbitrary ansatz distributions stochastic processes providing particularly principled approximation scheme applications kinetics biomolecular reaction networks. entropic matching turned special case variational moment closure. variational approach allows obtain self-consistent approximations arbitrary multi-time joint distributions. method require computations space trajectories underlying stochastic process greatly increasing class ansatz distributions handled closed form. main challenge application principled approximations computation expectations respect chosen ansatz distribution. considered relatively simple distributional families expectations closed-form expressions. interesting extension work practical point view would development numerical schemes eﬃcient treatment expectations involved distributional families using example monte carlo estimates. presumably terms computational complexity approximation quality resulting approximations would somewhat full numerical solutions simple closed form approximations considered treatments moment equations. established moment-closure equations principled approximation method also position investigate properties moment closures. considered particular issue article plan extend analysis future publications. another interesting application results would inference hidden process states parameters observations tractable distribution approximations help development inference algorithms. show derive entropic matching equations gaussian ansatz distribution. consider backwards evolution operator corresponding stochastic diﬀerential equation gaussian ansatz parameters given kampen stochastic processes physics chemistry kuehn moment closure brief review control self-organizing nonlinear systems schnoerr sanguinetti grima validity conditions moment closure approximations stochastic chemical kinetics journal chemical physics schnoerr sanguinetti grima comparison diﬀerent moment-closure approximations stochastic chemical kinetics journal chemical physics ramalho selig gerland enßlin simulation stochastic network dynamics entropic matching physical review gillespie chemical langevin equation journal chemical physics eyink action principle nonequilibrium statistical dynamics physical review leike enßlin optimal belief approximation entropy brigo hanzon gland approximate nonlinear ﬁltering projection exponential manifolds densities bernoulli lakatos kirk stumpf multivariate moment closure techniques stochastic kinetic models journal chemical physics gardiner chaturvedi poisson representation. technique chem-", "year": "2017"}