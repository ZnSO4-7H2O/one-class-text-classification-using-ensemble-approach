{"title": "Scalable population-level modeling of biological cells incorporating  mechanics and kinetics in continuous time", "tag": "q-bio", "abstract": " The processes taking place inside the living cell are now understood to the point where predictive computational models can be used to gain detailed understanding of important biological phenomena. A key challenge is to extrapolate this detailed knowledge of the individual cell to be able to explain at the population level how cells interact and respond with each other and their environment. In particular, the goal is to understand how organisms develop, maintain and repair functional tissues and organs.  In this paper we propose a novel computational framework for modeling populations of interacting cells. Our framework incorporates mechanistic, constitutive descriptions of biomechanical properties of the cell population, and uses a coarse graining approach to derive individual rate laws that enable propagation of the population through time. Thanks to its multiscale nature, the resulting simulation algorithm is extremely scalable and highly efficient. As highlighted in our computational examples, the framework is also very flexible and may straightforwardly be coupled with continuous-time descriptions of biochemical signalling within, and between, individual cells. ", "text": "wolfson centre mathematical biology mathematical institute university oxford radcliﬀe observatory quarter oxford united kingdom. e-mail daniel.wilsonmaths.ox.ac.uk processes taking place inside living cell understood point predictive computational models used gain detailed understanding important biological phenomena. challenge extrapolate detailed knowledge individual cell able explain population level cells interact respond environment. particular goal understand organisms develop maintain repair functional tissues organs. paper propose novel computational framework modeling populations interacting cells. framework incorporates mechanistic constitutive descriptions biomechanical properties cell population uses coarse graining approach derive individual rate laws enable propagation population time. thanks multiscale nature resulting simulation algorithm extremely scalable highly eﬃcient. highlighted computational examples framework also ﬂexible straightforwardly coupled continuous-time descriptions biochemical signalling within between individual cells. development disease repair require tightly coordinated action populations cells. almost every case plethora interacting components acting range spatial temporal scales combines drive observed tissue-level behaviours. research biosciences advanced stage suﬃcient understanding intercellular processes build relatively sophisticated models wide range cellular behaviours. promising approach generate test reﬁne hypotheses relative contributions various mechanisms tissue-level behaviours cell-based computational modeling individual cells explicitly represented cell position updates time cells also internal state program determining behaviour. cell-based models hold great potential regard naturally capture stochastic eﬀects cell-cell heterogeneity used explore tissue-level behaviours complex hypotheses cellular scale prevent straightforward continuum approximations tissue level. recent applications cell-based models study population-level behaviours include embryonic development wound healing tumour growth multiple cell-based modeling approaches exist categorised according approaches representing cell positions either onoﬀ-lattice. onlattice approach space divided discrete grid lattice sites. common type on-lattice model cellular automaton cell occupies single lattice site attempts move site time step according update rules. volume exclusion rule relaxed allow multiple cells lattice site depending level spatial description required problem consideration. position update rules typically take account number type neighbouring cells also depend information associated lattice sites nutrient signalling factor concentrations hybrid models often systems ordinary diﬀerential equations partial diﬀerential equation model evolution biochemical concentrations position update rules also stochastic cells move according e.g. biased random walk cases regular lattice used example square hexagonal unstructured lattices also used several cases references therein). diﬀerent on-lattice technique cellular potts model wherein cell allowed occupy multiple lattice sites energy minimisation used propagate shape cell time. cellular potts model used study biological processes ranging cell sorting morphogenesis tumour growth methods provide macroscopic limit models provided basic oﬀ-lattice approach cell-based modeling cell-centre-based model assumes cells eﬀect point particles interact speciﬁed potential function meanwhile vertex models cell populations modelled tessellation polygons polyhedra whose vertices move forces originating cells whilst immersed boundary models cell boundaries represented points move like elastic membranes immersed ﬂuid. cell-based models take subcellular composition cells account subcellular element model ﬁnite element vertex model cell-based modeling approach speciﬁc advantages disadvantages incorporate diﬀerent representations biochemical signalling biomechanics example immersed boundary model allows detailed representation cell shapes beneﬁt comes increased computational cost comparison methods. cellular potts models versatile possible eﬀects modelled updates controlled metropolis-type algorithm together user-speciﬁed hamiltonian time measured terms monte carlo steps. modeling speciﬁc application necessary weigh beneﬁts existing cell-based models context speciﬁc application. comprehensive review mechanocellular models including table compares diﬀerent modelling approaches provided comparison diﬀerent model output detailed work focus lattice-based approaches allow user-speciﬁed maximum number cells occupy lattice site given structured unstructured tessellation space develop constitutive equations governing dynamics cell population. cellular potts model update rules stochastic established global calculations. important diﬀerence however simulations take place continuous time thus allowing meaningful coupling continuous-time models. rationale developing approach desire able quickly eﬃciently simulate three-dimensional tissues consisting large numbers cells inclusion biomechanical eﬀects intercellular signalling external inputs. since approach base modeling cell biomechanics laplace operator spatial tessellation refer method discrete laplacian cell mechanics relying discrete laplace operator advantageous make highly developed scalable numerical methods evolve biomechanical details cell population time. important advantage provided highly eﬃcient framework potential ability conduct parameter sensitivity analysis parameter inference model selection cell-based models; increasingly important research tools quantitative interdisciplinary biology. detail model computational implementation; describe four examples showcase utility modeling framework; summarise results discuss avenues future exploration. method propose developed distributing cells onto grid voxels deﬁning suitable physics discrete space. laplace operator emerges convenient basic choice describe evolution biomechanics population involved alternatives could also employed place. enforce bound number cells voxel processes scale individual cells meaningfully described voxel-local basis. simulations performed paper voxels contain maximum cells larger carrying capacities also supported. choice discretisation made case-by-case basis taking account need balance computational complexity extent data individual-cell-level processes available. evolving individual cells discrete operators e.g. discrete laplacian processes population level connected eﬃcient scalable taking place inside individual cells. consider computational grid consisting voxels nvox three spatial dimensions. make assumptions whether grid structured however require consistent laplace operator formed grid. voxel shares edge neighbour voxels. dimensions voxel cartesian grid four neighbours regular hexagonal lattice voxel neighbours. general unstructured triangulation vertex grid varying number neighbour vertices general ﬂexible case voxels given point time voxels either empty contain certain number cells. number cells carrying capacity system assumed steady-state. hence absence processes cell population completely static. number cells voxels exceeds carrying capacity cells push exert cellular pressure. eventually non-equilibrium state changed event example cells moves neighbouring voxel pressure redistributed. goes until possibly system relaxes steady-state. relevant constitutive equation cellular pressure? make potential thus essentially assuming pressure spread evenly figure answer pressure distributed according negative laplacian source terms voxels carrying capacity exceeded. figure schematic explanation numerical model. unstructured voronoi tessellation green voxels containing single cells voxel containing cells. modeling physics cellular pressure thought pressure spread evenly linear springs connecting voxel centres grid unstructured derivation used regular e.g. cartesian hexagonal grids. instant time pressure gradient neighbouring voxels induces force that turn cause cells within voxels move. rate movement proportional pressure gradient conversion factor depend nature associated movement. example reasonable assume cell move empty voxel already occupied voxel diﬀerent rates unit pressure gradient. events algorithm lines dynamics driven discrete numerical operator i.e. laplacian context call simulation method discrete laplacian cell mechanics noted might beneﬁcial certain given state cell population cellular pressure calculated rates possible events determined sampling procedure gillespie used; rates decides time next event proportional sampling next determines event happens time next event processes local voxel simulated independent fashion finally event processed cell population state obtained loop starts anew. update state cells respect continuous-time processes taking place e.g. intracellular kinetics cell-to-cell communication. update state executing state transition associated determined event. summary modelling framework lattice-based allows range physical biomechanical phenomena accurately described facilitates explicit modelling cell size/excluded volume eﬀects pressure-dependence cell movements. incorporation stochasticity gillespie algorithm renders naturally able represent noise observed biological systems. moreover simple simultaneously integrate either deterministic stochastic models biochemical reaction networks. choice sensible numerical linear algebra techniques framework eﬃcient even complex models simulated short times. means possible perform statistical inference model parameters using quantitative experimental data together techniques approximate bayesian computation spatial discretisation discrete counting cells task track changes chosen state space. continuous time amounts ﬁguring cell move voxel move. requires governing physics deﬁned discrete state. continuous-time markov chain respects memoryless markov property stand promising approach requiring movement rates order fully deﬁned. model population cells follows three equations below understood simpliﬁed three assumptions assumptions .–.. present turn follows. current ﬂux. since aiming event-based simulation later derive rates discrete events continuous-time markov chain. prescribe current make starting assumption. assumption expresses idea small brownian-type movements cell center ignored. exclude additional description active movements chemotaxis haptotaxis. suﬃcient conditions equilibrium speciﬁed follows assumption doubly occupied voxels give rise rate move describe increased rate pressure source. absence units pressure source unity identically. denote cellular pressure time position using continuous notation variables implemented discrete grid. interpreting current result pressure gradient take simple phenomenological model viscosity form darcy’s porous ﬂuid ﬂow. notably darcy’s obtained ﬁrst principles using homogenisation arguments however diﬀerent cells preserve geometrical integrity freely like ﬂuid. rather current understood rate discrete event cell changes voxel. complete model require constitutive equation relating cellular pressure driven sources form overcrowded voxels provide constitutive model pressure evolution using heat equation source function prescribed below. speciﬁcally follows assuming isotropic medium scalar potential pressure. voxel populated carrying capacity potential divergence theorem implies laplace operator. overpopulated voxel instead outward captured divergence theorem source term. cases biochemical kinetics individual cells also aﬀect mechanical behaviour example signal transduction proliferation assumption entails processes must occur slower time-scale propagation cellular presre-interpret developed model onto given tessellation aiming speciﬁcally time-continuous event-driven simulation. denote subset voxels similarly denote discrete boundary; unpopulated voxels connected voxel figure illustration. ﬁrst consider discrete version whenever view normalisation static case following assumption discrete laplacian currently active grid precise choice numerical method chosen deﬁne likely strong inﬂuence model output since laplacian operator quite forgiving details. experiments used ﬁnite-element-based discrete laplacian operator linear basis functions lumped mass-matrix simpliﬁes traditional ﬁnite diﬀerence stencils structured grids. follows continuous interpretation source term formally consistent dirac delta function; continuous language ui>c denotes center point voxel carrying distance voxel centres shared edge length simpliﬁcation takes discrete nature model account simply substituting scaled diﬀerence gradient. current reversed result negative. follows that presence pressure source non-zero pressure gradient results everywhere except solid boundaries. remains specify including subset cells free move result pressure gradient. figure schematic illustration model figure green voxels contain single cells voxels contain cells giving rise pressure sources. pressure propagated laplacian operator voxels induces force hence rate move cells subset voxels indicated arrows. cells boundary voxels move empty voxels cells doubly populated voxels move voxels containing fewer cells. arrows drawn common scale. here conversion factor unit pressure gradient movement rate voxel never visited before similarly voxel previously occupied covers crowding case cell doubly occupied voxel enters singly occupied voxel. words total pressure gradient closed surface equal enclosed sources. boundary surrounding whole cell population follows ratio expresses preference events tissue boundaries events internal region example assuming presence single internal source total probability cell move boundary voxels rates eqs. illustrated common scale figure note that cartesian grid integration edge current non-zero along cardinal directions up/down right/left respectively. addition rates eqs. easily extend basic framework include active cell movements and/or behaviours prescribed additional rates handled lines algorithm example possible approach include adhesion constant neighbor voxel pairs edge length adhesion bonds active rik) denote unit vectors pointing voxel respectively voxel min-construct ensures adhesion acts resistance force. summing adhesion forces populated neighbor voxels voxel scaling inter-voxel distance thus evaluate adhesion current contribution options capture similar eﬀects could modify pressure source function and/or boundary conditions; best choice clearly dependent details modeling situation. present computational results proposed modeling framework. focus highlighting three distinct advantages approach mechanics based constitutive equations obeying well-understood physics; framework fast scalable therefore convenient experiment with; also ﬂexible allows seamless coupling processes interest. throughout examples constructed computational grid rectangular base geometry; used structured cartesian hexagonal grids case cartesian grid grid initially populated cells middle domain line algorithm previously mentioned relied upon ﬁnite-element-based discrete laplacian operator deﬁned using linear basis functions lumped mass-matrix implemented matlab add-on package toolbox discrete laplacian inverted using matlab’s built-in lu-decomposition fast enough purposes tests performed here. larger models well beneﬁt advanced linear solver techniques. code required data available look possible dependency results underlying computational grid investigate couple cellular behaviour signals couple modeling framework intracellular continuous-time processes including cell-to-cell signalling ﬁnally demonstrate test grid artefacts artiﬁcially forcing number cells square conﬁguration relaxing system equilibrium absence mechanical forces clearly equilibrium state approximately circular. figure set-up relaxation process experiment. left voxels square initially contain cells middle right relaxation populated domain becomes approximately circular shape voxels contain single cell bottom shows equivalent experiment three space dimensions cartesian grid dependence underlying grid except natural distortions discreteness. comes fact physics based well-understood constitutive equations employ grid-consistent discretisation laplacian notable extension basic framework model population cells respond external stimuli local environment. advantage dlcm framework restricted considering laplacian operator freely choose operators depending mechanics problem consideration. test case take two-dimensional migratory model neurons responding inhibiting chemical known slit cellular pressure neurons described chemotaxis figure average concentration relaxation square initial data. left cartesian grid right hexagonal grid. reference circle area total cell population. although discrete eﬀect visible grid artefacts sense preferred expansion directions. chemotactic sensitivity neurons chemical i.e. concentration slit. parameter taken small represents assumption pressure equilibrates faster timescale movement neurons. source term deﬁned previously. represents movement cells gradients constant diﬀusivity slit rate degradation strength slit source line parameter taken small represents assumption diﬀusion slit occurs faster timescale movement cells. imposing assumption thus allows solve steady-state problem also include pressure-independent movement mechanism representing active motion cells chemo-repellent include chemotaxis-driven movement cell voxel voxel derive following current measure aﬃnity cells slit type pressure-independent movement. initialise circular region radius doubly occupied sites centre domain voxel size taken specify parameters simulations terminal time present average cell density proﬁle figure expected average cell population moves away source slit consistent chemo-repellent. figure average cell density relaxation initially circular explant cells voxel. source slit right-hand edge domain that average cells move preferentially left away source slit. great ﬂexibility proposed framework comes fact additional processes simulated concurrently overall mechanics cell population notably processes include cell-to-cell communication driving cell fate diﬀerentiation. illustrate consider classical delta-notch intracellular signalling model produces pattern formation simple lateral inhibition feedback loop. respectively notch delta concentrations within cell model takes dimensionless form produce dynamic population cells middle region proliferate constant rate terminate simulation ncells average appropriately modiﬁed account doubly occupied voxels. realistic contact pattern hexagonal grid used; hence voxel neighbours. figure typical time-series model summarised. time-scale delta-notch dynamics proliferation process dynamics equilibrates tissue stops growing. second simulation summarised figure right-hand side scaled factor delta-notch model quasi-steady-state tissue grows. signiﬁcant diﬀerences patterns could potentially used together experimental data better understand timescales patterning compare tissue growth. figure coupling cellular signalling continuous time dynamics delta-notch cells proliferate. black cells indicate high notch grey cells indicate notch circle) cells region allowed proliferate constant rate. right population thus grows delta-notch signalling model simulated concurrently. bottom left/right delta-notch model equilibrates cellular growth process stopped. times snapshots units time unit proliferation rate model simulated using delta-notch parameters described text. figure delta-notch dynamics simulated anew faster time-scale. process essentially continuous equilibrium tissue grows. frames correspond right bottom left frames figure finally utilise proposed framework build model avascular tumour growth. known important factor growth tumours availability oxygen tumour. case avascular tumour direct supply oxygen tumour itself instead oxygen surrounding tissue diﬀuses tumour. consider tumour growing population cells potentially proliferate and/or course simulation. extend occupancy voxels boundary tumour consume oxygen proliferate concentration oxygen suﬃcient. tumour concentration oxygen generally lower cells continue consume oxygen longer proliferate; known quiescent cells. near centre tumour oxygen concentration enough cells eventually degrade; region known necrotic core. solve discrete laplace equation pressure voxel homogeneous dirichlet boundary conditions boundary collection empty voxels adjacent occupied voxels. also equation oxygen concentration diﬀuses domain sources ﬁxed external boundary ∂ωext thus empty voxels containing dead cells consume oxygen). discretised equations calculate diﬀerent rates possible events. events follows. cell occupying voxel proliferate rate ρprol κprol κprol minimum oxygen concentration proliferation occur. living cell rate ρdeath κdeath κdeath threshold oxygen concentration cell survival. demonstrates evolution tumour classical regions proliferating cells quiescent cells necrotic core. also present evolution numbers cell type duration realisation widely-held view ﬁeld limited oxygen supply leads stable ﬁnite-sized tumour recent models avascular tumour growth utilised successfully predict growth tumour cell lines exhibit sigmoidal growth curves sigmoidal curves three phases initially small population cells abundance oxygen exponential growth followed quasi-linear growth proliferating cells eventually lack oxygen causes three heterogeneous cell types appear proliferating ring quiescent annulus necrotic core. volume avascular tumour begin plateau observed simulations however possible lack surface adhesion model observe fourth phase emerge asymmetric protrusions appear surface tumour increases total uptake oxygen hence incline total cell number sought parameterisation model exhibit fourth phase instead produces steady-state tumour however could despite systematic search parameter space. navigate parameter space follows; ﬁrstly select user-speciﬁed ﬁnite size tumour radius solve steadystate oxygen equation. parameters chosen decide proliferating ring necrotic core lie. next initialise population cells required radius proliferation death rates ρprol ρdeath temporarily ρdeg dead cells instantly degrade. alter movement rates number cells proliferating roughly equal number cells instantly absorbed necrotic core; means that average size tumour constant. finally returning full avascular tumour model vary remaining parameters attempt build ﬁnite-size tumour. despite comprehensive exploration parameter space possible eﬃciency versatility dlcm framework best could slow growth asymmetric protrusions increasing greater cells invade matrix slower rate appears reasonable assumption here exact separation scales need investigated case-bycase basis using cell trajectory data collected relevant experiments. thus current modelling assumptions passive physics capable developing avascular tumour spheroids seen experiments. results line previous works conclude additional mechanisms necessary order tumour growth stabilised. suggested mechanisms involve necrotic cells secreting chemicals either growth inhibitor healthy cells become quiescent chemotactic signalling chemical attract tumour cells migrate back towards necrotic core inclusion mechanisms naturally proposed dlcm framework implemented future focussed studies. liferated exponentially initial abundance oxygen voxels doubly occupied tumour grows quasi-linear rate mostly voxels still doubly occupied. lack oxygen forced heterogeneity cell types proliferating ring annulus quiescent cells necrotic core cell numbers appear plateauing. asymmetric protrusions form exterior tumour enabling overall number cells continue increase thereby preventing complete plateau. goal work provide eﬃcient hybrid multiscale computational framework modelling populations cells tissue scale. framework harness either regular unstructured lattice required biological problem consideration draws upon constitutive mechanistic description cellular biomechanics drive expansion and/or retraction cell population cells move undergo proliferation death. assuming timescale tissue relaxes mechanical equilibrium much shorter mechanical processes able assume cellular pressure within population governed laplace equation speciﬁed boundary conditions source terms. pressure gradient within tissue derive rate equations movement cells within population. enables propagate model continuous time using event-driven algorithm originally proposed gillespie signiﬁcant advantage approach regard discrete continuous models biochemical signalling easily ﬂexibly incorporated framework. enables user develop hybrid multiscale models include constitutive descriptions cellular biomechanics interintra-cellular signalling eﬃcient scalable framework. approach ﬂexible computationally eﬃcient provides consistent description cellular mechanics. however form presented here allow detailed tracking individual cells resolution shape time; cell-based modelling approaches suitable spatial resolution required demonstrated utility approach using four examples. first demonstrated that expected simple colony proliferating cells relaxes isotropically. second demonstrated integrate signals local microenvironment cell movement laws using migration cells within neuronal explant exposed gradient secreted protein slit example. third example showed easy integrate cell-cell signalling models framework using delta-notch lateral inhibition model test case. finally developed model avascular tumour growth wherein cell proliferation death controlled local oxygen concentration cell population generates oxygen proﬁle within tumour cells consume oxygen. summary real advance provided approach ability quickly efﬁciently simulate behaviour large populations cells three spatial dimensions. model hybrid multiscale nature; incorporate continuum discrete models biochemical signalling within cells. purpose experimenting developed serial matlab implementation model employs direct factorisation discrete laplace operator such scales conveniently cells. using compiled language parallelisation could likely improve upon ﬁgure extent. however real savings computing time require optimal laplace solvers utilise example algebraic geometric multigrid techniques take advantage incremental nature computational process domain evolves slowly. leave aspect implementation future work. modern biology quantitative data describing evolution cell populations tissues collected relative ease position test validate experimentally generated hypotheses using biologically realistic mechanistic models. however models need calibrated available data sensitivity model predictions changes model parameters needs explored. requires repeated simulation multiscale hybrid cell-based models computational demands to-date provided barrier signiﬁcant progress. dlcm method outline results signiﬁcant advances ability eﬃciently simulate hybrid multiscale cell-based models three spatial dimensions therefore provides real opportunity test validate mechanistic models using quantitative data. would like thank royal society wolfson research merit award leverhulme trust leverhulme research fellowship. would like thank uk’s engineering physical sciences research council funding studentship systems biology programme university oxford’s doctoral training centre.", "year": "2017"}