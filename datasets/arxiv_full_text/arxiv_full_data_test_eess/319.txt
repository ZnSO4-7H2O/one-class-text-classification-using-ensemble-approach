{"title": "Deep Chain HDRI: Reconstructing a High Dynamic Range Image from a Single  Low Dynamic Range Image", "tag": "eess", "abstract": " In this paper, we propose a novel deep neural network model that reconstructs a high dynamic range (HDR) image from a single low dynamic range (LDR) image. The proposed model is based on a convolutional neural network composed of dilated convolutional layers, and infers LDR images with various exposures and illumination from a single LDR image of the same scene. Then, the final HDR image can be formed by merging these inference results. It is relatively easy for the proposed method to find the mapping between the LDR and an HDR with a different bit depth because of the chaining structure inferring the relationship between the LDR images with brighter (or darker) exposures from a given LDR image. The method not only extends the range, but also has the advantage of restoring the light information of the actual physical world. For the HDR images obtained by the proposed method, the HDR-VDP2 Q score, which is the most popular evaluation metric for HDR images, was 56.36 for a display with a 1920$\\times$1200 resolution, which is an improvement of 6 compared with the scores of conventional algorithms. In addition, when comparing the peak signal-to-noise ratio values for tone mapped HDR images generated by the proposed and conventional algorithms, the average value obtained by the proposed algorithm is 30.86 dB, which is 10 dB higher than those obtained by the conventional algorithms. ", "text": "paper propose novel deep neural network model reconstructs high dynamic range image single dynamic range image. proposed model based convolutional neural network composed dilated convolutional layers infers images various exposures illumination single image scene. then ﬁnal image formed merging inference results. relatively easy proposed method mapping different depth chaining structure inferring relationship images brighter exposures given image. method extends range also advantage restoring light information actual physical world. images obtained proposed method hdr-vdp score popular evaluation metric images display resolution improvement compared scores conventional algorithms. addition comparing peak signal-to-noise ratio values tone mapped images generated proposed conventional algorithms average value obtained proposed algorithm higher obtained conventional algorithms. image restoration important ﬁeld image processing computer vision. task restores original image using prior knowledge degradation phenomena. unlike image enhancement main purpose image restoration restore latent clean image corrupted image degradation function additive noise. mation deep learning proposed function approximator infers unknown mapping input output image sets deep neural networks advanced state-of-the-art performance image restoration ﬁeld applications super resolution deblurring denoising similarly efforts acquire original images close actual physical world called high dynamic range imaging also continued. debevec proposed hdri method expand narrow dynamic range limitations camera sensor. method estimates camera response function images different exposures derives radiance information using estimated makes possible obtain image information close information real world. addition considerable improvements display technology possible express larger luminance ranges past. result interest generating images high quality close real world increased image restoration optimized high dynamic range displays existing dynamic range images also become important. typically existing images lost speciﬁc information captured image camera limitations impossible retake images. therefore recovering dynamic range ill-posed problem considered image restoration problem. solve problem inverse tone mapping proposed. however conventional algorithms infer physical brightness information focus adjusting brightness values speciﬁc areas highlight regions create perceptually high-quality image. addition image narrow range enlarged image wide range difﬁcult appropriate relationship spaces different ranges. real-world range using deep neural network. proposed method novel hdri method produces multiple exposure image stack single image following main contributions. design neural network chain structure create image stack sequentially generating images different exposure levels input image deﬁned middle exposure image. addition gradient vanishing problem solved inserting additional loss function learning network smoothly performed. propose activation function hdri method minus prelu transforms existing prelu residuals given input image image darker exposure learned easily. physical limitations charge-coupled device sensor digital camera captures single image limited dynamic range scene information. image certain exposure value amount light reaches sensor digital camera. controlled aperture shutter speed sensor sensitivity deﬁned follows relative aperture exposure time sensor sensitivity displaying image speciﬁc difference scene observed human range image representation camera smaller human perception range. solve problem debevec proposed hdri technique estimates multiple images different exposure levels extracts omnidirectional radiance physical world. relationship physical brightness image pixel level modeled follows shot noise additional noises uniformly distributed quantization error occurs conversion analog voltage values digital quantized values. methods limited difﬁcult capture multiple exposure images given scene time. even multiple exposure images taken merged create image method sensitive changes caused moving objects illumination thereby degrading image quality. solve problems several methods proposed enhance image quality. display expanded dynamic range represent bright dark areas better display. therefore displaying large number existing images display become critical issue. images information saturated regions dark regions limitations dynamic range. hence image generated single image corresponding regions difﬁcult restore. method solving ldr-to-hdr conversion problem called several algorithms proposed banterle proposed method detects highlight regions extends range regions. masia proposed exponential expansion method meylan proposed piecewise linear mapping function increases range bright portions image. rempel used brightness enhancement linearly increase contrast intermediate range. further restored saturated pixel values using edge stopping function. kovaleski also used bilateral grid broaden dynamic range. however although algorithms change image image wide range expansion correctly performed image parameters appropriately given input. algorithms cause contour artifacts bright objects boosting brightness saturated areas image quality degrades side effect additional processing needed remove annoying artifacts. solve problems proposed method considers human visual system using perceptual brightness rather absolute brightness. however based local adaptive response retina difﬁcult obtain images match actual brightness. recently zhang proposed method converting panoramic image image deep learning input image pixel resolution method suitable ﬁnding light source position. automatically extracts feature using loss function deﬁned designer data given minimizes error inferred value reference value. strong points cnns made many improvements ﬁeld image restoration. speciﬁcally cases resnet densenet possible learn deeper structures skipconnections low-layer information high-layer abstract information. vdsr approach obtained good results using residual blocks. zhang also restored colors grayscale images using cnns. describing details proposed neural network architecture ﬁrst explain feasibility neural network structure generates multiple exposure image stack single image rather direct ldrto-hdr mapping. terms restoring information ill-posed problem neural network would ideal problem solver directly extracted actual scene luminance values single image. however figure range required restoration widened difﬁcult infer relationship image sets. addition impossible simply expand dynamic range shown figure hence metadata input image required infer luminance values actual scene. generally existing images information hence distinct limitation restoring actual scene luminance values. assume existing images wellcaptured properly exposed appropriate exposure value selected humans. single input image proposed network deﬁned middle exposure image. assuming middle exposure using multiple exposure image stack possible train infer images contain higher lower exposure information shown figure even value known existing image obtain tone mapped image well-ﬁtted wider range display. addition input image known scene luminance inferred debevec al.’s method therefore propose neural network infers multiple exposure image stack single image relationship image image deﬁned middle exposure image. figure problem. problems arise generating image single image. first range becomes wider lack mapping information becomes difﬁcult map. second metadata input image exist impossible accurately estimate luminance pixel value depending even though different scene. figure proposed multiple exposure image stack. obtain image using proposed method several subnetworks generate images various exposure levels rather inferring entire part once. based image middle exposure proposed neural network structure shown figure proposed network consists subnetworks infers images different exposures higher input image. exposure level middle exposure deeper structure needed infer relationship input output images. therefore proposed network constructs sequential learning process possible increase depth neural network infer patches given exposure information. entire network produces images three exposures bottom three exposures input image middle exposure. subnetwork architecture figure proposed deep chain hdri architecture. given image middle exposure value images inferred sequentially network. inferred image middle exposure value structure depth goes deeper image less exposure difference infer mapping relation accurately. ﬁnishing process proposed network total images inferred generate image stack. then image generated using hdri technique. output. subnetwork divided parts. front part consists total seven feature extraction blocks rear part consists four reconstruction blocks. block consists convolution layer batch normalization layer activation layer. prelu activation function block infers brighter images mprelu ﬁrst proposed paper activation function block infers darker images. feature extraction network operates abstraction feature extraction given input. reconstruction network consists paths reconstructs image using extracted features shown figure unlike layers reconstruction networks uses tanh function activation function enable representation residual. additionally extracting feature maps receptive ﬁeld signiﬁcant. therefore dilation parameters convolution layer feature extraction block respectively take account information patch. hence receptive ﬁeld network layer feature extraction network kernels size. reconstruction network layer consists kernels. kernel size respectively. train proposed model input subnetwork estimates image maps ground truth image image ground truth image optimization proceeds direction minimizing losses. subnetwork uses batch normalization produce regularization effects prevent vanishing gradients occur learning. addition adding error subnetwork structures vanishing gradients occur deep structure learning prevented. data multiple exposure image stack learning subnetwork need seven multiple exposure ground truth images satisfying static scenes. generally many datasets required train neural network stacks satisfy condition among existing datasets therefore generated different scene image stacks train test proposed network. shufﬂed split dataset training validation test set. ratio respectively. captured images format using nikon resolution resized obtain appropriate training rate. used tripod minimize image blur aperture value automatically adjusted sensor sensitivity shutter speed using auto bracketing function. then images middle exposure image stored shown figure given image sliced patches stride transforming image tensor shape inferred patch upper neural network reconstructed iev± using reconstruction process. then process repeated generate images construct multiple image stack. that image merged using hdri method proposed debevec section analyze reasons validity proposed neural network architecture characteristics network. first examine necessity chain structure exposure difference increases. second analyze settings activation function properties solve problems lpixel pixel loss total variation regularization. improve smoothness inferred image prevent overﬁtting speciﬁc pattern total variation regularization. experimentally relative weights loss therefore entire network trains minimize loss pixel loss norm patch-based learning brightness caused light radiation image localized property. therefore make patches image corresponding stride result subnetwork infers image image trained patch pairs. residual learning case image transformations learn relationship different images neural network often loses morphological information given input image optimizing loss minimization. therefore avoid losing spatial information neural network designed learn residual image ground truth. batch size one. optimize weights biases neural network used adam optimizer learning rate momentum parameter addition subnetwork trained using nvidia geforce epochs hours. dataset middle exposure correct exposure difﬁcult deﬁne reﬂects subjective viewpoint. however assume correctly exposed image depicts parts image detail. words pixels uniformly distributed throughout grayscale range. deﬁned middle exposure technical point view. therefore multiple exposure image stack obtained auto bracketing function camera changes automatically capturing images determine middle exposure image image evenly distributed histogram images stack. addition deﬁne average peak signal-to-noise ratios between ground truth images different scene calculated table difference arises information amount light entering camera gradually changes changed. difference relatively large images apart. assumed relatively deeper neural network required inferring relationship images. hence designed neural network structure simply increasing depth structure also proposing chain structure infers sequentially. example images made inferring images sequentially input image validate chain structure compared proposed method relatively shallow network skipconnected three convolution layers three deconvolution layers problem inferring relationship results shown table overall result shows inferring relationship images large distance deeply structured neural network better. therefore concluded good deeper structure exposure difference increases images. addition depth structure increases gradient vanishing effect error cannot delivered backpropagation occur. therefore loss term added intermediate results correspond images process. result proposed neural network architecture infers images accurately. deep neural network structure neuron activation determined nonlinear function describe nonlinear relation input output. based output neuron sigmoid relu functions non-negative output. contrast selu gradual slope toward negative inﬁnity prelu changes slope negative domain. proposed neural network contains residual learning process learns difference input reference. residuals image lower input image images decrease pixel value. means weight bias values become negative. perspective image decreases difﬁcult relation functions relu function. therefore proposed neural network requires activation function reﬂect negative value prelu. however negative domain prelu error easily gradient variation relatively smaller slope positive domain ﬂows consistently backpropagation. comparison results shown table results show mprelu effective learning residuals given input image image darker exposure. hence proposed neural network architecture prelu used images higher exposure mprelu used images lower exposure train network. results proposed network divided parts comparison ground truth image stack inferred image stack comparison ground truth images inferred images. conventional algorithms used. experiments image stacks used comparisons toolbox used generate tone compare images obtained conventional algorithms. figure comparison ground truth image stack inferred image stack. proposed neural network follows actual variation trends exposure also properties light source. determine similarity inferred images ground truth images psnr structural similarity multi-scale ssim used. comparison results shown table figure similarity inferred images ground truth images decreases exposure difference increases. addition images brightness darker single input image less similar ground truth images brightness brighter input single images generated using ground truth image stack inferred image stack. process hdri image stacks estimated based debevec tone-map images representative tone mapper reinhardet al.’s method used. psnr among tone-mapped images used quantitative comparison images. images evaluated hdr-vdp- drim based human cognitive system. evaluation used input parameters display viewing distance peak contrast gamma. evaluation results shown table figure psnr among tone mapped images vdp-quality score among images quantitatively show much closely ground truth image proposed method infers methods. conventional methods difﬁcult infer actual scene luminance single image information simply expanded target dynamic range. therefore artifacts brightness boosting loss details areas. addition hdr-vdp- drim results also show proposed method approximates actual scene luminance better conventional algorithms. result image hdr-vdp- proposed method blue-color pixels existing methods. result image colors close means observer cannot recognize difference ground truth image. drim shows contrast reversal loss visible contrast ampliﬁcation invisible contrast green blue points respectively represent differences images. proposed method aims infer actual scene luminances seen best-inferred result green blue points drim result image. point view proposed neural network inferred actual scene luminance single image better conventional methods. paper proposed novel artiﬁcial neural network structure infers image single image. inferring suitable image luminance scene given image captured proposed network structure widens dynamic range image also generates image closer ground truth image previously proposed methods. moreover proposed network trains residuals image pair contains morphological information changes illumination given training set. proposed subnetwork serves dictionary contains brightness information image desired exposure level rearranging images sequentially exposure space. proposed network able solve problems ghosting tearing appear conventional hdri. furthermore proposed network scalable extended obtain wider dynamic range. addition patch-based learning carried less restricted image resolution restoring images. shown experimental results learning relatively exposures difﬁcult. improvement additional studies network structure addressed future work.", "year": "2018"}