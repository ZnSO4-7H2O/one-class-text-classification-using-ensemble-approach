{"title": "Boundary-sensitive Network for Portrait Segmentation", "tag": "eess", "abstract": " Compared to the general semantic segmentation problem, portrait segmentation has higher precision requirement on boundary area. However, this problem has not been well studied in previous works. In this paper, we propose a boundary-sensitive deep neural network (BSN) for portrait segmentation. BSN introduces three novel techniques. First, an individual boundary-sensitive kernel is proposed by dilating the contour line and assigning the boundary pixels with multi-class labels. Second, a global boundary-sensitive kernel is employed as a position sensitive prior to further constrain the overall shape of the segmentation map. Third, we train a boundary-sensitive attribute classifier jointly with the segmentation network to reinforce the network with semantic boundary shape information. We have evaluated BSN on the current largest public portrait segmentation dataset, i.e, the PFCN dataset, as well as the portrait images collected from other three popular image segmentation datasets: COCO, COCO-Stuff, and PASCAL VOC. Our method achieves the superior quantitative and qualitative performance over state-of-the-arts on all the datasets, especially on the boundary area. ", "text": "compared general semantic segmentation problem portrait segmentation higher precision requirement boundary area. however problem well studied previous works. paper propose boundary-sensitive deep neural network portrait segmentation. introduces three novel techniques. first individual boundary-sensitive kernel proposed dilating contour line assigning boundary pixels multi-class labels. second global boundarysensitive kernel employed position sensitive prior constrain overall shape segmentation map. third train boundary-sensitive attribute classiﬁer jointly segmentation network reinforce network semantic boundary shape information. evaluated current largest public portrait segmentation dataset i.e. pfcn dataset well portrait images collected three popular image segmentation datasets coco coco-stuff pascal voc. method achieves superior quantitative qualitative performance state-of-the-arts datasets especially boundary area. semantic segmentation fundamental problem computer vision community aims classify pixels semantic categories. paper target special binary class semantic segmentation problem namely portrait segmentation generates pixel-wise predictions foreground background. recently becoming topic widely used many real-world applications augmented reality background replacement portrait stylization depth ﬁeld advanced driver assistance systems etc. although numerous deep learning based approaches proposed solve general semantic segmentation problem direct adaptation methods cannot satisfy high precision requirement portrait segmentation problem. portrait segmentation precise segmentation around object boundaries crucial challenging. applications like background replacement accurate smooth boundary segmentation better visual effects. however long challenging part portrait segmentation especially using convolutional neural networks since neighborhood boundary pixels contains mixture foreground background labels convolutional ﬁlters fuse information different classes confuse network segmenting boundary pixels. previous based semantic segmentation methods either conventional hard-label method ignore boundary pixels training fail solve problem. methods train better model separate foreground background sacriﬁcing accuracy predicting boundary pixels. paper propose boundary-sensitive network accurate portrait segmentation. contrast conventional semantic image segmentation systems dilate contour line portrait foreground label boundary pixels third class proposed soft-label method. boundary-sensitive kernels introduced loss function help network learn better representations boundary class well govern overall shape portrait. ﬁrst boundarysensitive kernel designed training image ﬂoating point vector assigned soft label pixel boundary class. second boundary-sensitive kernel global kernel location kernel indicates probability current location belonging boundary class. furthermore boundary-sensitive attribute classiﬁer trained jointly segmentation network reinforce training process. evaluate method pfcn largest available portrait segmentation dataset. method achieves best quantitative performance mean order show effectiveness generalization capability method test portrait images collected coco coco-stuff pascal experiment results demonstrate method signiﬁcantly outperforms state-of-the-art methods. rest paper organized follows section reviews previous work related problems. section describes general framework three boundarysensitive techniques detail. section discusses analyzes experimental results. section draws conclusions discusses work. semantic segmentation systems categorized unsupervised methods supervised methods. unsupervised methods solve semantic segmentation problem classic machine learning techniques include thresholding hashing k-means clustering topic model graph-cut etc. hand conventional supervised methods treat semantic segmentation problem pixel-wise classiﬁcation problem ﬁrst build handcrafted features train classiﬁers support vector machines random forest etc. recent years convolutional neural network based methods successfully applied semantic segmentation. long introduced endto-end fully convolutional networks takes natural image input performs dense pixel-wise predictions generate segmentation size input image. fully connected layers removed network preserve spatial information deconvolutional layers proposed up-sampling recover full image size. paradigm popularized based method quickly adopted subsequent approaches. traditional architectures pooling layer introduced increase receptive ﬁeld network goes deeper. however also decreases resolution feature map. proposed dilated convolutional layer replace pooling layer allows increasing size receptive ﬁeld without losing resolution feature maps. chen proposed deeplab system passes multiple rescaled input images different network branches parallel combines features maps operation end. portrait segmentation generally regarded subproblem semantic segmentation different traditional segmentation aspects. first foreground object limited people provides additional prior information. meanwhile portrait segmentation higher precision requirement boundary area. shen ﬁne-tuned portrait segmentation system pre-trained network portrait images. provide portrait-speciﬁc information network normalized position channels mean mask shape channel added input image. shen proposed joint correspondence segmentation estimation method using extra information provided figure kernel generating process method represents original image; represents detected contour line; shows three class labels foreground background dilated boundary; shows individual boundarysensitive kernel; shows global boundary-sensitive kernel. better address boundary prediction problem introduce individual boundary-sensitive kernel. label boundary class third class separate foreground background classes assign soft-labels pixels boundary class follows. first portrait’s contour line identiﬁed ground truth segmentation canny edge detector contour dilated p-pixels width overlayed onto ground truth segmentation map. call label individual boundary-sensitive kernel. pixel kernel ﬂoating-point vector indv assigned soft-label represent likely current pixel belongs class. indv computed equations methods easily generate rough segmentation generally fail provide precise segmentation near object boundaries. reﬁning predictions near boundaries commonly used solution employing conditional random fields along cnn. deeplab employs dense post processing method smooth predictions. however generally used post-precessing step quite time-consuming. architecture framework shown figure deeplabv resnet model base segmentation network. deeplabv resnet consists three resnet branches base process different scales input image. three branches followed atrous spatial pyramid pooling different dilation rates fused together end. details please refer make model sensitive portrait’s boundary training label training samples three non-overlapping classes foreground boundary background using softlabel method described below. individual boundarysensitive kernel global boundary-sensitive kernel introduced updating loss function affect forward pass back-propagation. generation process kernels shown figure furthermore attribute classiﬁer shares base layers trained jointly segmentation task reinforce training process. portrait images. global kernel designed follows. first mean mask computed using average ground truth segmentation maps training samples. generates probability value location indicates likely current location belongs foreground/background. second equation employed generate global boundary-sensitive kernel. values normalized range larger value close global kernel indicates current location higher probability boundary. words location difﬁcult network classify. force network focus possible boundary locations weight locations corresponding kernel values updating loss function. performing forward pass pixel location sample update loss function equations denotes global kernel value pixel global location denotes ground truth class label current pixel location. back-propagation gradient computed equation forward pass back-propagation functions pixels likely located boundary weighted higher contribute loss. guides network sensitive difﬁcult locations. portrait attributes long/short hair play important role determining portrait’s shape. training network capable classifying boundary-sensitive attributes give prior information system makes system accurate efﬁcient boundary prediction. motivated idea train attribute classiﬁer jointly portrait segmentation network multi-task learning. example ||ii cj|| represents distance current pixel nearest point contour line represents binary label current pixel original label pixels foreground/background class labeled pixels boundary class labeled ﬂoating-point vector. soft-label method computes lbdry normalized distance current pixel nearest point contour sets either based class label current pixel ground truth segmentation map. forward pass pixel sample formula updating loss function expressed equation last step holds since soft-label vector sums one. using soft-label method boundary pixels contribute boundary class also foreground/background class weighted manner based close contour line. nature aligned portrait images likely locations image upper corner pixels belong background high probabilities locations middle bottom pixels belong foreground high probabilities. pixels easily classiﬁed pixels harder classify. estimate position sensitive prior training data. evaluate proposed method largest publicly available portrait segmentation dataset dataset collected flickr manually labeled variations pose appearance background lighting condition hair style accessory etc. portrait images captured frontal cameras mobile phones. dataset consists portrait images split training images testing images. images scaled cropped size portrait image pixels labeled either foreground background. refer dataset pfcn dataset. sample images pfcn dataset given figure design attribute classiﬁer base layers conv pool shared segmentation network classiﬁer. this channel three fully connected layers. ﬁrst fully connected layers neurons followed dropout layer relu layer. last fully connected layer neurons binary classiﬁcation. model details train portrait segmentation system ﬁne-tune deeplabv resnet model using training pfcn dataset. introduce dataset next subsection. three resnet branches deeplabv. branch atrous convolution layers added parallel dilation factors summed together produce ﬁnal feature map. element-wise operation performed three branches produce ﬁnal prediction. generate individual kernel dilate contour line -pixels width label dilated boundary using soft-label method. select weight range global kernel following portraitfcn+ addition three channels normalized position channels mean mask shape channel input. details please refer iteration random patch size cropped original image randomly ﬂipped probability data augmentation. input image rescaled factors input images three branches deeplabv network. train attribute classiﬁer label training images long/short hair classes. stochastic gradient descent learning rate train model iterations without attribute classiﬁer. decrease learning rate factor since performance pfcn dataset pretty high data boundary class unbalanced compare foreground/background good performance boundary segmentation lead marginal improvement mean dataset. thus test method portrait images collected three popular semantic segmentation datasets evaluate effectiveness boundary-sensitive techniques. coco portrait automatically collect portrait portrait-like images coco dataset. face detector dataset keep images containing person face area covers least whole image. images total ground truth segmentation maps. refer dataset coco portrait. coco portrait challenging pfcn data various ways large pose variations large occlusions unlabeled individuals appear background large portion background different kinds accessories etc. coco-stuff portrait coco-stuff dataset augments coco dataset reﬁned pixel-level stuff annotations images. collect portrait portraitlike images dataset. quality images dataset coco portrait. refer dataset coco-stuff portrait. pascal portrait method collect portrait portrait-like images pascal datasets. lack ground truth segmentation maps dataset images collected. images dataset also challenging unconstrained. refer dataset pascal portrait. sample images three datasets illustrated figure statistics given table test generalization capability model directly test three datasets without ﬁne-tuning. achieve mean mean mean coco portrait coco-stuff portrait pascal portrait respectively. signiﬁcantly outperform portraitfcn+ three datasets. result comparisons illustrated table since deeplabv model trained dataset compare directly. deeplabv resnet ﬁne-tuned model refer portraitdeeplabv. portraitdeeplabv model training data portraitfcn+ training settings bsn. ablation study report results four models work train attribute classiﬁer train global boundary-sensitive kernel train individual boundarysensitive kernel all-in-one model ﬁnal model achieves state-of-the-art mean quantitative result comparison given table result graph-cut shown baseline. figure result visualizations three challenging examples. ﬁrst shows contains confusing objects background; second includes multiple people background; third background color close foreground. visualize overall performance model compared deeplabv portraitfcn+ using three challenging scenarios confusing objects background multiple people appear image background color theme close foreground. figure shows model accurate robust methods even challenging conditions. techniques. figure shows comparison method deeplabv portraitfcn+ three challenging scenarios hair segmentation accessory segmentation segmentation. results reveal methods difﬁculty segmenting accessories small body parts method provide smooth accurate segmentation. figure boundary segmentation comparisons. ﬁrst column original images. three subsequent columns represent results portraitfcn+ method ﬁne-tuned deeplabv model attribute classiﬁer ﬁnal model since method deliver accurate boundary prediction natural extension generate trimaps image matting models. performing segmentation technique training dilate boundary pixels -pixels width. several examples shown figure portrait segmentation widely used various image processing applications background replacement depth ﬁeld augmented reality image cartoonization etc. show applications figure salonidis desai chuah. deepcham collaborative edge-mediated adaptive deep learning mobile object recognition. ieee/acm symposium edge computing pages present boundary-sensitive portrait segmentation system. boundary-sensitive kernels introduced loss function. gives boundary information individual image governs overall shape portrait prediction. attribute classiﬁer trained jointly segmentation network reinforce training process. experiments conducted largest publicly available portrait segmentation dataset well portrait images collected three popular semantic segmentation datasets. outperform previous state-ofthe-arts quantitative performance visual performance. future work would like extend boundarysensitive methods general semantic segmentation problem explore semantic attributes reinforce training process.", "year": "2017"}