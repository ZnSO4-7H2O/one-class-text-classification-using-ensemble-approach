{"title": "Quantitative Susceptibility Mapping using Deep Neural Network: QSMnet", "tag": "eess", "abstract": " Deep neural networks have demonstrated promising potential for the field of medical image reconstruction. In this work, an MRI reconstruction algorithm, which is referred to as quantitative susceptibility mapping (QSM), has been developed using a deep neural network in order to perform dipole deconvolution, which restores magnetic susceptibility source from an MRI field map. Previous approaches of QSM require multiple orientation data (e.g. Calculation of Susceptibility through Multiple Orientation Sampling or COSMOS) or regularization terms (e.g. Truncated K-space Division or TKD; Morphology Enabled Dipole Inversion or MEDI) to solve the ill-conditioned deconvolution problem. Unfortunately, they either require long multiple orientation scans or suffer from artifacts. To overcome these shortcomings, a deep neural network, QSMnet, is constructed to generate a high quality susceptibility map from single orientation data. The network has a modified U-net structure and is trained using gold-standard COSMOS QSM maps. 25 datasets from 5 subjects (5 orientation each) were applied for patch-wise training after doubling the data using augmentation. Two additional datasets of 5 orientation data were used for validation and test (one dataset each). The QSMnet maps of the test dataset were compared with those from TKD and MEDI for image quality and consistency in multiple head orientations. Quantitative and qualitative image quality comparisons demonstrate that the QSMnet results have superior image quality to those of TKD or MEDI and have comparable image quality to those of COSMOS. Additionally, QSMnet maps reveal substantially better consistency across the multiple orientations than those from TKD or MEDI. As a preliminary application, the network was tested for two patients. The QSMnet maps showed similar lesion contrasts with those from MEDI, demonstrating potential for future applications. ", "text": "jaeyeon yoon† enhao gong† itthi chatnuntawech berkin bilgic jingu woojin jung jingyu hosan jung kawin setsompop greg zaharchuk eung yeop john pauly jongho lee* laboratory imaging science technology department electrical computer engineering seoul national university seoul korea department electrical engineering stanford university stanford california national nanotechnology center pathum thani thailand department radiology harvard medical school boston department radiology stanford university stanford california department radiology gachon university incheon korea deep neural networks demonstrated promising potential field medical image reconstruction. work reconstruction algorithm referred quantitative susceptibility mapping developed using deep neural network order perform dipole deconvolution restores magnetic susceptibility source field map. previous approaches entail multiple orientation data regularization terms solve ill-conditioned deconvolution problem. unfortunately either require long multiple orientation scans suffer artifacts. overcome shortcomings deep neural network qsmnet constructed generate high quality susceptibility single orientation data. network modified u-net structure trained using gold-standard cosmos maps. datasets subjects empoyed patch-wise training doubling data using augmentation. additional datasets orientation data used validation test qsmnet maps test dataset compared medi image quality consistency multiple head orientations. quantitative qualitative image quality comparisons demonstrate qsmnet results superior image quality medi comparable image quality cosmos. additionally qsmnet maps reveal substantially better consistency across multiple orientations medi. preliminary application network tested patients. qsmnet maps showed similar lesion contrasts medi demonstrating potential future applications. words machine learning reconstruction magnetic susceptibility dipole schweser wharton example morphology enabled dipole inversion algorithm constrains reconstructed similar edges t*-weighted magnitude image. results show much reduced streaking artifacts refined map. however certain errors illconditioned problem still remain prolonged scan time limitation subject cooperative obtain accurate acquiring data multiple head orientations respect reconstructing data using calculation susceptibility multiple orientation sampling algorithm resulting considered gold-standard ignoring susceptibility structural anisotropies white matter however approach requires acquisition multiple head orientations practical clinical routine. recently deep learning using neural network widely applied across multiple fields including computer vision computer assisted diagnosis pattern recognition deep neural network shown capability performing non-linear mapping input space output space. training dataset large enough deep neural network outperformed state-of-art machine learning algorithms even human raters deep neural networks also applied medical image reconstruction x-ray methods showed impressive performances compared conventional algorithms. considering current outcomes deep neural network image reconstruction approach applicable reconstruction. paper explore possibility training deep neural network conduct dipole deconvolution task high quality reconstruction qsm. refer neural network qsmnet hereafter. target reconstruction quality qsmnet cosmos single head orientation image used reconstruction neural network. magnetic susceptibility intrinsic property tissue determines degree magnetization external magnetic field. recent years measuring magnetic susceptibility using received much attention potentials clinical diagnosis diseases quantification susceptibility sources magnetic susceptibility source perturbs main magnetic field induces resonant frequency variation outside source. spatial pattern resonant frequency variation demonstrated dipole shape point susceptibility source placed field complex susceptibility source distribution calculate resonance frequency variation field convolution source distribution dipole pattern. field measured phase gradientecho sequence. susceptibility source distribution performing spatial de-convolution dipole pattern practically performing fourier transforms phase image dipole pattern dividing fourier transformed phase image fourier transformed dipole pattern. process generating susceptibility source distribution referred quantitative susceptibility mapping unfortunately de-convolution division fourier domain ill-conditioned problem fourier transformed dipole pattern contains zeros number solutions proposed address reconstruction problem. approach truncate inversion dipole pattern k-space avoiding infinity division zero approach generates susceptibility suffers streaking artifacts. overcome artifacts sophisticated regularization algorithms enforces certain prior information reconstruction proposed rotated cosmos generated matrix rotation using transpose rotation matrix calculated magnitude registration. increase size training datasets cosmos maps rotated angle local field maps generated dipole convolution. using data augmentation process total training datasets doubled total scans used training. since dipole deconvolution relates local field susceptibility defined patch size voxels used training. patch generated overlapping scheme overlap adjacent patches. total number patches training qsmnet reconstruction input output share similar structures matrix size. hence u-net proposed biomedical image segmentation used base structure qsmnet. network structure modified train dipole deconvolution network consisted convolutional layers batch normalization relu nonlinear layers max-pooling layers deconvolution layers feature contracting paths. first half network four groups group contained sets convolutional layers kernel batch normalization relu. group connected max-pooling layer. second half network four groups containing additional feature concatenation layers compared first half groups. group connected deconvolution layer instead max-pooling layer. groups connected convolutional layers. finally last layer applied convolution kernel. numbers channels convolutional layers summarized bottom blocks figure training testing qsmnet total scans seven healthy volunteers acquired five different head orientations volunteer evaluation neural network patients scanned single head orientation subjects signed irb-approved written consent forms. three plane localization shimming single-echo scan acquired using following sequence parameters voxel size bandwidth hz/pixel flip angle acceleration factor total acquisition time healthy volunteers scan repeated five times instruction changing head orientation scan. scan manual shimming performed improve field homogeneity. scans acquired axially. subject motion observed scan repeated. magnitude phase images reconstructed k-space data using offline grappa reconstruction followed coil combination using sensitivities estimated espirit magnitude image brain mask generated using within mask phase image spatially unwrapped laplacian phase unwrapping local field generated removing background field using vsharp cosmos reconstruction multiple head orientation data local field maps five different head orientations registered follows first orientation magnitude image registered unrotated head orientation magnitude image calculate rotation matrix then rotation matrix applied local field registration. using registered local field rotation information generated using cosmos algorithm addition cosmos results single orientation maps generated using medi algorithms. filter truncation value medi regularization factor five head orientation phase images reconstructed generating five maps expected show consistent contrasts across head orientations. patient data also processed medi. seven healthy volunteer datasets multiple head orientations scans five subject datasets used training qsmnet scans subject dataset used validation scans subject dataset used test set. figure network structure qsmnet. u-net designed convolutional layers convolutional layer pooling layer strides deconvolution layer strides feature concatenations. figure maps test reconstructed four methods. qsmnet high fidelity gold-standard cosmos map. hand medi maps shows steaking artifacts. figure supplementary information residual error maps. three plain views maps test displayed figure residual error maps included supplementary information maps first scan neutral head orientation coronal sagittal views medi results depict streaking artifacts deteriorate image quality. hand qsmnet shows noticeable artifacts. compared cosmos result qsmnet reveals almost identical contrast. residual error maps also confirm observations residual errors lowest qsmnet quantitative metrics psnr rmse hfen ssim three reconstruction methods summarized table compared medi qsmnet results achieved highest psnr lowest rmse lowest hfen highest ssim suggesting best performances criteria. learning rate exponentially decayed every steps training. initial values convolutional kernel calculated xavier initializer batch size training stopped epochs performance shown stable. network trained evaluated using tensorflow using nvidia gpu. compare image quality maps test five head orientations processed using three reconstruction methods. reconstruction times qsmnet medi measured. reconstructed maps methods displayed three plains. residual error maps respect gold-standard cosmos generated. quantitative metrics peak signal-to-noise ratio root mean squared error high-frequency error norm structure similarity index used measure reconstruction quality algorithm calculated cosmos reference. means standard deviations metrics five head orientations compared. quantify accuracy consistency maps multiple head orientations region interest analysis performed. five rois putamen globus pallidus caudate nucleus substantia nigra manually segmented mean standard deviation calculated five head orientation maps. preliminary attempt explore applicability qsmnet patients microbleed multiple sclerosis lesions trained network reconstructed compared results medi. figure coronal view maps five head orientations. compared medi results qsmnet maps show consistent results across orientations. qsmnet maps close cosmos. arrows indicate streaking artifacts medi maps. artifacts present qsmnet map. green arrows point internal capsule reveals consistent contrast across orientations qsmnet. hand structure shows substantial contrast variations medi results. figure supplementary information axial sagittal views. reference. qsmnet results reveal excellent fidelity cosmos head orientations. compared maps methods qsmnet results reveal superior consistency across head orientations. particular medi maps suffer streaking artifacts indicated arrows qsmnet maps show artifacts. green arrows indicate internal capsule changes contrast different head orientations medi results. hand qsmnet maps reveal consistent results. axial sagittal views qsmnet maps reconfirm superior image quality unnoticeable steaking artifacts higher consistency across head orientations. mean susceptibility standard deviation across head orientations calculated rois qsmnet results show tightest error bars smallest error compared gold-standard results cosmos. result demonstrates superior accuracy qsmnet compared reconstruction methods. figure zoomed-in view figure blue circles encompass cortical ribbons cortex. qsmnet maps preserve detail structures cortical ribbon medi results lose information. figure maps patients microbleed multiple sclerosis lesions compared using medi qsmnet. lesions similarly delineated maps. multiple sclerosis lesions show positive susceptibility contrast presumably demyelination. better identified compared negative contrast contralateral side white matter. note lesion observed healthy volunteers therefore trained qsmnet. reproducibility correct physically anisotropic characteristics white matter susceptibility microstructure potential interpretation observation neural network suppresses anisotropy. suppression anisotropy expected since network trained isotropic susceptibility alternative interpretation effects anisotropy small since average head orientation believe explanations contributed results. data head orientations available training train neural network susceptibility tensor imaging generating accurate susceptibility results. medi regularization factor affects image quality. multiple regularization factors tested results still show large variability results multiple head orientations proposed neural network limitations. first input resolution fixed. lower resolution data trained resolution interpolate data processing. higher resolution data however reconstruction properly performed network datasets necessary higher resolution data. different matrix size data network still process results since convolutional layer conducts operation sequentially regardless input matrix size. network presumes z-axis input image field direction. input data different orientation matrix rotation needs applied match direction. proposed qsmnet need tested extensively healthy volunteers patients confirm validity method. additionally efforts understand characteristics network continued. advantages high quality close goldstandard high processing speed close real-time provide method valuable opportunity future applications method. figure analysis five head orientations. susceptibility values rois plotted qsmnet results match well gold-standard cosmos results smallest standard deviation work constructed deep neural network perform dipole deconvolution reconstruction. results demonstrated high quality maps close gold-standard cosmos maps. particular maps network demonstrated consistent magnetic susceptibility results multiple head orientation inputs. outcome important value since supports high reproducibility longitudinal study requires multiple scans time. preliminary patient results suggest network applied abnormality trained network although patient study limited patients. validation using large number patients different diseases lesion types warranted confirm applicability neural network patient studies. despite high expressive power biggest challenges neural network difficult characterize. since network trained data specific design target function difficult understand functions difficult interpret outcomes. hence reliability valuable criteria clinical applications difficult guarantee. therefore demonstration results needs interpreted caution. qsmnet loss function function. approach helped network learn physical model rather image image transformation. however still guarantee training result. despite concern outcomes patients encouraging since features included training sets correctly reconstructed network. therefore speculate network trained dipole deconvolution function. exploration necessary understand characteristics network. prediction beyond mean square error. arxiv preprint arxiv. hong learning deconvolution network semantic segmentation. iccv. zhang sun. delving deep rectifiers surpassing human-level performance imagenet classification. iccv s.h. y.b. z.h. origin orientation dependent white matter. neuroimage olaf ronneberger philipp fischer thomas brox u-net convolutional networks biomedical image segmentation international conference medical image computing computer-assisted intervention. springer prasoon petersen igel lauze nielsen deep feature learning knee cartilage segmentation using triplanar convolutional neural network. image comput comput assist interv rampasek goldenberg tensorflow biology's gateway deep learning? cell syst schweser sommer deistung reichenbach j.r. quantitative susceptibility mapping investigating subtle susceptibility variations human brain. neuroimage shmueli zwart j.a. gelderen t.q. dodd s.j. duyn j.h. magnetic susceptibility mapping brain tissue vivo using phase data. magn reson smith s.m. fast robust automated brain extraction. brain mapp teramoto fujita yamamuro tamaki automated detection pulmonary nodules pet/ct images ensemble false-positive reduction using convolutional neural network technique. phys uecker murphy m.j. virtue elad pauly j.m. vasanawala s.s. lustig espirit--an eigenvalue approach autocalibrating parallel sense meets grappa. magn reson wang quantitative susceptibility mapping decoding data tissue magnetic biomarker. magn reson wharton bowtell whole-brain susceptibility mapping high field comparison multiplesingle-orientation methods. neuroimage wharton bowtell fiber orientation-dependent white matter contrast gradient echo mri. proc natl acad wharton schafer bowtell susceptibility mapping human brain using threshold-based k-space division. magn reson guidon whole brain susceptibility mapping using compressed sensing. magn reson yang andrade scullin dyer e.l. kasthuri carlo gursoy low-dose x-ray tomography deep convolutional neural network. zichuan yifei hang nasser coquet boudier nucleinet convolutional encoder-decoder network bio-image denoising. conf proc ieee biol marques bowtell evaluation fourier based method calculating susceptibility induced magnetic field perturbations. proc ismrm salomri senneville moonen ctw. fast calculation method magnetic field inhomogeneity arbitrary distribution fsusceptibility. concepts magn reson glorot bengio. understanding difficulty training deep feedforward neural networks. international conference artificial intelligence statistics pages chen image denoising inpainting deep neural networks. burges bottou weinberger eds. advances neural information processing systems vol. south lake tahoe curran association inc.; shelhamer donahue karayev long girshick guadarrama darrell. caffe convolutional architecture fast feature embedding. arxiv. l.l. adalsteinsson fast regularization. magn reson imaging rochefort kressler spincemaille lebon wang quantitative susceptibility reconstruction phase data using bayesian regularization validation application brain imaging. magn reson duyn susceptibility imaging. magn reson jenkinson bannister brady smith improved optimization robust accurate linear registration motion correction brain images. neuroimage jenkinson smith global optimisation method robust affine registration brain images. image anal johnson alahi perceptual losses real-time style transfer super-resolution arxiv preprint arxiv.v mar. karsa biondetti punwani shmueli effect large slice thickness spacing coverage accuracy susceptibility mapping. ismrm singapore kwon accurate image super-resolution using deep convolutional networks. proceeding-ieee conference computer vision pattern recognition vol. kwon park multi-contrast image denoising parallel imaging using multilayer perceptron. int. imaging syst. technol. doi./ima. langkammer schweser shmueli kames milovic bredies buch meineke rauscher marques j.p. bilgic quantitative susceptibility mapping report reconstruction challenge. magn reson choi j.y. e.y. s.h. d.h. mechanisms anisotropy gradient echo myelin water imaging. biomed shmueli fukunaga gelderen merkle silva a.c. duyn j.h. sensitivity resonance frequency orientation brain tissue microstructure. proc natl acad wang romero tantiwongkosi duong t.q. method estimating removing streaking artifacts quantitative susceptibility mapping. neuroimage quantitative susceptibility mapping human brain reflects spatial variation tissue composition. neuroimage susceptibility tensor imaging. magn reson tong yeom kuzminski susceptibility weighted imaging quantitative susceptibility mapping brain. journal magnetic resonance imaging rochefort ledoux khalidov chen tsiouris a.j. wisnieff spincemaille prince m.r. wang morphology enabled dipole inversion quantitative susceptibility mapping using structural consistency susceptibility map. neuroimage rochefort spincemaille khalidov ledoux j.r. wang morphology enabled dipole inversion singleangle acquisition comparison cosmos human brain imaging. magn reson spincemaille rochefort kressler wang calculation susceptibility multiple orientation sampling method conditioning inverse problem measured magnetic field susceptibility source image mri. magn reson shen yang image denoising using deep fully convolutional encoder–decoder networks symmetric skip connections; arxiv preprint arxiv.. michael mathieu camille couprie yann lecun. deep multi-scale video figure first shows original local field maps scans. maps registered first scan generating registered local field registered local field cosmos computed rotated back original head orientation generate input label pairs qsmnet training. figure axial sagittal views maps three reconstruction methods cosmos maps shown last column. medi results contain streaking artifacts creating variability different orientation maps. hand qsmnet streaking artifacts visually detected head orientations. figure medi three regularization factors tested. smallest regularization substantial smoothing observed cortical structures difficult observed. value increased better delineation structures detected cost increased streaking artifacts. three values applied analysis results show persistent variability multiple head orientations. figure shows means standard deviations five orientations regularization value rois", "year": "2018"}