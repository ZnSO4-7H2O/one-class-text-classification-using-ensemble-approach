{"title": "MRI Tumor Segmentation with Densely Connected 3D CNN", "tag": "eess", "abstract": " Glioma is one of the most common and aggressive types of primary brain tumors. The accurate segmentation of subcortical brain structures is crucial to the study of gliomas in that it helps the monitoring of the progression of gliomas and aids the evaluation of treatment outcomes. However, the large amount of required human labor makes it difficult to obtain the manually segmented Magnetic Resonance Imaging (MRI) data, limiting the use of precise quantitative measurements in the clinical practice. In this work, we try to address this problem by developing a 3D Convolutional Neural Network~(3D CNN) based model to automatically segment gliomas. The major difficulty of our segmentation model comes with the fact that the location, structure, and shape of gliomas vary significantly among different patients. In order to accurately classify each voxel, our model captures multi-scale contextual information by extracting features from two scales of receptive fields. To fully exploit the tumor structure, we propose a novel architecture that hierarchically segments different lesion regions of the necrotic and non-enhancing tumor~(NCR/NET), peritumoral edema~(ED) and GD-enhancing tumor~(ET). Additionally, we utilize densely connected convolutional blocks to further boost the performance. We train our model with a patch-wise training schema to mitigate the class imbalance problem. The proposed method is validated on the BraTS 2017 dataset and it achieves Dice scores of 0.72, 0.83 and 0.81 for the complete tumor, tumor core and enhancing tumor, respectively. These results are comparable to the reported state-of-the-art results, and our method is better than existing 3D-based methods in terms of compactness, time and space efficiency. ", "text": "glioma common aggressive types primary brain tumors. accurate segmentation subcortical brain structures crucial study gliomas helps monitoring progression gliomas aids evaluation treatment outcomes. however large amount required human labor makes diﬃcult obtain manually segmented magnetic resonance imaging data limiting precise quantitative measurements clinical practice. work address problem developing convolutional neural network based model automatically segment gliomas. major diﬃculty segmentation model comes fact location structure shape gliomas vary signiﬁcantly among diﬀerent patients. order accurately classify voxel model captures multiscale contextual information extracting features scales receptive ﬁelds. fully exploit tumor structure propose novel architecture hierarchically segments diﬀerent lesion regions necrotic non-enhancing tumor peritumoral edema gd-enhancing tumor additionally utilize densely connected convolutional blocks boost performance. train model patch-wise training schema mitigate class imbalance problem. proposed method validated brats dataset achieves dice scores complete tumor tumor core enhancing tumor respectively. results comparable reported state-of-the-art results method better existing d-based methods terms compactness time space eﬃciency. glioma segmentation data provides valuable assistance treatment planning disease progression monitoring oncological patients. although deep learning technologies shown great potential natural image segmentation straightforward apply segmenting medical imaging data. work address challenging problem brain tumor segmentation using scans. major diﬃculties task class imbalance problem. since lesion areas scans extremely small many cases additional techniques need employed avoid background domination. commonly used strategy extract small patches whole volume pre-deﬁned probability centered lesion area train convolutional neural network patch-wise fashion.– approach eﬀective keep positive negative samples balanced. among literature utilizes patch-wise training schema prediction strategies widely used. ﬁrst regarded patch classiﬁcation model predicts label central voxel patch. second patch segmentation model tries dense prediction labels multiple voxels patch simultaneously. either case contextual information voxels great importance accurate predictions. kamnitsas make dense predictions shrunken feature patch. nodes receptive ﬁeld lying outside input patch predicted contribute loss. performance method using patch classiﬁcation schema substantially improves eﬃciency. work improve performance introducing multi-stage make dense predictions based scales receptive ﬁelds. furthermore model built upon densely connected blocks utilizes hierarchical architecture consider diﬀerent types brain tumors. next introduce motivations technologies employed one-by-one. receptive ﬁeld node region input signal involved multi-layer convolution node forward pass. thus size receptive ﬁeld determines much contextual information taken account. voxels require neighboring information generate correct prediction others need distant information. make model robust predict voxel based sizes receptive ﬁeld multi-stage architecture. classiﬁcation scores added obtain ﬁnal score. observe multi-stage design signiﬁcantly boosts performance. residual learning since introduced gained popularity kinds computer vision tasks. sets apart traditional plain networks introduction shortcut connections enable network much deeper. shortcut connections attenuate notorious gradient vanishing problem since gradients back-propagated directly shortcuts. another point view shortcut connections make entire network huge ensemble shallow networks boosts performance. recently densenet successor applying shortcut connections incorporates features previous layers change makes network deeper reduced number parameters. improved eﬀectiveness eﬃciency various image classiﬁcation tasks. however whether dense connections improve brain tumor segmentation remains unexplored. fully exploit hierarchical structure lesion area develop novel architecture hierarchically segments subregions ncr/net. based observation ncr/net always inside thus propose two-pathway architecture ﬁrst segment fluid attenuated inversion recovery t-weighted scans segment subregions types scans. test models multimodal brian tumor segmentation benchmark. experimental results brats indicate model achieves comparable performance state-of-the-art methods without bells whistles suggests potential model applied lesion segmentation tasks scans. innovations introduced paper summarized follows generalize densely connected blocks scenarios brain tumor segmentation tasks; introduce multi-scale receptive ﬁelds accurate voxel classiﬁcation eﬃcient dense inference; propose hierarchical segmentation structure inspired structure lesion regions. overall architecture model illustrated fig. concatenate patches flair concatenate patches native post contrast t-weighted generate separate inputs independent feature extractors share structure. pathway fig. performs binary classiﬁcation segments whole tumor background. bottom pathway fig. concatenates features extracted t-ce flair feeds -class softmax classiﬁer pathways updated training phase together. testing phase ﬁnal predictions generated bottom pathway. hierarchical pipeline boosts performance since follows label hierarchy lesion regions. flair scans mainly responsible separating regions always largest lesion areas. ncr/net regions segmented t-ce inside regions. detailed information feature extractors provided table kernels kernel size initial convolution. stage densely connected blocks utilized respectively. illustration shown fig. block convolutional layers growth rate densely connected block formulated weight matrix denotes convolution operation represents batch normalization denotes rectiﬁed linear unit activation represents concatenation outputs previous layers layer feature dimension calculated growth rate number kernels used convolutional layer feature dimension initial convolution. receptive ﬁeld region input data involved calculation node hidden layers cnn. size receptive ﬁeld particular node output convolutional layer without pooling obtained layer index kernel size current stride size model downsampling layers order preserve high resolution patches. thus receptive ﬁelds outputs stages respectively dimension kernel. convolution operation follows dense block stage. concatenation operations dense blocks features lowest highest level persist. post convolution serves purpose merging features levels abstraction. number kernels output dense block. challenges working data dealing artifacts produced inhomogeneity magnetic ﬁeld called bias ﬁeld distortion. type distortion prevalent scans jeopardize performance models. employ nitk bias correction sequences. algorithm removes intensity gradient scan. normalizing sequences nitk normalize sequence subtracting mean value dividing standard deviation. training data brats challenge includes scans patients train test model. dataset challenging since interested segmenting complete tumor also subregions tumor e.g. necrotic non-enhancing tumor peritumoral edema gd-enhancing tumor fluid attenuated inversion recovery native post contrast t-weighted t-weighted scans acquired every subject. modalities captures diﬀerent properties complete tumor hence provides additional useful information required segment gliomas subregions. randomly split whole dataset training testing sets sequences. separate validation limited amount data. instead apply -fold validation procedure tune hyper-parameters. generate training patches following steps randomly sample voxels lesion regions; extract training epoch randomly extract patches patches centered lesion area patches centered background. adam optimizer applied initial learning rate model implemented tensorﬂow. takes hours train epoch single nvidia gpu. network converges approximately epochs. randomly select sequences visualize segmentation results fig. scan slices axial plane view coronal plane sagittal plane view visualized fig. fig. fig. respectively. example segmentations notice model promising performance slices. figure suggests model ability accurately separate lesion subregions. segmentation results tumor core enhancing tumor impressive. limitation model observation predictions inconsistent along axis perpendicular axial plane. cases lesion regions concentrated center whole sequence. however model predicts benign regions surrounded lesion regions fig. fig. unlikely happen. possible reason convolution cannot capture long-term dependencies sequences patch-wise training schema. future goal address inconsistency predictions. table shows performance three state-of-the-art models ours. prediction four subregions aggregated generate complete tumor tumor core enhancing tumor reﬁne predictions given cnn. model proposed kamnitsas makes dense predictions according receptive ﬁeld voxel ﬁnal feature inspired architecture work. build almost identical pathways take original scans downsampled ones account claiming lowresolution inputs helps incorporate larger contextual information. work instead modifying inputs incorporate multi-scale contextual information making predictions diﬀerent depths network makes model incredibly eﬃcient boosts performance. proposed architecture achieves dice scores complete tumor tumor core enhancing tumor segmentation respectively. compared previous models method achieves highest dice score tumor core enhancing tumor segmentation. kamnitsas obtain highest score complete tumor segmentation. results demonstrate potential model segmentation tasks. figure randomly selected segmentation results sequences. t-ce scans segmentations ground-truth presented middle bottom respectively. complete tumor tumor core enhancing tumor indicated yellow green masks respectively. slices axial plane coronal plane sagittal plane respectively. table experiment results ablation study. separately substantiate eﬀectiveness densely connected block hierarchical inference structure multi-scale receptive ﬁelds. justiﬁed removal component impairs overall performance extent. non-dense structure. indicate improved performance dense structure build convolutional layers linear chain topology stage size receptive ﬁeld corresponds proposed model. upper convolution layer kernels lower layer makes number features predictions layers equal counterpart. components non-dense architecture proposed model. non-hierarchical structure. understand eﬀectiveness hierarchical inference structure discard pathways pipeline illustrated concatenate four types scans inputs i.e. table speciﬁcations two-stage feature extractor traditional convolutional layers feature extractor number features densely connected counterpart prediction layers. single-scale recep. field structure. verify advantage using multi-scale receptive ﬁelds remove layers stage make predictions output stage still make model predict iteration dimension input patches becomes densely conablation study results substantiate eﬀectiveness component proposed model. non-hierarchical model achieves closest overall performance proposed one. however still outperformed proposed model large margin tumor core enhancing tumor segmentation. non-dense counterpart outperformed proposed model three categories. suggests eﬀectiveness densely connected blocks obvious even though network relatively shallow compared ultra deep networks used natural worthwhile mention non-dense network rather ineﬃcient parameters introduced. model single-scale receptive ﬁeld lowest accuracy. demonstrates taking account diﬀerent levels contextual information signiﬁcantly boost classiﬁcation accuracy. paper introduce approach brain tumor segmentation scans. densenet initially introduced image classiﬁcation problem. work explore potential densely connected blocks segmentation tasks. compared traditional networks skip connections improved information extracts better features signiﬁcantly help optimization. take multi-scale receptive ﬁelds account accurately classify voxels. model made predict voxels iteration increase eﬃciency. experimental results indicate proposed model performs stateof-the-art models without advanced tricks. ablation study substantiates eﬀectiveness component whole architecture. thus conclude proposed model great potential segmentation medical image segmentation tasks. kamnitsas ledig newcombe simpson kane menon rueckert glocker eﬃcient multi-scale fully connected accurate brain lesion segmentation medical image analysis ioﬀe szegedy batch normalization accelerating deep network training reducing internal covariate shift proceedings international conference machine learning lille france july", "year": "2018"}