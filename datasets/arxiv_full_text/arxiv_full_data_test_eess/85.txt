{"title": "Coupling Brain-Tumor Biophysical Models and Diffeomorphic Image  Registration", "tag": "eess", "abstract": " We present the SIBIA (Scalable Integrated Biophysics-based Image Analysis) framework for joint image registration and biophysical inversion and we apply it to analyse MR images of glioblastomas (primary brain tumors). In particular, we consider the following problem. Given the segmentation of a normal brain MRI and the segmentation of a cancer patient MRI, we wish to determine tumor growth parameters and a registration map so that if we \"grow a tumor\" (using our tumor model) in the normal segmented image and then register it to the patient segmented image, then the registration mismatch is as small as possible. We call this \"the coupled problem\" because it two-way couples the biophysical inversion and registration problems. In the image registration step we solve a large-deformation diffeomorphic registration problem parameterized by an Eulerian velocity field. In the biophysical inversion step we estimate parameters in a reaction-diffusion tumor growth model that is formulated as a partial differential equation.  In this paper, our contributions are the introduction of a PDE-constrained optimization formulation of the coupled problem, the derivation of the optimality conditions, and the derivation of a Picard iterative scheme for the solution of the coupled problem. In addition, we perform several tests to experimentally assess the performance of our method on synthetic and clinical datasets. We demonstrate the convergence of the SIBIA optimization solver in different usage scenarios. We demonstrate that we can accurately solve the coupled problem in three dimensions ($256^3$ resolution) in a few minutes using 11 dual-x86 nodes. Also, we demonstrate that, with our coupled approach, we can successfully register normal MRI to tumor-bearing MRI while obtaining Dice coefficients that match those achieved when registering of normal-to-normal MRI. ", "text": "abstract present sibia framework joint image registration biophysical inversion apply analyse images glioblastomas given segmentation normal brain segmentation cancer patient wish determine tumor growth parameters registration grow tumor normal segmented image register segmented patient image registration mismatch small possible. call coupled problem two-way couples biophysical inversion registration problems. image registration step solve large-deformation diffeomorphic registration problem parameterized eulerian velocity ﬁeld. biophysical inversion step estimate parameters reaction-diffusion tumor growth model formulated partial differential equation sibia couple steps iterative manner. ﬁrst presented components sibia gholami framework scalable biophysics-based image analysis ieee/acm proceedings derived parallel distributed memory algorithms software modules decoupled registration biophysical inverse problems. paper contributions introduction pde-constrained optimization formulation coupled problem derivation optimality conditions derivation picard iterative scheme solution coupled problem. addition perform several tests experimentally assess performance method synthetic clinical datasets. demonstrate convergence sibia optimization solver different usage scenarios. demonstrate using sibia accurately solve coupled problem three dimensions minutes using dual-x nodes. keywords biophysically constrained diffeomorphic image registration tumor growth atlas registration adjoint-based methods parallel algorithms present sibia framework comprises mathematical formulation algorithms software joint image registration biophysical inversion. given volumetric segmentation magnetic resonance imaging dataset glioma patient sibia simultaneously registers declarations interest none email addresses klaudius.scheufeleipvs.uni-stuttgart.de andreasmath.uh.edu amirghberkeley.edu christos.davatzikosuphs.upenn.edu birosices.utexas.edu miriam.mehlipvs.uni-stuttgart.de figure summarize joint registration biophysical inversion sibia. shows segmented healthy brain tumor-bearing atlas brain generated biophysical simulation patient tumor registered atlas tumor-bearing patient brain. inputs images outputs tumor growth parameters registration parameters images sibia compute tumor-growth registration parameters images similar possible. example biophysical tumor growth parameters initial conditions reaction-diffusion equation. registration parameterized using eulerian framework velocity ﬁeld used advect image image image segmented dataset normal brain biophysical tumor growth model. joint registration-biophysical inversion approach motivated practical problems often need calibrate complex macroscopic biophysical models using single-time snapshot dataset. since biophysical model typically dynamical system unclear model parameters using single-time dataset since don’t initial state. replacing missing second patient snapshot healthy atlas coupling registration patient atlas tumor growth model attempts resolve problem. want register normal images images abnormalities. normal-to-abnormal registration ﬁnds applications surgical planning longitudinal studies followups population studies. focus applying sibia registration segmented normal images segmented images glioma patients. many image analysis workﬂows gliomas involve ﬁtting biophysical models tumor characterization prognosis image registration image segmentation many methods image analysis biophysical modeling problems essential step solution inverse tumor-growth problem i.e. instance calculation initial conditions tumor growth; process combined registration segmentation speciﬁc scenario interested summarized fig. given single snapshot multi-modal glioma patient. assume obtained segmentation healthy tissue abnormal tissue i.e. labels white matter gray matter cerebrospinal ﬂuid cerebellum ventricles tumor since tumor-growth problem typically time dependent problem need least time snapshots invert parameters ideally would like pre-cancer image healthy brain patient white gray structure don’t have though. basic idea tackle issue pre-segmented normal healthy brain means create second snapshot. step requires registration. best describe consider forward problem assume given atlas tumor-growth model deformation then ﬁrst apply tumor growth model healthy image produce segmentation healthy tissue tumor. second step warp image using given deformation map. image tumor-plus-deformation warped atlas. inverse problem seek compute tumor-growth parameters deformation parameters tumor-plus-deformation warped atlas image matches patient image. thus sibia combines following steps forward tumor solver growing virtual tumor segmented healthy atlas brain inverse tumor solver determining initial condition tumor growth given observation later time forward linear advection solver implicitly computes warped image given velocity ﬁeld large-deformation diffeomorphic image registration solver. inversion registration optimization problems. instead using gradient descent method propose picard iteration scheme solving system based modular tumor image registration components generic idea extended problems. conduct numerical experiments synthetic real data demonstrate validity efﬁciency approach particular show picard iteration reduces gradient converges local minimum. examine sensitivity solver choice tumor model variant. consider three variants tumor model reaction model reaction-diffusion model simple radial basis approximation variants used depending goal analysis. several limitations unresolved issues remain. main limitation don’t theoretical proof picard scheme converges provide empirical evidence. second limitation tumor model include mass-effect simple phenomenological reaction-diffusion model model although proven quantitatively useful image analysis tumor characterization limited predictive capabilities. predictive capabilities limited. currently working integrating mass-effect considered critical characterizing tumor aggressiveness well richer reaction-diffusion models. sibia naturally extended complex models although course tests necessary demonstrate convergence picard scheme. presented fast algorithms individual components sibia introduced computational kernels demonstrated scalability large images distributed-memory architectures. problem formulation results mixed-type pde-constrained optimization problem poses signiﬁcant numerical challenges. refer general introduction pdeconstrained optimization reviews application medical image analysis. limit work closely related following. ﬁrst component sibia image registration. refer general overview medical image registration. registering atlas patient requires ﬁnding correspondences topologically different images—one tumor without tumor. issue ill-deﬁned correspondence arising presence tumor images registered. simple strategy deal issue consider tumor area non-informative mask optimization relax registration area affected tumor this however yields poor registration quality tumors severe tissue deformation mass effect. another strategy simultaneously invert deformation drift intensity representing imaging abnormality associated tumor also applied registration problems topological differences produce acceptable results purpose atlas-based segmentation registration used context model prediction—which ultimate goal. prior work diffeomorphic image registration forms basis proposed methodology based pioneering work additional references). second component sibia calibration brain tumor models medical imaging data associated operator parabolic non-linear reaction-diffusion equation despite phenomenological character model capable generating simulations good agreement observations abnormalities standard imaging data used groups besides implementation features inversion operators initial tumor concentration diffusivity parameters growth rate related optimal control formulations e.g. found unlike existing approaches parameterization problem allows invert multifocal tumors. numerical methods solving tumor calibration problem based either point estimate bayesian inference methods bayesian inference characterizes uncertainty model parameters. paper focus methods point estimates using adjoint formulation. approach extended bayesian setting integration biophysical brain tumor simulations deformable image registration purely mechanical model tumor progression used. limitations work model oversimpliﬁed; provide capabilities generate tumors complex shapes models provide information progression inﬁltration cancerous cells surrounding healthy tissue.the proposed formulation share limitations. work closest here authors present framework joint segmentation registration tumor modelling. likewise ours approach based constrained optimization problem constraint non-linear mixed-type reaction-diffusion-advection equation tumor cell density. sets work apart solver efﬁcient parallel implementation derivation optimality systems fully coupled problem; parameterization initial condition tumor allows represent multifocal tumors also signiﬁcantly simplify constraint without loosing segmentation accuracy; ﬁnally integration state-of-the-art algorithm constrained large deformation diffeomorphic image registration present proposed formulation biophysically constrained diffeomorphic image registraiton show optimality systems problem complex space-time multi-physics operators pose signiﬁcant numerical challenges. motivate explain choices forward operators tumor model registration present associated inversion operators. discuss algorithmic details. summarize setup experiments present numerical results real synthetic data conclude additional material provided §appendix segmentation labels probability maps. healthy brain tissue type i.e. gray matter white matter cerebrospinal ﬂuid separate probability map. represent probability maps space-time vector ﬁeld deﬁned space-time interval boundary domain occupied brain tissue denoted fourth probability also deﬁned output tumor forward simulation represents space-time domains dependency time space. formulations explicitly include dependency spatial position time dependency. instance denotes initial tumor probability deﬁned atlas image whereas tumor time point time associated patient image. probability maps atlas image evolve non-dimensional time interval diffeomorphic image registration introduce pseudo-time variable invert stationary velocity ﬁeld physical meaning; associate undeformed patient image deformed representation. make explicit deﬁnitions below. vector notation. given vector ﬁeld compute ij=∈ given velocity ﬁeld indicates matrix-vector multiplication. standard scalar product denoted outer product vector ﬁelds denoted addition propose coupled formulation based diffeomorphic image registration inverse tumor growth simulation. input take tumor-free atlas brain geometry tumor-bearing patient geometry plus patient’s tumor probability formulation based optimal control theory results coupled pde-constrained optimization problem. invert stationary velocity ﬁeld parameter vector mass-source follows measure discrepancy simulated tumor atlas space initial condition parametrized transported probability cancerous cells patient data initial condition discrepancy healthy tissue probability maps atlas space tumor transported probability maps healthy tissue patient data initial condition remaining parameters deﬁned follows diffusion tensor ﬁeld parametrized scalar weights specify diffusivity details) growth parameter logistic growth function different values gray matter white matter vanish everywhere else. although implementation general experiments isotropic diagonal tensor image registration velocity used transport brain geometry tumor concentration patient atlas space. deﬁnes model effect tumor growth brain geometry atlas space. solve coupled inverse problem gradient-based optimization. method lagrange multipliers transform constrained problem unconstrained one. lagrangian reads note haven’t given equation operator pseudo-differential operator derived eliminating discuss summary ﬁrst-order optimality conditions comprise system non-linear partial differential equations quite formidable since ﬁelds addition tumor initial condition parameters given need solve ﬁrst-order optimality pdes state adjoint inversion variables. elimination method solve equations. assume state adjoint equations fulﬁlled exactly require vanishing variations lagrangian respect inversion variables admissible solution problem. algorithm iterate eliminate given wish compute gradient i.e. used update respectively. gradient computation involves following steps compute coupling adjoint variable equation solve adjoint tumor equations solve adjoint registration equations evaluate gradients using inversion equations stationary point vanishes. present details tumor forward problem registration forward problems respectively. addition formulate separate inverse problems tumor growth image registration used high-level components coupling algorithm presented latter based picard iteration using tumor registration modular components instead gradient descent newton method line search coupled problem forward tumor problem. model tumor growth based population density main phenomena included proliferation cancerous cells migration cancerous cells surrounding healthy tissue proliferation model logistic growth function reaction coefﬁcient denotes scaling spatially variable characteristic growth rate parameters deﬁned white gray matter i.e. mgm. migration model based inhomogeneous diffusion process diffusion coefﬁcient here scaling factors isotropic anisotropic parts diffusion tensor weighted diffusion tensor modelling anisotropy. test cases always isotropic diffusion i.e. isotropic part kwmwm kgmgm. yields non-linear parabolic non-constant coefﬁcients tumor concentration given parametrization tumor initial condition originally np-dimensional space spanned gaussian basis functions i.e. gaussian basis functions gaussians zero prevent spurious diffusion cancerous cells mapping parametrization initial conditions tumor density time simple model means predictive de-facto standard approach comes modeling tumor progression seen medical imaging results available literature suggested model offer predictive capabilities integrated medical imaging information usefulness segmentation registration algorithms normal atlas information producing features augment image-based features tumor staging prognosis. note unlike stated tumor problem neumann boundary conditions actual biophysical problem. numerical implementation however extend small parameter discretize using periodic boundary conditions penalty approach approximate boundary conditions ∂ωb. show ‘’ﬁctitious domain method‘’ approximates reﬁne discretization converges correct solution inverse tumor problem. inverse tumor problem seek initial condition forward tumor problem recovers given tumor concentration time good possible i.e. solve minimization problem note inverse tumor problem contrast minimize mismatch observed predicted tumor cell population density; healthy tissue mismatch used tumor solver ’knows’ altas. addition deﬁnes concrete instance tumor regularization operator neglecting boundary conditions lagrangian reads vector ﬁelds. template image given probability maps patient’s healthy anatomy areas except part hidden tumor. treat probability tumor individual entity make coupled formulation accessible. register three probability maps healthy tissue tumor concentrations. advective image transformation given template image tumor concentration stationary velocity ﬁeld forward problem describes advective transformation pseudo-time interval periodic boundary conditions. augment formulation additional constraint divergence better control jacobian computed deformation additional details) image registration inverse problem i.e. actual image registration look velocity advects given template images images close possible corresponding images atlas brain solve following minimization problem mentioned before operator pseudo-differential operator comes elimination step inversion variable case exact incompressibility leray projection ∇∇−div non-zero projection operator becomes slightly main contribution paper picard iteration scheme instead solving using gradient descent newton scheme modular approach combine tumor growth inversion diffeomorphic registration models picard iteration scheme. scheme iteratively improves tumor initial condition’s parametrization registration velocity allows establish coupling components easy stable modular efﬁcient way; submodules exchanged required. instance simple tumor solver replaced sophisticated approaches. results presented demonstrate picard iteration powerful approach reduces gradient given algorithms individual subblocks published main ingredients described follows pdes spatially discretized spatial derivatives although formulation higher derivatives) computed using fourier transforms. present derivatives strong form implementation discretize-then-optimize approach tumor equations optimize-then-discretize approach registration. solution pure advection equations done using semi-lagrangian time-stepping scheme avoid stability issues small time-steps. krylov matrix-free newton methods linear nonlinear solvers. picard iteration scheme coupled optimization problem without line search. following subsections give details proposed picard iteration scheme give short overview numerical methods used solve tumor image registration forward inverse problems. initialize picard iteration start initial guess compute center mass given patient tumor place gaussian basis functions tumor initial condition parametrization regular grid around center mass. current algorithm grid gaussian basis functions ﬁxed throughout picard iterations i.e. re-compute center mass tumor advect gaussian basis functions velocity algorithm picard iteration executes following steps given grow tumor atlas space. seeds atlas brain tumor; update probability maps atlas space using deﬁne picard iteration useful introduce operator important facts note solution former iteration initial guess next iteration reduce runtime perform continuation regularization parameter explain below. proof convergence proposed picard scheme minimizer fully-coupled optimization problem proof beyond scope present paper remains future work. provide numerical evidence shows scheme reduces gradient fully-coupled problem. discuss below. parametrization tumor initial conditions atlas brain probability maps individual patient input implemented gradient coupled problem order verify picard iteration actually reduces gradient global optimization problem. implementation scheme iterates simultaneously control variables requires work addressed follow-up paper. show experimentally various settings algorithm effective generates registration results excellent agreement patient data. next give additional details numerical methods used sibia. parameter continuation. combination tikhonov-type regularization parameter continuation stabilize registration problem also identify adequate regularization parameter h-sobolev norm every picard iteration follows. specify lower admissible bound determinant deformation gradient start picard iteration reduced order magnitude speciﬁed lower bound determinant deformation gradient breached candidate registration solver disregards associated solution sets restarts inversion velocity former picard iteration initial guess. process repeated lower bound determinant deformation gradient longer violated. violation determinant deformation gradient detected registration solve ﬁnalize current picard iteration proceed next iteration. stopping conditions. ﬁnalize picard iteration either reaches prescribed minimum requested results violation user deﬁned lower bound determinant deforoptimality conditions complex multi-component non-linear operators state adjoint control ﬁelds. employ inexact globalized preconditioned gauss– newton–krylov method problems. reduced space methods second order optimality conditions similar structure ﬁrst order optimality conditions; employ numerical strategies solution operators ﬁrst order optimality conditions refer details reduced space hessian system discretization. numerical solution discretization operators. discretize forward adjoint tumor registration problems space time regular grids consisting grid points. spatial differential operators spectral projection scheme described mapping spatial spectral coefﬁcients done using ffts corresponding spectral collocation scheme assume functions formulation periodic continuously differentiable apply ﬁltering operations periodically extensions discrete data meet requirements. solve forward adjoint tumor problem unconditionally stable second-order strang-splitting method split right-hand side diffusion reaction details). diffusion sub-steps solved using implicit crank–nicolson method. solver preconditioned conjugate gradient method ﬁxed tolerance reaction sub-steps solved analytically. enforce positivity constraint initial tumor concentration apply forward operator make sure thresholding operation necessary since parametrization allows negative concentrations initial condition logistic growth function would amplify negative values time. image registration module solve hyperbolic transport equations based semi-lagrangian scheme semi-lagrangian schemes hybrid lagrangian eulerian schemes. unconditionally stable like lagrangian schemes example context diffeomorphic registration) require evaluation space-time ﬁelds appear optimality conditions off-grid locations deﬁned characteristic associated compute values space-time ﬁelds off-grid locations cubic lagrange polynomial interpolation model. time integration computing characteristic solution ordinary differential equations along based second order accurate runge–kutta scheme. refer precise deﬁnition computations. newton–krylov solver. initialize solvers reduced gradient systems zero initial guess inexact globalized preconditioned gauss–newton–krylov method. terminate tumor inversion relative change norm reduced gradient user deﬁned threshold opttolt reference gradient gradient obtained zero initial guess ﬁrst picard iteration. registration problem combination relative change norm gradient objective control variable controlled single parameter opttolr stopping criterion. also specify maximal number newton iterations lower bound absolute norm gradient safeguard prohibitively high number iterations. details stopping conditions found discussion. invert inner linear systems using matrix-free method. terminate method either reach predeﬁned tolerance relative residual norm method exceed maximum number iterations perform inexact solves tolerance proportional norm reduced gradient problem. idea invert hessian accurately optimum details approach found parallel implementation described detail pencil decomposition ffts distribute data among processors. denote number tasks task gets total values. open source library accfft supports parallel single double precision computations. parallel linear algebra operations petsc well it’s optimization interface computational kernel besides ffts cubic lagrange polynomial interpolation model used semi-lagrangian time integration hyperbolic transport equations. refer additional details parallel implementation interpolation kernel. provide algorithmic complexity analysis registration atav. ﬁrst class synthetic test cases used proof concept assess convergence picard scheme robustness respect tumor model sensitivity tumor reconstruction quality terms tumor model parameters. uses analytic tumor analytic velocity details. comes three different ﬂavours atav-reac reaction diffusion disabled atav-dif reaction-duffusion model atav-ld reaction diffusion disabled small number gaussian basis functions initial condition. determined experimentally purely synthetic test case image resolution gaussian basis function. variations test cases observed inversion sensitive respect accordingly ﬁxed test cases. smaller values reduce tumor mismatch picard iteration scheme. initialize gaussian basis sub-domain grid basis functions chosen priori synthetic test cases determined automatically real patient data cover actual tumor volume optimal center grid parameterization center mass tumor. stands low-dimensional. active gaussian basis functions limited support small neighbourhood surrounding center mass patient’s tumor. test cases allow grid gaussian cover entire area identiﬁed tumor patient data. ∞-ball covers entire patient’s tumor support domain covered basis functions adjust standard deviation gaussian functions distance centers automatically. values chosen quotient remains constant equal value used synthetic cases. allows ensure similar conditioning ﬁxed choice depends appearance patient’s tumor need able parameterize sufﬁciently complex initial conditions recover tumors complex appearance. accordingly invert varying number parameters case-by-case basis class synthetic test cases image resolution able perform experiments limited time real patient data ensure high accuracy. table common parameters used test cases opttolr opttolt convergence tolerances registratioin tumor inversion regularization parameter tumor inversion spacing gaussian basis function standard deviation; initial ﬁnal values β-continuation scheme described applied image registration determined based values shown yield best results numerical tests rtrv test problem. data. generation synthetic cases normal brain imaging data obtained university pennsylvania. test case real imaging data data available ﬁrst iteration glistr data results patient data used study presented consider datasets repository original datasets labels picard iterations. particular contain background white matter gray matter cerebellum cerebrospinal ﬂuid ventricles edema enhancing tumor necrotic tumor construct labels integrating brains labels white matter gray matter cerebrospinal ﬂuid background motivation introducing additional label technical. ensure partition unity across probability maps i.e. labels one. example atlas data performance measures. perform registration patient space atlas space. however report performance measures patient space since patient space relevant space applications point view important point note velocity based image registration offers immediate access inverse deformation applied image; essentially solve forward problem negative velocity obtain action inverse deformation map. following measures assess performance approach relative mismatch/residual patient anatomy atlas anatomy registration relative mismatch/residual patient tumor atlas table summary parameters generation synthetic test cases inversion. report values following parameters denotes grid size used discretization problem; characteristic reaction factors white gray matter overall reaction scaling factor characteristic diffusion parameters white gray matter overall scaling parameter isotropic part inhomogenious diffusion coefﬁcient migration cancerous cells surrounding tissue; number gaussian parameterization tumor initial condition standard deviation associated gaussian basis functions maxiti denotes maximum number newton iterations krylov iterations tumor inversion registration respectively dice coefﬁcient dicelb individual label maps associated probability maps patient atlas anatomy well average dice coefﬁcient diceb across labels dicelbc |h)) |h))| also report values dice coefﬁcient computed probability maps tumor denoted dicet. further monitor relative change gradient coupled problem ﬁnal iteration gradient coupled optimization problem picard iteration gradient initial guess. finally relative -error computed velocity initial condition true tumor parameters synthetic test problem) ﬁnal iteration hardware. runs test cases executed tier- supercomputer hazelhen high performance computing center hlrs stuttgart cray system peak performance petaﬂops comprising nodes xeon processors cores sockets node. nodes connected aries interconnect. data sizes nodes tasks nodes tasks. purpose. experiment proof concept. test numerical accuracy scheme identify inversion accuracies ideally expect study convergence solver.. atav-reac atav-dif addition test sensitivity approach respect pertubations model model parameters. atav-ld restruct admissible initial condition parametrization tumor growth dimensionality order exclude fully grown tumors initial conditions. examine whether increases sensitivity reconstruction quality tumor respect correct model parameters. setup. atav based real brain geometries uses tumor grown forward solver synthetically generated patient image. resolution choose deﬁnes choose deform atlas grown tumor advecting probability maps negative velocity gives velocity generated registering tumor-free images different individuals e−). center mass synthetic tumor initial condition artiﬁcial tumor generation enable gaussians center grid gaussians. details parameters. baseline also report results sole registration healthy anatomy addition that quantify numerical error scheme solving transport equations done solving forward problem twice original reverted velocity. associated error given whereas disable diffusion atav-reac full tumor model including diffusion atav-dif. atav-reac growth rates scaling scaling used growing tumor inversion reconstruct initial condition. atav-dif values reaction diffusion coefﬁcients inversion picard iterations either differ used generation tumor. atav-ld full reaction-diffusion tumor model enforce initial tumor small i.e. invert parameters results grid gaussians cover true initial condition artiﬁcially grown tumor. expect increase sensitivity inversion respect tumor parameters inversion consider variety models model parameter combinations includes ‘’correct‘’ tumor parameters. also consider case completely neglect tumor model invert basis. results. report results registration anatomy tab. results inversion atav-reac presented fig. assess reconstruction quality reduction reduced gradient respect iteration index. also report error ground truth estimated iterates well relative norm gradient fully coupled problem general considering real data forward model is—at best—a crude approximation actual observations. ﬁrst expect registration algorithm recover bio-physically meaningful deformation brain anatomies different subjects second forward tumor model realistic reduction list runtime picard scheme iteration percentage spent individual solver respectively. note tumor registration runtimes parts code calculation reduced gradient steering picard iteration included measurements. atav-ld show simulation results fig. report quantitative results tab. plot trend relative tumor mismatch respect regularization parameter sobolev norm registration velocity fig. table reference results geometry registration healthy atlas healthy patient. table shows values relative mismatch geometry associated dice coefﬁcient diceb well relative -error reconstruction velocity ﬁeld respect ground truth table results analytic tumor analytic velocity non-zero diffusion test case; ground truth −v). report values norm residual respective probability maps different brain tissue classes tumor patient space mean dice coefﬁcient brain tissue diceb tumor dicet respectively well relative norm gradient grel global coupled problem report results different values used inversion report time spent iteration total entire picard inversion amount time spent tumor inversion image registration seconds respectively. note latter sums less explicitly measure time spent additional coupling functionality forward solvers. runs performed using tasks three nodes hazelhen block shows course inversion respect picard iteration index correct parameters four rows bottom show ﬁnal result picard scheme different parameter model combinations. observations. important observation reconstructed data excellent agreement patient data able reduce reduced gradient orders magnitude less iterations picard scheme atav-reac signiﬁcantly factor experiments atav-dif atav-ld. figure results analytic tumor analytic velocity reaction-only test case; ground truth −v). ﬁgure shows probability maps labels healthy atlas brain patient brain tumor generated tumor grown atlas known atlas patient advection velocity show initial conﬁguration problem ﬁnal conﬁguration joint registration tumor inversion target patient data contains probability maps residual differences probability maps hard segmentation based given probabilities individual tissue classes. table bottom provides quantitative results inversion. report average mismatch probability maps brain tissue labels tumor mean dice coefﬁcient brain tissue diceb tumor dicet respectively. reconstruction quality given terms convergence towards ground truth respectively expect error zero several reasons. first loose information construct test case second numerical solver introduces errors addition report change update velocity across successive iterations vk−/vk−. finally also list relative norm gradient coupled problem grel). registration problem. also reconstruction seems bounded error. fact advection error leads mismatch order atlas domain best expect without over-ﬁtting data. similar observations made compare inversion results results obtained registration healthy brains reported tab. hence quality tumor reconstruction comparable quality pure image registration healthy geometries. excellent result clearly demonstrates potential approach. obtained dice coefﬁcient brain anatomy order sole registration healthy anatomies. note mismatch true velocity recovered velocity reported atav-reac fact image figure mismatch reduction function regularization parameter analytic tumor analytic velocity diffusion low-dimensional initial condition test case; ground truth n/a). initial condition parameterized gaussians analytic tumor non-zero diffusion. plot shows relative mismatch tumor probability patient space. note reduce factor picard iteration; plot shows mismatch reduction picard iterations read right left. figure tumor brain labels analythic tumor analythic velocity non-zero diffusion low-dimensional initial condition test case; ground truth n/a); ’correct’ tumor parameters different settings registration inherently ill-posed problem velocity reconstructed exactly image areas non-zero gradients non-zero intensity differences images registered areas correspond another. addition reconstruction vector ﬁeld scalar data. dice coefﬁcient brain anatomy increases atav-reac obtain ﬁnal dice coefﬁcient tumor. results atav-dif atav-ld show used model dimensionality initial conditions signiﬁcant impact quality inversion furthermore signiﬁcantly reduce norm reduced gradient .e−. also reached target regularization parameter make progress. update velocity tends zero changes reduced gradient small error measures longer change signiﬁcantly. atav-dif obtain slightly better mismatch dice coefﬁcient tumor probability correct results suggest identify correct multiple inversions initial condition. however note differences small test case; ground truth n/a). low-dimensional parameterization initial condition gaussians report mismatch probability maps brain tissue tumor patient space mean dice coefﬁcient hard segmentations brain tissue tumor respectively relative norm gradient grel) coupled problem assess ﬁnal state reconstruction using different values e−}. absolute timings given tumor inversion image registration respectively using tasks three nodes hazelhen. note latter sums less reported total time explicitly measure time spent additional coupling functionality forward solvers. always reach target value treg respectively tumor). overall obtain excellent agreement patient data atlas data irrespective model choice. observations conﬁrmed careful visual inspection fig. explained parameterization initial condition. reconstruct complex tumor shapes even simple model. overall indicates using reaction-only model might sufﬁcient pure diffeomorphic image registration comparison total time last tab. total runtimes attained enabling diffusion shows save factor runtime disabling diffusion. another interesting behavior within scheme that ﬁrst iterations time spent tumor inversion whereas reduce registration work. expected since runtime scheme diffeomorphic registration independent important observation atav-ld identify correct pair diffusion reaction rate used generate synthetic test based slightly pronounced differences overall mismatch dice scores atav-dif. sensitivity respect changes diffusion parameter larger respect changes growth rate expect much pronounced dependence diffusion model parameterize initial condition grid smaller support since need cancerous cells diffuse areas distant tumor center order able reconstruct whole tumor. trend relative mismatch tumor fig. highlights effect. curves almost cluster terms different choices diffusion coefﬁcient; overall achieve signiﬁcantly better mismatch choose correct diffusion coefﬁcient. also curves plateau much earlier cases wrong parameter combinations. tumor mismatch takes values dice score .e−. conclusion conclude picard scheme efﬁcient converges valid minimum search space attain excellent agreement data predicted state ﬁnal dice coefﬁcient labels anatomy tumor atav-reac slightly worse values atav-dif atav-ld. integration diffusion model inversion costly least current implementation. designing efﬁcient forward solver diffusion operator requires work. could demonstrate parameterization initial condition allows generate high-ﬁdelity registration results especially healthy anatomy irrespective model used generate data. clearly preliminary results provide evidence reactionmodels might sufﬁcient pure image registration also observe subtle differences reconstruction quality tumor ‘’correct‘’ growth rate inversion atav-dif pronounced atav-ld. overall conclude neglect diffusion model context diffeomorphic registration compensate resulting loss accuracy higher-dimensional gaussian basis might able identify appropriate growth rates multiple inversions different parameters lowdimensional gaussian basis setup. test scenario consists real patient brains real tumors know parameters. patient datasets ﬁrst proposal patient segmentation produced ﬁrst iteration glistr provide additional details databasis identify support domain spanned gaussian basis functions tumor initial condition parametrization well spacing standard deviation unseen patient. done automatically. real tumors multifocal gaussians ﬁrst experiments brains initial condition parametrization. contrast synthetic test cases atav-reac atav-dif atav-ld allow tumor grow also gray matter instead white matter only reaction parameter times smaller white matter variety models parameter settings picard scheme patients aamh aaan assess performance method also study sensitivity towards parameter changes model complexity. vary reaction parameter choose diffusion coefﬁcient either .e−. additional details setup test case parameters. results. fig. fig. show healthy atlas corresponding patient image tumor bottom axial saggital coronal orientations. hard segmentations results computed proposed approach shown middle using orientations. tab. summarize results patient datasets. report initial ﬁnal values mismatch dice coefﬁcients associated probability maps tumor brain anatomy well relative norm gradient coupled problem also report timings entire inversion. fig. shows detailed images probability maps patient aamh detailed visual results information iterations inversion algorithm patients given §appendix results varying reaction diffusion aamh aaan listed tab. note parameter choices refer model used tumor reconstruction picard scheme. true growth parameters tumors unknown. observations. important observation obtain good registration results— qualitatively quantitatively—in extremely challenging registration problem. visual figure tumor brain labels real tumor real velocity test case; ground truth patients aamh aaan. parameters tumor solver gaussians inversion. shows original atlas image. bottom shows patient image. middle shows solution coupled scheme. figure tumor brain geometry real tumor real velocity test case; ground truth patients aaac aamp. parameters tumor solver gaussians inversion. shows original atlas image. bottom shows patient image. middle shows solution coupled scheme. figure tumor brain geometry real tumor real velocity test case; ground truth patients aaqd aawi. parameters tumor solver gaussians inversion. shows original atlas image. bottom shows patient image. middle shows solution coupled scheme. table summary results real tumor real velocity test case ground truth based real clinical data tumor parameters parametrization tumor initial conditions gaussians. report mismatch brain tissue probability maps tumor probability patient space mean dice coefﬁcient hard segmentation corresponding brain tissue tumor respectively well relative norm gradient coupled problem grel). also report total time seconds time individual components picard scheme respectively note latter sums less reported total time explicitly measure time spent additional coupling functionality forward solvers. execute code parallel nodes using tasks hazelhen. figure results real tumor/ real velocity test case ground truth aamh patient. ﬁgure shows probability maps labels healthy atlas brain aamh patient brain probability maps tumor along reconstructed probability maps i.e. ﬁnal result inversion algorithm table report mismatch brain tissue probability maps tumor probability patient space mean dice coefﬁcient hard segmentation corresponding brain tissue tumor dicet respectively well relative norm gradient coupled problem grel). also report time iteration seconds percentages runtime spent tumor solver image registration solver respectively. note latter sums less explicitly measure time spent additional coupling functionality forward solvers. last shows ﬁnal state summed absolute timings respective solvers seconds. inspection data alone immediately signiﬁcant anatomical differences atlas image patient images accross patients. tumors vary signiﬁcantly shape size. overall poses considerable challenges framework. results reported fig. fig. fig. clearly demonstrate deformed atlases good agreement patient data subjects. reach dice coefﬁcients probability maps associated anatomy tumor. results slightly worse obtained artiﬁcially grown tumors former sections still competitive. also note initial dice coefﬁcients anatomy range data drastically worse seen synthetic test cases. runtimes compareable former experiment. achieve reduction relative norm gradient coupled problem orders magnitude results study varying tumor model parameters presented tab. show slight variances results depending parameter choices picard iteration scheme successful cases. enhancements environment required table results aamh aaan patient real tumor/ real velocity test case ground truth using real clinical input data. table shows mismatch brain tissue probability maps tumor probability patient space mean dice coefﬁcient hard segmentation corresponding brain tissue tumor respectively different values reaction scaling parameter diffusion coefﬁcient scaling parameter well relative norm gradient coupled problem grel). also report total time seconds time individual components picard scheme respectively note latter sums less reported total time explicitly measure time spent additional coupling functionality forward solvers. execute code parallel nodes using tasks hazelhen. conclusions tested formulation real data pose signiﬁcant challenges large inter-subject anatomical variability strong variation appearance tumor shape size location growth behaviour. simple model accounts logistic growth. this combination ﬂexible high-dimensional parameterization initial condition allows overcome challenges. achieve extremely promising registration accuracies dice score label maps associated probability maps brain anatomy tumor extremely challenging problem. runs variation growth parameter show hand important identify correct parameters achieve optimal quality tumor reconstruction. therefore believe possible identify physical tumor growth parameters coupled solver tumor model enhanced consider ’correct’ time horizons and/or restrict initial conditions tumor points seeds hand results varying model parameters show robustness picard scheme respect model parameter choice. furthermore reconstruction results aaan patient data show reconstruct multifocal tumors comparable quality computational costs. presented method registration images patients diagnosed monomulti-focal brain tumors common reference atlas. application scenarios biophysical model calibration image registration. method combines stand-alone forward inverse tumor diffeomorphic registration means efﬁcient coupling scheme based picard iteration. allows exploit available tailored implementations solution subproblems monitoring convergence using coupled gradient information. invert simultaneously control variables problems—a parameterization initial condition tumor model smooth velocity ﬁeld capture inter-subject variability brain anatomy. learned experiments synthetic real data despite fact scheme neglects coupling terms appear coupled optimization problem could experimentally show efﬁciently reduces coupled gradient. convergence proof picard scheme local minimum beyond scope paper remains subject future work. could demonstrate parameterization initial condition allows generate highﬁdelity registrations irrespective complexity data model used tumor simulations. reduce number basis functions used initial condition parametrization longer true. studies various models pure interpolation basis functions parameterize initial condition reaction-only full reactiondiffusion model could show synthetic cases highest accuracy tumor reconstruction correct model. implies framework could eventually serve powerful tool model selection. rigorous veriﬁcation claim requires signiﬁcantly work remains future. overall numerical study includes real brain images real tumors shows achieve high-ﬁdelity results overall mismatch high dice score particular simulated observed tumor dice coefﬁcients ranging real tumors critical size artiﬁcially grown tumors real brain geometry. emphasize tumor model currently sophisticated enough allow proper parameter identiﬁcation tumor growth prediction tumor-registration coupling approach present work show good computational performance high accuracy various real brain data test cases lays basis developments improved tumor solvers ﬁnally parameter identiﬁcation growth prediction tool. next steps sibia improve biophysical tumor-growth model ﬁrst adding mass-effect second higher-ﬁdelity tumor growth models. material based upon work supported afosr grants fa---; grant ccf; u.s. department energy ofﬁce science ofﬁce advanced scientiﬁc computing research applied mathematics program award numbers de-sc de-sc; grant darpa grant wnf---; technische universit¨at ¨unchen— institute advanced study funded german excellence initiative opinions ﬁndings conclusions recommendations expressed herein authors necessarily reﬂect views afosr darpa nsf. computing time high-performance computing centers hazel system provided allocation federal project application acid-. computing time texas advanced computing centers stampede system provided allocation tacc nsf.", "year": "2017"}