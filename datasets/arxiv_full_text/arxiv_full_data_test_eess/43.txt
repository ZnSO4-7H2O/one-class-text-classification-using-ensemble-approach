{"title": "A Hybrid DSP/Deep Learning Approach to Real-Time Full-Band Speech  Enhancement", "tag": "eess", "abstract": " Despite noise suppression being a mature area in signal processing, it remains highly dependent on fine tuning of estimator algorithms and parameters. In this paper, we demonstrate a hybrid DSP/deep learning approach to noise suppression. A deep neural network with four hidden layers is used to estimate ideal critical band gains, while a more traditional pitch filter attenuates noise between pitch harmonics. The approach achieves significantly higher quality than a traditional minimum mean squared error spectral estimator, while keeping the complexity low enough for real-time operation at 48 kHz on a low-power processor. ", "text": "abstract—despite noise suppression mature area signal processing remains highly dependent tuning estimator algorithms parameters. paper demonstrate hybrid dsp/deep learning approach noise suppression. focus strongly keeping complexity possible still achieving high-quality enhanced speech. deep recurrent neural network four hidden layers used estimate ideal critical band gains traditional pitch ﬁlter attenuates noise pitch harmonics. approach achieves signiﬁcantly higher quality traditional minimum mean squared error spectral estimator keeping complexity enough real-time operation low-power cpu. noise suppression topic interest since least despite signiﬁcant improvements quality highlevel structure remained mostly same. form spectral estimation technique relies noise spectral estimator driven voice activity detector similar algorithm shown fig. components requires accurate estimators difﬁcult tune. example crude initial noise estimators spectral estimators based spectral subtraction replaced accurate noise estimators spectral amplitude estimators despite improvements estimators remained difﬁcult design required signiﬁcant manual tuning effort. recent advances deep learning techniques appealing noise suppression. deep learning techniques already used noise suppression many proposed approaches target automatic speech recognition applications latency required. also many cases large size neural network makes real-time implementation difﬁcult without gpu. proposed approach focus real-time applications complexity. also focus full-band speech. achieve goals choose hybrid approach rely proven signal processing techniques deep learning replace estimators traditionally hard correctly tune. approach contrasts so-called end-to-end systems signal processing operations replaced machine learning. end-to-end system clearly demonstrated propose hybrid approach noise suppression. goal deep learning aspects noise suppression require careful tuning using basic signal processing building blocks parts not. signal-level block diagram system shown fig. bulk suppression performed low-resolution spectral envelope using gains computed recurrent neural network gains simply square root ideal ratio mask ﬁner suppression step attenuates noise pitch harmonics using pitch comb ﬁlter. spectrum. practice prevents noise suppression pitch harmonics. alternative comb ﬁlter pitch period cancel inter-harmonic noise similar speech codec post-ﬁlters operate since periodicity speech signal depends heavily frequency pitch ﬁlter operates frequency domain based per-band ﬁltering coefﬁcient windowed pitch-delayed signal ﬁltering performed computing renormalizing resulting signal energy band original signal denotes real part complex value denotes complex conjugate. note single band would equivalent time-domain pitch correlation. deriving optimal values ﬁltering coefﬁcient hard values minimize mean squared error perceptually optimal. instead heuristic based following constraints observations. since noise causes decrease pitch correlation expect greater average band noise want distort signal similarly pitch enhance using following expression ﬁltering coefﬁcient respects constraints smooth behavior them makes sense input network include spectrum noisy signal based bands used output. improve conditioning training data apply spectrum results bark-frequency cepstral coefﬁcients addition these also include temporal derivative second temporal derivative ﬁrst bfccs. since already need compute pitch compute pitch correlation across frequency bands include ﬁrst coefﬁcients features. last include pitch period well spectral non-stationarity metric help speech detection. total input features. unlike features typically used speech recognition features cepstral mean normalization include ﬁrst cepstral coefﬁcient. choice deliberate given track absolute level noise approach taken neural network used directly estimate magnitudes frequency bins requires total hidden units close million weights process speech. scaling speech using frames would require network outputs clearly results higher complexity afford. avoid problem assume spectral envelopes speech noise sufﬁciently coarser resolution frequency bins. also rather directly estimating spectral magnitudes instead estimate ideal critical band gains signiﬁcant advantage bounded choose divide spectrum approximation bark scale opus codec uses. bands follow bark scale high frequencies always least bins frequencies. rather rectangular bands triangular bands peak response boundary bands. results total bands. network therefore requires output values range. telephonometry various sources noise used including computer fans ofﬁce crowd airplane train construction. noise mixed different levels produce wide range signal-to-noise ratios including clean speech noise-only segments. since cepstral mean normalization data augmentation make network robust variations frequency responses. achieved ﬁltering noise speech signal independently training example using second order ﬁlter form total hours speech hours noise data produce hours noisy speech using various combinations gains ﬁlters resampling data frequencies khz. optimization process loss function used training determines network weighs excessive attenuation versus insufﬁcient attenuation cannot exactly determine correct gains. although common binary cross-entropy function optimizing values range produce good results gains match perceptual effect. gain estimate corresponding ground truth instead train loss function exponent perceptual parameter controls aggressively suppress noise. since limγ→ limγ→ minimizes mean-squared error log-energy would make suppression aggressive given lack ﬂoor gain. practice value provides good trade-off equivalent minimizing mean squared error energy raised power sometimes noise speech particular band. common either input silent high frequency signal low-pass ﬁltered. happens ground truth gain explicitly marked undeﬁned loss function gain ignored avoid hurting training process. figure architecture neural network showing feed-forward fully connected layers recurrent layers along activation function number units layer. neural network closely follows traditional structure noise suppression algorithms shown fig. design based assumption three recurrent layers responsible basic components fig. course practice neural network free deviate assumption includes total units hidden layers largest layer units. increasing number units signiﬁcantly improve quality noise suppression. however loss function construct training data large impact ﬁnal quality. gated recurrent unit slightly outperforms lstm task also simpler. despite fact strictly necessary network includes output. extra complexity cost small improves training ensuring corresponding indeed learns discriminate speech noise. since ground truth gains requires noisy speech clean speech training data constructed artiﬁcially adding noise clean speech data. speech data mcgill speech database multi-lingual speech database make easy deploy noise suppression algorithms desirable keep size complexity low. size executable dominated weights needed represent units neural networks. keep size small possible weights quantized bits loss performance. makes possible weights cache cpu. operations) frame mﬂops real-time use. ifft ffts frame require around mﬂops pitch search requires around mﬂops. total complexity algorithm around mﬂops comparable full-band speech coder. non-vectorized implementation algorithm requires around single core perform noise suppression single channel. real-time complexity ﬂoating-point code cortex-a core comparison speech enhancement approach uses hidden layers units. requires million weights results complexity mﬂops. even quantized bits weights cache cpus requiring around mb/s memory bandwidth real-time operation. mmse-based noise suppressor speexdsp library. although noise suppression operates output resampled limitations wideband pesq objective results fig. show signiﬁcant improvement quality deep learning especially non-stationary noise types. improvement conﬁrmed casual listening samples. fig. shows effect noise suppression example. interactive demonstration proposed system available https//people.xiph.org/~jm/demo/rnnoise/ including real-time javascript implementation. software implementing proposed system obtained license https//github.com/xiph/rnnoise/ results produced using commit hash paper demonstrates noise suppression approach combines dsp-based techniques deep learning. using deep learning aspects noise suppression hard tune problem simpliﬁed computing ideal critical band gains done efﬁciently using units. coarse resolution bands addressed using simple pitch ﬁlter. resulting complexity makes approach suitable mobile embedded devices latency enough video-conferencing systems. also demonstrate quality signiﬁcantly higher pure signal processing-based approach. believe technique easily extended residual echo suppression example adding input features cepstrum signal ﬁltered farend signal. similarly applicable microphone array post-ﬁltering augmenting input features leakage estimates like ephraim malah speech enhancement using minimum mean-square error log-spectral amplitude estimator ieee transactions acoustics speech signal processing vol. l.-r. c.-h. regression approach speech enhancement based deep neural networks ieee transactions audio speech language processing vol. narayanan wang ideal ratio mask estimation using deep neural networks robust speech recognition proc. icassp montgomery vorbis speciﬁcation princen bradley analysis/synthesis ﬁlter bank design based time domain aliasing cancellation ieee tran. acoustics speech signal processing vol. merriënboer bahdanau bengio properties neural machine translation encoder-decoder approaches proc. eighth workshop syntax semantics structure statistical translation itu-t perceptual evaluation speech quality objective method end-to-end speech quality assessment narrow-band telephone networks speech codecs", "year": "2017"}