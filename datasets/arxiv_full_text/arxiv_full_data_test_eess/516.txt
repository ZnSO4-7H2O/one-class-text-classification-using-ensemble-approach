{"title": "Stroke Controllable Fast Style Transfer with Adaptive Receptive Fields", "tag": "eess", "abstract": " The Fast Style Transfer methods have been recently proposed to transfer a photograph to an artistic style in real-time. This task involves controlling the stroke size in the stylized results, which remains an open challenge. In this paper, we present a stroke controllable style transfer network that can achieve continuous and spatial stroke size control. By analyzing the factors that influence the stroke size, we propose to explicitly account for the receptive field and the style image scales. We propose a StrokePyramid module to endow the network with adaptive receptive fields, and two training strategies to achieve faster convergence and augment new stroke sizes upon a trained model respectively. By combining the proposed runtime control strategies, our network can achieve continuous changes in stroke sizes and produce distinct stroke sizes in different spatial regions within the same output image. ", "text": "abstract. fast style transfer methods recently proposed transfer photograph artistic style real-time. task involves controlling stroke size stylized results remains open challenge. paper present stroke controllable style transfer network achieve continuous spatial stroke size control. analyzing factors inﬂuence stroke size propose explicitly account receptive ﬁeld style image scales. propose strokepyramid module endow network adaptive receptive ﬁelds training strategies achieve faster convergence augment stroke sizes upon trained model respectively. combining proposed runtime control strategies network achieve continuous changes stroke sizes produce distinct stroke sizes diﬀerent spatial regions within output image. rendering photograph given artwork style long-standing research topic conventionally task style transfer usually studied generalization texture synthesis based recent progress visual texture modelling gatys ﬁrstly propose algorithm exploits convolutional neural network recombine content given photograph style artwork reconstruct visually plausible stylized image known process neural style transfer since seminal work gatys neural style transfer attracting wide attention academia industry however algorithm gatys based iterative image optimizations leads slow optimization process pair content style. tackle issue several algorithms proposed speed style transfer process called fast style transfer literature classes per-style-per-model multiple-style-per-model arbitrary-style-per-model gist pspm train feed-forward style-speciﬁc generator produce corresponding stylized result forward pass. mspm improves eﬃciency incorporating multiple styles single generator. aspm aims transferring arbitrary style single model. trade-oﬀ eﬃciency quality fast style transfer algorithms terms quality pspm usually regarded produce appealing stylized results however pspm ﬂexible terms controlling perceptual factors among perceptual factors strokes important geometric primitives characterize artwork shown figure reality texture diﬀerent artists place diﬀerent sizes strokes reﬂection unique styles achieve diﬀerent stroke sizes pspm possible solution train multiple models time space consuming. another solution resize input image diﬀerent scales inevitably hurt quality stylization. none solutions however achieve continuous stroke size control produce distinct stroke sizes diﬀerent spatial regions without trading quality eﬃciency. paper propose stroke controllable fast style transfer algorithm incorporate multiple stroke sizes single model achieves ﬂexible continuous stroke size control spatial stroke size control. analyzing factors inﬂuence stroke size stylized results propose explicitly account receptive ﬁeld style image scale. propose strokepyramid module endow network adaptive receptive ﬁelds diﬀerent stroke sizes learned diﬀerent receptive ﬁelds. introduce progressive training strategy make network converge faster incremental training strategy learn stroke sizes upon trained model. combining proposed runtime control techniques continuous stroke size control spatial stroke size control network produce distinct stroke sizes diﬀerent outputs diﬀerent spatial regions within output image. summary work three primary contributions analyze factors inﬂuence stroke size stylized results propose receptive ﬁeld style image scale considered stroke size control cases. propose stroke controllable style transfer network corresponding training strategies order achieve faster convergence augment stroke sizes upon trained model respectively. present runtime control strategies empower single model ability producing continuous changes stroke size distinct stroke sizes diﬀerent spatial regions within output image. best knowledge ﬁrst style transfer network achieves continuous stroke size control spatial stroke size control. controlling perceptual factors fast style transfer. stroke size control belongs domain controlling perceptual factors stylization. ﬁeld several signiﬁcant works recently presented. however eﬀorts devoted controlling stroke size fast style transfer. gatys study color control spatial control fast style transfer. extend gatys al.’s work meaningful spatial control incorporating semantic content achieving so-called fast semantic style transfer another related work wang al.’s algorithm aims learn large brush strokes high-resolution images current fast style transfer algorithms fail paint large strokes high-resolution images propose coarse-to-ﬁne architecture solve problem. note work intrinsically diﬀerent paper single pre-trained model still produces stroke size input image. concurrent work also explores issue stroke size control. compared work beneﬁts ﬂexible continuous spatial stroke size control. regulating receptive ﬁeld neural networks. receptive ﬁeld basic concepts convolutional neural networks refers region input image neuron responsive aﬀect performance networks becomes critical issue many tasks image parsing). regulate receptive ﬁeld proposes operation dilated convolution supports expansion receptive ﬁeld setting diﬀerent dilation values widely used many generation tasks like another work proposes deformable convolution augments sampling locations regular convolution additional oﬀsets. furthermore propose learning-based receptive ﬁeld regulating method inﬂate shrink feature maps automatically. fig. results learning size large strokes large small receptive ﬁelds respectively. represents result produced large receptive ﬁeld represents result produced small receptive ﬁeld. content images credited ﬂickr users kevin robson togol. start reviewing concept stroke size. consider image style transfer composition series small stroke textons referred fundamental geometric micro-structures images stroke size image deﬁned average scale composed stroke textons. deep neural network based fast style transfer three factors found inﬂuence stroke size namely scale style image receptive ﬁeld loss network receptive ﬁeld generative network. objective style usually learned matching style image’s grambased statistics style transfer algorithms computed feature maps pre-trained network gram-based statistics scale-sensitive i.e. contain scale information given style image. reason characteristic features vary image scale. also style statistics reaches conclusion. therefore given content image generative networks trained diﬀerent scales style image produce diﬀerent stroke sizes. neuron pre-trained loss network aﬀect region receptive ﬁeld size input image. stroke texton much larger ﬁxed receptive ﬁeld loss network visual diﬀerence large larger stroke texton relatively small region. apart factors receptive ﬁeld size generative network also inﬂuence stroke size. figure change receptive ﬁeld size generative network factors remain same. noticeable larger stroke size produced larger receptive ﬁeld styles. explain result interpret training process generative network teaching convolutional kernels paint pre-deﬁned size stroke textons region size receptive ﬁeld. therefore given diﬀerent sizes input images kernels trained network paint almost size stroke textons fig. feed-forward process fast style transfer. size regions outputs small large input images respectively stroke sizes almost same. content image credited ﬂickr user billchensf. size regions shown figure particular receptive ﬁeld generative network smaller stroke texton kernels learn paint part whole stroke texton region inﬂuences stroke size. hence large stroke size network needs larger receptive ﬁelds learn global stroke conﬁguration. small stroke size network needs learn local features. scale style image receptive ﬁeld generative network generally considered stroke size control. style image high-resolution cases inﬂuence receptive ﬁeld loss network considered work. assume denotes stroke size image denotes stroke sizes represents image stroke size problem studied paper incorporate diﬀerent stroke sizes feedg trained generator. target statistic output image characterized components semantic content statistics derived input image visual style statistics derived style image fig. overview network architecture strokepyramid. consists several stroke branches gating functions. stroke branch corresponds speciﬁc stroke size. based analysis section incorporate diﬀerent stroke sizes single model propose design network adaptive receptive ﬁelds receptive ﬁeld used learn corresponding size stroke. network architecture proposed approach depicted figure network consists three components. core network strokepyramid module proposed decompose network several stroke branches. branch larger receptive ﬁeld previous branch progressively growing convolutional ﬁlters. network also encourages stroke consistency adjacent stroke size control results diﬀer stroke sizes. handling diﬀerent stroke branches strokepyramid regulate receptive ﬁeld generative network. diﬀerent receptive ﬁelds network learns paint strokes diﬀerent sizes. particular better preserve desired size strokes larger strokes learned larger receptive ﬁelds explained section testing phase given signal indicates desired stroke size strokepyramid automatically adapts receptive ﬁeld network stylized result corresponding stroke size produced. addition strokepyramid components network namely pre-encoder stroke decoder. pre-encoder module refers ﬁrst layers network shared among diﬀerent stroke branches learn semantic content content image basic appearances style. stroke decoder module takes feature maps strokepyramid input decodes stroke feature stylized result corresponding stroke size. determine stroke feature decode semantic loss. semantic loss deﬁned preserve semantic information content image formulated euclidean distance content image output stylized image feature space network assume rc×h×w represents feature layer stroke loss. visual style statistics well represented correlations ﬁlter responses style image diﬀerent layers pre-trained network. feature correlations obtained computing gram matrix feature certain layer network. gram-based statistic scale-sensitive representations diﬀerent stroke sizes obtained simply resizing given style image. progressive training. train diﬀerent stroke branches single network propose progressive training strategy. training strategy stems intuition training latter stroke branch beneﬁts knowledge previously learned branches. taken consideration network learns diﬀerent stroke sizes diﬀerent stroke branches progressively. assume number stroke sizes learned every iterations network ﬁrstly updates ﬁrst stroke branch order learn smallest size stroke. then based learned knowledge ﬁrst branch network uses second stroke branch learn second stroke size corresponding scale style image. particular since second stroke branch grows convolutional ﬁlters basis ﬁrst stroke branch updated components previous iteration also adjusted. similarly following stroke branches updated progressive process. next iterations network repeats progressive process since need ensure network preserves previously learned stroke sizes. incremental training. also propose ﬂexible incremental training strategy eﬃciently augment stroke sizes upon trained model. given desired stroke size instead learning scratch algorithm incrementally learns stroke size adding single layer stroke branch strokepyramid. position augmented layer depends previously learned stroke sizes corresponding receptive ﬁelds. ﬁxing network components updating augmented layer network learns paint size strokes basis previously learned stroke features thus reach convergence quickly. continuous stroke size control. advantages algorithm previous approaches algorithm endow single model ability ﬁner continuous stroke size control. propose stroke interpolation strategy exploit architecture interpolate trained stroke sizes feature embedding space instead training tons style image scales. knowledge none previous approaches considers much ﬁner continuous stroke size control. however point view possible solutions derived current approaches directly interpolate stylized results diﬀerent stroke sizes pixel space. design network diﬀerent encoders shared decoder train encoder shared decoder jointly diﬀerent style image scales. interpolate representations encoders. rescale style image aspm methods produce corresponding results. however algorithm outperforms solutions following aspects correspondingly manipulate interpolation feature embedding space achieve perceptually superior results stroke representations obtained diﬀerent receptive ﬁelds strokepyramid. explained veriﬁed section figure stroke representations perceptually better obtained receptive ﬁeld. addition results proposed strokepyramid consistent stroke orientations conﬁgurations stroke size control. comparison results found supplementary material. aspm compromises visual quality generally eﬀective producing strokes details. algorithm outperforms aspm terms quality also stylization speed. spatial stroke size control. previously community fast style transfer stylized results usually almost stroke size across whole image impractical real case. algorithm supports mixed stroke sizes diﬀerent spatial regions also single model. contrast information stylized results enhanced. spatial stroke size control achieved feeding masked content image diﬀerent corresponding stroke branches controlling gating functions combining stylized results. mask obtained either manual labelling forwarding content image pre-trained semantic segmentation network e.g. deeplabv combining continuous stroke size control strategy algorithm provides practitioners much ﬁner control stylized results. fig. quality comparison proposed algorithm aforementioned possible stroke control solutions section represents image super-resolution technique images second line represent zoom regions frames. style layers relu used content layer. default number initially learned stroke sizes ensure ability stroke decoder scales diﬀerent stroke sizes styles experiment. information found supplementary material. comparison previous solutions. sample results algorithm aforementioned possible solutions shown figure produced algorithm achieves comparable results ﬁrst possible solution figure regarding quality preserving ﬂexibility second possible solution figure figure shows sample results algorithm fast style transfer algorithms. compared results diﬀerent stroke sizes consistent stroke orientations stroke conﬁgurations stroke orientations conﬁgurations results random since diﬀerent encoder-decoder pairs learn diﬀerent stroke sizes separately. contrast strokepyramid encourage stroke consistency adjacent stroke size control results diﬀer stroke sizes. compared algorithm exploit single trained model achieve continuous spatial stroke size control. also model size much smaller compared single-model stroke size control algorithms results capture ﬁner strokes details. also fig. example results diﬀerent stroke sizes produced algorithm fast style transfer algorithms. column represents results algorithm. style image figure runtime user controls. figure show sample results proposed continuous stroke size control strategy. network trained three scales style image default stroke interpolation obtain totally stroke sizes. test content image never seen training. also demonstrate results comparison explained section compare results diﬀerent algorithms globally locally. globally algorithm seems achieve superior performance terms visual quality. locally compared algorithm eﬀective producing strokes preserving details. addition shown figure absolute diﬀerences adjacent continuous stroke size control results much clearer stroke contour indicates strokes results increase decrease size together continuous stroke size control. also produced sample video demonstrate continuous stroke size control supplementary material. figure demonstrates results spatial stroke size control strategy. spatial stroke size control realized single model. compared figure controlling stroke size diﬀerent spatial regions enhance contrast stylized images make ai-created much closer human-created art. fig. results continuous stroke size control. zoom region observe variations stroke sizes. algorithm produces ﬁner strokes details. content style image found figure training curve analysis. demonstrate eﬀectiveness progressive training strategy record stroke losses learning several sizes strokes progressively learning diﬀerent strokes individually. result shown figure reported loss values averaged randomly selected batches content images. observed network progressively learns multiple stroke sizes converges relatively faster learns single stroke size individually. result indicates progressive training latter stroke branch beneﬁts learned knowledge previous branches even improve training previous branches shared network component turn. validate stroke incremental training strategy present training curves incremental training training scratch figure achieving comparable stylization quality incrementally learning stroke signiﬁcantly speed training process compared learning scratch. fig. algorithm allows ﬂexible spatial stroke size control stylization. result produced single model mixed stroke sizes consistent artist’s artwork reality. average loss analysis. measure well loss function minimized compare average content style loss algorithm style transfer methods. recorded values averaged content images style images. style calculate average loss three stroke sizes. shown figure average style loss algorithm similar average content loss slightly lower indicates algorithm achieves comparable slightly better performance regarding ability minimize loss function. speed model size analysis. fully training single model three stroke sizes takes hours single nvidia quadro generating time takes averagely seconds stylize image size similar shorter path stroke sizes algorithm average faster faster wang al.’s algorithm huang belongie’s algorithm al.’s algorithm according speed analysis size model disk paper introduce ﬂexible stroke size control approach fast style transfer. without trading quality eﬃciency algorithm ﬁrst achieve continuous spatial stroke size control single model. idea also directly applied mspm methods. application real world work provides tool practitioners inject artistic preferences style transfer results directly applied production software entertainment. regarding signiﬁcance work larger vision community beyond style transfer work takes step direction learning adaptive receptive ﬁelds human vision system primarily validates signiﬁcance style transfer. future hope explore learning adaptive receptive ﬁelds beneﬁt larger vision community e.g. multi-scale deep image aesthetic assessment deep image compression deep image colorization etc. work ﬁrst step towards ﬁner ﬂexible stroke size control still issues remaining addressed. interesting probably automatic spatial stroke size control shot. process spatial stroke size control eﬃcient user-friendly semantic segmentation network incorporated module network support automatic determination stroke sizes diﬀerent spatial regions. besides relations among style representations diﬀerent scales style image still remains unclear. transformaacknowledgments. ﬁrst authors contributed equally. mingli song corresponding author. work supported national research development program national natural science foundation china fundamental research funds central universities research development program zhejiang province australia.", "year": "2018"}