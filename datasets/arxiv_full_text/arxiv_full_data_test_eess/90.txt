{"title": "Optimal Experiment Design for Magnetic Resonance Fingerprinting:  Cram\\'er-Rao Bound Meets Spin Dynamics", "tag": "eess", "abstract": " Magnetic resonance (MR) fingerprinting is a new quantitative imaging paradigm, which simultaneously acquires multiple MR tissue parameter maps in a single experiment. In this paper, we present an estimation-theoretic framework to perform experiment design for MR fingerprinting. Specifically, we describe a discrete-time dynamic system to model spin dynamics, and derive an estimation-theoretic bound, i.e., the Cramer-Rao bound (CRB), to characterize the signal-to-noise ratio (SNR) efficiency of an MR fingerprinting experiment. We then formulate an optimal experiment design problem, which determines a sequence of acquisition parameters to encode MR tissue parameters with the maximal SNR efficiency, while respecting the physical constraints and other constraints from the image decoding/reconstruction process. We evaluate the performance of the proposed approach with numerical simulations, phantom experiments, and in vivo experiments. We demonstrate that the optimized experiments substantially reduce data acquisition time and/or improve parameter estimation. For example, the optimized experiments achieve about a factor of two improvement in the accuracy of $T_2$ maps, while keeping similar or slightly better accuracy of $T_1$ maps. Finally, as a remarkable observation, we find that the sequence of optimized acquisition parameters appears to be highly structured rather than randomly/pseudo-randomly varying as is prescribed in the conventional MR fingerprinting experiments. ", "text": "abstract—magnetic resonance ﬁngerprinting quantitative imaging paradigm simultaneously acquires multiple tissue parameter maps single experiment. paper present estimation-theoretic framework perform experiment design ﬁngerprinting. speciﬁcally describe discrete-time dynamic system model spin dynamics derive estimation-theoretic bound i.e. cram´er-rao bound characterize signal-to-noise ratio efﬁciency ﬁngerprinting experiment. formulate optimal experiment design problem determines sequence acquisition parameters encode tissue parameters maximal efﬁciency respecting physical constraints constraints image decoding/reconstruction process. evaluate performance proposed approach numerical simulations phantom experiments vivo experiments. demonstrate optimized experiments substantially reduce data acquisition time and/or improve parameter estimation. example optimized experiments achieve factor improvement accuracy maps keeping similar slightly better accuracy maps. finally remarkable observation sequence optimized acquisition parameters appears highly structured rather randomly/pseudorandomly varying prescribed conventional ﬁngerprinting experiments. permitted. however permission material purposes must obtained ieee sending request pubs-permissionsieee.org work supported part national institutes health grant nih-r-eb nih-r-eb nih-peb national science foundation grant nsf-ccf. zhao also supported ruth kirschstein national research service award postdoctoral fellowship national institutes health grant nih-f-eb. zhao athinoula martinos center biomedical imaging massachusetts general hospital charlestown also department radiology harvard medical school boston liao athinoula martinos center biomedical imaging massachusetts general hospital charlestown also department biomedical engineering zhejiang university hangzhou zhejiang province china setsompop wald athinoula martinos center biomedical imaging massachusetts general hospital charlestown also department radiology harvard medical school boston also harvard-mit division health sciences technology massachusetts institute technology cambridge quantitative magnetic resonance imaging framework enables simultaneous acquisition multiple tissue parameters single imaging experiment. compared conventional relaxometry techniques original proof-ofprinciple ﬁngerprinting implementation featured several innovations encoding decoding processes speciﬁcally encoding applies series timevarying random quasi-random data acquisition parameters probe spin system. generates unique transient-state signal evolutions ﬁngerprints different tissue parameters. applies incoherent spatial encoding collect k-space data. decoding performs simple gridding reconstruction reconstruct contrast-weighted images applies dictionarybased pattern matching obtain tissue parameter maps interest. given many departures conventional quantitative imaging fundamental questions still remain unclear mechanism ﬁngerprinting. example theoretical perspective optimality encoding decoding processes ﬁngerprinting examined recent paper performed theoretical analysis ﬁngerprinting problem lowdimensional manifold recovery viewpoint analysis asymptotic probabilistic nature provide results could used ensure quality guide design ﬁnite-duration ﬁngerprinting experiments. practical perspective existing ﬁngerprinting methods work well scenarios important cases performance methods much worse. example accuracy maps ﬁngerprinting often depends critically length data acquisition much worse maps especially short acquisition lengths settings would highly desirable either improve parameter mapping quality without increasing experiment duration recently introduced novel statistical imaging framework ﬁngerprinting decoding side proposed maximum likelihood approach directly reconstructs tissue parameter maps highlyundersampled noisy k-space data. moreover showed analytically conventional reconstruction approach sub-optimal statistical estimation perspective reconstruction dramatically improved estimation accuracy and/or reduced acquisition time. apart quality decoding schemes performance ﬁngerprinting inherently depends quality available data. motivates optimization ﬁngerprinting encoding side naturally falls domain optimal experiment design statistical imaging framework. paper address optimal experiment design problem ﬁngerprinting. goal encode tissue parameters informative measurements presence noise. speciﬁcally ﬁrst model spin dynamics discrete-time dynamic system. calculate estimation-theoretic bound i.e. cram´er-rao bound measure signal-to-noise efﬁciency ﬁngerprinting experiments. utilize bound formulate optimal experiment design problem choose ﬁngerprinting acquisition parameters maximal efﬁciency respecting physical constraints constraints image decoding. show representative results numerical simulations phantom experiments vivo experiments illustrate performance proposed framework. remarkable observation sequence optimized acquisition parameters appears highly structured rather randomly/pseudo-randomly varying used existing ﬁngerprinting experiments preliminary account work presented early conference papers which best knowledge ﬁrst introduced estimation-theoretic bounds ﬁngerprinting experiment design. recently similar problems also investigated researchers. example assl¨ander applied crbbased experiment design framework imaging sequence polar coordinates bloch equation maidens provided optimal control interpretation experiment design problem developed dynamic programming based algorithm however curse dimensionality dynamic programming feasibility approach demonstrated highly simpliﬁed scenario reﬂect full complexities real applications. besides crb-based approaches experiment design problem also addressed perspectives. example cohen optimized ﬁngerprinting acquisition parameters maximizing discrimination power different tissue types extend approaches ﬁngerprinting unique transient-state quantitative imaging technique encodes tissue parameters spin dynamics. context calculation complex requires handling dynamic system rather analytical signal model conventional relaxometry paper introduce efﬁcient calculating dynamic systems described bloch equation. particular show calculation done iterating difference equations. easy reference summarize notations symbols used paper. denote ﬁeld real numbers rm×n respectively denote space real vectors length space real matrices. bold letters denote vectors matrices. respectively denote transpose inverse trace scalar-valued function argument deﬁne gradient i.e. vector /∂xn; vector-valued function argument deﬁne jacobian matrix i.e. ∂f/∂x matrix ∂fm/∂xn; matrix-valued function rm×n argument deﬁne derivative matrix mn/∂x. random vector denote expectation covariance rest paper organized follows. section presents proposed framework detail starts state-space model spin dynamics followed calculation cram´er-rao bound optimal design ﬁngerprinting experiments. section demonstrates performance proposed approach numerical simulations phantom experiments vivo experiments. section discusses related issues future work followed concluding remarks section number ﬁngerprinting imaging sequences recently developed subsection start formalizing generic state-space model spin dynamics underlie ﬁngerprinting sequences give example specializing model representative ﬁngerprinting sequence. state-space model spin dynamics governed bloch equation system ﬁrst-order ordinary differential equations. magnetization evolves continuous time mainly interested values ﬁnite time points ﬁngerprinting experiment. consider discrete-time state-space model simplicity completely captures features interest spin dynamics continuous time. moreover focus magnetization evolution respect small sample tissue issues related spatial encoding discussed later. presence magnetic ﬁeld inhomogeneity intravoxel spin dephasing occurs. account effect model multiple isochromats voxel represents ensemble spins resonance frequency isochromatsummation approach approximate magnetization evolution voxel interest. approach performs bloch simulations individual isochromat sums magnetization evolutions obtain ensemble magnetization evolution voxel. dynamic system viewpoint approach essentially employs independent state equation describe magnetization evolution isochromat obtains ensemble magnetization observation equation. following start describing state equation single isochromat. divide voxel interest i.e. sufﬁciently small equal-sized subvoxels {△r} centered assume exists single isochromat denote magnetization associated isochromat repetition time magnetization evolution described following state equation equations together form state-space model describe spin dynamics various ﬁngerprinting imaging sequences note model nonlinear time-varying nature. example sequence example illustrate state-space model using widely-used ﬁngerprinting sequence i.e. inversion recovery fast imaging steady-state precession sequence sequence robust off-resonance effects spoiler gradients unknown parameters acquisition parameters ir-fisp sequence three physical processes drive magnetization evolutions excitation; spin relaxation; spin dephasing. following isochromat-summation approach model spin dynamics. speciﬁcally cartesian coordinates rotating frame form system matrix denotes phase dispersion associated isochromat note ir-fisp sequence dominated impact spoiler gradients although various factors also contribute spin dephasing. contains unknown parameters ﬁngerprinting experiment including tissue-speciﬁc parameters experiment-speciﬁc parameters contains data acquisition parameters applied repetition time including angle phase radio frequency pulse echo time repetition time respectively denote system matrix input matrix repetition time. note implicitly assume subvoxels share parameters moreover assuming imaging experiment starts thermal equilibirium initial condition given m/nv denotes magnitude magnetization voxel thermal equilibrium denotes number sub-voxels next describe observation equation. note magnetization measured corresponding echo time excitation signal detected receiver coil proportional transverse component magnetization. denoting transverse magnetization associated isochromat echo time matrix inequality means positive semideﬁnite matrix. note depend underlying tissue parameter given data model nonlinear respect moreover obtain bound variance individual tissue parameter estimate extracting corresponding diagonal entry matrix i.e. iterate difference equations note initial conditions calculate given ∂mr/∂θi /∂θi]t sake concreteness illustrate procedure example ir-fisp sequence appendix. given provides lower bound smallest possible variance unbiased estimator used characterize efﬁciency imaging experiment. helps understand potential reliability ﬁngerprinting experiment ﬁgure much acquisition time necessary achieve certain level quantitative accuracy. importantly principled tool optimize encoding process ﬁngerprinting experiment. example given representative deﬁned before. models excitation well spin relaxation. note matrix account spin dephasing since spoiler gradient placed echo time within repetition time. proceed describe data model calculate perform experiment design. note spin dynamics described utilized perform contrast encoding ﬁngerprinting experiments. besides contrast encoding data generating process also encompasses spatial encoding noise contamination. described data model data generating process. principle calculate perform experiment design. practice however often computationally expensive non-cartesian fourier transform spatial encoding. describe practical approach ignore spatial encoding following simpliﬁed data model vector contains magnetizations collected echo time {z}n denotes independent identically distributed gaussian noise note corresponds data model single voxel nuclear magnetic resonance experiment. alternatively also viewed data model fully-sampled imaging experiment crosstalk magnetization evolutions different voxels. despite simpliﬁcation demonstrate later experiment design effective highly-undersampled ﬁngerprinting experiments. next derive data model estimation theory provides lower bound covariance unbiased estimator mild regularity conditions bound asymptotically achieved estimator mathematically expressed following information inequality take account constraints image decoding/reconstruction especially dealing highlyundersampled ﬁngerprinting experiments. different reconstruction methods different strategies image decoding often beneﬁt magnetization evolutions smoothly varying. number ways enforce property. incorporate additional constraints restricts maximum angle variations consecutive time points. demonstrated later constraints effective promoting smooth magnetization evolutions yield better performance image reconstruction highly-undersampled data. accordingly reformulate optimal experiment design problem follows proposed formulations result nonlinear nonconvex optimization problems. number numerical algorithms employed solve optimization problems including standard nonlinear optimization methods stochastic optimization methods example state-of-the-art nonlinear optimization method i.e. sequential quadratic programming seek local minima algorithm iterative algorithm iteration performs quadratic approximation cost function current alternatively could replace constraint constraint total acquisition time previous work principle formulation could allow larger variations could potentially improve optimized experiments. however note formulation simultaneously determine rn}n often leads highly non-convex optimization problem. without loss generality decided focus paper simpler optimization formulation avoids issue. example conventional reconstruction method utilizes direct pattern matching smoother magnetization evolutions often less correlation noise-like aliasing artifacts. causes underlying magnetization evolution better differentiated aliasing artifacts leading improved accuracy dictionary matching. another example low-rank/subspace reconstruction method smooth magnetization evolutions often result smaller low-rank approximation error given rank value. turn enables better reconstruction accuracy. finally statistical reconstruction methods involve solving nonconvex optimization problems initialization improved pattern-matching reconstruction low-rank reconstruction method often leads better performance. tissue parameters {θ}l could optimize data acquisition parameters ﬁngerprinting experiment maximize efﬁciency. mathematically optimal experiment design problem formulated follows denotes design criterion scalar function matrix; rq×n denotes acquisition parameters ﬁngerprinting experiment time points; rq×n denotes constraint feasible data acquisition parameters. note that sake concrete illustration assume total number time points i.e. given practice speciﬁed according desired experiment duration constraints trs. moreover given matrix depends underlying tissue parameter assume that speciﬁc application interest knowledge range tissue parameter values prior experiment design. desirable design experiments universally optimal possible parameters within range often feasible. such select representative tissues practical compromise. example specialize optimize ﬁngerprinting experiments ir-fisp sequence. first specify design criterion note various information criteria used including a-optimality d-optimality e-optimality criteria comprehensive survey). choose a-optimality criterion minimizes trace matrix further incorporate weightings design criterion motivated crbs different tissue parameters often different scales; want tailor design parameters relevant speciﬁc applications interest. accordingly diagonal matrix whose entries contain weightings different tissue parameters. second specify data acquisition parameters note acquisition parameters ir-fisp sequence include angles pulse phases echo times repetition times. following early work assume angles repetition times design parameters ﬁxing pulse phases echo times. accordingly lastly specify constraint acquisition parameters. taking account various physical considerations and/or total acquisition time) impose upper bounds lower bounds term optimal experiment design refers goal problem formulation i.e. maximizing efﬁciency experiment. term follows convention statistics imaging unrelated whether speciﬁc solution algorithm produces globally optimal design not. solution also linearizes constraints. solves constrained quadratic optimization problem update solution. nonlinear optimization methods performance algorithm generally dependent initialization. initialize algorithm acquisition parameters conventional ﬁngerprinting experiment algorithm consistently yields good performance although initialization schemes lead better performance. general setup created numerical brain phantom simulate single-channel ﬁngerprinting experiments. took maps brainweb database ground truth shown fig. experimental ﬁeld-of-view matrix size simulated ﬁngerprinting experiments ir-fisp sequence robust main magnetic ﬁeld inhomogeneity. moreover simplicity assumed transmit ﬁeld homogeneous simulations. performed bloch simulations generate contrastweighted images. used isochromat-summation approach simulated magnetization evolutions isochromats voxel. bloch simulations considered three different sets acquisition parameters conventional scheme optimized scheme optimized scheme fig. show acquisition parameters conventional scheme well resulting magnetization evolutions regions-ofinterest respectively white matter tissue gray matter tissue highly-undersampled experiment acquired highlyundersampled spiral k-space data time point this used spiral trajectory acquired spiral interleaf time point whereas full spiral trajectory consists interleaves. added complex white gaussian noise measured kspace data according pre-speciﬁed noise level deﬁne signal-to-noise ratio denotes average value region white matter. deﬁnition measures decibels experiments. note fully-sampled cartesian experiments approach equivalent direct fourier reconstruction followed dictionary-based pattern matching highly-undersampled experiments solved reconstruction problem algorithm initialized gridding reconstruction. dictionary used reconstruction constructed based following parameter discretization scheme value range used increment increment value range used increment increment assess reconstruction accuracy used following metrics overall error i.e. ki−ˆik/kik respectively denote true parameter reconstructed parameter voxelwise relative error i.e. iv|/|iv| respectively denote values voxel. describe detailed implementation proposed approach application example. convenience refer optimized schemes optimized-i optimized-ii respectively. work assumed primary interest chose three represeni.e. tative tissues moreover manually chose weighting matrix diag) ensure good performance optimized experiments. note allows inversion pulse imposed beginning imaging experiments often advantageous estimation minimum respectively angle αmin maximum minimum repetition times rmax rmin here worth mentioning constraints roughly match range acquisition parameters conventional scheme. additional constraints angle variations values tissues arbitrarily chosen range tissue parameter values relevant neuroimaging. avoid inverse crime take tissue parameter values directly brain phantom. tolerance maximum iteration reached. runtime algorithm depends length acquisition. example solving respectively took linux workstation intel xeon processors running matlab optimized acquisition parameters independently several choices example fig. shows optimized acquisition parameters optimized-i optimized-ii. seen optimized acquisition parameters appear highly structured remarkably different acquisition parameters conventional scheme. particular optimized repetition times turn binary besides also similar observations acquisition lengths. show example optimized schemes supplementary material. section discuss interesting observation. fig. also shows resulting magnetization evolutions optimized-i optimized-ii. seen magnetization evolutions optimized-i exhibit signiﬁcant oscillation dramatic change acquisition parameters contrast enforcing additional constraints angle variations optimized-ii oscillation behavior signiﬁcantly suppressed resulting magnetization evolutions become much smoother. later demonstrate advantageous image reconstruction highly-undersampled data. evaluation evaluated conventional scheme optimized-i optimized-ii. note lower bound variance unbiased estimator characterizes property imaging experiment. speciﬁcally calculated associated three sets acquisition parameters different acquisition lengths. experiments order show scale used fig. acquisition parameters conventional scheme well resulting magnetization evolutions. flip angle train. repetition time train. magnetization evolutions white matter gray matter rois marked fig. note ﬁrst pulse exceeds scale vertical axes applied algorithm solve optimization problems associated initialized algorithm acquisition parameters rn}n conventional scheme. terminated algorithm change solution less pre-speciﬁed fig. optimized acquisition schemes resulting magnetization evolutions white matter gray matter rois marked fig. flip angle train optimized-i. repetition time train optimized-i. magnetization evolutions optimized-i. flip angle train optimized-ii. repetition time train optimized-ii. magnetization evolutions optimized-ii. note ﬁrst pulses optimized-i optimized-ii exceed scale vertical axes ters. nonetheless difference optimized schemes quite small. supplementary material also show evaluation respect gray matter similar observations. evaluation fully-sampled experiments evaluated fully-sampled ﬁngerprinting experiments described section iii.a. note scenario exactly corresponds data model calculated performed experiment design. speciﬁcally simulated experiments using conventional scheme optimized-i optimized-ii. fig. shows reconstructed maps. seen optimized schemes improve accuracy although improvement signiﬁcant moreover performance optimized-i slightly better optimized-ii consistent prediction shown before. investigated bias-variance property reconstructed parameter maps. speciﬁcally performed monte carlo simulations trials calculate bias standard deviation root-mean-square error reconstructed parameter maps. convenience normalized quantities follows normalized bias length becomes longer. ncrb rapidly approaches asymptotic limit short acquisitions three schemes. however conventional scheme needs much longer acquisition attain good ncrb. consistent previous observations indicates estimation-theoretic perspective signiﬁcant room improvement conventional scheme. contrast optimized schemes signiﬁcantly improve ncrb especially short acquisition lengths. example optimized experiments reduce ncrb factor also note ncrb optimized-i better optimized-ii acquisition lengths. expected since smaller constraints optimized-i searches larger feasible space acquisition paramefig. reconstructed parameter maps fully-sampled ﬁngerprinting experiments using acquisition parameters conventional scheme optimized-i optimized-ii. reconstructed maps associated relative error maps. reconstructed maps associated relative error maps. note overall error labeled lower right corner error regions associated background skull scalp zero. fig. bias-variance analysis reconstructed parameter maps fully-sampled ﬁngerprinting experiments using acquisition parameters conventional scheme optimized-i optimized-ii. normalized bias standard deviation root-mean-square error maps maps. regions associated background skull scalp zero. evaluation highly-undersampled experiments repeated evaluations applied highlyundersampled case. note closely matches ﬁngerprinting applied practice. fig. shows reconstructed maps highlyundersampled experiments using conventional scheme optimized schemes. seen optimized-i improves accuracy conventional scheme expense degrading accuracy map. contrast optimizedii provides better accuracy maps highly desirable. note reconstruction involves solving nonlinear nonconvex optimization problem good initialization often required. enforcing additional constraint angle variations optimized-ii results much smoother magnetization evolutions highly-undersampled data often leads better pattern matching results conventional reconstruction turn provides improved initialization reconstruction. fig. shows normalized bias standard deviation root-mean-square error maps reconstructed maps simulations clearly optimized-ii reduces normalized standard deviation root-mean-square error maps compared conventional scheme. moreover smooth magnetization evolutions optimized-ii reduces bias compared optimized-i. illustrates merit introducing constraint angle variations highlyundersampled experiments. fig. shows overall errors versus acquisition length highly-undersampled experiments clearly optimized-ii outperforms conventional scheme optimized-i acquisition lengths. illustration show reconstruction results supplementary material. fig. shows overall errors versus highly-undersampled experiments seen optimized-ii provides better accuracy conventional scheme optimized-i levels. evaluated proposed approach phantom experiments. focus scenario highly-undersampled ﬁngerprinting experiments practical interest quantitative imaging. speciﬁcally created physical phantom consists plastic tubes ﬁlled solution gadolinium agar different concentrations. created different combinations values relevant neuroimaging application carried experiments siemens trio scanner equipped -channel head array coil. relevant imaging parameters include matrix size slice thickness fig. overall error versus acquisition length fully-sampled ﬁngerprinting experiments overall error map. overall error map. note overall error calculated respect whole brain excluding skull scalp csf. fig. overall error versus level fully-sampled ﬁngerprinting experiments overall error map. overall error map. note overall error calculated respect whole brain excluding skull scalp csf. fig. shows normalized bias standard deviation root-mean-square error maps reconstructed maps. seen optimized-i optimized-ii reduce normalized standard deviations compared conventional scheme. consistent prediction results shown fig. improvement substantial moreover three acquisition schemes normalized standard deviation much larger normalized bias normalized rootmean-square error dominated normalized standard deviation. behavior expected given reconstruction asymptotically unbiased moreover evaluated fully-sampled experiments different acquisition lengths ranging experiments. fig. shows overall errors versus acquisition length. clearly optimized acquisition schemes outperform conventional scheme acquisition lengths. example show reconstruction results supplementary material. fig. reconstructed parameter maps highly-undersampled ﬁngerprinting experiments using acquisition parameters conventional scheme optimized-i optimized-ii. reconstructed maps associated relative error maps. reconstructed maps associated relative error maps. note overall error labeled lower right corner error regions associated background skull scalp zero. fig. bias-variance analysis reconstructed parameter maps highly-undersampled ﬁngerprinting experiments using acquisition parameters conventional scheme optimized-i optimized-ii. normalized bias standard deviation rootmean-square error maps maps. regions associated background skull scalp zero. general evaluation performed three sets experiments respectively using acquisition parameters conventional scheme optimized-i optimized-ii. used spiral trajectory sampling pattern numerical simulations. acquisition times conventional scheme optimized) evaluation cross-scan variance given variance reduction direct beneﬁt based experiment design evaluated variance associated three acquisition schemes. speciﬁcally conducted acquisition times calculated normalized standard deviation associated acquisition scheme. absence ground truth phantom experiments standard deviations normalized respect parameter maps reconstructed fully-sampled data fig. shows normalized standard deviation maps three acquisition schemes fig. shows normalized standard deviation averaged tube. evident optimized experiments substantially reduce standard deviation maps providing similar standard deviation maps. particular optimized-ii achieves factor reduction standard deviation maps tubes. evaluated performance proposed approach vivo experiments. conducted imaging experiments healthy volunteer approval local institutional review board informed consent obtained subject. performed highly-undersampled ﬁngerprinting experiments conventional scheme optimized-i optimized-ii scanner acquisition length performed reconstruction estimate maps highlyundersampled data. moreover repeated acquisition times evaluated sample variance associated acquisition scheme. fig. shows reconstructed maps three acquisition schemes well normalized standard deviation maps repetitions imaging experiments. standard deviations normalized respect parameter maps reconstructed conventional scheme fig. shows normalized standard deviations averaged representative rois respectively gray matter white matter. additional results comparing tissue parameter standard deviations whole brain found supplementary material. first note optimized acquisition schemes provide maps similar range conventional scheme conﬁrming feasibility proposed experiment designs. second optimized acquisition schemes improve standard deviation providing similar standard deviation results consistent numerical simulations phantom experiments. lastly comparing optimized-i optimized-ii reduces artifacts associated reconstruction white matter also enables better variance estimation. illustrates beneﬁts introducing variation constraint experiment design. fig. overall error versus acquisition length highlyundersampled ﬁngerprinting experiments overall error map. overall error map. note overall error calculated respect whole brain excluding skull scalp csf. fig. overall error versus level highly-undersampled ﬁngerprinting experiments overall error map. overall error map. note overall error calculated respect whole brain excluding skull scalp csf. performing fully-sampled ﬁngerprinting experiment using acquisition parameters conventional scheme. acquisition time experiment min. additionally calibrated spiral trajectory specialized pulse sequence avoid potential trajectory distortion finally performed auxiliary scan gradient echo sequence estimated coil sensitivity maps. acquisition took sec. performed reconstruction experiments incorporated slice-proﬁle correction dictionary. fig. shows reconstructed maps relative error maps corresponding reconstruction errors tube. clear optimized-ii signiﬁcantly improves accuracy conventional scheme providing similar accuracy map. compared optimized-i optimized-ii also provides better accuracy particularly maps. conﬁrms beneﬁts introducing constraint angle variation highly-undersampled ﬁngerprinting experiments. fully-sampled experiment performed repeating highlyundersampled acquisition times. acquisition switched different spiral interleaf every time point. note short time delay added consecutive acquisitions ensure magnetization starts thermal equilibrium. fig. reconstructed parameter maps phantom experiments using acquisition parameters conventional scheme optimized-i optimized-ii. reconstructed associated relative error map. overall error reconstruction tube. reconstructed associated relative error map. overall error tube. note highly-undersampled ﬁngerprinting experiments using conventional scheme optimized-i optimized-ii respectively took whereas fully-sampled ﬁngerprinting experiment reference data took min. alternatively derive model expanded phase graph formalism similar early work observed models equivalent terms simulating magnetization evolutions however state-space model isochromat summation approach conceptually simple easy describe mathematically facilitates subsequent derivation. also note work used simpliﬁed data model calculate optimize acquisition parameters. yields small-scale fims enabling efﬁcient computation storage. tailor highly-undersampled experiments incorporated constraint angle variation balance improvement encoding efﬁciency considerations decoding. generalization would interesting formulate problem directly optimizes highly-undersampled ﬁngerprinting experiments. could allow joint design acquisition parameters k-space trajectories however note calculation case requires signiﬁcantly higherdimensional formulation models contrast encoding spatial encoding often results fig. normalized standard deviation maps associated conventional acquisition optimized-i optimized-ii estimated independent imaging experiments. normalized standard deviation maps normalized standard deviation maps regarding numerical optimization worth reiterating proposed formulations result non-convex optimization problems solution algorithm guaranteed local convergence. work initialized algorithm acquisition parameters conventional ﬁngerprinting experiments demonstrated good performance. supplementary material evaluated impact initialization experiment design. simply different initializations lead different local minima although cost function values local minima close. interestingly several distinct initializations produce optimized acquisition parameters. non-convex optimization problem behavior rather remarkable worth in-depth theoretical study future. solving observed optimized acquisition parameters appeared highly structured. particular optimized repetition times appeared binary. interesting behavior worth in-depth study. note shown certain based experiment design problem involving dynamic system cast optimal control problem. possible empirical observations could explained principles optimal control theory although control-theoretic characterization beyond scope paper interesting topic follow particular know advance admit structured solutions fact could leveraged simplify algorithms used derive optimal experiment design. optimal control viewpoint algorithm solving targets necessary condition optimal control problem nonlinear programming algorithms local minima obtained algorithm generally good would obtained dynamic programming which contrast deals sufﬁcient condition optimal control problem. however complexity algorithm grows polynomially number design parameters thus curse-of-dimensionality issue dynamic programming. practice solutions show substantial improvement conventional acquisition demonstrating practical utility. respect experimental validation demonstrated merit proposed framework i.e. variance reduction parameter estimation especially estimation. example demonstrated proposed framework enables factor reduction knowledge work ﬁrst reports bang-bang structure optimized acquisition parameters ﬁngerprinting. although maidens formulated experiment design problem optimal control problem derived approximate dynamic programming algorithm considered highly-simpliﬁed problem setup report bang-bang behavior. proposed formulation manually selected parameters weighting matrix constraint sets provided good performance application example. general choose parameters according application-speciﬁc requirements. example desirable constrain angles small apply multiple inversion pulses acquisition cardiac ﬁngerprinting experiments another related aspect example implementation proposed approach utilizes representative tissues design ﬁngerprinting experiments. practical since range tissue parameter values often known priori speciﬁc imaging application. strategy generalizes well demonstrated numerical simulations real experiments. supplementary material include additional results conﬁrm good generalization capability strategy. alternatively incorporate prior tissue parameters experiment design ways. example perform bayesian experiment design incorporating probability distribution tissues parameter values perform optimal experiment design bayesian alternatives include min-max experiment design minimizes worst-case fig. reconstructed parameter maps normalized standard deviation maps vivo experiments using acquisition parameters conventional scheme optimized-i optimized-ii. reconstructed maps. reconstructed maps. normalized standard deviation maps normalized standard deviation maps standard deviation improvement substantial could potentially correspond quadrupling averaging time upgrade higher ﬁeld scanner. expect positive impact utility ﬁngerprinting. optimization focuses minimizing variance assumption unbiased estimation real parameter estimation error also include contributions bias. numerical simulations demonstrated optimized-ii provides similar level bias conventional scheme. however real experiments particularly vivo experiments assessing bias involved. first note underlying ground truth vivo experiments second various model mismatches often complicate bias evaluation comparison. example partial volume effect often yield different magnetization evolutions different signal excitations result signiﬁcant difﬁculty comparing different acquisition schemes thorough assessment bias parameter estimation still remains open problem ﬁngerprinting quantitative imaging general. implementations possible alternatives preferable depending imaging context. example used weighted a-optimality criterion design ﬁngerprinting experiments demonstrated good performance. alternative design criteria could incorporated proposed framework exploration criteria beneﬁcial certain applications. another example also include acquisition parameters optimization. larger search space acquisition parameters could achieve better performance although resulting optimization problem computationally expensive. additionally could optimize ﬁngerprinting experiments include tissue parameters apparent diffusion coefﬁcients magnetization transfer etc. lastly although implementation paper focused optimizing ﬁxed number many design considerations total acquisition time etc) important worth including within optimization framework. exploring possibilities improve practical signiﬁcance approach. work presented novel estimation-theoretic framework optimize acquisition parameters ﬁngerprinting experiments. formulated optimal experiment design problem maximizes efﬁciency ﬁngerprinting experiment incorporating additional constraints advantageous reconstruction process. optimized experiments enables substantially improved accuracy maps providing similar slightly better accuracy maps. remarkably found optimized acquisition parameters appear highly structured rather random/pseudo-randomly varying used conventional ﬁngerprinting experiments. authors would like thank anonymous reviewers constructive comments help improve paper. zhao would like thank polo help creating physical phantom drs. park chang discussions correction acquisition imperfections. zhao haldar liao griswold setsompop wald optimal experiment design magnetic resonance ﬁngerprinting insights improvements proc. int. symp. magn. reson. med. teixeira malik hajnal joint system relaxometry cram´er-rao lower bound optimization sequence parameters framework enhanced precision despot estimation magn. reson. med. press. zhao setsompop adalsteinsson gagoski jiang grant griswold wald improved magnetic resonance ﬁngerprinting reconstruction low-rank subspace modeling magn. reson. med. vol. jiang seiberlich gulani griswold ﬁngerprinting using fast imaging steady state precession spiral readout magn. reson. med. vol. assl¨ander glaser hennig pseudo steady-state free precession mr-ﬁngerprinting magn. reson. med. vol. rieger zimmer zapp weing¨artner schad magnetic resonance ﬁngerprinting using echo-planar imaging joint quantiﬁcation relaxation times magn. reson. med. vol. lampinen szczepankiewicz westen englund sundgren l¨att st˚ahlberg nilsson optimal experimental design ﬁlter exchange imaging apparent exchange rate measurements healthy brain intracranial tumors magn. reson. med. vol. hilbert kober zhao block j.-p. thiran krueger sodickson cloos mitigating effect magnetization transfer magnetic resonance ﬁngerprinting proc. int. symp. magn. reson. med. pierre jiang schluchter setsompop gulani griswold music-based magnetic resonance ﬁngerprinting improve patient comfort examinations magn. reson. med. vol. chen jiang herrmann vincent dell drumm brady-kalnay griswold flask preclinical ﬁngerprinting effective quantitative imaging rodent disease models biomed. vol. chen input design aircraft parameter identiﬁcation using time-optimal control formulation methods aircraft state parameter identiﬁcation advisory group aerospace research development conference proceedings osmolovskii maurer applications regular bangbang control second-order necessary sufﬁcient optimality conditions calculus variations optimal control. philadelphia siam", "year": "2017"}