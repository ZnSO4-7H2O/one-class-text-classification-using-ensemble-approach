{"title": "Time series kernel similarities for predicting Paroxysmal Atrial  Fibrillation from ECGs", "tag": "eess", "abstract": " We tackle the problem of classifying Electrocardiography (ECG) signals with the aim of predicting the onset of Paroxysmal Atrial Fibrillation (PAF). Atrial fibrillation is the most common type of arrhythmia, but in many cases PAF episodes are asymptomatic. Therefore, in order to help diagnosing PAF, it is important to design procedures for detecting and, more importantly, predicting PAF episodes. We propose a method for predicting PAF events whose first step consists of a feature extraction procedure that represents each ECG as a multi-variate time series. Successively, we design a classification framework based on kernel similarities for multi-variate time series, capable of handling missing data. We consider different approaches to perform classification in the original space of the multi-variate time series and in an embedding space, defined by the kernel similarity measure. We achieve a classification accuracy comparable with state of the art methods, with the additional advantage of detecting the PAF onset up to 15 minutes in advance. ", "text": "work propose framework based time series analysis methods predict onset paf. overall procedure consists different steps. first extract numerical descriptors characterizing original signals. then perform feature selection extract reduced subset features according mutual dependencies. values assumed time selected features represented multivariate time series might contain missing values. finally order predict onset train classiﬁer based special kernel similarity measures designed missing data classiﬁer trained either input space using directly relationships among data deﬁned kernel similarity embedding space represented similarity values respect training data. evaluate effectiveness proposed framework take account data physionet prediction challenge results show performance higher respect state-of-the-art results correctly identify ecgs associated events. also option predict onset minutes event thus providing ability alert patient possible occurrence episode. work provides following contributions methodological contribution propose novel method predicting events based classiﬁer trained either input embedding space induced kernel similarity measure. space samples described similarities respect elements training set. kernel similarities missing data recent development time series analysis never considered context prediction represents thus ﬁeld application. abstract—we tackle problem classifying electrocardiography signals predicting onset paroxysmal atrial fibrillation atrial ﬁbrillation common type arrhythmia many cases episodes asymptomatic. therefore order help diagnosing important design procedures detecting importantly predicting episodes. propose method predicting events whose ﬁrst step consists feature extraction procedure represents multi-variate time series. successively design classiﬁcation framework based kernel similarities multi-variate time series capable handling missing data. consider different approaches perform classiﬁcation original space multivariate time series embedding space deﬁned kernel similarity measure. achieve classiﬁcation accuracy comparable state methods additional advantage detecting onset minutes advance. wearable devices nowadays able capture bio-signals electrocardiograms extended period time. data recorded devices paramount clinical importance assessment numerous heart-related conditions. among them prediction paroxysmal atrial fibrillation episodes risk stratiﬁcation pafprone patients high importance atrial ﬁbrillation common type arrhythmia. symptoms include fatigue decreased exercise tolerance palpitations dyspnea exertion generalized weakness even though many cases episodes asymptomatic risk progressing permanent atrial ﬁbrillation increases time. problem detecting predicting events recordings received attention researchers different ﬁelds many approaches proposed tackle problems including entropy descriptors p-wave characterization number premature atrial complexes intervals heart variability rate average number f-waves interval hybrid complex networks time series analysis techniques degree parallelization. provides opportunity signiﬁcantly speeding computation procedure implemented highly scalable systems embedded devices parallel computing support. remaining part paper organized follows section describes dataset prediction challenge used develop method; section describes details framework section presents results obtained. consider data physionet prediction challenge half records present database acquired patients prone half healthy subjects. patients ongoing pafs considered. database provides training consisting records patients records healthy subjects test containing records. excerpts minutes long concurrently acquired sensors. prediction challenge aims predicting onset events occurrence. therefore task tackle simple detection problem. dataset analysis consists recordings organized follows. test ﬁrst event recordings classiﬁed control pafprone. generating test prediction challenge recordings paf-prone patients considered. paf-prone recordings divided classes closeto-onset far-from-onset class. former represents records preceding event; latter instead represents records precede event. therefore generating test prediction challenge recordings equally distributed different classes. training constructed considering pairs recordings time taken pafprone subjects belonging records used training total records used training. propose classiﬁcation framework implements procedure summarized fig. procedure consists three main steps feature extraction computation kernel similarity iii) training classiﬁer. details phase given remainder section. objective step extract descriptors useful classiﬁcation. selected descriptor represented variable that turn becomes representation original ecg. therefore dataset represented number variables number time steps shortest fig. schematic depiction proposed classiﬁcation procedure. original dataset signals processed feature extraction block represent mts. speciﬁc kernel measures used evaluate similarities stored kernel matrix. kernel matrix ﬁnally exploited train classiﬁer predicting onset original signal. number time steps longest one. dataset analysis number variables determined feature extraction procedure consists main steps feature generation feature selection. feature generation signals initially processed identifying interval successive heartbeats variation time interval heartbeats provides important clinical descriptors used characterize heart failure circulatory diseases compute intervals ﬁrst pre-process signal using morphological ﬁltering technique described morphological ﬁltering allows retain useful information acquired signals effectively eliminating noise originating multiple sources low-frequency baseline wandering higher-frequency components step enhance quality acquired data combine signals different inputs feature extraction step. study employ root mean square combination signals provided paf-prediction database. delineation performed individual signals provided prediction database root-mean-square combination. cases ﬁducial points cannot extracted quality signal. quality different reasons imprecise/faulty measurements registered leads. cases missing value descriptors correspondence time steps relative portion measured quality. techniques better performance available extracting ﬁducial points ones used work suitable used resources-constrained devices wearable ones. thus satisfy conditions methodology designed operate. output procedure produces original signal time series features related morphological wave characteristics feature selection feature generation procedure original represented variates. initially considered available features. however preliminary results showed training classiﬁer using variates yielded worse results. indeed original features highly correlated. furthermore including features computational time evaluate kernel similarities training classiﬁer increase considerably. therefore considered different subsets features experiments performing feature selection original variates. guiding selection features evaluated linear pearson correlation. fig. show sample correlation matrix variables computed follows particular avoided select time attributes highly correlated suitable threshold average correlation matrix used choice allows highly correlated variables time signiﬁcantly reduce memory requirements procedure. feature selection procedure reduced number variables those describe features mostly related intervals summarized tab. dynamic time warping widely used approach assess similarity time series cannot treat original formulation. complicated variants proposed deal multiple variables characterized difﬁcult hyperparameter tuning description position peak number structures beat peak value wave area wave width wave time distance beginning peak maximum value position wave peak value wave area wave width wave time distance beginning peak maximum value interval waves position peak peak value wave area wave width wave time distance beginning peak maximum value interval wave interval interval peaks interval segment time distance waves interval mean interval peaks mean work adopt different kernel similarities learned pattern similarity time series cluster kernel whose details provided following subsections. methods beneﬁt high parallelization capabilities learn model that training over quickly process unseen data. procedures computing require equal length therefore followed approach proposed means linear interpolation length longest dataset ceiling operator. computing also standardized i.e. variable dataset subtract mean value divide standard deviation computed training set. hand since decision trees scale invariant apply transformation training procedure returns kernel matrix rntr×ntr whose components similarities among elements training set. ﬁtted process test generate additional matrix rnte×ntr whose components similarities elements training respect test set. represent size test training respectively nts. account missing patterns data compute similarities rather relying imputation methods introduce strong biases. imputation techniques replace missing values predeﬁned computed values empirical mean last seen values. choice often arbitrary presence large amounts missing values resulting data signiﬁcantly different well result analysis. learned pattern similarity learned pattern similarity algorithm based identiﬁcation segments-occurrence within time series. generalizes naturally means regression trees bagof-words type compressed representation created turn used compute similarity score. considered state-of-the-art inherits decision tree approach handle missing data based ensemble strategy. speciﬁcally extracts possible segments length starting time index randomly initialized regression trees. since naturally deals missing data general necessary replace missing entries. time series cluster kernel time series cluster kernel computes unsupervised kernel similarity missing data. method based ensemble learning approach wherein robustness hyperparameters ensured joining clustering results many gaussian mixture models form ﬁnal kernel. hence critical hyperparameters tuned user. order deal missing data gmms extended using informative prior distributions generate partitions different resolutions capture local global structures input data similarity matrix built ﬁtting gmms time series number mixtures different number components. provide diversity ensemble partition evaluated random subset attributes segments using random initializations randomly chosen hyperparameters. also helps provide robustness concerns hyperparameters selection. built summing inner products pairs posterior distributions corresponding different time series. hyperparameters needs speciﬁed number different random initializations maximum number gaussian mixtures sufﬁcient hyperparameters reasonable high values obtain good performance many tasks kernel matrices generated train classiﬁer based similarities yielded kte. principle classiﬁer operating real-valued vectors consider different ones knearest neighbors classiﬁer support vector machine classiﬁer perform classiﬁcation follow different approaches classiﬁcation input space classiﬁcation similarity-induced embedding space. ﬁrst approach classiﬁcation performed directly input space considering similarity samples values contained kernel matrix kte. element test select relative select indices relative highest values identify training similar estimated label frequent among mts. hand possible train classiﬁer using precomputed kernel deﬁnes kernel space optimal separating hyperplane computed. case label assigned according region contains second approach rather assuming input classiﬁcation original whose similarity described kernel matrix train classiﬁer rows kte. particular rntr considered vectorial embedding representation original similarity space. necessary compute additional vector similarity among rows kte. consider euclidean cosine cityblock pearson correlation similarities identify vector similar vectors ktr. analogously compute kernel similarity among rows using radial basis functions whose analytic expression reads compared directly performing classiﬁcation input space approach requires additional computation evaluate vector similarities among representations original mts. increment training time scales dimensionality vectors equal i.e. size training set. procedure computational demanding case classiﬁer adopted since kernels must evaluated pair vectors. proposed approach based similarity-induced embedding provides stronger form regularization usually improves generalization capability classiﬁer. additionally similarity embedding model better relationships among classes thanks robustness instance level noise finally similarity embedding highly synthesize information characterized large number variables time steps i.e. ntr. however cases classiﬁer required capture higher degree variance among data embedding approach might beneﬁcial. section describe experiments performed report results obtained. whole classiﬁcation framework including kernels implemented matlab. experiment number regression trees length segments instead maximum number gaussian mixtures number random initializations kernel matrices yielded depicted fig. higher values position matrices higher similarity corresponding depiction brighter colors correspond higher similarities. possible observe block structure matrices denotes intraclass similarities higher inter-class similarities. blocks representing relative far-from-onset close-to-onset patients visible clearly kernel matrix yielded suggests superior capability discriminate classes. following present different experiments. first sec. iv-a report classiﬁcation results original dataset relative second challenge obtained means proposed framework. then sec. iv-b analyze results change vary number time steps taken account signals; accordingly results evaluating performance here evaluate results obtained proposed approach classify far-from-onset close-to-onset classes objective second challenge comparison also report three best ofﬁcial results terms accuracy obtained challenge discussed sec. iii-c possible kernel matrices directly pre-computed kernel kernel-based classiﬁer exploit pairwise similarity scores classiﬁer operating input space. second approach consider kernel matrix ntr-dimensional embedding vector. compared original representations samples highly compressed since move rntr dataset. embedding-based approach several similarity measures used evaluating relationships embedding vectors evaluate classiﬁcation performance consider accuracy recall close-to-onset class ﬁnally score. select optimal hyperparameters classiﬁers perform k-fold cross-validation. classiﬁer consider range values number neighbors case classiﬁcation embedding space consider possible vector similarities euclidean distance cosine similarity cityblock distance pearson correlation. presence ties resolve deterministically assigning label class far-from-to-onset samples. classiﬁer search margin hyperplane kernel bandwidth classiﬁcation results obtained kernel similarities yielded shown tab. along optimal hyperparameters found. refer knn-i svm-i table classiﬁcation results input space embedding space using time series similarities tck. report classiﬁcation accuracy recall close-to-onset class measure relative conﬁguration achieving best value validation procedure. also report optimal hyperparameters conﬁguration. best results method shown bold. last entries table best ofﬁcial results reported challenge note reported performance measure. observe conﬁgured yield time better results. however conﬁgured operates input space provides best results comparable state-of-the-art. indeed highest ofﬁcial accuracy obtained problem knn-i+lps obtains interestingly notice validation procedure always identiﬁes optimal high values number neighbors high value improves robustness noise classiﬁer. particularly important real-world datasets considered work especially boundaries different classes distinct respect remaining hyperparameters notice optimal conﬁguration found cross-validation varies case case. second experiment study classiﬁcation outcomes change take account increasing number time steps input mts. particular expand initially small time window located recording iteratively including measurements closer hence closer onset. allows evaluate much time ahead events predicted accurately framework. applying window increasing size original data obtain different classiﬁcation problems fig. graphically illustrates procedure. ﬁrst problem created considering smallest window heartbeats fig. classiﬁcation windows increasing size. ﬁrst classiﬁcation problem takes account small timewindow heartbeats actual event. last classiﬁcation problem takes account maximum number time steps considering window size equal shortest terms heartbeats positioned possible event note ﬁrst heartbeat considered ﬁrst shortest time series therefore window maximum width considered last classiﬁcation problem length equal number heartbeats shortest dataset details classiﬁcation problems reported tab. iii. note that assuming adult approximately heartbeats minute last column constitutes approximation minutes window occurrence event. classiﬁcation results problem different classiﬁcation methods reported fig. terms accuracy recall classiﬁer uses hyperparameter conﬁgurations described tab. notice best performance task terms recall obtained classiﬁer conﬁgured operating input space. hand operating input space fig. classiﬁcation accuracy recall close-to-onset class obtained different classiﬁers considering different windows increasing size reported table iii. conﬁgured obtain best performance terms accuracy also note knn-e conﬁgured achieves stable results different lengths time windows since performance classiﬁcation deteriorate signiﬁcantly data items event considered. suggests method suitable early detection onset. note that latter case high accuracy recall obtained problem considered time window terminates roughly minutes actual onset. interestingly experiment observe recall general much lower short time windows considered. hand accuracy classiﬁcation stable classiﬁcation problem. demonstrates proposed method capable detecting onset classiﬁcation accuracy comparable state methods additional advantage detecting event several minutes occurrence. paper proposed methodology classify predicting onset paroxysmal atrial fibrillation. represented ecgs multi-variate time series measurements different descriptors time. considered kernel functions multi-variate time series allowed compute pair-wise similarity ecgs. similarities exploited training classiﬁer deﬁned either original input space similarity-induced embedding space. classiﬁcation results higher pair state-of-the-art approaches. addition show proposed framework possible predict good precision onset several minutes available recordings. result signiﬁcant practical importance makes possible conceive early-warning system onset alert patient occurrence event. proposed methodology particularly efﬁcient terms computational resources. particular bottleneck computation kernel similarity matrix implemented efﬁciently embarassingly parallelizable algorithm computational complexity scales linearly number available computing units. thanks property proposed framework also suitable implementations highly parallel hardware devices multicore microprocessors ones adopted embedded systems. future includes porting onto embedded systems proposed software pipeline. work supported funded hasler foundation project personal device automatic evaluation health status physical training paper reﬂects view authors. authors would like thank elisabetta giovanni amir aminifar prof. alonso david atienza ´ecole polytechnique f´ed´erale lausanne helping feature extraction process well precious feedback. moody goldberger mcclennen swiryn predicting onset paroxysmal atrial ﬁbrillation computers cardiology challenge computers cardiology. rotterdam netherlands ieee sep. goldberger amaral glass hausdorff ivanov mark mietus moody c.-k. peng stanley physiobank physiotoolkit physionet components research resource complex physiologic signals circulation vol. malik f¨arbom batchvarov hnatkova camm relation intervals highly individual among healthy subjects implications heart rate correction interval heart vol. braojos lopez ansaloni atienza alonso vallejos javier embedded real-time delineation methods comparative evaluation ieee international conference bioinformatics bioengineering vol. wang wang effective multivariate time series classiﬁcation approach using echo state network adaptive differential evolution algorithm expert systems applications vol. marlin kale khemani wetzel unsupervised pattern discovery electronic health care data using probabilistic clustering models proceedings sighit international health informatics symposium miami jan. mikalsen bianchi soguero-ruiz skrøvseth r.-o. lindsetmo revhaug jenssen learning similarities irregularly sampled short multivariate time series ehrs proc. international workshop pattern recognition healthcare analytics icpr øyvind mikalsen soguero-ruiz bianchi revhaug jenssen unsupervised multivariate time series kernel approach identifying patients surgical site infection blood samples arxiv e-prints alcaraz rieta review sample entropy applications non-invasive analysis atrial ﬁbrillation electrocardiograms biomedical signal processing control vol. hickey heneghan chazal non-episode-dependent assessment paroxysmal atrial ﬁbrillation measurement interval dynamics atrial premature contractions annals biomedical engineering vol. milosevic dittrich ferrante malek quiros braojos ansaloni atienza risk assessment atrial ﬁbrillation failure prediction approach computing cardiology conference. cambridge ieee sep. wann curtis january ellenbogen lowe estes page ezekowitz slotwiner jackman stevenson tracy accf/aha/hrs focused update management patients atrial ﬁbrillation circulation vol. available http//circ.ahajournals.org/content/// marco raine bourke langley characteristics atrial ﬁbrillation cycle length predict restoration sinus rhythm catheter ablation heart rhythm vol. m.-t. y.-c. chang young y.-h. y.-l. c.k. peng outlier-resilient complexity analysis heartbeat dynamics scientiﬁc reports vol. cervig´on moreno reilly millet p´erez-villacast´ın castells entropy measurements paroxysmal persistent atrial ﬁbrillation physiological measurement vol. mart´ınez ab´asolo alcaraz rieta alteration p-wave non-linear dynamics near onset paroxysmal atrial ﬁbrillation medical engineering physics vol. mart´ınez alcaraz rieta morphological variability p-wave premature envision paroxysmal atrial ﬁbrillation events physiological measurement vol. thong mcnames aboy goldstein prediction paroxysmal atrial ﬁbrillation analysis atrial premature complexes ieee transactions biomedical engineering vol. apr. schlenker socha riedlbauchov´a nedˇelka schlenker mal´a kut´ılek recurrence plot heart rate variability signal patients vasovagal syncopes biomedical signal processing control vol. qian feng chen novel method real-time atrial ﬁbrillation detection electrocardiograms using multiple parameters annals noninvasive electrocardiology vol. yang x.-m. bridging time series dynamics complex network theory application electrocardiogram analysis ieee circuits systems magazine vol. nov.", "year": "2018"}