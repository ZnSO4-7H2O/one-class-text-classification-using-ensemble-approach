{"title": "Technical Report: A New Decision-Theory-Based Framework for Echo  Canceler Control", "tag": "eess", "abstract": " A control logic has a central role in many echo cancellation systems for optimizing the performance of adaptive filters while estimating the echo path. For reliable control, accurate double-talk (DT) and channel change (CC) detectors are usually incorporated to the echo canceler. This work expands the usual detection strategy to define a classification problem characterizing four possible states of the echo canceler operation. The new formulation allow the use of decision theory to continuously control the transitions among the different modes of operation. The classification rule reduces to a low cost statistics for which it is possible to determine the probability of error under all hypotheses, allowing the classification performance to be accessed analytically. Monte Carlo simulations using synthetic and real data illustrate the reliability of the proposed method. ", "text": "continuous step size adjustment frequency domain approach however eventual beneﬁt avoiding detection usually comes expense decreased convergence rates need additional information loudspeaker-microphone coupling near-end signal statistics moreover methods require extra estimation strategies resulting extended memory usage computational complexity significantly simpliﬁed implementations practical applications. several works proposed methods detection without considerations regarding however detection strategies assume static channel response yield unpredictable performances presence vast majority techniques available detection rely statistics make decision leading cumbersome design processes. works employ statistical framework formulate detection problem. instance proposes maximum posteriori decision rule based channel output observations assuming bernoulli distributed priors different hypotheses. similar approach used employing markov channel model. generalized likelihood ratio test proposed using observations channel input output signals. detection considered. ﬁrst test distinguishes single-talk second test based echo path estimate detects though latter studies consider single formulation aforementioned statistical formulations proposed conventional adaptive structure alternative structure proposed uses shadow adaptive ﬁlter operates parallel actual echo cancellation ﬁlter. shadow ﬁlter coefﬁcients transferred echo cancellation ﬁlter shadow ﬁlter better estimate unknown channel response echo cancellation ﬁlter. authors experience structure allows much better control convergence conventional structure. structure shown fig. consists main echo cancellation ﬁlter adaptive shadow ﬁlter. output main ﬁlter subtracted echo obtain canceled echo shadow ﬁlter weights adapted continuously. control shadow ﬁlter coefﬁcients copied main ﬁlter improve performance. likelihood ratio test detector abstract— control logic central role many echo cancellation systems optimizing performance adaptive ﬁlters estimating echo path. reliable control accurate double-talk channel change detectors usually incorporated echo canceler. work expands usual detection strategy deﬁne classiﬁcation problem characterizing four possible states echo canceler operation. formulation allow decision theory continuously control transitions among different modes operation. classiﬁcation rule reduces cost statistics possible determine probability error hypotheses allowing classiﬁcation performance accessed analytically. monte carlo simulations using synthetic real data illustrate reliability proposed method. index terms— adaptive ﬁlters adaptive signal processing adaptive systems echo cancellation channel change double-talk classiﬁcation multivariate gamma distribution. echo cancellation requirement modern voice communication systems. speech echo cancelers employed telephone networks hands-free communications designs include main blocks; channel identiﬁcation block control logic block. channel identiﬁcation block tries estimate echo path often employing adaptive ﬁltering. however adaptive algorithm tends diverge presence near-end signals hence adaptation must stopped hand abrupt echo channel changes require faster adaptation improve tracking. finally absence slow adaptation rate tends improve channel estimation accuracy. control logic required control transitions among distinct modes adaptive operation. numerous approaches proposed deal echo cancelers. approaches proposed require detector aiming continuous adaptation methods employ signal correlations independent component analysis jean-yves tourneret university toulouse irit enseeiht camichel toulouse cedex france emailjean-yves.tourneretenseeiht.fr. jos´e carlos bermudez tales imbiriba dept. electrical engineering federal university santa catarina florian´opolis brazil e-mailj.bermudezieee.org talesimgmail.com. neil bershad dept. electrical engineering computer science university california irvine irvine santiago drive newport beach u.s.a. e-mailbershadece.uci.edu channel input vector dimension covariance matrix channel output scalar input signal stationary within decision periods signal modelled white gaussian process detection purposes also modelled zeromean gaussian vector. denoting adaptive shadow ﬁlter main echo cancellation ﬁlter channel output expressed follows different hypotheses hypothesis considers converged recently copied hypothesis assumes already converged channel change. signal happens convergence copy finally fourth hypothesis considers happens following already converged channel copied cases rely convergence relation resulting several practical implications concerning control logic block fig. control strategy addressed section additive noise stationary zero-mean white gaussian independent modeling zero-mean white gaussian independent introduced facilitate analysis. error signals expressed follows different hypotheses ased structure fig. derived detect versus generalized could simpliﬁed sufﬁcient statistic proposed structure performance test statistic evaluated function system parameters. idea developed detection result stop adaptation detected adapt fast presence channel change. speed adaptation controlled adaptation step size. several motivations identifying four classes. motivations include possibility adjust accurately step size adaptive ﬁlter long time intervals resulting smaller residual errors inclusion adds important degree ﬂexibility control logic exploited shown section four classes lead simple cost test statistic. paper organized follows. section introduce signal models derive classiﬁcation rules. section present performance analysis proposed classiﬁer. monte carlo simulations presented section validate theory. section discusses application proposed classiﬁcation strategy presents illustrative simulation results. finally section discusses results presents conclusions. note whiteness assumption restrictive since always possible whiten channel outputs pre-multiplying consecutive samples appropriate matrix. course operation assumes covariance matrix consecutive noise samples known estimated. interpreted power output difference ﬁlter response assuming hypotheses equiprobable classiﬁcation rule minimizing average probability error decides hypothesis true deﬁning zero-mean gaussian vector hypotheses. straightforward computations yield covariance matrices different hypotheses. matrices expressed multiple samples analysis generalized case multiple time samples available. analysis performed samples simplicity generalized later. samples observed error signals considered. expressed follows different hypotheses classiﬁer performance. first note elements form diagonal matrix since jointly distributed according zero-mean gaussian distribution covariance matrix shown appendix that hypotheses distributed according multivariate gamma distribution denoted shape parameter scale parameter vector sufﬁcient statistic solving proposed classiﬁcation problem. noting rearrangement vectors distribution obtained following reasoning presented appendix assumption independence vectors stationarity assuming vectors distributed according zero-mean gaussian distribution covariance matrix distributed according wishart distribution degrees freedom thus diag distributed according multivariate gamma distribution shape parameter given represents integration limits associated detailed expansion classes presented appendix iii. integral implemented using matlab function integral.m. figures show probabilities computed different sets using functions parameters. ﬁgures corresponds given true hypothesis figure shows plots clearly show performance classiﬁer improves increasing large value especially important distinguishing hypotheses also clear classiﬁcation error increases signiﬁcantly limiting situation vector values compared obtained one-sample case. generalization samples straightforward. indeed p-sample case covariance matrices deﬁned replaced deﬁned differently. however since cancels difference inverses classiﬁcation rule p-sample case expressed squared norm replaced clear classiﬁcation rules sufﬁcient statistic classiﬁcation problem. interestingly exact distribution derived hypotheses allowing analytical study placed exactly line separating classes since yielded good classiﬁcation performance opted ﬁxing figs. varying power fig. noise power fig. although power little inﬂuence classiﬁer performance hypotheses clearer inﬂuence observable case increasing power tends increase behavior expected effect channel change distinguishing hypotheses diminishes increase power. figure explores effect noise power classiﬁer performance. noted large noise power increases probability error detecting onset performance function noise ratio effect however small ratios larger typical practice. simulations one-sample case different noise powers available figs. respectively. although results obtained one-sample case show stronger inﬂuence noise power classiﬁcation performance compared results corroborate conclusions. section monte carlo simulations performed compared theoretical expressions derived previous section. results also valuable assess effect independence approximation analysis accuracy. generate statistics sampling dimensional vectors need deﬁne covariance correlation matrices. considering input signal auto-regressive order chosen follows relative delay channel parameter deﬁned ﬁlter gain different scenarios studied corresponding figure presents simulations obtained averaging runs varied range leading figure presents simulation comparing figs. theoretical results small degradation classiﬁcation accuracy noted mainly small difference attributed independence approximation. simulations different values correlation coefﬁcient shown figs. although varying little impact classiﬁcation performance interesting notice increasing slightly improves classiﬁcation performance classes especially classiﬁcation hypotheses presented considered case adaptive ﬁlter time converge diverge. becomes critical point designing control block since probabilities error high direct consequences related values characteristic following becomes zero probability error becomes large classes fact vector exactly frontier classes happens assume values true ﬁlter response hnew. case classiﬁcation errors expected since norms become larger address problems propose control strategy combines tuning adaptive step size deﬁning appropriate frequency realization tests introducing delay actually changing system state decision. state advisable consider delay samples decision moment actual ﬁlter copy. decisions neighborhood decision rather arbitrary practical situations address issue propose allow changes classes samples second occurs period sample adaptive algorithm employed normalized least mean square algorithm whose maximum convergence speed known attained control parameters −db. adaptive ﬁlter coefﬁcients initialized equal zero adaptation step initialized simulation results realization synthetic signal shown fig. panel presents classes attributed classiﬁer sample time. second panel presents step-size corresponding class. x−n) squared excess errors follow bottom panels. although good classiﬁcation performance evident example h/hh issue discussed section vnoticed sample samples classiﬁed becomes smaller correct class selected sample however since adaptive ﬁlter never stops adapting problem satisfactorily mitigated without severe deterioration echo canceler performance veriﬁed results bottom panels. results clearly show performance improvement resulting generalization approach proposed improvement shows especially single-talk periods. occur periods proposed solution leads reduction step size clearly improving quality channel estimation. note instance step size simulation presented section used voice data channels considered data approximately samples long cc’s occurring sample intense occurring simulation results presented fig. compare proposed decision framework sequential classiﬁcation strategy presented deal power ﬂuctuation inherent speech signals used detection threshold chosen empirically avoid errors remaining control strategy parameters kept used synthetic simulation presented fig. parameters used method values used authors. although detector presented also considers different classes authors consider inﬂuence multiple samples used shadow ﬁlter conﬁguration clearly impacts results. results displayed fig. also compared result obtained indicates proposed classiﬁcation control strategies perform least well previous echo cancellation systems. manuscript presented computational cost multi-class classiﬁer coupling control strategy echo cancellation problem. proposed classiﬁcation rule initially proposed one-sample easily extended multi-sample scenario. error probabilities also analytically computed assumption independence among vectors assumption bivariate gamma distributions sufﬁcient statistics performance curves proved accurate confronted monte carlo simulations. results showed greater ﬂexibility provided multi-class approach could well explored control strategy considered different step-sizes hypothesis. simulations synthetic data showed multi-class strategy viable accurate doubletalk noise power estimated improving ﬁlter convergence long periods single-talk. simulations realistic scenario showed proposed strategy works well methods literature even ignoring power ﬂuctuation speech signals using ﬁxed threshold fig. performance echo canceller system voice real channels. down panels present evolution classiﬁcation result adaptation step size results proposed method using method deﬁne independent random vectors denoted matrix v)··· vp−)]. then matrix known distributed according wishart distribution degrees freedom covariance matrix deﬁne vector composed elements main diagonal then shown proposition distributed according multivariate gamma distribution denoted shape parameter scale parameter elements covariance matrix making hypothesis assuming independence results show distributed according multivariate gamma distribution shape parameter scale parameter evaluated σip. gunther moon adaptive cancellation acoustic echoes double-talk based information theoretic criteria proc. asilomar conf. signals systems computers paciﬁc grove california gil-cacho waterschoot moonen jensen wiener variable step size gradient spectral variance smoothing double-talk-robust acoustic echo cancellation acoustic feedback cancellation signal processing vol. available http//www.sciencedirect.com/science/ article/pii/s yang enzner yang statistical convergence analysis optimal control dft-domain adaptive echo canceler ieee/acm transactions audio speech language processing vol. gil-cacho waterschoot moonen jensen frequency-domain adaptive ﬁlter prediction error method framework double-talk-robust acoustic echo cancellation ieee/acm transactions audio speech language processing vol. carlemalm logothetis detection double talk changes echo path using markov modulated channel model int. conf. acoust. speech signal proc. munich germany april fozunbal hans schafer decision-making framework acoustic echo cancellation proc ieee workshop applications signal processing audio acoustics paltz new-york oct. j.-y. tourneret bershad bermudez echo cancellation generalized likelihood ratio test double-talk versus channel change ieee trans. signal processing vol. mar. jean-yves tourneret ingnieur degree electrical engineering ´electronique ecole ´electrotechnique d’informatique d’hydraulique toulouse ph.d. degree national polytechnic institute toulouse currently professor university toulouse france member irit laboratory research activities centered around statistical signal processing particular interest markov chain monte carlo methods. program chair european conference signal processing held toulouse also member organizing committee international conference icassp’ held toulouse member different technical committees including signal processing theory methods committee ieee signal processing society currently serving associate editor ieee transactions signal processing. tales imbiriba received b.e.e. m.sc. degrees federal university par´a bel´em brazil doctorade degree federal university santa catarina florian´opolis brazil currently serving postdoctoral researcher digital signal processing laboratory ufsc. research interests include audio image processing pattern recognition kernel methods adaptive ﬁltering. jos´e carlos bermudez received b.e.e. degree federal university janeiro janeiro brazil m.sc. degree electrical engineering coppe/ufrj ph.d. degree electrical engineering concordia university montreal canada respectively. joined department electrical engineering federal university santa catarina florian´opolis brazil currently professor electrical engineering. winter visiting researcher department electrical engineering concordia university. visiting researcher department electrical engineering computer science university california irvine research interests involved analog signal processing using continuous-time sampled-data systems. recent research interests digital signal processing including linear nonlinear adaptive ﬁltering active noise vibration control echo cancellation image processing speech processing. prof. bermudez served associate editor ieee transactions signal processing area adaptive ﬁltering signal processing associate editor journal brazilian telecommunications society member signal processing theory methods technical committee ieee signal processing society currently associate editor eurasip journal advances signal processing. neil bershad received b.e.e. degree rensselaer polytechnic institute troy m.s. degree electrical engineering university southern california angeles ph.d. degree electrical engineering rensselaer polytechnic institute joined faculty henry samueli school engineering university california irvine emeritus professor electrical engineering computer science. research interests involved stochastic systems modeling analysis. recent interests area stochastic analysis adaptive ﬁlters. published signiﬁcant number papers analysis stochastic behavior various conﬁgurations adaptive ﬁlter. present research interests include statistical learning behavior adaptive ﬁlter structures echo cancellation active acoustic noise cancellation variable gain adaptive algorithms. bershad served associate editor ieee transactions communications area phase-locked loops synchronization. recently associate editor ieee transactions acoustics speech signal processing area adaptive ﬁltering.", "year": "2017"}