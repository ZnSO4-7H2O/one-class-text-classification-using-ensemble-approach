{"title": "Graph Laplacian for Image Anomaly Detection", "tag": "eess", "abstract": " Reed-Xiaoli Detector (RXD) is recognized as the benchmark algorithm for image anomaly detection, however it presents known limitations, namely the dependence over the image following a multivariate Gaussian model, the estimation and inversion of a high dimensional covariance matrix and the inability to effectively include spatial awareness in its evaluation. In this work a novel graph-based solution to the image anomaly detection problem is proposed; leveraging on the Graph Fourier Transform, we are able to overcome some of RXD's limitations while reducing computational cost at the same time. Tests over both hyperspectral and medical images, using both synthetic and real anomalies, prove the proposed technique is able to obtain significant gains over performance by other algorithms in the state-of-the-art. ", "text": "abstract reed-xiaoli detector recognized benchmark algorithm image anomaly detection however presents known limitations namely dependence image following multivariate gaussian model estimation inversion high dimensional covariance matrix inability eﬀectively include spatial awareness evaluation. work novel graph-based solution image anomaly detection problem proposed; leveraging graph fourier transform able overcome rxd’s limitations reducing computational cost time. tests hyperspectral medical images using synthetic real anomalies prove proposed technique able obtain signiﬁcant gains performance algorithms state-of-the-art. keywords anomaly detection graph fourier transform graph-based image processing principal component analysis hyperspectral images graphs proved natural tools represent data many domains e.g. recommendation systems social networks protein interaction systems recently found wide adoption also computer vision image processing communities thanks ability intuitively model relations pixels. graph-based approaches verdoja aalto university school electrical engineering maarintie espoo finland e-mail francesco.verdojaaalto.ﬁ grangetto university turin department computer science pessinetto turin italy e-mail marco.grangettounito.it proposed date solve wide variety image processing tasks e.g. edge detection gradient estimation segmentation particular spectral graph theory recently bridged signal processing graph used model local relations signal samples example graph-based signal processing emerging novel approach design energy compacting image transformations paper using graphs tackle image anomaly detection task spotting items conform expected pattern data. case images anomaly detection usually refers problem spotting pixels showing peculiar spectral signature compared pixels image. target detection considered interesting crucial tasks many high level imagevideo-based applications e.g. surveillance environmental monitoring medical analysis used widely validated techniques anomaly detection known reedxiaoli detector often called detector short date graph-based approaches proposed image anomaly detection although many techniques anomaly detection generic graphs explored literature techniques cannot extended image straightforwardly since usually exploit anomalies topology graph extract knowledge data hand image case graph topology constrained pixel grid whereas diﬀerent weights assigned edges connecting pixels depending similarity correlation. proposed approach uses undirected weighted graph model expected behavior data computes distance pixel image model. propose graph model spectral spectral spatial correlation. main contribution paper generalize widely used detector leveragmean vector covariance matrix computed assumption vectors observations random process; usually possible make assumption anomaly small enough negligible impact estimate finally decision threshold usually employed conﬁrm refuse anomaly hypothesis. common approach adaptively percentage dynamic range then pixel considered anomalous. despite popularity recognized drawbacks undermine performance applications. full discussion limitations suggest however summarized following involves high dimensional covariance matrix needs estimated inverted often small sample size unstable highly complex badly conditioned operations. individually extrapolated context address issues variations rxd’s idea proposed e.g. subspace whitening spatial correlation filtering kernel selective kpca minimum covariance determinant random-selection-based anomaly detector compressive graph signal processing. novel anomaly detector estimates statistic background using graph laplacian matrix overcomes well known limitations detector i.e. need estimate invert covariance matrix. estimation covariance critical presence small sample size; moreover inverting matrix also complex badly conditioned unstable operation also graph model used approach abstract ﬂexible enough tailored prior knowledge data possibly available. finally eﬀectiveness methodological contributions shown use-cases typical hyperspectral anomaly detection experiment novel application tumor detection biomedical images. paper organized follows ﬁrst give brief overview detector graph fourier transform section present technique section evaluate performance technique compare results yielded algorithms state-ofthe-art visually objectively section discuss results section ﬁnally conclusions drawn section anomaly detection refers particular class target detection problems namely ones prior information target available. scenario supervised approaches pixels match reference spectral characteristics cannot usually employed; unsupervised approaches preferable instead. algorithms detect anomalous peculiar pixels showing high spectral distance surrounding typical strategy extract knowledge background statistics data measure deviation examined pixel learned knowledge according aﬃnity function. best known widely employed algorithm anomaly detection reed-xiaoli detector reed date still used benchmark algorithm many anomaly detection applications assumes background characterized non-stationary multivariate gaussian model estimated image mean covariance. then measures squared mahalanobis distance pixel estimated background model. pixels showing distance values threshold assessed anomalous. formally works follows. consider image consisting pixels column vector represents value i-th pixel channels expected j-th element vector choose smallest commonly dimensionality reduction applications anomaly detection purposes value might given want risk lose anomaly. case usually appropriate. recent years growing interest graph-based signal processing stimulated study graph-based transform approaches. methodologies image content onto topological graph nodes represent pixel intensities edges model relations them e.g. according criterion based correlation similarity measures. fourier transform generalized graphs obtaining called graph fourier transform consider undirected weighted graph composed vertex order edge speciﬁed edge weight vertices thus weighted graph described adjacency matrix wab. graph signal mapping assigns value vertex denoted typically computing graph constructed capture inter-pixel correlation used compute optimal decorrelating transform leveraging spectral graph theory adjacency matrix combinatorial graph laplacian matrix computed degree matrix diagonal matrix whose a-th diagonal element equal weights edges incident node formally sometimes useful normalize weights laplacian matrix; cases symmetric normalized laplacian matrix lsym preferred. deﬁned lsym lsym important properties i.e. eigenvalues always real non-negative bounded range reasons spectrum symmetric normalized laplacian relates well graph invariants general graphs deﬁnitions fail formulation notice detects targets small energies represented small eigenvalues. because according smaller eigenvalue greater contribution value reasonable since anomalous small target present image visible principal components rather going appear smaller components however seeing form quite evident last components containing mostly noise actually weighted most. improve result value determined then eigenvalues beyond ﬁrst considered represent components containing noise discarded. obtain de-noised version expressed issue determining addressed closely related problem determining intrinsic dimensionality image signal. empirically usually desired percentage original image cumulative energy content retained. cumulative energy content ﬁrst principal components image expressed terms transform refer eigenvector eigenvalue matrices used eigen decomposition although formulation might look similar given important diﬀerences noted. first arbitrary laplacian model; generalization image follows gmrf model laplacian constructed estimate precision matrix case laplacian model computed according knowledge domain. second laplacian matrix used capture spatial spectral characteristics detail section multiplied whereas instead divided corresponding eigenvalue already discussed also denoised version ﬁrst smaller eigenvectors kept removing higher noisier frequencies obtaining already mentioned graph model used characterize typical behavior around pixel tested anomaly. analogously standard graph employed model spectral relations case vertex consists nodes representing spectral bands; then connect pair nodes edge obtaining fully-connected graph. zhang florêncio showed laplacian model used estimation precision matrix image assumption image follows gaussian markov random ﬁeld model. amounts using function partial correlation nodes graph weights. work exploit analogy framework anomaly detection. deﬁnition role covariance matrix taken graph laplacian. turns exploited also inverse problem anomaly detection according propose novel algorithm image anomaly detection refer laplacian anomaly detector overcomes known limitations exposed section used avoid problematic covariance matrix estimate inversion able include spatial information well priori knowledge available. given image composed pixels spectral bands channels ﬁrst build undirected graph serve model background pixels image. graph used model local relations pixels values constructed capture spectral spatial characteristics. topology weights graph chosen accordingly domain. discuss general construction strategies section section chosen graph described weight matrix laplacian matrix computed according procedure detailed section symmetric normalized laplacian constructed place unnormalized combinatorial preferred reasons expressed section also lsym proved preferable similar domains e.g. segmentation classiﬁcation advantages using graph-based approach ﬂexibility model. example augmenting graph topology include edges connecting node nodes describing band neighboring pixels shown figure able include spatial information model. refer spatially-aware version lad-s. example topology -bands image given figure weight assigned edge priori knowledge inter-band correlation available used weights accordingly; case possibility image data estimate weights. also pixel graph signal contain exactly value pixel bands removing mean; thus note include self loops. however approach still relies estimate inversion covariance matrix that already discussed might unreliable well expansive compute matrix inversion requires time another possibility cauchy function commonly used graph weight applications propose weight edge connecting bands according band mean vector estimated scaling parameter. study decided normalize values according mean range bands. advantages approach two-fold avoids using unreliable correlation estimates require matrix inversion thus reducing computational cost signiﬁcantly. considering case -connected nodes resulting graph composed nodes; therefore weight matrix well corresponding laplacian matrix matrix. construct weight matrix then compute distance pixel model graph signal constructed concatenating vector corresponding -connected neighbors; also case mean value i.e. subtracted. follows vector length objectively evaluate lad’s performance selected couple scenarios proposed. ﬁrst hyperspectral remote sensing images common case anomaly detection widely validated second domain volumetric segmentation tumoral masses positron emission tomography images successfully explored past scenarios compare performance proposed technique produced hyperspectral domain wscf wscf applies whitening transformation input based image covariance matrix incorporates spatial information anomaly measure. latter algorithm particular interest evaluation compare performance spatially-aware methodology. cropped area scene mostly contains ﬁelds various kinds human-made construction good anomalous candidate. setup call real shown figure together ground truth figure obtain synthetic anomaly used target implant method binary mask image shown figure constructed generating squares sides measuring pixels arranged line. squares copied reverse order arranged another line close distance. lines ﬁnally rotated angle approximatively pixels inside squares value rest pixels value cropped region hyperspectral images wide adoption remote sensing applications hyperspectral sensors typically deployed either aircraft satellites. data produced sensors three-dimensional array cube data width length array corresponding spatial dimensions spectrum point third dimension. scene used study collected -bands aviris sensor salinas valley california characterized high spatial resolution area covered comprises lines samples. common practice discarded water absorption bands i.e. bands image available at-sensor radiance data. includes vegetables bare soils vineyard ﬁelds. classiﬁcation ground truth containing classes provided scene. sample band image together classiﬁcation ground truth shown figure evaluate scenario tested real synthetic anomalies. scene containing real anomaly cropped portion scene manually segmented construction visible fig. spectral characteristic curves pixels diﬀerent regions image. line represents mean intensity computed pixels region shaded area represents standard deviation. respectively. representative values chosen since achieves best performance former worst latter. refer impl- impl- respectively. sample band impl- setup shown figure figure shows mean standard deviation intensity band background anomaly region impl- impl-. noticed spectral characteristics anomaly impl- similar shape background although reduced intensities. anomaly impl- presents diﬀerent curve others instead. interested evaluating detection accuracy using laplacian model built partial correlation weights built using cauchy distance also want test spectral version spatially-aware variant lad-s. results compared yielded classic wscf. compare results yielded since well known status benchmark algorithm anomaly detection. want also conﬁrm experiments known limitations enunciated section namely inclusion spatial information detrimental performance demonstrate approach overcomes limitation. another well known algorithm aims addressing limitation wscf reason selected evaluation well. wscf requires parameter determine amount spatial information included metric. study suggested original work figure figure show visual results approach compared ones yielded wscf real impl- setups respectively. clearly noticed lower number false positives able achieve wscf images shown scene dimension mask built modiﬁed image containing implanted target function that given parameter returns random pixel region salinas scene class according classiﬁcation ground truth shown figure following discussion conciseness limit analysis synthetic setups figure figure prove technique able enhance contrast anomalies background distance matrix less subject noise compared yielded algorithms i.e. figure figure figure figure figure shows curves three hyperspectral test cases. scale axis enhanced common anomaly detection studies given great diﬀerence scale number negative pixels positive ones. noticed scenarios approach outperforms wscf. also worth noticing inclusion spatial information yields limited improvements hyperspectral scenarios. comparing results obtained using noticed performance often similar. remarkable result also considering creates model background without need matrix inversions proves quicker equally precise. binary masks output automatic algorithm); intersection operator used indicate number pixels/voxels value masks operator indicates total number pixels/voxels value masks. also equivalent statistical f-score harmonic mean precision sensitivity usually deﬁned term type type errors true positive false positive false negative equality easily demonstrated considering contains true positive pixels/voxels consider also denominator equals clearly compute metric needs select threshold identify anomaly subset many approaches proposed literature deal problem choosing optimal threshold. work select value yielding highest i.e. striking best balance curve terms soi. choice allows compute single objective metric compare analyzed methods. alternative could also area curve measures area curve; decided avoid metric since recently criticized finally table show results de-noised version call ladp rxdp respectively. case value chosen according cumulative energy described section setting noticed able gain dimensionality reduction. results explained considering distribution energy eigenspace decomposition. impl- scenario figure show cumulative energy distribution diﬀerent eigenspaces together corresponding eigenvalues respectively). noticed case energy better compacted eigenspaces respect time observed distribution dramatically ampliﬁes last eigenspaces i.e. noise components according contrary phenomenon aﬀect since distribution eigenvalues peaked last eigenspaces. follows eﬀect noise mitigated construction beneﬁt dimensionality reduction limited. indeed noted results obtained dimensionality reduction line obtained simple form. eigen-decomposition costly operation matrix inversion require matrix inversion eigen-decomposition might preferable. data volumetric medical images usually employed locate tumoral area proper oncological treatment e.g. means radio therapy. scan images produced intensity voxel represents local concentration tracer time window scan. particular ﬂuorodeoxyglucose positron emission tomography used detect tissue metabolic activity virtue glucose uptake. normal cell replication mutations occur lead birth cancer cells. nature cells lack ability stop multiplication raising cell density region causing insuﬃcient blood supply. resulting deﬁciency oxygen forces cells rely mostly anaerobic metabolism i.e. glycolysis reason glycolysis excellent marker detecting cancer cells; fdg-pet tracer’s concentration indicates glucose uptake imaged area—turns suitable tool recognizing tumors metastasis lymph nodes follows proper segmentation tumors medical images crucial oncological treatment plans rely precise information tumoral region eﬀective manual segmentation medical staﬀ proven subjective inaccurate time consuming reason need automatic methods tumor region segmentation rise. images carry information cells metabolism therefore suitable task; however segmentation still open problem mainly limited image resolution strong presence acquisition noise successfully explored identify anomalous behavior cancer cells time sequences three fdg-pet images acquired time span hour. quick visual overview setup shown figure idea behind scenario arises fact cancer cells tend acquire glucose diﬀerently normal cells given peculiar reliance anaerobic metabolism. reason considering values voxel assumes time cancer’s anomalous glucose uptake successfully spotted using anomaly detection techniques usual role spectral bands taken images acquired time. this build matrix three spatial dimensions ﬁrst three dimensions time fourth dimension. acquired diﬀerent times subject assuming slightly diﬀerent positions worth recalling images need aligned using registration algorithms detailed resulting matrix size then generic voxel identiﬁed spatial coordinates deﬁne vector vector containing voxel’s intensities time. words employed case time takes role spectral dimension. fig. three fdg-pet images sample patients; early scan contructed integrating delayed scan minutes time windows area containing tumor acquired delayed scan. images originally grayscale displayed using fire lookup table. research purposes. acquisitions made using philips gemini pet/ct. acknowledge precious nuclear medicine physicians manually segmented rois images setting ground truth evaluating performance yielded proposed tools. refer setup tumor. also scenario interested evaluating detection accuracy using laplacian models compare results yielded classic rxd. cannot compare wscf domain extension proposed therefore compare performance yielded diﬀerent approaches presented again study selected value yielding highest soi. figure shows curves four sample patients tumor dataset table shows average results tests patient dataset. inclusion spatial information graph slightly improves metric. beneﬁt including spatial information noticeable scenario case spectral dimension reduced bands representing diﬀerent acquisitions time scenario present results dimensionality reduction spectral dimensions already few. previous section conducted experiments hyperspectral medical domain. rxd’s limitations detailed section noticed many presented experiments. particular high number false negative easily noticed figure figure poor performance wscf impl scenario imputed fact anomaly case similar covariance matrix background shown figure makes diﬃcult covariance-based methods acceptable solution case. moreover improved performance obtained wscf conﬁrms including spatial information indeed increase detection quality. proposed technique able outperform state-of-the-art techniques scenarios proving ﬂexibility graph model actually enable better robust background estimation well successful inclusion spatial information. comparing results obtained using noticed performance often similar hyperspectral images tumor able obtain consistently better results. behavior clearly fact depends pairwise correlation estimates particularly critical tumor case tests conﬁrm approach preferable wscf laplacian estimated using cauchy distance able perform well estimated using partial correlation. again remarkable former require matrix inversion latter does. present laplacian anomaly detector graph-based algorithm aiming detecting targets virtue laplacian model image background. diﬀerent approaches graph construction proposed. comparing wscf main advantages technique ability model image content without need matrix inversions. visual inspection objective results show proposed approach able outperform wscf. future direction might devoted evaluate ability detect anomalies generic non-image graphs.", "year": "2018"}