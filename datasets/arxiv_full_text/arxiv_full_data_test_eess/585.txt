{"title": "An explicit staggered-grid method for numerical simulation of  large-scale natural gas pipeline networks", "tag": "eess", "abstract": " We present an explicit second order staggered finite difference (FD) discretization scheme for forward simulation of natural gas transport in pipeline networks. By construction, this discretization approach guarantees that the conservation of mass condition is satisfied exactly. The mathematical model is formulated in terms of density, pressure, and mass flux variables, and as a result permits the use of a general equation of state to define the relation between the gas density and pressure for a given temperature. In a single pipe, the model represents the dynamics of the density by propagation of a non-linear wave according to a variable wave speed. We derive compatibility conditions for linking domain boundary values to enable efficient, explicit simulation of gas flows propagating through a network with pressure changes created by gas compressors. We compare Kiuchi's implicit method and an explicit operator splitting method with our staggered grid method, and perform numerical experiments to validate the convergence order of the new method. In addition, we perform several computations to investigate the influence of non-ideal equation of state models and temperature effects into pipeline simulations with boundary conditions over various time and space scales. ", "text": "present explicit second order staggered ﬁnite diﬀerence discretization scheme forward simulation natural transport pipeline networks. construction discretization approach guarantees conservation mass condition satisﬁed exactly. mathematical model formulated terms density pressure mass variables result permits general equation state deﬁne relation density pressure given temperature. single pipe model represents dynamics density propagation non-linear wave according variable wave speed. derive compatibility conditions linking domain boundary values enable eﬃcient explicit simulation ﬂows propagating network pressure changes created compressors. compare kiuchi’s implicit method explicit operator splitting method staggered grid method perform numerical experiments validate convergence order method. addition perform several computations investigate inﬂuence non-ideal equation state models temperature eﬀects pipeline simulations boundary conditions various time space scales. recent years witnessed renewal interest eﬃcient methods accurate simulation transient ﬂows pipeline systems physical models mathematical descriptions ﬂuid pipelines various regimes well-understood variety available numerical methods developed decades general euler equations dimension used describe compressible ﬂuid pipe using hydrodynamic partial diﬀerential equations equation state relates density pressure. darcy-wiesbach formula used approximate nonlinear energy dissipation caused three-dimensional turbulent within pipe diﬀusive eﬀects turbulence ignored. range models numerical methods available solution initial boundary value problem pipeline system depending time space scales interest. variety high-ﬁdelity explicit methods used accurately approximate eﬀects rapid variations pressure time-scales corresponding speed wave propagation methods solve full isothermal euler equations account nonlinear self-advection formation propagation shock waves captured. typically second order accurate regions pressure continuous. methods designed accurate solution short time scales impractical simulation large pipelines typical operating regime signiﬁcant boundary changes occur time scales hours longer. studies evaluated non-isothermal models hand several lowerﬁdelity implicit methods better suited characterizing dynamics large pipelines operating regime pressure mass change time scales much longer rate wave advection terms euler equations omitted regime interest characterized previous empirical studies result nonlinear ﬁrst order hyperbolic system. implicit methods eﬃcient scalable adaptable larger systems complex network structure nodal components compressors regulators. however even slight changes fast time-scales present obstacles stability methods major recent work bridge high-ﬁdelity explicit methods computationally costly stable fast transients lower accuracy schemes simpliﬁed physics applied large-scale pipeline networks recently proposed method applies well-known operator-splitting scheme solve simpliﬁed equations describe one-dimensional dynamics networks long pipes method accurately represents rapid small amplitude changes resolving slowly-varying dynamics time scale normal pipeline operations extensible complex pipeline networks nodally-located time-varying compressors boost adjoining pipes. although unconditionally stable second order accurate operator-splitting discretization based propagation characteristics uniformly-spaced grid requires assumption uniform constant wave propagation speed thus ideal model. high pressure transmission pipeline ﬂows exhibit highly non-ideal states explicit method simulation pipeline ﬂows using non-ideal models signiﬁcant interest. paper develop computationally eﬃcient explicit numerical method capable simulating pipeline dynamics non-ideal equation state models. formulate model transport large-scale pipeline network. single pipe solution ibvp model could viewed representing propagation non-linear wave density gas. non-linearity present wave speed non-linear dissipation term. present second-order accurate staggered grid discretization ﬁnite diﬀerences space time model network focus particular connection staggered grid approach implicit method kiuchi uses standard discretization staggered quantities approximated using trapezoidal rule averages. implicit method kiuchi unconditionally stable even using arbitrarily large time discretization step relative spatial discretization although accuracy reduced case. kiuchi’s implicit method requires solution system non-linear equations time step arise dissipation term generally complicated form compressibility factor non-ideal case. although proposed explicit staggered ﬁnite diﬀerence discretization restricted courant-levy stability condition employs simple time stepping require solution large-scale implicit system. moreover data dependence time step highly localized facilitates parallelization computation ibvp solutions large-scale pipeline networks. section present one-dimensional mathematical formulation transport long pipe various possibilities modeling dependence density pressure temperature using compressibility factor function. present derivation compressibility factor formulas appendix section derive explicit staggered grid discretization non-ideal single pipe validate second order accuracy derive stability criterion grid steps. section develop standardized compatibility rules boundary conditions junctions individual pipes linked scheme applied complex pipeline networks compressors. section present numerical experiments single pipe verify method better second order accurate well evaluate signiﬁcance non-uniform temperature non-ideal modeling simulation ﬂows various time space scales. section examine number numerical experiments network pipes using proposed method well operator splitting method lumped-element implicit method. finally section conclude discussion open questions future work. euler equations dimension describe compressible ﬂuid long pipe using hydrodynamic pdes equation state relates density pressure darcy-wiesbach formula used approximate nonlinear energy dissipation caused three-dimensional turbulent within pipe. eﬀects turbulent diﬀusion ignored approximation equations considered phenomenological average three-dimensional navier-stokes hydrodynamic equations captures eﬀects spatial scales much longer pipe diameter time scales longer required dissipation acoustic waves. rapid dissipation turbulent eﬀects regime interest precludes formation shockwaves strongly nonlinear acoustic events develop dispel much shorter time scales result signiﬁcant abrupt changes time parameters friction factor pipe diameter gravitational acceleration pipe angle terms right hand side aggregate friction gravity eﬀects. assume pressure density satisfy equation state relation ideal constant temperature respectively. compressibility factor deﬁnes deviation equation state ideal law. assume equation uniquely solved pressure function density. equation valid regime changes consumption injections suﬃciently slow excite propagation sound waves. formally term left hand side much smaller ratio pressure gradient term term typically order addition velocities much smaller nominal speed sound nominal compressibility factor. regime advection term omitted even comparison already small term simplicity assume pipeline level thus ignoring gravity term right hand side usually assume temperature uniform along pipeline constant. exception section consider eﬀects heat generation compressor station. dynamics long pipe segment large transmission pipeline commonly represented using subject initial boundary conditions simple boundary conditions include complicated boundary conditions arise consider junctions several pipes well devices compressors regulators used actuate ﬂow. nominal coeﬃcients gravity pressure units psig units consider nominal gravity methane ethane. compressibility factor relation formula used equation state create bijection density pressure. describe numerical scheme ﬁnite diﬀerence discretization dynamic equations single pipe. proposed scheme motivated fact pdes reduce linear wave equation ideal assumptions constitutive order accurate staggered discretization wave equation written mixed form. discretization could considered prototype classical scheme time domain computational electrodynamics consider staggered discretization shown figure space grid points indexed indices time layers indexed additional indices variables discretized staggered grid blue points variable discretized staggered grid green points equation discretized point discretization second order accurate space time validated verifying terms discrete equations constitutes second order accurate approximation corresponding terms pdes provide validation showing nonlinear term approximated least second order accuracy. speciﬁcally show although discretization friction term causes equation appear implicit actually spatial coupling terms seen therefore expect conditional stability. furthermore nonlinearity precludes performance von-neumann type analysis. instead analyze happens perturbation numerical solution time step derive error assumed domain interest. done mostly simplify notations also physical assumptions model reductions valid order obtain pdes regard note satisfy equation instead section describe standardized approach construction pipeline network models compressors purpose simulating transient ﬂows large spatial scales. reduction extends previous modeling work represent pipeline network metric graph system pdes edge subject timedependent boundary conditions nodal compressor actions manner similar done quantum graphs graph deﬁned nodes directed edges elements represent pipes nodes every edge associated diameter length cross-section area friction coeﬃcient constitute metric pipe characterized hydrodynamic equations solution denoted deﬁned expressed area units withdrawal mass units cross-section areas required weight mass balance equation. mass pipe sklφkl total mass node pipe sgnkl similarly mass start pipe slkφlk total mass node pipe sgnkl network controlled compressors boost pressure preserving mass ﬂow. model compressors located interfaces nodes adjoining pipes able boost going node adjoining pipe fig. generalized compression ratios relate nodal pressures boundary pressure inlet outlet pipe respectively. method presented here assume removed system compression processes. complete boundary conditions provided pipeline network specifying withdrawal pressure node. removed network speciﬁed pressure node dependent variable pressure node given network node free variable. pressure least so-called slack node must speciﬁed. endpoint boundary information together initial conditions deﬁnes well-posed ibvp pipeline network. equations together constitute nodal compatibility laws provide consistent boundary conditions pipes network. next describe staggered grid discretization scheme applied link pipes together compatibility conditions. natural boundary conditions values implemented single pipe simply assigning value ends. alternatively boundary conditions pressure density reformulated time step computing appropriate value mass step would result values pressure density respectively. thus pipe time step consists following sub-steps case boundary conditions specify values mass endpoint pipe step straightforward. however boundary conditions specify value density pipe endpoint appropriate value found conservation mass equation example i.e. gives right boundary value mass pipe time density known time speciﬁed boundary conditions. case boundary conditions specify value pressure condition reformulated terms value density using proceed above. ﬁrst reformulate condition density condition mass ﬂux. note order satisfy mass conservation properties must balance mass joint. expressed terms area mass variables note solution unique function one-to-one. particular case monotone function. example case equation quadratic equation unique positive solution. boost ratios represent actions compressors propelling pipe endpoints. here represent pressures endpoints pipe represent pressures nodes side compressors located endpoints. general setting least unity given time compressors would used simultaneously. remark paper consider case time discretization step pipes spatial discretization step vary. also note pipe satisfy appropriate condition relating section perform number numerical experiments designed compare contrast various models. comparisons perform based choice constitutive models considered order verify order convergence method considered single initial value problem pipe solved numerically diﬀerent resolutions ﬁxed time space resolution convergence rates computed based last data points well ﬁrst last data points shown table below. indicate three variables converge least second order. consider long pipe diameter friction coeﬃcient temperature initial conditions uniform throughout pipe zero constant pressure .mpa corresponding density .kg/m. boundary conditions initial value problem descretized using non-ideal model ideal model latter speed sound taken match initial conditions pressure density. corresponds constant value solutions ibvp left right boundaries shown figure could seen figure ideal model results signiﬁcantly smaller values maximum velocity right boundary compared non-ideal model smaller values velocity signiﬁcantly larger values density around min. consider long pipe diameter friction coeﬃcient temperature initial conditions taken uniform throughout pipe constant pressure .mpa density .kg/m. boundary conditions follows. initial value problem solved using non-ideal model well ideal model latter speed sound taken order match initial conditions pressure density. solutions shown periods figure tscale hrs. consider steady models temperature distribution modeling heating compressor. models assume exponential temperature decay steady value diﬀerent rates figure illustration pressure density velocity left right boundaries respectively time using ideal model non-ideal model evolution pressure/density prescribed boundary conditions. took tambient tjump ﬁrst model assumed temperature spike decays ambient level scale kilometer second model decay assumed happen scale kilometers. results simulation shown figure initial conditions pipe steady-state. given explicitly speciﬁed conditions nodes. initial nodal conditions given pressure pressure node withdrawal node simulate dynamics network using three discretizations staggered discretization implicit lumped elements discretizations conservation mass illustrated descrepancy pressure nodes shown figure illustration discrepancy mass pipe mass left system nodes split-step lumped element staggered discretization plot staggered discretization shows data point minute. split-step discretization assumes constant compressibility factor works pressure-ﬂux formulation. splits step linear non-linear step. linear step integrated using characteristics. compared split-step discretization explicit staggered discretization eﬃciency rather general forms compressibility factor require constant. figure illustration inﬂow node pressure node using ideal model split-step method points lumped element method points staggered discretization points presented computationally eﬃcient second-order accurate explicit numerical method simulating pipeline dynamics non-ideal equation state models. method applied model transport transmission pipeline network. staggered grid discretization ﬁnite diﬀerences space time applied model simulate initial boundary value problems make comparisons numerical schemes including kiuchi explicit operator splitting implicit lumped elements demonstrated unconditional stability proved second order accuracy approach. although proposed explicit staggered ﬁnite diﬀerence discretization restricted courant-levy stability condition employs simple time stepping require solution large-scale implicit system. moreover data dependence time step highly localized facilitates parallelization computation solutions large-scale pipeline networks. numerical experiments single pipe verify method better second order accurate also showed signiﬁcant eﬀects arising incorporating non-uniform temperature non-ideal modeling simulation ﬂows various time space scales. comparison numerical scheme explicit operator splitting method implicit lumped-element method test network pipes shows close results. presented staggered-grid method accurately resolves fast transient dynamics networks arbitrary structure extended future comprehensive physical models thermal eﬀects composition. authors wish thank michael chertkov alexander korotkevich richard carter productive discussions suggestions. study conducted part project geco advanced research project agency-energy u.s. department energy award de-ar. work carried alamos national laboratory auspices national nuclear security administration u.s. department energy contract deac-na. present approximations compressibility factor ﬁrst approximation presented section assumes constant temperature throughout pipe. another approximation presented section assume variable temperature throughpipe. positive root quadratic equation temperature mixture methane ethane constant approximately yielding nominal value corresponds nominal wave speed m/s.", "year": "2018"}