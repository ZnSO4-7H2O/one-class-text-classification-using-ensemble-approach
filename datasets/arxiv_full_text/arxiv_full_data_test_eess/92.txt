{"title": "Pulse rate estimation using imaging photoplethysmography: generic  framework and comparison of methods on a publicly available dataset", "tag": "eess", "abstract": " Objective: to establish an algorithmic framework and a benchmark dataset for comparing methods of pulse rate estimation using imaging photoplethysmography (iPPG). Approach: first we reveal essential steps of pulse rate estimation from facial video and review methods applied at each of the steps. Then we investigate performance of these methods for DEAP dataset www.eecs.qmul.ac.uk/mmv/datasets/deap/ containing facial videos and reference contact photoplethysmograms. Main results: best assessment precision is achieved when pulse rate is estimated using continuous wavelet transform from iPPG extracted by the POS method (overall mean absolute error below 2 heart beats per minute). Significance: we provide a generic framework for theoretical comparison of methods for pulse rate estimation from iPPG and report results for the most popular methods on a publicly available dataset that can be used as a benchmark. ", "text": "georg-elias-müller-institute psychology university goettingen goettingen germany theoretical neurophysics group planck institute dynamics self-organization objective establish algorithmic framework benchmark dataset comparing methods pulse rate estimation using imaging photoplethysmography approach ﬁrst reveal essential steps pulse rate estimation facial video review methods applied steps. investigate performance methods deap dataset www.eecs.qmul. ac.uk/mmv/datasets/deap/ containing facial videos reference contact photoplethysmograms. main results best assessment precision achieved pulse rate estimated using continuous wavelet transform ippg extracted method signiﬁcance provide generic framework theoretical comparison methods pulse rate estimation ippg report results popular methods publicly available dataset used benchmark. keywords imaging photoplethysmography pulse rate signal processing heart rate benchmark heart rate important indicator functional status psycho-emotional state health conditions general. traditionally estimated electrocardiogram photoplethysmogram however techniques require contact sensors disadvantageous whereas non-contact estimation useful example detecting driver drowsiness abnormal state non-contact assessment pulse rate imaging photoplethysmogramm analysis proposed similarly contact ippg acquired measuring variations intensity light reﬂected skin tamura details) video camera used instead simple photodetector. ippg computed sequence images usually acquired face palm. theoretical underpinnings imaging photoplethysmography provided hülsbusch kamshilin wang rapid development ippg analysis emphasizes importance comparing various algorithms ippg-based pulse rate estimation. theoretical comparison complicated since algorithms ippg acquisition consist multiple steps often non-uniformly described. empirical comparison publicly available benchmark dataset required since pulse rate estimates reported diﬀerent studies comparable overcome problems comparing algorithms suggest generic algorithmic framework describing main steps ippg-based pulse rate estimation; discuss popular methods employed various steps compare performance publicly available dataset containing facial video reference contact ppg. report experimental results demonstrating choice methods step inﬂuences overall quality pulse rate estimation. framework consists steps. methods used single steps pulse rate estimation previously compared combine methods used steps optimal conﬁgurations. dataset emotion analysis using physiological video signals contains physiological recordings frontal face videos human volunteers watching music videos one-minute trials. denote trials number participant deap number trial. altogether deap dataset consists one-minute trials facial video reference contact data reject trials large part face occluded since videos stable ippg acquisition impossible. section propose generic algorithmic framework ippg-based pulse rate estimation. takes input sequence frames; t-th frame consists pixels given uncompressed video normally used ippg acquisition large publishing on-line. attempt compare existing algorithms publicly available mahnob dataset made however dataset seems unsuitable ippg benchmarking videos underwent strong compression making consistent ippg extraction impossible when applying method contact deap realize detect diastolic minima since amplitudes vary signiﬁcantly. alleviate problem introduce modiﬁcations. first detect minima varying amplitudes determine oﬀset level mean whole signal running mean window second reject false positives arise ﬁrst modiﬁcation post-processing step method detects diastolic minima reject holds figure scheme considered methods. blocks represent steps pulse rate estimation inside block represents sub-step contains list methods used sub-step. various combinations methods time taking method every sub-step. compute color signals color intensities averaged roi. ppg-induced variations facial color weak comparison noise artifacts selection choose pixels containing maximal pulsatile information averaging reduces noise preserving ippg signal. selection consists sub-steps initial choice facial region ippg acquisition excluding irrelevant pixels deap dataset participants covers forehead hinders using forehead region; therefore consider whole-face region facial region eyes. cases detect facial rectangle frame commonly-used cascade classiﬁer constructed means viola-jones algorithm take width equal estimated face width recommended reﬁnement. even selected properly pixels contain ippg signal. examples include non-skin pixels under-lit areas damaged pixels sensor. exclude pixels roi-reﬁnement methods used consider them. first non-skin pixels discarded. essential part reﬁnement deap since many videos cables hang front participants’ faces. simple masking pixels saturation value outside ranges respectively considered non-skin discarded step reﬁned color signals computed signals suppressing noise artefacts. preserve relevant information frequency components human heart rate bandwidth corresponds suppressed. typical pre-processing sub-steps detrending band-pass moving average ﬁltering often used combination sub-steps omitted applied post-processing detrending important since pulsatile component ippg much lower amplitude slowly-varying baseline simple detrending method consists mean-centering color model generally considered useful skin detection another popular choice ycbcr model also elaborate approach skin selection ippg acquisition. another popular detrending method smoothness priors approach used remove trend without aﬀecting heart rate bandwidth employ control parameter suppresses frequencies details. choosing take account -point ﬁlter suppresses frequencies sampling rate signal details. since human pulse rate reach recommend using fsr. instance requires thus consider ﬁltering -point average. band-pass ﬁltering suppresses frequency components outside heart rate bandwidth. employ commonly used ﬁlters either order ﬁnite impulse response ﬁlter linear phase designed using hamming window order butterworth inﬁnite impulse response ﬁlter decomposing color signals components means blind source separation indechoosing component prominent peak heart rate bandwidth. pendent component analysis popular technique ippg computation jade algorithm cardoso suggested order make chrom compliant generic framework introduce minor algorithmic changes aﬀecting nature methods. namely running means standard deviations instead computing ippg signal overlapped windows. considered dataset performance modiﬁed versions slightly better original methods. note special pre-processing required ippg extraction methods namely mcas detrending chrom band-pass ﬁltering agrd. testing eﬀect pre-processing always required pre-processing ippg extraction methods. post-processing improves quality ippg signal especially necessary noise artifacts removed pre-processing ippg extracted step non-linear fashion consider three typical sub-steps post-processing band-pass adaptive band-pass ﬁltering. band-pass ﬁltering described subsection pre-processing sub-steps also used post-processing results diﬀerent ippg signal considered methods ippg extraction except linear methods. ﬁltering assumes frequency components ippg signal pertaining pulse rate relatively high power; weak components correspond noise suppressed criticism approach) post-processing methods part describe separately limited applicability non-ica-based ippg extraction. proach rarely used ippg since precise estimation often problematic corresponds cardiac cycle; thus momentary pulse rate equal inverse duration. usually deﬁned ippg time successive systolic peaks using method peak detection; employ method elgendi modiﬁcations described subsection figure illustration. accurate estimation increase sampling rate ippg signal using cubic spline interpolation suggested another approach assess average pulse rate frequency corresponding maximal power spectral density computing points estimates average pulse rate value time interval n/fsr sampling rate ippg signal usually estimated discrete fourier transform autoregressive modeling. direct estimate often criticized since frequency resolution leads crude estimation pulse rate taking hinders tracking pulse rate variations. results averaging pulse rate modeling considers ippg output linear system added white noise parameters system estimated compute psd. comparison modeling yields improved resolution short samples. implement modeling using burg’s method employ models either first perform continuous wavelet transform ippg ﬁlter wavelet coeﬃcients wide gaussian window centered scale corresponding maximum squared wavelet coeﬃcients averaged temporal running window. apply usual gaussian ﬁlter. ﬁltered signal reconstructed performing inverse continuous wavelet transform. bousefsaf details. figure contact ippg signal circles indicate diastolic minima systolic peaks ippg detected using algorithm elgendi modiﬁcations described subsection note contact signal interbeat intervals estimated diastolic minima since clear prominent peaks. continuous wavelet transform provides promising alternative modeling implement using matlab function cwtft; take morlet wavelet scales corresponding factor note methods pulse rate estimation recently compared ippg extracted using method study modeling considered used either long windows resulting time resolution short windows providing frequency resolution. investigate quality pulse rate estimation split trial epochs overlap epochs trial. epoch compare estimated average pulse rate averaged reference value prref following quantities used assess estimation performance epochs participant. choose scales suﬃciently good coverage human heart rate bandwidth twice lower minimal pulse rate half ippg signal sampling rate. factor provides scales octave. rmse sensitive large estimation errors small number large errors results high rmse mae. pulse rate estimates uncompressed video stationary subjects usually rmse range epochs table present quality metrics pulse rate estimates ippg extraction methods best prepost-processing cases best results obtained whole face skin selection outliers rejection lowest estimation errors achieved using ippg extraction pulse rate estimation. altogether values quality metrics comparable reported literature pulse rate estimation uncompressed video discuss inﬂuence various steps pulse rate estimation quality. begin methods ippg extraction since results diﬀerent methods vary considerably proceed selection prepost-processings ﬁnish pulse rate estimation subsections respectively. rmse observed obtained video recorded dedicated professional illumination makes results incomparable deap. hand rmse reported mahnob dataset high indicates limited usefulness dataset ippg-based pulse rate estimation. best method estimates pulse rate error epochs. interested percentage epochs pulse rate estimated well; precision seems insuﬃcient this bound error table quality metrics pulse rate estimates computed ippg best prepost-processing values cell stand rmse best values metrics ippg extraction method shown bold. table prepost-processing providing precise pulse rate estimates stand corresponding band-pass ﬁltering moving average ﬁltering length wavelet ﬁltering. table present performance metrics considered ippg extraction methods. prepost-processing ensuing best estimate pulse rate since method provides best results step table average quality metrics pulse rate estimates ippg extracted using prepost-processing settings providing best snr. cell present values without wavelet ﬁltering. comparison include overall values best values quality metrics shown bold. table highest signal-to-noise ratio provides precise pulse rate estimation. ranking methods generally line results reported except performing worse ica. explain diﬀerence sensitivity number source components signal; light variation motion introduce additional components color signals complicate extraction pure ippg means ica. figure shows average values every participant three best ippg extraction methods cases high corresponds indicates good quality ippg ensures precise pulse rate estimation. choice. results whole face region better region eyes terms ippg quality pulse rate estimation. namely signal acquired whole face region least higher pulse rate estimation lower detrending. among detrending methods mcas always improves pulse rate estimation provide positive eﬀect agrd methods ippg extraction using mcas increases improves pulse rate estimation chrom methods using mcas pre-processing immanent therefore performance without mcas tested. bandwidth tested). exception pulse rate estimation ippg obtained chrom methods case best results observed figure illustrates eﬀect eﬀect quality metrics similar. band-pass ﬁltering improves quality ippg signal cases performance pulse rate estimation table surprisingly band-pass ﬁltering little positive even negative eﬀect pulse rate estimation modeling; cannot explain result. order ﬁlter performs slightly better order butterworth ﬁlter; expected since frequency response latter slightly worse. wavelet ﬁltering results elimination large errors pulse rate estimation reﬂected prominent decrease rmse however wavelet ﬁltering slightly improves almost change pe.. parameter choice wavelet ﬁlter deserves separate study preserving several harmonics pulse rate interest keep shape ippg signal. prevs postprocessing. band-pass ﬁltering preferable pre-processing agrd used step post-processing methods ippg extraction table chrom using ﬁltering diﬀerent step considerably decreases quality ippg pulse rate estimation. quite unexpected since originally chrom proposed band-pass ﬁltering pre-processing post-processing recommended agrd band-pass ﬁlter essentially pre-processing sub-step observe diﬀerence using ﬁlter prepost-processing. tested methods pulse rate estimation certain drawbacks. provides second best result terms frequency resolution highest rmse. estimation lowest overall performance explained insuﬃcient quality ippg extracted compressed deap videos. ﬁltering techniques improve precision estimation. finally modeling requires elaborate choice model order using orders diﬀerent selected subsection resulted considerably worse pulse rate estimation. figure performance pulse rate estimation methods ippg signal extracted using method data momentary pulse rate estimated spectrograms ippg signal estimated using modeling summarize main results work. established generic framework ippgbased pulse rate estimation. using framework compared various methods ippg analysis compressed video deap dataset; best pulse rate estimation obtained using following methods. ippg used human subjects. however ippg acquisition seem unfeasible non-human animals bare face instance primates using ippg pulse rate estimation beneﬁcial animal research using contact measurements often undesirable. author acknowledges funding ministry science education lower saxony volkswagen foundation program niedersächsisches vorab. additional support provided leibniz association funding leibniz sciencecampus primate cognition. author grateful dynamics self-organization support work manuscript. author thanks möller kagan prof. wolf useful discussions remarks manuscript.", "year": "2017"}