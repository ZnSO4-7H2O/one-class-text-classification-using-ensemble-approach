{"title": "Separation of Instrument Sounds using Non-negative Matrix Factorization  with Spectral Envelope Constraints", "tag": "eess", "abstract": " Spectral envelope is one of the most important features that characterize the timbre of an instrument sound. However, it is difficult to use spectral information in the framework of conventional spectrogram decomposition methods. We overcome this problem by suggesting a simple way to provide a constraint on the spectral envelope calculated by linear prediction. In the first part of this study, we use a pre-trained spectral envelope of known instruments as the constraint. Then we apply the same idea to a blind scenario in which the instruments are unknown. The experimental results reveal that the proposed method outperforms the conventional methods. ", "text": "abstract—spectral envelope important features characterize timbre instrument sound. however difﬁcult spectral information framework conventional spectrogram decomposition methods. overcome problem suggesting simple provide constraint spectral envelope calculated linear prediction. ﬁrst part study pre-trained spectral envelope known instruments constraint. apply idea blind scenario instruments unknown. experimental results reveal proposed method outperforms conventional methods. recover original signals interest given signal mixtures. attracted considerable attention research topic past decades applied many research ﬁelds applications source separation include music audio analysis instrument-wise equalizing stereo-to-surround up-mixing karaoke systems crosstalk cancellation biomedical signal analysis electroencephalographic electromyographic chemical signal analysis nevertheless mainstream recent source separation research focuses audio signal easily overlapping nature sound diverse applications. almost every situation hear variety sounds occur simultaneously humans able meaningful information sounds. cocktail party problem demonstrates interesting phenomenon concerning human’s capability listening. even noisy environment like cocktail party people able concentrate sound want attend voice person conversation. selective attention enables humans catch crucial auditory information insensitive magnitude sound. process happens human brain unconsciously machines capable imitating magnitude-robust operation. hence order make machines work correctly pre-processing amplify separate sounds interest necessary. leads necessity audio source separation source separation algorithms enormous impact audio signal processing machine learning research. method music source separation contributed improvement various music information retrieval algorithms enabling extraction musical information work high accuracy. algorithms include low-level music analyses pitch detection tempo estimation instrument identiﬁcation high-level analyses genre classiﬁcation music identiﬁcation copyright monitoring besides also assisted music generation algorithms automatic music composition well music enhancement algorithms up-mixing time-stretching instrument-wise equalization noise reduction addition spectral temporal characteristics music signals often considered stationary. hence algorithms analyze music signals extended applications investigate noisier signals signal. source separation research categorized according number channels input sound. mixture signal composed multiple channels estimation original sources achievable spatial ﬁltering. conventional studies spatial ﬁltering assume mixture signal linear combination convolutional mixing original sounds. case separation process identical obtaining inverse actual mixing matrix. number channels equal number original sources task categorized determined case since perfect reconstruction original sounds theoretically available. also applied overdetermined case number channels exceeds number sources. however number channels smaller number sources referred underdetermined case perfect reconstruction possible spatial ﬁltering; hence assistance spectrotemporal characteristics necessary. since music signals comprised single channel channels music source separation task often presumed underdetermined. accordingly intensive study single channel-based music source separation methods essential commonly utilized essential background multi-channel music source separation spectral envelopes corresponding excitations without pre-training process work fails precisely assess spectral envelopes since roughly approximates envelopes using band-pass ﬁlter banks. ozerov developed ﬂexible audio source separation toolbox spectra also split excitations ﬁlter parts paper present novel approach singlechannel instrument sound separation problem. ﬁrst part paper assume instruments known advance spectral envelopes obtained. instance audio segments instruments given extract spectral envelopes them. spectral bases approximate mixture spectrogram partitioned ahead iteration constrained resemble extracted envelopes. constraint imposition achieved generalized dirichlet prior used source separation tasks. second part paper extend informed approach case additional information available. blind approach spectral envelopes basis calculated envelopes belong group averaged. spectral envelope determined instrument whereas excitations differ bases belong group. iteration proceeds average spectral envelopes group converge true spectral envelopes instruments. methods based source-ﬁlter model linear predictive coding obtain envelopes spectra without converting time-domain signal. comparative evaluation reveals proposed method outperforms conventional methods. rest paper organized follows. section describes informed approach method. section extend informed approach blind approach. section shows experimental results real recordings. conclusions presented section section present detailed description proposed informed source separation method. section composed three subsections present excitation-ﬁlter model linear predictive coding proposed nmf-based spectrogram decomposition procedure. studies. early stage music source separation blind approach intensively investigated additional information target source exists. blind source separation studies often assume target sound certain statistical features non-gaussianity independence sparsity techniques useful cases; however statistical assumptions cannot guaranteed many practical situations eventually causes performance degradation. overcome performance informed source separation widely studied studies assume situations side-information target sources available. information includes spectro-temporal characteristics music score partial information onset direct information manually provided annotations user-guided audio signal especially recent approaches examined effect artiﬁcial neural network-based methods source separation tasks. research efforts directly applied deep learning-based techniques like autoencoder lee’s work osako al.’s work grais plumbley’s work others attempted enhance conventional approaches like matrix decomposition time-frequency mask however still issue reduce amount information needed successful separation target sound situation side-information provided highly limited. especially deep learning-based approaches signiﬁcant amount training data required sound source. hence focus reducing amount required information. instruments known show static spectrotemporal characteristics timbre. characteristics also used source separation. especially cases harmonic instruments drums coexist attributes appear time-frequency representation easily distinguishable. previous work focused spectral features harmonic percussive sounds also extended simultaneously consider time frequency domain aspects instruments separation harmonic instrument sounds challenging problem differences spectral temporal characteristics less obvious compared harmonic-percussive source separation. spiertz gnann presented basis clustering algorithm post-processing non-negative matrix factorization fitzgerald used shift-invariant non-negative tensor factorization ozerov fevotte focused mixing procedure studies harmonic instrument sound separation adopt source-ﬁlter model. heittola trained bases instruments used separation rodriguezserrano also made instrument-dependent models used separation klapuri al.’s work extended heittola al.’s method separately estimate approximated denotes magnitude spectrogram instrument denotes index bases explain denote k-th spectral basis time activation respectively. spectrogram conversion error assumed small negligible. convenience description assume ||wk|| estimated matrix decomposition algorithms probabilistic latent semantic analysis probabilistic latent component analysis also assume instrument sounds represented using source-ﬁlter model alternatively address excitation-ﬁlter model avoid term collision. excitation-ﬁlter model widely used analyze speech production mechanism according excitation-ﬁlter model timbre instrument determined ﬁlter whereas pitch determined excitation signal. figure illustrate spectrum corresponding spectral envelope violin clarinet respectively plotted log-scale. even though excitation-ﬁlter model describe generation harmonic instrument sound similarly extend percussive instruments since also present difference energy distribution spectra shown figure ﬁlter’s frequency response instrument alternatively referred spectral envelope spectrum k-th excitation signal operator denotes element-wise multiplication satisﬁed proper source separation applied. ongoing matrix decomposition iteration spectral envelopes vary however proposed method focuses reverse direction theory group bases successfully reconstruct sound instrument make basis envelopes equal instrument? since proposed method requires estimation true spectral envelopes instruments basis envelopes representative spectral envelope extraction method presented next subsection. basis equivalence plca application dirichlet framework presented conventional works according research dirichlet prior shape bases probabilistic framework easily generalized framework. paper present implement plca framework. instead directly describe method framework. figure illustrates overall procedure proposed method works. input mixture audio transformed magnitude spectrogram decomposed using proposed modiﬁed nmf. doing bases randomly initialized ﬁrst spectral bases corresponding time activations estimated iteratively afterwards. estimation divided parts envelope excitation using linear prediction. envelopes bases belong instrument’s index replaced true envelope instrument. spectral bases reconstructed multiplying envelope excitation followed next iteration. iteration ﬁnished spectrograms reconstructed instrument. finally audio signals reconstructed. calculation coefﬁcients aims calculate all-pole inﬁnite impulse response ﬁlter coefﬁcients best predict signal value minimizing energy error signal represented real time domain signal error signal number ﬁlter coefﬁcients. accurate estimation coefﬁcients important since ﬁlter’s frequency response namely spectral envelope represented formula observe calculation coefﬁcients necessarily require original time domain signal also calculated autocorrelations. toeplitz matrix easily obtained using levinson-durbin recursion envelope spectral bases consider spectrum time domain signal magnitude |y|. spectral envelope magnitude spectrum directly obtained without spectrum-to-time domain signal conversion process. according wiener-khinchin theorem computation autocorrelation simpliﬁed power spectral density deﬁned denotes denotes inverse fast fourier transform complex conjugate. here magnitude spectrum sufﬁcient information attain autocorrelations turn used estimate coefﬁcients. coefﬁcients ﬁnally used estimate spectral envelope. section describe extend informed approach blind scenario. similar previous approach mainly based generalized dirichlet prior. figure shows structural overview proposed method. similar informed approach input signal converted spectrogram decomposed using minimize divergence iteration spectral envelopes bases belong group averaged. mean envelope applied bases next step. process represented mathematical formula average spectral envelope instrument weight weighted mean denotes mixing weight strength constraint imposition. heuristically determined optimization process presented next section. note identical respectively. true spectral envelope extracted given instrument sound replaced groupwise average envelope vφi. proposed blind source separation method unsupervised separation method ground truth spectral envelopes assumed given advance. made bases group uniﬁed envelope envelope converges ground truth envelope. technically technique estimates envelopes mixed instruments hence utilized algorithm simultaneously learns envelope excitation. finally spectrograms instrument reconstructed previous informed approach followed inverse short-time fourier transform. matrix time activations k-th matrix spectral bases k-th column denote temporarily adopted variables size denotes temporarily adopted variable size estimated spectrogram reconstructed up-to-date denote spectral envelope excitation spectrum k-th column represented respectively true spectral envelope instrument denotes mixing weight control strength constraint imposition denote index frequency time frame respectively denotes iteration index. note normalization stages spectral bases based generalized dirichlet prior contains autocorrelations make ||v|| normalization constant levinsondurbin function calculates dimensional vector coefﬁcients means levinson-durbin recursion. note imaginary number differentiated instrument index deﬁnition lpc. true spectral envelope instrument true spec computed similar step. tral envelope assume audio segment given first converted magnitude spectrogram spectral envelopes frame calculated. averaged observed previous research initialization spectral bases result difference separation performance. matrix decompositionbased source separation methods gaussian random noise uniform random sequence visualize distribution directions figure conﬁrmed sparse characteristics. however spectral bases often show sparse characteristic helpful initialize sparse vectors fast convergence well performance improvement. strategy generate sparse vectors perform elementwise square operation uniform random sequence. makes sparsity bases ampliﬁed figure utilize square operation; however effect higher order power operation needs investigated future. using novel initialization method obtain additional performance gain. section performance proposed method evaluated compared baseline algorithms fasst ozerov spiertz gnann’s methods. objective comparison performances audio dataset real recordings representative performance indicators. compare performances methods ﬁrst optimize using external dataset. performance evaluation used real-world computing music database consists audio clips musical instruments contains variations playing styles pitch dynamics. name playing styles instruments used experiment listed table last columns represent hi-hat snare drum sounds. note database provides three variations instrument manufacturer performer used different variation test data playing style spectral envelope training. second variation recorder contains sounds alto recorder whereas ﬁrst variation contains sounds soprano recorder occur mismatch spectral envelope. similarly ﬁrst second variations harmonica contain blues harp harmonica chromatic harmonica respectively. however show similarity timbre used second variations envelope training. generate mixtures audio clip multiple segments contains sound single note. mixed sounds instruments -second duration notes placed random positions. drum sounds contain pitch information sound excerpt selected repeated times mixed. used signal-to-distortion ratio signalto-interference ratio signal-to-artifact ratio measure quantitative performance separation methods. calculated using eval toolbox supported starget sinterf sartif denote target sound interference artifact respectively. trade-off relationship performance consider representative performance value. fasst provides many options perform source separation. among options assumed instantaneous mixing scenario ﬁxed adaptability rest options adaptive. types time-frequency representations stft tested options. also evaluate spiertz gnnan’s mel-frequency cepstrum coefﬁcient clustering-based method clusteringbased method hierarchical clustering-based method. table shows evaluation parameters used experiment proposed method. optimal number bases dependent number notes instrument. experiment number notes mixture total; however impossible recognize advance. addition single note often requires multiple bases thoroughly reconstructed. reason bases ﬁrst experiment later observe compare performance transitions different number bases used. order empirically determined separation quality vary dramatically. since methods spiertz gnann’s methods require iteration number iterations ﬁxed methods fair comparison. mixing weight linearly increases step size whereas ﬁxed zero cases. subsection weight optimized using pieces bach dataset dataset contains real recordings four instruments; violin clarinet saxophone bassoon. generated total sixty cases four instrument sounds linearly mixed. note sounds ampliﬁed suppressed energies mixture. analyzed case weight function mean activation assumption bases spectral envelopes close actual ones larger time activity average. figure shows performance transitions increase exponent here assumed {hk}p. envelopes averaged equal weights observed average ﬂuctuate notes bases sufﬁcient tested algorithms spiertz gnann’s algorithms. results proposed informed approach conﬁrm performance affected number bases. blind approaches reveal performances tend increase bases. particular performance proposed blind approach normal initialized bases highly enhanced increase number bases sparse initialization partly covers short bases reforming bases meaningful shapes. regardless number bases sparse initialization improves performance. overall proposed blind approaches tend outperform spiertz gnann’s methods. paper presented novel source separation methods exploit spectral envelope information spectrogram decomposition framework. proposed method divided basis vectors spectral envelopes corresponding excitations using linear prediction. enforcing constraints envelope part bases every iteration could shape bases represent desired instruments. ﬁrst research assumed could obtain instrumentspeciﬁc envelopes provided audio clips. second part study extended informed approach situations acquisition true instrument envelopes impossible. evaluated performance proposed methods veriﬁed methods outperform conventional methods. robert aichner herbert buchner meray zourub walter kellermann. multi-channel source separation preserving spatial information. acoustics speech signal processing icassp ieee international conference volume pages ieee nicholas bryan gautham mysore wang. isse interactive source separation editor. proceedings sigchi conference human factors computing systems pages arnaud delorme scott makeig. eeglab open source toolbox analysis single-trial dynamics including independent component analysis. journal neuroscience methods table shows performance conventional methods proposed methods. experiment total bases used methods spiertz gnann’s methods. baseline algorithms fasst show lowest performance resulting lowest sdr. contrary proposed informed approach shows highest sdr. side-information methods use. except informed approach proposed blind approach shows highest performance showing highest preserving high sar. spiertz gnann’s method also shows high values overall performance severely degraded. investigations performance comparison perform additional experiments examine effect number bases sparse initialization. table shows sdrs change according variations initialization methods number bases. here refer initialization method using uniform random sequence normal initialization proposed initialization method presented section referred sparse initialization. starting bases minimum identical number jeongsoo park jaeyoung shin kyogu lee. exploiting continuity/discontinuity basis vectors spectrogram decomposition ieee/acm transactions harmonic-percussive sound separation. audio speech language processing michael syskind pedersen larsen ulrik kjems lucas parra. convolutive blind source separation methods. springer handbook speech processing pages springer francisco rodriguez-serrano julio carabias-orti pedro vera-candeas tuomas virtanen nicolas ruiz-reyes. multiple instrument mixtures source separation evaluation using instrument-dependent models. latent variable analysis signal separation pages yann sala¨un emmanuel vincent nancy bertin nathan souviraalabastie xabier jaureguiberry dung tran fr´ed´eric bimbot. ﬂexible audio source separation toolbox version icassp madhusudana shashanka bhiksha paris smaragdis. probabilistic latent variable models nonnegative factorizations. computational intelligence neuroscience paris smaragdis gautham mysore. separation humming user-guided sound extraction monophonic mixtures. applications signal processing audio acoustics waspaa’. ieee workshop pages ieee martin spiertz volker gnann. source-ﬁlter based clustering monaural blind source separation. proceedings international conference digital audio effects romo v´azquez hugo velez-perez radu ranta louis dorr didier maquin louis maillard. blind source separation wavelet denoising discriminant analysis artefacts noise cancelling. biomedical signal processing control emmanuel vincent nancy bertin r´emi gribonval fr´ed´eric bimbot. blind guided audio source separation models ieee signal side information improve separation sound. processing magazine tuomas virtanen. monaural sound source separation nonnegative matrix factorization temporal continuity sparseness criteria. ieee transactions audio speech language processing zhiyao duan bryan pardo. soundprism online system scoreinformed source separation music audio. ieee journal selected topics signal processing leonardo tomazeli duarte said moussaoui christian jutten. source separation chemical analysis recent achievements perspectives. ieee signal processing magazine sebastian ewert meinard muller. using score-informed constraints acoustics speech signal nmf-based source separation. processing ieee international conference pages ieee sebastian ewert bryan pardo meinard m¨uller mark plumbley. score-informed source separation musical audio recordings overview. ieee signal processing magazine derry fitzgerald matt cranitch eugene coyle. extended nonnegative tensor factorisation models musical sound source separation. computational intelligence neuroscience joachim fritsch mark plumbley. score informed audio source separation using constrained nonnegative matrix factorization score synthesis. acoustics speech signal processing ieee international conference pages ieee toni heittola anssi klapuri tuomas virtanen. musical instrument recognition polyphonic audio using source-ﬁlter model sound separation. ismir pages christian hesse christopher james. semi-blind source separation using spatial constraints applications analysis. ieee transactions biomedical engineering po-sen huang minje mark hasegawa-johnson paris joint optimization masks deep recurrent neural smaragdis. networks monaural source separation. ieee/acm transactions audio speech language processing anssi klapuri tuomas virtanen toni heittola. sound source separation monaural music signals using excitation-ﬁlter model acoustics speech signal processing algorithm. ieee international conference pages ieee daniel sebastian seung. learning parts objects augustin lefevre francis bach c´edric f´evotte. semi-supervised time-frequency annotations single-channel source separation. ismir international society music information retrieval conference yuanqing shun-ichi amari andrzej cichocki daniel shengli xie. underdetermined blind source separation based sparse representation. ieee transactions signal processing keiichi osako yuki mitsufuji rita singh bhiksha raj. supervised monaural source separation based autoencoders. acoustics speech signal processing ieee international conference pages ieee alexey ozerov c´edric f´evotte. multichannel nonnegative matrix factorization convolutive mixtures audio source separation. ieee transactions audio speech language processing alexey ozerov emmanuel vincent fr´ed´eric bimbot. general ﬂexible framework handling prior information audio source separation. ieee transactions audio speech language processing", "year": "2018"}