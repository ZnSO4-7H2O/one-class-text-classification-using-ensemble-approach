{"title": "Using instantaneous frequency and aperiodicity detection to estimate F0  for high-quality speech synthesis", "tag": "eess", "abstract": " This paper introduces a general and flexible framework for F0 and aperiodicity (additive non periodic component) analysis, specifically intended for high-quality speech synthesis and modification applications. The proposed framework consists of three subsystems: instantaneous frequency estimator and initial aperiodicity detector, F0 trajectory tracker, and F0 refinement and aperiodicity extractor. A preliminary implementation of the proposed framework substantially outperformed (by a factor of 10 in terms of RMS F0 estimation error) existing F0 extractors in tracking ability of temporally varying F0 trajectories. The front end aperiodicity detector consists of a complex-valued wavelet analysis filter with a highly selective temporal and spectral envelope. This front end aperiodicity detector uses a new measure that quantifies the deviation from periodicity. The measure is less sensitive to slow FM and AM and closely correlates with the signal to noise ratio. ", "text": "trajectories produced models. attain highly natural synthetic speech important retain temporal variation trajectories although many extractors proposed practice parameter tuning and/or manual error correction often necessary. addition performance extracting temporal variations investigated explicitly. goal paper. paper organized follows. section discusses motivation target designing observer based review existing issues. also deﬁnes aperiodicity relevant speech analysis synthesis. section presents objective measures used paper. based these section introduces general scalable architecture observer. consists three subsystems front aperiodicity detectors best trajectory ﬁnder initial estimate reﬁnement subsystem aperiodicity extractor. sub-sections introduce front reﬁnement subsystems respectively. section subsystems evaluated using artiﬁcial test signals. section discusses remaining issues. example analysis results using actual speech samples mathematical details given appendices. speech synthesis requires dependable values whenever producing voiced sounds. however even copy-synthesizing actual speech samples targets known always easy since voiced sounds purely periodic deﬁning values signals trivial issue. figure shows beginning sentence speech corpus. speech signal voiced. however irregularities glottal vibrations deﬁning difﬁcult. lower plot shows tracks swipe′ illustrate issues. difﬁcult evaluate relevance tracking results. state systems produce consistent results. fact voicing without vocal fold contact rare prevents using source ground truth. using extracted trajectory comparing synthesized speech original speech reasonable test demanding human resource time obtain reliable results. alternative approach evaluating extractors objectively deﬁned artiﬁcial test signal. ideal candidate speech signal ground truth available instead provides wide divergence variability. paper introduces general ﬂexible framework aperiodicity analysis speciﬁcally intended high-quality speech synthesis modiﬁcation applications. proposed framework consists three subsystems instantaneous frequency estimator initial aperiodicity detector trajectory tracker reﬁnement aperiodicity extractor. preliminary implementation proposed framework substantially outperformed existing extractors tracking ability temporally varying trajectories. front aperiodicity detector consists complexvalued wavelet analysis ﬁlter highly selective temporal spectral envelope. front aperiodicity detector uses measure quantiﬁes deviation periodicity. measure less sensitive slow closely correlates signal noise ratio. front combines instantaneous frequency information ﬁlter outputs using measure yield observation probability map. second stage generates initial trajectory using signal power information. ﬁnal stage uses deviation measure harmonic component adaptive time warping reﬁne estimate aperiodicity estimation. proposed framework ﬂexible integrate sources instantaneous frequency provide relevant information. index terms fundamental frequency speech analysis speech synthesis instantaneous frequency paper describes tracker rapidly changing trajectories aperiodicity represents additive nonperiodic components. high-quality speech synthesis modiﬁcation applications surpassing point score glitches aperiodicity handling failure follow rapidly changing fundamental frequencies harmful processed speech quality. introducing generative model trajectory estimation provides well behaved parametric representation. however estimated trajectories still good enough highquality speech synthesis. actual excitation signal speech glottal contains several sources ﬂuctuations consequently observed trajectories different figure frequency modulated tracking. black thin line shows waveform model output. thick blue line shows true trajectory used generate test signal. reﬁned trajectory proposed method almost overlays true trajectory. question sometimes regular fashion vibrato. sometimes varies complex patterns tonal languages trajectory conveys linguistic information. intended changes modulations physiological aspects voice production. stochastic nature neural pulses drive muscles vocal organ strong noise source critical conditions produce vocal fold oscillation introduce bi-stable chaotic vocal fold vibration especially voice onset offset. related change physical body status also affects stability vibration deviations pure periodicity play important roles speech communication make speech much richer media text important properly analyse replicate deviations periodicity high-quality speech synthesis modiﬁcation applications. accurately estimating aperiodicity still challenging problem. tracking errors introduces spurious components original random component. reasons tracking distortions shown fig. harmful high-quality speech synthesis. issues properly solved accurate estimate tracking changing trajectory accurate estimate random components based accurate estimate trajectory. issues motivate develop framework provides calibrated procedure describe amount aperiodicity track primary analysis target high quality speech corpus recorded quiet acoustically controlled environment using high-ﬁdelity microphones. provide accurate certiﬁed metadata case value index represents accuracy estimated well measure represents amount aperiodicity. processing speed ﬁrst priority framework described here. note metadata depend data analysis frame reliable model dynamic behaviour aperiodic component. using models dynamic behaviour fujisaki’s model continuity constraint introduce biases figure example difﬁculty handling irregular voicing. upper plot shows speech waveform. middle shows spectrogram using blackman window frame shift. lower plot shows trajectories extracted using swipe′. around deviations caused discrepancies and/or failure baseline trajectory trackers. article uses excitation source signal deﬁned model model represents time derivative glottal using equations four parameters. however directly digitizing model deﬁned continuous time domain introduces spurious components aliasing. alleviate aliasing problem paper uses closed-form representation antialiased model deﬁned continuous time domain since model deﬁned continuous time domain easy generate signal using given trajectory ground truth used paper. figure shows example tracking using sinusoidally frequency modulated trajectory test signal. test signal vibrato large compared normal human voice demonstrates problems random cycle-by-cycle variations tested extractors swipe′ proposed method described section trajectories obtained swipe′ strongly distorted attenuated perhaps changing faster models allow. distorted trajectories used generate excitation source copy-synthesis output perceived differently. distortion adds fast-changing modulation components original signal. effects spurious components made worse humans sensitive fast frequency modulations amplitude modulations voiced sounds usually considered periodic ﬁrst approximation glottal pulses occur regular intervals. prosodic needs voice constantly changing sometimes simple glide rise open-source implementation anti-aliased model model parameters controlled glottal cycle independently simulate details vocal fold behaviour combined time varying lattice ﬁlter simulate dynamic speech production process modulates observed interaction harmonic component group delay associated resonances detailed simulations study. model mismatch. frame-based aperiodicity information proposed system produces help establish certiﬁably accurate models statistical/dynamic behaviour. speech synthesis applications amplitude controllable parameters excitation source. however replicating amplitude precisely original speech yields poor quality synthetic sounds. important attribute excitation missing. missing attribute aperiodicity. paper attributes represented amplitude modulation included deﬁnition aperiodicity. left removing periodic component deﬁnes aperiodicity paper. turns system’s estimation error well correlated system’s estimate aperiodicity described below. extractors evaluated based error-rate related measures; gross pitch error voicing detection error pitch tracking error attaining high performance measures prerequisite good extractors. paper focus tracking ﬁdelity proposed method make voiced/unvoiced decision. instead tracker outputs measure aperiodicity closely correlates standard deviation relative estimation error true value. aperiodicity detector also informative source type excitation. voiced/unvoiced decision left application output proposed method make decision. proposed framework yangsaf computes instantaneous using three steps estimate track reﬁne. estimation step calculates three features input signal number bandpass channels. maximum estimate stage tracked produce local estimate finally optional reﬁnement stage combines temporal harmonic information produce accurate estimate ﬁrst stage yangsaf algorithm analyses signal number bandpass channels estimates three values channel function time. values local instantaneous frequency measure called aperiodicity represents amount variability channel’s frequency estimate probabilistic estimate channel contains good representation signals described subsections follow used tracking stage described section figure shows diagram estimating detector channel. figure schematic diagram aperiodicity detector. upper part calculates instantaneous frequency using flanagan’s equation lower part calculates aperiodicity measure relative residual level channels using bank bandpass ﬁlters centered center frequencies cover possible range ﬁxed separation logarithmic frequency axis. current implementation covers using channels detectors octave. instantaneous frequency estimate needs complex-valued signal derivative. values calculated starting bandpass ﬁlter derivative shown fig. described appendix bandpass ﬁlter linear phase zero-delay ﬁlter complex-valued response passes positive frequency components. instantaneous frequency signal contained within channel calculated using flanagsn’s approach based logarithm complex signal derivative. am/fm modulated signal represented polar form rejθ. instantaneous frequency deﬁned derivative phase component namely instantaneous frequency derived starting logarithm component phase using algebra also wish calculate measure aperiodicity signal channel used measure reliability instantaneous frequency measurement. constant sinusoid aperiodicity zero aperiodicity grows signal varies within bandpass ideal brick-wall ﬁlter amplitude change. subtracting original twice-ﬁltered normalized response gives estimate aperiodicity. note estimate done without explicitly identifying primary sinusoid frequency. signal whose fundamental frequency equal ﬁltered fundamental component complexvalued slowly time-varying signal passed normalized become then using ﬁlter again normalizing overall amplitude ﬁltering signal using absolute value complex valued-signal twice ﬁltered signal obtained. subtracting twice ﬁltered amplitude normalized signal amplitude normalized ﬁrst ﬁlter output yields residual signal since signal normalized power residual represents relative level component. corresponds spectral components channel primary sinusoid. calculating energy signal smoothing gives system’s measure harmonic aperiodicity. appendix describes relation original signal residual aperiodicity power using equations examples. placing bandpass ﬁlters shape logarithmic frequency axis yields detector output higher aperiodicity value located harmonic frequencies fundamental. similar concept fundamentalness explained fig. reference appendix shows relation ﬁlter shape examples harmonic components. instantaneous frequency calculation aperiodicity calculation yield values audio sampling rate. audio sampling rate time series down-sampled later processing. work down-sampling accomplished extracting nearest time samples time series providing sequences instantaneous frequency aperiodicity measure values frame rate fundamental component original signal dominant number output channels little else ﬁlters centered frequencies lower second harmonic respond. thus number channels respond fundamental component seen blueish blob around second panel figure channels inside blob information fundamental component different reliabilities. given number estimates true different channels probability indicates channel best estimate. create probability instantaneous frequency aperiodicity estimates converted gaussian probability masses centered various instantaneous frequency estimates. output channel’s aperiodicity estimate converted variance scaling. scaling coefﬁcient empirically determined simulations. log-frequency scale gives number estimates instantaneous frequency modelled gaussian mass centered variance figure example ﬁrst stage detector outputs. upper plot shows instantaneous frequency map. middle plot shows residual map. bottom plot shows probability map. speech material japanese vowel sequence /aiueo/ spoken male. reference purpose trajectory extracted third stage overlaid using open circles. probability periodic vertical lines synchronized vocal fold vibration. upper right trace periodicity corresponds response ﬁrst formant vowel /o/. channel. basic idea periodicity detector calculate amount energy band-passed signal primary sinusoid. primary sinusoidal component largest energy complex signal normalized unit magnitude reﬁltered renormalized primary sinusoid still unit magnitude. components ﬁltered non-unit gain since ﬁlter finally channel selection reﬁned returning original probability computed section choosing channel highest probability closest chosen smoothed estimate. following provides initial estimate foi. third stage improves estimate adding reﬁnements. first importantly higher harmonics estimate reﬁne estimate. secondly adaptive time warping original signal combined reﬁnement using higher harmonics warped signal reduces amount trajectory deviation better analyses. ﬁrst procedure uses harmonic frequencies variance. harmonic component ﬁrst m-th corresponding aperiodicity detector. bandpass ﬁlter detector shape linear frequency axis cover neighbouring harmonic components. detector yields instantaneous frequency aperiodicity represents harmonic number. values converted estimate fk/k variance bkfk/k provides reﬁned estik= used calculate best however reﬁnement properly make higher harmonic information trajectory rapidly changing. rapid movement higher frequencies generates strong side-band components smear analysed harmonic structure thus second procedure uses adaptive time axis warping alleviate problem. stretching time axis proportional instantaneous value makes observed value constant keeps harmonic structure intact. then placing aperiodicity detectors harmonic frequencies ﬁrst m-th weighted average information yields estimate warped time axis. converting estimate value value original time axis provides improved estimate. procedures applied serially well recursively. represent operation harmonic based reﬁnement using ﬁrst m-th harmonic components represent operation adaptive time warping-based reﬁnement using ﬁrst m-th harmonic components. represent function initial estimate represents input signal represents associated design parameters analysis. following equations describes conﬁgurations trackers tested summing yields probability density function represented gaussian mixture. channel integrating distribution provides observation probability channel fundamental component nominal pass band integrates instantaneous frequency probability distributions frequency limits ﬁlter arrive estimate reasonable channel provide estimate example result shown bottom figure. given three instantaneous maps computed section initial estimate single best frame calculated ﬁnding channel highest probability. done four steps estimate pitch range utterance smooth probability highest probability reﬁne estimate. result smooth estimate true based instantaneous frequency calculated channel. first search range estimated weighted average instantaneous frequencies seen utterance. temporal weighting calculated energy original signal ﬁltering prospective pitch range. frame instantaneous frequency weighted combined form overall instantaneous frequency histogram. weighting signal’s amplitude point time high-energy portion utterance treated importance. median instantaneous frequency distribution deﬁnes center point search range. tracker looks peaks probability distribution within octaves center point octaves below total octave range. second order better estimate start voicing probability computed section smoothed time using hanning window amplitude weighting. smoothing done tracking extend estimates start voiced segments. example onset voicing probability high signal level low. smoothing using amplitude weighting increases probability frames onset level grows consequently become higher. words probability distribution onset frames become like probability distribution later frames. smoothing reduces tracking error beginning voicing. thing happens voice offset. figure frequency modulation transfer function modulation. higher tracking frequency limit initial estimate expanded times proposed reﬁnement using adaptive time warping measuring ability tracker follow modulation relevant test speech sounds rapid changes. instantaneous frequency aliasing-free model output controlled audio sampling rate resolution. average musical cent peak-to-peak modulation depth roughly frequency modulation peak-topeak frequency. tests described section white noise added. figure shows frequency modulation transfer function four trackers serve benchmark variations tracker described paper. vibrato frequency trackers work well high snr. higher modulation frequencies trackers except fail follow full modulation shows reduced gain considfinally placing aperiodicity detectors harmonic frequencies warped time axis estimated around harmonic component provides excitation source information speech synthesis. trajectories warped time axis constant time aperiodicity values detectors output consistent aperiodicity deﬁnition paper. paper uses measures performance. importantly standard deviation relative error tells total distortion estimated trajectory ground truth. second performance measure frequencymodulation amplitude transfer function expresses well tracker follows fast modulations. test signal uses sinusoidal modulation logarithmic frequency axis since dynamics better described logarithmic frequency axis consequently fmtf distortion evaluation measures logarithmic frequency calculate value. proposed algorithms implemented using matlab tested using synthetic signals. representative results described below. following tests test signals generated using aliasing-free model sampling frequency modal voice quality parameters model used following examples. firstly quality estimate face additive white noise tested using conﬁguration given extractor initial estimate tested clarify effects reﬁnement four popular extractors also evaluated reference; swipe′ tested using default recommended settings. constant trajectory used test. figure shows results vertical axis represents relative error. larger yielded best results. yin’s performance obtained cost poor temporal resolution shown following test. designed high-quality recordings tolerant noise. swipe′ showed good performance performance saturated after. harmonic reﬁnement procedure reduced error initial estimate factor even high noise standard deviation error n-th harmonic component described previous paragraph. total second best result. original model anti-aliased using closed form representation. matlab implementation function guibased interactive application speech science education open source spurious levels around fundamental component model’s output lower temporal variation consists effects caused interactions harmonic components group delay vocal tract transfer function. desirable compensate effect speech synthesis applications effect accumulated analysis synthesis cycle. addition interesting consider unique tracker based harmonic-locked loop tracking alternative reﬁnement procedure third stage proposed framework. paper introduced framework intantaneous estimates aperiodicity. able improve ability extractors temporally follow varying trajectories factor serve useful infrastructure speech research applications. authors appreciate insightful discussions prof. patterson human auditory perception especially temporal structure detection interfering sounds. malcolm slaney provided editorial assistance. ellis also provided productive well critical comments. flanagan uses time derivative logarithm complex signal estimate instantaneous frequency. introducing logarithmic function phase component linearly separable amplitude. figure shows error trajectories function modulation frequency. dashed line dash line show error best approximation true using piece-wise linear function segment lengths respectively. swipe′ yielded large error corresponding strong distortion shown fig. reﬁnement performance without time warping comparable ndf. showed best performance among popular methods. reﬁned trajectory using adaptive time warping reduces error factor range modulation. higher values errors methods decrease inversely proportionally value. adaptive time warping also reduced spurious component substantially. example test signal frequency modulation musical cent depth reﬁned analysis conﬁguration t◦t◦h reduced spurious residual levels lower perceptually negligible. goal paper estimate trajectories consist rapidly changing components accurately high-quality speech synthesis. proposed procedures provide prospective framework. however following aspects estimation exploited here. investigations following issues could important improving synthesis quality further. plosive sounds sometimes sound like fricative smearing temporal sharpness smoothing effect time windowing. common degradation found straight. speakers languages frequently creaky voice. representing sounds using periodic signal plus noise results poor reproduction. relevant analysis representations investigated. figure principles operation. upper plot shows ﬁlter shape dominant signal .fc. filter gains adjusted make output levels subtracting second ﬁlter gain ﬁrst yields equivalent ﬁlter components. lower plot shows output residual level function location dominant signal noise level. detector designed cancel primary periodic component input signal adjusting ﬁlter gain frequency primary component. done normalizing output level. high case total level ﬁltered signals approximately equal level periodic component. level lower level components affected suppression process. since equivalent ﬁlter gain suppression process difference ﬁlters yields ﬁlter shape terms time-frequency product bounded plorate spheroidal wave function theoretically best however large spectral dynamic range actual speech signals cosine series windows side lobe level steep side lobe decay yielded better performance. note tkeo relevant estimating rapidly changing trajectories since uses approximation requires slowly changing using flanagan’s equation relevant since rely approximation. integration interval nuttall window hann window interval blackman window interval band pass ﬁlters impulse response lengths ﬁrst spectral zeros smoothing relative residual level yields kawahara morise banno skuk temporally variable multi-aspect n-way morphing based interference-free speech representations aspipa agiomyrgiannakis vocaine vocoder applications kameoka yoshizato ishihara kadowaki ohishi kashino generative modeling voice fundamental frequency contours ieee trans. audio speech language processing vol. boersma accurate short-term analysis fundamental frequency harmonics-to-noise ratio sampled sound proceedings institute phonetic sciences vol. amsterdam kawahara cheveign´e banno takahashi irino nearly defect-free trajectory extraction expressive speech modiﬁcations based straight. interspeech shown curve left plot fig. right plot fig. shows output aperiodicity parameter function location primary component level lower level components. figure shows detector ﬁlter shapes front third stage. front ﬁlter width proportional center frequency. reﬁnement stage ﬁlter width constant. ﬁlters reﬁnement stage designed using estimated band estimators front independently estimate instantaneous frequency estimate quality estimate form aperiodicity measure. need consolidate estimates single estimate weighted average. assume random variables having zero mean variances wish generate estimate noisy estimates weighting individual estimates arrive answer minimum estimated variance. thus assume following cost function. kawahara k.-i. sakakibara banno morise toda irino aliasing-free implementation discrete-time glottal source models applications speech synthesis extractor evaluation apsipa hong kong wang instantaneous frequency-warped techniques source separation signal parametrization ieee assp workshop applications signal processing audio acoustics sparkng interactive matlab tools introduction speech production perception processing fundamentals application aliasing-free model component interspeech fujisaki note physiological physical basis phrase accent components voice fundamental frequency contour vocal fold physiology voice production mechanisms functions kawahara masuda-katsuse cheveign´e restructuring speech representations using pitch-adaptive timefrequency smoothing instantaneous-frequency-based extraction speech communication vol. kawahara katayose cheveigne patterson fixed point analysis frequency instantaneous frequency mapping accurate estimation periodicity eurospeech’ morise kawahara katayose fast reliable estimation method based period extraction vocal fold vibration singing voice speech audio engineering society", "year": "2016"}