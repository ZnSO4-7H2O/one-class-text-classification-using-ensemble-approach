{"title": "Nonlinear Shape Regression For Filtering Segmentation Results From  Calcium Imaging", "tag": "eess", "abstract": " A shape filter is presented to repair segmentation results obtained in calcium imaging of neurons in vivo. This post-segmentation algorithm can automatically smooth the shapes obtained from a preliminary segmentation, while precluding the cases where two neurons are counted as one combined component. The shape filter is realized using a square-root velocity to project the shapes on a shape manifold in which distances between shapes are based on elastic changes. Two data-driven weighting methods are proposed to achieve a trade-off between shape smoothness and consistency with the data. Intuitive comparisons of proposed methods via projection onto Cartesian maps demonstrate the smoothing ability of the shape filter. Quantitative measures also prove the superiority of our methods over models that do not employ any weighting criterion. ", "text": "revolution calcium imaging accommodating observation neural function multitude neurons without invasive electrodes. calcium imaging ﬂuorescent proteins provides convenient optical record large neuron populations precision single action potential level progress parallel areas calcium sensitive ﬂuorescent protein engineering calcium imaging techniques vivo calcium imaging become standard method investigate neural circuit mechanisms underlying cognitive behaviors. however calcium imaging methods contrast previous sparse neuron short-term imaging recordings generate huge volume data hundreds thousands neurons resulting several hours recording. analyze large datasets high throughput automated image analysis methods advanced image segmentation techniques required able identify single neurons also detect single calcium events. years researchers explored numerous image segmentation techniques analysis biomedical images. existing segmentation techniques thresholding edge detection active contours morphological methods still limited single-neuron analysis. recently efforts image analysis research community attempted avoid identiﬁcation multiple components single component using graph method iterative local level evolution approaches allow identiﬁcation individual cells; however seeded segmentation strategy methods challenging datasets given noisy signals non-activated neurons. also vivo videos increase difﬁculty locating seeds individual cells. also post-segmentation algorithms attempt isolate connected components including watershed transform concavity identiﬁcation former algorithm fails inhomogeneity present datasets latter method suffers rough boundaries extracted preliminary segmentation. paper explore novel perspective postsegmentation shape ﬁlter transform preliminary segmentation produced temporal sequence shapes. provides smooth shape evolution path targeting single shape ﬁlter presented repair segmentation results obtained calcium imaging neurons vivo. postsegmentation algorithm automatically smooth shapes obtained preliminary segmentation precluding cases neurons counted combined component. shape ﬁlter realized using square-root velocity project shapes shape manifold distances shapes based elastic changes. data-driven weighting methods proposed achieve trade-off shape smoothness consistency data. intuitive comparisons proposed methods projection onto cartesian maps demonstrate smoothing ability shape ﬁlter. quantitative measures also prove superiority methods models employ weighting criterion. mammalian brain complex system mainly large number neurons form complicated interconnected networks. human brains contain almost billion neurons mouse brains million neurons neurons receive thousands inputs innervate thousands downstream neurons. since brain functions require coordinated activation large groups neurons across different brain regions recording understanding neural activity circuit level fundamental understanding brain cognitive functions. paper accepted published ieee international conieee personal material permitted. permission ieee must obtained uses current future media including reprinting/republishing material advertising promotional purposes creating collective works resale redistribution servers lists reuse copyrighted component work works. neuron activity along time ﬁltering unnecessary incomplete segments smoothing boundaries preliminary results. realize method modiﬁed smooth nonlinear regression shapes riemannian manifold proposed based shape space introduced although several works proposed smooth splines regression manifold evaluating polynomial energy-minimization functions able automatically detect exclude non-smooth shapes preserving structure target object. deep learning shape regression face alignment. methods able split connected components suitable limited dataset. limitations segmentation methods results show separate cells single connected component. paper propose novel method automatically ﬁlter outliers provide smooth segmentation cell interest rest connected component. design shape ﬁlter generates smooth path manifold represent shape evolution time. fig. shows chart shape ﬁlter framework. following sections present detailed description locally weighted shape smooth regression method provides smooth segmentation based shape evolution path ﬁtted data. data preparation shape representation shown fig. input shape ﬁlter preliminary result segmentation. time neuron chosen analyzed. then shape information extracted represented equidistant points located boundary segmented body cartesian coordinates square-root velocity representation shapes order compare shapes extracted time-indexed segmented data. under representation shape deﬁned riemannian manifold locally assembled euclidean coordinates deﬁned follows represents shape closed curve parameterized equal distant arclength shows gradient curve ||·|| denotes euclidean norm. suppose geodesic path arbitrary shapes deﬁned manifold. then difference shapes evaluated using geodesic distance srv-transformed shapes ˙αdt represent initial ﬁnal positions shows gradient path respectively. geodesic path. inﬁnitesimally small geodesic distance approximately integral length gradient magnitudes. weighted smoothed nonlinear regression transforming shape data representation optimization problem solved ﬁlter extra components preliminary result interpolating likely smooth shapes along time-indexed calcium ﬁring path. time ﬁltered path also smooth boundary segmentation results imposing several constraints. denote original evolution path represent ﬁltered path manifold. paths approximately differentiable geodesic distance deﬁned aforementioned. then estimated optimizing following regression problem modiﬁed boor’s approach proposing automatic outlier detectors space shape manifold modiﬁed shape regression model aims desired minimizer balances trade-off approaching original data smoothing ﬁltered path equation time index shape also used following sections paper. second derivative path here qmedian represents euclidean median shape along input path shapes representation. moreover euclidean distance normal gaussian cases replaced geodesic distance. weighting response according sample input datum shown fig. piecewise constant fig. three weighting responses sample input. modify weights based local shape information. however needs additional analysis detect outliers; instantaneous automatic data-driven weightings. analysis comparison methods examined performed videos time sampling. frame videos resolution pixels. activated neurons observed calcium imaging diameters vary experimental data focused regions interest frames sample neighboring neurons activated time. cases separating different neurons individual components challenging task. used basic thresholding morphological methods produce preliminary segmentation results. then compared experimental results datasets using unity weighting local shape weighting modiﬁed shape gaussian weighting quantitatively qualitatively. evaluate performance three weights using dice coefﬁcient normalized mean squared error. table. shows mean scores experiments. dice coefﬁcient compares similarity sets ground truth segments ﬁltered segments volumes packed time-indexed results. dice calculated |sg∩sf| |sg|+|sf| denotes cardinality corresponding set. mean squared error characterizes changes shapes along ﬁtted path. smoothing parameter reﬂects emphasis data smoothness. note that close becomes spline input data becomes small smoother fewer shape changes along time terms transformed shape representation. local weights used estimate outliers automatically explained details section detect clutter found segmentation calcium images propose locally weighted shape regression strategy. four weight selection methods discussed section third fourth proposed local weights shape ﬁlter. residual geodesic distance true data ﬁtted smooth spline small weight data term equation speciﬁes mean deviation residuals median) treated mean shape sequence instead traditional mean outliers affect value. tolerance residual deviations. automatically assign negative feedback data term data larger tolerance smoothed spline formula calculate value inspired skew measure statistical analysis. constant amplify proportion data term. cubic weight capable yielding wider range data base inner cube closer zero increases acceptance shapes similar mean shape. fig. comparison data smoothness oriented results. section input path; ﬁltered path using unity weight; ﬁltered path using local; ﬁltered path using sgaussian. ﬁrst column shows data oriented results larger values second column shows smoothness oriented results smaller fig. two-dimensional visualization path shape space using isomap dimensionality reduction project path shapes shape ﬁlter riemannian manifold. left right columns values isomaps using local; bottom isomaps using sgaussian. markers spline shows indices time. note scales diagram left right getting larger. measures average squared errors ground truth test data. normalized total number pixels frames. comparing dice factors demonstrate superiority local sgaussian unity weighting model. intuitively fig. visualizes comparison paths shape ﬁlter shape ﬁlters cartesian coordinates. results show application shape ﬁlter twofold smoothing non-smooth boundaries preliminary results; ﬁltering extra neuron single neuron segmentation path substituting reasonable shape. ﬁgure also compares ﬁltered shapes different weights graphically. fig. shows comparison data smoothness oriented results based choice equation precisely verify inﬂuence ﬁltered path utilized isomap dimensionality reduction method project high dimensional path riemannian manifold trajectories cartesian shown fig. near projected trajectories become smoother denser. case using shape ﬁlter result smooth shape regression manifold. overall proposed algorithm computationally efﬁcient. major time consumption local weighting calculation roughly computation complexity performance shape ﬁlter degrade quantity input shapes sufﬁcient generate path manifold predicts evolution activated neurons. proposed srv-based manifold shape ﬁlter provides powerful theoretical basis repairing time sequences shapes obtained calcium imaging neurons. method agnostic initial segmentation even images depicting overlapping neurons. experimental results demonstrate proposed weighting methods outperform method equal weights. shape ﬁlter effective detecting improper segmentation addressing splitting problem. azevedo carvalho grinberg equal numbers neuronal nonneuronal cells make human journal brain isometrically scaled-up primate brain comparative neurology vol. yang ahuja automatic segmentation granular objects images combining local density clustering gradient-barrier watershed pattern recognition vol. kong gurcan belkacem-boussaid partitioning histopathological images integrated framework supervised color-texture segmentation cell splitting ieee transactions medical imaging vol. hinkle fletcher joshi intrinsic polynomials regression riemannian manifolds journal mathematical imaging vision vol. k¨uhnel sommer stochastic development regression non-linear manifolds ieee conf. ipml", "year": "2018"}