{"title": "Multispectral Compressive Imaging Strategies using Fabry-P\\'erot  Filtered Sensors", "tag": "eess", "abstract": " This paper introduces two acquisition device architectures for multispectral compressive imaging. Unlike most existing methods, the proposed computational imaging techniques do not include any dispersive element, as they use a dedicated sensor which integrates narrowband Fabry-P\\'erot spectral filters at the pixel level. The first scheme leverages joint inpainting and super-resolution to fill in those voxels that are missing due to the device's limited pixel count. The second scheme, in link with compressed sensing, introduces spatial random convolutions, but is more complex and may be affected by diffraction. In both cases we solve the associated inverse problems by using the same signal prior. Specifically, we propose a redundant analysis signal prior in a convex formulation. Through numerical simulations, we explore different realistic setups. Our objective is also to highlight some practical guidelines and discuss their complexity trade-offs to integrate these schemes into actual computational imaging systems. Our conclusion is that the second technique performs best at high compression levels, in a properly sized and calibrated setup. Otherwise, the first, simpler technique should be favored. ", "text": "paper introduces acquisition device architectures multispectral compressive imaging. unlike existing methods proposed computational imaging techniques include dispersive element dedicated sensor integrates narrowband fabry-p´erot spectral ﬁlters pixel level. ﬁrst scheme leverages joint inpainting super-resolution voxels missing device’s limited pixel count. second scheme link compressed sensing introduces spatial random convolutions complex affected diffraction. cases solve associated inverse problems using signal prior. speciﬁcally propose redundant analysis signal prior convex formulation. numerical simulations explore different realistic setups. objective also highlight practical guidelines discuss complexity trade-offs integrate schemes actual computational imaging systems. conclusion second technique performs best high compression levels properly sized calibrated setup. otherwise ﬁrst simpler technique favored. multispectral imaging consists capturing light intensity object scene varies along spatial coordinates different wavelengths i.e. light spectrum measured intervals bands. information sampled data volume allows accurate classiﬁcation segmentation constituents object scene spectral proﬁle. hence imaging ﬁnds diverse applications remote sensing optical sorting astronomy food science medical imaging precision agriculture classic approach spatially spectrally multiplex cube focal plane array done scanning cube speciﬁc slices sequentially acquired sensor several snapshots systems require either tunable spectral ﬁlters dispersive elements mechanical parts scan object scene. approaches entail trade-offs complexity cost spectral spatial resolution acquisition time. recently single-snapshot imagers developed rapidly acquire cube thus avoiding motion artifacts enabling video acquisition rate among imagers focus using fabry-p´erot ﬁltered sensors i.e. standard cmos imaging sensors array spectral ﬁlters deposited. technique generalizes ﬁlter arrays ﬁlter banks using arbitrary number narrowband proﬁles e.g. tens. thus array imposes reduction spatial resolution sensor’s pixels partitioned bands. ispgroup icteam/elen universit´e catholique louvain belgium funded f.r.s.-fnrs part work funded pˆole mecatech walloon region project adric lisa universit´e libre bruxelles imec belgium computational resources provided cism/ucl ´eci funded f.r.s.-fnrs convention paper investigates imaging strategies based compressed sensing established signal processing paradigm inspired several computational imaging frameworks acquisition compressive device measurements recovery algorithm along sensing operator signal prior. broad theoretical conditions method recovers highresolution approximation target scene even sensing performed scene’s nyquist rate. complexity sensing operation therefore balanced complexity signal respect given prior. propose snapshot imaging strategies multispectral volume inpainting multispectral random convolution maintain relatively system-level complexity without dispersive element. using principles designed low-pixel-count sensor. msvi leverages generalized inpainting procedure discussed provide simple integration sensor computational imaging scheme. architecture performs spatio-spectral subsampling cube relies redundancy obtain high-resolution recovery. fairly simple works best lower compression levels. msrc leverages random convolution discussed provide spatial-domain means out-of-focus random coded aperture i.e. array square apertures randomly placed opaque screen. preserves spectral resolution ﬁxed number narrowband ﬁlters fpa. ideally sized low-noise setup complex architecture clearly improves recovered quality especially higher compression levels. however entails optical design challenges discussed section architectures numerically compared terms achievable recovery performances. also discuss complexity trade-offs design guidelines identifying unavoidable adverse optical effects integrate schemes realistic imaging systems. ﬁndings numerical results corroborate conspicuous reduction number measurements w.r.t. nyquist-rate representation made possible architectures preserving high peak signal-to-noise ratio table summarizes pros cons strategy detailed clariﬁed throughout paper. paper organized follows. rest section places contribution perspective respect related work literature introduces useful notations. section presents ﬁlters technology proposed analysis sparsity prior inverse problem formulation common strategies well associated reconstruction algorithm. section details speciﬁcs msvi strategy i.e. image formation model sensing matrix. section similarly provides details msrc strategy discusses associated non-idealities practical considerations. section presents numerical reconstruction results. demonstrate msvi performances experimental data compare msvi msrc using simulated acquisition. ﬁnal section gives brief conclusion. imaging schemes dates back popular application spectral imaging coded aperture snapshot spectral imaging framework many variants summarized hereafter. single-disperser cassi uses random partially occlude focused scene. refractive prism grating shears spatio-spectral information processed light recorded standard imaging sensor. system introduced shows high spectral accuracy image recovery expense lower spatial accuracy. double-disperser cassi achieves opposite performances terms optical system complexity optical calibration robustness noise robustness miscalibration acceptable psnr compression psnr compression acquisition speed initialization quality spatial versus spectral accuracy requires non-trivial calibration geometric alignment optical components. close line work proposes snapshot spectral imaging architecture. based cassi features wide-band spectral ﬁlters provide random spatio-spectral subsampling shearing element. non-snapshot spectral imaging architectures based also recently proposed cassi variants target relatively large number bands intrinsically capable achieving high spectral resolution thanks dispersive optics. however spectrum well represented fewer bands spectral mixing less effective purposes spatial mixing especially fp-ﬁltered sensors tens narrowband ﬁlters whose high selectivity excludes spectral super-resolution. work focus ﬁltered schemes target bands without using dispersive element. since introduction envisioned provide image acquisition reduced sensor resolution shorter acquisition times references therein). particular second strategy proposed paper related random convolution sensing operation acts spatial-domain convolution random ﬁlter e.g. random imaging recently subsampled random convolution operation shown comply theoretical results operation also featured recent imaging architectures convolution-based schemes appealing allow fast sensing operation. indeed compressive measurements formed frame full imaging sensor opposed single-pixel camera designs compressive measurements multiplexed time. moreover fast fourier transform implementations convolutions drastically reduce computational cost reconstruction compared unstructured sensing operations. however snapshot capability numerical efﬁciency random convolution architectures paid higher correlation adjacent compressive measurements spatial adjacency considering optical-level non-idealities point spread function optical elements. work propose extension low-complexity snapshot imaging architecture introduced bj¨orklund magli particular architecture uses placed out-of-focus provide random convolution. notations vectors noted matrices rn×n arrays rn×n×n vectorization row-major ordering identity matrix adjoint note |x|p)/p p-norm operator -norm. proximal operator associated deﬁned proxf argminx full convolution valid part indicator inside otherwise. note diag diagonal matrix diagonal bdiag block-diagonal matrix blocks arranged without overlap bdiagn bdiag repeating times section introduce ﬁltered sensors used strategies. propose image analysis sparsity prior. prior used regularize inverse problem convex optimization program common strategies. section describes convex formulation associated recovery algorithm used section class imaging sensors core work comprised standard cmos sensor designed operate visible light range wavelengths layer fabry-p´erot interferometers deposited. latter whose physics well described spectrum incoming light band-pass ﬁlters whose center wavelength width designed yield narrowband proﬁles ﬁlter proﬁles designed ﬁlters manufactured cover area single pixel either mosaic layout group different ﬁlters repeated mosaic pattern partitioning sensor tiled layout sensor partitioned large areas spectral ﬁlter speciﬁc wavelength deposited possible envision architectures tiled layouts focus mosaic designs allow reduction correlation measurements taken adjacent sensor pixels. sensor designed prototyped imec referred imec’s sensor following. external spectral cutoff ﬁlter removing anything outside range allows obtain ﬁlter bank depicted fig. proﬁles generated illustration purposes based calibration measurements taken imec. data post-processed keep main lobe ﬁlter response. particular smaller secondary modes appear harmonic wavelengths another example) removed clarity. work consider idealized situation ignoring secondary modes. furthermore real situation must compensate attenuation coefﬁcients either before reconstruction. hereafter sake simplicity approximate spectral responses dirac delta ﬁlter’s centre wavelength equal gain. consider sensor featuring -band ﬁlter bank uniformly spaced center wavelengths either placed mosaic pattern randomly-assigned arrangement called random pattern latter manufactured practice pose major difﬁculty compared mosaic pattern. simulations random pattern generated permuting assigned locations ﬁlters entire fpa. forward model analysis sparsity prior rnu×nv×nλ represent discretized cube spatial spectral domains equivalently represented vectorization nunvnλ. studied architectures entail noisy linear acquisition process summarized following generic forward model model linear sensing operator represented matrix form rm×n mumv. yields compressive measurements captured sensor array rmu×mv vectorized form noise vector bounded -norm computational imaging system based regularized inverse problems schemes must leverage prior model signal acquired. choose analysis sparsity prior speciﬁcally separately apply linear transforms spatial spectral domains denoted domain transform chose daubechies- undecimated discrete wavelet transform forms shift-invariant separable overcomplete wavelet transform approximation level inherently sparse contains low-pass approximation image. found however slowly varying spatial information helps leveraging redundancy bands. thus discrete cosine transform concentrates low-pass information coefﬁcients making consistent sparsity prior. wavelet ﬁlters chosen length levels resulting analysis transform rnunv×nunv chosen spectral domain transform rnλ×nλ given focus cubes natural scenes smooth spectral proﬁles. good noise estimate used setting parameter solve non-smooth convex optimization program using alternating directions method multipliers introduced speciﬁcally version recasted solve problems form convex lower semicontinuous functions linear operators full column rank. practical implementation requires efﬁcient computation proximal operators associated functions well matrix-vector products hj∗wj arbitrary crucial step algorithm matrix inversion property matrices simplify step exploited. particular tight frame property i.e. hj∗hj fourier diagonalization i.e. f∗σf discrete fourier transform diagonal; sparsity separability used following. blind deconvolution problem proposes handle boundary conditions adding masking missing rows block-circulant sensing operator. stabilizes estimation recovering block-circulant structure convolution operator allowing fourier diagonalization. building ideas detailed architectures sections arbitrarily rows columns order exploit properties cited above. deﬁne extended sensing matrix ¯m×¯n restriction operators }n×¯n i.e. restrict input vectors arbitrarily chosen index sets note adjoint restriction corresponding zero-padding operator. addition factorization happens analysis transform introduced actually scaled tight frame i.e. exists diagonal weighting matrix order make ﬁrst architecture coined multispectral volume inpainting presented section. describe formation recording measurements snapshot sensor corresponding sensing matrix implementation. description aligned fig. scheme allows choose free parameter target spatial resolution target volume rnu×nv×nλ choose target smaller resolution sensor resolution i.e. even though mumv nunvnλ. assume spatial low-pass ﬁlter appropriate frequency placed device chosen resolution achieves nyquist rate resulting low-pass scene practice common stabilizing demosaicking e.g. using birefringent ﬁlters slightly defocusing objective lens. linear operator rm×nunv applied band. since achieves nyquist rate lossless representations de-couples number pixels mumv target scene resolution nunv; choose subsampling rate changing other. order model sensing operation relation upsampling introduce diagonal mask operator }m×m masking pixels ones corresponding ﬁlters index concatenation }m×nλm restriction operator rnλm aside clear afﬁliation inpainting problem computer vision make links random basis ensembles references therein) spectral direction sparsity basis maximally incoherent canonical basis therefore optimal choice. hand spatial dimension loosely speaking ignoring upsampling sparsity basis wavelet transform maximally incoherent canonical basis. intuitively justiﬁes study second method section rigorously extending analogy redundant wavelet analysis upsampling would require work. explained section ease computations adding rows columns natural choice bdiagnλ. therefore separable sparse matrix easily pre-computed fast invert example conjugate gradients algorithm. even though gain less obvious msrc case discussed section found empirically using trick speeds admm’s convergence compared direct noted case i.e. subsampling rate makes inversion step trivial scalar multiplication section describes multispectral random convolution device. first discuss image formation model implementation aspects linked important non-idealities attenuation diffraction. finally discuss numerical implementation sensing matrix used recovery method section give description msrc device based geometrical optics depicted fig. follows ideas originally introduced difference here ﬁltered sensor instead panchromatic sensor. precise description easier continuous domain representation object interest. order lighten notations consider spatial dimension simpliﬁed instead since everything separable dimensional extension straightforward. consider virtual ﬂipped source radiates directions allowed aperture objective lens. illuminates random elements distance along optical axis. known symbols equal probability modeling either transparent opaque pixels. assume negligible effect spectral domain. illuminated replicas source shifted bundles parallel rays propagate optical axis. ideal thin lens focal length directions deﬁned angle w.r.t. placed front focuses modulated light sensor. rays direction converge focal plane denoting here continuous convolution. deﬁnes relationship pixel pitch imaging sensor choose model sampling function corresponding detector notation highlight fact sensor measurement obtained forming discrete measurements vector note spectral ﬁltering step continuous equivalent described section represented right part fig. replaces sensor pixels i.e. shifts target covers elements. must therefore elements cover recorded angles. explained alter pattern measurements vector symbols effectively become instead propose either complementary patterns transparent pixels become opaque vice versa subtract corresponding measurements vectors subtract measurement made fully transparent aperture i.e. yon. implies programmable ﬁxed mask easily removed full non-coded acquisition rest consider equivalent pattern used. discrete model discrete linear forward model optical processing chain stems particular discretization target volume. natural choice instance replace dirac-sampled version sample discrete target volume. note sampling functions nicely aligned other directly translates discrete model. coming back discrete spatial dimensions discrete forward model thus reads rmu×mv array recorded measurements; rmu×mv rmu×mv mask linear operators modeling effect ﬁlters introduced section ﬁlter }su×sv represents discrete version rnu×nv band index full cube rnu×nv×nλ. size chosen valid convolution matches size sensor i.e. multi-snapshot mode since total measurements recorded sensor latter produces mumv measurements band. consider possibility partitioning acquisition taking multiple snapshots {yp}p∈ different aperture patterns i.e. {sp}p∈. therefore total number measurements becomes mumvms. taking multiple snapshots different aperture patterns expected reduce correlation measurements. size decreases keeping constant multisnapshot device resembles single-pixel camera equivalent setting anticipated main optical-level limitation scheme impact diffraction occurs single small square aperture followed lens illuminated plane wave forms diffraction pattern focal plane effect diffraction modeled optical ﬁlter whose point spread function pattern. wavelength-dependent diffraction kernel following expression focal plane unimportant energy conservation constant low-pass effect limits spatial bandwidth system causing correlation measurements decrease performance. simplify discussion spatial dimension. kernel equivalently viewed scale. note rescaled physically appear notational trick allowing mathematical simpliﬁcation. expression discrete measurements becomes order deﬁne discrete sensing model inject replacing expanding expression verify result completely equivalent replacing continuous kernel discretized version deﬁned pre-compute diffracted wavelength dependent aperture patterns since size focal plane matches valid convolution size safely truncate diffracted aperture pattern effective size keep mind modeled diffraction kernel approximation based assumptions perfect thin lens fact object incoherent plane wave etc. actual system could measured instance using pre-deﬁned along point-like target light source estimate regularized inverse problem spatially-dependent psfs could also estimated similar techniques. leave subject open future investigation. focusing lens must bigger i.e. dlens max{su moreover practical lenses sufﬁciently high f-number avoid aberrations i.e. f/dlens characterize width diffraction kernel sensor location ﬁrst zeros argument sinc i.e. pixels thus apply simulations parameters section i.e. notice largest width corresponds longest wavelength λmax wide must choose lens least diameter focal length e.g. arbitrarily choose parameters ﬁxed width focal plane number pixels determined pixel pitch sensor also determines distance parameters incompatible standard cmos technology used case impractical width dpsfλmax pixels. workaround proposed binning pixels together macro-pixels wasteful defeats purpose compressive architecture. another modifying equivalent requiring investigation magnify sensor viewed focusing lens. simulations intended proof concept assume effective magniﬁcation times cmos sensor. leads width respectively dpsfλmax pixels illustrated fig. mention important challenges msrc design. beside spectral differences mentioned section manufacturing variability introduce unknown gains sensor. measurement provides information entire scene highly limit quality msrc reconstruction. comparison effect corrupted measurement msvi design would localized. blind calibration techniques help direct calibration possible. optical alignment another important issue. instance distances roll angle sensor must precisely set. choice lenses must also minimize chromatic spherical aberrations. narrowband ﬁltering considerably decreases system’s light throughput. therefore implementation must limit light attenuation. instance several possible choices exist manufactured mask physical holes provides best light throughput programmable. pixels semi-transparent spatial light modulator imperfect opacity transparency. goes reﬂective liquid crystal silicon devices paired polarizing beam splitter dims light. despite excellent light transmittance digital micro-mirror devices used single-pixel camera suitable used focus uncertainty deﬂection angles would translate systematic error.. based discrete model write sensing matrix corresponding vectorized forward model rmumv×nunv partial block circulant matrix deﬁnes valid convolution operator rmumv×mumv matrix equivalent first notice every band every snapshot processed separately submatrices φpx. sensing matrix thus block matrix )p∈∈. follows natural order elements stacked vectorized note masked random convolution enjoys good properties explained section rmumv rmumv×susv restriction operator selects valid part size mu×mv circular convolution size su×sv. similarly r∗nunv rsusv×nunv zero-padding operator whose output matches size circular convolution. csusv×susv diag)) i.e. equivalent inverting diagonal matrix µid. note computing input vector requires computing dfts msnλ inverse dfts size similarly computing input vector requires msnλ dfts inverse dfts. comparatively computing inverse cheaper since requires dfts inverse dfts. section present numerical results experimental data msvi simulated acquisition compare msvi msrc strategies. experiments performed matlab code provided supplementary material recoveries used dynamic range normalized xmin xmax tolerance relative -distance iterations always reached less niter iterations. parameters manually tuned order reach reasonably fast convergence critically affect recovery quality. factor heuristic normalization compared initialization tolerance maximum iterations. fig. present result based experimental measurements test scene observed imec’s mosaic sensor. imager resolution pixels organized mosaic identical macropixels; different ﬁlters wavelengths visible light experiment restricted measurements region depicted bigger white square false color image. subsampling rate i.e. recover volume voxels. setting target minimum measurements residual ratio logy naive super-pixel based demosaicking method used clearly worst. middle shows result linear interpolation tikhonov regularization initialization method though observe clear improvement grid artifact already observed appears particularly visible band. artifact removed proposed method without exact ﬁlter calibration proﬁles ground truth spectra cannot here evaluate spectral accuracy. following dataset compare strategies quantitatively qualitatively series controlled synthetic simulations. comprises eight selected multispectral volumes cave dataset spectral matching imec’s sensor. spatial manually chosen image capture interesting features. chart stuffed toys sample used qualitative comparisons shown fig. figure result experiments real data acquired imec’s sensor. qualitative comparison naive demosaicking initialization proposed method. image false color nearest neighbor preview. points pixels whose spectra represented column. samples chosen produce average psnr curves balloons feathers jelly beans glass tiles stuffed toys superballs beads middle right plots fig. show average reconstruction peak signal-to-noise rate different sensor conﬁgurations; msvi three msrc setups levels additive white gaussian noise measurements. value determined oracle. simulation uses corresponding sensing operator generating measurements reconstruction i.e. model mismatch. fig. shows qualitative result chosen sample snr. chose extreme sampling rate input noise expose obvious differences sensing strategies conﬁgurations. msvi since ﬁxed dataset explore four msvi sensor sizes test different ﬁlters conﬁgurations mosaic pattern random pattern lower subsampling ratios random arrangement outperforms mosaic sensor particularly high input snr. indicates randomness mitigates aliasing caused extreme subsampling. nyquist rate mosaic beats random sampling results look visually perfect fig. ﬁrst show initialization point deﬁned i.e. since xinit −ylin. despite much faster iterative method gives visually scrambled results particularly outer bands less data-points available. spectral error particularly large pixel highly textured region destabilizes linear interpolation. results obtained proposed method denoted accurate edges textures e.g. horizontal bars chart stripes toy’s sleeve well resolved. mosaic arrangement leads grid artifact observed section whereas random arrangement leads seemingly unstructured artifacts smaller spectral error areas figure results synthetic experiment. ground truth false color cave sample chart stuffed toy. bigger white square region indicates part cube used experiment. smaller white squares labelled correspond zooms features depicted fig. average psnr whole dataset levels input noise curves correspond msvi system mosaic random layouts msrc diffraction modeled dpsfλmax pixels testing msrc strategy size ﬁxed vary sampling rate number snapshots increased simulations unique snapshot increasing size omitted sake conciseness gave close slightly inferior results. compare performances diffraction-free case cases diffraction kernel respectively dpsfλmax pixels wide. expected global trend indicates increasing size decreases quality. interestingly reconstruction psnr diffraction-free case pixels case. fig. suggests msrc method suitable extreme subsampling example digits chart diffraction-free reconstruction legible artifacts barely noticeable. spectral error also impressively small. performances rapidly decrease diffraction spatial low-pass effect. expected redundant wavelet prior able recover lost high-pass information. however pixels case gives pretty spectral accuracy especially near edges pixels case remains reasonably good spectral reconstruction. ideal diffraction-free case noise msrc device provides performance improvement msvi. justiﬁes present study feasibility msrc design. however higher sampling rates diffraction decreases quality even pixels psf. note msvi ideal msrc falls zero input snr. qualitative comparison focus case msrc outperforms msvi average even diffraction. msrc gives better spectral accuracy msvi selected pixels particular pixels regarding spatial accuracy noisy patterns appear stripes toy’s sleeve msvi reconstruction. however spatial high-frequency content particularly visible chart patterns digits affected diffraction kernel. strategies proposed paper sensor integrated ﬁlters. despite using principles involve dispersive elements. along conceptual optical design device proposed accurate forward model uniﬁed reconstruction procedure formulated regularized inverse problem original spatio-spectral prior. particularity msrc compared msvi lies spatial mixing provided out-of-focus allows higher compression ratios properly sized entails adverse effects diffraction. figure qualitative results sensor setups input snr. patches correspond zooms regions cube points pixels whose spectra represented column. light gray lines remind ground truth areas represent error. rows show results linear interpolation mosaic random msvi measurements. last rows recovery results corresponding tested setup. extensive numerical simulations explored different setups. devised practical guidelines highlighted limitations methods allowing proceed towards informed implementation. ideally sized low-noise calibrated setup msrc gives better performances high compression. situations factoring cost implementation calibration msvi preferred.", "year": "2018"}