{"title": "Water Residence Time Estimation by 1D Deconvolution in the Form of a  l2-Regularized Inverse Problem With Smoothness, Positivity and Causality  Constraints", "tag": "eess", "abstract": " The Water Residence Time distribution is the equivalent of the impulse response of a linear system allowing the propagation of water through a medium, e.g. the propagation of rain water from the top of the mountain towards the aquifers. We consider the output aquifer levels as the convolution between the input rain levels and the Water Residence Time, starting with an initial aquifer base level. The estimation of Water Residence Time is important for a better understanding of hydro-bio-geochemical processes and mixing properties of wetlands used as filters in ecological applications, as well as protecting fresh water sources for wells from pollutants. Common methods of estimating the Water Residence Time focus on cross-correlation, parameter fitting and non-parametric deconvolution methods. Here we propose a 1D full-deconvolution, regularized, non-parametric inverse problem algorithm that enforces smoothness and uses constraints of causality and positivity to estimate the Water Residence Time curve. Compared to Bayesian non-parametric deconvolution approaches, it has a fast runtime per test case; compared to the popular and fast cross-correlation method, it produces a more precise Water Residence Time curve even in the case of noisy measurements. The algorithm needs only one regularization parameter to balance between smoothness of the Water Residence Time and accuracy of the reconstruction. We propose an approach on how to automatically find a suitable value of the regularization parameter from the input data only. Tests on real data illustrate the potential of this method to analyze hydrological datasets. ", "text": "water residence time distribution equivalent impulse response linear system allowing propagation water medium e.g. propagation rain water mountain towards aquifers. consider output aquifer levels convolution input rain levels water residence time starting initial aquifer base level. estimation water residence time important better understanding hydro-bio-geochemical processes mixing properties wetlands used ﬁlters ecological applications well protecting fresh water sources wells pollutants. common methods estimating water residence time focus cross-correlation parameter ﬁtting non-parametric deconvolution methods. propose full-deconvolution regularized non-parametric inverse problem algorithm enforces smoothness uses constraints causality positivity estimate water residence time curve. compared bayesian non-parametric deconvolution approaches fast runtime test case; compared popular fast cross-correlation method produces precise water residence time curve even case noisy measurements. algorithm needs regularization parameter balance smoothness water residence time accuracy reconstruction. propose approach automatically suitable value regularization parameter input data only. tests real data illustrate potential method analyze hydrological datasets. hydrological water residence time distribution measure allowing analysis transit water given medium. estimation necessary using wetlands natural treatment plant pollutants already water werner kadlec better manage protect drinking water sources pollution cirpka study water transport dissolved nutrients gooseff comprehensive application range including deciphering hydro-bio-geochemical processes river monitoring review done mcguire mcdonnell useful starting point. call residence time linear response aquifer system. context refers wave propagation water dynamics actual molecular travel time botter obtain residence time distinguish families methods active passive. active methods carried releasing tracers entrance system given time like artiﬁcial dyes tracing curve measuring tracer levels exit system dzikowski delay werner kadlec payn robinson although robust methodology involves high effort high operational costs. could also perturb water channel lead biased results. passive methodology consists recording data inlet outlet water channel speciﬁc water isotopes mcguire mcdonnell water electrical conductivity cirpka simply recording rainfall levels high altitude grounds aquifer levels base delbart passive case residence time measured directly must retrieved deconvolution. authors also deconvolution active methodology release tracer cannot considered instantaneous mcguire mcdonnell cirpka payn residence time approximated impulse response system turn estimated deconvolution neuman skaggs fienen method also used enhancing geophysical models although targeted explicitly water residence time estimation deconvolution methods parametric neuman marsily long derickson etcheverry perrochet werner kadlec mcguire mcdonnell non-parametric neuman dietrich chapman skaggs michalak kitanidis cirpka fienen gooseff delbart parametric methodology advantage always providing result expected properties correct shape positiveness caveat insensitive unexpected results real data non-parametric deconvolution advantage blind meaning strong priori estimated curve absence adapted mathematical constraints results reﬂect physics residence time curve method non-parametric takes account limitations previous methods category variable-sized rainfall time series input compared neuman compact direct model formulation neuman cirpka less computational effort less time consuming bayesian monte-carlo inverse problem methodology fienen strictly using passive method respect mixed methods like ones gooseff contrast cross-correlation vogt delbart avoid unrealistic hypothesis rain signal considered white noise. fact rainfall datasets long range memory properties therefore simulate input rainfall synthetic tests multifractal signal tessier important difference non-parametric deconvolution methods enforce causality explicitly projection. also discuss importance aspect avoid sub-optimal solution using fourier domain based convolution mccormick neuman dietrich chapman delbart causality constraint mentioned. skaggs cirpka payn gooseff causality taken account carefully constructed toeplitz matrix convolution operation. passive input rainfall output aquifer levels required; ﬂexible sense handles even unexpected solutions handle dirac-like rain events inputs also clustered rain events longer time period last property important order deal non-linearity non-stationarity water channel known difﬁculty residence time estimation neuman marsily massei mcguire mcdonnell payn rest article organized follows section presents direct problem inverse problem formulation section depicts algorithm used solve inverse problem formulation. important implementation details discussed section also discuss differences solution previous non-parametric deconvolution methods used benchmarks section section present results obtained synthetic data discuss choice hyper-parameter controls smoothness residence time. finally present results obtained real data section section concludes paper. white gaussian noise real signal length impulse response system well mean level aquifer must estimated. required positive causal smooth. positivity obvious residence time causality refers delayed unidirectional water point entry aquifer thus idea must progress positive time domain smoothness regularization used order avoid noise ampliﬁcation deconvolution. function classically introduces ﬁdelity term corresponding white gaussian noise well regularization term gradient order favor smooth solutions. smoothness degree estimate controlled hyper-parameter bigger stress smoothness solution smaller better solution data. main goal work also optimal range consistently gives accurate estimates toeplitz matrix corresponding convolution signal ﬁnite-difference matrix corresponding gradient used applying smoothness estimated signal. minimization interpreted maximum posteriori estimation bayesian context gaussian prior noise exponential family smoothness. since problem convex estimate alternating minimization algorithm ensures global minimization items estimated. historical overview available osullivan ﬁxed problem simple quadratic optimization constraints solved using projected newton method bertsekas chosen computational speed. ﬁxed estimate given analytic formula. algorithm evaluate convergence applying orthogonal projection positivity causality constraints iteration. analytic solution computed used initial step iterative algorithm. algorithm alternating minimization input dαmink errminy errminsmaxtmax output kestcestyrec cest cest errrel errrel smax errrel errmin kest kest yrec yrec cest tmax errrel errmin αmin provide distribution package matlab algorithm download link found article. although previous sections model solution written matrix form matlab implementation convolution algorithm done product multiplication fourier domain appropriate zero padding meaning toeplitz matrix explicitly deﬁned convolution. also possible carefully implement causal convolution designing proper toeplitz matrix. however convolution fourier domain appears efﬁcient general. implementation also allows estimation residence time longer inputs although would under-determined. non-circularity enforced particular implementation convolution another aspect dealt causality constraint. figure present convolution rainfall diracs residence time curve. convolve rainfall time series residence time curve found negative time domain curve positive time domain resulting breakthrough curve appears rain events ﬁrst case wrong. second case breakthrough curve appears rainfall events expected real applications. non-causal case lobes appear negative time domain also incorporating energy present residence time curve thus reducing amplitude distorting shape. figure estimate algorithm possible residence time curves positivity causality constraints applied positivity constraint applied causality constraint applied positivity causality constraints applied. cases convolution rainfall residence time curves give reconstructed breakthrough curve similar general shape real one. best residence time estimation breakthrough curve reconstruction nonetheless ones positivity causality constraints applied algorithm. figure different results kest different constraints applied algorithm. give similar yrec best yrec kest positivity causality constraints applied. optimal solution caused algorithm navigates optimality attached given functional change estimated vector kest algorithm moves value functional away optimal point estimated last iteration mccormick bertsekas ﬁrst example let’s take neuman regularized nonparametric deconvolution uses bi-criterion curve; navigates optimality optimal estimation residence time using lag-one auto-correlation coefﬁcient error criteria. consider similar approach functional simpler uniﬁed formulation direct model’s point view different method navigate optimality projected newton method algorithm. also cited article discussion positivity smoothness causality estimated residence time. output system known; input system known; toeplitz matrix input system; impulse response system estimate; hyper-parameter estimate fischer’s statistic method; denotes hessian hyper-parameter squared determined fischer’s statistic method smoothness implemented second derivative applied constraint positivity condition integral obtained curve sums solutions evaluated provencher fischer’s statistic method visual inspection. another aspect multiple peak problem provencher argues investigate separately certain values also avoid computational difﬁculties test runs basis function representation introduced ensure linearity probability density function representation transport model. causality constraint discussed here. contrast estimate hyper-parameter using values reconstructed breakthrough curve original one. bigger means better reconstruction also better estimation constraints realized hyper-parameter possible choice strategies hydrologist estimate curve range values multiple time series time series lengths value best particular tested site. smoothness regularization ﬁrst-order derivative since testing second-order derivative show improvement estimate thus direct model slightly simpler. algorithm make priori assumption shape estimated residence time therefore multiple lobes appear without ﬁxed number beforehand. estimation also free modeled basis functions. sole observation channel needs short enough considered linear. case fienen presented method bayesian monte-carlo non-parametric deconvolution method gives result full shape residence time distribution curve containing possible residence time curves channel zones interest curves average curve. method yield multiple peaks transfer function computational cost using mcmc gibbs sampler reﬂected brownian motion requires computational effort fienen constraint positivity causality michalak kitanidis expectation maximization used estimate parameters. algorithm tested uni-modal bi-modal cases. comparison method provides faster estimates residence time curve dirac-like rainfall event clustered rainfall event. computational cost tested hyper-parameter small. constraint shape residence time curve smoothness positivity causality implement throughout algorithm. downside algorithm estimate uncertainties attached residence time like bayesian approach. another example dietrich chapman algorithm based ridge regression direct model similar hyper-parameters set. michalak kitanidis another article bayesian monte-carlo deconvolution done inverse problem setup. positivity causality implicitly enforced method images applied reﬂected brownian motion gives prior non-zero non-negative parameter range michalak kitanidis mcmc implemented gibbs sampling algorithm. similar fienen result also zones interest residence time curve. even computational time bayesian mcmc deconvolution methods deemed manageable michalak kitanidis probably even current hardware need fast method seems necessary community expand next paragraph. cross-correlation method benchmark compare performance algorithm. cross-correlation measures similarity signals second shifted version itself. algorithm also estimates basin measurements constant level cest estimated residence time amplitude depends constant level. necessary obtain amplitude cross-correlation method comparison purposes done following cross-correlation implicitly assumes input rainfall white noise. case auto-correlation rain fall time series would dirac center. since real rainfall time series actually long-tailed statistics cross-correlation method inexact. multifractals simulate realistic rainfall tessier therefore expect cross-correlation method limited performance real life tests. decision benchmark cross-correlation fact deterpreferred method hydrologists numerous recent articles mining transport biological constituents sheets studying rivergroundwater interaction different types measurements cross-correlated like hoehn cirpka cross-correlation also used vogt estimating mixing ratios mean residence times delbart estimating pure residence time curve. therefore hydrology community interested simple fast method minimal implementation time gives residence time curve estimation different time series measurements. case cross-correlation method focuses analyzing position maximal amplitude general shape curve. curve hydrologists extract characteristics interest particular channel contrast cross-correlation method offer positivity smoothness causality constraints give precise curve similar computing time. another benchmark method presented cirpka uses measurements ﬂuctuations electrical-conductivity inputs direct model similar algorithm cirpka used vogt articles compare results crosscorrelation method. cirpka deconvolution algorithm also alternating minimization algorithm time estimating residence time ﬁrst step using bayesian maximum posteriori method estimating variance noise slope parameters second step. notice equation similar main advantage cirpka approach delivers uncertainty curves full bayesian method full bayesian deconvolution method thus fast computation time. drawback parameters variance noise slope need well chosen initial values. full bayesian based deconvolution parameters would also need estimated would done markov chain monte carlo methods computationally intensive. regularization based deconvolution avoid high computational costs multiple parameters need carefully chosen initial values. optimal value hyperparameter automatically obtained inputs. context realistic synthetic validation generate rain signals multifractal simulation based tessier multifractal parameters furthermore simulate beta distribution choose arbitrarily evaluate computed estimates deﬁnition replace noise term estimated kest signal yrec signal respectively. examples results obtained synthetic data shown figure figure positivity causality constraints well respected. addition method always provides better estimation residence time kest comparison standard cross-correlation method. cross-correlation method manages preserve position maximum intensity residence time distribution match either shape amplitude true observed high noise level hyper-parameter must greater order obtain better estimates kest yrec. greater greater importance regularization term comparison ﬁdelity term therefore smoothing important improves results entries noisy. therefore analysis deconvolution results also necessary order right adaptation hyper-parameter particular noise level. propose four strategies automatically tune hyper-parameter. λoracle choosing corresponding best estimation kest maximizing kest output strategy works solution known represents maximum achievable value. idelity choosing corresponding best reconstruction yrec maximizing yrec output value reconstruction optimum. completely heuristic method automatically selects hyper-parameter performance close selection discrepancy principle seen next completely blind figure examples residence time estimation kest reconstructed aquifer levels yrec synthetic data input input rain generated realistic multifractal time series. stands alternating minimization xcorr standard cross-correlation true true solution. four strategies give different estimates kest whose value compared input goal obtain best possible kest given input level. algorithm tested different input values range chosen values dispersed logarithmic scale. show quality estimation noise level arbitrarily test cases randomly chosen convolved known resulting signal gaussian noise added according input test value. apply xcorr cirpka methods test case test record kest value yrec value yrec correlation coefﬁcient. since tests made input obtain plots showing evolution kest yrec yrec correlation coefﬁcient depending choice. averaging plots mean values standard deviation computed shown figure input figure respectively. lose optimality single example averaging show variability criteria depending noise level input data. also present graphically four strategies determination. figure selection strategy hyper-parameter plot average standard deviation synthetic examples kest yrec yrec correlation coefﬁcient function input meaning noisy measurements. λoracle point shows best average maximize kest synthetic tests. computed true solution known. idelity maximizes yrec snr. λdiscrepancy achieved yrec closest actual noise level. λcorrcoe optimum correlation coefﬁcient yrec figure four strategies compare cross-correlation method. kest length data points estimate show results inputs data points long results data points long. kestsnr always best λoracle strategy expected. across plots λcorrcoe performs closest idelity strategy similar λdiscrepancy snrs highest noise level input idelity worst short time series λdiscrepancy worst average optimal value strategy given input level presented figure evolution values versus input four given strategies. four strategies hyper-parameters similar noise level data points. then begin diverge λcorrcoe always stays neighborhood λoracle meaning valid strategy real test cases known. high noise levels data points λdiscrepancy increases provides over-regularized highly smooth solution optimum. data points idelity λdiscrepancy deliver smaller idelity still expect would deliver proper kest suspect λdiscrepancy would stress attachment data. means estimated kest would give yrec would follow closely shape including noise. furthermore investigate inﬂuence data volume estimate. aggregated results presented figure input input four strategies show signiﬁcant improvement input time series rainfall aquifer measurements longer especially measurements noisy. figure quality residence time estimation kest four hyper-parameter selection strategies cross-correlation method. mean standard deviation obtained kest snrs function noise level measurements inputs length data points data points crosscorrelation method always stands lower indicating poorer estimation. correlation coefﬁcient strategy λcorrcoe best strategy across noise level signal length. figure quality residence time kest estimation depending number data points contained observe data points lead better estimation method four strategies. input input figure method compares cross-correlation method algorithm described cirpka various input snrs data points respectively method cirpka algorithm show similarly good results comparison cross-correlation. method cirpka smaller standard deviation method showing weaker dependence noise/structure dataset. proposed approach provides different output results depending given best solution picked automatically operator choose appropriate solution based expertise appropriate range around optimal moreover solution independent initialization convexity functional. figure plots illustrate average runtime test cases different input snrs three algorithms. algorithm consistently faster cirpka algorithm input snrs higher also faster small data sets points tests real data conducted data sets made available base donnes observatoires hydrologie irstea irstea data gathered france region france. measurements neighboring sites higher altitude rainfall measurements second lower altitude aquifer measurements taken every hour intervals january january real data estimates based λcorrcoe strategy chosen around optimal values found synthetic data figure figure estimates residence time real life measurements shown. figure examples results real data using λcorrcoe strategy. estimate residence time kest aquifer level cest; also plot breakthrough curve yrec blue. stands alternating minimization xcorr standard cross-correlation true residence time known. position maximum amplitude kest similar methods shape kest varies signiﬁcantly. method physical properties positivity causality. cases estimated curves honor given positivity causality constraints. cross-correlation even yrec close original curve residence time estimated method disadvantage respect positivity causality constraints across presented cases. aquifer level measurements negative values conventions used measuring instruments. algorithm also capable estimating aquifer average level depending constant amplitude rain fall input estimated residence time curve kest also certain amplitude small signiﬁcant changes residence time curve different data sets channel also identiﬁed datasets delbart seasonal variability inputs effects hydrological process. aspect would interest study detail speciﬁc sites better understand another observation made fact non-linearities system present approach also lead simpliﬁcation. nonetheless question arises hydrological channel could considered linear stationary system parts therefore allow method estimating partial residence time curves together complex mapping channel. also note plots yrec slightly better cases heavy rainfall event appears beginning time series instead towards suggesting fact residence time estimation would also better. finally examples show appearance multiple lobes considered sign reservoirs hydrological channel keeping part water time releasing later discharge. demonstrates usefulness non-parametric deconvolution method comparison parametric deconvolution methods lobes either ignored ﬁxed number. propose approach estimate smooth residence time taking account positivity causality constraints fast runtime. highlight constraints must used along algorithmic process reach expected solution case non-parametric deconvolution algorithm presented here. estimation residence time kest done using fast alternating minimization algorithm steps deconvolution estimation aquifer initial level. tests done personal laptop intel core .ghz -bit x--based processor using matlab validated approach synthetic tests proposed several strategies automatically estimate hyper-parameter controls smoothness residence time curve. found strategies correlation coefﬁcient strategy seems efﬁcient estimate best value validated method synthetic data found results better standard cross-correlation method similar cirpka method. also demonstrated capabilities method real data. additionally method respects physical constraints important interpretation purposes. estimation made method provide better information hydro-geologists amplitude full shape residence time mean level aquifer also improve estimation mean residence time matlab implementation algorithm available cecill license following public repository https//git.ls.centralesupelec.fr/ meresescual/smoothsignalestimatordeconvolution.git. work supported center data science funded idex parissaclay anr--idex--. acknowledge support institut national sciences l’univers centre national recherche scientiﬁque centre national d’etude spatiale programme national plantologie mex/pfs program.", "year": "2018"}