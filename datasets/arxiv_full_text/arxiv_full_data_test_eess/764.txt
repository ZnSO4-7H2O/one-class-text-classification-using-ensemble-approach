{"title": "2D Reconstruction of Small Intestine's Interior Wall", "tag": "eess", "abstract": " Examining and interpreting of a large number of wireless endoscopic images from the gastrointestinal tract is a tiresome task for physicians. A practical solution is to automatically construct a two dimensional representation of the gastrointestinal tract for easy inspection. However, little has been done on wireless endoscopic image stitching, let alone systematic investigation. The proposed new wireless endoscopic image stitching method consists of two main steps to improve the accuracy and efficiency of image registration. First, the keypoints are extracted by Principle Component Analysis and Scale Invariant Feature Transform (PCA-SIFT) algorithm and refined with Maximum Likelihood Estimation SAmple Consensus (MLESAC) outlier removal to find the most reliable keypoints. Second, the optimal transformation parameters obtained from first step are fed to the Normalised Mutual Information (NMI) algorithm as an initial solution. With modified Marquardt-Levenberg search strategy in a multiscale framework, the NMI can find the optimal transformation parameters in the shortest time. The proposed methodology has been tested on two different datasets - one with real wireless endoscopic images and another with images obtained from Micro-Ball (a new wireless cubic endoscopy system with six image sensors). The results have demonstrated the accuracy and robustness of the proposed methodology both visually and quantitatively. ", "text": "moves digestive tract takes three pictures second eight hours. thus large number images generated moreover illumination random movements device therefore non-perfect shooting angles make images less understandable. besides symptoms usually spread large areas tract whereas endoscopic image area small order detect symptoms crucial build panoramic images interior walls extend ﬁeld view consequently representation whole tract possible generate much easier interpret rather investigating images individually. however noted capsule average missing rate limited visual ﬁeld random movements capture rate cameras imposes challenge address missing-rate issue smart wireless micro-ball endoscopy prototype system proposed cameras constructing cubic structure embedded micro-ball system. determined smart control system device operates monitor normal drastic modes capture rate respectively. reduce power consumption camera selection strategy applied cameras work simultaneously without missing areas. shown fig. tract constructed successfully provided images efﬁciently registered. context image registration deﬁned follows given images register images optimal geometric transformation function best matches transformation parameters. considering tract soft ﬂexible together fact endoscopy device propelled gravity peristaltic movements within tract reconstruction interior wall seems formidable task current algorithms fail achieve satisfactory results within reasonable time frame. therefore approach required overcome challenge. abstract—examining interpreting large number wireless endoscopic images gastrointestinal tract tiresome task physicians. practical solution automatically construct dimensional representation gastrointestinal tract easy inspection. however little done wireless endoscopic image stitching alone systematic investigation. proposed wireless endoscopic image stitching method consists main steps improve accuracy efﬁciency image registration. first keypoints extracted principle component analysis scale invariant feature transform algorithm reﬁned maximum likelihood estimation sample consensus outlier removal reliable keypoints. second optimal transformation parameters obtained ﬁrst step normalised mutual information algorithm initial solution. modiﬁed marquardt-levenberg search strategy multiscale framework optimal transformation parameters shortest time. proposed methodology tested different datasets real wireless endoscopic images another images obtained micro-ball results demonstrated accuracy robustness proposed methodology visually quantitatively registration residual error pixels real endoscopy image pairs residual error accumulation pixels without affecting visual registration quality stitching images micro-ball. troenterologists opportunity investigate small intestine non-invasive way. wireless capsule endoscopy commonly performed obscure gastrointestinal bleeding also indications diagnosis crohns disease suspicion small bowel tumour diagnosis surveillance hereditary polyposis syndromes non-steroidal anti-inﬂammatory drug-induced small intestinal lesions celiac disease wireless endoscopy offers several potential advantages traditional esophagogastroduodenoscopy including ability perform hours without sedation interpreted bedside physicians. addition painless much less invasive enables patient pursue daily routines procedure. therefore high patient acceptability rate however interpretation procedure time consuming tiresome. swallowed device typically cameras attar centre computational imaging simulation technologies biomedicine department electronic electrical engineering university shefﬁeld shefﬁeld micro-ball. work proposed method straightforward combination image registration algorithms i.e. phase correlation method scale invariant feature transform assess image registration algorithms particular application. however practice investigations crucial provide better representation small intestinal tract physicians. objective present work improve solution reconstruction small intestines interior wall proposing methodology register images easier inspection. images enhanced preprocessing method improve quality. keypoints extracted principle component analysis sift algorithm processed maximum likelihood estimation sample consensus outlier removal select correlated keypoints between paired images. transformation parameters considered candidate solutions transformation function improve accuracy efﬁciency image registration optimal transformation parameters tuned maximize normalized mutual information value paired images. becomes evident sequel application technique real wireless endoscopic images also unique database images obtained vitro experiments micro-ball demo system shows capability reconstructing representation visual inspection. proposed method works well images current endoscopy devices also perfect capsules multiple cameras larger ﬁeld view like micro-ball. paper organized follows. section endoscopic images related research reviewed brieﬂy. whole problem representation contribution paper given section iii. section image stitching algorithm developed. experimental results presented section finally section concludes paper proposes future work. endoscopic image analysis related work imaging conditions illumination high compression ratio limitations power consumption shortfocal-length camera communication bandwidth storage device affect image quality observing large number histograms endoscopic images seen distribution pixels concentrates certain range intensity bins. fig. shows distribution pixels samples. furthermore striking result emerge investigating pixels whole images dataset pixels fall intensity bins. moreover frequency domain analysis using discrete fourier transform typical images tract shown fig. frequency domain image point represents particular frequency contained spatial domain image. number high frequency components small. means features distinct brings challenges medics interpret engineers process different applications. thousands images aforementioned features recorded physicians inspect. depending experience examiner average time required visual inspection ranges minutes. result unnecessary waste time efforts. literature apart methods directly detect abnormal frames main groups algorithms proposed reduce visual inspection time improve quality examination. first group reduce number images removing redundancy dataset. example registration methodology proposed reduce video length removing similar frames. utilizes segmentation scheme graph method register similar regions consecutive frames. similar work shown image registration sparse graph method yields computation speed order magnitude comparison standard dense graph cut. different study combination intensity correction method method based optical features proposed detect reduce near-duplicate images. objective approach proposed based data reduction algorithm extract representative video frames full length endoscopic images. second group image processing computer vision algorithms produce clearer detailed wider view region interest. information images introduce informative representative. example method proposed facilitate clinical diagnosis building panoramic image bladder using images acquired different viewpoints. consecutive images pairwise registered placed common global coordinate system. recently method automatic construction panoramic visual summaries proposed involves extraction visual features frame frame registration speeded robust features algorithm. according investigation methodologies proposed create interpolated frames smoothing video representation realistic view regions digestive tract surface representation whole tract. method forward based model deformable rings. model processes video characterize capsule’s motion produce rough representation system’s endoluminal surface. novelty model lies shape mesh designed particularly follow speciﬁc type motions. every image registration algorithm requires three basic ingredients spatial transformation model determines possible solutions objective similarity measure estimates quality potential solution optimization algorithm looks best solution therefore whole procedure solve image registration problem formulated following equations adjacent images. transformation parameters lead rotation scale shear shift projection images. small surface deformation highly overlapped frames slow movement camera small displacements consecutive images endoscopic video sequence. therefore possible successfully register image pairs using perspective transformations overlapping parts successive images respectively. usually image registration homologous information extracted images using particular algorithm however lack enough distinct features endoscopic images it’s difﬁcult select meanwhile image deformation negatively affected image registration process. generally homologous structures superimposed optimization procedure opttµ maximizes similarity function minimise dissimilarity. unpredictable motions capsule camera probability successive frames dissimilar relatively high. cases crucial methodology perform registration. order handle cases create decision-making model simple check successive images structural similarity index used. ssim basically shows degree similarity images scaled range ssim higher value ssim however practice investigations needed provide better solution. work focuses developing algorithm address concerns groups i.e. reducing number images dataset well providing wider representation region interest easier inspection. feature-based methods establish correspondence number especially distinct points images geometrical transformation determined target image reference images. main advantages approaches fast robust noises complex geometric distortions signiﬁcant radiometric differences. supremacy sift comparison keypoint detectors/descriptors reported although sift performs best cases unable provide satisfactory result it’s directly applied endoscopic images. thus using sift alone cannot produce optimal results small number correct matches keypoints evenly spread image many outliers exist feature matches. intensity-based methods popular medical image registration employ intensity pixels. mutual information popular measure robustness intensity variation noise high accuracy. indicates linear/non-linear correlation produces consistently sharper peaks correct registration values intensity-based methods important accurate registration. despite general promising results using result misregistration images resolution images contain little information however registration algorithm performs much better starts maximisation normalised accurate initial solution close ground truth. work hybrid algorithm forward based combination intensity-based feature-based method shown best performance images registration. advantages methods employed complement other. based experiments done endoscopic images work normalized cross correlation intensitybased method produces similar results nmi. replaced algorithm overall error slightly surf also tested instead sift. although surf faster sift results obtained using sift accurate results declare combination methods works best endoscopic images someone better results future works changing/modifying method initialization step and/or ﬁne-tuning step. structure algorithm presented initialization step done featurebased method intensity-based method used tune transformation function. similarity therefore registration method applied image pairs whose ssim greater threshold according fig. shows correct rate versus ssim threshold clearly values lower values greater increases. thus based predictable behaviour judgement possible. consequently hybrid registration scheme proposed work preprocessing composed following main stages visualized fig. begin with initial solution transform function obtained preregistration procedure based scale invariant keypoints extracted reﬁned reliable outlier removal. then tuning registration parameters accomplished order maximize paired images. main innovation contribution study summarised follows work proposes efﬁcient automatic algorithm employs robustness feature-based methods accuracy intensity-based methods construct hybrid scheme endoscopic image registration. examining performance best featurebased keypoints detectors/descriptors algorithm i.e. sift algorithm variants widely used outlier removal algorithms wireless endoscopic images dataset best couple selected produce best primary results guarantee preregistration results close enough ground truth. maximization excellent initial solution selection strategy forward using pca-sift mlesac outlier removal coarsest level search stage. registration accuracy improved signiﬁcantly compared standard uses random initial solution. modiﬁcation marquardt-levenberg search strategy multiscale framework exploited reﬁne coarser level registration results reach precise registration parameters maximising nmi. proposed registration strategy besides common wireless endoscopic images tested unique database obtained vitro experiments micro-ball demo system. efﬁcient preprocessing step enhance quality endoscopic images make feature distinct easier examine simple approach proposed used. method histogram information correction edge preserving mask accentuate features interest endoscopic images. rectiﬁcation process transforming acquired image rectiﬁed image resulting overall transformation physical object rectiﬁed image ideal form. distortion correction problem solved efﬁcient approach separate preprocessing step improve quality registration. overcome issue caused random motion micro-ball perspective distortion wireless endoscopic images needs rectiﬁed. several rectiﬁcation methods using advantage reference corners images easy automatically keypoints wireless endoscopic images. fortunately location information given attitude-sensing system embedded micro-ball used solve image rectiﬁcation problem addition sensor includes magnetometer accelerator another attitudesensing sensor worn patient body consists magnetometer accelerator gyroscope. using attitude sensing systems intestine’s orientation driven details available moreover t.r.t.t used obtain realize image correction. although image perspective distortion correction made registration process following perspective transformation function used accurate results. fig. shows result registration image pair without image perspective distortion correction. thus perspective distortion correction registration images obtained micro-ball crucial step. section provides brief overview sift algorithm variants namely pca-sift sift+gc following different steps sift algorithm generating keypoints descriptors scale space creation laplacian gaussian approximation keypoints detection keypoints elimination keypoints orientation descriptors formation. work different editions sift also examined best result application terms time efﬁciency accuracy; sift+gc pca-sift; sift+gc integrates global information sift pcasift applies normalized gradient patch. section performance three scale invariant keypoints detectors investigated pca-sift selected application better performance standard sift sift+gc. although pca-sift good performance used alone image registration many false matches arise. false matches lead incorrect geometric correction. therefore reliable outlier removal procedure needed ensure correct registration. example fig. shows corresponding keypoints image pair post-corrected image ocal respectively roll pitch focal length camera available micro-ball device. coordinate system relative practical plane. invariability physical point coordinates real world obtained. micro-ball endoscopy system captured image plane changeable camera coordinate system problem image geometry correction complex. shown fig. coordinate systems illustrated follows reference frame attitude-sensing system; carrier coordinate system micro-ball; frame camera corrected; frame intestine; frame corresponding image plane captured. takes maximum value images absolutely dependent. registration assumed correspond maximizing images aligned manner amount information contain maximal. formulation giving images register deﬁned continuous domain coordinates samples discrete samples called discrete sets intensities images geometric transformation associated parameters measures degree dependency measuring distance joint distribution distribution associated case complete independence kullbackleibler measure distributions obtained positive scaling factors related card card respectively order control width parzen window work b-spline functions used parzen window. b-spline order generated convolving b-spline order times. piece-wise polynomial integer degree recursively deﬁned following convolution even small estimation errors reduce efﬁciency selection method drastically. practice optimal features usually unknown common irrelevant redundant features beginning process. squared differences corresponding keypoints used measure strength candidate matches. matching process based proximity similarity mismatches often occur. threshold match acceptance deliberately conservative stage minimise incorrect matches. consequently robust methods must also adopted provide good estimate solution even data mismatches correct matches obey epipolar geometry. obtain inliers consistent epipolar geometry using robust technique. case outliers putative matches inconsistent epipolar geometry. ﬁrst criterion indicator ambiguity matching; euclidean distance feature space keypoint input image nearest matched keypoint image euclidean distance second nearest keypoint. close means close certain keypoint input image algorithm detected possible matching keypoints reference image. ambiguous situation matched pair deleted second criterion spatial constraint based external algorithm. following algorithms examined second step eliminate falsely matched keypoints using spatial relationship ransac msac mlesac consequently performance three different scale invariant keypoints detectors accompanied four different outlier removal algorithms examined i.e. totally different cases. results show combination pca-sift mlesac best performance among others application. section experimental results shown. based experimental results reliable keypoints extracted pca-sift-mlesac used form initial transform function used next step proposed method improvement. main characteristics distinguish dependency measures first capacity measuring kind relationship variables; second invariance space transformations. images change uncertainty image values therefore marginal entropies result change alignment measure. maximisation seeks transformation joint entropy minimised respect marginal entropies. multiscale framework multiscale framework solution solve problem high computation cost. task ﬁrst solved coarse scale. then results propagated next ﬁner level used starting guess solving task level. procedure iterated ﬁnest level reached. image pyramid made gradually reduced versions original image. based image size sequence images created different sizes obtained mi+/ ni+/. important initial condition last level best possible order reduce amount reﬁnement necessary reach convergence. optimal starting conditions crucial coarse levels pyramid represent ﬁnest level. cases whole overlap subband images images computed level maximized successively search performed interval around optimal transformation parameters found previous level reﬁned next level. thus accuracy search increases coarse resolution resolution. level iteration stops maximum number iterations achieved sufﬁcient search converge registration parameters subpixel accuracy based experiments. search strategy multiscale framework suitable optimizer desired converges criterion evaluations initialized good starting conditions. levenberg-marquardt algorithm iterative technique locates minimum multivariate function expressed squares non-linear real-valued functions. become standard technique non-linear least-squares problems widely adopted broad spectrum disciplines. thought combination steepest descent gauss-newton method. current solution correct algorithm behaves like steepest descent method slow guaranteed converge. current solution close correct solution becomes gauss-newton method. deﬁned matrix also given second derivative convergence optimum guaranteed converge saddle point. even worse diverges desired solution problem convex. modiﬁcation marquardtlevenberg proposed exhibits superlinear convergence close enough optimum. speciﬁcally designed optimizer introduce modiﬁed hessian retain off-diagonal entries multiply diagonal entries factor. following subsections performance ﬁrst steps algorithm namely keypoints detection outlier removal examined then accuracy proposed algorithm veriﬁed quantitatively visually show algorithm would help reach goal constructing reconstruction small intestinal tract. results based ﬁrst dataset except fig. images aligned stitched together gradually construct map. however visible seams occur stitching process. order reduce artefacts achieve smooth transition across images mechanism decide pixels weight blend them. work order make transition across images smooth simple effective algorithm proposed used. order blend source image target image points seam intensity differences points images pixel source image. intensity differences pixel computed section results experimental analysis given evaluate overall performance proposed algorithm. implementations carried using matlab intel xeron .ghz ram. datasets considered. ﬁrst dataset concerns normal endoscopic images internal wall tract different subjects obtained pillcam capsule endoscopy. dataset different subjects totally contains almost colour images size jpeg format. second dataset based scenario considers simulation micro-ball performance since device currently available prototype diameter dataset scenario consists images size obtained experiment moving micro-ball cylinder. although simulation surface deformation tract neglected experiment surface deformation tract impact image stitching considered work. micro-ball placed transparent soft ﬂexible plastic pipe images captured micro-ball moving rotating slow-moving pipe. outer wall pipe covered reference picture. similarly approach observation image sequences subjects used estimate actual movement micro-ball inside small bowel. rotation occurrence frequency approximately deduced perspective changes image sequences. simulated movement obtained altering translation frequency average translation distance rotation occurrence frequency adjust prototype actual size translation frequency average translation distance rotation occurrence frequency real situation simulation number remaining correct matches remaining false matches correct matches respectively. experimental results shown table follows mlesac reliable methods different keypoint detectors capable removing false matches tested datasets. illustrative example shown fig. number correct false matches calculated statistically visual inspection. pca-sift performs better sift sift+gc intended application. thus combination mlesac pca-sift promising approach detect reliable scaleinvariant keypoints input maximizes nmi. observing results table correct rate expectedly increased cases applying image enhancement method. evaluate registration performance ground truth required compare obtained registration parameters. therefore different pairs images generated cropping manipulating real endoscopic images different overlap ratios. thereafter registration accuracy criterion computed mean euclidean distance homologous pixels target images registered images. computation time registration accuracy terms mean standard deviation image pairs different methods shown table seen results table proposed algorithm shows better performance compared results either pca-sift nmi. although computation time increased second average accuracy improved signiﬁcantly compared pca-sift. analogously comparing proposed method shows good improvement terms time accuracy. proposed algorithm sets consecutive images obtained conventional wireless capsule endoscopy. fig. segments representation stitched consecutive images shown. many cases examined generate wider map; however many regions covered cameras segments tract able reconstruct instead image whole intestinal tract. wireless capsule endoscopy devices equipped cameras never provide enough information enable reconstruction full view intestinal tract. reconstruction method relies overlapping areas paired images coverage rate intestine’s interior wall traditional wireless capsule devices could provide enough information reconstruction whole intestinal tract limited visual ﬁeld abnormal region found fig. reveals arteriovenous malformation active bleeding conﬁrmed physicians indicates proposed method could perform well show surroundings abnormal region efﬁcient diagnosis. proposed algorithm able create continues representing whole area tract explained above however registration successive images contain similar information reduction total number images dataset. since control movement wireless capsule endoscopy random movement causes producing redundant data stops moving still captures images region repeatedly. proposed algorithm registering similar version method works best someone better results future changing method initialization step and/or ﬁne-tuning step. structure algorithm presented initialization step done feature-based method intensity-based method used tune transformation function. second proposed registration strategy besides common wireless endoscopic images tested unique database obtained vitro experiments micro-ball demo system. algorithm successful construct whole inner wall vitro experiment also many regions tract using real endoscopic images. construction whole tract possible real endoscopic images algorithm limitations endoscopy devices i.e. high data missing rate location information smart imaging strategy etc. results signiﬁcance challenging task endoscopic image registration different applications. third noted work produce improvement registration algorithm whole workﬂow high importance wireless endoscopy ﬁeld. fact using capability developed smart micro-ball construct whole inner wall also promising result future wireless endoscopy devices multiple cameras. fully automatic image registration approach proposed paper register endoscopic images construct representation small intestine’s interior wall. proposed method based maximization normalised mutual information consecutive images. aiming this initial solution search strategy obtained pca-sift algorithm equipped mlesac outlier removal. then multiscale framework algorithm tries best transformation parameters registration gradually form whole map. method examined different datasets registration accuracy computation time satisfying. future work plan reduce computation time searching salient initial solution ﬁrst stage without outlier removal algorithms adding high performance computing hardware gpu. moreover tract wall soft live object texture changes slightly examination also important consider image deformation issue endoscopic image registration. another objective extend methodology process every images time several images lead higher quality reconstructed map. fig. sample sets consecutive images captured different regions intestinal wall. images registered proposed method image second represents whole information image ﬁrst row. adjacent images considerably reduces number images. instance fig. shows sets successive images almost region small intestinal wall. running proposed algorithm sets output image information images shown fig. running proposed method implementation second dataset taken moving micro-ball cylinder shown fig. proves proposed method together micro-ball successful make entire ﬁeld view possible minutes error accumulation pixels without affecting visual registration quality compared reference image shown fig. microball makes impossible goal possible image represents whole information dataset. provides unique wide area visualization observation examination performed efﬁcient way. besides clinical point view valuable observe region interest surrounding area without passing image another. importance work included limited following items first work proposes efﬁcient automatic algorithm employs robustness featurebased methods accuracy intensity-based methods construct hybrid scheme endoscopic image registration. results show arrangement different groups image registration algorithm successful. current yuan q.-h. meng bleeding frame region detection wireless capsule endoscopy video ieee journal biomedical health informatics vol. bruaene looze hindryckx small bowel capsule endoscopy almost years use? world journal gastrointestinal endoscopy vol. weibel daul wolf r¨osch ben-hamadou endoscopic bladder image registration using sparse graph cuts ieee international conference image processing ieee bergen wittenberg stitching surface reconstruction endoscopic image sequences review applications methods ieee journal biomedical health informatics vol. m.-h. meng wang chan wireless robotic capsule endoscopy state-of-the-art challenges intelligent control automation wcica fifth world congress vol. ieee wang wang research representation method wireless micro-ball endoscopic images annual international conference ieee engineering medicine biology society ieee attar zhang wang wireless microball endoscopic image enhancement using histogram information annual international conference ieee engineering medicine biology society ieee sukthankar pca-sift distinctive representation local image descriptors computer vision pattern recognition cvpr proceedings ieee computer society conference vol. ieee zhang zheng wong poon automatic detection classiﬁcation colorectal polyps transferring low-level features nonmedical domain ieee journal biomedical health informatics vol. segu´ı drozdzal zaytseva malagelada azpiroz radeva vitria detection wrinkle frames endoluminal videos using betweenness centrality measures images ieee journal biomedical health informatics vol. karargyris bourbakis video-frame based registration using segmentation graph connectivity wireless capsule endoscopy life science systems applications workshop lissa ieee/nih ieee miranda-luna daul blondel hernandez-mier wolf guillemin mosaicing bladder endoscopic image sequences distortion calibration registration algorithm ieee transactions biomedical engineering vol. spyrou diamantis iakovidis panoramic visual summaries efﬁcient reading capsule endoscopy videos semantic social media adaptation personalization international workshop ieee karargyris bourbakis three-dimensional reconstruction digestive wall capsule endoscopy videos using elastic video interpolation ieee transactions medical imaging vol. pluim maintz viergever image registration maximization combined mutual information gradient information international conference medical image computing computer-assisted intervention springer thevenaz unser spline pyramids intermodal image registration using mutual information optical science engineering instrumentation’ international society optics photonics froehlich patak weymarn juli zollikofer k.-u. wentz small bowel motility assessment magnetic resonance imaging journal magnetic resonance imaging vol.", "year": "2018"}