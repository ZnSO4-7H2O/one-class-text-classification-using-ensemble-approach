{"title": "Densely Connected Pyramid Dehazing Network", "tag": "eess", "abstract": " We propose a new end-to-end single image dehazing method, called Densely Connected Pyramid Dehazing Network (DCPDN), which can jointly learn the transmission map, atmospheric light and dehazing all together. The end-to-end learning is achieved by directly embedding the atmospheric scattering model into the network, thereby ensuring that the proposed method strictly follows the physics-driven scattering model for dehazing. Inspired by the dense network that can maximize the information flow along features from different levels, we propose a new edge-preserving densely connected encoder-decoder structure with multi-level pyramid pooling module for estimating the transmission map. This network is optimized using a newly introduced edge-preserving loss function. To further incorporate the mutual structural information between the estimated transmission map and the dehazed result, we propose a joint-discriminator based on generative adversarial network framework to decide whether the corresponding dehazed image and the estimated transmission map are real or fake. An ablation study is conducted to demonstrate the effectiveness of each module evaluated at both estimated transmission map and dehazed result. Extensive experiments demonstrate that the proposed method achieves significant improvements over the state-of-the-art methods. Code will be made available at: https://github.com/hezhangsprinter ", "text": "image degradation presence haze mathematically formulated observed hazy image true scene radiance global atmospheric light indicating intensity ambient light transmission pixel location. transmission distance-dependent factor affects fraction light reaches camera sensor. atmospheric light homogeneous transmission expressed e−βd represents attenuation coefﬁcient atmosphere scene depth. single image dehazing given goal estimate observed exists important aspects dehazing process accurate estimation transmission accurate estimation atmospheric light. apart several works focus estimating atmospheric light algorithms concentrate accurate estimation transmission leverage empirical rule estimating atmospheric light mainly common belief good estimation transmission lead better dehazing. methods broadly divided main groups priorbased methods learning-based methods. prior-based methods often leverage different priors characterizing transmission dark-channel prior contrast color-lines haze-line prior learningbased methods based convolutional neural networks attempt learn transmission dipropose end-to-end single image dehazing method called densely connected pyramid dehazing network jointly learn transmission atmospheric light dehazing together. endto-end learning achieved directly embedding atmospheric scattering model network thereby ensuring proposed method strictly follows physicsdriven scattering model dehazing. inspired dense network maximize information along features different levels propose edge-preserving densely connected encoder-decoder structure multi-level pyramid pooling module estimating transmission map. network optimized using newly introduced edge-preserving loss function. incorporate mutual structural information between estimated transmission dehazed result propose joint-discriminator based generative adversarial network framework decide whether corresponding dehazed image estimated transmission real fake. ablation study conducted demonstrate effectiveness module evaluated estimated transmission dehazed result. extensive experiments demonstrate proposed method achieves signiﬁcant improvements state-of-the-art methods. code made available https//github.com/hezhangsprinter severe hazy conditions ﬂoating particles atmosphere dusk smoke greatly absorb scatter light resulting degradations image quality. degradations turn affect performance many computer vision systems classiﬁcation detection. overcome degradations caused haze image video-based haze removal algorithms proposed literature progressively optimize part network jointly optimize entire network. make sure estimated transmission preserves sharp edges avoids halo artifacts dehazing edge-preserving loss function proposed paper based observation gradient operators ﬁrst several layers structure function edge extractors. furthermore densely connected encoder-decoder network multilevel pooling modules proposed leverage features different levels estimating transmission map. exploit structural relationship transmission dehazed image joint discriminator-based generative adversarial network proposed. joint discriminator distinguishes whether pair estimated transmission dehazed image real fake pair. guarantee atmospheric light also optimized within whole structure u-net adopted estimate homogeneous atmospheric light map. shown fig. sample dehazed image using proposed method. paper makes following contributions novel end-to-end jointly optimizable dehazing network proposed. enabled embedding directly optimization framework math operation modules. thus allows network estimate transmission atmospheric light dehazed image jointly. entire network trained stage-wise learning method. edge-preserving pyramid densely connected encoder-decoder network proposed accurately estimating transmission map. further optimized newly proposed edge-preserving loss function. structure estimated transmission dehazed image highly correlated leverage joint discriminator within framework determine whether paired samples data distribution not. extensive experiments conducted synthetic datasets real-world image dataset. addition comparisons performed several recent state-of-the-art approaches. furthermore ablation study conducted demonstrate improvements obtained different modules proposed network. related work single image dehazing. single image dehazing highly ill-posed problem. various handcrafted prior-based learning-based methods developed tackle problem. figure overview proposed dcpdn image dehazing method. dcpdn consists four modules pyramid densely connected transmission estimation net. atmospheric light estimation net. dehazing joint discriminator. ﬁrst estimate transmission using proposed pyramid densely-connected transmission estimation followed prediction atmospheric light using u-net structure. finally using estimated transmission atmospheric light estimate dehazed image though tremendous improvements made learning-based methods several factors hinder performance methods results optimal. mainly because inaccuracies estimation transmission translates quality dehazed result. existing methods leverage end-toend learning unable capture inherent relation among transmission atmospheric light dehazed image. disjoint optimization hinder overall dehazing performance. recently method proposed jointly optimize whole dehazing network. achieved leveraging linear transformation embed transmission atmospheric light variable learning light-weight recover clean image. paper take different approach addressing end-to-end learning image dehazing. particular propose image dehazing architecture called densely connected pyramid dehazing network jointly optimized estimate transmission atmospheric light also image dehazing simultaneously following image degradation model words end-to-end learning achieved embedding directly network math operation modules provided deep learning framework. however training complex network challenging. ease training process accelerate network convergence leverage stage-wise learning technique ﬁrst handcrafted prior-based fattal proposed physicallygrounded method estimating albedo scene. images captured hazy conditions always lack color contrast proposed patch-based contrast-maximization method. kratz nishino proposed factorial model estimate albedo depths ﬁled. inspired observations outdoor objects clear weather least color channel signiﬁcantly dark proposed dark-channel model estimate transmission map. recently fattal proposed color-line method based observation small image patches typically exhibit one-dimensional distribution color space. similarly berman proposed non-local patch prior characterize clean images. learning-based unlike mentioned methods different priors estimate transmission introduce end-to-end network estimating transmission novel brelu unit. recently proposed multi-scale deep neural network estimate transmission map. limitations methods limit capabilities considering transmission frameworks. address issue proposed all-in-one dehazing network linear transformation leveraged encode transmission atmospheric light variable. recently several benchmark datasets synthetic real-world hazy images dehazing problems introduced community generative adversarial networks notion ﬁrst proposed goodfellow synthesize realistic images effectively learning distribution training images game theoretic min-max optimization framework. success gans synthesizing realistic images researchers explore adversarial loss various low-level vision applications text-to-image synthesis image-image translation applications inspired success methods generating high-quality images details propose joint discriminator-based reﬁne estimated transmission dehazed image. proposed dcpdn network architecture illustrated fig. consists following four modules pyramid densely connected transmission estimation atmosphere light estimation dehazing joint discriminator. follows explain modules detail. pyramid densely connected transmission estimation network. inspired previous methods multi-level features estimating transmission propose densely connected encoderdecoder structure makes features multiple layers dense block used basic structure. reason dense block lies maximize information along features guarantee better convergence connecting layers. addition multi-level pyramid pooling module adopted reﬁne learned features considering ‘global’ structural information optimization leverage pre-deﬁned weights dense-net adopt ﬁrst conv layer ﬁrst three denseblocks corresponding down-sampling operations transition-blocks pre-trained dense-net encoder structure. feature size encoding part input size. reconstruct transmission original resolution stack dense blocks reﬁned up-sampling transition-blocks decoding module. addition concatenations employed features corresponding dimension. even though proposed densely connected encoderdecoder structure combines different features within network result densely connected structure still lack ‘global’ structural information objects different scales. possible reason features different scales used directly estimate ﬁnal transmission map. efﬁciently address issue multi-level pyramid pooling block adopted make sure features different scales embedded ﬁnal result. inspired global context information classiﬁcation segmentation tasks rather taking large pooling size capture global context information different objects ‘local’ information characterize ‘global’ structure object needed. hence four-level pooling operation pooling sizes adopted. then four level features up-sampling original feature size concatenated back original feature ﬁnal estimation. gives overview proposed pyramid densely connected transmission estimation network. atmospheric light estimation network. following image degradation model eq.; assume atmospheric light homogeneous similar previous works predicted atmospheric light uniform given image. words predicted d-map pixel value constant). result ground truth feature size input image pixels ﬁlled value. estimate atmospheric light adopt -block u-net structure encoder composed four conv-bn-relu blocks decoder composed symmetric dconv-bn-relu block dehazing bridge relation among transmission atmospheric light dehazed image make sure whole network structure jointly optimized three tasks directly embed overall optimization framework. overview entire dcpdn structure shown denote networks generate transmission dehazed result respectively. reﬁne output make sure estimated transmission dehazed image indistinguishable corresponding ground truths respectively make novel joint discriminator. figure feature visualization gradient operator low-level features. input transmission map. horizontal gradient output. vertical gradient output. visualization feature maps relu vgg- dehazed image highly correlated. hence order leverage dependency structural information modalities introduce joint discriminator learn joint distribution decide whether corresponding pairs real fake. leveraging joint distribution optimization structural correlation better exploited. similar previous works predicted air-light uniform given image. words predicted air-light d-map pixel value propose following joint-discriminator based optimization commonly acknowledged euclidean loss tends blur ﬁnal result. hence inaccurate estimation transmission loss result loss details leading halo artifacts dehazed image efﬁciently address issue edge-preserving loss proposed motivated following observations. edges corresponds discontinuities image intensities hence characterized image gradients. known low-level features edges contours captured shallow layers structure words ﬁrst layers function edge detector deep network. example transmission pre-deﬁned vgg- model certain features output layer relu visualized clearly observed edge information preserved corresponding feature maps figure transmission estimation results using different modules. ded; ded-mlp; .ded-mlp-gra; ded-mlpep; dcpdn; target. observed multi-level pooling module able reﬁne better global structure objects image edge-preserving loss preserve much sharper edges ﬁnal joint-discriminator better reﬁne detail small objects based observations inspired gradient loss used depth estimation well perceptual loss low-level vision tasks propose edge-preserving loss function composed three different parts loss two-directional gradient loss feature edge loss deﬁned follows composed edge-preserving loss composed traditional loss predicting atmospheric light represents dehazing loss also composed loss only. denoted joint discriminator loss deﬁned follows log) log). experiments found directly training whole network scratch complex loss difﬁcult network converges slowly. possible reason gradient diffusion caused different tasks. example gradients de-hazed image loss ‘distract’ gradients loss transmission initially resulting slower convergence. address issue speed training stage-wise learning strategy introduced used different applications multi-model recognition feature learning hence information training data presented network gradually. words different tasks learned progressively. firstly optimize task separately updating task simultaneously. ‘initialization’ task ﬁne-tune whole network together optimizing three tasks jointly. section demonstrate effectiveness proposed approach conducting various experiments synthetic datasets real-world dataset. results compared state-of-the-art methods berman addition conduct ablation study demonstrate effectiveness module network. similar existing deep learning-based dehazing methods synthesize training samples {hazy /clean /transmission /atmosphere light} based synthesis four atmospheric light conditions scattering coefﬁcient randomly sampled generate corresponding hazy images transmission maps atmospheric light maps. random images selected nyu-depth dataset generate training set. hence total training images denoted traina. similarly test dataset testa consisting images also nyu-depth obtained. ensure none testing images training set. demonstrate generalization ability network datasets synthesize {hazy /clean /transmission /atmosphere light} images middlebury stereo choose loss estimating transmission optimizing joint discriminator. training adam optimization algorithm learning rate generator discriminator batch size training samples resized trained network iterations. parameters chosen cross-validation. iments densely connected encoder decoder structure densely connected encoder decoder structure multi-level pyramid pooling densely connected encoder decoder structure multi-level pyramid pooling using loss gradient loss densely connected encoder decoder structure multi-level pyramid pooling using edge-preserving loss proposed dcpdn composed densely connected encoder decoder structure multi-level pyramid pooling using edge-preserving loss joint discriminator evaluation performed synthesized testa testb datasets. ssim results averaged estimated transmission maps dehazed images various conﬁgurations tabulated table visual comparisons shown make following observations proposed multi-level pooling module able better preserve ‘global’ structural objects relatively larger scale compared edge-preserving loss able better reﬁne edges estimated transmission compared ﬁnal joint-discriminator enhance estimated transmission ensuring structural details captured results details small objects table shown demonstrate improvements achieved proposed method compared recent state-ofthe-art methods synthetic real datasets. evaluation synthetic dataset proposed network evaluated synthetic datasets testa testb. since datasets synthesized ground truth images transmission maps available enabling evaluate performance qualitatively well quantitatively. sample results proposed method recent state-of-theart methods sample images test datasets shown fig. observed even though previous methods able remove haze input image tend either dehaze dehaze image making result darker leaving haze result. contrast observed results preserve sharper contours less color distortion visually closer ground-truth. quantitative results tabulated table table evaluated testa testb also demonstrate effectiveness proposed method. evaluation real dataset demonstrate generalization ability proposed method evaluate proposed method several real-world hazy images provided previous methods challenging hazy images downloaded internet. results four sample images obtained previous methods shown fig. revealed fig. methods tend leave haze results methods tend darken regions methods berman method competitive visual results. however looking closer observe berman produce unrealistic color shifts building color fourth row. contrast method able generate realistic colors better removing haze. seen comparing ﬁrst second row. also evaluate several hazy images downloaded internet. dehazed results shown fig. seen results outputs berman suffer color distortions shown second third rows. contrast presented end-to-end deep learning-based dehazing method jointly optimize transmission atmospheric light dehazed image. achieved directly embedding atmospheric image degradation model overall optimization framework. efﬁciently estimate transmission novel densely connected encoder-decoder structure multi-level pooling module proposed network optimized edge-preserving loss. addition reﬁne details leverage mutual structural correlation dehazed image estimated transmission jointdiscriminator based framework introduced proposed method. various experiments conducted show signiﬁcance proposed method.", "year": "2018"}