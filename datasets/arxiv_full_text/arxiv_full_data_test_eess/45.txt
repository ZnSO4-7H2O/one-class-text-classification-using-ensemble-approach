{"title": "Propagation based phase retrieval of simulated intensity measurements  using artificial neural networks", "tag": "eess", "abstract": " Determining the phase of a wave from intensity measurements has many applications in fields such as electron microscopy, visible light optics, and medical imaging. Propagation based phase retrieval, where the phase is obtained from defocused images, has shown significant promise. There are, however, limitations in the accuracy of the retrieved phase arising from such methods. Sources of error include shot noise, image misalignment, and diffraction artifacts. We explore the use of artificial neural networks (ANNs) to improve the accuracy of propagation based phase retrieval algorithms applied to simulated intensity measurements. We employ a phase retrieval algorithm based on the transport-of-intensity equation to obtain the phase from simulated micrographs of procedurally generated specimens. We then train an ANN with pairs of retrieved and exact phases, and use the trained ANN to process a test set of retrieved phase maps. The total error in the phase is significantly reduced using this method. We also discuss a variety of potential extensions to this work. ", "text": "determining phase wave intensity measurements many applications ﬁelds electron microscopy visible light optics medical imaging. propagation based phase retrieval phase obtained defocused images shown signiﬁcant promise. however limitations accuracy retrieved phase arising methods. sources error include shot noise image misalignment diﬀraction artifacts. explore artiﬁcial neural networks improve accuracy propagation based phase retrieval algorithms applied simulated intensity measurements. employ phase retrieval algorithm based transport-of-intensity equation obtain phase simulated micrographs procedurally generated specimens. train pairs retrieved exact phases trained process test retrieved phase maps. total error phase signiﬁcantly reduced using method. also discuss variety potential extensions work. employed enable fast accurate computation exit surface waveﬁeld using single in-line hologram. method utilized experimental training data using visible light training pairs consisting complex waveﬁeld obtained single in-line hologram input corresponding waveﬁeld obtained using eight image iterative phase retrieval algorithm target ann. process labor intensive would typically result small volume training data method improves utilizing procedurally generated specimen simulations produce large volume training data. also enables scaled projected potential used directly target phase resulting training data whose accuracy limited precision resolution used simulations. wavenumber transverse gradient longitudinal derivative operator intensity evaluated image plane intensity phase respectively image plane. solved numerically using fourier transform method giving propagation based phase retrieval reconstructs exit phase specimen out-of-focus intensity images. applicable many optical modalities phase retrieval techniques used visible light x-ray electron neutron optics achieved using variety techniques linear phase retrieval algorithms signiﬁcant performance advantages iterative methods often come disadvantages poor noise-stability artiﬁcial neural networks found application ﬁelds natural language processing game playing medical imaging employ improve accuracy propagationbased phase retrieval algorithm based transportof-intensity equation technique described utilizes training data comprising pairs exact retrieved phases obtained specimen simulations procedurally generated training data used iteratively optimize model applied test retrieved phases resulting output phases signiﬁcantly improved accuracy. anns employed solve dimensional dimensional phase retrieval problems. work focused high parallelizability neural networks consequent fast convergence properties relative conventional iterative approaches. recently anns employed analyze convergent beam electron diﬀraction patterns method utilizes improve accuracy phase retrieval algorithms. work require priori knowledge phase retrieval purposes generating training data performing initial phase recovery easily generalizable wide variety phase retrieval techniques. rivenson hidden layer. non-linear function applied pointwise output given layer. hyperbolic tangent activation function. choice initialization weights biases reasonable ideal output quantitatively similar input initialization causes output untrained similar input diﬀerence scaling activation function. parameter known learning rate. backpropagation used compute gradients. simulations consider phase retrieval context electron microscopy. training data consists pairs exact retrieved phases. specimen training example randomly generated using python script conjunction blender built-in python api. achieved spawning cube size location rotation chosen uniform pseudo-random distribution implementing geometry modiﬁers included api. exact phase specimen computed projecting electrostatic potential electron propagation direction. simulate attenuation include imaginary part potential; specifically potential constant throughout specimen. compute retrieved phases under- over-focus images simulated using transfer function formalism. image size electron accelerating voltage shot noise level added micrographs ﬁrst training using technique described second training generated using methods ﬁrst increased exacerbate blurring retrieved phases. micrographs remain noise-free purposes testing neural network systematic phase retrieval errors. equation used retrieve phase images. simulated micrographs ﬁrst specimen ﬁrst training shown fig. corresponding exact retrieved phases shown fig. exact retrieved phases prepared gradient descent performed using batches pairs each optimization process runs epochs. implemented using tensorflow /|k| δint δtie respective regularization parameters—is used work. δint .iin δtie incident intensity width image units length pixels respectively. intensity derivative computed using ﬁnite diﬀerence approximation ϕret exact retrieved phases respectively. improve sampling fourier space apodize images circular window function radius equation computed circular region. calculate average error collection test phases take mean fully connected feedforward employs series aﬃne transforms applied input vector produce output. transform consisting weight matrix bias vector referred layer. case input retrieved phase output improved approximation ϕout true phase shift refer adjusted phase. input output vectors length obtained ﬂattening phase maps. work resulting form weights biases layer respectively. hidden layer nodes. initialize weights rectangular diagonal unit matrix transpose biases zero vectors. model nonlinear eﬀects activation function must applied test eﬀectiveness prepared test hundred exact/retrieved phase pairs using methods training using randomly generated specimens. trained noisy applied retrieved phases. results three example pairs test shown fig. calculated mean error entire test using found ¯erms ¯erms retrieved adjusted phases respectively. trained noise-free training used process test retrieved noise-free phases. mean error reduced erms ¯erms set. example test pair along adjusted phase shown fig. error small difﬁcult discern diﬀerences total phases also provide errors themselves gray scale range scaled accordingly. shown fig. large component total error retrieved phase constant oﬀset. determine signiﬁcant contribution also using corrected phases training test data noise-free case. correction performed subtracting mean error retrieved phases. mean errors test case retrieved adjusted phases respectively. demonstrates eﬀective removing oﬀset ameliorating defocusinduced errors. results presented provide powerful means error reduction propagation based phase retrieval using noisy images show signiﬁcant promise noise-free case. training simply requires sufﬁcient volume simulated training data generated based knowledge experimental parameters defocus noise level. unknown parameters randomly varied within reasonable ranges training data. increase required number training examples probably complexity require altering process fundamental way. work choice hyperparameters mostly arbitrary. nonetheless results presented extremely promising suggesting rigorous tuning hyperparameters could reduce errors further. achieved using manual algorithmic optimization methods training multiple times using diﬀerent sets hyperparameters minimizing error validation results show anns eﬀective reducing errors phase retrieval random noise systematic errors—the latter comprising range errors inherent numerical implementation truncation errors arising sampling errors deviations regularization. error retrieved phase using depends strongly chosen defocus. signal-to-noise ratio increases defocus increases comes cost diﬀractioninduced blurring thus choice defocus typically compromise eﬀects. although address work broad categories errors adjusted phases vary defocus likely eﬀectiveness method diﬀerent respective types error. implies optimal defocus processing retrieved phases using would general different retrieved phase itself. method performs best stochastic errors small defocus chosen decreasing reducing systematic errors diﬃcult remove using ann. conversely systematic errors eﬀectively removed much larger defocus chosen resulting greater defocus-induced errors ameliorated maximizing snr. ﬂexibility approach suggests applicable variety error sources addressed here. example electron micrographs crystalline specimens contain delocalization artifacts artifacts avoided selection appropriate objective aperture choosing crystal orientations minimize eﬀects. however vector tomographic applications least orthogonal tilt series required angle-limiting apertures mechanically obstructed high tilt approaches impractical. delocalization artifacts deterministic highly sensitive crystal orientation therefore diﬃcult precisely predict arbitrary orientations. signiﬁcantly complicates inverse problem reconstructing projected potentials electron micrographs purposes vector tomographic reconstruction proposed solution problem published. pattern recognition capabilities anns immense utility solving problems. another consideration relating vector tomographic applications methods described work generalize higher dimensions reconstruction algorithms enabling applied reconstructed vector scalar ﬁelds contain signiﬁcant errors note however large amount data three dimensional ﬁeld would require corresponding increase complexity neural network least terms number nodes layer would make methods computationally infeasible current standard desktop computing hardware. however thorough performance analysis would required ascertain whether methods applied vector ﬁelds using specialized computing hardware graphics processing unit tensor processing unit clusters. anns phase retrieval much broader implications addressed simulations. preliminary work demonstrated promise using defocused images directly input vector bypassing phase retrieval step entirely. could provide significant advantage avoiding many causes errors phase retrieval rather ameliorating post hoc. also allows perform necessary alignment micrographs—which required shifts in-plane rotations scaling images—negating need implementing image registration algorithms potentially incurring additional errors. avenue explore future convolutional neural networks type network used rivenson conjuction methods. employs additional layers apply convolutions input data detect image features. cnns widely used computer vision applications autonomous driving handwritten character recognition convolutional nature numerical implementation excellent pattern recognition capabilities cnns signiﬁcant beneﬁts type used present work means extracting phase information directly defocused intensity measurements. abadi agarwal barham brevdo chen citro corrado davis dean devin tensorflow large-scale machine learning heterogeneous systems software available www.tensorflow.org. john mita pedestrian detection thermal images using adaptive fuzzy c-means clustering convolutional neural networks machine vision applications iapr international conference cires˛an meier gambardella schmidhuber convolutional neural network committees handwritten character classiﬁcation document analysis recognition international conference burian kuosmanen saarinen rusu dimensional phase retrieval using neural networks neural networks signal processing proceedings ieee signal processing society workshop vol. lebeau deep convolutional neural network analyze position averaged convergent beam electron diﬀraction patterns arxiv. rivenson zhang gunaydin teng ozcan phase recovery holographic image reconstruction using deep learning neural networks arxiv.", "year": "2017"}