{"title": "Ultrasonic Tissue Reflectivity Function Estimation Using Correlation  Constrained Multichannel FLMS Algorithm with Missing RF Data", "tag": "eess", "abstract": " Poor resolution of ultrasound images due to convolution of the tissue reflectivity function (TRF) with the system point spread function (PSF) is a major issue in medical ultrasound imaging. In this paper, we propose a correlation constrained missing-data estimation based blind multichannel frequency- domain least-mean-squares (md-bMCFLMS) algorithm to undo the effect of PSF on the ultrasound radio-frequency (RF) data. In the first step, a block-based MCFLMS (bMCFLMS) algorithm is proposed to estimate the TRFs and the PSF which are used in the second step to estimate the missing data. This missing data is used in the md-bMCFLMS algorithm to construct a modified cost function for further improvement of the image resolution. To account for the nonstationarity of the PSF, unlike the blocking approach described in the literature, we introduce a time-efficient blocking method in this paper. The blocking approach described here uses a block position independent fixed size matrix and can be implemented parallely. The bMCFLMS algorithm, however, shows misconvergence due to both channel noise and propagation of TRF estimation error from the previous blocks. This phe- nomenon is more intense in the case of md-bMCFLMS algorithm because of increased estimation error. To address this problem, a novel constraint based on the correlation between the measured RF data and estimated TRF is proposed in this paper. The efficacy of our proposed blind deconvolution algorithm is measured using simulation phantom, experimental phantom and in-vivo data. ", "text": "suitable model measured ultrasound data development effective deconvolution technique ultrasound images. ultrasound imaging transmitted ultrasonic pulse reﬂected randomly distributed scatterers present tissue received transducer array generate diagnostic image. considering scattering pulse tissue weak ﬁrst order born approximation consider tissue scattering system linear system. therefore model received signal convolution transfer function scattering system process blurring introduced data psf. number algorithms proposed literature deconvolve received data thereby restore image resolution. algorithms classiﬁed groups. ﬁrst group estimates ﬁrst classical deconvolution algorithm applied estimate trfs. methods based homomorphic ﬁltering involves ﬁltering either cepstrum domain magnitude domain algorithms elegant sense simple implemented real-time. filtering wavelet coefﬁcients magnitude spectrum gives better result terms mean square error cepstrum based methods however tuning length ﬁlter cepstrum domain selecting decomposition level wavlet decomposition determines smoothness estimated hence overall deconvolution accuracy. addition category techniques assume spectrum separate spectral band completely true minimum phase assumption applied here satisﬁed general moreover inaccuracy phase unwrapping poses another problem algorithms solve problem phase unwarping recent hybrid parametric inverse ﬁltering algorithm proposed estimates steps. first partial information i.e. power spectrum estimated using homomorphic ﬁltering. partial information obtained used constraint shape inverse ﬁlter. linearity inverse ﬁlter exploited recover phase psf. however method energy inverse ﬁlter regularized avoid instability zero magnitude. ﬁnite number coefﬁcients using abstract—poor resolution ultrasound images convolution tissue reﬂectivity function system point spread function major issue medical ultrasound imaging. paper propose correlation constrained missing-data estimation based blind multichannel frequencydomain least-mean-squares algorithm undo effect ultrasound radio-frequency data. ﬁrst step block-based mcflms algorithm proposed estimate trfs used second step estimate missing data. missing data used md-bmcflms algorithm construct modiﬁed cost function improvement image resolution. account nonstationarity unlike blocking approach described literature introduce time-efﬁcient blocking method paper. blocking approach described uses block position independent ﬁxed size matrix implemented parallely. bmcflms algorithm however shows misconvergence channel noise propagation estimation error previous blocks. phenomenon intense case md-bmcflms algorithm increased estimation error. address problem novel constraint based correlation measured data estimated proposed paper. efﬁcacy proposed blind deconvolution algorithm measured using simulation phantom experimental phantom in-vivo data. proposed md-bmcflms algorithm shows normalized projection misalignment improvement resolution gain improvement compared techniques literature. moreover frequency-domain implementation computationally efﬁcient fast converging robust time-domain counterpart l-bmclms algorithm reported literature. index terms—blind deconvolution ultrasound image simo model axial blocking multichannel flms missing data misconvergence correlation constraint. nature made popular medical diagnostics added beneﬁts real-time imaging cost portability compared x-ray magnetic resonance imaging imaging modalities. however clinical ultrasound images often difﬁcult interpret blurring speckle noise contrast different soft tissues point spread function ultrasound imaging system introduces blurring thereby degrades resolution ultrasonic images. removal effect ultrasound images fourier basis cannot properly represent ﬁnite support psf. solve problem fourier basis replaced complex exponentials compact support nevertheless properly represent psf. second group algorithms estimates trfs simultaneously. among blind deconvolution method described improves convergence speed reduces computational load projecting null space correlation matrix onto space spanned third-order b-spline wavlet basis. however presence noise thresholding necessary determine null space bases. another classical algorithm iterative blind deconvolution suffers poor convergence property. parametric methods group depend accurately parameters represent ultrasound imaging system. addition extremely complex composition biological tissues derivation convenient accurate model in-vivo possible lately block-based blind deconvolution method time-domain using multichannel algorithm presented estimates trfs block block account nonstationarity psf. blocking procedure described time-domain method uses convolution matrix segmentation thereby applicable convolution. therefore algorithm computationally inefﬁcient implementation timedomain convolution using matrix multiplication. addition size matrix increases number blocks increases. furthermore suffers misconvergence presence additive white noise propagation estimation error block block. attempt made solve problem using damped variable step-size gradient averaging l-norm constraint. order apply l-norm constraint data assumed sparse generally true case in-vivo data. noise effect minimizing methods described adopted basis misconvergence completely stopped even applying aforesaid noise effect minimization techniques. paper propose missing data estimation based blind deconvolution algorithm frequency-domain correlation constraint noise corrupted ultrasound data. smaller eigenvalue spread frequency-domain approach facilitates faster convergence adaptive algorithms compared time-domain ones moreover variable step-size mcflms algorithm known noise robust unlike blocking procedure described paper introduce blocking technique facilitates make algorithm computationally efﬁcient. however reported crossrelation based blind adaptive algorithms proposed algorithm also suffers misconvergence presence channel noise estimation error previous estimated blocks trfs. overcome problem propose novel noise effect compensating constraint based correlation measured data estimated trfs compensate effect noise estimation error stated above. next estimating missing data estimated using r-mint algorithm manner described estimated trfs used estimate missing data available nature data acquisition ultrasound imaging. estimated missing data used develop md-bmcflms algorithm improve resolution ultrasound images further. performance proposed blind deconvolution techniques evaluated simulation phantom experimental phantom in-vivo data. paper organized follows. section describes simo model ultrasound imaging system. blockbased blind deconvolution algorithm noise effect compensating constraint explained section iii. improvement resolution ultrasound images using estimated missing data discussed section performance md-bmcflms algorithm demonstrated section finally summarizing contributions highlights future research paper concludes section system modeled simo model ultrasound pulse single input lines multiple outputs trfs along axial direction multiple system channels figure shows simo model backscattered ultrasound data ultrasound pulse convolves i-th channel transfer function additive noise measured data given however data sample ultrasound signal results reﬂection ultrasound pulse scatterer tissue reality echo data equal length instead moreover assumes stationary i.e. remains constant penetrating tissue. acquired data long axial direction suffers depth dependent attenuation traveling tissue. nonstationary restricts direct crossrelation based mcflms algorithm blind simo model identiﬁcation deconvolution ultrasound images therefore main challenge ultrasound deconvolution process estimate trfs using truncated nonstationary data corrupted additive white noise. deconvolution process carried frequencydomain obtain robustness noise timedomain along faster convergence facilitated smaller eigenvalue spread reduced computational complexity. note error function becomes zero noiseless condition substituted however shown incomplete data acquisition ultrasound imaging ﬁrst samples error function equal zero. taking account truncated error function matrix form written nonstationarity ultrasound imaging cannot directly used estimate trfs. appropriate solution problem estimate trfs block block error blocks formed shown consider quasi-stationary within particular block. however blocking approach described requires matrix multiplication segments convolution matrix formed data estimated trf. frequency-domain implementation require multiplication error block matrix making algorithm computationally inefﬁcient. unlike propose different blocking approach uses smaller ﬁxed size vector operations applicability thus faster approach. crossrelation error basically difference convolution operations. therefore implement full convolution summation convolutions smaller blocks signals implemented efﬁciently eliminating need using truncation operator well unnecessary computation full convolution details ﬁrst show convolution implemented block block. subsequent discussion used denote truncated data channel number placed subscript block number presented superscript. consider convolution trucated data arbitrary channel estimated data j-th channel given truncated crossrelation error described difference convolutions similar approach described adopted evaluate crossrelation error block block. similar last samples following error function contributes b-th block crossrelation error c˜xp crossrelation error considering p-th block data block data. notice true replaced estimated trf. manner according ﬁrst samples following error function contributes b-th block crossrelation error notice error components constitute b-th block error function computed parallely. third term right side depends b-th block ﬁrst terms depend ˆh··· ˆhb−. estimating b-th block already known therefore treated constant. therefore write multiplication refers unit sample delay represent b-th block i-th channel j-th channel respectively. evident convolution operation splitted smaller convolution blocks identical length. reasons explained consider ﬁrst samples total samples convolution modifying write account nonstationarity problem ultrasound convolution must evaluated smaller blocks samples. smaller convolutions length observe evident ﬁrst samples contributes ﬁrst last samples contributes convolution block next convolution block adding ﬁrst samples second convolution block ﬁrst block represent general idea behind blocking technique explain mathematical operations second convolution block length truncation matrices used take last ﬁrst samples convolution respectively. faf− fourier transform ﬁrst block i-th channel data denotes length convolution fourier transform time-domain becomes multiplication frequency. domain write example denotes m-th iteration estimate variable step-size b-th block. step-size adapted distance becomes minimum iteration noise-free case given details) denotes transpose operation. problem equation need know true b-th block calculate known beforehand. unlike orthogonal function also blocks b-th block. therefore trfs gradient cost function b-th block calculate step-size assumed noise-free case adaptive algorithm. however presence noise avoided practice. well-known noise signiﬁcant impact convergence crossrelation based adaptive algorithms stop misconvergence type algorithms effect noise spectral constraint proposed assumed acoustic channel impulse response spectrally ﬂat. assumption therefore valid trfs. time-domain approach described uses damped variable step-size described gradient averaging l-norm constraint prevent misconvergence. l-norm constraint gives sort robustness noise data sparse. unfortunately sparsity in-vivo data cannot guaranteed. modiﬁed cost function proposed assumed additive noise different channels variance condition satisﬁed practice. thus none techniques generalized address problem misconvergence. work develop generalized approach problem thereby make adaptive algorithm robust noise. denotes additive noise i-th channel error noiseless data error noise. therefore noisy case gradient also components however noise power generally lower desired signal power beginning signal gradient higher noise gradient. thus reduce lower value faster certain instant iteration error values comparable. point noise gradient dominates causes solution misconverge. order prevent algorithm misconverging introduce constraint estimation process somehow restrains noisy gradient. consider following correlation data unity norm constraint applied blocks trfs b-th block among total blocks trfs cost function contains trfs finally inverse fourier transform estimate obtained using result estimate b-th block trf. executing blocks estimate full obtained fig. effect noise convergence bmcflms algorithm behavior curve around misconvergence point ﬁrst block behavior correlation cost function around misconvergence point ﬁrst block. behavior curve around misconvergence point ﬁrst block correlation constraint misconvergence phenomenon second block trfs additive white noise data. misconvergence problem solved second block trfs using correlation constraint. order show corr becomes maximum misconvergence point graphically simulation phantom data described later result section used. fig. misconvergence phenomenon shown simulation ﬁrst data snr. shown fig. block correlation cost function misconvergence point decreases. therefore misconvergence noise avoided minimize b-th block cost function time corr. adding maximize constraint previous cost function gives ﬁltering point view viewed ﬁltered ﬁlter output ﬁltered changing iteration. misconvergence point getting closer shape true misconvergence point deviates shape concept matched ﬁlter know ﬁlter passes maximum energy output input signal shape ﬁlter impulse response. therefore energy increases gets closer misconvergence point decreases misconvergence point. result energy reaches maximum value misconvergence point. paper exploit phenomenon prevent misconvergence. little modiﬁcation consider following convolution obvious power spectrum different phase spectrum. therefore instead using energy constraint prevent misconvergence. since estimate trfs block block cannot full length convolution described rather follow block-based convolution described previous section. similar manner b-th block total convolution length deﬁned write coupling factor chosen gives smaller value higher value larger value lower value fact initially value high gradient noiseless data dominant. therefore initially coupling factor small value facilitate unconstrained update dominant gradient noiseless data. update equation described makes cost function decrease even misconvergence point point gradient noise becomes comparable signal gradient. reason chosen increases decrease small value crosses misconvergence point higher value makes noise effect compensation stronger. suitable expression coupling factor empirically obtained determines sensitivity decrease value higher value means increase highly small decrease fig. shows misconvergence problem solved adding constraint described misconvergence phenomenon also emerge estimation noise. example using estimated trfs ﬁrst block instead true trfs estimating trfs second block actually adding estimation noise process. phenomenon shown fig. misconvergence becomes stronger number blocks increases. fig. shows proposed constraint also works estimation noise. figs. also show proposed constraint helps achieve better misconverging point. proposed bmcflms algorithm summarized tadescribed section incomplete data acquisition ultrasound imaging results blocks usable errors given estimating particular channel unknown coefﬁcients thus number unknowns total channels. error blocks b-th block gives equations estimate coefﬁcients. however extra error block i.e. error block additional equations estimate trfs. therefore incorporation extra equations estimation algorithm expected provide robustness noise also help improve resolution ultrasound image further. using convolution matrix ﬁrst drawn line i.e. number rows. order introduce redundancy estimation equations wish next block convolution matrix second drawn line give block error function. however nature ultrasound data acquisition extra block data needed block available transducers. estimate block missing data estimated trfs bmcflms algorithm estimated using r-mint algorithm shown observe lower part convolution matrix i.e. part second drawn line block contains mostly estimated data. therefore block error function deteriorate estimation accuracy. hence block error function used proposed md-bmcflms algorithm. work robust multiple-input/output inverse theorem estimate ﬁrst block axially blocked data. figure shows block diagram algorithm. here equalization ﬁlter i-th channel removes effect data gives psf. psfs different channels estimation using channel trfs according desirable. however memory limitation involved direct implementation reduce size matrix divide trfs lateral blocks equal number trfs estimate blocks δi)− however problem estimated data. using blind bmcflms r-mint algorithms estimate trfs scaling factor. result need evaluate scale factors channel extra missing data block performance improvement proposed adaptive algorithm. following similar approach using part matrix compare ﬁrst drawn line estimate equation reveals impulse function extract therefore estimated close impulse function. equalization ﬁlter removes effect data energy become unbounded lower magnitude. regularization constraint needed keep energy ﬁlter bounded. cost function evaluate shown given estimate using estimate scaled missing data using using calculate missing data current block number iteration index calculate error functions b-th block using section performance proposed algorithms measured simulation phantom experimental phantom also in-vivo data. results obtained compared time-domain method described cepstrum method based method performance measured using indices normalized projection fig. deconvolution performed simulation phantom scatterers resolution cell data size darker oval inclusion long axis short axis created placing scatterers relatively lower strength surroundings. log-envelope image true backscattered standard data deconvolved md-bmcflms algorithm spectra true estimated data single scan-line marked vertical green line envelope images curve deconvolved true ﬁrst block. represent resolutions deconvolution respectively. calculate normalized autocovariance function data calculated. axial slice peak considered width slice level measured represents absolute value hilbert transform data taken. stated compression performed using adjusted match contrast standard reference deconvolved images. data total number block parameters noise effect compensating constraint mdbmcflms algorithm selected parameters reason behind signiﬁcantly small value portion minimized ﬁrst step i.e. bmcflms make comparable given smaller weight. ultrasound simulation done using field-ii transducer element height chosen ultrasound simulation done simulation phantom scatterer density scatterers resolution cell. oval inclusion long axis short axis simulated reducing magnitudes region. focus ultrasound beam depth phantom surface. transducer centre frequency selected fig. performance analysis md-bmcflms algorithm using cirs phantom. spectrum deconvolved r-mint estimated spectra true estimated data single scan-line marked vertical line envelope images. standard envelope images backscattered data deconvolved trfs zoomed-in views sampling frequency mhz. array transducer elements used match available commercial ultrasound scanners. simulate noisy data zero-mean additive white gaussian noise added data obtain performance proposed md-bmcflms algorithm simulation data shown fig. visual comparison images provided figs. standard image poor resolution contrast estimated matches closely terms resolution true image fig. shows estimated along green marked line image matches closely true trf. again since true simulation data evaluate estimated shown fig. fig. proves effectiveness proposed correlation-based constraint prevent misconvergence proposed algorithm remains stable comparative results different algorithms simulation phantom data presented table iii. quantitative performance measures used comparison obvious table proposed bmcflms algorithm gives better image quality terms resolution gain methods. order show improvement using missing data algorithm results initial estimate bmcflms ﬁnal deconvolved image md-bmcflms presented. table shows md-bmcflms algorithm improves compared bmcflms proposed paper. requires additional iterations compared bmcflms algorithm improve image further. fig. performance analysis md-bmcflms algorithm in-vivo backscattered data breast cyst. spectrum deconvolved r-mint estimated spectra true estimated data single scanline marked vertical line envelope images. standard envelope images backscattered data deconvolved trfs zoomed-in views also tested data generated experiment cirs tissue mimicking phantom dimension background made zerdine attenuation coefﬁcient db/cm/mhz sound velocity m/s. spherical inclusion radius attenuation coefﬁcient db/cm/mhz. backscattered data collected using sonixtouch reasearch probe operating sampling frequency mhz. fig. shows performance proposed mdbmcflms algorithm experimental phantom data. fig. shows wideband spectrum line chosen along line fig. fig. shows narrowband smooth spectrum. estimated spectrum evaluted multiplication spectrum spectrum matches closely true spectrum shown fig. ensures deconvolution efﬁcacy proposed algorithm. figs. visual proof resolution increase deconvolved image compared standard image. better visualization zoomed-in view segment figs. given figs. seen deconvolved image ﬁner texture compared standard image. quantitative performance results terms resolution gain presented table show time-domain lbmclms algorithm performs better cr-based cepstrum methods. however proposed bmcflms algorithm frequency-domain gives better resolution gain level l-bmclms algorithm improved proposed md-bmcflms algorithm. fig. performance analysis md-bmcflms algorithm in-vivo backscattered data left carotid artery. spectrum deconvolved r-mint estimated spectra true estimated data single scan-line marked vertical line envelope images. standard envelope images backscattered data deconvolved trfs zoomed-in views medical centre bangladesh university engineering technology dhaka bangladesh. study approved institutional review board prior patient consent taken. effect deconvolution prominent case in-vivo data data mentioned earlier. fact scatterer density case in-vivo data fig. shows performance proposed md-bmcflms algorithm breast cyst data. figs. show frequency spectrum data axial line marked fig. psf. frequency spectrum data estimated product spectrum superimposed real spectrum fig. close match spectrum ensures convergence algorithm. visual perspective shows signiﬁcant increase resolution compared fig. better visualization zoomed-in view images provided figs. also show superiority proposed algorithm. evident deconvolved image shown table proposed bmcflms algorithm gives signiﬁcantly better resolution gain level compared time-domain counterpart cr-based method cepstrum method in-vivo data. latter methods also show data dependency give resolution gain improvement different range breast cyst carotid artery data. discussed introduction section effectiveness cepstrum method depends separability spectrum. again cr-based method requires thresholding null space bases correlation matrix. however l-bmclms proposed md-bmcflms algorithm impose stringent requirements data. therefore show similar resolution improvement type data justiﬁes less dependence parameter tuning. parameters correlation constraint remain effective types data presented result section. paper correlation constrained missing-data estimation based blind multichannel frequency-domain lmstype adaptive algorithm proposed ultrasonic estimation. order exploit inherent advantages noise robustness faster convergence less number iterations deconvolution performed frequency-domain. algorithm estimate missing data ﬁrst trfs estimated using bmcflms algorithm derived paper estimated trfs estimated using r-mint algorithm. incorporating additional information data modiﬁed cost function proposed mdbmcflms algorithm causes improvement deconvolution result. again address issue nonstationarity unlike convolution matrix segmentation described bmclms algorithm time-efﬁcient blocking procedure introduced paper. moreover well-known phenomenon misconvergence blind multi-channel identiﬁcation algorithms presence additive noise estimation error addressed here. prevent proposed algorithm misconverging novel constraint exploits correlation data estimated proposed paper. salient feature constraint generalized prevent misconvergence crossrelation-based blind simo model identiﬁcation schemes noisy measurements. constraint also imposes maximum correlation data estimated causes little improvement resolution deconvolved ultrasound images compared misconvergence point. efﬁcacy proposed algorithm tested quantitatively qualitatively simulation experimental in-vivo data. results demonstrated superiority proposed algorithms compared cr-based cepstrum time-domain bmclms methods. order show time requirement iteration proposed algorithm experimental phantom data described result section used. data length along axial direction varied channel number kept ﬁxed implementation platform used were intel coretm software matlab mathworks natick plot fig. shows proposed algorithm takes signiﬁcantly less time iteration required time-domain bmclms algorithm. addition reduced eigen-value spread observed frequency-domain implementation requires fewer iterations convergence time-domain approach. implies proposed algorithm faster compared bmclms algorithm. computation time algorithm reduced implementing java scope improving quality image considering realistic model instead approximation used here. again coupling factor used correlation constraint chosen empirically elegant solution issue addressed future work. nevertheless proposed algorithm results better image quality ultrasound images removing effect data far-reaching effect tissue characterization using quantitative ultrasound. hasan naylor analyzing effect noise lms-type approaches blind estimation simo channels robustness issue signal processing conference european abeyratne petropulu reid higher order spectra based deconvolution ultrasound images ieee transactions ultrasonics ferroelectrics frequency control vol. jirik taxt two-dimensional blind bayesian deconvolution medical ultrasound images ieee transactions ultrasonics ferroelectrics frequency control vol. h.-c. shin prager gomersall kingsbury treece sensitivity point-spread function parameters medical ultrasound image deconvolution ultrasonics vol. taxt restoration medical ultrasound images using twodimensional homomorphic deconvolution ieee transactions ultrasonics ferroelectrics frequency control vol. michailovich tannenbaum blind deconvolution medical ultrasound images parametric inverse ﬁltering approach ieee transactions image processing vol. adam michailovich blind deconvolution ultrasound sequences using nonparametric local polynomial estimates pulse ieee transactions biomedical engineering vol. michailovich adam shift-invariant dwt-based projection method estimation ultrasound pulse power spectrum ieee transactions ultrasonics ferroelectrics frequency control vol. hasan shifat-e-rabbi blind deconvolution ultrasound images using l-norm-constrained block-based damped variable step-size multichannel algorithm ieee transactions ultrasonics ferroelectrics frequency control vol. hasan damped variable step size multichannel wiener algorithm blind channel identiﬁcation noise proc. communication systems networks digital signal processing haque hasan variable step-size multichannel frequencydomain algorithm blind identiﬁcation ﬁnite impulse response systems signal processing vol. liao x.-l. khong analysis noise robustness problem blind channel identiﬁcation algorithm digital signal processing ieee international conference haque bashar naylor hirose hasan energy constrained frequency-domain normalized algorithm blind channel identiﬁcation signal image video processing vol. hasan benesty naylor ward improving robustness blind adaptive multichannel identiﬁcation algorithms using constraints signal processing conference european", "year": "2017"}