{"title": "Convolutional Neural Networks for joint object detection and pose  estimation: A comparative study", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "In this paper we study the application of convolutional neural networks for jointly detecting objects depicted in still images and estimating their 3D pose. We identify different feature representations of oriented objects, and energies that lead a network to learn this representations. The choice of the representation is crucial since the pose of an object has a natural, continuous structure while its category is a discrete variable. We evaluate the different approaches on the joint object detection and pose estimation task of the Pascal3D+ benchmark using Average Viewpoint Precision. We show that a classification approach on discretized viewpoints achieves state-of-the-art performance for joint object detection and pose estimation, and significantly outperforms existing baselines on this benchmark.", "text": "francisco massa mathieu aubry renaud marlet universit´e paris-est ligm enpc marne-la-vall´ee france francisco-vitor.suzano-massapolytechnique.edu mathieu.aubryimagine.enpc.fr renaud.marletenpc.fr paper study application convolutional neural networks jointly detecting objects depicted still images estimating pose. identify different feature representations oriented objects energies lead network learn representations. choice representation crucial since pose object natural continuous structure category discrete variable. evaluate different approaches joint object detection pose estimation task pascald+ benchmark using average viewpoint precision. show classiﬁcation approach discretized viewpoints achieves state-of-the-art performance joint object detection pose estimation signiﬁcantly outperforms existing baselines benchmark. also show performing tasks jointly improve signiﬁcantly detection performances. convolutional neural networks long shown impressive practical results specialized vision tasks optical character recognition thanks availability large annotated image datasets increased power computing cnns recently outperformed techniques less constrained computer vision tasks. following seminal work krizhevsky imagenet classiﬁcation many methods developed apply cnns tasks. work explore potential cnns specialized task real world images namely joint detection pose estimation images difﬁcult pascal dataset extended annotations detecting estimating pose known object instance oldest problem computer vision early works object contours detected explicitly images matched contours model object instance ﬁeld moved towards object category recognition methods focused photographs objects performed detection without explicitly taking account structure object. approaches typically based manually designed low-level features sift features aggregated used input classiﬁer svm. recently problem pose estimation object categories drawn attention many techniques developed joint object detection orientation estimation real images difﬁcult requires features conﬂicting properties. first estimating orientation requires high level discriminative power since example rotation airplane degrees change appearance much. second features need cope strong appearance changes since objects occluded appearance change e.g. intra-class variability categories illumination effects. moreover amount training data task limited deal lack training data following oquab pre-trained imagenet learn ﬁne-tune last layers. based idea choose spatial pyramid pooling framework consists computing densely image convolutional layers pre-trained manner similar sermanet re-scaling output compute fully connected layers ﬁne-tuned task. framework allows efﬁcient training testing taking advantage shared computation ﬁrst layers provides state-of-the-art performance classiﬁcation detection. adapt ﬁne-tune last layers architecture predict different features identify presence object orientation. experiments network performs detection pose estimation difference feature used associated error function. goal related emerging trend computer vision attempts predict detailed information objects addition category information. achieve goal question representation object category seen single entity anymore central. special case orientation identify test several natural representations. contributions. paper compare several feature representations learned single joint detection pose estimation. show handling continuous nature object poses possible method discretizes object poses classify image patch object pose performs well. moreover signiﬁcantly outperforms existing methods providing baseline task. also demonstrate beneﬁt continuous representations pose estimation. computer vision work focusing pose estimation roughly separated classes exclusively instance alignment target alignment entire category. work instance alignment includes early results recent ones aiming difﬁcult specialized tasks perform category-level pose estimation necessary handle large intra-class variation categories. difﬁcult reason work either focuses classes simple geometry cars consider simpliﬁed models objects example approximated planes cuboids hypotheses clearly limit applicability methods general objects real images. approaches demonstrated restricted dataset. recently xiang introduced extension classic challenging pascal dataset aligning models object classes. also introduced average viewpoint precision standard metric evaluation joint detection viewpoint estimation. provided baseline evaluations using detector orientation class well using method pepik uses adaptation constraints usually performs better. show clearly outperform baseline using cnns. cnns. convolutional neural networks architectures designed learn robust features images. formed succession layers convolutions spatial poolings. successfully applied many specialized tasks digit recognition related work joint detection pose estimation faces however attracted much attention computer vision impressive advances made classiﬁcation task categories ilsvrc krizhevsky since then improved dramatically results many vision problems either adapted speciﬁc task used generic features figure feature representation joint detection pose estimation methods explored paper. approach features associated different orientations given object category correspond subspace general feature space. images target subspace object class orientations shown blue subspace actual feature space. discrete method network subspace discrete points corresponding combination category discrete pose single-class regression subspace circle space. joint classiﬁcation continuous regression plotted independently classiﬁcation features pose features ﬁrst used girshick dramatic improvement pascal detection results. drawback algorithm must applied independently candidate bounding box. reason proposed apply selective search convolutional layers leading efﬁcient algorithm achieving slightly better performance. many methods recently proposed neural networks less training data available imagenet. particular oquab performed classiﬁcation pascal dataset adding learning fully connected layers network already trained imagenet obtained state-of-the-art results detection classiﬁcation learning fully connected layers convolutional layers trained imagenet. remains however unclear much invariance encoded ﬁrst layers network strategy could applied task pose estimation requires discriminative. except stated otherwise consider problem detection pose estimation object classes. given pitch roll angles vary slightly pascal images restrict estimation azimuth angle paper. however model could extended account angles. output continuous structure. example seems natural represent features associated chairs different orientations circle rather separated points. reason tested several alternative representations summarized ﬁgure section adapted directly successful algorithms developed detection discretizing different object poses orientations different classes predicting vector probabilities class orientation plus background class. contrary section focus continuous aspect angle prediction. single class associate orientation object point circle force background patches features circle. detection pose estimation completely joined small distances features circle associated class angle predicts orientation. section seen intermediate previous approaches. patch predict jointly probability class vector angle. manifold corresponding angle feature single circle classes circle class hyper-cylinder class evaluate option. finally choice architecture course important inﬂuence results. provide comparable results choose base models spatial pyramid pooling framework developed efﬁcient training testing. used zeiler architecture provides good results detection. dense features computed image multiple scales using convolutional layers max-pooling layers similar krizhevsky ﬁrst part network trained imagenet used network provided features corresponding windows picked selective search image rescaled used input three fully-connected layers. work tune fully-connected layers different tasks. section describe details different approaches evaluated paper corresponding choices error functions. selected cover different approaches problem corresponding different cases presented ﬁgure section write output network parameters input suppose given training images ≤k≤m ground truth labels orientation explained section labels different dimensions interpretations depending choice architecture. simplest solve problem pose estimation based classiﬁcation algorithm discretize orientations bins consider separate class. leads classiﬁcation problem classes. write coordinates vector rn×p deﬁne setting object object category orientation otherwise setting category otherwise. exactly architecture detection. ﬁrst part network trained imagenet ﬁxed. windows corresponding patches extracted selective search image extracted feature maps rescaled ﬁxed size input three fully connected layers followed softmax. error minimized learning algorithm negative log-likelihood written discrete framework consider natural continuous structure object space. indeed appearance varies continuously viewpoint output discretized network supposed jump point another viewpoint varies taking advantage continuity appearance. reason present section different view problem similar developed osadchy face detection orientation prediction. consider single class associate positive example point unit circle angle corresponding orientation. enforce speciﬁc prediction negative examples force away circle describing positives. problem arises simply considers circle space error function deﬁned push symmetrically negatives away circle local minimum inside circle negatives. thus negative samples trapped circle instead pushed away. avoid effect third dimension features unit circle live space. formally circle deﬁning positives deﬁned since problem classiﬁcation problem network without ﬁnal softmax. separate indices training examples sets spos corresponding positive examples sneg corresponding negative examples. spos desired output network error function attracts positive examples target position network written parameter introduced osadchy found important complementary indeed huge values would needed compensate exponential decrease negative weights push negative examples distance clearly larger radius positive circle. network probability test sample correspond positive example decreasing function probable orientation positive sample angle deﬁned projection computed feature obtain angle corresponding pose arctan i-th coordinate feature network described previous paragraph treats classiﬁcation problem implicitly straightforward extend several mutually exclusive classes. would need example deﬁne parameters ratio distance categories distance different orientations objects category. reason considered alternative inspired work penedones consists dividing last layer network part devoted classiﬁcation call class orientation prediction pose. classiﬁcation layer followed softmax pose prediction layer not. rest network keep architecture previous sections. approach seen intermediate two. target values network output decomposed part corresponding associated last layer. standard classiﬁcation network class dimensional vector dimension corresponding probability input instance corresponding class. pose natural choices possible balances contribution terms. choose class log-likelihood similarly equation using classiﬁcation feature. case deﬁnition pose based loss similar equation case consider possibilities deﬁne pose penalizes distance pose; penalizes distance components corresponding relevant class. similar approach penedones approach similar used williams control points localization. since performing jointly detection pose estimation requires optimizing provide experiments pose estimation using using detection score reference classiﬁer learning pose regression compare several variants penalization lpos. experimented squared losses. network probability test sample belong object class given classiﬁcation part output orientation prediction made pose estimation part similar section trained evaluated methods using pascald+ dataset introduced xiang extends annotation challenging pascal dataset particular provides orientation annotations object classes. orientation annotation obtained aligning models images. xiang also introduced standard measure evaluating joint detection pose estimation provided several baselines. accuracy measure called average viewpoint precision similar standard average precision used detection obtained computing area precisionrecall curve except considers detection positive associated orientation prediction accurate error given threshold. case discrete viewpoint prediction threshold associated size thus number different viewpoints predicted. reason following xiang report results tolerance thresholds corresponding views. since test orientation annotations available networks ﬁnetuned using pascal training augmented ﬂipped images evaluated pascal validation xiang data imagenet ﬁne-tunning moreover considered instances evaluation except marked difﬁcult; particular occluded truncated objects evaluated. best baseline provided xiang corresponds method pepik baseline others consist ﬁrst using detection method zeiler architecture used rest paper. then detection either predict probable viewpoint class predict orientation class using linear regression features computed bounding box. note baseline corresponds limit method described section tends corresponding results provided tables detailed results baselines found appendix. expected results clearly better using cnns notice still favor method pepik comparing baselines regression features able recover valuable orientation information. networks trained using stochastic gradient descent momentum weight decay batch size patches. balanced proportion positive negative patches following manner discretized method joint classiﬁcation regression models positive patches negative patches batch; continuous regression positive class consider positive negative patches batch. used adaptive strategy vary learning rate number required iterations different experiments. this randomly selected validation patches keeping positive negative proportions training evaluate every iterations. started learning rate divided learning rate error small validation stopped decreasing successive evaluations strategy allowed fast training networks although optimal. models implemented using torch discrete method. experiments discretized method trained different model discretization variant results presented table clearly outperform previous state-of-the-art results presented table term avp. detection results comparable baseline presented table decrease number viewpoints. another interesting fact margin method outperforms baseline decreases number viewpoints augments. explained fact less training examples orientation class available number discrete viewpoints increased. test interpretation trained -views model using pascal training imagenet annotations. results presented last table expected adding training data increases considerably mavp. continuous regression. study method determine best parameters selected bicycle class orientations well represented database explored different values parameters found model performs best however able study higher values stability issues. parameters conducted experiments classes. report results table detection performances better baseline worse baseline discrete method. surprising since error function optimized detection. viewpoint predictions clearly better baseline showing pose information effectively learned. joint classiﬁcation continuous pose estimation. ﬁrst test regression method without detection different loss functions using detector baseline score candidates. results presented left side table using squared norm loss observe improvement baseline showing real pose estimation learned. results obtained norms much better table discretized method section network predicts orientation different class. last corresponds model trained using pascal training imagenet annotations table single class continuous regression section network aims predicting points unit circle correct angle positive instances points circle negative instances. table joint continuous pose estimation classes section left side pose-estimation learned classiﬁer baseline classiﬁer. right side classiﬁcation pose-estimation jointly trained. really learning pose estimation improving baselines. however slightly lower results discrete method. investigate interest jointly optimizing detection pose prediction. test three variants presented section using norm similar penedones results presented right side table approach fails probably lack ﬂexibility. surprising result clear improvement detection performance method result corroborates initial ﬁndings penedones much challenging dataset. possible explanation separating different orientations helps network better representations object classes. interestingly despite improvement detection orientation predictions good obtained learning pose independently detection. possible explanation would relative weight pose loss small. thus repeated experiment method observe limited improvement pose estimation performance detection performance drops. summary. experiments demonstrate possible perform joint detection pose estimation cnns continuous discrete set-up. discrete set-up provides best results orientation prediction needs data avoid decrease detection performance treats orientation separate class. contrary possible continuous set-up take advantage additional orientation annotations improve detection performances. paper presented uniﬁed view several approaches joint detection orientation prediction. compared approaches showed beneﬁt performing tasks jointly. finally used cnns outperform state-of-the-art results provide baseline joint detection pose estimation. work carried imagine joint research project ecole ponts paristech scientiﬁc technical centre building partly supported project semapolis anr--cord-. lecun boser denker henderson howard hubbard jackel backpropagation applied handwritten code recognition. neural comp. lecun bottou bengio haffner gradient-based learning applied document sermanet eigen zhang mathieu fergus lecun overfeat integrated recognition localization detection using convolutional networks. preprint arxiv. simard steinkraus platt best practices convolutional neural networks applied visual document analysis. international conference document analysis recognition volume ieee computer society", "year": 2014}