{"title": "Primal View on Belief Propagation", "tag": ["cs.LG", "cs.AI", "stat.ML"], "abstract": "It is known that fixed points of loopy belief propagation (BP) correspond to stationary points of the Bethe variational problem, where we minimize the Bethe free energy subject to normalization and marginalization constraints. Unfortunately, this does not entirely explain BP because BP is a dual rather than primal algorithm to solve the Bethe variational problem -- beliefs are infeasible before convergence. Thus, we have no better understanding of BP than as an algorithm to seek for a common zero of a system of non-linear functions, not explicitly related to each other. In this theoretical paper, we show that these functions are in fact explicitly related -- they are the partial derivatives of a single function of reparameterizations. That means, BP seeks for a stationary point of a single function, without any constraints. This function has a very natural form: it is a linear combination of local log-partition functions, exactly as the Bethe entropy is the same linear combination of local entropies.", "text": "known ﬁxed points loopy belief propagation correspond stationary points bethe variational problem minimize bethe free energy subject normalization marginalization constraints. unfortunately entirely explain dual rather primal algorithm solve bethe variational problem beliefs infeasible convergence. thus better understanding algorithm seek common zero system non-linear functions explicitly related other. theoretical paper show functions fact explicitly related partial derivatives single function reparameterizations. means seeks stationary point single function without constraints. function natural form linear combination local log-partition functions exactly bethe entropy linear combination local entropies. loopy belief propagation well-known algorithm approximate marginals partition function gibbs probability distribution deﬁned undirected graphical model acyclic graphs yields exact result graphs cycles often yields surprisingly good approximations. large body literature exists related topics refer reader recent survey unfortunately cyclic graphs guaranteed converge indeed often observed. eﬀort invested understanding phenomenon references. solid ground provided discovered ﬁxed points coincide stationary points bethe variational problem long known statistical physics. showed every stable ﬁxed points local optima problem vice versa. basic operation algorithm ‘passing message’ means sending vector numbers node edge graph messages turned directly related lagrange multipliers bethe variational problem later became clear passing message corresponds reparameterizing distribution. view tries reparameterize distribution corresponding beliefs consistent marginals. though generally known existing theoretical analysis fully utilizes interpretation messages lagrange multipliers bethe variational problem reparameterizations. contrast incorporate reparameterizations variational inference principled makes picture complete provides mathematical framework formulate main result. correspondence ﬁxed points bethe variational problem entirely explain algorithm directly solve bethe variational problem beliefs infeasible problem convergence. thus still better understanding algorithm seek common zero system non-linear functions explicitly related other. main result show functions fact explicitly related partial derivatives single function reparameterizations. words searches stationary point single funcentropy distribution function equals denote entropy distribution function deﬁned implicitly ﬁrst take satisfying function positive concave domain interior conv functions related convex conjugacy says interior conv satisfy fenchel’s inequality equality holds alternative view kl-divergence distribution determined distribution determined notice equality obtained minimizing left-hand side respect similarly minimizing respect yields tion without constraints. function natural form linear combination local logpartition functions exactly bethe entropy linear combination local entropies. show ﬁxed points one-to-one correspondence stationary points function points saddles. several versions related free energies exist. originally formulated models pairwise interactions. formulate result factor-graph permits interactions arbitrary order. currently consider complex versions cluster variation methods generalized recall basics exponential families probability distributions oﬀer convenient formalism reason graphical models cept reparameterizations overcomplete exponential families principled authors important graphical models reparameterizations play crucial rˆole. ﬁnite sets discrete exponential family family probability distributions log-partition function denotes log-sum-exp operation. operation associative commutative distributes assume functions aﬃnely independent i.e. form minimal representation family. relax later specify matrices capture aﬃne dependencies among functions indirectly writing products equation systems turn familiar marginalization normalization condilet remark describes subset existing homogeneous dependencies among namely couple hyperedges variables omits couple pairs hyperedges. limitation factor-graph compared generalized existing dependences would described explain detailed meaning deﬁne elementary homogeneous reparameterization follows pick pair subtract arbitrary unary function function function then follows transformation preserves distribution thus reparameterization distribution. refer subclass reparameterizations homogeneous reparameterizations. overcomplete representation longer determined uniquely reparameterizations moreover equality longer used partial derivatives undeﬁned directional derivatives parallel space deﬁned. gibbs distribution show gibbs distribution graphical model arises special exponential family. variables. variable subsets i.e. hypergraph. assume contains one-element subsets. variable takes states ﬁnite domain variable. hyperedge ×v∈a denote cartesian product domains variables elements denoted instantiate distribution becomes gibbs distribution hypergraph cartesian product variable domains. function well-known bethe entropy approximation seen ‘bethe logpartition function’. knowledge function mentioned previous works. next proceed follows. deﬁne algorithm ﬁxed points. give interpretations ﬁxed points here term ‘stationary point’ slightly broader meaning usual stationary point function aﬃne space point directional derivatives parallel space vanish. usually formulated terms passing messages following formulate terms reparameterizations. formulation related diﬀerent probabilities seen approximations true variable hyperedge marginals gibbs distribution general fail satisfy marginal consistency condition satisﬁed true marginals. algorithm seeks reparameterize holds. since functions invariant reparameterizations homogeneous reparameterizations considered. plugging yields since cancels preserves hence also function applying transformations pairs yields terms i.e. homogeneous reparameterization reparameterization θ+βb simply adds constants functions point papers graphical models usually mean ‘reparameterizations’ homogeneous reparameterizations explicit that. reparameterizations form ﬁrst used relaxation problem maxx∈x found modern revisions approach. general formulation related algorithms free energies start decomposing original hypergraph collection sub-hypergraphs subhypergraph assigned counting number every hyperedge original hypergraph counted exactly total. factor-graph hypergraph decomposed collection sub-hypergraphs hypergraph contains variable hypergraph contains hyperedge variables counting number equals counting number equals single update algorithm enforces condition hold single pair applying elementary homogeneous reparameterization pair determines constant. constant ensures numbers stay bounded algorithm. exponential family formalism ﬁxed point condition stated concisely follows. deﬁned seen approximation true marginal ﬁxed point condition reads simply true satisﬁes contrast satisﬁes general. seeks reparameterize also i.e. solve system optimum attained provides advantage marginal polytope conv entropy function deﬁned intractable way. trick replace tractable approximations. then optimal argument value approximation true respectively. polytope conv approximated ‘local polytope’ known bethe free energy. general conv however factor graph graphical model acyclic i∩aﬀ conv emphasize algorithm directly solve problem maintains ensures tries reparameterize thus infeasible converges. operating lagrange multipliers dual algorithm solve showed ﬁxed points correspond stationary points problem need precisely meant correspondence deﬁned ﬁxed points terms stationary points terms correspondence given oneto-one adding constants functions i.e. reparameterizations moreover notice objective invariant homogeneous reparameterizations feasible understanding state yedidia’s result. present main result concisely stated follows algorithm tries vector gradient respect vanishes. gradient conveniently evaluated without loss generality since gradient recovered replacing thus claim ﬁxed point ﬁrst equality follows chain rule. alternative interpretation condition stationary point function space homogeneous reparameterizations recall space vectors possible condition says directional derivatives parallel space vanish. formulate result. indeﬁnite point satisfying suﬃces show partial hessian indeﬁnite. obtain partial hessian computing partial derivatives /∂αk possible pairs work ∂αav ∂αbv holds points derivative complex. derivative takes values depending whether hence diagonal elements partial hessian zero remaining elements equal. matrix indeﬁnite. unlike fenchel’s equality true equality fails hold interestingly observed condition becomes unnecessary form bethe entropy replaced diﬀerent form. functions equal different otherwise easily veriﬁed form equality holds even words substitution transforms function bethe entropy clear meaning acyclic graphs equals true entropy follows similar property acyclic graphs equals true log-partition function presented novel interpretation loopy belief propagation. known ﬁxed points correspond stationary points bethe free energy local polytope shown also correspond stationary points ‘bethe log-partition function’ space homogeneous reparameterizations. best knowledge simple observation made before. interpretations exactly complementary however related classical convex duality function concave convex. understood algorithm seek common zero explicitly unrelated equations. result shows equations partial derivatives single function without additional constraints. would expect ﬁnding stationary point single multivariate analytic function must easier solving system unrelated non-linear equations true stationary point local extreme. unfortunately stationary points function saddle points ﬁnding saddle point much harder therefore currently know whether result provide insights convergence various generalized versions often designed dual considerations involving local free energies entropies. result suggests free energies needed primal route reparameterizations local log-partition functions simpler. open future research. although demonstrated practical consequences contribution believe presented mathematical framework treats reparameterizations explicitly incorporates exponential family language brings clarity theoretical understanding graphical models.", "year": 2012}