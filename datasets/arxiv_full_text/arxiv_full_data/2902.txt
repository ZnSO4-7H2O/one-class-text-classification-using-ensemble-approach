{"title": "Modeling the Sequence of Brain Volumes by Local Mesh Models for Brain  Decoding", "tag": ["cs.LG", "cs.AI", "cs.CV"], "abstract": "We represent the sequence of fMRI (Functional Magnetic Resonance Imaging) brain volumes recorded during a cognitive stimulus by a graph which consists of a set of local meshes. The corresponding cognitive process, encoded in the brain, is then represented by these meshes each of which is estimated assuming a linear relationship among the voxel time series in a predefined locality. First, we define the concept of locality in two neighborhood systems, namely, the spatial and functional neighborhoods. Then, we construct spatially and functionally local meshes around each voxel, called seed voxel, by connecting it either to its spatial or functional p-nearest neighbors. The mesh formed around a voxel is a directed sub-graph with a star topology, where the direction of the edges is taken towards the seed voxel at the center of the mesh. We represent the time series recorded at each seed voxel in terms of linear combination of the time series of its p-nearest neighbors in the mesh. The relationships between a seed voxel and its neighbors are represented by the edge weights of each mesh, and are estimated by solving a linear regression equation. The estimated mesh edge weights lead to a better representation of information in the brain for encoding and decoding of the cognitive tasks. We test our model on a visual object recognition and emotional memory retrieval experiments using Support Vector Machines that are trained using the mesh edge weights as features. In the experimental analysis, we observe that the edge weights of the spatial and functional meshes perform better than the state-of-the-art brain decoding models.", "text": "following pioneering study haxby machine learning techniques used mvpa diagnosing disorders hypothesis validation classifying cognitive states method predicting cognitive states called brain decoding. context machine learning encoding brain activities formalized training classiﬁer using training fmri measurements whereas cognitive state decoded assigning label test fmri measurement recorded prescribed cognitive stimuli. state-of-the-art mvpa approaches cognitive states usually represented concatenating selected voxel intensity values construct vector feature space. time series recorded voxel represented various methods computing maximal mean values. also inactive voxels eliminated principal component analysis independent component analysis searchlight analysis reduce dimension feature space. then classiﬁer support vector machine k-nearest neighbor naive bayes employed using feature vectors. state-of-the-art methods designed extract spatial patterns bold responses others focus modeling temporal information form features brain decoding. popular method extracting spatial feature brain decoding fmri data computing average bold response voxel represent stimulus recent work suggested considers brain volume sample. hand mitchell concatenate bold responses within trial extract features include spatio-temporal information. order extract temporal information fmri data various studies compute pairwise correlations responses voxels brain regions. among studies pantazatos model temporal relationships using pairwise correlations brain regions features brain decoding. moreover richiardi model functional connectivity graph using pairwise correlations brain regions decode brain states using graph matching algorithms. also edge weights proposed brain graphs generally selected using correlation pairs selected voxels vertices edge weights brain graphs used features cognitive state classiﬁcation contrary coarse-level functional connectivity firat abstract—we represent sequence fmri brain volumes recorded cognitive stimulus graph consists local meshes. corresponding cognitive process encoded brain represented meshes estimated assuming linear relationship among voxel time series predeﬁned locality. first deﬁne concept locality neighborhood systems namely spatial functional neighborhoods. then construct spatially functionally local meshes around voxel called seed voxel connecting either spatial functional p-nearest neighbors. mesh formed around voxel directed sub-graph star topology direction edges taken towards seed voxel center mesh. represent time series recorded seed voxel terms linear combination time series p-nearest neighbors mesh. relationships seed voxel neighbors represented edge weights mesh estimated solving linear regression equation. estimated mesh edge weights lead better representation information brain encoding decoding cognitive tasks. test model visual object recognition emotional memory retrieval experiments using support vector machines trained using mesh edge weights features. experimental analysis observe edge weights spatial functional meshes perform better state-of-the-art brain decoding models. functional magnetic resonance imaging used primary modality capture neural activations brain high spatial resolution reasonable temporal resolution measures blood oxygenation level dependent responses stimulus seconds event-related design experiment. approach generates brain volume approximately time instance. smallest unit volume called voxel consists time series intensity values approximate hemodynamic response pairwise correlations voxels features baldassano extract functional connectivity structures modeling pairwise connectivity among voxels. also minimum spanning tree graph structure deﬁned using functional connectivity matrix employed using voxels stimulus brain decoding note that aforementioned temporal methods designed model pairwise relationships voxels employ relationships brain decoding. although methods represent spatio-temporal information certain degree none propose model formalize relationships among brain volumes recorded along time course cognitive stimulus. words spatial models mostly lack temporal information temporal ones lose spatial relationships among voxel bold responses. major motivation study follows observations functional spatial similarities voxel bold responses pre-deﬁned locality. example bazargani state neighboring voxels belonging homogeneous hemodynamic response function shape possibly slightly varying amplitude. words spatially close voxels tend give similar bold responses stimuli. moreover kriegeskorte report univariate model activations fails beneﬁt local spatial combination signals performs worse searchlight methods detection informative regions. observe spatially remote voxels also exhibit functionally similar time series. furthermore ozay observe voxel time series differ signiﬁcantly discriminate different cognitive states exist slight variations among voxel intensity values voxels located spatial neighborhood. propose local meshes model relationship among spatially close voxels. show features perform better voxel intensity values classiﬁcation cognitive states. however brain volume obtained seconds stimulus presentation used construction model remaining ones discarded canonical assumption. finally firat propose functional mesh model used construct local meshes selecting nearest neighbors voxels deﬁned within functional neighborhood. experimental results show features discriminative features obtained within spatial neighborhood. also estimate mesh weights using single intensity value voxel. none mentioned models time series recorded voxels fully employed represent spatial relationships among voxels fmri data. available approaches either active voxels crucial time instances both. although approaches smooth noise voxel time series represent huge amount data compact result losing important information embedded time series brain volumes recorded stimulus. brain cannot represented considering collection selected voxels and/or time instances obtained fmri data. addition mentioned studies indicate relationship among voxels informative information provided individual voxels. therefore desirable develop model represents relationship among brain volumes recorded stimulus. furthermore model incorporates local similarities among voxel time series possible represent sequence brain volumes recorded cognitive stimulus graph consists subgraphs represented local linear regression model. study employ voxel time series measured during cognitive task create local mesh around voxel models relationship among bold responses. concept locality deﬁned neighborhood system. study introduce types neighborhoods namely spatial functional neighborhoods. local mesh around voxel constructed using either spatial functional neighborhood system generate spatially functionally local meshes. form local mesh around voxel connecting voxel p-nearest neighbors star topology. mesh bold response voxel represented weighted linear combination bold responses spatially functionally nearest neighbors. weights estimated solving linear regression equation assigned edges mesh. mesh edge weights estimated voxel enable represent fmri brain volumes recorded stimulus directed graph consists ensemble local meshes. proposed local mesh models different connectivity models deﬁned pairwise similarities voxels and/or regions sense connectivity deﬁned local neighborhood voxels. employ estimated weights mesh edges features train test state-of-the-art support vector machines encoding decoding cognitive processes measured fmri signals. approach employed modeling sequence fmri brain volumes recorded event-related design experiment. assume voxel time series approximate hemodynamic response stimulus. unfortunately block design lacks information overlaps between consecutive hemodynamic responses. therefore test approach event-related design experiments namely visual object recognition emotional memory retrieval experiments. observe classiﬁers employ proposed local mesh ensembles outperform state mvpa models. fig. steps proposed method summarized. first preprocess fmri measurements obtain voxel intensity values. then select voxels eliminate redundant voxels reduce noise dataset. that deﬁne spatial functional neighborhood systems construct meshes accordingly. finally estimate edge weights meshes employ features cognitive state classiﬁcation. used pre-processing data analysis. preprocessing images consisted correction slice acquisition timing across slices realigning images ﬁrst volume fmri correct head movement normalization functional anatomical images standard template provided smoothing images full-width half-maximum isotropic gaussian kernel. finally extract automated anatomical labeling regions using marsbar visual object recognition experiment active voxels identiﬁed using general linear model implemented occipital lobe selected region interest task engaged visual cortex activity pattern analyses employed. emotional memory retrieval experiment selected ﬁrst discriminative voxels whole brain analysis using relieff visual object recognition experiment measurements recorded runs samples. design datasets taking ﬁrst samples class training last samples class validation testing. hand emotional memory retrieval experiment measurements recorded within run. measurements recorded encoding phase employed training data ones obtained retrieval phase used validation test data. local mesh model proposed study constructed using collection voxels located within neighborhood voxel. purpose ﬁrst make formal deﬁnition locality. task achieved deﬁning spatial functional neighborhood systems. then deﬁne types local meshes namely spatial functional meshes. important tasks study construct linear relationship among bold responses voxels employing locality properties voxels. order achieve goal deﬁne types neighborhood systems namely spatial functional neighborhoods. deﬁnition spatial neighborhood {vj} nodes corresponds voxel located coordinate ¯lj. spatially nearest neighbor voxel deﬁned voxel smallest euclidean distance seed voxel given below experiment fmri measurements recorded participants performed one-back repetition detection task. stimuli consisted gray-scale images belonging categories namely birds ﬂowers. stimulus presented seconds followed rest period seconds. experiment stimuli consisted neutral emotional categories images. trial started seconds ﬁxation period followed seconds encoding period. encoding period participants presented images category image lasting screen. following ﬁfth image seconds delay period presented participants solved three math problems consisting addition subtraction randomly selected two-digit numbers. following third math problem seconds retrieval period started participants presented test image category indicated whether image member current study list not. similar experimental setting please refer classiﬁcation employed measurements obtained encoding retrieval phase training test data respectively. fig. ensemble meshes formed using spatial neighbors functional neighbors seed voxels. ensembles voxels denoted color seed voxels. orange voxels denote spatially nearest neighbors voxel functionally nearest neighbors voxel green voxels spatially nearest neighbors corresponding orange voxels functionally nearest neighbors corresponding orange voxels highest edge weights displayed simplicity. note functionally p-nearest neighbors voxel spatially p-nearest neighbors. practical evidence indicates spatially close voxels also functionally close i.e. highly correlated. however voxel pairs spatially apart functionally close deﬁnition p-spatially nearest neighborhood -nearest neighbors voxel correspond adjacent voxels right left down front back voxel increase neighboring voxels gets larger. voxels adjacent nearest neighbors included recursively increasing deﬁnition functional neighborhood denote vector entries bold signal measurements voxel recorded response series stimulus entire experiment. functionally nearest neighbor voxel deﬁned voxel vector maximally correlated measured voxel order functionally nearest neighbor voxel pearson correlation computed voxels brain volume using following criterion fig. design spatially local mesh modeling relationship among bold responses voxels. simplicity seed voxel depicted axial slice center mesh four spatially nearest neighbors neighboring voxels selected within brain volume. example would include voxels seed voxel. fmri time series recorded voxel stimulus bird ﬂower classes. local mesh computed using responses obtained seed voxel four nearest neighbors last sample also visualize voxel intensity values sample response obtained voxel ¯lo. types meshes constructed around voxel brain volume using predeﬁned neighborhood system. select neighborhood system form local mesh around voxel connecting voxel pnearest neighboring voxels star topology. voxel located center mesh called seed voxel. voxel resides within neighborhood seed voxel connect seed voxel edge directed towards seed voxel. name implies spatially local meshes constructed using p-spatially nearest neighbors whereas functionally local meshes constructed using pfunctional nearest neighbors seed voxels. since form meshes around voxels brain volume meshes deﬁned neighborhood system overlap. seed voxel mesh become neighboring voxel seed voxel different mesh. formal deﬁnition local meshes given below deﬁnition spatially local meshes voxel brain volume spatially local mesh formed around voxel called seed voxel deﬁned directed graph mspat represents nodes mesh deﬁnition functionally local meshes voxel brain volume functionally local mesh constructed around voxel deﬁned directed graph represents nodes mesh notice that neighborhood systems seed voxel located center mesh becomes neighboring voxel another mesh. therefore directed edges neighboring voxels opposite directions. edge weights mesh estimated minimizing mean square error linear model explained next section. proposed linear model seed voxel represented terms linear combination p-nearest neighbors. star topology deﬁned meshes employed experiments ﬁxed mesh size words voxels edges formed mesh change time. however weights nodes correspond intensity values measured entry time-series representing bold response change time. since estimate edge weights cognitive stimulus edges remain duration stimulus changes across stimuli. fig. design functionally local mesh using voxel time series. sample functional connectivity matrix formed using pearson correlation. p-functionally nearest neighbors voxel denoted ones darkest color. fmri measurements recorded stimulus bird ﬂower classes. depict functional mesh formed around seed voxel star topology. direction edges taken towards seed voxel indicating seed voxel represented linear combination neighbors. edge weights computed using response obtained seed voxel responses four functionally nearest neighbors last sample also visualize voxel intensity components sample response obtained voxel located ¯lo. size mesh deﬁned order neighborhood system gets larger size mesh constructed around voxel increases resulting overlaps among meshes. therefore considered measure degree locality proposed mesh model represent bold response seed voxel linear combination bold responses neighboring voxels seed voxel. suppose record bold response voxel located coordinate stimulus order measure brain activation predeﬁned cognitive state label denote intensity value bold response measured voxel time instance stimulus stimulus presentation record measurements voxel given stimulus denote weight edge approximate weight edge directed voxel stimulus estimating value aijk considered seed voxel mesh. estimate edge weights mesh formed around voxel located coordinate stimulus linear model formed among bold response seed voxel mesh bold responses p-nearest neighbors follows; bold response obtained seed voxel modeled using weighted linear combination bold responses obtained p-nearest neighbors. weight aijk represents relationship responses obtained seed voxel neighboring voxel addition entry represented weighted combination neighboring entries therefore equivalently represented follows regularization parameter estimated training phase matrix consisting bold responses obtained p-nearest neighbors seed voxel presentation sample spatially local mesh small seed voxel mesh related spatially close voxels. increase mesh includes larger areas brain volume take account contribution distant voxels seed. hand functionally local bold mesh small implies correlated voxels related seed voxel. increase mesh size include contribution voxels relatively less correlated seed voxel. identiﬁcation optimal mesh size crucial issue. study optimize mesh size using validation set. task also achieved using information theoretic function akaike’s information criterion bayesian information criterion rissannen’s minimum description length estimate model order. possible deﬁne different mesh size seed voxel using approaches mentioned above. interested reader referred representation power proposed mesh ensemble analyzed fmri recordings brain encoding decoding tasks. purpose employ machine learning methods encoding cognitive state represented training phase decoding state corresponds recognition phase classiﬁcation algorithm. major question well cognitive state represented ensemble meshes? answer question partly observed performance classiﬁer. recall cognitive stimulus label record sequence brain volumes number brain volumes sequence depends duration stimulus. sequence brain volumes considered sample label training set. order represent cognitive state corresponding stimulus mesh ensembles estimate edge weights local meshes extracted corresponding sequence brain volumes. sequence brain volumes recorded stimulus represented brain graph consists ensemble local meshes. finally sample dataset represented vector entries estimated mesh weights input space classiﬁer. formally speaking sample label edge weights ¯aij used construct feature vector concatenating edge vectors number voxels. denote feature vector sample belonging training feature vector sample belonging test set. then construct features training samples features test samples train test classiﬁers classiﬁcation cognitive states. order observe validity proposed mesh models perform groups experiments. ﬁrst group train test support vector machine classiﬁer using labeled fmri data recorded using experimental setups explained section group experiments examine power models representing brain encoding decoding tasks. second group experiments analyze validity local meshes exploring similarities among voxel time series mesh distribution error proposed linear regression model. encoding decoding performances models. encoding process performed training classiﬁer linear kernel decoding process corresponds classiﬁcation unknown stimulus class label perform seven sets computer experiments different groups fmri datasets ﬁrst second experiments represent cognitive stimulus using spatial functional meshes. classiﬁcation performances measured using edge weights obtained using spatially functionaly local mesh models. third fourth experiments tested classiﬁcation performances employing local mesh model functional mesh model. recall keep single value bold response voxel omitting rest signals measured stimulus. ﬁfth group experiments test performance classiﬁers employ features computed using pairwise pearson correlation first compute pairwise correlations voxel bold responses given seed voxels p-nearest neighbors stimulus. words ﬁrst meshes constructed around seed voxels pairwise correlations computed voxel pairs within meshes instead estimating edge weights within neighborhood. then form feature vector concatenating correlation values within meshes. note that obtain feature vectors whose sizes equal concatenating distances within meshes make fair comparison. sixth experiments analyze classiﬁcation performance classiﬁers state-of-the-art mvpa methods voxel intensity values used features train test classiﬁers. mvpapeak used third instance bold response following assumption voxel becomes active reaches peak value seconds hand mvpa-mean depicts case employed average measurements also concatenate measurements bold response {v}d obtain results mvpa-all. dimension feature vector constructed mvpapeak mvpa-mean equals visual object recognition experiment emotional memory retrieval experiment. moreover since concatenate measurements mvpa-all size feature vectors used mvpa-all equals times size features vectors mvpa-mean mvpa-peak. seventh experiments selected surrounding voxels mesh random voxels test importance locality. lm-rand form meshes deﬁned sequence brain volumes random voxels. perform intra-subject classiﬁcation using classiﬁers features extracted samples collected proposed visual object recognition experiment participants emotional memory retrieval experiment thirteen participants. mesh size used mesh computed using data collected participant. visual object recognition experiment table provides classiﬁcation performance using models described previous subsection. regularization parameter selected experimentally computed meshes using various mesh sizes order optimize mesh size within interval randomly split part test data validation set. ensured validation test sets balanced. selected optimal mesh sizes ones maximizes validation performances. classiﬁcation results visual object recognition experiment given table additionally performances obtained test using optimal mesh size obtained validation sets given table method employed classiﬁer participant. example obtain accuracy mesh size ﬁrst participant observed that mesh size leads maximum performance varies different participants methods. addition classiﬁers employ features extracted perform best among others features extracted perform slightly better features extracted slm. note that selecting random voxels lm-rand performs worse employing spatial functional neighbors. emotional memory retrieval experiment provided results -class -class classiﬁcation experiments. experiments selected experimentally computed meshes mesh sizes ﬁrst case provided two-class classiﬁcation results classes correspond neutral emotional categories second case four classes correspond kitchen utensil furniture fear disgust kitchen utensil furniture belong neutral category fear disgust belong emotional category first results show employing bold responses computation meshes provides discriminate representations cognitive states. moreover observe estimating functional relationships within neighborhood provides better performance using pairwise functional relationships utilized fc-mesh. features extracted fc-mesh perform worst among others since computation correlation among voxels using voxel intensity values stimulus presentation enough represent real correlation among voxels computed considering whole dataset. therefore obtain better classiﬁcation performance computing single functional connectivity matrix training data using matrix select functionally nearest neighbors instead computing functional connectivity matrices sample using elements features. finally obtained worse classiﬁcation performance using classiﬁers employ mvpa features consisting individual voxel intensity values compared proposed methods. provided mean standard deviations classiﬁcation performances using different meshes constructed visual object recognition experiment fig. emotional memory retrieval experiment fig. fig. fig. bars represent mean classiﬁcation performance averaged whereas fig. fig. bars represent mean classiﬁcation performance averaged similar visual object recognition experiment optimal mesh sizes selected ones maximize validation accuracy within interval table table provide classiﬁcation performance obtained using optimal mesh sizes. results -class -class classiﬁcation experiments show obtain signiﬁcantly better performance using features extracted features. employing random voxels lm-rand performs signiﬁcantly worse employing spatial functional neighbors. also observed obtain better performance using features extracted employment peak values bold responses using features extracted computing average bold responses. words ﬁgures error represents standard deviations corresponding performance value. participant ﬁrst bars depict performances methods employ functional spatial meshes whereas last four bars depict performances obtained using mesh models consider whole bold responses. observed standard deviation performance values obtained using various mesh sizes decreases temporal measurements considered statistical learning models. words methods employing temporal measurements recorded within neighborhoods robust changes mesh size methods employ temporal measurements. seed voxels. first compute correlations surrounding voxels seed voxel. then depict histograms correlations computed voxels surrounding voxels meshes. proposed local mesh models assume bold responses voxels located neighborhood similar bold response voxel represented linear combination bold responses nearest neighbors. words assume error linear regression model small enough cognitive stimulus represented local meshes edge weights meshes estimated minimizing expected square error. statistical analysis correlations voxels order understand voxels within neighborhood behave behavior differs behavior random voxel sets plot seed voxel randomly selected voxels spatially iii) functionally nearest neighbors. observe that sample voxels located within spatial functional neighborhoods perform similar presentation stimuli. analysis pearson correlation used compute pairwise relationship seed voxels surrounding voxels. analysis surrounding voxels selected random voxels spatially nearest neighbors seed voxels functionally nearest neighbors observe meshes formed random voxels mean distribution correlations around words randomly selected voxels statistically signiﬁcant linear relationship other. hand results show correlation values voxels observed highest frequency close histograms computed meshes formed using spatially functionally close voxels. observations indicate voxels modeled mesh better statistical relationship randomly selected meshes. therefore expect linear relationship among bold responses observed voxels located proposed neighborhood system provides reasonable data. statistical analysis models recall that represent voxel intensity values voxel linear combination values p-nearest neighbors models. obtain regression error mesh estimation seed voxels considering neighbors. next experiments analyze well seed voxels represented terms nearest neighbors exploring model estimation error proposed representation. local meshes around voxel namely spatially local mesh functionally local mesh models relationship among voxel bold responses spatial neighborhood system models relationship among voxel bold responses functional neighborhood deﬁned pearson correlation. observed considering whole bold responses recording cognitive stimulus employment spatial functional relationship among voxels enables model discriminative information fmri data. represent brain encoding decoding precess machine learning algorithm namely support vector machines observe features perform substantially better among features state-of-the-art mvpa models. observed classiﬁcation performances depend mesh size varies participant. also observed employment temporal measurements modeling mesh edge weights results less standard deviation various mesh sizes. therefore models employ temporal measurements robust effect using different mesh sizes extraction classiﬁcation features. future research direction development algorithms generalize ensemble local meshes model resting state disease fmri data. thank orhan firat baris nasir arman afrasiyabi burak velioglu hazal mogultay emre aksan sarper alkan insightful discussions fmri data gathering. also thank umram fmri recordings. work supported tubitak grant number notice measure takes values values closer represent better models. analysis computed values meshes participant formed samples around voxels. fig. plot histograms values computed meshes formed using random voxels spatially nearest voxels functionally nearest voxels. experiments seed voxels meshes formed using spatial functional neighbors represented terms neighbors observe mean values histograms respectively hand represent seed voxels terms random voxels observe larger estimation errors mean value reduces therefore employing spatial functional neighbors construction meshes results better model compared selecting random voxels. study propose method maps sequence brain volumes recorded cognitive stimulus brain graph consisting local meshes. proposed model called ensemble local meshes deﬁnes types orru pettersson-yeo marquand sartori mechelli using support vector machine identify imaging biomarkers neurological psychiatric disease critical review neurosci. biobehav. rev. vol. savoy functional magnetic resonance imaging brain reading detecting classifying distributed patterns fmri activity human visual cortex neuroimage vol. kamitani tong decoding visual subjective contents human brain neurosci vol. decoding seen attended motion directions activity human visual cortex. curr biol vol. mitchell hutchinson niculescu pereira wang just newman learning decode cognitive states brain images machine learning vol. abugharbieh modeling spatiotemporal structure fmri brain decoding using generalized sparse classiﬁers prni korea seoul pantazatos talati pavlidis hirsch decoding unattended fearful faces whole-brain correlations approach identify condition-dependent large-scale functional connectivity plos comput biol vol. richiardi achard bunke ville machine learning brain graphs predictive modeling approaches functional imaging systems neuroscience ieee signal process. tzourio-mazoyer landeau papathanassiou crivello etard delcroix mazoyer joliot automated anatomical labeling activations using macroscopic anatomical parcellation single-subject brain neuroimage vol. brett j.-l. anton valabregue j.-b. poline. region interest analysis using toolbox international conference functional mapping human brain sendai japan", "year": 2016}