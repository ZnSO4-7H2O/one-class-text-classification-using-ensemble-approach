{"title": "DeepSign: Deep Learning for Automatic Malware Signature Generation and  Classification", "tag": ["cs.CR", "cs.LG", "cs.NE", "stat.ML"], "abstract": "This paper presents a novel deep learning based method for automatic malware signature generation and classification. The method uses a deep belief network (DBN), implemented with a deep stack of denoising autoencoders, generating an invariant compact representation of the malware behavior. While conventional signature and token based methods for malware detection do not detect a majority of new variants for existing malware, the results presented in this paper show that signatures generated by the DBN allow for an accurate classification of new malware variants. Using a dataset containing hundreds of variants for several major malware families, our method achieves 98.6% classification accuracy using the signatures generated by the DBN. The presented method is completely agnostic to the type of malware behavior that is logged (e.g., API calls and their parameters, registry entries, websites and ports accessed, etc.), and can use any raw input from a sandbox to successfully train the deep neural network which is used to generate malware signatures.", "text": "abstract—this paper presents novel deep learning based method automatic malware signature generation classiﬁcation. method uses deep belief network implemented deep stack denoising autoencoders generating invariant compact representation malware behavior. conventional signature token based methods malware detection detect majority variants existing malware results presented paper show signatures generated allow accurate classiﬁcation malware variants. using dataset containing hundreds variants several major malware families method achieves classiﬁcation accuracy using signatures generated dbn. presented method completely agnostic type malware behavior logged input sandbox successfully train deep neural network used generate malware signatures. despite nearly exponential growth number malware method defending threats largely remained unchanged. anti-virus solutions detect malware analyze generate special handcrafted signature released update clients. manual analysis phase typically takes long time malware remains undetected keeps infecting computers. additionally even detected authors malware programs usually make minimal changes code variant undetected anti-virus software. mouse game malware developers anti-virus companies goes many years major malware programs release variant thousands computers infected. several methods proposed automatic malware signature generation e.g. signatures based speciﬁc vulnerabilities payloads honeypots etc. major problem associated methods target speciﬁc aspects malware thus allowing malware developers create undetected variant modifying small parts software. example malware spreading speciﬁc vulnerability found windows operating system another vulnerability system spread thus evading vulnerability-based signatures. paper present novel method signature generation rely speciﬁc aspect malware thus invariant many modiﬁcations malware code method relies training deep belief network i.e. deep unsupervised neural network would create invariant compact representation general behavior malware. recent years dbns proven successful generating invariant representations challenging domains method attempts similar principles generating invariant representations malware. proposed method consists following steps unsupervised training phase given dataset malware programs program sandbox generate text containing behavior program. then parse sandbox text convert binary bit-string feed neural network. next deep belief network implemented using deep denoising autoencoders trained layer-wise training. training completely unsupervised network aware labels sample. eight layers output layer contains neurons. thus resulting deep network basically generates signature containing ﬂoating point numbers program sandbox. large dataset containing several major malware categories several hundred variants each. trained generates signature malware sample. quality representation power generated signatures examined running several supervised classiﬁcation methods them. results show deep neural network achieves classiﬁcation accuracy tested unseen data attests representation power signatures dbn. next section review several previous approaches automatic signature generation. section describe approach section presents implementation details experimental results. section contains concluding remarks. difﬁcult successfully generate signatures used prevent attacks conventional methods usually ineffective zero-day malware several approaches suggested improve signature generation process. brieﬂy review several them. several methods cope malware variants analyzing trafﬁc autograph records source destination connections attempted outside network external source considered scanner made prespeciﬁed number attempts connect address network. deeming external source scanner thus potentially malicious autograph selects frequent byte sequence network trafﬁc source uses signature. scanner malware already signed autograph evade detection modifying frequent byte sequence. similar approach signature generation based network trafﬁc honeycomb analyzes trafﬁc honeypot. honeycomb uses largest common substrings generate signatures measure similarities packet payloads. payl sensor monitors information network tries detect malicious attacks using anomaly detection assuming packets associated zero-day attacks distinct normal network trafﬁc. nemean architecture semantic-aware network intrusion detection system normalizes packets individual sessions network renders semantic context. signature generation component clusters similar sessions generates signatures cluster. another semantic-aware method generates semantic-aware code templates speciﬁes conditions match templates programs checked. polygraph generates content based signatures several substring signatures expand detection malware variants. earlybird sifts invariant portion worm’s content appear frequently network spreads attempts spread. netspy also uses invariant portion network trafﬁc generated malware generate signature. majority anti-virus programs reply analyzing executable determine whether malware. filiol josse establish current anti-virus programs detects variant malware. propose method automatic signature generation analyzing executable’s code substrings measure statistical distribution code across variants malware. experiments performed short malware nimda code red/code blaster sober netsky beagle. method less accurate applied larger malware. real world malware large containing many modules sub-modules statistical analysis would sufﬁcient accurately classify them. auto-sign generates list signatures malware splitting executable segments equal sizes. segment signature generated list signatures subsequently ranked. method resilient small modiﬁcations executable malware evade method encrypting executable thus evading method inspects executable signature comparison. since current approaches mostly rely speciﬁc behavior malware signature generation malware variants could created minimal modiﬁcations would detected conventional methods. next section propose method signature generation based behavior program without focusing speciﬁc aspect executable network trafﬁc thus making difﬁcult malware variant evade detection. section provides novel approach signature generation. main question trying answer following possible generate signature program represents behavior invariant small scale changes? recent years deep learning methods proven successful accomplishing task computer vision. deep neural networks trained create invariant representations objects even object different position size contrast angle etc. network still detects object correctly. networks achieved error difﬁcult task imagenet unsupervised versions networks developed well e.g. deep belief networks training merely exposing networks images randomly taken youtube videos. krizhevsky hinton used deep autoencoders create short binary codes images based content method uses principles applies modeling behavior programs goal obtained representation would invariant small scale changes thus capable detecting variants malware. accomplish goal ﬁrst need represent behavior program ﬁxed sized vector would input neural network. train deep belief network would produce invariant representations input. output signature malware. behavior programs typically recorded running programs sandbox. sandbox special environment allows logging behavior programs results saved figure shows snippet logs recorded sandbox. sandbox records usually analyzed manually trying learn information would assist creating signature malware simplest method converting sandbox generated text ﬁxed size string using methods common natural language processing methods simplest unigram extraction. example given dataset text samples frequent words text text sample check words present. thus text sample represented sized bit-string. unlike language text ﬁles sandbox ﬁles contain variety information require several preprocessing stages extract useful content deep autoencoders create short signatures content; case content high level behavior program krizhevsky hinton’s case high level objects appearing image string \"api\" contains name function call etc.). however order remain domain agnostic possible propose treat sandbox simple text extract unigrams without preprocessing. markup tagged part ﬁles extracted well sounds absurd pose problem since learning system easily learn ignore irrelevant parts. speciﬁcally method follows following simple steps convert sandbox ﬁles ﬁxed size inputs neural network sandbox dataset extract unigrams remove unigrams appear ﬁles unigram count number ﬁles appears select highest frequency convert sandbox sized string checking whether unigrams appeared words ﬁrst deﬁne words participate dictionary sample check dictionary presence word thus produce binary vector. size binary vector. discussed previously malware variants make small changes code sufﬁcient evade classical signature generation methods. would like generate signature program resilient small changes order achieve goal create deep belief network training deep stack denoising autoencoders. autoencoder unsupervised neural network sets target values equal inputs i.e. number neurons input output layers equal optimization goal output neuron equal value input neuron hidden layer neurons used input output layers number neurons hidden layer usually fewer input output layers thus creating bottleneck intention forcing network learn higher level representation input. input ﬁrst mapped hidden layer output layer tried reconstruct weights encoder layer weights decoder layer tied autoencoders typically trained using backpropagation stochastic gradient descent recently demonstrated denoising autoencoders generalize much better basic autoencoders many tasks. denoising autoencoders time sample given network small portion corrupted adding noise given input ﬁrst corrupted given input layer network. objective function network output layer remains generating i.e. uncorrupted version input approach usually works better basic autoencoders diminishing overﬁtting network. recreate uncorrupted version input network forced generalize better determine high level patterns. additionally since network rarely receives input pattern diminished risk overﬁtting finally using denoising autoencoders hidden layer need necessarily smaller input layer note noise added training. prediction time network given uncorrupted input hidden layer input autoencoder added previous autoencoder. autoencoder trained similarly. using layer-wise unsupervised training deep stacks autoencoders assembled create deep neural networks consisting several hidden layers given input passed deep network resulting high level outputs. typical implementation outputs used supervised classiﬁcation required serving compact higher level representation data. approach train deep denoising autoencoder consisting eight layer –––––– step layer trained weights frozen subsequent layer trained etc. training phase deep network capable converting input vector ﬂoating point values. regard -sized vector signature program. note network trained using samples training future samples prediction mode i.e. receiving -sized vector produce output values without modifying weights. next section provides implementation details experimental results demonstrates resulting -sized vector indeed provides good invariant representation malware. dataset consists major categories malware variants category total samples. malware categories spread massively worldwide caused tremendous damage. hundreds variants created time modifying fig. illustration training. train ﬁrst autoencoder layer. weights previous layer build autoencoder them. weights taken ﬁrst autoencoder frozen. similarly take weights previous layer layer. proceed layer-wise training training eight layers ﬁnal dbn. malware categories used zeus carberp spyeye cidox andromeda darkcomet. malware families used carry wide range criminal tasks infected millions computers worldwide. several crackdowns enforcement agencies numerous countries resulted arrest hundred persons involved development malware variants widely used present day. following brief description malware classes. zeus. probably widely used trojan cyber crime ﬁrst detected july still widely used original format thousands variants continuously introduced evade anti-viruses. estimated alone infected million computers. several malware programs used stealing banking information based variations zeus. entire source code zeus freely available online facilitating creation malware based carberp. widespread malware silently downloads installs malware components infected system. ﬁrst discovered reported sixth popular malware stealing ﬁnancial information. currently clear estimates number infected systems amount money earned developers malware remains mostly underground. later versions heavily incorporates zeus code. developers malware made million six-month period alone. specializes stealing valuable personal information victim’s computer including banking login passwords credit card numbers social security numbers etc. cidox. remote administrative tool mainly used control infected systems. trojan selfreplicating rather spread manual targeting victims. ﬁrst malware hiding master boot record windows operating system instead hides network system locations. reconﬁgures ntfs system’s program loader thus becoming invisible system. andromeda. widespread non-replicating spam bots mostly spreads email-based infections. inactive certain duration recently resurfaced sophisticated features. malware ﬁrst identiﬁed february reported infected systems european countries. andromeda highly modular incorporate various modules darkcomet. remote administration tool ﬁrst discovered used wide range targeted february attacks ability take pictures webcam record conversations microphone attached gain full control infected machine. freely available online result popular remote administration tools. source code zeus leaked since many malware started incorporating code program. result times difﬁcult categorize variant either zeus malware families work programs dataset cuckoo sandbox popular open source sandbox tool malware analysis. cuckoo sandbox records native functions windows call traces details ﬁles created deleted ﬁlesystem addresses urls ports accessed program registry keys written etc. result saved text json format using procedure described previous section sandbox ﬁles converted sized bit-string rough ﬁxed size representation sandbox text ﬁle. described previous section train deep denoising autoencoder consisting eight layers layer-wise training. regularize network prevent overﬁtting dropout time input given network hidden unit randomly omitted network probability idea hidden unit cannot rely hidden units present. dropout essentially efﬁcient performing model averaging. instead training many separate networks applying networks test data calculating average predictions random dropout makes possible train huge number different networks reasonable time. prediction time neurons hidden layer present output multiplied note case training autoencoders learning step hidden layer. example training ﬁrst layer neurons hidden layer neurons affected dropout. prediction output hidden units halved. relu widely used training deep neural networks usually resulting faster convergence diminishes gradient vanishing problem especially affects deep networks parameters noise ratio denoising autoencoders training epochs learning rate starts linearly decays batch size momentum. penalty network regularization. note layer additional bias unit connected units subsequent layer. putting steps together constructed end-to-end method automatic signature generation program sandbox sandbox converted binary bit-string neural network deep neural network produces -sized vector output layer treat signature program. figure figure provides dimensional visualization data node malware signature. visualization generated using t-distributed stochastic neighbor embedding algorithm case reducing examine whether classiﬁcation accuracy supervised learning context improved weights trained neural network initial weights deep supervised neural network. supervised network exactly layers addition neurons output layer neurons added output layer softmax units minimizing cross-entropy loss function. training network input training samples predicting test samples results accuracy test data relatively substantial improvement results. paper reviewed past approaches generating signatures malware programs proposed novel method based deep belief networks. current approaches malware signature generation speciﬁc aspects malware thus malware variants easily evade detection modifying small parts code. proposed approach inspired recent success training deep neural networks produce invariant representations. ﬁrst malware sandbox convert sandbox long binary bit-string. bit-string deep -layered neural network produces values output layer. values used signature program. experimental results show signatures produced highly successful malware detection. signatures either used completely unsupervised framework used supervised malware classiﬁcation. results presented demonstrate unsupervised deep learning powerful method generating high level invariant representations domains beyond computer vision language processing speech recognition; applied successfully challenging domains malware signature generation. fig. -dimensional visualization malware signatures generated t-sne dimensionality reduction algorithm. color corresponds malware categories. note labels used coloring nodes only otherwise visualization completely unsupervised dbn. dimensionality data goal t-sne reduce dimensionality closer nodes original high dimensional space closer would -dimensional space. note labels used coloring nodes only otherwise visualization unsupervised dbn. ﬁgure illustrates variants malware family mostly clustered together signature space demonstrating signatures indeed capture invariant representations malware. clustering errors expected since explained subsection iv-a many malware classes parts code other distinction even amongst anti-virus detections blurred. labels given kaspersky anti-virus ground truth measure performance method. measure quality compact representation train supervised classiﬁer -sized vectors follows train classiﬁer vectors size predict test vectors higher prediction accuracy better generated signatures are. ﬁrst train classiﬁer using signatures predict correct labels prediction signatures. resulting accuracy alternatively running basic k-nearest neighbor algorithm prediction samples given label nearest neighbor training samples results accuracy high accuracy obtained training predicting solely compact signature space attests fact deepsign generates meaningful signatures malware resulting successful detection high percentage krizhevsky sutskever g.e. hinton. imagenet classiﬁcation deep convolutional neural networks advances neural information processing systems pages q.v. monga devin chen g.s. corrado dean building high-level features using large scale unsupervised learning proceedings international conference machine learning l.j.p. maaten g.e. hinton. visualizing high-dimensional data using t-sne. journal machine learning research newsome karp song. polygraph automatically generating signatures polymorphic worms proceedings ieee symposium security privacy pages ranzato c.s. poultney chopra lecun. efﬁcient learning sparse representations energy-based model. advances neural information processing systems pages press vincent larochelle lajoie bengio manzagol. stacked denoising autoencoders learning useful representations deep network local denoising criterion. journal machine learning research wang s.j. stolfo. anomalous payload-based network intrusion detection. recent advances intrusion detection p.j. werbos. beyond regression tools prediction analysis yegneswaran j.t. gifﬁn barford jha. architecture generating semantics-aware signatures proceedings usenix security symposium pages baltimore maryland august", "year": 2017}