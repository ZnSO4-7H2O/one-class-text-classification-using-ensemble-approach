{"title": "A Deep-structured Conditional Random Field Model for Object Silhouette  Tracking", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "In this work, we introduce a deep-structured conditional random field (DS-CRF) model for the purpose of state-based object silhouette tracking. The proposed DS-CRF model consists of a series of state layers, where each state layer spatially characterizes the object silhouette at a particular point in time. The interactions between adjacent state layers are established by inter-layer connectivity dynamically determined based on inter-frame optical flow. By incorporate both spatial and temporal context in a dynamic fashion within such a deep-structured probabilistic graphical model, the proposed DS-CRF model allows us to develop a framework that can accurately and efficiently track object silhouettes that can change greatly over time, as well as under different situations such as occlusion and multiple targets within the scene. Experiment results using video surveillance datasets containing different scenarios such as occlusion and multiple targets showed that the proposed DS-CRF approach provides strong object silhouette tracking performance when compared to baseline methods such as mean-shift tracking, as well as state-of-the-art methods such as context tracking and boosted particle filtering.", "text": "deep-structured conditional random field model object silhouette tracking shafiee∗ azimifar wong department systems design engineering university waterloo waterloo ontario canada department computer science engineering shiraz university shiraz fars iran m.s. z.a. a.w. conceived designed ds-crf model. m.s. z.a. a.w. worked formulation derivation solution ds-crf model. m.s. performed data processing. authors contributed writing paper editing paper. work introduce deep-structured conditional random field model purpose state-based object silhouette tracking. proposed ds-crf model consists series state layers state layer spatially characterizes object silhouette particular point time. interactions adjacent state layers established inter-layer connectivity dynamically determined based inter-frame optical flow. incorporate spatial temporal context dynamic fashion within deep-structured probabilistic graphical model proposed ds-crf model allows develop framework accurately efficiently track object silhouettes change greatly time well different situations occlusion multiple targets within scene. experiment results using video surveillance datasets containing different scenarios occlusion multiple targets showed proposed ds-crf approach provides strong object silhouette tracking performance compared baseline methods mean-shift tracking well state-of-the-art methods context tracking boosted particle filtering. structured prediction wishes predict structured states given structured observations interesting challenge problem important number different applications object silhouette tracking. goal object silhouette tracking identify silhouette object video sequence challenging number factors occlusion object motion changing dynamically video sequence object silhouette changing drastically time. methods joint distribution states observations modeled. classical example kalman filters predictions object made gaussian assumptions made states observations based predefined linear system dynamics. however since object motion follow gaussian behaviour non-linear system dynamics kalman filters often lead poor prediction performance object tracking. address issue non-linear system dynamics researchers made modified kalman filters extended kalman filter unscented kalman filter resolve issues associated non-gaussian behaviour objection motion. address issue non-linear system dynamics non-gaussian behaviour attention paid particle filters non-parametric posterior density estimation methods model arbitrary statistical distributions. however particle filters object tracking computationally expensive difficult learn especially case object silhouette tracking motion silhouette appearance change drastically dynamically time. recently significant interest discriminative methods object tracking generative methods. contrast generative methods discriminative methods directly model conditional probability distribution states given observations relax conditional independence assumption made generative methods. particular conditional random fields well-known discriminative graphical models used purpose structured prediction shown large number studies outperform generative models markov random fields motivated this number crf-based methods proposed purpose object tracking. taycher proposed human tracking approach using crfs similarity space corresponding potential functions. different poses considered tracked states within video sequence number states must predefined user. sigal used two-layer spatio-temporal models component-based detection object tracking video sequences. work object component object considered node graphical model given time. moreover graph edges correspond learned spatial temporal constraints. following work ablavsky proposed layered graphical model purpose partially-occluded object tracking. layered image plane used represent motion surrounding known object associated pre-computed graphical model. crfs also applied image-sequence segmentation random fields modeled using spatial temporal dependencies. shafiee proposed concept temporal conditional random fields purpose object tracking object’s next position estimated based current video frame subsequently refined template matching based subsequent video frame. limited existing literature. malik proposed crfs object silhouette segmentation video sequences background foreground distributions updated time. work boudoukh target silhouette tracked video sequence fusing different visual cues crf. particular temporal color similarity spatial color continuity spatial motion continuity considered feature functions. advantage method object silhouette tracking pixel-wise resolution achieved. promise inherent limitation faced existing models used predict object silhouettes video frame limited ability take greater advantage information video frames. complex models increase modeling power address limitations improved object silhouette tracking would also significantly increase computational complexity well model learning complexity. recently concept deep-structured models proposed facilitate increased modeling power without significant increase computational complexity model learning complexity incurred complex models. deep-structured models make intermediate state layers improve structured prediction performance inter-layer dependency layer previous layer. ratajczak proposed context-specific deep model local factors linear-chain crfs replaced sum-product networks. proposed deep-structured model composed multiple layers simple crfs layer’s input consisting previous layer’s input resulting marginal probabilities. given problem object silhouette tracking video frames contribute predicting object silhouette video frame motivated investigate efficacy deep-structured models solving problem. work propose alternative framework state-based object silhouette tracking based concept deep-structured discriminative modeling. particular introduce deep-structured conditional random field model consisting series state layers state layer spatially characterizes object silhouette particular point time. interactions adjacent state layers established inter-layer connectivity dynamically determined based inter-frame optical flow. incorporate spatial temporal context dynamic fashion within deep-structured probabilistic graphical model proposed ds-crf model allows develop framework accurately efficiently track object silhouettes change greatly time. furthermore modeling framework require distinct stages prediction update require independent training dynamics object silhouette tracked. experimental results show proposed framework estimate object silhouettes time situations occlusion well large changes object silhouette appearance time. within statistical modeling framework describe problem object silhouette tracking classification problem goal classify pixel video frame either foreground background. necessary generative modeling approaches. proposed ds-crf modeling framework object silhouette tracking object silhouette corresponding background pixel level video frame characterized state layer series state layers interconnected based inter-frame optical flow information form deep-structured conditional random field model facilitates interactions amongst adjacent state layers. detailed description crfs context object silhouette tracking followed detailed description proposed ds-crf model provided below. conditional random fields amongst effective widely-used discriminative modeling tools developed past decades. idea modeling first proposed laffety based markov property directly models conditional probability states given measurements normalization constant essentially so-called partition function gibbs fields respect possible values represents cliques encodes potential functions non-negative value condition. feature function respect clique denotes weight feature function learned. feature function expresses relationship amongst random variables clique. number feature functions respect clique denoted two-dimensional crfs applied many computer vision problems segmentation classification. particular undirected structure images leads efficient performance computer vision although early crfs incorporate spatial relationships amongst random variables model relationships repeat sequentially many applications visual tracking incorporating property framework lead better modeling. appropriate feature functions speeds convergence training process whereas inappropriate feature functions cause inconsistent results inference. illustrate importance selecting appropriate feature functions object silhouette tracking train predicting object silhouette frame based previous frame using spatial feature functions without incorporating feature function describing temporal relationship amongst frames. frames consist simulated object small movement frames. seen fig. prediction result object silhouette poor could learn object motion dynamics absence temporal feature functions leading poor object silhouette tracking performance. performance shafiee proposed incorporation temporal feature functions inter-frame optical flow modeling framework better take advantage temporal relationships visual tracking. although approach showed promising results illustrated feasibility temporal processing visual tracking modeling framework makes motion information previous frame estimate object position current frame cannot figure example modeling object motion using spatial feature functions object silhouette tracking. first column shows temporal observation second column shows label used training model object silhouette tracking series interconnected state layers making model along corresponding temporal observations allow better modeling complex motion shape dynamics occur realistic scenarios. here describe proposed ds-crf model detail follows. first graph representation ds-crf model presented. second manner inter-layer connectivity within ds-crf model established dynamically based motion information derived temporal observations presented. third feature functions incorporated ds-crf model object silhouette tracking presented. optical flow extracted observed frames track target location video. tracking result encoded black white field demonstrating target location black pixels. graph represent proposed ds-crf model consists several state layers corresponding times shown fig. state layer characterizes object silhouette specific time step modeling conditional figure flow diagram proposed framework. observed frames utilized predict target position. several feature functions incorporated model. extracted features observed frames utilized measurement layer object location inferred black white plane considered label field random field. layers corresponding node incorporate object motion dynamics model. such inter-layer connectivity carries energy corresponding unary potential model specified dynamically adaptively proposed framework based motion information derived temporal observations described detail next section. figure graph representation deep-structured conditional random field model. model labels observations incorporated model object silhouette’s motion. different types clique connectivity exist model inter-layer clique connectivity nodes within layer shown inter-layer clique connectivity nodes adjacent layers. end-nodes inter-layer clique determined based motion information. last three frames chosen provides sufficient information reasonably model accelerated motions given acceleration velocity computed thus allowing handling various motion situations short time steps. discussed above intra-layer connectivity nodes layer incorporate spatial context inter-layer connectivity layers incorporate temporal context ds-crf model. simplest approach establishing inter-layer connectivity nodes different layers would simply create inter-layer cliques nodes represent spatial location different time steps. creates simple regular spatial-temporal lattice fixed across time. however appropriate object silhouette tracking temporal neighbors established fixed inter-layer connectivity structure would share relevant information since target objects undergoing drastic motion shape changes time thus feature functions structure would hold little meaning. therefore motivated establish inter-layer connectivity propose ds-crf model dynamic adaptive manner motion information derived temporal observations used determine inter-layer cliques state layer. shown fig. inter-layer clique structures established based inter-frame optical flow temporal observations mt−. seen nodes corresponding target object form inter-layer clique structures nodes previous state layer characterize different spatial locations motion nodes corresponding background form inter-layer cliques nodes previous state layer corresponding spatial location since motion position. such motion-guided dynamic inter-layer connectivity strategy allows better characterization temporal context object silhouette tracked allow feature functions hold meaning. addition inter-layer connectivity state layers important also describe feature functions incorporated proposed ds-crf model. feature functions optical flow target appearance iii) spatial coherency edge. figure inter-layer connectivity. inter-layer connectivity nodes adjacent layers determined based motion information computed consecutive frames. inter-layer cliques constructed dynamically adaptively based motion information corresponding node layer seen corresponding temporal neighbor node ykt− based inter-layer clique structure determined inter-frame optical flow. gray color correspond nodes associated target object movement previous frame. optical flow crucial feature function described velocity pixel directions adjacent frames estimated inter-frame optical flow. optical flow approximation motion based upon local derivatives given sequence images specifies moving distance pixel adjacent images denotes spatial intensity gradient denotes motion directions optical flow assumes change pixel’s intensity corresponds displacement pixels here inter-frame optical flow applied temporal observations. target appearance model utilizes simple unary appearance feature functions based features describing target object’s appearance including color target appearance previous frame. obtain unary feature function label spatial coherency target scene spatial color coherency. term implies reflection neighboring nodes image. node consisted target strong relations nodes corresponding target silhouette. words target appearance coherent time frame. adding feature function ds-crf tracking framework proposed algorithm track target object’s silhouette despite large changes time. rough segmentation algorithm enforces label consistency among nodes segment produced segmentation result frame log-likelihood function concave parameters chosen global maximum obtained gradient vector partial derivatives respect parameter becomes zero. differentiating respect parameter gives exact solution exist; therefore parameters determined iteratively using gradient descent optimization. ds-crf training performed belief propagation method probability random variables represented graph given observations mt−t− decoding performed assigning output variable determining states maximum probability based ds-crf model described above develop state-based framework tracking object silhouettes across time video sequence follows. first frames annotated user initialization. velocity computed based frames ds-crf starts tracking procedure third frame. ds-crf track objects automatically frame optical flow performed used last seen frames time. since optical flow computed time frame parameters trained based velocity model needs train time. shape appearance temporal context motion dynamics within proposed tracking framework. contribution aspect spatial temporal information within ds-crf model based weights learned pixels). example temporal observation corresponding binary label field shown fig. binary label setup allows reduced computational complexity training process also convergence. well suited single target object silhouette tracking less appropriate multi-target object silhouette tracking. address issue introduce data association procedure connected components binary label field assigned target objects tracked. accomplished matching object silhouettes determined previous time step connected components binary field current time step determine best template matches evaluate performance proposed ds-crf model purpose object silhouette tracking number different experiments performed allow better understanding analysis model different conditions factors. first experiments involving video simulated object different motion dynamics performed study capability ds-crf model handling objects changing motion dynamics. second experiments performed videos humans moving within subway station pets database used study capability ds-crf model handling object silhouette tracking scenarios occlusion objects change drastically shape size time. experiment examine ability proposed ds-crf method tracking silhouette object different motion dynamics time. accomplish this produce three video sequences consisting simulated object undergoing following motion dynamics time motion object undergoes acceleration remain constant shape time. motion object undergoes size change time moves constant velocity. motion object undergoes acceleration well size change time. first rows fig. respectively. proposed method used predict object silhouette time based video sequences. predicted results shown second rows fig. respectively. observed proposed method able provide accurate object silhouette tracking results three video sequences thus illustrate ability handle uncertainties motion object appearance time. experiment examine capability ds-crf model handling object silhouette tracking scenarios occlusion objects change drastically shape size time. accomplish this made three different video sequences pets database depicting human targets moving within subway station used illustrate different aspects capability proposed method subway sequence used illustrate capability proposed method handling object occlusions. object target sequence crossing hallway right scene left scene becomes occluded person walking left scene right scene. method handling multiple object silhouette tracking time. target objects sequence crossing hallway bottom scene scene third object target crossing hallway scene bottom scene. mean-shift tracking mean-shift tracking based non-parametric feature space analysis goal determine maxima density function case visual tracking based color histogram target object. goal achieved iterative optimization strategy locates target object position near previous object position based similarity measure bhattacharyya distance. utilizes specific trained detector semi-supervised fashion locate target consecutive frames. goal method locate possible regions look similar target. context tracking identifies figure examined simulated motion results. ds-crf examined three different simulated motion shape dynamics time. object undergoes acceleration remain constant shape time object undergoes size change time moves constant velocity object undergoes acceleration well size change time. table quantitative results different video sequences. accuracy visual silhouette tracker method reported sequence since sequence result provided authors refereed mean-shift tracking context tracking visual silhouette tracker boosted particle filtering respectively. differentiates target object ‘distracters’ within possible regions based confidence measure derived based posterior probability supporting features. boosted particle filtering particle filtering discriminative tracking approach approximates posterior dirac measure using finite }i=...n sample candidate particles drawn based particles proposal distribution. importance weight particle updated according previous weight importance function often transition prior. that particles re-sampled using importance weights. here employed boosted particle filter proposed incorporates mixture particle filtering ideally suited multi-target tracking. different visual cues means conditional random fields. object silhouette estimated every frame according visual cues including temporal color similarity spatial color continuity spatial motion continuity. incorporated energy functions minimized within conditional random field framework. evaluated subway subway sequences implementations used designed tracking multiple object targets within scene. visual silhouette tracking method compared subway sequence object silhouette results sequence provided authors finally boosted particle filtering proposed ds-crf method evaluated three sequences situation object tracked changes significantly size shape time. fig. shows single-object object silhouette tracking results tested tracking methods subway sequence. observed mean-shift tracking context tracking boosted particle filtering methods lose object target completely visual silhouette tracking method proposed ds-crf method able track object silhouette through. also observed object silhouette obtained using proposed method accurate obtained using visual silhouette method. results illustrate capability proposed ds-crf method tracking object silhouette time spite drastic changes size shape time. figure example tracking results subway. observed mean-shift tracking context tracking boosted particle filtering methods lose object target completely visual silhouette tracking method proposed ds-crf method able track object silhouette through. also observed object silhouette obtained using proposed method accurate obtained using visual silhouette method. methods subway sequence. observed mean-shift tracking context tracking boosted particle filtering methods lose object target completely proposed ds-crf method able track object silhouette despite occluded another person. results illustrate capability proposed ds-crf method tracking object silhouette time spite object occlusion. figure example tracking results subway. observed mean-shift tracking context tracking boosted particle filtering methods lose object target completely proposed ds-crf method able track object silhouette despite occluded another person. situation wish track multiple object silhouettes time. fig. shows multiple-object silhouette tracking results tested tracking methods subway sequence. observed boosted particle filtering method able track three object targets completely loses object targets result crossing paths object targets. furthermore boosted particle filtering method provide pixel-level object silhouettes able track bounding boxes. hand proposed ds-crf method able track three object silhouettes pixel-level through. results illustrate capability proposed ds-crf method tracking multiple object silhouettes time reliable manner. figure example tracking results subway. observed boosted particle filtering method able track three object targets completely loses object targets result crossing paths object targets. furthermore boosted particle filtering method provide pixel-level object silhouettes able track bounding boxes. hand proposed ds-crf method able track three object silhouettes pixel-level through. here proposed deep-structured conditional random field model object silhouette tracking. model series state layers used characterize object silhouette points time within video sequence. connectivity state layers formed dynamically based inter-frame optical flow allows interactions adjacent state layers facilitate utilization spatial temporal context within deep-structured probabilistic graphical model. experimental results showed proposed ds-crf model used facilitate accurate efficient pixel-level tracking object silhouettes change greatly time well different situations occlusion multiple targets within scene. experiment results using simulated data real-world video datasets containing different scenarios demonstrated capability proposed ds-crf approach provided strong object silhouette tracking performance compared existing tracking methods. uncertainties object motion dynamics size shape changes time inter-layer connectivity established dynamically based inter-frame optical flow information. inter-layer connectivity established statically state layers deep-structured model feature functions would hold little meaningful relationships temporal domain object accelerates changes size time. making inter-frame optical flow information determine inter-layer connectivity adjacent state layers feature functions maintain meaning time guiding prediction process. another important contributing factor incorporation object shape feature functions enforces proposed method consider object shape variations time also aids handling changes size shape time. descriptor matching better guide establishment inter-layer connectivity situation large object displacements within short time video sequence. furthermore explore extension ds-crf model high-order fully-connected clique structures improve modeling spatial relationships better object silhouette boundaries. finally explore application proposed ds-crf model purpose improved video saliency detection using texture distinctiveness-based feature functions improved content-based video retargeting using energy gradient feature functions work supported natural sciences engineering research council canada canada research chairs program ontario ministry economic development innovation. financial support provided shiraz university work also appreciated.", "year": 2015}