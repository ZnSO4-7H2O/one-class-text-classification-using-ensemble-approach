{"title": "Is Big Data Sufficient for a Reliable Detection of Non-Technical Losses?", "tag": ["cs.LG", "cs.AI"], "abstract": "Non-technical losses (NTL) occur during the distribution of electricity in power grids and include, but are not limited to, electricity theft and faulty meters. In emerging countries, they may range up to 40% of the total electricity distributed. In order to detect NTLs, machine learning methods are used that learn irregular consumption patterns from customer data and inspection results. The Big Data paradigm followed in modern machine learning reflects the desire of deriving better conclusions from simply analyzing more data, without the necessity of looking at theory and models. However, the sample of inspected customers may be biased, i.e. it does not represent the population of all customers. As a consequence, machine learning models trained on these inspection results are biased as well and therefore lead to unreliable predictions of whether customers cause NTL or not. In machine learning, this issue is called covariate shift and has not been addressed in the literature on NTL detection yet. In this work, we present a novel framework for quantifying and visualizing covariate shift. We apply it to a commercial data set from Brazil that consists of 3.6M customers and 820K inspection results. We show that some features have a stronger covariate shift than others, making predictions less reliable. In particular, previous inspections were focused on certain neighborhoods or customer classes and that they were not sufficiently spread among the population of customers. This framework is about to be deployed in a commercial product for NTL detection.", "text": "abstract—non-technical losses occur distribution electricity power grids include limited electricity theft faulty meters. emerging countries range total electricity distributed. order detect ntls machine learning methods used learn irregular consumption patterns customer data inspection results. data paradigm followed modern machine learning reﬂects desire deriving better conclusions simply analyzing data without necessity looking theory models. however sample inspected customers biased i.e. represent population customers. consequence machine learning models trained inspection results biased well therefore lead unreliable predictions whether customers cause not. machine learning issue called covariate shift addressed literature detection yet. work present novel framework quantifying visualizing covariate shift. apply commercial data brazil consists customers inspection results. show features stronger covariate shift others making predictions less reliable. particular previous inspections focused certain neighborhoods customer classes sufﬁciently spread among population customers. framework deployed commercial product detection. losses power grids grouped technical losses losses occur naturally non-technical mainly caused internal electrical resistance infrastructure components. non-technical losses appear power distribution include limited following causes meter tampering order record lower consumptions bypassing meters rigging lines power source arranged false meter readings bribing meter readers faulty broken meters technical human errors meter readings data fig. example spatial bias large city close whereas small city located interior country. weather small city undergoes stronger changes year. subsequent change electricity consumption year triggers many inspections. consequence inspections carried small city. therefore sample customers inspected represent overall population customers. practice ntls primarily consist electricity theft cause major problems electricity providers including ﬁnancial losses decrease stability reliability. furthermore ntls lead extra limited natural resources turn increases pollution. range total electricity distributed countries brazil india malaysia lebanon predominant research direction reported recent literature machine learning/data mining methods learn anomalous behavior customer data known irregular behavior reported inspection results. however carrying inspections expensive requires physical presence technicians. therefore important trained models make accurate predictions. last ﬁfteen years data paradigm followed machine learning gather data rather improving models. hence assume simply customer inspection data would help detect accurately. however many cases data biased depicted fig. concretely customers inspected sample overall population customers. example spatial bias. hence inspections represent overall population customers. consequence learning inspection results bias learned making predictions less reliable. technical terms bias called covariate shift sampling bias aside spatial covariate shift types covariate shift data meter type connection type etc. extensively reviewed state previous work identiﬁed open challenges detection previously addressed class imbalance evaluation metric selection showed large-scale machine learning approach outperformed rule-based boolean fuzzy logic expert systems furthermore shown neighborhood customers yields signiﬁcant information order decide whether customer causes best knowledge aware previously published research addresses topic detection. convinced accurate study topic necessary order advance detection reducing covariate shift data sets future. electrical engineering perspective energy balance methods applied detection ntl. however requires topological information distribution network reﬂect change network. practice network topology undergoes rapid changes emerging countries i.e. countries particular issue. predominant methodology used literature employing artiﬁcial intelligence anomaly detection problem. historically based rule-based expert systems incorporate expert knowledge. however many cases describing problem domain challenging complexity temporal dynamics. therefore years ﬁelds machine learning data mining become popular. methods learn models data without explicitly programmed. data customers used training neural network. uses average consumption previous months customer features location type customer voltage whether meter reading notes period. test accuracy precision recall reported. consumption proﬁles brazilian industrial customer proﬁles analyzed customer proﬁle contains features including demand billed maximum demand installed power etc. setting support vector machine slightly outperforms k-nearest neighbors neural network test accuracies respectively reported. paper address challenge covariate shift. refers problem training data production data different distributions. fact leads unreliable predictors learning training data. section describe quantify historically covariate shift long-standing issue statistics. example literary digest sent questionnaires order predict outcome presidential election. received returns. nonetheless predicted result proved wrong. reason used registrations phone directories compile list recipients. time households phone represented biased sample overpopulation. contrast george gallup interviewed handpicked people unbiased sample population. consequence gallup could predict outcome election well customers previously inspected sample overall population customers. however sample biased i.e. population customers visualized fig. reason previous inspections largely focused certain criteria sufﬁciently spread among population. problem training data production data different distributions initially addressed ﬁeld computational learning theory also calls covariate shift sampling bias sample selection bias. deﬁned mathematical terms follows domain feature space label space examples drawn independently denotes selected example whereas denotes opposite. training performed sample comprises examples implies independent given case selected sample biased bias depends feature vector problem called covariate shift past ﬁfteen years data paradigm followed summarized it’s best algorithm wins. it’s data. concretely approach reﬂects desire deriving better conclusions simply analyzing data without necessity looking theory models. however taking covariate shift account data sufﬁcient. case less data representative seems answer. affected covariate shift whereas others local learner prediction learner depends asymptotically hence affected covariate shift. examples logistic regression hardmargin support vector machine global learner prediction learner depends asymptotically both hence affected covariate shift. example decision tree learners recursively split input space choosing remaining discriminative feature data set. predict learned tree traversed top-down. examples naive bayes soft-margin svm. kullback-leibler divergence measure difference probability distributions. however challenging adapt measure multi-dimensional data combination discrete continuous features common machine learning deﬁne criteria distance indicator covariate shift. therefore preferred methodology quantifying covariate shift first feature assign values training data production data respectively. data sets furthermore merged data set. latter split training test objective develop supervised learning method capable predicting feature using performance classiﬁer quantiﬁed using matthews correlation coefﬁcient measures accuracy binary classiﬁers taking account imbalance classes ranging greater greater covariate shift. concrete threshold covariate shift depends problem however proposed though automatically imply lack covariate shift signiﬁcant value indicator covariate shift. model selection want model able distinguish distributions. thus maximizing test equivalent ﬁnding best two-class classiﬁcation production data original training data. this optimize important tree model parameters randomly drawing probability distributions max. number leaves max. number levels measure purity split min. number samples required leaf min. number samples required split node. cross-validation also split data folds order reduce overﬁtting. leads reliable model covariate shift quantiﬁcation. model denoted average mccs test sets. standard deviation test mccs serves reliability lower standard deviation reliable note inspection results taken account covariate shift concerns distributions inputs. algorithm quantifying covariate shift. result reliability selected train data.add eature selected prod data.add eature data selected selected olds olds model model candidates return result reliability data used paper comes electricity provider brazil. first consists customers. complete list customer master data used following experiments depicted table categorical features class voltage number wires contract status meter type converted one-hot coding. second data contains inspection results inspection date presence fraud irregularity type inspection notes. customers inspected least remaining customers never inspected. third meter readings consumption date meter reading number days meter readings. computations server cores ram. entire code implemented python using scikit-learn machine learning. scikit-learn allows distribute training cross-validated classiﬁers among cores. maps plotted using cartopy total results plots reported paper computed hours using infrastructure. implementation available open source http//github.com/pglauner/spatialbiasntl. following experiments -fold crossvalidation. experiment train trees different tree models trained folds. optimize tree model parameters randomly drawing predeﬁned uniform probability distributions depicted table chosen ranges based best practice recommendations experience. furthermore classes imbalanced i.e. examples non-inspected customers inspected ones. order take account training associate weights classes examples minority class stronger impact. following experiments compute different global types covariate shift using customers experiment. therefore split customers different geographical areas. shift features. report results table iii. denotes maximum average mccs test sets among tree models trained feature. denotes standard deviation test scores reliability measure max. overall strongest covariate shift location value means previous inspections mostly biased towards location customers. location also feature beyond threshold mentioned section iii-d. features class number wires meter type threshold greater almost covariate shift previous inspections towards voltage contract status features. standard deviation mccs greatest contract status. reason strong overﬁt folds. mccs much lower standard location number wires location class location meter type location voltage location contract status class number wires class meter type class voltage number wires meter type class contract status number wires voltage number wires contract status meter type voltage meter type contract status voltage contract status next create compound features composed multiple features. great number possible combinations assess -combinations well combination features. visualize mccs -combinations fig. reported mccs table -combination comprising features computed maximum covariate shift compound features. therefore spatial covariate shift contributes covariate shift most however covariate shifts contribute fraction well. entirely focus spatial covariate shift since strongest among different types covariate shift. following experiments compute local covariate shifts splitting customers different locations. data provides following divisions following hierarchical order local spatial covariate shifts four levels granularity fig. customers located brazilian state. observe spatial covariate shift smoothened regional level fig. becomes increasingly granular municipal local neighborhood levels figs. respectively. also notice spatial covariate shifts lower levels tend increase depicted increasing upper limits color bars. fig. spatial covariate shift different levels granularity. division compute median location respective customers assign ccmax nearest interpolation generate local covariate shift maps. note maps visualize fraction political divisions. cropped computed maps paper privacy purposes. affected covariate shift location followed class number wires meter type. classiﬁers features voltage contract status instead tend reliable. also shown spatial covariate shift exists different levels granularity municipalities localities strong covariate shifts exist. subsequently local covariate shifts signiﬁcant impact covariate shifts higher levels even globally entire data set. therefore using inspection results data training predictor data perspective leads biased models reliably detect ntl. consequence reducing spatial covariate shift data must priority order learn reliable predictors. however ﬁner hierarchical granularity divisions cannot used computations following reasons. first using -fold cross-validation training possible division least customers. second folds used training must examples computed classes. third denominator case test cannot computed fold model mccs remaining folds used cross-validation. mccs computed division skip plotting. instance effect become apparent neighborhood level west state population density. covariate shift problem training data production data different distributions. work proposed novel framework quantifying visualizing covariate shift spatial data sets. context nontechnical loss detection showed covariate shift inspected customers overall population customers. used real world data brazil consists customers inspection results. showed features stronger covariate shift others. particular spatial covariate shift strongest appears different hierarchical levels. subsequently machine learning models trained data lead unreliable predictions. contribution allow domain experts model reliable rules predictors. would like thank lautaro dolberg diogo duarte yves rangoni choice technologies holding s`arl contributing many good ideas discussions. work partially funded luxembourg national research fund. depuru wang devabhaktuni green high performance computing detection electricity theft international journal electrical power energy systems vol. nagi tiong improving svm-based nontechnical loss detection power utility using fuzzy inference system ieee transactions power delivery vol. oliveira kagan meffe method computation technical losses electrical power distribution systems electricity distribution part contributions. cired. international conference exhibition vol. costa alberto portela fraud detection electric power distribution networks using ann-based knowledgediscovery process international journal artiﬁcial intelligence applications vol. ramos souza gastaldello identiﬁcation feature selection non-technical losses industrial consumers using software weka industry applications ieee/ias international conference glauner boechat dolberg large-scale detection non-technical losses imbalanced data sets innovative smart grid technologies conference ieee power energy society. ieee glauner meira dolberg neighborhood features help losses data sets ieee/acm detecting non-technical international conference data computing applications technologies banko brill scaling large corpora natural language disambiguation proceedings annual meeting association computational linguistics. association computational linguistics baddeley b´ar´any schneider spatial point processes applications stochastic geometry lectures given cime summer school held martina franca italy september", "year": 2017}