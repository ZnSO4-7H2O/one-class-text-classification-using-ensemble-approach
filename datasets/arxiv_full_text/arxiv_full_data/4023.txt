{"title": "Approximate evaluation of marginal association probabilities with belief  propagation", "tag": ["cs.AI", "cs.CV"], "abstract": "Data association, the problem of reasoning over correspondence between targets and measurements, is a fundamental problem in tracking. This paper presents a graphical model formulation of data association and applies an approximate inference method, belief propagation (BP), to obtain estimates of marginal association probabilities. We prove that BP is guaranteed to converge, and bound the number of iterations necessary. Experiments reveal a favourable comparison to prior methods in terms of accuracy and computational complexity.", "text": "recently practical applications methods relied simple heuristics; recent survey found example cheap jpda replaces joint weights heuristic maintains form behaviour sense linear joint integrated provides heuristic modiﬁcation standard weights model impact tracks incorporating estimate probability measurement used another track. linear multitarget ipda improves upon approach treating measurements targets additional clutter. approach takes expression exact two-target case heuristically extends multi-target case. methods based pruning events joint weight calculation. near-optimal jpda averages highly likely joint events ﬁrst ﬁnding maximum posteriori event repeating calculation modiﬁed problems removing elements chosen map. jpda* calculates association conditioned subset targets hypothesised detected subset measurements hypothesised target-originated. signiﬁcant improvements made recently towards highly accurate exact approaches. efﬁcient hypothesis management method exploits redundancy present many problems provide exact evaluation reduced complexity effectively providing improved version junction tree algorithm however cases complexity remains exponential. markov chain monte carlo data association provides randomised fully polynomial time approximation scheme estimating probabilities computational complexity method limits practical use. subsequent initial publications related correlation decay method proposed providing deterministic fptas. show section computational complexity approach remains problematic. paper develops practical approximation approach data association based belief propagation demonstrating remarkable accuracy proving convergence algorithm despite presence cycles graphical model formulation. abstract—data association problem reasoning correspondence targets measurements fundamental problem tracking. paper presents graphical model formulation data association applies approximate inference method belief propagation obtain estimates marginal association probabilities. prove guaranteed converge bound number iterations necessary. experiments reveal favourable comparison prior methods terms accuracy computational complexity. recent years graphical models emerged powerful tool inference learning large scale systems. promise graphical models tracking problems demonstrated formulation former focused sensor networks sensor narrow ﬁeld view. non-overlapping regions deﬁned association variables instantiated hypothesise joint association events targets measurements within region. graphical models studied similar application present study consider classical data association problem single sensor surveils large number targets. target give rise measurement measurement related target. focus approximate solution core problem data association calculating marginal measurementto-target association probabilities used joint probabilistic data association multi-target mixture reduction related methods calculation marginal association probabilities closely related computation permanent non-negative matrix problem deﬁnition p-complete complexity class brute force exact calculation quantities intractable smallest problems. intelligence surveiltechnollance jason.williamsdsto.defence.gov.au organisation australia jason williams also school electrical electronic engineering university adelaide australia. roslyn also research school computer science australian national university australia. imating marginal association probabilities. motivated success method ﬁrst proposed subsequently studied developed independently evaluated tracking context preliminary paper contributions paper follows proof convergence method common case tracking probability detection nonunity false alarm rate non-zero. preliminary version result published general proof developed parallel announced available analysis computational complexity method providing guarantees number iterations required function problem parameters interpretation parameters tracking context. thorough experimental evaluation accuracy approximation challenging tracking problems comparison state-of-the-art methods tracking literature. comparison reveals unique position proposed approximation accuracy versus computation time trade-off. section introduce problem data association particular formulation utilise introducing formalism graphical models section derive approach prove convergence bound computation time examine practical stopping criteria. section compare contrast method three closely related approaches. section present thorough experimental comparison approach stateof-the-art alternatives. data association model analyse variant classical model incorporates uncertainty target existence using random ﬁnite formalism focus paper approximate calculation marginal association probabilities; describe model concreteness order provide intuition model parameters impact number iterations required convergence. details model derivation ﬁlters present algorithm found abbreviated notation etc. represent probability density function continuous random variable corresponding value conditioned etc. etc. represent point mass function discrete random variable corresponding value conditioned etc.. symbol refer target index refer measurement index. target give rise measurement measurement result target targets arrive time according poisson point process intensity λnew. target dynamics models important analysis wish perform. measurement likelihood complete measurements including time denoted assumptions measurements either false alarms targets poisson point process intensity scribed latent association variables comprising target association variable value index measurement target hypothesised associated measurement association variable value index target measurement hypothesised associated note sets association variables entirely redundant given information either reconstructed perfectly. following sections choice formulation results approximate algorithm guaranteed convergence remarkable accuracy. clarity neglect uncertainty target existence introduction; shown incorporation phenomenon results slightly modiﬁed weights assuming prior distribution factors i.e. standard approach pioneered extended incorporate target existence similarly using closely related methods hypothesis-conditioned updated distribution calculated using standard state estimation methods kalman ﬁlter unscented kalman ﬁlter particle ﬁlter depending model use. challenging problem computation marginal probabilities collectively ensuring redundant sets association variables consistent i.e. event problem estimating marginal association probabilities arises formulations tracking problems extensions probabilistic multiple hypothesis tracker topic interest current paper might suppose joint distribution association events approximated product marginals; shown product form distribution minimises kullback-leibler divergence graphical models graphical models represent manipulate joint probability distributions many variables efﬁciently exploiting factorisation. kalman ﬁlter hidden markov model examples algorithms exploit sparsity particular kind efﬁciently conduct inference systems involving many random variables. inference methods based graphical model framework generalise algorithms wider variety state spaces dependency structures. graphical model methods developed undirected graphical models directed graphical models factor graphs. work consider subclass pairwise undirected models involving nodes edges joint distribution written inference conducted tree-structured graphs using belief propagation proceeds passing messages neighbouring nodes. denote µi→j message sent node node iterative update equations then obvious reasons also known sum-product algorithm. summations replaced maximisation operations arrive max-product generalises well-known viterbi algorithm providing joint state variables graph. convergence sum-product marginal distribution node calculated general setting joint distribution product maximal cliques since graph undirected assume symmetric i.e. need incorporate factors distribution. inference cyclic graphs challenging. conceptually always convert arbitrary cyclic graph tree merging nodes practical problems dimensionality agglomerated variables prohibitive. applied cyclic graphs; practically simply involves repeated application convergence occurs unfortunately neither guaranteed converge right answer converge all. nevertheless perhaps surprisingly exhibited excellent empirical performance many practical problems example popular iterative turbo decoding algorithm shown instance applied cyclic graph current understanding cyclic graphs stems largely shown recover exact marginal probabilities optimisation convex function known gibbs free energy term joint entropy distribution. optimisation intractable points family variational inference methods approximate objective function feasible enable calculation marginal probability estimates without ever manipulating full joint distribution shown solves approximation objective approximated bethe free energy feasible approximated distributions pairwise joint distributions along edges consistent node marginals message iterates viewed general iterative method solving series ﬁxed point equations derived optimality conditions bethe free energy variational problem marginal probability estimates obtained using referred beliefs. approximations made lead difﬁculties certain circumstances. firstly whereas gibbs free energy convex bethe free energy general neither concave convex. practical behaviour errors often either small large general intuition failure convexity leads large errors; families algorithms tree re-weighted product replace bethe free energy convex surrogate. secondly approximation feasible admit points correspond valid probability distribution hence solution infeasible. methods seeking tighten feasible include fig. graphical model formulation employed data association. value random variable index measurement target hypothesised associated value random variable index target measurement hypothesised associated. reduction effectively sum-product version simpliﬁed algorithm equivalent form provided section iii-c simpliﬁed update equations prove convergence algorithm then section iii-d bound number iterations required convergence. section iii-e calculate expected value quantity involved bound number iterations required providing intuition practical behaviour method. section iii-f provide criterion terminating computation guarantee deviation converged solution. model study illustrated fig. bipartite model target association variables connected measurement association abbreviating notation t→bj refer respectively. omitting simplicity message update time index equations matching problems involve graphs pairs nodes matched unmatched. subset edges called matching edges matching incident node. maximal matching additional edge matched maintaining matching. finding likely data association corresponds assignment problem formulated maximum weighted matching problem bipartite graph seek edges maximises weights). recent years several authors applied graphical models matching problems. shown max-product used optimally solve assignment problems time comparable well-known auction algorithm. result extended showing max-product converges general matching problems relaxation unique integral optimum. paper study calculation marginal probabilities model utilise graph formulation. problem counting number matchings special case evaluation marginal probabilities joint events non-zero probability equally likely. cavity method counting matchings studied convergence cavity method proven general graphs. proof convergence current work closely related method; essence section iii-c treats weighted version problem considered subclass graphs shown that similar model involving perfect matchings bethe free energy parameterised doubly stochastic matrix marginal target-measurement probabilities convex respect parameterisation. furthermore birkhoff-von neumann theorem states doubly-stochastic matrix convex combination permutations hence infeasibility also ruled out. following section state model derive results relating convergence complexity model. section consider approximate association probabilities commence section iii-a explicitly stating update equations obtain equivalent form reduces computation complexity iteration function operating metric space distance metric contraction contraction factor contraction complete metric space sequence resulting repeated application converge ﬁxed point following distance metric simpliﬁed algorithm computations shown dramatically simpliﬁed observing message consists values distinct values further since free renormalise messages divide values νj→i= respectively) obtain scalar representation message. j=jj> i=ii> message update equations terms scalars become proof convergence previous work convergence requires factors graph satisfy conditions dynamic range minaibj ψij). methods apply present case since factor inﬁnite dynamic range. nevertheless show possible establish simpliﬁed expressions eqs. contractions thus guaranteeing convergence method. property exploit proof correlation decay property utilised recent work omit proof theorem since straightforward application contraction mapping results; note message iterates contained compact subset space hence establishing completeness. note graph structures would necessary establish overall message update operation contraction. since graph case bipartite messages vice versa. thus implemented sequential application showing operations contraction compound operation shown contraction. bound complexity proven convergence algorithm switch analysing computational complexity involved attaining convergence. term error describe difference exact solution approximation obtained upon convergence contrast term deviation describe difference marginal estimate obtained particular iteration belief upon convergence. analysis theorem tightened bound computed numerically. iterations progress guaranteed closer optimal solution. correspondingly contraction factor reduces hastening convergence. closed-form analysis exploit fact rather assuming contraction factor remains original worst-case value. tighter computable bound described corollary corollary assume commence νj→i fig. shows number iterations required guarantee deviation beliefs various ranging green line shows computable bound corollary blue line shows closed-form bound theorem empirically computable bound well-approximated function closed-form bound well-approximated function functions shown light grey dashed lines respective bounds. interpretation complexity previous section showed number iterations required bounded function depends parameters maxi and/or maxj section evaluate expected value ez|x true target positions order provide intuition parameter relates problem parameters. modifying notation explicitly incorporate measurement obtain level bounded simple closed-form expression. follows denote µi→jk νj→ik k-th iterate messages µi→j∗ νj→i∗ messages upon convergence. theorem starting νj→i given deﬁned lemmas deviation current beliefs obtained convergence guaranteed number iterations satisﬁes proof first bound distance messages initialisation. point choose bound message µi→j results single application initialisation νj→i examine ratio measurements dynamic models reduce additional accuracy permits targets distinguished i.e. reduces contribution targets. spacing targets additional accuracy separate targets increase accuracy increase increasing convergence time. summary additional permits disambiguation measurement-target association convergence; cases lower cases yield better convergence. empirically section beliefs also become closer exact marginal probabilities lower conditions. similar analysis show quantities depend intensity tracks vicinity measurements although quantities involved easily interpreted. emphasis previous sections bounding number iterations required obtain deviation less particular threshold. practically lead algorithm performs predetermined number iterations. common approach cyclic compare messages previous iterates terminate convergence detected. following theorem well-known application contraction mapping results provides stopping criterion guaranteed bound deviation converged estimate. algorithm summarised fig. algorithm incorporates results lemma theorem order test convergence. convergence checks performed every iterations order avoid computational overhead involved. practice suggest values range fig. bounds number iterations required convergence blue line shows closed-form bound green line shows tighter bound computed using corollary least squares functions shown light-grey dashed lines. accordingly interpret expected measurement intensity vicinity predicted measurement distribution track provides useful intuition dependence various problem parameters decreases false alarm intensity increases. reduction signiﬁcant false alarm intensity small contributor overall measurement intensity. false alarm intensity dominant contributor intensity little reduction occur. decreases probability existence detection decreases. occurs leading factor reduction overall measurement intensity. probability existence detection approaches unity quantity increases rapidly term fig. example graphical formulation used input junction tree algorithm. case measurement non-zero weight target target hence edge corresponding nodes. assume node potentials thresholded zero infeasible associations turn creates sparsity exploited junction tree algorithm. could also applied directly cyclic graph formulation shown performs poorly comparison bipartite formulation example graph show fig. efﬁcient hypothesis management method exploits similar tree-based inference gaining additional efﬁciency effectively reducing alphabet within junction tree hyper-nodes experiments section compare accuracy computation time method proposed paper junction tree algorithm various thresholds applied yielding various levels sparsity resulting graph. experiments conducted using implementation junction tree algorithm contained library discrete approximate inference junction tree algorithm standard method conducting exact inference cyclic graph. algorithm provides systematic procedure merging variables hyper-nodes order convert cyclic graph tree executes tree conduct exact inference. previously described complexity algorithm problematic computation increases exponentially number nodes need merged together order yield tree-structured graph. junction trees applied data association using graph described fig. would quite inefﬁcient since redundant target association variables measurement association variables beneﬁt exact case increases number variables more precisely method forms tree hyper-nodes satisﬁes running intersection property thus ensuring enforcing consistency along edges sufﬁcient. details tracks remaining recursion maximum number recursion steps perform. close inspection reveals equations almost identical difference recursion never revisits nodes recursion; consequently exact exponential complexity. theoretical analysis shows number nodes graph grows maximum connectivity maximum single-target association weight remains constant chosen error bounded complexity polynomial number tracks measurements. proof theorem based earlier work exploits similar properties convergence proof section iii-c. discussed section ii-c present work closely related recent extension work studies effect applying weight subset terms bethe free energy work particularly interesting context estimating permanents since guaranteed yields exact answer. convergence modiﬁed objective remains proven. extending convergence proof case examining whether provide improved estimates marginal probabilities topics future study. consider series single time-step problems involving targets regularly spaced grid. although experiment involves single time step track covariances preinitialised simulating time steps standard constant velocity model commencing equal zero. track estimates initialised true target positions corrupted additive gaussian noise covariance distributed according prior covariance target generated independent simulation target. gating performed threshold probability excluding target-derived measurement area populated false alarms sufﬁciently large cover gates. three groups experiments conducted targets varying target spacing units considering cases targets regular grid target spacing units targets regular grid target spacing units parameter single time step monte carlo trials performed. total number monte carlo trials performed algorithm experiments performed using dual processor intel xeon server matlab parallel computing toolbox utilising worker threads. evaluate various algorithms compared calculated average maximum error marginal probability estimates calculated algorithm average computation time. comparison performed basis accuracy marginal estimates order exclude down-stream effects coalescence mixture reduction etc. effects signiﬁcant separate issues approximation marginal probabilities conclusion reached experiment including effects speciﬁc full gamut approximations made tracking system. deﬁne average maximum error average value largest element difference marginal distribution target association variable estimated algorithm test corresponding reference value thus averaging performed monte carlo trials targets trials. ﬁrst experiment reference value exact marginal distribution calculated using junction tree algorithm threshold size problems second third experiments prevented exact computation thus reference values calculated using mcmcda samples. second instance algorithm included test providing estimate expected error reference values. fig. examples single monte carlo trials. true target positions shown measurements shown prior track estimates shown faint grey lines show edges graph connecting track estimates measurements form feasible associations. junction tree algorithm described section iv-a weights thresholded inducing varying degrees sparsity thus exploring accuracy versus computation time trade-off. algorithm implemented using general-purpose libdai system mcmcda algorithm using mcmc steps. algorithm initialised association avoid need burn-in. implementation written matlab compiled using matlab coder. correlation decay algorithm described secintegrated existence linear multitarget track existence algorithm probabilities unity comparison non-ipda methods. vectorised matlab-based implementation utilised. preliminary version paper included results applied directly cyclic graph alternative formulation fig. excluded comparison errors committed considerably worse algorithms comparing. discussed section iv-a ehm- exploits problem-speciﬁc structure provide efﬁcient version junction tree algorithm. comparison ehm- topic future work. since approach exact results would equivalent junction tree algorithm; point interest would computational efﬁciency. results comparison shown fig. rows plots alternate average marginal error average computation time plots shaded backgrounds correspond second third experiments remaining plots correspond target experiments. x-axis six-target experiments shows spacing true positions targets regular grid varying units. ﬁrst rows plots show results varying false alarm rate ﬁrst case baseline following cases compare. second rows show effect lowering raising i.e. ﬁnal rows show effect raising lowering measurement noise i.e. plots shaded show second experiment third experiment latter cases target spacing ﬁxed units baseline parameters apply. make following observations exhibits excellent performance average errors less cases except high case measurement noise case cases errors range. note cases correspond high snr. large scale problems show little indication accuracy deteriorates number targets increases. signiﬁcantly outperforms lmipda exhibiting errors reduced factor cases. computational complexity times lmipda averaging fractions millisecond six-target problems little millisecond even target problems. lmipda appear perform similarly across board. performs signiﬁcantly better high false alarm high measurement noise cases lmipda performs better measurement noise cases. computation time comparable. reiterate although junction tree exact algorithm apply different approximations problem obtain trade-off accuracy computation. method exhibits excellent performance smaller thresholds high computational cost. threshold error globally worse often much worse. computational complexity case orders magnitude higher experiments unable completed high memory requirements algorithm. threshold accuracy junction tree generally much better computation time orders magnitude higher experiments cases unable completed excessive memory requirements. performance mcmcda iterations generally comparable six-target cases performs progressively worse cases larger number targets. larger cases performs similar better mcmcda iterations. complexity mcmcda orders magnitude higher depending number samples used. generally outperforms correlation decay method generally performs better tighter target spacings correlation decay performs better larger target spacings. correlation decay method performs particularly poorly case computational complexity correlation decay method varies greatly experiments. cases slightly faster many cases complexity orders magnitude slower large scale problems orders magnitude slower. convergence parameter analysed fig. experiment challenging convergence namely ﬁgure illustrates convergence parameter related density measurements vicinity tracks. minimal targets well-spaced maximal targets closely-spaced. since convergence parameter around fig. shows bound fig. results experiments. first third ﬁfth rows plots show average worst-case error marginal probabilities averaged targets monte carlo trials. second fourth sixth rows show average computation time. unshaded plots show results ﬁrst experiment shaded plots show second third experiments colours and/or symbols show algorithms lmipda mcmcda correlation decay junction tree chen wainwright etin willsky data association based optimization graphical models application sensor networks mathematical computer modelling vol. gning mihaylova dynamic clustering belief propagation distributed inference random sensor networks deﬁcient links proc. international conference information fusion july ristic arulampalam multitarget mixture reduction algorithm incorporated target existence recursions proc. spie signal data processing small targets vol. july horridge maskell searching initiating tracking multiple targets using existence probabilities proc. international conference information fusion seattle july williams marginal multi-bernoulli ﬁlters submitted ieee trans. aerosp. electron. syst. available http//arxiv.org/abs/.v fitzgerald development practical logic multitarget tracking microprocessor multitarget-multisensor tracking advanced applications bar-shalom norwood artech-house bakhtiar alavi amoozegar efﬁcient algorithm computing data association probabilities multitarget tracking automated target tracking sadjadi orlando spie vol. horridge maskell real-time tracking hundreds targets efﬁcient exact jpdaf implementation proc. international conference information fusion july convergence loopy belief propagation data association proc. international conference intelligent sensors sensor networks information processing brisbane australia december distributed deterministic approximation algorithm data association proc. international conference distributed computing sensor systems workshops june number iterations around practice maximum number iterations experiment difference shows ofﬂine bounds examined fig. loose compared online termination criterion provided theorem paper introduced approximate method solving data association problems using particular graphical model formulation. generally guaranteed converge cyclic graphs proven convergence formulation studied bounded computation required. method approximate experiments section reveal highly favourable comparison state-of-the-art methods accuracy versus computation time trade-off. future work includes extensions problems involving multiple time steps multiple sensors extensions obtain guarantees accuracy approximation evaluation impact accuracy convergence weighting proposed comparison computational complexity authors thank prof. alan willsky prof. m¨ujdat etin discussions development formulation section stephen howard discussions early stage convergence proof anonymous reviewers suggestions helped clarify many points. chen wainwright etin willsky multitargetmultisensor data association using tree-reweighted max-product algorithm proc spie signal processing sensor fusion target recognition vol. august chertkov kroc krzakala vergassola zdeborov inference particle tracking experiments passing messages images proceedings national academy sciences vol. williams tracking coordinated group using expectation maximisation proc. international conference intelligent sensors sensor networks information processing melbourne australia april lauritzen spiegelhalter local computations probabilities graphical structures application expert systems journal royal statistical society series vol. anguelov srinivasan h.-c. pang koller thrun davis correlated correspondence algorithm unsupervised registration nonrigid surfaces advances neural information processing systems vol. bayati gamarnik katz nair tetali simple deterministic approximation algorithms counting matchings proc. annual symposium theory computing. york jason williams received degrees be/binftech queensland university technology msee united states force institute technology massachusetts institute technology worked several years engineering ofﬁcer royal australian force joining australia’s defence science technology organisation also adjunct senior lecturer university adelaide. research interests include target tracking sensor resource management markov random ﬁelds convex optimisation. roslyn received degrees be/bma&cs university adelaide australia. currently candidate australian national university. also scientist defence science technology organisation australia. research interests include target tracking data fusion graphical models.", "year": 2012}