{"title": "Coarse to fine non-rigid registration: a chain of scale-specific neural  networks for multimodal image alignment with application to remote sensing", "tag": ["cs.CV", "cs.AI", "cs.LG", "cs.NE", "stat.ML"], "abstract": "We tackle here the problem of multimodal image non-rigid registration, which is of prime importance in remote sensing and medical imaging. The difficulties encountered by classical registration approaches include feature design and slow optimization by gradient descent. By analyzing these methods, we note the significance of the notion of scale. We design easy-to-train, fully-convolutional neural networks able to learn scale-specific features. Once chained appropriately, they perform global registration in linear time, getting rid of gradient descent schemes by predicting directly the deformation.We show their performance in terms of quality and speed through various tasks of remote sensing multimodal image alignment. In particular, we are able to register correctly cadastral maps of buildings as well as road polylines onto RGB images, and outperform current keypoint matching methods.", "text": "tackle problem multimodal image nonrigid registration prime importance remote sensing medical imaging. difﬁculties encountered classical registration approaches include feature design slow optimization gradient descent. analyzing methods note signiﬁcance notion scale. design easy-to-train fully-convolutional neural networks able learn scale-speciﬁc features. chained appropriately perform global registration linear time getting gradient descent schemes predicting directly deformation. show performance terms quality speed various tasks remote sensing multimodal image alignment. particular able register correctly cadastral maps buildings well road polylines onto images outperform current keypoint matching methods. image alignment also named non-rigid registration task ﬁnding correspondence ﬁeld given images i.e. deformation which applied ﬁrst image warps second one. warpings prove useful many situations transfer information several images compare appearance similar parts estimate spatial changes image alignment thus predominant topic ﬁelds medical imaging remote sensing remote sensing images earth acquired different types sensors visible spectrum satellites planes various spatial precision analysis images allows monitoring ecosystems animals soils...) evolution urban growth well automatic creation maps generally digitizing earth. however geographic localization pixels remote sensing images limited number factors positioning precision effect relief nonvertical points view. deformation images signiﬁcant instance openstreetmap objects shifted meters means error displacement pixels cm/pixel resolution. deformations prevent proper exploitation data. instance consider task ﬁnding buildings roads remote sensing image. ground truth actually available considerable amounts openstreetmap based cadastral information gives coordinates building corner hand-made ground truth often inaccurate human mistakes. thus possible learn remote sensing images properly aligned objects might even overlap. severe issue remote sensing ﬁeld data machine learning. many works focusing problem relief knowledge dedicated hand-designed alignment algorithms. anapproach worth mentioning train coarsely datasets available ﬁne-tune small better-handaligned datasets tackle problem non-rigid alignment directly. tasks image registration deals images either modality not. modality task typically align different similar objects organs different people align object taken different times side multi-modal registration deals aligning images usually object taken different sensors capture different physical properties possibly different resolutions. instance medical imaging scans capture density water matter respectively remote sensing hyperspectral data capture information different light frequencies case study focus alignment remote sensing images cadastral maps vector-format images polygonal representations buildings roads hand-made local authorities makers openstreetmap users figures whether mono-modal multi-modal image registration faces challenges ﬁrst describe locally image data then match points similar description spatially coherent manner. historically main classical approaches emerged. tion design proper sampling criteria descriptors matching algorithm. multi-modal case would also design learn correspondence between descriptors modalities. note highprecision registration requires dense sampling well consequently ﬁner descriptors naturally leads second approach. estimating deformation ﬁeld gradient descent second approach particularly popular medical imaging consists estimating dense deformation ﬁeld image advantages ﬁrst approach able model objects make shape statistics etc. warping modeled smooth vector ﬁeld mapping image domain onto one. given images criterion deﬁned express similarity warped image target optimized respect gradient descent. selecting suitable similarity criterion crucial well designing carefully gradient descent detail section difﬁculty design pick particular local descriptors matching criteria among many possibilities trait computer vision problems introduction neural networks prove useful. question how. machine learning techniques already explored learn similarity measures different imaging modalities instance using kernel methods register brain scans without tackling question scale. designing system able learn scale-speciﬁc modality-speciﬁc features able perform multimodal image registration densely swiftly without iterative process gradient descent hampers classical approaches. contributions thus. order analyze issues arise aligning images ﬁrst consider case mono-modal registration simplicity. keeping notations section pursue quest reasonable criterion optimize gradient descent estimate deformation local quantities pixellic intensity difference would create many local minima gradient descent stuck fast. indeed example considers white images unique black different locations respectively derivative respect never involve quantities based points time prevents inﬂuenced other points deformation evolves make disappear cost shrinking image around. thus derivative similarity cost respect deformation convey information pushing towards contrary make descent gradient stuck local minimum. instead intensity might want consider local higher-level features edge detectors order grasp meaningful information thus minimize criterion instance form intensity around within neighborhood pre-deﬁned size another famous example mutual information histograms intensity within certain window pre-deﬁned size. cases neighborhood size particularly important small gradient descent stuck poor local minimum large image details might lost preventing registration. actually needed neighborhood size order magnitude displacement found. displacement unknown neighborhood size needs wide enough ﬁrst gradient steps decrease time registration able ﬁner ﬁnally reach pixellic precision. controlling speed decrease difﬁcult matter leading slow optimization. moreover performance descriptors depend scale different descriptors might need chosen coarse initial registration ﬁnest ﬁnal one. plus difﬁcult task designing learning relevant descriptors scale raises anissue criterion optimize depends current neighborhood size time-dependent thus optimized criterion might increase descriptor evolves optimization process gradient descent anymore. might think scale-invariant descriptors sift however issue adapt scale particular location within image adapt amplitude deformation remains done matched image. solution consists considering local descriptors involving larger spatial neighborhoods wide enough image domains involved computations points matched overlap signiﬁcantly. instance computation canny edge detector performed truncated gaussian neighborhood whose size pre-deﬁned standard deviation parameter another example local-cross correlation compares local variations another point view scale-increasing process consider descriptors optimization process remain scales resolution image increasing. algorithm loop successive resolutions starting low-resolution version image waiting convergence gradient descent upsampling deformation ﬁeld found higher resolution version image iterating until original resolution reached. limitation descriptor used resolution previously convergence gradient descent reached scale leading slow optimization. different approach consists dealing knowledge neural network-based work dense nonrigid alignment yet. siamese network idea used matching points. also worth noting that much earlier similarity criterion different modalities learned kernel method rigid registration only. seen previous sections aligning images thanks gradient descent deformation following drawbacks slow need ensure convergence scale actually real gradient descent descriptors scale-dependent induces long backpropagation chain learning descriptors. iterative process propose predict directly ﬁnal result convergence. given images predict directly optimal deformation aligned. also instead proceeding steps ﬁrst learning features required deﬁne criterion ﬁnding deformation minimizing propose directly learn deformation standard machine learning setup examples. given training dataset input pairs together expected associated output learning function machine learning setting training ﬁrst consider task aligning geolocalized aerial images binary maps openstreetmap indicating building locations. explained section matching usually imperfect. creating deformation ground truth manually performing warpings would time-consuming. instead extract image pairs visually look already well aligned figure obtain dataset composed image pairs resolution .m/pixel deformation found identity. generate artiﬁcial training applying random deformations cadastral vectorial maps moving accordingly corners polygons contains generating binary maps rasterization. thus obtain training pairs non-registered images known deformations. typical deformations reality smooth model family random deformations global translation taken uniformly within certain range plus mixture gaussian functions random shifts centers covariance matrices scales simultaneously considering multi-scale parameterisation deformation however local minimum problem would encountered implemented naively; heuristics need used estimate scale optimization currently performed locally. deformations usually modeled diffeomorphisms i.e. smooth one-to-one vector ﬁelds order avoid deleting image parts. smoothness controlled additional criterion optimize quantifying regularity deformation sobolev norm machine learning technique regularity term sets prior space possible functions preventing overﬁtting again smoothness level required depend scale e.g. prioritizing global translations rotations ﬁrst allowing local moves converging. handled suitable metrics instantaneous deformations practice metrics tend slow convergence oversmoothing gradients ﬁnest scales. neural networks proved useful replace handdesigned features various tasks literature recently convolutional ones particular computer vision could think mono-modal image alignment training siamese network setup order learn relevant distance image patches. multi-modal version would consist training output size computing euclidean norm difference outputs dissimilarity measure using quantity within standard non-rigid alignment algorithm gradient descent training would however require able differentiate result iterative alignment process respect features. realistic given varying usually large number steps required typical alignment tasks. similar approach nonetheless successfully used simpler task correcting blurry segmentation maps sharpening relying image edges. this partial differential equation mimicked recurrent network number steps applying pre-deﬁned small value sufﬁcient particular problem. spirit image denoising proximal operator used iterative optimization process modeled neural network learned. instance scale task search pixelwise precise registration dataset prepared previously amplitude ﬁrst approximate test train network described earlier i.e. coordinates thus feasible easy extract information specifying scale. intuitively search space much smaller; light section descriptor receptive ﬁeld required pixel task radius indeed classical framework monomodal registration feature simple image intensity would deﬁne sufﬁciently good criterion associated gradient step involves comparison next pixel note simple intensity-based criterion would expected perform more e.g. deformations amplitude pixels general case uniformly random within suitable predeﬁned ranges drastically augment dataset applying arbitrarily many random deformations initially wellaligned images. i.e. expectation ground truth dataset triplet examples pixels image domain norm difference ground truth deformation predicted pair images given model parameters ﬁrst produce training typical real deformations picking realistic range pixels deformation amplitudes. consider fully-convolutional neural network consisting convolutional networks whose ﬁnal outputs concatenated sent convolutional layers. last layer task scale need fully-convolutional architecture since output -channel image size input need across several scales order understand kind object part pixel belongs modality. high-level features require wide receptive ﬁeld usually obtained several pooling layers pyramidally shaped network. output needs however resolution input leads autoencoder-like shapes. order keep low-level information lose precision link same-resolution layers together thus obtaining u-net-like network input images registered modality-speciﬁc features build separate convolutional pyramids modality concatenate activities scale feed u-net. architecture summarized figure network trained successfully solve task explained previously. full processing chain shown figure note certain global similarity resnet chain consecutive scale-speciﬁc blocks reﬁning previously-estimated deformation adding diffeomorphism composition note overall complexity alignment linear image size. indeed given image pixels similar convolutional architecture applied reduced versions factors size −s×−sn pixels leading total cost consisting arrangement different scale-related blocks though monomodal principled scale analysis without scale-speciﬁc training. fast replace scale-speciﬁc blocks -speciﬁc block well features generalize across scales; output quality decreases slightly remains honorable. perform four experiments different datasets. ﬁrst experiment uses inria aerial image labeling dataset collection aerial orthorectiﬁed color imagery spatial resolution cm/pixel covering cities austria. aligning buildings downloaded images inria dataset. network described section trained using image patches different cities accurate building cadastral data available. evaluated network using images area kitsap county presented training. fig. shows example close-up alignment result. figure full architecture chain scale-speciﬁc neural networks. full-resolution input images always available horizontal row. full-resolution deformation iteratively reﬁned scale scale bottom horizontal line. scale-speciﬁc block downsample images right size apply previously-estimated deformation reﬁnes somehow similar resnet. block trained independently. second experiment network trained ﬁrst experiment used align building satellite images pansharpened resolution cm/pixel acquired pl´eiades sensor forez rural area france. measure performance network percentage correct point metric manually identiﬁed matching points couples multimodal images keypoints image. measure distance positions keypoints alignment using different algorithms manually indicated ones. distance smaller certain threshold keypoint identiﬁed matched. fig. compares performance network following methods deepflow weinzaepfel variations geometric matching method rocco multimodal registration method approach clearly outperforms ones large margin. note averaging rotations symmetries help forez dataset learning scale-speciﬁc features performs slightly better scale-independent features always examples alignment results shown figure approach also much faster shown computational times image even though compute dense registration approaches match keypoints third experiment align roads images used ﬁrst experiment. task differs previous experiments center line road known form polyline. moreover local edges useful features alignment anymore center roads homogeneous. train data dilating road polylines reach pixel width rasterizing them. test performance trained network kitsap image. results shown figure fourth experiment checks performance approach higher-resolution dataset. consider kitti dataset contains high precision aerial images well perfectly aligned multi classes labeling create training artiﬁcial random deformations spirit before test randomly deformed images well following different distributions order check also robustness training approach. image pairs registered consist image -channel binary image indicating buildfigure points matching. scores different methods kitsap forez datasets. curves indicate percentage keypoints whose distance ground truth less threshold abscissa. higher better. ings roads sidewalk presence respectively. example result shown figure also analyse distribution misalignments registration shown histograms figure note vast majority pixels successfully closely matched ground truth location. weinzaepfel figure multimodal keypoint matching comparison different methods datasets. forez dataset; bottom kitsap. blue predicted green ground truth. full resolution appendix. also perform extra experiment show multi-scale approach could generalize applications. consider problem stereovision input pair images taken slightly different view points expected output depth i.e. single channel image instead deformation ﬁeld. consider dataset deﬁne loss function depth error plus regularizer keep architecture link scale-speciﬁc networks additions instead compositions block adds figure misalignment histograms fourth experiment left original misalignment distribution test set; right remaining error automatic alignment. additional details speciﬁc sparse modalities cadastral maps though essential. training sort fully mostly blank images also order train information extract multiply pixel loss factor building edges training. rectangular building glued together shared walls location edges corners visible anymore rasterized version cadastre. adding channel cadastre reminding corner locations observe better alignment rows. based analysis classical methods designed chain scale-speciﬁc neural networks non-rigid image registration. predicting directly ﬁnal registration scale avoid slow iterative processes gradient descent schemes. computational complexity linear image size lower even keypoint matching approaches. demonstrated performance various remote sensing tasks resolutions. trained network well training code made available online. hope contribute creation large datasets remote sensing precision issue requiring hand-made ground truth.", "year": 2018}