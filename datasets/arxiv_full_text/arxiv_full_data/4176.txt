{"title": "Automatic Liver and Tumor Segmentation of CT and MRI Volumes using  Cascaded Fully Convolutional Neural Networks", "tag": ["cs.CV", "cs.AI"], "abstract": "Automatic segmentation of the liver and hepatic lesions is an important step towards deriving quantitative biomarkers for accurate clinical diagnosis and computer-aided decision support systems. This paper presents a method to automatically segment liver and lesions in CT and MRI abdomen images using cascaded fully convolutional neural networks (CFCNs) enabling the segmentation of a large-scale medical trial or quantitative image analysis. We train and cascade two FCNs for a combined segmentation of the liver and its lesions. In the first step, we train a FCN to segment the liver as ROI input for a second FCN. The second FCN solely segments lesions within the predicted liver ROIs of step 1. CFCN models were trained on an abdominal CT dataset comprising 100 hepatic tumor volumes. Validations on further datasets show that CFCN-based semantic liver and lesion segmentation achieves Dice scores over 94% for liver with computation times below 100s per volume. We further experimentally demonstrate the robustness of the proposed method on an 38 MRI liver tumor volumes and the public 3DIRCAD dataset.", "text": "automatic segmentation liver hepatic lesions important step towards deriving quantitative biomarkers accurate clinical diagnosis computer-aided decision support systems. paper presents method automatically segment liver lesions abdomen images using cascaded fully convolutional neural networks enabling segmentation large-scale medical trials quantitative image analyses. train cascade fcns combined segmentation liver lesions. ﬁrst step train segment liver input second fcn. second solely segments lesions within predicted liver rois step cfcn models trained abdominal dataset comprising hepatic tumor volumes. validation results datasets show cfcn-based semantic liver lesion segmentation achieves dice scores liver computation times volume. experimentally demonstrate robustness proposed method liver tumor volumes public dircad dataset. anomalies shape texture liver visible lesions computed tomography magnetic resonance images images important biomarkers initial disease diagnosis progression primary secondary hepatic tumor disease primary tumors breast colon pancreas cancer often spread metastases liver course disease. therefore liver lesions routinely analyzed primary tumor staging. addition liver also site primary tumor disease hepatocellular carcinoma hepatocellular carcinoma presents sixth-most common cancer third-most common cause cancer-related deaths worldwide comprises genetically molecularly highly heterogeneous group cancers commonly arise chronically damaged liver. importantly subtypes diﬀer signiﬁcantly clinical outcome. stepwise transformation accompanied major changes tissue architecture including increase cellularity switch vascular supply quantiﬁable changes tissue architecture provide basis non-invasive detection imaging also lead highly variable structures shapes. clinical routine manual semi-manual segmentation techniques applied interprete images acquired diagnosis liver. techniques however subjective operator-dependent time-consuming. order improve productivity radiologists computer-aided methods developed past. however automated robust segmentation combined liver lesion remains still open problem challenges low-contrast liver lesion different types contrast levels abnormalities tissues size varying number lesions. shown ﬁgure heterogeneity liver lesion contrast large among subjects. diﬀerent acquisition protocols diﬀering contrast-agents varying levels contrast enhancements dissimilar scanner resolutions lead unpredictable intensity diﬀerences liver lesion tissue. complexity contrast diﬀerences make diﬃcult intensity-based methods generalize unseen test cases diﬀerent clinical sites. addition varying shape lesions irregular tumor growth response treatment reduce eﬃciency computational methods make prior knowledge lesion shape. nevertheless several interactive automatic methods developed segment liver liver lesions volumes. grand challenges benchmarks liver liver lesion segmentation conducted conjunction miccai conference methods presented challenges mostly based statistical shape models. furthermore grey level texture based methods developed recent work liver lesion segmentation employs graph level techniques sigmoid edge modeling manifold machine learning however methods widely applied clinics speed robustness heterogeneous low-contrast real-life data. overcome weaknesses interactive methods still developed overcome weaknesses. deep convolutional neural networks gained signiﬁcant attention scientiﬁc community solving computer vision tasks object recognition classiﬁcation segmentation often out-competing state-of-the methods. importantly methods proven highly robust varying image appearance motivates apply fully automatic liver lesions segmentation volumes. figure liver liver lesions slices diﬀusion weighted dw-mri well corresponding histogram liver lesions pixels respective modality. shape size level contrast vary diﬀerent lesions. histograms indicate signiﬁcant overlap liver lesion intensities leading overall contrast. semantic image segmentation methods based fully convolutional neural networks developed impressive results natural image segmentation competitions likewise segmentation methods based fcns developed medical image analysis highly competitive results compared state-of-the-art. work demonstrate combined automatic segmentation liver lesions low-contrast heterogeneous medical volumes. contributions threefold. first train apply fully convolutional volumes liver ﬁrst time demonstrating adaptability challenging segmentation hepatic liver lesions. second propose cascaded fully convolutional neural network slices segments liver lesions sequentially leading signiﬁcantly higher segmentation quality demonstrated public challenge dataset. third experimentally demonstrate generalization scalability methods diﬀerent modalities diverse real-life datasets including novel diﬀusion weighted dataset large multri-centric dataset. preliminary version work presented miccai presented isbi paper substantially revised extended previous publications. main modiﬁcations include elaborated description proposed proposed segmentation workﬂow depicted ﬁgure workﬂow consists three major steps. ﬁrst step deals data preprocessing preparation neural network segmentation. second step cascaded fully convolutional neural networks ﬁrst segment liver lesions within liver region-of-interest ﬁnal third step calculated probabilities cfcn reﬁned using dense conditional random ﬁeld produce ﬁnal segmentation result. eﬀect applied preprocessing medical slice. increased contrast histogram equalization. figure shows also ﬁnal slice hu-windowing contrastenhancement. contrast within liver enhanced allow better diﬀerentiation abnormal liver tissue. dw-mri data preparation scheme similar diﬀers data normalization additionally performs nbias correction teach network desired invariance properties several data augmentations steps elastic deformation translation rotation addition gaussian noise standard deviation current slice employed increase training data cfcn. details data augmentation schemes made available sourcecode. following section describe diﬀerent state-of-the deep learning architecture design choices evaluated segmentation tasks. denote image volume total number voxels possible labels figure overview proposed image segmentation workﬂow training testing. ﬁrst step ct/mri volumes preprocessed either hu-windowing bias correction. training phase training data augmented foster learning invariance noise deformations medical data. ct/mri volumes trained pre-processing data augmentation cascaded fully convolutional neural network ﬁrst segments liver abdomen ct/mri scans. segmented liver region interest input second segments lesions given segmented liver roi. gain ﬁnal segmented volume reﬁned afterwards using conditional random ﬁeld crf. figure overview applied preprocessing steps. slices windowed hounsﬁeld unit range neglect organs tissues interest. hu-windowed slice processed using histogram equalization allow contrast enhancement abnormal tissue long presented ﬁrst fully convolutional network architecture semantic segmentation main idea work replace last fully connected layers classiﬁcation network alexnet fully convolutional layers allow dense pixel-wise predictions. last fully convolutional layers upscaled match input dimensions. comparison prior work alexfcn allows pixelwise prediction full-sized medical slices instead patch-wise classiﬁcation. figures show training curves training alexfcn dircad dataset. training curves converged fast steady state training test dice overlap. training curves show large overﬁtting alexfcn without class balancing dice overlaps test/training data liver lesions. general lesion dice test time comparable low. long explicitly stated need apply class balancing natural image segmentation problem. reason used pretrained alexnet weights trained natural images i.e. imagenet data. however many medical applications mandatory apply class balancing since pre-trained networks natural images cannot used properly class interest occurs seldomly dataset. figures show importance class balancing medical image segmentation. training test dice liver lesions increases noticeably liver lesions. large improvement obtained applying u-net architecture proposed ronneberger besides increased depth layers learnable upscaling u-net provides superior design pattern skip connections diﬀerent stages neural network. early stages neural network spatial information present activations current stage. later stages neural network spatial information gets transferred semantic information cost speciﬁc knowledge localization structures. here example original u-net architecture reduces input image size size u-net bottleneck. ronneberger introduced skip-connections allow utilization spatial semantic information later stage since spatial information earlier stage fused neural network later stages. thus neural network later stages utilize semantic spatial information infer information. u-net architecture enables accurate pixel-wise prediction combining spatial contextual information network architecture comprising convolutional layers. figures show training curves u-net dircad data set. overall performance lesion segmentation increased test dice. u-net learned features discriminate liver lesion time. main contributions propose cascaded training fcns learn speciﬁc features solving segmentation task training leads higher segmentation performance. motivation behind cascade approach shown u-nets forms cnns learn hierarchical representation provided data. stacked layers convolutional ﬁlters tailored towards desired classiﬁcation data-driven manner opposed designing hand-crafted features separation diﬀerent tissue types. cascading u-nets ensure u-net step learns ﬁlters speciﬁc detection segmentation liver overall abdominal scan u-net step arranges ﬁlters separation lesions liver tissue. furthermore liver helps reducing false positives lesions. figures illustrate proposed method. train network segment liver abdomen slices network solely concentrate learning discriminative features liver background segmentation e.g. ﬁgure train another network segment lesions given image liver segmented liver step cropped re-sampled required input size cascaded u-net step non-liver regions masked second u-net concentrate learning discriminative features lesion liver background segmentation. crucial step training fcns appropriate class balancing according pixel-wise frequency class data. contrast observed training network segment small structures lesions possible without class balancing high class imbalance typically range lesion pixels. therefore introduced additional weighting factor ωclass cross entropy loss function common concept deep learning transfer learning using pretrained neural network models. neural networks pretrained task e.g. natural image classiﬁcation data used initialization network weights training task e.g. image segmentation medical volumes. intuition behind idea also tasks dataset ﬁrst layers neural networks learn similar concepts recognize basic structures blobs edges. concepts trained scratch using pretrained models. experiments used pretrained u-net models provided ronneberger trained cell image segmentation data released trained models liver lesion segmentation allow researcher start training learned liver lesion concepts. volumetric implementation convolutions strongly limited hardware available vram recent work v-net u-net allow nowadays fcns decreased resolution addition anisotropic resolution medical volumes complicates training discriminative ﬁlters. instead capitalise locality information across slices within dataset utilize dense conditional random ﬁelds proposed account information consider slice-wise predictions together applied entire volume once. main metric dice score. additionally report volume overlap error relative volume diﬀerence average symmetric surface distance symmetric maximum surface distance metrics applied binary valued volumes metric computed lesions example considers lesion objects foreground everything else background. refer foreground object ground truth object object predicted object. clinical routine usage methods algorithms developed trained evaluated heterogeneous real-life data. work want demonstrate robustness generalization scalability proposed method applying public dataset comparison clinical dataset ﬁnally clinical dataset evaluated proposed method dircadb dataset comparison grand challenge datasets dircadb dataset oﬀers higher variety complexity livers lesions publicly available. dircadb dataset includes venous phase enhanced volumes various european hospitals diﬀerent scanners. study trained evaluated models using volumes containing hepatic tumors liver -fold cross validation. analyzed volumes diﬀer substantially level contrast-enhancement size number tumor lesions data prepared described section data augmentation scheme lead total training data size image slices. cfcn trained recent desktop single nvidia titan vram. neural networks implemented trained using deep learning framework caﬀe university berkeley. used stochastic gradient descent optimizer learning rate momentum reduce overﬁtting applied weight decay eﬀect class balancing seen ﬁgure introducing class balancing improved segmentation dice score liver lesion simultaneously decreasing over-ﬁtting. eﬀect less liver since percentage liver voxels abdomen dataset order comparison lesions. following experiments accounted class imbalance weighting imbalanced class according frequency dataset introducing weight factor described section qualitative results automatic segmentation presented ﬁgure complex heterogeneous structure liver lesions detected shown images. cascaded approach yielded enhancement lesions respect segmentation accuracy compared single seen ﬁgure general observe signiﬁcant additional improvements dice overlaps liver segmentations mean dice applying crf. lesions could achieve dice score standard deviation fold cross-validation. second dataset evaluated real-life clinical dataset multiple scanners acquired diﬀerent centers. compromises scans diﬀerent patients. examined patients suﬀering diﬀerent kind cancerous diseases figure automatic liver lesion segmentation cascaded fully convolutional networks dense conditional random ﬁelds green depicts correctly predicted liver segmentation yellow liver false negative false positive pixels blue shows correctly predicted lesion segmentation lesion false negative false positive pixels ﬁrst false positive lesion prediction single u-net proposed eliminated cfcn result restricting lesion segmentation liver region. second applying cfcn increases liver lesion segmentation accuracy further resulting lesion dice score diﬀerent manifestations liver. dataset ranges single lesions diﬀusive conﬂuent metastatic lesions. addition diﬀerent contrast agents therefore diﬀerent levels contrast enhancement present dataset. human rater ground truth obtained manual volumetric segmentation using software turtleseg clinical dataset prepared augmented dircad dataset described data split training test validation. neural networks trained setup training parameters dircad dataset. experiment adam optimizer applied shown table cascaded cascaded reach dice score dataset. inter-rater dice comparison among training cases yielded dice overlap score considering inter-rater dice score proposed method provides remarkable segmentations. furthermore proposed method achieves demonstrate generalization modalities employed methods clinical dw-mri dataset. patients underwent clinical assessment imaging primary diagnosis hcc. imaging performed using clinical scanner standard imaging protocol including axial coronal axial images application gadolinium-dtpa contrast agent. diﬀusion weighted imaging performed using slice thickness matrix size human rater ground truth segmentation created dw-mri sequence allow automatic image analysis e.g. section comparison datasets dw-mri dataset prepared diﬀerently. dw-mri dataset normalized using nbias correction algorithm afterwards pre-processing steps carried cfcn dw-mri dataset trained hardware training setup. optimizer experiment adam optimizer seen ﬁgure cfcn able segment liver lesion correctly. cases cfcn undersegments lesion leading dice score cases. quantitative segmentation results shown table cascaded u-net able reach dice score liver mr-dwi lesion found mean dice score accurate liver lesion segmentation necessary advanced medical image analysis meant input radiomics algorithms survivalnet predictor paragraph want introduce possible applications automatic liver lesion segmentation algorithms medical imaging. survival outcome prediction important ﬁelds medical image analysis. hepaticcellular carcinoma prior work relied manual liver lesion segmentation dw-mri calculate features liver lesion sequence predict patient survival. contrast prior work trained cfcn automatically segment liver lesion segmentation dw-mri allow automatic survival predictions. formulate task classiﬁcation problem classes risk high risk represented longer shorter survival times median survival. predict malignancy steps ﬁrst step automatically segment tumor lesions using proposed method cascaded fully convolutional neural networks second step predict lesions’ malignancy tumor segmentation mr-dwi sequence using classical texture features features. main contributions found accuracy end-to-end assessment tumor malignancy based proposed cascaded fully convolutional neural networks equal assessment based expert annotations high signiﬁcance words automatic tumor malignancy framework performs equally assessment based expert annotations terms accuracy. detailed information found christ ettlinger kaissis comparison state-of-the-art presented framework capable combined segmentation liver lesion. moreover presented clinical relevance proposed method utilisation automatic segmentations derive quantitative medical insights. furthermore contrast prior work proposed method could generalized segment liver lesion diﬀerent modalities also multiple organs medical data. recent results natural image segmentation indicate fully convolutional networks capable segmenting dozens labels ease. cascading architecture smaller subregions segmentation accuracy could increased. addition runtime slice figure automatic lesion segmentation cascaded fully convolutional neural networks dwmri. dw-mri slices automatically segmented proposed method. green depicts correctly segmented lesion pixels. shows false positive false negative i.e. wrong predictions lesions. cases proposed cfcn achieves dice score lesions recent works deepmedic v-net u-net became possible eﬃcient implementations convolutions gpus show promising results respective segmentation tasks. proposed idea cascaded could also applied novel architectures. restriction region interest relevant organs shown u-net restricting liver pixels segmenting lesions signiﬁcantly boosts segmentation accuracy. intuition speciﬁc ﬁlters underlying problem could trained restricting relevant regions holds well. future work show whether architectures could cope less training data available lesion segmentation. showed statistically signiﬁcant improvement segmentation quality applying segmentation problem. however tuning hyperparameters time-consuming task dependent. found highly heterogeneous structures shape appearance lesions hard hyperparameter generalizes unseen cases random search. similar conclusion made applying heterogeneous brain lesions. recent work successfully integrated learning hyperparameter training process approach combination additional pairwise terms incorporate prior knowlegde problem could lead improvement task. cascaded fcns dense crfs trained volumes suitable automatic localization combined volumetric segmentation liver lesions. proposed method competes state-of-the-art. provide trained models open-source license allowing ﬁne-tuning medical applications data additionally introduced evaluated dense post-processing step deep learning-based medical image analysis. furthermore contrast prior work proposed method could generalized segment multiple organs medical data using multiple cascaded fcns. future work application cascaded fcns lesions rois classify malignancy lesions well advanced techniques data augmentation using adversarial networks could enhance accuracy segmentation further. heterogeneous dw-mri volumes diﬀerent scanners protocols segmented proposed approach. conclude cfcns promising tools automatic analysis liver lesions clinical routine large-scale clinical trials. work supported german research foundation within sfbinitiative imaging selection monitoring individualization cancer therapies bmbf project softwarecampus. thank nvidia amazon granting computation support.", "year": 2017}