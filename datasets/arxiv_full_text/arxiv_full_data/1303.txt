{"title": "Spatially-Adaptive Reconstruction in Computed Tomography using Neural  Networks", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "We propose a supervised machine learning approach for boosting existing signal and image recovery methods and demonstrate its efficacy on example of image reconstruction in computed tomography. Our technique is based on a local nonlinear fusion of several image estimates, all obtained by applying a chosen reconstruction algorithm with different values of its control parameters. Usually such output images have different bias/variance trade-off. The fusion of the images is performed by feed-forward neural network trained on a set of known examples. Numerical experiments show an improvement in reconstruction quality relatively to existing direct and iterative reconstruction methods.", "text": "generic approach adapts off-line learning process given algorithm. requirement access design parameters reconstruction procedure inﬂuence nature output image resolution-variance trade-off. exploit fact reconstruction algorithm provide image information instead ﬁxed value parameter controlling reconstruction different values used order extract information collection image versions artiﬁcial neural network proposed method also techniques computing non-linear multivariate regression function. neural networks used extensively medical imaging particularly purpose reconstruction propose constellation consists local fusion different image versions aimed improved reconstruction quality. intensity values neighborhood pixel taken different versions inputs network train compute neighborhood values close possible found reference image. show paper proposed approach enables improvement variance-resolution trade-off given reconstruction algorithm i.e. producing images reduced amount noise without compromising spatial resolution without introducing artifacts. organized follows sections devoted brief general discussion scan/reconstruction artiﬁcial neural networks. readers familiar topics skip start reading section core concept work detailed. section also contains illustration one-dimensional piecewise constant signals easy appreciate action proposed algorithm effect local fusion performed neural network. sequel proposed method implemented tomographic reconstruction methods boosting filtered back-projection presented section penalized weighted least-squares method described section vii. conclude work discussing computational complexity proposed algorithms section viii summary work potential implications section abstract—we propose supervised machine learning approach boosting existing signal image recovery methods demonstrate efﬁcacy example image reconstruction computed tomography. technique based local nonlinear fusion several image estimates obtained applying chosen reconstruction algorithm different values control parameters. usually output images different bias/variance trade-off. fusion images performed feed-forward neural network trained known examples. numerical experiments show improvement reconstruction quality relatively existing direct iterative reconstruction methods. computed tomography imaging produces attenuation scanned object sequentially irradiating x-rays several directions. integral attenuation x-rays measured comparing radiation intensity entering leaving body forms data imaging. practice photon count measurements degraded stochastic noise typically modeled instances poisson random variables. also degradation effects number physical phenomena e.g. detailed account. given projection data known sinogram reconstruction process performed order recover attenuation map. various algorithms exist ranging simple still popular filtered-back-projection advanced bayesianinspired iterative algorithms take statistical nature measurements unknown image account. since relies x-ray ionizing radiation known dangerous living tissues dire constant need improve reconstruction algorithms attempt enable reduction radiation dose. work concerned question image post-processing following reconstruction purpose getting better quality image thereby permitting eventual radiation-dose reduction. proposed method focus speciﬁc reconstruction algorithm properties images produces. instead take research leading results received funding european research council european union’s seventh framework program grant agreement research supported gurwin family fund. process scan object radiated x-rays. work consider reconstruction plane rays incident plane mathematical point view considered object function plane values attenuation coefﬁcients composing materials measured photon counts perfect measurements directly related x-ray transform function collection straight lines passing object value associated line integral along dimensions assumption full rotated parallel beam scan coincides radon transform blank scan count. scanned data stored matrix columns correspond sampled angle column referred view projection acquired schematically parallel array xrays passing object corresponding angle. rows matrix corresponding sampled values distance called bins projection. according equation reconstruction purposes measurements data undergoes transform refer sinogram. name indicates every point image space traces sine curve domain. since sinogram matrix radon transform original image discrete version image reconstructed applying inverse radon transform measured photon count typically interpreted instance random variable following poisson distribution oisson) reﬂects photon count statistics detectors random variable oisson standard deviation satisﬁes sinogram domain standard deviation error ideal sinogram computed measurements well approximated ˆy−/ figure display sinogram matrix corresponding poisson noise image. below observe resulting reconstruction artifacts produced standard algorithm sinogram error image high-energy regions sinogram values relatively high; corresponds predicted behavior noise variance. reconstruction noisy sinogram contaminated anisotropic noise mainly right exact sinogram figure upper absolute-valued difference corrupted sinogram lower left true image corresponding true sinogram. lower right reconstruction noisy data algorithm. images displayed window various reconstruction algorithms computing attenuation scanned object projections. paper shall refer work algorithms filtered back-projection direct radon inversion approach. popular technique despite known ﬂaws; iterative reconstruction algorithm takes statistical nature unknown noise account bayesian methods achieve better image quality direct radon inversion expense longer processing time. describe methods somewhat details. filtered-back-projection method mathematically linear operator form adjoint radon transform known literature back-projection. convolution ﬁlter applied individual projection uses ram-lak kernel deﬁned fourier domain flow low-pass ﬁlter prevents noise ampliﬁcation high frequencies completeness paper provide brief background particular role medical imaging. mimicking biological networks neurons comprise nervous system intensively used many domains computer science. work focus multi-layer feed-forward cycles. best represented directed weighted graph array input nodes inner nodes implementing speciﬁc scalar functions another array output nodes. input argument neuron weighted inputs weights associated edges. weights learned network training effectively deﬁne regression function produced ann. layer consists inputs coming outside world; neurons situated l-th layer last contains output nodes. input connected neuron second layer weighted edge weight output neuron connected input every k-th neuron second layer weight finally neuron last layer connected output weight vsj. denote function implemented neuron. number popular choices function instance tanh. weights deﬁne multi-variable regression function approximates continuous function implied training examples. training network comprises collection examples vector inputs true output related vector. training network consists optimizing weights minimal error since development back-propagation algorithm mid-eighties image processing community attained powerful tool attack virtually regression discrimination task. among wealth applications neural networks found area universal approximation theorem states network hidden layer neuron realized monotonically-increasing continuous function uniformly approximate given multivariate continuous function arbitrary small error bound practice adding hidden layers shows improvement performance. typical ram-lak action. clinical scanners parameters flow tuned speciﬁc needs radiologist different preset values chosen view bones soft tissues high contrast/smooth images speciﬁc anatomical regions etc. without low-pass ﬁlter exact inverse radon transform continuous domain noiseless case. moving theory practice algorithm perform well. low-pass convolution ﬁlter sinogram domain effective remedy projections noise. problem photon starvation manifests outlier values sinogram propagate output image form streak artifacts. corrupt image contents jeopardize diagnostic value. artifacts explained follows measured line integral effectively smeared back line image back-projection; incorrect measurement results line wrong intensity image. typically streaks radiate bone regions metal implants. statistically-based method relation sought image vector measured counts described approximates radon transform models scan process reality. additive error stems statistical noise. bayesian framework reconstruction performed computing maximum a-posteriory estimate image accurate statistical model data quite complicated often replaced gaussian approximation suitable diagonal weighting term whose components inversely proportional measurement variances. leads penalized weighted least-squares formulation e.g. diagonal matrix weights simplistic model proportional photon counts penalty term also referred prior expresses assumptions behavior clean image. expression chosen scheme rather employed perform locally-adaptive fusion number image versions produced given reconstruction algorithm upon using different conﬁgurations. brings naturally next section describe algorithm. scalar parameter controls behavior therefore inﬂuences certain characteristics estimate example responsible variance-resolution tradeoff algorithm estimate obtained different noise levels corresponding spatial resolution characteristics. described situation common many signal/image processing scenarios. basic example consider simple image denoising algorithm recovers signal noisy measurements shift-invariant low-pass ﬁlter realized convolution prescribed kernel. ﬁxed shape kernel width parameterized scalar variable wider kernel perform aggressive noise reduction averaging noisy signal larger area cost reducing spatial resolution. second relevant example work domain reconstruction. recovery attenuation classically performed filtered back-projection algorithm. latter involves low-pass ﬁlter applied individual projections. example cut-off frequency ﬁlter controls variance-resolution properties reconstructed image. examples also general situation single value parameter makes best processing algorithm. different signals different values optimal sense quality measure. indeed image computed different values different regions treatment different values speciﬁc case ad-hoc considerations tuning scalar parameter applied. domain non-parametric statistics noise reduction algorithm proven near-optimality devises switch rule selecting location signal appropriate local ﬁlter effect signal processed low-pass ﬁlter adaptive local signal smoothness. context discussion algorithm performs fusion number ﬁltered versions signal broad comprehensive overview) designed medical imaging. such hopﬁeld used computer-aided screening cervical cancer breast tumors segmentation also used compression classiﬁcation cardiac studies beat recognition tasks ﬁltering segmentation edge detection medical images addressed cellular group used neural networks optimal photon detection scintillation crystals reconstruction problems series works appeared replaces overall reconstruction chain learning contribution detector readings pixel image. electron magnetic resonance algorithm proposed floyd used approach spect reconstruction feed-forward networks also lesion detection modality remark naive application reconstruction limited low-resolution images since network must inputs outputs. instance image reconstructed. application spect reconstruction also studied kerr bartlett imaging modalities like spect lowresolution images produced natural domain application. however works tackle also problem reconstruction image size larger. ref. proposes using neural network structure training based minimization maximum entropy energy function. reconstruction electrical impedance tomography treated another variety electrical capacitance tomography ann-based reconstruction method described despite abundance applications still place innovation domain application medical imaging. first reconstruction problem rarely attacked tool high dimensions data resulting images render naive application black converting measurements image unfeasible. indeed work propose varying ﬁlter parameter. switch rule developed adaptive signal smoothing based balance stochastic structural noise components model assumptions such difﬁcult devise. moreover better output obtained allow combination given image versions pixel rather selecting alone. knowledge mathematical theory offering descriptive rule local fusion available signal estimators used denoising reconstruction. borrowing switch-rule idea ﬁlters solution propose problem described local fusion sequence estimates ¯xpn speciﬁc regression function learned training dataset consisting similar cases. among known regression methods choose work strong adaptivity generalization properties supervised learning done training examples location processed signals features sample values extracted corresponding location sequence reconstructed versions signal. output small region sample desired destination signal. contemporary training algorithms employ error back-propagation optimize objective function measuring discrepancy correct output values predicted work employ matlab neural network toolbox; training performed levenbergmarquardt algorithm networks consist hidden layers. function similar properties classical sigmoid computationally cheaper robust saturation caused large arguments. work outlined general concept specialized reconstruction algorithms speciﬁcally consider representatives types algorithms direct iterative pwls methods. propose making sweep cut-off frequency low-pass ﬁlter sinogram domain. parameter controls noise-resolution tradeoff major inﬂuence visual impression resulting images. iterative pwls algorithm sequence images extracted along execution saving version result every iterations. following sections illustrate approach simple denoising problem work number applications reconstruction algorithms detailed above. along discuss choice training design features extracted ann. illustrate proposed concept begin simple signal denoising algorithm mentioned above. assume original signal piece-wise constant choice beneﬁcial test present since random signals easily generated training/testing purposes effect low-pass ﬁlter denoising easily observed. generate signal length choosing step locations uniformly random choosing intensity value step uniformly random well segment. assume signal created contaminated i.i.d. gaussian noise noise reduction perform convolution gaussian kernel chosen values standard deviation obtain sequence estimates setup train better signal restoration. location extract small neighborhoods location signals ˆxk. concatenated vector serves input. speciﬁcally take -samples window processed signal sequence signals. thus overall feature vector location size samples. training stage every vector matched label correct value provided desired output. training procedure generate signal size extract training data described above. obtained tested another signal length randomly generated engine. figure test results presented. neural network improved best linear estimate difference observed fact estimate original signal much closer. values calculated interval samples center test signal avoid boundary problems. presented algorithm various design variables number shape width applied ﬁlters size structure neural network structure input vector example questions algorithm expression training data consisting pairs feature vectors desired label function output governed control parameters simple weighted idea mentioned encompassed choice scalar weights assigned training examples. work chosen zero examples variance input image correspond regions. speciﬁcally threshold times maximal variance zero weight also assigned examples accumulated gradient input patch maximal value. later pruning introduced order avoid bias strong bone-ﬂesh ﬂesh-air edges training process. remaining examples assign weight proportional accumulated gradient patch remaining informative edges pronounced effect learning procedure. make error measurement meaningful computed image region screened object resides ignoring background area. used active contour technique object region image; speciﬁcally used chan-vese method windowed signal-to noise ratio. dynamic range values image large bones. often diagnostic interest lies soft tissues values near zero axial sections thighs chose window algorithms tuned best reconstruction range. therefore appropriate measurement considers regions image fall range. technically reference image noisy image pre-processed standard computed projecting values lower higher respectively values. structured similarity measure measure similarity images comes replace standard mean squared error appearing formula) known problamatic correlation human visual perception system references therein). ssim compares small corresponding patches images normalization intensity contrast. explicit formula involves ﬁrst second moments local image statistics correlation compared images. numerical experiments conclude section move present speciﬁc details boosting reconstruction algorithms discuss choice error function learning process error measure evaluating quality reconstruction. supervised learning procedure design weights minimize regression error output desired labels many cases natural choice function would mean-squared-error however contemplate whether proper choice use. consider homogeneous region image small detail different similar intensity penalty paid over-smoothing reconstruction ﬁlter blurs lesion small therefore faint details lost leading better mse. remedy problem could penalize difference intensity values reference image reconstruction also difference derivatives images. alternatively weight training examples boost importance faint edge regions expense pronounced parts image edges sufﬁciently strong. spirit building general error term written equation propose spatial resolution measure spatial resolution properties non-shift-invariant reconstruction method characterized using local impulse response function replaces standard point-spread function compute lirs placing sharp impulses many random locations reference image taking difference reconstructed images scanned without spikes. full-width half-maximum value computed follows ﬁrst image matrix response function resized image larger axis order reduce discretization effect. then number pixels intensity higher half-maximum counted divided reﬁnement factor fwhm resolution measure speciﬁc location. method local fusion advocated previous section applied standard filtered back-projection algorithm reconstruction. fusion performed parameters low-pass sinogram ﬁlter applied back-projection. one-dimensional lowpass ﬁlter realized multiplication butterworth window fourier domain deﬁned sweep range parameter thus changing resolution-variance tradeoff fbp. also change parameter controls steepness window rolloff. controls amount blur introduced reconstruction parameter inﬂuences texture reconstructed image. figure show reconstruction ﬁxed value increasing cut-off frequency visually strong low-pass ﬁlter produces cleaner image looses spatial resolution. displayed sequence corresponds values testing various combinations chose three images cut-off frequencies selected eight images three frequencies another three images frequencies last obtained reason restriction three images smaller required. detail several steps list above. training stage neural network tuned minimize discrepancy true values output vector produced network noisy inputs. vector inputs built described above location reference image training using data noisy reconstructions. corresponding vector outputs disk-shaped neighborhood reference image. thus image produce using pre-deﬁned ﬁlters sample build training dataset. image sampled cartesian grid choosing every third pixel horizontal vertical directions. pair input output vectors neural networks example used training process. examples training images pool. portion pool variance inputs vector discarded examples correspond regions since constant patch kind tissue observed noisy images. step leads empirical improvement performance ann. given intensity values neighborhood pixel several noisy images network predict single value pixel fusion image. however step regularization design produce vector output interpreted small neighborhood fusion image built disk-shaped overlapping patches averaged produce ﬁnal result. done avoid possible artifacts produced network training stage produces single outlier intensity value penalty smaller vector incorrect intensities. regularization reduces performance achieve training since equations imposed performance test images expected stable. experiments used sets clinical images axial body slices extracted scan male head abdomen thighs. images courtesy visible human project. intensity levels grayscale images correspond hounsﬁeld units. training comprises male thighs sections. image training consists images examples extracted. number experience sufﬁces avoid over-ﬁtting chosen size neural network vector features example built pixel neighborhoods radius pixels coming three corresponding reconstructions. images subset reconstruction images mentioned before seeking subgroup would perform best. size input vector entries. figure present reconstruction test image. test image taken away region training data taken from. middle upper image result fusion number versions performed trained ann. visual impression noiseresolution balance fused image better versions forming texture tissues closer original level streaks general noise lower central right images image sharpness higher left central images. thus fusion image enjoys good properties offered versions superior them. recall training done weights corresponding penalty component equation iv.. quantitative error measures compute comparison include plain weighted weights training risk ssim measures. values given table observed table weighted fusion image higher highest attainable value images. plain increment .db. values training risk measure behave expectedly weights training designed implicitly reduce measure fusion image. indeed lower optimal image. finally ssim measure supports claim fusion image best visual appearance since admits larger value measure. study algorithm performance different amounts local data provided fusion. sequence test image reconstructions produced radius pixel neighborhood extracted fusion increased input vector built three neighborhoods coming reconstructions corresponding cut-off frequencies low-pass ﬁlter. remark special case regression function learned network incorporates relations pixel values different image versions larger neighborhood sizes also possibility perform local ﬁltering image. figure display graphs values computed test image. observably quality increment neighborhood radius exhausted around choice requires smaller number variables without almost loss quality. also notice graphs fusion using central pixel performance close best version tests conclude forcing neural networks evaluate number pixels neighborhood recovered reduce performance. don’t empirical evidence step truly necessary since artifacts single-pixelestimation case observed test. special case proposed method perform local processing using image. this fact post-processing algorithm based regression function implements non-linear local ﬁlter. following experiment compare performance fusion methods using three images another using image produced low-pass ﬁlter. results displayed figure visually single-image fusion case artiﬁcial streaks figure upper left reference image. upper right best-snr reconstruction. lower left fusion result output size pixel. lower right fusion result produces single pixel value. figure test images thighs sections. left column reference images. middle column fusion single image sinogram ﬁlter quality upper middle image lower middle right column fusion three versions corresponding ﬁlter cut-off frequency quality upper right image lower right different numbers iterations. idea capture gradual transformation image initial ﬁnal state. initial image blurred gradually changes along iterations towards sharper version; intermediate stages contain important information contribute improve algorithm output. method similar proposed previous section. training stage reconstruction performed high-quality reference hand. examples training produced following manner vector inputs corresponding location image assembled using neighborhoods different versions image gathered along pwls iterations. speciﬁcally take small neighborhood pixels image sequence correct answer corresponding vector inputs value pixel reference image. done previously objective function training augmented weights determine importance individual examples. conducted numerical experiments demonstrate proposed method using setup experiment. training data obtained using dataset axial male thighs section images. each initial image computed algorithm using sinogram ﬁlter cut-off frequency value pwls algorithm implemented described section ii-b parameters performed iterations saving image version every iterations overall sequence images. practice three images sequence namely iterations ﬁrst third images neighborhoods radius taken estimation pixel value second image contributed neighborhood radius overall inputs. network neurons hidden layer. single output produce central pixel provided neighborhood. speciﬁc settings obtained manual tuning design parameters. figure display fusion result along individual pwls reconstructions used fusion process. lower part ﬁgure contains absolute-valued error images. fusion result higher visual quality three underlying images. comparing images noise level fusion image lowest tissue texture closer original. sharpness lower middle pwls image. values also point improvement quality. ssim fusion image sequence pwls results ssim values reconstruction additional test image displayed figure effect fusion observed similar previous reconstruction. conclude ann-based fusion contribute also iterative reconstruction without requiring figure images thighs section. upper left right reference image ann-fused pwls middle rows three pwls versions lower absolute-valued error images fusion image best-snr pwls darker shade corresponds larger error. robustness training results apply trained thigh sections reconstruction images body parts sections head abdomen. reconstruction results presented figure order previous comparison middle image upper result fusion components presented lower row. head reconstruction improved substantially fusion process visual observation shows. however values point favor pwls image corresponding iterations highest ssim value belong fusion result though. case abdomen section fusion image similar -iterations version contains less noise; quantitative measures somewhat better individual pwls images. right figure upper part head reconstruction. left three bottom reference image ann-fused image pwls versions lower part abdomen reconstruction arrangement. last experiment consider special case performs local ﬁltering single version image without reference versions. neighborhood radius extracted location pwls image corresponding iteration number fusion result visually compared figure versus image produced pwls versions before. observed processing reduces analyze number computations required proposed method cases pwls reconstruction. first consider complexity applying perform pixel-wise fusion number image versions produced reconstruction stage. image activations required. typically dimension input vector order samples output dimension elements single hidden layer neurons used. thus network contains weights. neuron also implements sigmoid function thus requiring sigmoid calculations produce output values. therefore cost performing local fusion operations. method used reconstruction number versions must produced; experiments three reconstructions sufﬁce. reconstruction computational complexity therefore hardware changes existing scanner made producing fusion image require roughly four times extent single reconstruction course regular image available radiologist usual time single reconstruction. iterative pwls algorithm changes reconstruction process needed since sample images along standard iterations. accurate estimate time complexity pwls since depends optimization method efﬁcient implementation. however iterative process necessarily involves application system matrix operations) iteration therefore order magnitude slower fbp. adding fusion step process marginally increase total reconstruction time. introduced method quality improvement general parametric signal estimator. concept regression function local fusion number estimator’s outputs corresponding different parameter settings. regression proposed realized feed-forward artiﬁcial neural networks. fusion process consists components ﬁrst behavior signal different versions gathered; second performs nonlinear ﬁltering signal versions small neighborhoods estimated pixel. proposed method general reconstruction possible application local fusion used solve linear non-linear inverse problem algorithm producing solution estimate exists. proposed method enable incorporate algorithm outputs produced different values core parameter single improved result thus removing need tuning parameter. work concept illustrated case reconstruction done basic algorithms pwls. empirical results suggest local fusion improve resolution variance trade-off given reconstruction algorithm thus adding visual quality images. post-processing method timeconsuming cost local fusion well extent reconstruction. penalized weighted least-squares approach sinogram noise reduction image reconstruction lowdose x-ray computed tomography ieee trans. med. imaging vol. sauer hsieh j.-b. thibault bouman recursive ﬁlter noise reduction statistical iterative tomographic imaging spie/is&t conference computational imaging vol. spie. ramachandran lakshminarayanan three-dimensional reconstruction radiographs electron micrographs application convolutions instead fourier transforms proceedings national academy sciences united states america vol. automatic method discriminate malignant masses normal tissue digital mammograms phys. med. biol. vol. j.s. k.s. cheng c.w. application competitive hopﬁeld neural network medical image segmentation ieee trans. med. imag. vol. v.j. martinez j.r. hilera mazo neural networks compression classiﬁcation proceedings international conference fuzzy logic neural nets soft computing. iizuka japan. aizenberg aizenberg hiltner moraga meyer bexten cellular neural networks computational intelligence medical image processing image vision computing vol. floyd artiﬁcial neural network spect image reconstruction ieee trans. med. imag. vol. c.e. floyd g.d. tourassi artiﬁcial neural network lesion detection single-photon emission computed tomographic images investigative radiology vol.", "year": 2013}