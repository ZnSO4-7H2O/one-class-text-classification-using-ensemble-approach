{"title": "Automorphism Groups of Graphical Models and Lifted Variational Inference", "tag": ["cs.AI", "cs.LG", "math.CO", "stat.CO", "stat.ML"], "abstract": "Using the theory of group action, we first introduce the concept of the automorphism group of an exponential family or a graphical model, thus formalizing the general notion of symmetry of a probabilistic model. This automorphism group provides a precise mathematical framework for lifted inference in the general exponential family. Its group action partitions the set of random variables and feature functions into equivalent classes (called orbits) having identical marginals and expectations. Then the inference problem is effectively reduced to that of computing marginals or expectations for each class, thus avoiding the need to deal with each individual variable or feature. We demonstrate the usefulness of this general framework in lifting two classes of variational approximation for MAP inference: local LP relaxation and local LP relaxation with cycle constraints; the latter yields the first lifted inference that operate on a bound tighter than local constraints. Initial experimental results demonstrate that lifted MAP inference with cycle constraints achieved the state of the art performance, obtaining much better objective function values than local approximation while remaining relatively efficient.", "text": "using theory group action ﬁrst introduce concept automorphism group exponential family graphical model thus formalizing general notion symmetry probabilistic model. automorphism group provides precise mathematical framework lifted inference general exponential family. group action partitions random variables feature functions equivalent classes identical marginals expectations. inference problem effectively reduced computing marginals expectations class thus avoiding need deal individual variable feature. demonstrate usefulness general framework lifting classes variational approximation inference local relaxation local relaxation cycle constraints; latter yields ﬁrst lifted inference operate bound tighter local constraints. initial experimental results demonstrate lifted inference cycle constraints achieved state performance obtaining much better objective function values local approximation remaining relatively efﬁcient. classical approaches probabilistic inference area reasonably well understood traditionally exploited tree-width sparsity graphical model efﬁcient exact approximate inference. recent approach known lifted inference demonstrated possibility perform efﬁcient inference highly-connected symmetric models arising context relational probabilistic models. clear symmetry essential element lifted inference currently formally deﬁned notion symmetry probabilistic model thus formal account exploiting symmetry means lifted inference. mathematical formulation symmetry object typically deﬁned transformations preserve object interest. since forms mathematical group theory groups group action essential study symmetry. paper ﬁrst introduce concept automorphism group exponential family graphical model thus formalizing notion symmetry general graphical model. automorphism group provides precise mathematical framework lifted inference graphical models. group action partitions random variables feature functions equivalent classes identical marginals expectations. inference problem effectively reduced computing marginals expectations class thus avoiding need deal individual variable feature. demonstrate usefulness general framework lifting classes variational approximation inference local relaxation local relaxation cycle constraints; latter yields ﬁrst lifted inference operates bound tighter local constraints. initial experimental results demonstrate lifted inference cycle constraints achieved state performance obtaining much better objective function values local approximation remaining relatively efﬁcient. background groups graph automorphisms partition disjoint nonempty subsets whose union element called cell. partition deﬁnes equivalence relation denoted letting cell. partition ﬁner every cell subset cell brieﬂy review important concepts group theory graph automorphisms group non-empty binary operation associative closed contains identity element denoted exists element group containing element called trivial group. subgroup subset forms group binary operation write subgroup permutation bijective mapping itself. permutations together mapping-composition operator forms group named symmetric group symmetric group plays central role paper symmetric group permutations permutation image vector vector permuted denoted xπ); permuted denoted {xπ|x action group mapping assigns every permutation denoted identity element assigned identity permutation group product elements assigned composition action group induces equivalence relation deﬁned exists group action therefore induces partition called orbit partition denoted orbg. orbit element action elements equivalent orbg subgroup also induces ﬁner equivalence relation given group action every element preserves group said stabilize next consider action permutation group vertex graph leads concept automorphism graph vertices permutation permutes vertices preserves structure automorphisms forms group named automorphism group denoted clear subgroup cardinality indicates level symmetry trivial group asymmetric. action vertex partitions node-orbits orba node orbit vertices equivalent another node relabeling. furthermore also acts graph edges letting action partitions edge-orbits orba. similarly also obtain arc-orbits orba computing automorphism groups graphs. base density )j∈i m-dimensional feature vector natural parameter log-partition function. natural parameters epφ} realizable mean parameters convex dual mean parameter mapping maps eθφ. note relative interior details often feature function depends subset variables case write compactly factorized form indices distinct cannot reduced further i.e. must depend arguments. keep track variable indices arguments scope denote arguments k-th argument |ηi| number arguments. factored forms features encoded hypergraph nodes hyperedges {c|∃i scope models pairwise features standard graph. discrete random variables often want work overcomplete family describe case pairwise features. overcomplete features indicator functions i{xu node nodes edges graphical model φo{utvt} i{xu edge overcomplete realizable mean parameters also called marginal polytope since overcomplete mean parameter corresponds node edge marginal probabilities. given parameter transformation overcomplete representation done letting corresponding parameter overcomplete family straightforward verify automorphism group exponential family deﬁne symmetry exponential family group transformations preserve kind transformation used pair permutations permutes variables permutes feature vector. deﬁnition automorphism exponential family pair permutations vectors straightforward show automorphisms denoted forms subgroup group acts permuting action permuting action remainder paper always symmetric function therefore condition automatically holds. example. pair permutations automorphism since proposition automorphism following conditions true |ηi| |ηγ|; bijective mapping scope scope); s|ηi| |ηi|. remark. consider automorphisms type must permute features scope scope scope). thus features redundant scopes scope must generally features redundant scopes uniquely determines next consider automorphisms type must permute among variables preserve features thus features asymmetric functions must generally uniquely determines consequence features redundant scopes asymmetric functions exists one-to-one correspondence form automorphism automorphism deﬁned preserves number characteristics exponential family shown following theorem. theorem discuss principle exploit symmetry exponential family graphical model lifted variational inference. general variational inference framework marginal inference viewed compute mean parameter given natural parameter solving optimization problem lifted inference essence assumes parameter-tying setting components same. precisely assume partition goal study parameter-tying coupled symmetry family lead efﬁcient variational inference. restricting natural parameter equivalent parameter tying hence equivalent working different exponential family aggregating features family fewer parameters obvious would help inference; moreover working directly aggregation features structure original family lost. investigate effect parameter tying complexity inference turn question characterize image mean mapping ﬁrst note general taking singleton partition enforce natural parameters same clearly guarantee mean parameters same. however hope perhaps mean parameters forced symmetry graphical model. precisely following question partition mean parameter guaranteed inside therefore domain variational problem restricted accordingly partitions deﬁned general convex optimization problems below. deﬁnition consider convex optimization convex convex function. partition lifting partition aforementioned problem infx∈sϕj i.e. constraint restricted theorem every corresponds permutation every induced orbit partition orbg lifting partition theorem know stabilizes however group take parameter account. given partition permutation consistent permutes among elements cell permutations special interest since every group acting denote group elements whose actions consistent straightforward verify subgroup notation subgroup whose member’s action consistent group thus stabilizes family also every parameter straightforward verify stabilizes constraint objective function therefore previous theorem induced orbit yields lifting partition. corollary orba∆. lifting partition variational problem call ground formulation variational problem lifted formulation. number cells lifted constraint mϕthen effectively lies inside -dimensional subspace forms core idea principle lifted variational inference perform optimization lower dimensional constraint instead remark. result also holds subgroup since orbg ﬁner thus obvious also lifting partition. however smaller group ﬁner lifting partition less symmetry exploited. extreme trivial group discrete partition putting element cell corresponds lifting. characterization give characterization case discrete random variables. note convex hull conv {φ|x polytope acts conﬁgurations permuting action maps theorem orba∆ -conﬁguration orbits. orbit consequence lifted polytope extreme points. number conﬁguration orbits much smaller total number conﬁgurations |x|n model highly symmetric. example fully connected graphical model identical pairwise unary potentials every permutation part automorphism; thus every conﬁguration number belongs orbit hence general however often still exponential discuss approximations section representation lifted polytope constraints r|ϕ| directly obtained constraints polytope cell common value variables orbit mapping function maps element corresponding cell contains substituting constraints obtain constraints overcomplete variational problems state analogous results lifting overcomplete variational problems ﬁnite. simplify notation consider case features unary pairwise. before group used induce lifting partition. however need deﬁne action group overcomplete features recall automorphism graphical model graph since overcomplete features naturally correspond nodes edges natural action maps πt}. deﬁne orba∆ induced orbits overcomplete features. corollary lifting partition variational problems term lifted marginal polytope. cells intimately connected node edge orbits graph induced list cells case node orbit corresponds cells edge orbit corresponds cells t}|{u orbit corresponds cell ¯a}. orbit mapping function maps element orbit follows total number cells number node edge orbits thus working big-o order number variables reduced number nodes edges number node edge orbits. lifted approximate inference approximate variational inference typically works tractable approximation tractable approximation paper focus lifted outer bounds leave problem handling approximations future work. thus focus relaxation inference problem since outer bound outer yields outer bound outerϕo always relax lifted problem replace outerϕo. relaxed lifted problem outerϕo equivalent relaxed ground problem outer? depends whether lifting partition relaxed ground problem. theorem outer outer depends graphical model structure lifting partition relaxed problem often used outer bound local marginal polytope local enforces consistency marginals nodes nodes edges used cycle tighter bound also enforces consistency edge marginals cycle sheraliadams hierarchy provides sequence outer bounds starting local progressively tightening exact marginal polytope outer bounds depend structure graphical model thus corresponding relaxed problems admit lifting partition. note exception outer local equitable partitions used lifting partitions approximate variational problem theorem note terminology following tradition lifted inference paper uses term lift refer exploitation symmetry avoiding inference ground model. unfortunate term lift also used context coming better bounds marginal polytopes. there lift means move higher dimensional space constraints easily expressed auxiliary variables. focus lifted approximate inference using local marginal polytope local. point also restrict models features pairwise unary variables binary local polytope local deﬁned locally consistent pseudo-marginals. substituting corresponding given subsection noting constraints generated edge orbits redundant obtain constraints lifted local polytope localϕo follows. thus number constraints needed describe lifted local polytope localϕo similar ground problem constraints derived graph representation node edge orbits. deﬁne lifted graph graph whose nodes node orbits edge orbit representative corresponding edge connects node orbits note unlike lifted graph general simple graph contain self-loops multi-edges nodes. figure shows ground graph lifted graph example described subsection rewrite objective function terms as¯θ coefﬁcients deﬁned nodes edges lifted graph follows. node orbit ¯θ¯vt representative edge orbit representative ¯θ¯ett ={uv}∈¯e θo{utvt} |¯e|θo{utvt} shown lifted formulation inference local polytope described terms lifted variables lifted parameters lifted variables parameters associated orbits ground graphical model. thus derived lifted formulation also read directly lifted graph fact derived lifted formulation local relaxed problem lifted graphical model therefore algorithm solving local relaxed problem also used solve derived lifted formulation lifted inference point view lift algorithm solving local relaxed problem constructing algorithm allows since regular graph local approximation yields identical constraints every node. however nodes graph participate cycles different length hence subject different cycle constraints. discuss lifting relaxation cycle bound obtained tightening local additional linear constraints hold cycles graphical model structure called cycle constraints constraints arise fact number cuts conﬁguration cycle must even. cycle constraints framed linear constraints mean vector follows. every cycle every odd-sized subset theorem guarantees inference cycle lifted restricted feasible domain cycleϕo term lifted cycle polytope. substituting original variables lifted variables obtain lifted cycle constraints terms nocut lifted cycle constraints cycles passing fixed node node cycle constraints generated cycles passing cycle simple intersect contain repeated edges; considers simple cycles also consider cycle including non-simple cycles cyc. adding non-simple cycles change story since constraints non-simple cycles redundant. give precise characterization lifted cycle constraints obtained lifting cycle constraints transformation lifted graph ﬁxing deﬁned follows. subgroup ﬁxes nodes node orbits induced edges edge orbits edge orbit connects orbits adjacent nodes since ﬁxed node orbit hence node note general simple graph multi-edges loops. theorem cycle passes node {i}. odd-sized number cycle constraints reduced signiﬁcantly lifted space still computationally expensive list them. address issue follow employ cutting plane approach violated lifted cycle constraint iteration ﬁnding violated lifted cycle constraint propose lifted version method presented performs separation iterating nodes graph node ﬁnds violated cycle constraint cycles passing theorem suggests lifted cycle violated lifted cycle constraint could ﬁrst violated lifted cycle constraint node take violated constraints however note node orbit cyc]. hence perform separation using following algorithm notice mirror graph calculated graph. separation iteration reuse structures provided adapt edge weights mirror graph according current marginals. detecting symmetries graph automorphisms discuss computation subgroup automorphism group approach construct suitable graph whose automorphism group guaranteed subgroup thus tool algorithm computing graph automorphism applied. constructed graph resembles factor graph representation however also colors factor nodes mark feature functions identical cell colors edges encode symmetry feature functions themselves. deﬁnition colored factor graph induced denoted bipartite graph finding automorphism group graph therefore yields procedure compute subgroup thus according corollary induced orbit partition factor node lifting partition variational problems discussed earlier. nauty example directly supports operation computing automorphism group graph extracting induced node orbits. markov logic network prescribed list weighted formulas logical domain {a...a|d|}. objects appearing constants formulas objects appear formulas. ground predicates p)’s. substitution denotes result applying substitution grounding contain logical free variables. groundings grfi grfk. corresponds exponential family variable index grounding grfi feature function associated parameter truth assignment ground predicates weight formula since ground features formula parameter also induces parameter-tying partition {{φf} .{φfk renaming permutation permutation ﬁxes every object i.e. permutes objects thus renaming permutations group isomorphic symmetric group consider following actions xk/r). basically rename constants ground predicate ground formula according renaming permutation following theorem shows isomorphic subgroup automorphism group exponential family theorem every renaming permutation thus furthermore observe maps groundings formula thus action consistent parameter-tying partition {{φf} .{φfk thus according corollary orbit partition induced action lifting partition variational inference problems associated exponential family addition orbit partition quickly derived ﬁrst-order representation mln; size orbit partition depends number observed constants |do| depend actual domain size |d|. designed simpliﬁed version models enforce transitivity predicate pred called semi-transitive model. weights negative yields repulsive model relatively strong interaction shared predicate variables ﬁrst formula known difﬁcult case lifted inference. third formula observation constants ground markov network corresponding exponential family methods described sections derive lifting partitions. ﬁrst method fully grounds ﬁnds lifting partition using nauty. second works directly uses renaming group lifting partition. outer bounds marginal polytope local cycle. three variants method propositional lifting using nauty orbit partition lifting using renaming orbit partition. yields total methods compare. reference also calculate exact solution problem using ilp. figure shows runtime convergence different domain sizes logical variables mln. make observations. first cases lifting dramatically reduces runtime larger domains. second nauty-based methods suffer larger domain sizes. expected perform automorphism ﬁnding propositional graphs increasing size. third renaming partition outperforms nauty partitions virtue working directly ﬁrst-order representation. notice particular lifted-via-renaming methods still observe dependency domain size artifact current implementation—in future curves constant. finally propositional cycle method faster ilp. figure illustrates objective changes cutting plane iterations case domain size local polytope approaches cutting plane iterations hence represented single points. given exact point gives optimal solution. notice methods based outer/upper bounds variational objective hence decreasing time. first observe cycle methods converge optimal solution substantially better local methods. however propositional case cycle algorithm converges slowly barely faster ilp. lifted cycle methods clear winners problem. also different lifting partitions affect cycle performance. renaming partition performs ﬁrst iteration much quicker nauty-based partition since nauty needs work full grounded network. consequently converges much earlier too. however also observe renaming partition ﬁne-grained nauty partition leading larger orbit graphs hence slower iterations. notably working lifted cycle constraints gives substantial runtime improvements effectively optimal solutions. presented general framework lifted variational inference. this introduce study precise mathematical deﬁnition symmetry graphical models construction automorphism groups. using device automorphism groups orbits random variables obtained lifted variational inference materialized performing corresponding convex variational optimization problem space per-orbit random variables. framework enables lifting large class approximate variational inference algorithms including ﬁrst lifted algorithm inference cycle constraints. presented experimental results demonstrating lifted inference cycle constraints achieved state performance obtaining much better objective function values local approximation remaining relatively efﬁcient. future work includes extending approach handle approximations convex upperbounds would enable lifting full class approximate convex variational marginal inference. proof proposition proof. ﬁrst prove conditions theorem hold. pick since express feature factorized forms xπ). since cannot reduced further must depend distinct arguments j|ηj|}. implies arguments j|ηj|}. thus |ηi| |ηj|. apply argument automorphism note obtain |ηj| |ηi|. thus |ηi| |ηj| furthermore jk}. implies bijection scope scope jk}. proof. part prove automorphism hypergraph representing structure exponential family graphical model need show hyperedge hyperedge. hyperedge scope. proposition scope hyperedge apply reasoning using automorphism obtain part ﬁrst state identities used repeatedly throughout proof. counting measure lebesgue measure case counting measure veriﬁed directly establishing bijection summands summations case lebesgue measure direct result property linearly transformed lebesgue integrals also probability density. thus hence apply similar reasoning automorphism thus every expressed means thus exists negative entropy function becomes part thus border m\\rim holds continuity argument. proof theorem proof. proof makes orbit-stabilizer theorem elementary group-theoretic result describe below. ﬁnite group acting {k|∃g s.t. orbit containing stab stabilizer orbit-stabilizer theorem essentially states group partitioned |orb| subsets ∪k∈orbgk |gk| |stab|. thus |orb||stab|. proof. automorphism induces permutation denoted proceed steps. step overcomplete family induced guarantees action stabilizes step guarantees stabilizes linear function action steps together theorem complete proof. step recall πo}) note well-deﬁned automorphism show )πo. indeed proof. proof corollary stabilizes objective function remains show group also stabilizes outer. ﬁrst elaborate means formal sense outer depend graph intuition constraints form outer constructed purely graph property assign label nodes formally iouter indicator function outer given pair function return belongs outer otherwise. relabeling assigning index node obtain graph isomorphic reassign index accordingly obtain since construction outer invariant w.r.t. relabeling iouter iouter outer outer. thus group stabilizes outer. theorem automorphism thus also stabilizes outer. proof. clearly every lifted cycle constraint rewritten form show every constraint form lifted constraint cyc. this every cycle passing every odd-sized point constraint whose lifted form form ﬁrst show edge orbit connecting node orbits exists edge arbitrary member since node orbit exists group element take clearly satisﬁes using above straight forward prove stronger statement induction. path node orbit exists path node cycle passing path itself. thus must exist path thus take arbitrary constraint form exists corresponding ground constraint cycle passing constraint clearly belongs cyc. proof. since bi-partite graph variable factor nodes different colors automorphism must form pair permutation permutation among variable nodes permutation among factor nodes. since color shows consistent partition show automorphism exponential family this make proposition coloring since maps neighbors neighbors need show must bijection scope scope. cases. proof. renaming permutation herbrand model. denote herbrand model obtained applying groundings using lemma fk). writing vector indicates corresponding grounding true thus vector form equivalently feature function vector form acknowledgement. authors gratefully acknowledge support defense advanced research projects agency machine reading program force research laboratory prime contract fa--c-. opinions ﬁndings conclusions recommendations expressed material author necessarily reﬂect view darpa afrl u.s. government.", "year": 2012}