{"title": "DROW: Real-Time Deep Learning based Wheelchair Detection in 2D Range  Data", "tag": ["cs.RO", "cs.CV", "cs.LG", "cs.NE"], "abstract": "We introduce the DROW detector, a deep learning based detector for 2D range data. Laser scanners are lighting invariant, provide accurate range data, and typically cover a large field of view, making them interesting sensors for robotics applications. So far, research on detection in laser range data has been dominated by hand-crafted features and boosted classifiers, potentially losing performance due to suboptimal design choices. We propose a Convolutional Neural Network (CNN) based detector for this task. We show how to effectively apply CNNs for detection in 2D range data, and propose a depth preprocessing step and voting scheme that significantly improve CNN performance. We demonstrate our approach on wheelchairs and walkers, obtaining state of the art detection results. Apart from the training data, none of our design choices limits the detector to these two classes, though. We provide a ROS node for our detector and release our dataset containing 464k laser scans, out of which 24k were annotated.", "text": "fig. overview approach. extract windows ﬁxed real world size regardless laser coverage. values centered clamped range window. window classiﬁed object found weighted vote cast relative offset finally votes consolidated using non-maximum suppression scheme yield detection centroids. aids harder time avoiding approaching robot making reliable detection important. weinrich face similar task propose gandalf detector detecting people wheelchairs walkers individual laser scans. introduce feature laser segments classify adaboost classiﬁer. resulting detector performs reasonably well include baseline. paper introduce drow detector. driven application scenario focus detection wheelchairs walkers. however design decisions restrict approach objects conﬁdent generalize detection persons objects given sufﬁcient annotated training data. code data needed train detector well code annotate data tasks made available upon publication. computer vision deep learning recently become best practice replacing hand-crafted features learned ones overhauling state many tasks speciﬁcally convolutional neural networks successful challenging abstract— introduce drow detector deep learning based object detector operating range data. laser scanners lighting invariant provide accurate range data typically cover large ﬁeld view making interesting sensors robotics applications. research detection laser range data dominated hand-crafted features boosted classiﬁers potentially losing performance suboptimal design choices. propose convolutional neural network based detector task. show effectively apply cnns detection range data propose depth preprocessing step voting scheme signiﬁcantly improve performance. demonstrate approach wheelchairs walkers obtaining state detection results. apart training data none design choices limits detector classes though. provide node detector release dataset containing laser scans annotated. many autonomous robots equipped laser scanner typically used navigation-related tasks including detection people objects laser scanners widely used typically large ﬁeld view invariance lighting environmental conditions. early detection methods used simple heuristics ﬁtting lines circles past years hand crafted features coupled learned classiﬁers dominated laser based detection. within paradigm range successful people mobility road obstacle detectors developed support mobile robot navigation autonomous driving even though aforementioned models obtain respectable results general consensus seems information provided range data sufﬁcient reliably perform detection single scan leading approaches relying sensor fusion multilayered sensor setups temporal integration information tracking. show detection based single range scan actually perform well. paper speciﬁcally focus detection wheelchairs walkers. motivated service robot application elderly care facility many people rely mobility aids. since presence mobility signiﬁcantly change person’s appearance laser camera data less reliably detected existing people detectors. however especially people relying †equal contribution. ordering determined last minute coin ﬂip. work paper funded project strands authors visual computing institute rwth aachen university. e-mail lastvision.rwth-aachen.de fig. non-maximum suppression part input scan votes shown arrows joint voting grid wheelchair voting grid walker voting grid resulting detections. like multibox yolo could principle applied laser scan found naively effective. since spatial density laser points varies greatly distance ﬁxed perceptive ﬁeld cnns covers widely different scales making learning difﬁcult. make spatial information laser sensor provides propose preprocessing stage cuts normalizes ﬁxed realworld extent window around laser point. windows cast votes object locations. votes turned individual detections using non-maximum suppression scheme. show depth preprocessing voting essential components approach overview seen fig. approach require background subtraction runs frame rate modern desktop machine using single core gpu. robot easily keeps laser frame rate laptop gpu. summarize make following contributions introduce drow detector based wheelchair walker detector range data which effectively making provided depthinformation achieves state results. approach consists three steps preprocessing cuts resampled window around every laser point computes detection locations local coordinate system classifying said windows predicting relative detection locations ﬁnally voting non-maximum suppression scheme turning predictions detections. order apply detection network’s receptive ﬁeld must cover large part object. problem laser scans nearby objects cover large amount laser beams whereas distant objects handful beams. means cnn’s receptive ﬁeld circumvent problem time make real-world scale information laser data provides propose evaluate depth-guided slidingwindow fashion. means preprocess data objects approximately representation every distance thus alleviating need implicitly learn completely different representations varying distances around beam window real-world extent containing variable amount measurements depending distance current beam hits obstacle. resample measurements inside window linearly ﬁxed samples. applied window network’s receptive ﬁeld always covers real-world extent regardless distance addition center window around current point clamp values outside hull order remove distant clutter ﬁnally project values total means max)/hr applied point window around point depth illustrated fig. detailed analysis regarding preprocessing operations contribute drow’s performance found section iii-e. window thus laser point context classiﬁes whether window belongs object class interest softmax output votes center location object regression output. range data inherently rotationinvariant want perform voting absolute coordinates. instead learn offsets coordinate system centered aligned current laser point shown fig. predictions every window need consolidated detection centers. achieved making cnn’s predictions vote regular grids spanning laser’s ﬁeld total probability window seeing object interest classes detected. exceeds predeﬁned voting threshold window cast vote class-agnostic grid weight well class-speciﬁc grid weight windows potentially cast votes dataset statistics split resulting dataset train validation test set. create sets split care facility four non-overlapping areas three assigned train test validation sets respectively. fourth entrance hall split temporally disjoint sequences distributed train validation sets. based split show well approach generalizes never seen areas. table shows overview dataset well statistics subset annotated. wheelchair walker counts refer individual detections opposed instances plots show distribution distance. represents slice distance clearly showing majority observed mobility aids encountered within robot. annotation annotate data wheelchair walker centers. since dataset contains laser scans devise annotation scheme keeps effort manageable still covering full extent sequences well allowing temporal approaches developed future. instead laser scans annotate small batches throughout every sequence follows batch consists frames annotate every frame resulting annotated frames batch. within sequence annotate every batch leading total laser scans annotated. wrote custom annotation tool based matplotlib fig. example view annotation tool. dotted cone shows xtion’s ﬁeld view right ﬁrst current last image batch shown. blue cross shows annotated wheelchairs. grid blurred gaussian ﬁlter non-maximum suppression performed class-agnostic grid. maximum found grid detection predicted cell’s center using class highest votes said cell. reason voting scheme opposed treating class separately avoid detections classes position. fig. shows example different steps involved. votes cast laser points shown show three voting grids shows resulting detections. evaluation approach ﬁrst introduce dataset. outline details training procedure evaluation methods. general evaluation drow comparison baselines perform several ablation studies show much individual parts detector contribute overall performance. although weinrich provide datasets recordings limited scenes single wheelchair walker. might sufﬁce learning parameters fairly constrained features classiﬁers want learn features scratch thus require general varied data. recorded little hours data elderly care facility. setup using recorded data scitos robot equipped sick laser scanner mounted approximately ground plane. laser conﬁgured record nearly span ﬁeld view resolution totalling measurements. annotation purposes recorded rgb-d data asus xtion mounted robot’s head unfortunately allowed publish video streams privacy reasons. software infrastructure based data stored rosbags. ensure seeing enough wheelchairs walkers person permanently roamed around using either robot recording. recordings consist natural scenes recorded everyday life facility including kinds clutter ﬂower pots chairs furniture artiﬁcial recordings rolling beds drove around certain patterns bring variation dataset. apart resident’s wheelchairs included many wheelchair walker models possible including motorized wheelchair. fig. performance comparison drow gandalf detector naive deep learning baseline test sets explained section iii-d naive baseline applicable reha test set. loads sequences scans corresponding images head camera automatically ﬁnds batches need annotated. user annotation show ﬁrst current last image current batch. example view annotation tool seen fig. circle around mouse pointer indicating average wheelchair size helps user click locations wheelchair walker centers. using supportive information understanding scene able annotate mobility aids based limited camera view likely still missed few. train which preprocessed window indicative nearby wheelchair predicts whether walker predicts offset center. single pass using network output layers three-way softmax differentiating background wheelchair walker two-dimensional linear regression output. optimize network minimizing negative log-likelihood criterion softmax output root-mean-square error regression output. regression targets computed window’s local coordinate system shown fig. class-labels determined type closest detection window’s center-point maximal euclidean distance wheelchairs walkers. nearby annotation error backpropagated regression output network thus free predict offset. architecture network inspired popular vggnet follows conv conv conv conv conv conv conv represents convolution ﬁlters size maximum operation window values. batch-normalization dropout relu nonlinearities applied convolutional layers. input window resampled values network outputs vector length three sent softmax regression outputs weights initialized similarly scheme proposed except output layer initialized training network adadelta optimizer train approximate convergence. training small multiplicative random noise regression targets window target probability implemented theano voting scheme multiplicative class-weights votes re-normalize them thus voting class voting hyper-parameters using hyperopt maximize maxt fwheelchair fwalker validation f-score class using detection threshold interestingly best values wwheelchair wwalker initial guesses. trained model training computed hyperparameters validation described previous section. order evaluate real-world performance drow look precision recall curves test publicly available reha test recorded similar robot. recall test recorded never seen part care facility thus method learns location priors background models fail. result shown fig. demonstrates drow generalizes well signiﬁcantly higher precision recall gandalf test reha test set. application scenario actual detection mobility important correct classiﬁcation hence also evaluate class-agnostic performance. this ignore class detections annotations evaluation. precision recall curves class computed varying voting threshold evaluation radius meaning detection matched ground-truth falls within groundtruth’s center correct class. annotation matched detection remaining detections class false positives unmatched annotations class false negatives. well localized drow’s detections show precision-recall curves varying evaluation radii fig. cluttering curves acceptance radii mean detections well localized. annotation became clear precision annotations limited meaning evaluation radii small strongly affected labeling noise. also analyze well drow behaves respect distance laser scanner. this start ignoring detections beyond laser. slowly grow radius taking account detections plot precision recall ﬁxed threshold evolve fig. drow performs well across board especially mid-range crucial navigation planning. unsurprisingly curves change much beyond distance mobility aids observed far. none precision-recall curves quantify gandalf’s actual detection performance focus parts system independently. obtain comparable detection precision-recall values evaluate gandalf using evaluation protocol described above. provided gandalf detector single threshold tuned thus results single point plots. classagnostic case plot results cases gandalf person detections kept discarded respectively showing trade-off precision recall. note detector performance obtained code signiﬁcantly lower reported original paper. performance could improved additional covariance-based merging step brieﬂy mentioned however neither described detail paper included provided detector code. thus able reproduce results presented however extrapolating false positives missing detections observed using provided code even optimistic bound method’s performance would place detector’s curve. naive deep learning baseline train another similarly yolo directly predicts detections normalized coordinates based full scan. results baseline experiment shown dotted lines fig. missing reha test scans different amount laser beams. noted spent considerable amount time getting naive baseline work well possible follow best-practice carefully chosen receptive-ﬁelds batch-normalization careful initialization adadelta optimizer etc. however easily seen applying deep learning range data naive leads abysmal results. section analyze design decisions affects detection systematically removing substituting part deﬁnes approach. fig. summarizes experiments. overall complete drow outperforms conﬁgurations i.e. detector preprocessing depth preprocessing dissected three operations centering clamping sampling. centering input window hurts overall performance much removing ensures network’s receptive ﬁeld keeps constant real-world cnn. show spatial prior encoded useful train three hidden-layer perceptron regresses three class probabilities local trained training data used scikit-learn implementation regression forest default settings trees. training took hours resulted model compared model .mb. nevertheless forest model performs even slightly worse cases. window size evaluations performed real-world window spanning motivated typical extent wheelchairs verify reasonable choice trained network larger smaller windows. results experiment seen fig. classagnostic prediction performance best choice wheelchairs alone could detected considerably better using window results suggest improvements might obtained providing network multiple scales input windows. related approach weinrich propose distance invariant feature laser based detection. detect wheelchairs walkers persons range data ﬁrst detecting larger jumps distance. jump found create window ﬁxed real-world extent covering subsequent scan points. window discretized equally sized segments clamped distance relative window depth computed. segment characterized average depth concatenated segments form feature vector. classiﬁed adaboost classiﬁer. feature design high similarity depth preprocessing step windows created jump distance found size performance drops signiﬁcantly especially walkers. considering learn completely different representations across different distances overall performance still surprisingly good. fact walkers almost undetected agnostic performance decent suggests high confusion. finally dropping performs worst measures showing steps train version network regresses angular offset absolute distance laser scanner experiment also remove centering otherwise impossible predict. without centering network could principle learn pass through centerpoint’s distance bias last layer. drastically degraded results suggest much difﬁcult problem learning procedure fails solve. difﬁculty caused interaction preprocessing also train network make predictions unprocessed data model performing worst shows even plain voting-based network alone perform well care taken input output. create window every scan point. biggest difference however directly predict detection center object class every window vote centers step detector shown essential. publications identify need distance-invariant representation highlight work. solution creating re-sampled depth image point-cloud ray-tracing however involves multiple signiﬁcantly complex operations proposed simple pre-processing timings provided. commonly-used solution creation occupancy-grid approach effectively uses -dimensional inputs data ndimensional manifold approach keeps input n-dimensional. arguably latter makes learning easier predictions robust addition multiple different heuristics exist ﬁlling holes occupancygrids whereas pre-processing doesn’t produce holes ﬁrst place. data representations made work believe lower-dimensional representation simpler effective. others used voting detection laser scans mozos multi-height laser setup spinello layered fashion based range data. both related learn shape models data cast votes different laser layers detection centroids. however similar weinrich rely jump distance segmentation segments cast votes detections. wang prove detection using voting scheme corresponds sliding-window detection sparse grid linear models. achieve good detections point clouds using hand-crafted features linear shown time computer vision literature learned non-linear features classiﬁers outperform handcrafted features linear classiﬁers large margin. line ﬁndings voting recently shown work well combination various deep learning approaches would thus interesting establish relationship deep non-linear voting detectors drow sliding-window detectors sparse inputs shown limited persons mobility aids. around time uploaded preprint paper ondruska shows tracking pedestrians cyclists buses cars road obstacles range data. although seemingly similar work input occupancy-grid predict labelled occupancygrid opposed discrete detections tracks ids. based biases static grid cells remains seen well approach works mobile robot. information extracted range data done achieve designing large hand-crafted features. agree instead learn feature representations data directly. interesting aspects detector highlighted. firstly given experimental evaluation becomes clear perform well respect wheelchairs walker performance leaves room improvement. reason could fact training rather biased towards wheelchairs. however classagnostic precision-recall curves similar ones wheelchairs experiments. suggests signiﬁcant problem walker detection high confusion wheelchairs. fact whenever drow detects mobility either class well localized leads conclusion network understood walkers needs them. secondly laser-based detection often dismissed sparse difﬁcult single frame. hope results refute fear even though dismiss performance gain could likely achieved tracking detections time. commonly suggested alternative laser-based detections vision-based detector cameras produce much richer data. several approaches tried none general enough applied scenarios. typically rely geometric primitives speciﬁc camera setups furthermore commonly used rgb-d sensors asus xtion mounted human sized robot narrow ﬁeld view perceive wheelchairs away well come close robot. vision-based detectors would thus need many cameras cover ﬁeld view covered single laser scanner. additionally since mobility aids come many different appearances training detector robustly would require vastly larger dataset. thus laserbased detector shown feasible here effective efﬁcient approach. paper introduced drow detector fast deep learning based detector wheelchairs walkers range data. proposed depth preprocessing voting scheme enable cnns vastly outperform naive detection baselines obtain state results compared previous method. performed thorough experimental evaluation justifying major design choices. achieve this recorded large dataset annotated wheelchair walker centroids believe enable research. convinced detector generalizes classes given training data thus useful community. upon acceptance paper publish code including node annotated dataset. fr´ed´eric bastien pascal lamblin razvan pascanu james bergstra goodfellow arnaud bergeron nicolas bouchard yoshua bengio. theano features speed improvements. deep learning unsupervised feature learning nips workshop james bergstra daniel yamins david daniel cox. making science model search hyperparameter optimization hundreds dimensions vision architectures. icml cyril cauchois fabrice chaumont bruno marhic laurent delahoche m´elanie delafosse. robotic assistance automatic wheelchair tracking following functionality omnidirectional vision. iros fausto milletari seyed-ahmad ahmadi christine kroll annika plate verena rozanski juliana maiostre johannes levin olaf dietrich birgit ertl-wagner b¨otzel hough-cnn deep learning segmentation deep brain regions ultrasound. arxiv preprint arxiv. peter ondruska julie dequaire dominic zeng wang ingmar posner. end-to-end tracking semantic segmentation using recurrent neural networks. workshop limits potentials deep learning robotics pedregosa varoquaux gramfort michel thirion grisel blondel prettenhofer weiss dubourg vanderplas passos cournapeau brucher perrot jmlr duchesnay. scikit-learn machine learning python. nitish srivastava geoffrey hinton alex krizhevsky ilya sutskever ruslan salakhutdinov. dropout simple prevent neural networks overﬁtting. jmlr christoph weinrich wengefeld christof schroeter horstmichael gross. people detection distinction walking aids laser range data based generic distance-invariant features. ro-man", "year": 2016}