{"title": "Demand-Driven Clustering in Relational Domains for Predicting Adverse  Drug Events", "tag": ["cs.LG", "cs.AI", "stat.ML"], "abstract": "Learning from electronic medical records (EMR) is challenging due to their relational nature and the uncertain dependence between a patient's past and future health status. Statistical relational learning is a natural fit for analyzing EMRs but is less adept at handling their inherent latent structure, such as connections between related medications or diseases. One way to capture the latent structure is via a relational clustering of objects. We propose a novel approach that, instead of pre-clustering the objects, performs a demand-driven clustering during learning. We evaluate our algorithm on three real-world tasks where the goal is to use EMRs to predict whether a patient will have an adverse reaction to a medication. We find that our approach is more accurate than performing no clustering, pre-clustering, and using expert-constructed medical heterarchies.", "text": "learning electronic medical records challenging relational nature uncertain dependence between patient’s past future health status. statistical relational learning natural analyzing emrs less adept handling inherent latent structure connections related medications diseases. capture latent structure relational clustering objects. propose novel approach that instead pre-clustering objects performs demand-driven clustering learning. evaluate algorithm three realworld tasks goal emrs predict whether patient adverse reaction medication. approach accurate performing clustering pre-clustering using expert-constructed medical heterarchies. statistical relational learning focuses developing learning reasoning formalisms combine beneﬁts relational representations relational databases ﬁrst-order logic probabilistic graphical models handling uncertainty. especially applicable domains important incorporate information multiple diﬀerent relations learned model explicitly model uncertainty. emerging application meets criteria analyzing electronic medical records relational database stores patient’s clinical history disease diagnoses procedures prescriptions results etc. using emrs possible build models address important medical problems predicting patients risk adverse response certain drug. however emrs pose challenges relational schemas longitudinal nature because diﬀerent patients dramatically diﬀerent numbers entries given table diagnoses vitals. furthermore important model uncertain non-deterministic relationships patients’ clinical histories current future predictions health status. latent structure poses substantial challenge using machine learning analyze data. patient’s clinical history records information speciﬁc prescribed medications speciﬁc disease diagnoses. explicitly mention important connections diﬀerent medications diagnoses medications could prescribed treat illness. information necessary build accurate models. medical resources provide relevant information. example diagnoses codes tree structured hierarchy vocabulary concepts. impossible single pre-deﬁned hierarchy capture medically-relevant groupings diseases medications particular prediction task. example suppose using machine learning detect certain antibiotics carry risk liver damage known eﬀect. antibiotics number people taking small enough association weak meet interestingness threshold support threshold association rule mining. algorithm examines antibiotics antibiotics grouped mechanism action drugs class exhibit association. detecting assocation adverse event requires discovering right grouping antibiotics grouping unlikely appear existing heterarchies. addressing problem requires automatically detecting diseases medicines informative speciﬁc prediction task grouping together. state-of-the-art systems unable eﬀectively cope challenge latent structure approaches address problem relational clustering objects and/or relations domain intuitively objects clustered together occur similar contexts approaches discovering relevant structure data opposed addressing speciﬁc prediction task. furthermore top-down divisive search computationally infeasible complex domains emrs contain large numbers objects scalable pre-clustering approach searches latent relationships among objects domain. thus miss subtle interactions relevant task hand. paper proposes lucid novel approach automatically discovers clusters objects relational domain makes invented clusters ﬁnal learned model. rather ignoring target task simply pre-clustering objects lucid dynamically clusters objects possibly hierarchically demand-driven fashion. identiﬁes useful coverage regularity data lucid tries strengthen selecting object regularity grouping together objects and/or existing groups expand coverage. evaluates proposed grouping strengthens regularity results accurate learned model. lucid allows object participate multiple diﬀerent groupmotivate evaluate proposed approach speciﬁc task predicting adverse drug reactions data. adrs fourth-leading cause death united states represent major risk health quality-of-life economy. pain reliever vioxxtmalone earning billion year found double risk heart attack pulled market similar drugs remain market. additionally accurate predictive models adrs actionable. model found accurate prospective trial could used avoid giving drug highest risk adr. using three real-world tasks demonstrate proposed approach produces accurate model using pre-deﬁned medical hierarchies several machine learning based approaches. furthermore algorithm uncovered latent structure doctor expertise tasks deemed interesting relevant. lucid dynamically constructs clusters capture latent relationships diﬀerent objects domain. context algorithm vista combines automated feature construction model learning single process. vista uses ﬁrst-order deﬁnite clauses capture relational information deﬁne features. features become nodes bayesian network. vista deﬁnes features using non-recursive datalog subset ﬁrst-order logic. alphabet consists three types symbols constants variables predicates. constants start upper case letter denote speciﬁc objects domain. variable symbols denoted lower case letters range objects domain. predicate symbols refers arity predicate represent relations among objects. atom constant variable. literal atom negation. clause disjunction ﬁnite literals. deﬁnite clause clause contains exactly positive vista uses deﬁnite clauses deﬁne features statistical model. deﬁnite clause becomes binary feature underlying statistical model. feature receives value example data example satisﬁes clause receives value zero otherwise. vista starts learning model empty feature corresponds model predicts prior probability target predicate. repeatedly searches features ﬁxed number iterations. iteration vista ﬁrst selects random seed example performs general-to-speciﬁc breadth-ﬁrst search space candidate clauses. guide search process constructs bottom clause ﬁnding facts relevant seed example vista constructs rule containing target attribute right-hand side implication. means feature matches examples. creates candidate features adding literals appear bottom clause left-hand side rule makes feature speciﬁc restricting candidate literals appear bottom clause helps limit search space guaranteeing generated reﬁnement matches least example. vista converts candidate clause feature evaluates learning model incorporates principle structure learner could used vista typically uses tree-augmented naive bayes model vista evaluates comparing generalization ability current model versus model learned feature extended vista calculating area precision-recall curve tuning set. auc-pr used relational domains typically many negative examples positive examples auc-pr ignores potentially large number true negative examples. iteration vista adds feature results largest improvement score model. order included model must improve score certain percentage-based threshold. helps control overﬁtting pruning relatively weak features improve model score slightly. feature improves model’s score simply proceeds next iteration. high-level innovation lucid occurs constructing feature deﬁnitions. here algorithm ability invent hierarchical clusters pertain subset objects domain. intuitively constants appear grouping share latent relationship. discovering exploiting latent structure feature deﬁnitions provides several beneﬁts. first allows compact feature deﬁnitions. second aggregating across groups objects helps identify important features otherwise deemed relevant learning algorithm. illustrate intuition behind lucid running example adrs medication warfarintm blood thinner commonly prescribed patients risk stroke. however warfarin known increase risk internal bleeding patients. consider following feature deﬁnition rule applies patients satisfy conditions left hand side rule. conditioning whether patient prescribed terconazole limits applicability rule. terconazole enzyme inducer type medication known elevate patient’s sensitivity warfarin. however many drugs enzyme inducer class frequently prescribed instead terconazole makes feature overly speciﬁc. potentially stronger feature would replace terconazole invented concept enzyme inducer warfarin elevator. concepts explicitly encoded clinical data. grouping together related objects lucid captures latent structure able learn general features. example could generalize previous rule follows deﬁnition cluster shown cluster deﬁnition below represents latent structure among group medicines. rule general rule true patient taken medications assigned cluster. rule restrictive true patients taken terconazole. lucid’s goal capture hierarchical latent structure speciﬁc objects domain. conceptually clusterings represent latent structure. lucid introduces unary predicate cluster/ cluster invents. predicate true object assigned cluster represents. deﬁnition learned appear learned rules rule lucid assign objects clusters ways. first lucid assign individual objects cluster. captures speciﬁc constants interchangeable cases. example terconazole rifampicin ketoconazole enzyme inducers doctor could reasonably prescribe them. thus lucid could invent cluster generically called cluster follows before ﬁrst statements assign speciﬁc drugs cluster. step third statement constants assigned cluster assigned cluster well. proposed grouping used feature included model available future reuse learning procedure. reusing previously discovered concepts allows algorithm automatically explore tradeoﬀs between ﬁne-grained grouping high-level groupings present data. furthermore allows algorithm build progressively complex concepts time. step algorithm discovering latent structure. given feature deﬁnition constant replace cluster latent structure learned according two-step process. ﬁrst step rewrites feature definition applies objects invented cluster instead single speciﬁc object. second step decides objects assign newly invented cluster. feature redeﬁnition lucid rewrites feature deﬁnition replacing reference speciﬁc constant variable conjoining invented latent structure predicate rule shown algorithm example rule would transformed rule rule variable instead constant terconazole feature deﬁnition extended invented predicate cluster. assigning objects cluster order learn deﬁnition invented latent predicate cluster rule lucid needs decide objects include cluster. lucid employs bottom-up data-driven approach assigning objects cluster. cluster initially contains single constant lucid greedily adds additional constants type lucid creates initial cluster assigning running exreplaced constant ample following statement cluster. next tries identify candidate constants type could added cluster. ideally candidate given candidate lucid tries extend deﬁnition cluster construction. adds candidate turn cluster. beneﬁt modiﬁed cluster measured seeing score retrained model includes feature makes extended cluster deﬁnition improves. lucid greedily selects single constant results largest improvement model’s score. procedure iterates addition improves model’s performance candidate constants empty. result cluster deﬁnition illustrated either cluster deﬁnition cluster deﬁnition would include object type well every previously invented cluster type. often computationally infeasible large number objects. example predicting adverse reactions data contains information thousands drugs diseases. central challenge identify small promising candidates include grouping. lucid restricts candidate objects near miss examples. illustrate idea consider following rules condition drug fewer patients. patients match rule speciﬁc rule took similar identical medication. sense rule provides context drug like terconazole prescribed. thus focusing medications prescribed patients match rule rule potentially identify medications prescribed place terconazole. considering objects near miss examples desirable properties. first adds objects cluster improve rule’s positive minus negative coverage score meaning addition guaranteed increase recall without harming precision least training set. second objects property considered giving heuristic completeness property. candidate thus includes previously invented clusters type constants appear algorithm provides overview lucid. uses procedure vista construct initial candidate features. next lucid considers augmenting feature deﬁnition extra invented predicate calling procedure outlined subsection diﬀerence vista results larger much expressive candidate features. however large number candidate features prohibitively expensive consider inventing incorporating learned cluster feature deﬁnition. therefore lucid restricts itself inventing latent concepts features meet following conditions condition rule consideration improves score model. provides initial evidence rule useful algorithm able improve quality modeling latent structure. discarding rules initially exhibit improvement dramatically improves algorithm’s eﬃciency. condition rule must contain constant type user identiﬁed candidate having latent structure. helps reduce search space types constants exhibit latent structure. candidate feature meets criteria lucid attempts discover latent structure. invokes procedure outlined subsection adds feature constructs contains invented latent predicate candidate features. expanded candidate feature lucid picks highest scoring feature fbest adds feature set. fbest contains invented cluster cluster made available reuse subsequent iterations. feature improves model’s score lucid goes next iteration. procedure terminates running ﬁxed number iterations. section evaluate proposed approach three real-world data sets. tasks given patients take certain medication goal model patients related adr. compare following algorithms. expert+vista setting augmented data hand-crafted hierarchies diagnoses medications. diagnoses used levels hierarchy. medications hierarchy developed medical collaborators. vista augmented data set. thus instead limited speciﬁc disease diagnoses medications recorded patient expert+vista learn rules exploit information diseases medications appear higher expert deﬁned hierarchies. gether objects related other. first analyzes training data produces clustering objects domain. exploit sne’s clusters vista create unary predicate clustering true every object assigned cluster. second vista data augmented sne’s learned clustering. thus learned rules incorporate clusters discovered sne. data comes large multispecialty clinic using electronic medical records since electronic data back early received institutional review board approval undertake studies. tasks access information observations test results disease diagnoses medications. patient data week patient’s ﬁrst prescription drug consideration. ensures building predictive models data generated patient prescribed drug. characteristics task found table brieﬂy describe task. selective inhibitors class pain relief drugs found increase patients risk myocardial infarction angiotensin-converting enzyme inhibitors class drugs commonly prescribed treat high blood-pressure congestive heart failure. known people acei result angioedema warfarin commonly prescribed blood-thinner known performed stratiﬁed ten-fold cross-validation task. used default parameter settings. sub-divided training data used folds training model structure parameters four folds tuning. require candidate feature result least improvement auc-pr order considered acceptance. parameters identical approaches. diﬀerence vista lucid based approaches lucid introduce latent structure. without ability algorithms would construct evaluate identical candidate feature sets. table reports average auc-prs tasks. lucid alone outperforms non-lucid approaches three tasks. three addition codes improves lucid’s performance degrades lucid’s performance. selective cox- warfarin domains lucid results relatively large improvements auc-pr respectively compared vista. domains lucid improves auc-pr compared sne+vista. lucid oﬀers improvements compared using expert provided heterarchies. improvements come little run-time cost. across three tasks average time fold approximately hour vista hours sne+vista hours vista+expert hours lucid hours lucid+expert. sne+vista slow running took hours fold. clearly beneﬁt incorporating latent information relationships medicines diseases. particular beneﬁcial include data-driven latent structure expert provided heterarchies. interestingly learned structure always valuable expert heterarchies terms building accurate model. indicates resources either lack relevant groupings terms groupings right granularity prediction tasks. expert+vista achieves best non-lucid based result three tasks. combining lucid expert knowledge always useful. likely explanation approach largest search space falls local optimum. utility pre-clustering prior learning represented sne+vista less clear. approach improves baseline tasks better hand-crafted heterarchy task. visual inspection sne’s learned clustering show discovers reasonable concepts medical perspective. however tends discover high-level concepts perhaps less useful prediction task hand. constrast lucid’s discovery task directed also leverage partial feature deﬁnitions detect correlations among objects arise context speciﬁc rule. another important evaluation measure whether lucid invents interesting relevant concepts. presented several invented clusters medical doctor expertise circulatory diseases. focus discussion structures selective cox- domain. expert noted cluster containing drugs diltiazem calcium-channel blocker clopidogrel antiplatelet agent. cardiac drugs frequently used acute coronary syndrome especially angioplasty. terms diseases expert highlighted cluster describing cardiac catheter coronary angioplasty consistent acute coronary syndrome means patient high risk another cluster interest involved cholecystectomy procedure removes gall blader females diagnosis often confused gall bladder pain. finally expert remarked cluster containing hearing loss ﬁnding deserves investigation. lies intersection relational learning graphical model learning. thus methods discovering latent structure build predicate invention relational learning latent variable discovery propositional graphical models approach closely related dietterich michalski’s relational learning work internal disjunction. operation replaces constant disjunction several constants. beyond work allowing reuse internal disjunction importantly explicitly modeling reasoning uncertainty data invented predicates. work ﬁrst combine ideas latent variable discovery predicate invention perform cluster-based concept discovery uncertain relational domains popescul ungar pre-processing step learns clusterings treats cluster membership invented feature learning. contrast lucid uses learning process guide cluster construction also allows reuse clusters part clusters. sutskever focus binary relations whereas domains higher arity relations. empirically system compare outperformed domain similar complexity size considered. presented lucid novel algorithm discovers latent structure dynamic demand-driven procedure. learning invent clusters objects domain include learned model. evaluated lucid learning models electronic medical record data predict patients risk suﬀer given adverse drug reaction three tasks investigated lucid resulted improved performance compared standard baseline pre-clustering based latent structure discovery algorithm using expert-constructed medical heterarchies. additionally produced meaningful latent structure. important directions research include applications adrs tasks learning emrs types relational databases. thank daniel lowd maurice bruynooghe reviewers helpful feedback. partially supported research fund k.u.leuven marie curie career fwo-vlaanderen funded", "year": 2012}