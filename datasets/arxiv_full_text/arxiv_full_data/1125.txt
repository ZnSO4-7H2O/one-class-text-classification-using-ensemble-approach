{"title": "DeepAPT: Nation-State APT Attribution Using End-to-End Deep Neural  Networks", "tag": ["cs.CR", "cs.LG", "cs.NE", "stat.ML"], "abstract": "In recent years numerous advanced malware, aka advanced persistent threats (APT) are allegedly developed by nation-states. The task of attributing an APT to a specific nation-state is extremely challenging for several reasons. Each nation-state has usually more than a single cyber unit that develops such advanced malware, rendering traditional authorship attribution algorithms useless. Furthermore, those APTs use state-of-the-art evasion techniques, making feature extraction challenging. Finally, the dataset of such available APTs is extremely small.  In this paper we describe how deep neural networks (DNN) could be successfully employed for nation-state APT attribution. We use sandbox reports (recording the behavior of the APT when run dynamically) as raw input for the neural network, allowing the DNN to learn high level feature abstractions of the APTs itself. Using a test set of 1,000 Chinese and Russian developed APTs, we achieved an accuracy rate of 94.6%.", "text": "abstract. recent years numerous advanced malware advanced persistent threats allegedly developed nation-states. task attributing speciﬁc nation-state extremely challenging several reasons. nation-state usually single cyber unit develops advanced malware rendering traditional authorship attribution algorithms useless. furthermore apts state-of-theart evasion techniques making feature extraction challenging. finally dataset available apts extremely small. paper describe deep neural networks could successfully employed nation-state attribution. sandbox reports input neural network allowing learn high level feature abstractions apts itself. using test chinese russian developed apts achieved accuracy rate malware detection always challenging research topic special challenge involves nation-state advanced persistent threats highly sophisticated evasive malware. since usage cyber weapons might considered question which country responsible? could become critical. paper features dynamic analysis train nation-state attribution classiﬁer. main contribution paper providing ﬁrst nation-state attribution classiﬁer achieves high accuracy largest test available nation-state developed apts ever collected successfully attributing malware families. rest article structured follows section contains relevant related work cases. section speciﬁes problem deﬁnition unique challenges domain nation-state attribution general especially using feature engineering. section contains nation-state attribution classiﬁer implementation experimental results. section contains concluding remarks. binary program authorship attribution. provides broad review many topics including natural language processing traditional machine learning algorithms relevant features used example lexical syntactic semantic application speciﬁc following sub-sections focus ones relevant work certain stylistic features survive compilation process remain intact binary code leads feasibility authorship attribution binary code. rosenblum extracted syntax-based semantic-based features using predeﬁned templates idioms n-grams graphlets. machine learning techniques applied rank features based relative correlations authorship. alrabaee extracted sequence instructions speciﬁc semantics construct graph-based register manipulation machine learning algorithm applied afterwards. caliskan extracted syntactical features present source code decompiled executable binary. though approaches represent great eﬀort authorship attribution noted applied real malware. furthermore limitations could observed including weak accuracy case multiple authors potentially thwarted light obfuscation inability decouple features related functionality related authors styles. diﬃculty obtaining ground truth labels samples much work area focus clustering malware wide range obfuscation techniques common many researchers focus dynamic analysis rather static features work pfeﬀer examines information obtained static dynamic analysis malware samples order organize code samples lineages indicate order samples derived other. alrabaee used features extracted disassembled malware code executable itself used mutual information information gain rank them built classiﬁer using ranked features. methods require large amount pre-processing manual domain-speciﬁc feature engineering obtain relevant features. malware attribution papers mentioned applicable cases malware evolution another malware family functionality-wise. methods eﬀective completely diﬀerent families malware examined. paper presents novel application work marquis-boire examines several static features intended provide credible links executable malware binary produced authors. however many features speciﬁc malware command control infrastructure data exﬁltration methods authors note features must extracted manually. best knowledge available paper explicitly dealt nation-state apts detection however cases limited accuracy performance measures provided. addition paper deal classifying nation developed malware rather mentioned could similarities known nationstate unknown infer attribution latter. nation-state usually single cyber unit developing products single developer unit. means accuracy traditional authorship attribution algorithms associates author source code program using stylistic features source code features survived compilation would limited. apts also state-of-the-art evasion techniques such-as anti-vm antidebugging code obfuscation encryption making feature extraction challenging. moreover number available apts small since apts tend targeted used speciﬁc purposes therefore available many computers. evasion mechanisms make hard detect well. results decrease training size learn. finally since nation states aware apts caught commonly might fool security researchers examining think another malware developer group developed unlike traditional authorship attribution problems case authors actively trying evade attribution encourage false attribution. despite issues manual nation-state attribution performed mostly based functional similarities shared command control servers etc. example apts duqu flame gauss attributed origin stuxnet following cumbersome advanced manual analysis question overcome challenges create automated classiﬁer deep neural networks greatest advantages ability features input learning higher level features training process. process hidden layer extracts higher level features previous layer creating hierarchy higher-level features. reason deep learning classiﬁers perform better traditional machine learning classiﬁers complex tasks requires domain-speciﬁc features language understanding speech recognition image recognition etc. framework input high level features derived manually based limited dataset thus necessarily ﬁtting task hand. instead input features learns high-level hierarchy features training phase. deeper hidden layer higher abstraction level features previous work applying machine learning malware analysis relied manually crafted features david trained dynamic analysis reports generate malware signatures malware family classiﬁcation context. paper similarly train dynamic analysis reports goal obtaining diﬀerent functionality beneﬁts using features cheaper less time consuming manual feature engineering. especially true case nation-state apts code requires time reverse engineer in-order gain insights features obfuscation techniques commonly used mentioned above. higher accuracy deep learning classiﬁers since important features never overlooked. instance nation-state attribution classiﬁer mentioned next section used technique suggested assess contribution features multiplying weights network highest value indicates signiﬁcant feature. seen that besides expected calls strings servers arbitrary hexadecimal values surprisingly important features. security researcher might throw addresses away since useless. however values size data speciﬁc section contained encrypted malicious shellcode identifying speciﬁc malware family. ﬂexibility ability features diﬀerent classiﬁcation objectives. instance nation-state attribution classiﬁer uses features malware signature generator implemented therefore could implement both using single feature extraction process. challenges mentioned previous section require novel approach inorder mitigate them. mentioned before problem hand regular authorship attribution problem since single developer likely involved might replaced middle development. makes regular authorship attribution algorithms using personal stylistic features irrelevant. another approach would consider nation state apts part single malware family. rationale common frameworks functionality exist diﬀerent apts nation. however also accurate nation might several cyber units targets frameworks functionality etc. thus would accurate look classiﬁcation task malicious/benign classiﬁer label might contain several families might little common. fortunately known excel complex tasks. brings usage features since know many actual families available dataset need features letting build feature abstraction hierarchy itself taking account available families mentioned section sandbox analysis report executable provide useful information leveraged many diﬀerent classiﬁcation tasks. order show advantages using features classiﬁer chosen features used diﬀerent classiﬁcation tasks. cuckoo sandbox widely used open-source project automated dynamic malware analysis. provides static analysis analyzed header metadata imports exports sections etc. therefore provide useful information even absence dynamic analysis e.g. anti-vm techniques used nation-state apts. cuckoo sandbox also provides dynamic analysis monitors process system calls arguments return value. thus provide useful information mitigate obfuscation techniques used nation-state apts. decided cuckoo sandbox reports data classiﬁers level detail conﬁgurability popularity. used cuckoo sandbox default conﬁguration. used words only basic features commonly used text analysis domain. although cuckoo reports json format parsed speciﬁc information obtained them perform parsing. words treated reports text completely ignoring formatting syntax etc. goal classiﬁers learn everything including json parsing necessary. therefore markup tagged parts ﬁles extracted well. instance \"api createfilew\" terms extracted \"api\" \"createfilew\" completely ignoring part means. select features words highest frequency cuckoo reports removing words appear ﬁles. rationale words appear ﬁles words uncommon contain lots useful information. convert sandbox -sized string checking whether words appear analyzed cuckoo report feature= i-th common word appears cuckoo report otherwise. training-set included ﬁles class dozens known campaigns nation-developed apts. samples training used validation set. test contained additional ﬁles class labels ﬁles based well-documented extended manual analyses within cyber-security community conducted past years. note above-mentioned separation training test sets completely separates diﬀerent families well. family test variations also test only. makes training challenge much diﬃcult many cases inevitably training developed group developers testing developed completely diﬀerent group. softmax layer. used dropout rate input noise rate prevent overﬁtting. relu activation function used initial learning rate decayed epochs. hyper-parameters optimized using validation set. test accuracies surprising light complete separation malware families train test sets. inevitably many cases developers even developing units train test sets diﬀerent given strict separation light high accuracy results obtained results lead conclusion nation-state diﬀerent sets methodologies developing apts separate cyber units nation still similar cyber unit nation paper presented ﬁrst successful method automatic attribution nation-states using dynamic analysis reports input training deep neural network attribution task. features advantages saving costs time involved manual training analysis process. also prevents losing indicative data classiﬁer accuracy allows ﬂexibility using features many diﬀerent classiﬁcation tasks. results presented lead conclusion despite eﬀorts devoted nation states diﬀerent cyber units developing unattributable apts still possible reach rather accurate attribution. additionally diﬀerent nation-states diﬀerent developing methodologies works developers separate cyber units still suﬃciently similar allow attribution. work presented could help facilitate automatic attribution nation-state attacks aware nation-states could subvert methods presented would modify apts lead misclassiﬁcation attribution another nation-state. example using deep neural networks themselves could employ generative adversarial networks modify successfully fools classiﬁer attributing another nation-state. applying modiﬁcation would prove diﬃcult theoretically possible.", "year": 2017}