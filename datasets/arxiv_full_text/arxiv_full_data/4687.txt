{"title": "Bag-of-Words Representation for Biomedical Time Series Classification", "tag": ["cs.LG", "cs.AI"], "abstract": "Automatic analysis of biomedical time series such as electroencephalogram (EEG) and electrocardiographic (ECG) signals has attracted great interest in the community of biomedical engineering due to its important applications in medicine. In this work, a simple yet effective bag-of-words representation that is able to capture both local and global structure similarity information is proposed for biomedical time series representation. In particular, similar to the bag-of-words model used in text document domain, the proposed method treats a time series as a text document and extracts local segments from the time series as words. The biomedical time series is then represented as a histogram of codewords, each entry of which is the count of a codeword appeared in the time series. Although the temporal order of the local segments is ignored, the bag-of-words representation is able to capture high-level structural information because both local and global structural information are well utilized. The performance of the bag-of-words model is validated on three datasets extracted from real EEG and ECG signals. The experimental results demonstrate that the proposed method is not only insensitive to parameters of the bag-of-words model such as local segment length and codebook size, but also robust to noise.", "text": "manual inspection monitoring experts. therefore automated system assist professional experts analyze long-term biomedical signals valuable realword applications. automatic analysis biomedical time series signals based machine learning techniques applied variety real-word applications. instance signals automatically analyzed epileptic seizure detection brain computer interaction human mental fatigue detection emotion recognition signals provide useful information heart rhythm used study heart arrhythmias essential extract meaningful features represent individual time series aforementioned applications. methods directly describe time series time domain others extract features transformed domain instance zadeh extracted morphological timing-interval features segments classify heartbeats. extracted line length features based discrete wavelet transform detect epileptic segments. previous representations extract local temporal frequency information characterize time series effective short time series time series periodic waveforms. however limited ability capture structural similarity long time series repetitive un-periodic waveforms instance electrocardiography electroencephalography signals. order capture high-level structural information time series proposed bag-of-patterns representation converting time series words string using symbolic aggregate approximation temporal order local segments i.e. local patterns time series ignored local segments time series histogrammed construct bag-of-patterns representation. bag-of-patterns representation effective capture structural similarity time series. however drawback bag-of-patterns representation dimension high limits application large datasets. instance size alphabet number symbols respectively dimension bag-of-patterns representation could reach work motivated success bag-ofwords model text document analysis image analysis propose simple effective bag-ofwords representation whose dimension much lower bag-of-patterns representation characterize biomedical time series. bag-of-words representation able capture highabstract—automatic analysis biomedical time series electroencephalogram electrocardiographic signals attracted great interest community biomedical engineering important applications medicine. work simple effective bag-of-words representation able capture local global structure similarity information proposed biomedical time series representation. particular similar bag-of-words model used text document domain proposed method treats time series text document extracts local segments time series words. biomedical time series represented histogram codewords entry count codeword appeared time series. although temporal order local segments ignored bag-of-words representation able capture high-level structural information local global structural information well utilized. performance bag-of-words model validated three datasets extracted real signals. experimental results demonstrate proposed method insensitive parameters bag-of-words model local segment length codebook size also robust noise. index terms—bag words codebook construction clustering tion hardware cost large amount biomedical signals electroencephalogram electrocardiographic collected every day. biomedical signals useful monitoring human’s physical condition. however challenging task efﬁciently effectively analyze signals. traditionally signals manually analyzed professional experts. however several disadvantages manual analysis. firstly comparing large amount biomedical signals number professional experts especially ones extensive experience limited. secondly inspection monitoring long-term biomedical signals signals always time consuming. difﬁcult keep high level concentration lengthy inspection giving rise increase false rate operator. finally frequently needed inter-reader variability level structural information time series utilization local global information. moreover used represent streaming data time series different lengths incrementally constructed. bag-of-words model originally developed document representation. basic idea deﬁne codebook contains codewords represent document histogram codewords entry count codeword occurred document. although order information words ignored bag-of-words model still effective capture document information frequency information codewords documents well explored. recently bag-of-words model extended analyze images videos computer vision local patches extracted images videos treated words codebook constructed clustering local patches training data. similar extension bagof-words representation computer vision extend bag-of-words representation characterize biomedical time series regarding local segments extracted time series words treat time series documents. main contribution paper twofold simple effective bag-of-words representation proposed analysis biomedical time series; series experiments conducted investigate effectiveness robustness bag-of-words representation classiﬁcation biomedical time series. structure paper organized follows. section proposed method including bag-of-words representation distance measures classiﬁcation method described. section describes biomedical time series datasets used experiments. experimental results reported analyzed section discussion conclusion given section section respectively. section describe bag-of-words representation biomedical time series classiﬁcation. bag-of-words representation ignores temporal order local segments within time series represents time series histogram codewords i.e. local segments. several distance measures introduced histograms comparison. bag-of-words representation time series treated text document local segments extracted time series words. general ﬂowchart proposed method demonstrated fig. firstly continuously slide window pre-deﬁned length along time series extract group local segments. then extract feature vector local segments using dwt. next similar bag-of-visual-words model images videos analysis local segments training time series clustered k-means clustering create codebook cluster centers treated codewords. then local segment assigned codeword minimum distance local segment time series represented histogram codewords. finally bag-of-words representation used input classiﬁcation. procedure generating bag-of-words representation illustrated fig. continuously slide window pre-deﬁned length along time series extract group local segments time series. feature vector extracted local segments using characterize local segment. local segments training data clustered construct codebook contains codewords i.e. cluster centers. then local segment assigned codeword minimum distance local segment. bag-ofwords representation ignores order local segments time series represent time series histogram codewords. fig. procedure generating bag-of-words representation. codebook constructed clustering local segments training data. circle triangular square hexagon stand basis elements i.e. codewords codebook. local segment assigned codeword histogram representation extracted time series histogram codewords time series. ﬁgure best viewed color. generally created performing clustering group local patches training data i.e. codewords deﬁned clustering centers. codeword nearest local patch assigned local patch. spatial temporal order information local patches ignored image video represented histogram codewords image video. classical k-means clustering algorithm commonly used construct codebook although unsupervised supervised methods also developed mean-sift supervised gaussian mixture models similar codebook construction image video analysis cluster local segments training time series using k-means clustering construct codebook. clustering centers estimated k-means clustering regarded basis elements codebook i.e. codewords. suppose group local segments extracted taring time series codebook construction k-means clustering formulized optimization problem local segments extraction group local segments extracted time series continuously sliding window pre-deﬁned length along time series. local segments different time series different scales local segments normalized zero mean standard deviation. transform local segments wavelet domain approximations wavelet coefﬁcients feature vector represent local segment. wavelet transform analyzes signal different frequency bands provides accurate frequency information frequencies time information high frequencies important biomedical signal analysis. choice wavelet function number decomposition levels importance multiresolution decomposition. work single level order daubechies wavelet function employed decompose local segment approximations coefﬁcients detailed coefﬁcients. similar work used approximation coefﬁcients feature vector represent local segment. directly value local segments feature vectors fact features using approximations coefﬁcients robust noise features using segments also nearly half dimension local segments. codebook formulation text document analysis codebook pre-deﬁned words also called codewords. bag-of-words method counts number codeword exists document provides document-level representation using histogram codewords. image video analysis codebook codebook size importance bag-of-words representation. compact codebook entries limited discriminative ability large codebook likely introduce noise sparsity codewords histogram. therefore size codebook well balance trade-off discrimination noise. codewords assignment codebook constructed local segment assigned codeword minimum distance local segment. speciﬁcally suppose codebook entries learned training data. local segment assigned codeword that minj euclidean distance function. temporal order local segments ignored time series represented histogram codewords time series entry speciﬁes count codeword occurred time series. fig. illustrates bag-of-words representation example time series. ﬁgure ﬁrst example time series. three ﬁgures second fourth rows three local segments length extracted time series three ﬁgures second fourth rows corresponding codewords assigned local segments codebook consists codewords. three local segments assigned codewords respectively. ﬁgure last bagof-words representation time series entry gives count codeword occurred time series. discriminative classiﬁers artiﬁcial neural networks support vector machine probabilistic neural networks widely used biomedical signal classiﬁcation. since goal paper investigate effectiveness bag-ofwords representation simplest classiﬁer i.e. -nearest neighbor classiﬁer. test time series represents time series category. test data determined class training sample minimal distance test data i.e. mini similarity measure deﬁned following. many similarity measures proposed histograms comparison. following describe four commonly used similarity measures distance measurement bag-of-words representations. chi-squared distance euclidean distance subtracts histograms bin-by-bin contributes pairs equally distance. problem words however occur frequently documents; therefore contribute distance euclidean distance measure. actually less study three datasets constructed signals used evaluate performance bag-ofwords representation. ﬁrst dataset collected signals widely used automatic epileptic seizure detection. datasets extracted long signals collected different subjects random start points. long signals corresponds class i.e. subjects’ identity. order demonstrate bag-of-words representation time series different lengths third dataset extracted different lengths ﬁrst datasets length respectively. worth noting although extracted time series class obtained long signal exist substantial inter-class variations. signal classiﬁcation experiment attribute instance i.e. extracted time series subjects’ identity used human identiﬁcation signals real application task difﬁcult comparing features extracted based heartbeat waveforms ﬁducial points instance cross-correlation among complexes. however bagof-words representation need detect localize heartbeat waveforms ﬁducial points always required previous works dataset described used experiments. complete dataset consists classes contains singlechannel sequences length signals recorded -channel ampliﬁer system visual inspected artifacts. collected surface recordings healthy subjects open closed respectively. three sets taken intracranial recording patients suffered epileptic. taken epileptogenic zone hippocampal formation opposite hemisphere brain respectively. recorded seizure-free intervals whereas contains seizure activity. fig. shows example time series classes. small value avoid dividing zero. distance introduces normalization emphasis rarely happened codewords common words always shared documents different categories. jensen-shannon distance entry bag-ofwords represents interpreted frequency codeword occurred time series. therefore histogram stands probabilistic distribution discrete random variables. simple measure compare distribution kullback-leibler divergence histogram intersection based distance histogram intersection counts total overlap histograms able address problem partial matches histograms different bins. distance based histogram intersection deﬁned large number local segments extracted training data especially large datasets. clustering large number local segments construct codebook computationally expensive. practice instead using local segments extracted training data performing k-means clustering subset local segments randomly selected training data construct codebook. strategy also employed image video analysis reduce computation codebook construction continuously slide window along time series extract local segments. however time series contains many data points large number local segments extracted time series requires expensive computation. instance time series consisting data points local segments extracted using window length. practice slide window step data points along time series reduce number local segments extracted time series. varied length local segments experiments. determination parameter ranges relies fact biomedical time series signals relatively ﬂat. classiﬁcation accuracies ecg- ecg- datasets codebook size using chi-squared distance illustrated fig. fig. fig. respectively. experimental results seen performance relatively stable respect length local segments classiﬁcation accuracies decrease considerably length less mainly fact local segment short long length capture local structure information within time series. following experiments empirically length local segments show performance bag-of-words representation respect size codebook report classiﬁcation accuracies three datasets fig. increasing size codebook results become stable size codebook larger classiﬁcation accuracies reduce quickly size codebook less conﬁrms compact codebook entries limited discriminative ability. optimal size codebook roughly identiﬁed compared classiﬁcation performance three datasets using four similarity measures described section ii-c. fig. demonstrates classiﬁcation accuracies based four distance measures codebook size results slightly different using various distance measures indicating distance measures limited impact performance bag-of-words representation. overall chi-squared distance measure performs slightly better measures four sizes codebook. compared performance proposed bag-ofwords representation representation representation classiﬁer based distance addition also compared proposed bag-of-words representation bag-of-patterns representation similar proposed approach. twenty healthy subjects. forty long signals collected forty subjects monitored hours sampling rate signals contain data points long. extracted ﬁfty time series length forty long signals random start points. totally dataset contains time series length evenly distributed forty classes. ecg- dataset consists time series extracted ﬁfteen long signals bidmc congestive heart failure database ﬁfteen long signals recorded ﬁfteen patients suffered severe congestive heart failure. hundred time series length extracted ﬁfteen long signals random start points. totally ecg- dataset consists ﬁfteen classes time series length section report experimental results three datasets. firstly investigated impact parameters varying length local segments size codebook based different distance measures. then compared proposed method discrete wavelet transform representation discrete fourier transform representation classiﬁer based dynamic time warping distance bag-of-patterns representation addition compared classiﬁcation accuracies achieved proposed method achieved state-of-the-art methods dataset. finally investigated robustness bag-ofwords representation noise. order ensure un-biased evaluation dataset randomly partitioned subsets. subsets used training remaining series. similar based feature used used daubechies wavelet decomposed time series levels. detail wavelet coefﬁcients four levels approximation wavelet coefﬁcients fourth level concatenated form ﬁnal representation. widely used transformation technique extract frequency information time series. transformed original time series frequency domain extracted coefﬁcients features. line length feature based dwt+artiﬁcial neural networks line length feature based dwt+artiﬁcial neural networks line length feature based dwt+artiﬁcial neural networks data+support vector machine data+probabilistic neural network data+mlpnn lyapunov exponents+support vector machine lyapunov exponents+probabilistic neural network lyapunov exponents+mlpnn deal temporal drift time series. distance matrix pair test time series training time series calculated based unconstrained dtw. distance matrix used input classiﬁer. representation represents time series histogram local patterns similar proposed bag-of-words representation. size alphabet number symbols empirically respectively. varied length local segments bag-of-patterns representation step best accuracy reported comparison. since time series ecg- datasets different lengths resized time series length using bilinear interpolation based features dimension. calculating distance reduced time series three datasets length downsampling rate computationally expensive. table summarizes best results achieved proposed approach methods. seen proposed approach achieves highest accuracies illustrate effectiveness bag-of-words representation. representation obtains comparable accuracies ecg- ecg- datasets bag-of-words representation. however proposed bag-of-words representation performs signiﬁcantly better representation dataset. feature distance methods outperform based method. probably better deal temporal sift sequences dwt. dataset used experiment popular dataset automatic epileptic seizure classiﬁcation localization. table provides comparison classiﬁcation accuracies proposed bag-of-words method previous state-of-the-art approaches literature. noticed comparison direct since method classify time series sequence level methods classify segments extracted time series. works used several subsets whole dataset construct -class dataset others used whole dataset classes. -class classiﬁcation bag-of-words method outperforms methods. -class classiﬁcation whole dataset used classiﬁcation accuracies support vector machine probabilistic neural network multilayer perception neural network data respectively. features extracted lyapunov exponents used corresponding accuracies increase respectively. result obtained proposed representation simplest classiﬁer slightly lower achieved features based lyapunov exponents. however slightly higher result obtained mlpnn features based lyapunov exponents. experiment designed investigate robustness bag-of-words representation noise. signals ecg- ecg- datasets corrupted zero mean white gaussian noise. standard deviation white gaussian noise varied snrs training data test data separated exactly previous experiments. table summaries classiﬁcation accuracies three datasets contaminated white gaussian noise different snrs. seen bag-ofwords approach relatively robust noise. accuracies decreased less percents even considerable noise contamination accuracies reduced less percents ecg- datasets less percents ecg- dataset. although bag-of-words representation ignores temporal order local segments able effectively capture high-level structural frequency codewords occurred time series well utilized. however since local segments extracted sliding window along time series time series reasonably long cannot provide enough local segments capture local structures time series. therefore bag-of-words representation ineffective represent short time series mainly limitation bag-of-words representation cannot extract enough meaningful discriminative local segments short sequences. size codebook pre-deﬁned empirically determined method. compact codebook small size limited discriminative ability codebook large size likely introduce noise. adaptively optimal size codebook make codebook compact discriminative still open question. criteria deﬁned merge entries codebook construct adaptive codebook. instance method utilized maximization mutual information principal estimate optimal entries codebook merged maximizing mutual information unsupervised way. creating codebook adaptive size investigated future work. paper proposed bag-of-words representation biomedical time series analysis. proposed method treats time series document local segments extracted time series words. time series represented histogram codewords. although temporal order information local segments ignored local structure global structure information time series captured. experimental results three publicly available datasets demonstrate bag-of-words representation effective characterizing biomedical time series signals. furthermore bag-of-words representation insensitive length local segments size codebook also robust noise. distance measures comparison histograms also investigated experiments showing chi-squared distance measure suitable comparing histograms distance measures. compared performance bag-of-words representation several state-of-the-art approaches literature. experimental results show bag-of-words representation simplest -nearest neighbor classiﬁer achieves comparable higher classiﬁcation accuracies others. rivero dorado rabual pazos automatic epileptic seizure detection eegs based line length feature artiﬁcial neural networks neurosci meth. vol. h.-l. guan plataniotis venetsanopoulos regularized common spatial pattern aggregation classiﬁcation small-sample setting ieee trans. biomed. eng. vol. dec. y.-p. c.-h. wang t.-p. jung t.-l. s.-k. jeng j.-r. duann j.-h. chen eeg-based emotion recognition music listening ieee trans. biomed. eng. vol. july ince kiranyaz gabbouj generic robust system automated patient-speciﬁc classiﬁcation signals ieee trans. biomed. eng. vol. khade rotation-invariant similarity time series using bag-of-patterns representation intell. inf. syst lebanon dillon locally weighted words framework document representation mach. learn. res. vol. december andrzejak lehnertz mormann rieke david elger indications nonlinear deterministic ﬁnite-dimensional structures time series brain electrical activity dependence recording region brain state. phys. rev. vol. dec. goldberger amaral glass hausdorff ch.ivanov mark mietus moody c.-k. peng stanley physiobank physiotoolkit physionet components research resource complex physiologic signals circulation vol. ping bachelor degree wuhan university technology master degree huazhong university science technology studying university south carolina american. generally interest includes computer vision pattern recognition machine learning. mary f.h.she received b.sc. m.sc. degrees engineering donghua university shanghai china ph.d deakin university victoria australia. awarded australian postdoctorial fellowship australian research council currently research fellow center intelligent system research institute frontier material deakin university. major research interest includes image processing intelligent wearable systems. saeid nahavandi received b.sc. m.sc. ph.d. degrees automation control durham university durham u.k. alfred deakin professor chair engineering director center intelligent systems research deakin university geelong australia. research interests include modeling complex systems simulation-based optimization robotics haptics augmented reality. nahavandi associate editor ieee systems journal editorial consultant board member international journal advanced robotic systems editor international journal intelligent automation soft computing. fellow engineers australia senior member ieee wang received m.s. pattern recognition artiﬁcial intelligence huazhong university science technology china. currently pursuing ph.d. degree center intelligent system research institute frontier material deakin university australia. major research interests signal processing machine learning intelligent system including biomedical time series analysis automatic image video analysis intelligent wearable systems. abbas kouzani received m.eng. degree electrical electronics engineering university adelaide australia ph.d. degree electrical electronics engineering flinders university australia currently associate professor school engineering deakin university. involved several industry research grants publications. research interests include pattern recognition intelligent systems.", "year": 2012}