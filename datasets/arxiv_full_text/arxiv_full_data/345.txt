{"title": "Classification regions of deep neural networks", "tag": ["cs.CV", "cs.AI", "cs.LG", "stat.ML"], "abstract": "The goal of this paper is to analyze the geometric properties of deep neural network classifiers in the input space. We specifically study the topology of classification regions created by deep networks, as well as their associated decision boundary. Through a systematic empirical investigation, we show that state-of-the-art deep nets learn connected classification regions, and that the decision boundary in the vicinity of datapoints is flat along most directions. We further draw an essential connection between two seemingly unrelated properties of deep networks: their sensitivity to additive perturbations in the inputs, and the curvature of their decision boundary. The directions where the decision boundary is curved in fact remarkably characterize the directions to which the classifier is the most vulnerable. We finally leverage a fundamental asymmetry in the curvature of the decision boundary of deep nets, and propose a method to discriminate between original images, and images perturbed with small adversarial examples. We show the effectiveness of this purely geometric approach for detecting small adversarial perturbations in images, and for recovering the labels of perturbed images.", "text": "goal paper analyze geometric properties deep neural network classiﬁers input space. speciﬁcally study topology classiﬁcation regions created deep networks well associated decision boundary. systematic empirical investigation show state-of-the-art deep nets learn connected classiﬁcation regions decision boundary vicinity datapoints along directions. draw essential connection seemingly unrelated properties deep networks sensitivity additive perturbations inputs curvature decision boundary. directions decision boundary curved fact characterize directions classiﬁer vulnerable. ﬁnally leverage fundamental asymmetry curvature decision boundary deep nets propose method discriminate original images images perturbed small adversarial examples. show effectiveness purely geometric approach detecting small adversarial perturbations images recovering labels perturbed images. geometry classiﬁcation regions decision functions induced traditional classiﬁers fairly well understood fundamental geometric properties large extent unknown state-of-the-art deep neural networks. understand recent success deep neural networks potentially address weaknesses understanding geometric properties remains primordial. many fundamental properties deep networks recently studied optimization landscape generalization expressivity geometric properties decision boundary classiﬁcation regions deep networks comparatively received little attention. goal paper analyze properties leverage improve robustness classiﬁers perturbations. paper speciﬁcally view classiﬁcation regions topological spaces decision boundaries hypersurfaces examine geometric properties. ﬁrst study classiﬁcation regions induced state-of-the-art deep networks provide empirical evidence suggesting classiﬁcation regions connected; exists continuous path remains region points label. knowledge represents ﬁrst instance connectivity classiﬁcation regions empirically shown. then study complexity functions learned deep network analyze curvature decision boundary. empirically show directions curved decision boundaries shared different datapoints. demonstrate existence relation sensitivity classiﬁer perturbations inputs shared directions deep vulnerable perturbations along directions insensitive perturbations along remaining directions. ﬁnally leverage fundamental asymmetry deep networks revealed analysis propose algorithm detect natural images imperceptibly similar images small adversarial perturbations well estimate correct label perturbed samples. show purely geometric characterization adversarial examples effective recognize perturbed samples. related works. authors employ tools riemannian geometry study expressivity random deep neural networks. particular largest principal curvatures shown increase exponentially depth; decision boundaries hence become complex depth. provide paper complementary global analysis decision boundary curvature decision boundary along directions analyzed. authors show number linear regions deep networks grow exponentially number layers. note also unlike study geometry optimization function weight space focus ∗the ﬁrst authors contributed equally work. ‡ucla vision university california angeles †lts école polytechnique fédérale lausanne switzerland geometric properties input space. finally note graph-based techniques proposed analyze classiﬁcation regions shallow neural networks; focus generation deep neural networks shown remarkable performance. denote class classiﬁer. given datapoint estimated label obtained argmaxk component corresponds class. classiﬁer partitions space classiﬁcation regions constant label. neighboring class pairwise decision boundary classiﬁer deﬁned decision boundary deﬁnes hypersurface note point decision boundary gradient orthogonal tangent space paper interested studying decision boundary deep neural network vicinity natural images. given point deﬁne mapping given argminr∈rd subject corresponds smallest perturbation required misclassify image note corresponds geometrically vector minimal norm required reach decision boundary classiﬁer often dubbed adversarial perturbation noted that simple optimality conditions orthogonal decision boundary remainder paper goal analyze geometric properties classiﬁcation regions decision boundaries deep networks. particular study connectedness classiﬁcation regions sec. curvature decision boundaries sec. draw connection robustness classiﬁers. developed geometric insights propose method sec. detect artiﬁcially perturbed data points improve robustness classiﬁers. deep networks create shattered disconnected classiﬁcation regions contrary large connected region label deep neural networks exponential number linear regions input space remains unclear whether deep nets create connected region class shatters classiﬁcation region around large number small connected sets. formally cast problem connectivity classiﬁcation regions follows given data points continuous curve exist problem complex address theoretically; therefore propose heuristic method study question. classiﬁcation region. given points proposed approach attempts construct piecewise linear path remains classiﬁcation region. path represented ﬁnite anchor points convex path taken consecutive points. path algorithm ﬁrst attempts take convex path path entirely included classiﬁcation region path modiﬁed projecting midpoint onto target classiﬁcation region. procedure applied randomly sampled points validation estimated label randomly sampled point validation adversarially perturbed image consider image validation corresponds image classiﬁed differently however classiﬁed similarly targeted perturbation randomly sampled point validation perturbed random point. similar scenario random image note scenario visually correspond image class scenarios illustrated fig. scenario pairs points considered approach described used path. result stated follows fig. classiﬁcation regions illustration different paths images left convex path datapoints might entirely included classiﬁcation region image cross-section spanned right illustration nonconvex path remains classiﬁcation region. image obtained stitching cross-sections spanned fig. empirical probability convex combination samples classiﬁcation region stays classiﬁcation region networks trained imagenet. samples randomly chosen validation set. result suggests classiﬁcation regions created deep neural networks connected deep nets create single large regions containing points label. that path found using proposed path ﬁnding approach approximately corresponds straight path. illustration path images validation provided fig. interestingly endpoints randomly sampled images validation straight path endpoints overwhelmingly belong classiﬁcation region. however classiﬁcation regions convex bodies fig. illustrates estimated probability random convex combinations images belong observe convex combinations samples region likely belong region convex combinations samples usually belong region. experimental results therefore suggest deep neural networks create large connected classiﬁcation regions points region connected path. start basic deﬁnitions curvature. normal curvature along tangent direction deﬁned curvature planar curve resulting cross-section along two-dimensional normal plane spanning curvature along tangent vector expressed terms hessian matrix principal directions correspond orthogonal directions tangent space maximizing curvature speciﬁcally l-th principal direction obtained maximizing constraint vl−. alternatively principal curvatures correspond nonzero eigenvalues matrix projection operator tangent space; i.e. analyze curvature decision boundary deep neural networks vicinity natural images. consider lenet architectures trained cifar- task show principal curvatures decision boundary vicinity randomly chosen images validation set. speciﬁcally given image perturbed sample corresponds closest point decision boundary. compute principal curvatures point average proﬁle principal curvatures illustrated fig. observe that networks large majority principal curvatures approximately zero along principal directions decision boundary almost ﬂat. along remaining principal directions decision boundary positive negative curvature. interestingly principal curvature proﬁle asymmetric towards negatively curved directions. property speciﬁc considered datapoints considered networks even problem hand fact bias towards negatively curved directions repeatable across wide range networks datasets. next section leverage characteristic asymmetry decision boundaries deep neural networks order detect adversarial examples clean examples. normal section decision boundary along plane spanned normal vector fig. principal curvatures lenet networks computed point decision boundary vicinity natural image. local analysis shows existence directions along decision boundary curved examine whether directions shared across different datapoints relate directions robustness deep nets. estimate shared common curved directions compute largest principal directions randomly chosen batch training samples merge directions matrix estimate common curved directions largest singular vectors denote assess whether decision boundary curved directions evaluate curvature decision boundary directions points vicinity unseen samples validation set. validation compute measures relatively curved decision boundary direction compared random directions sampled fig. shows average points decision boundary vicinity unseen natural images lenet architecture cifar-. note directions lead universally curved directions across unseen points. decision boundary highly curved along data-independent directions. note that despite using relatively small number samples compute shared directions generalize well unseen points. illustrate fig. directions along decision boundary universally curved vicinity natural images; interestingly ﬁrst principal directions localized gabor-like ﬁlters. discriminative training deep neural network implicitly learned curve decision boundary along directions preserve decision boundary along orthogonal subspace. interestingly data-independent directions also tightly connected invariance classiﬁer perturbations. elucidate relation construct subspace span contains ﬁrst shared curved directions. then show fig. accuracy cifar- lenet model observed deep network noisy validation noise either belongs much robust noise orthogonal noise hence also represents subspace perturbations support classiﬁer highly vulnerable classiﬁer learned invariant perturbations claim report table norm projection adversarial perturbations subspace compare projection random noise onto note networks study adversarial perturbations project well onto subspace comparatively random perturbations signiﬁcant component contrast note perturbations obtained taking difference random images belong overwhelmingly agrees observation drawn sec. whereby straight paths likely belong classiﬁcation region. finally note gradient image also important component robustness directions fundamental achieve invariance small geometric deformations. importance shared directions {ui} decision boundary curved hence goes beyond curvature section leverage asymmetry principal curvatures propose method distinguish original images images perturbed adversarial examples well improve robustness classiﬁers. element decision boundary denote average principal curvatures. points sampled vicinity natural images proﬁle principal curvature asymmetric leading negative average curvature; i.e. contrast perturbed adversarial example instead average curvature vicinity xpert instead positive schematically illustrated fig. table supports observation empirically adversarial examples computed method note networks asymmetry principal curvatures allows distinguish accurately original samples perturbed samples using sign curvature. based simple idea derive algorithm detecting adversarial perturbations. denote principal directions. therefore follows average curvature efﬁciently estimated using sample estimate detecting perturbed samples practical approximate assuming sufﬁciently close decision boundary. approximation avoids computation closest point decision boundary provide details algorithm note that order extend approach multiclass classiﬁcation empirical average taken decision boundaries respect classes. moreover used threshold fact ﬁrst order taylor approximation translated image τ∇xx τ∇yx. achieve robustness translations deep fig. true positives false positives left results reported googlenet caffenet vgg- architectures perturbations computed using approach right results reported googlenet perturbations scaled constant factor detect adversarial examples original data explanation threshold parameter used practice finally noted addition detecting whether image perturbed algorithm also provides estimate original label perturbed sample detected test proposed approach different networks trained imagenet adversarial examples computed using approach latter approach used provides small difﬁcult detect adversarial examples mentioned fig. shows accuracy detection algorithm original images respect detection error perturbed images varying values threshold three networks test approach achieves accurate detection adversarial examples note ﬁrst success strategy conﬁrms asymmetry curvature decision boundary complex setting large-scale networks trained imagenet. moreover simple curvature-based detection strategy outperforms detection approach recently proposed addition unlike approaches detecting perturbed samples approach uses characteristic geometry decision boundary deep neural networks involve training/ﬁne-tuning perturbed samples commonly done. proposed approach distinguishes original perturbed samples also provides estimate correct label case perturbed sample detected. algorithm correctly recovers labels perturbed samples accuracy respectively googlenet caffenet vgg- shows proposed approach effectively used denoise perturbed samples addition detection. finally report fig. reports similar graph fig. googlenet architecture perturbations multiplied factor note that increases accuracy detection using method decreases heavily relies local geometric properties classiﬁer interestingly enough report regime perturbations small hardest detect; therefore foresee geometric approach used along detection approaches provides accurate detection distinct regime traditional detectors work well analyzed paper geometry induced deep neural network classiﬁers input space. speciﬁcally provided empirical evidence showing classiﬁcation regions connected. next analyze complexity functions learned deep networks provided comprehensive empirical analysis curvature decision boundaries. showed particular that vicinity natural images decision boundaries learned deep networks along directions curved directions shared across datapoints. ﬁnally leveraged fundamental observation asymmetry curvature deep nets proposed algorithm detecting adversarially perturbed samples original samples. geometric approach shown effective perturbations sufﬁciently small recovering label possible using algorithm. shows study geometry state-of-the-art deep networks analysis perspective also lead classiﬁers better properties. acknowledgments gratefully acknowledge support nvidia corporation donation titan pascal used research. work partly supported hasler foundation switzerland framework robert project. supported swiss national science foundation grant pelp-. s.s. supported n--- wnf---. hardt recht singer train faster generalize better stability stochastic gradient descent arxiv preprint arxiv. delalleau bengio shallow deep sum-product networks advances neural information processing systems cohen shashua convolutional rectiﬁer networks generalized tensor decompositions international conference machine learning dinh pascanu bengio bengio sharp minima generalize deep nets arxiv preprint arxiv. melnik pollack using graphs analyze high-dimensional classiﬁers neural networks ijcnn proceedings ieee-inns aupetit high-dimensional labeled data analysis gabriel graphs. esann shelhamer donahue karayev long girshick guadarrama darrell caffe convolutional architecture fast feature manifolds differential geometry vol. american mathematical society providence chen network network international conference learning representations s.-m. moosavi-dezfooli fawzi frossard deepfool simple accurate method fool deep neural networks ieee conference metzen genewein fischer bischoff detecting adversarial perturbations arxiv preprint arxiv. issaranon forsyth safetynet detecting rejecting adversarial examples robustly arxiv preprint arxiv.", "year": 2017}