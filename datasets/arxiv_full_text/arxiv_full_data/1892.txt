{"title": "Resolving Language and Vision Ambiguities Together: Joint Segmentation &  Prepositional Attachment Resolution in Captioned Scenes", "tag": ["cs.CV", "cs.CL", "cs.LG"], "abstract": "We present an approach to simultaneously perform semantic segmentation and prepositional phrase attachment resolution for captioned images. Some ambiguities in language cannot be resolved without simultaneously reasoning about an associated image. If we consider the sentence \"I shot an elephant in my pajamas\", looking at language alone (and not using common sense), it is unclear if it is the person or the elephant wearing the pajamas or both. Our approach produces a diverse set of plausible hypotheses for both semantic segmentation and prepositional phrase attachment resolution that are then jointly reranked to select the most consistent pair. We show that our semantic segmentation and prepositional phrase attachment resolution modules have complementary strengths, and that joint reasoning produces more accurate results than any module operating in isolation. Multiple hypotheses are also shown to be crucial to improved multiple-module reasoning. Our vision and language approach significantly outperforms the Stanford Parser (De Marneffe et al., 2006) by 17.91% (28.69% relative) and 12.83% (25.28% relative) in two different experiments. We also make small improvements over DeepLab-CRF (Chen et al., 2015).", "text": "figure overview approach. propose model simultaneous semantic segmentation prepositional phrase attachment resolution reasoning sentence parses. language vision modules produce diverse hypotheses goal select pair consistent hypotheses. example ambiguity resolved image caption whether standing next couch. modules beneﬁt selecting pair compatible hypotheses. sentence algorithms must operate under tremendous levels ambiguity. human reads sentence sushi tuna clear preposition phrase with tuna modiﬁes sushi eating ambiguous machine. problem determining whether prepositional phrase modiﬁes noun phrase verb phrase formally known prepositional phrase attachment resolution consider captioned scene shown figpresent approach simultaneously perform semantic segmentation prepositional phrase attachment resolution captioned images. ambiguities language canresolved without simultaneously reasoning associated image. consider sentence shot elephant pajamas looking language alone unclear person elephant wearing pajamas both. approach produces diverse plausible hypotheses semantic segmentation prepositional phrase attachment resolution jointly reranked select consistent pair. show semantic segmentation prepositional phrase attachment resolution modules complementary strengths joint reasoning produces accurate results module operating isolation. multiple hypotheses also shown crucial improved multiple-module reasoning. vision language approach signiﬁcantly outperforms stanford parser different experiments. also make small improvements deeplab-crf caption standing next woman couch exhibits attachment ambiguity couch next clear access image segmentations help resolve ambiguity access correct attachment help image segmentation. main roadblocks keep writing single uniﬁed model perform tasks inaccurate models empirical studies repeatedly found models often inaccurate miscalibrated most-likely beliefs placed solutions ground-truth. search space explosion jointly reasoning multiple modalities difﬁcult combinatorial explosion search space main thesis diverse plausible hypotheses serve concise interpretable summary uncertainty vision language ‘modules’ form basis tractable joint reasoning given modules hypotheses each integrate beliefs across segmentation sentence parse modules pick best pair hypotheses? focus consistency correct hypotheses different modules correct consistent incorrect hypotheses incorrect incompatible ways. speciﬁcally develop mediator model scores pairs consistency searches pairs pick highest scoring one. demonstrate approach three datasets abstract-s pascal-s pascalcontext-s show vision+language approach signiﬁcantly outperforms stanford parser works intersection vision tend ‘pipeline’ systems vision tasks take -best inputs without trying improve performance vice-versa. instance fidler prepositions improve object segmentation scene classiﬁcation consider mostlikely parse sentence resolve ambiguities text. analogously yatskar investigate role object attribute action classiﬁcation annotations generating human-like descriptions. achieve impressive results generating descriptions assume perfect vision modules generate sentences. work uses current vision modules reason images provided captions simultaneously improve vision language modules. similar philosophy earlier work barnard johnson used images help disambiguate word senses recent work gella studied problem reasoning image verb attempt pick correct sense verb describes action depicted image. berzak resolve linguistic ambiguities sentences coupled videos represent different interpretations sentences. perhaps work closest kong leverage information rgbd image sentential description improve semantic parsing resolve ambiguities related coreference resolution sentences focus different kind ambiguity prepositional phrase attachment resolution. classiﬁcation parsing ambiguities coreference resolution considered discourse ambiguity attachment considered syntactic ambiguity visual madlibs image captioning work falls domain difference produce vision outputs. work also similarities works ‘spatial relation learning’ i.e. learning visual representation noun-preposition-noun triplets approach certainly utilize spatial relation classiﬁers available focus work different. goal improve semantic segmentation ppar jointly reranking segmentation-parsing solution pairs. approach implicitly learns spatial relationships prepositions simply emergent latent representations help reranker pick consistent pair solutions. order emphasize generality approach show approach compatible wide class implementations semantic segmentation ppar modules present approach modules abstracted black boxes satisfy general requirements minimal assumptions. section describe modules detail making concrete respective features details. multiple hypotheses. order useful hypotheses must provide accurate summary score landscape. thus hypotheses plausible mutually non-redundant approach applicable choice diverse hypothesis generators. experiments k-best algorithm huang chiang sentence parsing module divmbest algorithm semantic segmentation module. instantiate modules section describe diverse solution generation detail. show intergrate information segmentation ppar modules. recall focus consistency correct hypotheses different modules correct consistent incorrect hypotheses incorrect incompatible ways. thus goal search pair mutually consistent. mediator model. develop mediator model identiﬁes high-scoring hypotheses across modules agreement other. concretely express mediator model factor graph node corresponds module working factor graph typically completely intractable node exponentiallymany states illustrated figure factor-graph view hypothesis sets considered ‘delta-approximations’ reducing size output spaces. unary factors capture score/likelihood hypothesis provided corresponding module image/sentence hand. pairwise factors represent consistency factors. imporintuitively constraint tries maximize margin score oracle pair pairs hypothesis sets. importantly slack scaled loss tuple. thus good pairs much worse oracle margin tuples tightly enforced. hand margin oracle tuples strictly enforced. standard measure evaluating semantic segmentation average jaccard index evaluating sentence parses w.r.t. prepositional phrase attachment fraction prepositions correctly attached. experiments report results convex combination module loss functions tantly since restricted module variables states free capture arbitrary domain-speciﬁc high-order relationships consistency without optimization concerns. fact describe experiments consistency factors designed exploit domain knowledge fairly sophisticated ways. notice search space hypotheses experiments allow module take different value typically around solutions module leading mere pairs easily enumerable. found even small least solutions tends highly accurate meaning hypothesis sets relatively high recall. shows power using small diverse hypotheses. large exploit number standard ideas graphical models literature fact reason show factor figure natural decomposition problem modules. training mediator. express mediator score linear function score consistency features single-module score features inter-module consistency features. describe features detail experiments. learn consistency weights dataset annotated ground-truth modules denote oracle pair composed datasets. access rich annotated image caption datasets crucial performing quantitative evaluations. since ﬁrst paper study problem joint segmentation ppar standard datasets task exist curate annotations ppar three image caption datasets abstracts pascal-s captions image pascal-contexts annotations publicly available authors’ webpages. curate pascal-context-s ppar annotations ﬁrst select sentences preposition phrase attachment ambiguities. plotted distribution prepositions sentences. prepositions used large drop frequencies beyond these. prepositions with next front near down. sampled sentences ensure uniform distribution across prepositions. perform similar ﬁltering pascal-s abstract-s details appendix. consider preposition ambiguous least parsings objects preposition dependency across parsings object different summarize statistics three datasets abstract-s sentences images abstract scenes made clipart. filtering captions containing top- prepositions resulted sentences describing unique images. prepositions with ‘next front behind under. overall total prepositions ambiguous prepositions ambiguity rate sentences pascal-s sentences images uiuc pascal sentence dataset filtering top- prepositions resulted total unique images image-caption pairs groundtruth ppar carefully annotated vision graduate students. overall total prepositions ambiguous prepositions ambiguity rate sentences multiple ambiguous prepositions. images captions pascal-s pascal context segmentation annotations makes vision task challenging. filtering dataset top- prepositions resulted total unique images image-caption pairs. ground truth annotations ppar collected using amazon mechanical turk. workers shown image prepositional attachment phrase asked correct. screenshot interface available appendix. overall total prepositions ambiguous prepositions ambiguity rate sentences multiple ambiguous prepositions. setup. single module ﬁrst show visual features help ppar using abstract-s dataset contains clipart scenes extent position objects scene known. allows consider scenario perfect vision system. multiple modules recent version pcfg stanford parser module produce parsings sentence. addition parse trees module also output dependencies make syntactical relationships explicit. dependencies come form dependency type preposition dependency prep evaluate count percentage preposition attachments parse gets correct. experiments compare proposed approach highest scoring solution predicted independently module. semantic segmentation output deeplab-crf ppar module -best output stanford parser since hypothesis lists generated greedy m-best algorithms corresponds predicting tuple. comparison establishes importance joint reasoning. best knowledge existing joint model compare domain adaptation. learn reranker parses. note domain adaptation needed ppar since stanford parser trained penn treebank text images domain adaptation necessary semantic segmentation. competitive single-module baseline. speciﬁcally parse-based features approach learn reranker parse trees approach signiﬁcantly outperforms baselines. improvements indep show joint reasoning produces accurate results module operating isolation. improvements domain adaptation establish source improvements indeed vision reranking step. simply adapting parse original training domain domain enough. ablative study. ours-cascade ablation studies importance multiple hypothesis. module feed single-best output module input. module learns weight using exactly consistency features learning algorithm mediator predicts plausible hypotheses ycascade argmaxy∈y lation system similar helps disentangling beneﬁts multiple hypothesis joint reasoning. finally note ours-cascade viewed special cases mediator. mediator- denote approach hypotheses ﬁrst module second. indep corresponds mediator- cascade corresponds predicting solution mediator- solution mediator-. upper-bound approach report oracle accuracy accurate tuple tuples. mediator consistency features. recall types features score features capture likely solutions respectively consistency features capture consistent attachments segmentation compute features object object segmentations since humans writing captions multiple synonymous words visual entity wordvec similarities nouns sentences corresponding dataset categories. semantic segmentation score features ranks solution scores deeplab-crf ppar score features ranks probability parses binary indicators pascal denoting prepositions present parse. present segmentation distance features ratio areas features also assuming smaller object missing. case object connected components segmentation distances computed w.r.t. centroid segmentation area computed number pixels union instance segmentation masks. also calculate features pascal-s features pascal-context-s capture consistency terms presence/absence pascal categories. noun ppar compute wordvec similarity pascal categories. pascal categories feature similarities nouns category present segmentation times similarities nouns otherwise. feature used abstracts since features intended help improve accuracy semantic segmentation module. abstract-s distance features resulting feature vector. single-module results performed -fold cross-validation abstract-s dataset pick weight hinge-loss mediator results presented table approach signiﬁcantly outpeforms -best outputs stanford parser shows need diverse hypotheses reasoning visual features picking sentence parse. oracle denotes best achievable performance using hypotheses. figure example pascal-s ambiguity sentence couch next calculate horizontal vertical distances segmentation centers person couch segmentation centers couch. much further couch woman mediator model learned means ﬁrst object second object would expect choose person couch preposition parsing. feature euclidean distance center segmentation masks objects connected preposition. objects segmentation correspond categories soft similarity objects sentence highest among pascal categories. four features capture max{ directionaldistance measures above/below/left/right displacements objects segmentation normalization involves dividing height/width. table results subset pascal-s pascal-context-s datasets. able signiﬁcantly outperform stanford parser make small improvements deeplab-crf pascal-s. train folds fold test fold fold used pick figure shows average combined accuracy found maximal pascal-s pascal-context-s used test time. approach signiﬁcantly outperforms stanford parser pascal-s pascal-context-s. also make small improvements deeplabcrf case pascal-s. measure statistical signiﬁcance results performed paired t-tests mediator indep. modules null hypothesis successfully rejected p-value sake completeness also compared mediator ablated system found statistically signiﬁcant differences ppar. results demonstrate need module produce diverse plausible hypotheses mediator model reason about. case pascal-context-s mediator performs identical cascade since chosen crossvalidation. recall mediator larger model class cascade interesting large model class hurt mediator gracefully reduces smaller capacity model amount data enough warrant extra capacity. hypothesize presence training data crossvalidation pick different setting resulting full utilization model capacity. also note domain adaptation baseline achieved accuracy higher map/stanfordparser signiﬁcantly lower approach pascal-s pascal-context-s. also performed single-module experiment picked cross-validation resulted accuracy again higher map/stanford-parser signiﬁcantly lower approach clearly domain adaptation alone sufﬁcient. also oracle performance fairly high suggesting ambiguity room improvement mediator able rerank effectively. ablation study features. table displays results ablation study pascal-s pascal-context-s show importance different features. retain module score features drop single consistency features. consistency features contribute performance mediator. visualizing prepositions. figure shows visualization mediator model implicitly learned prepositions visualizations show score obtained taking product distance features object object connected preposition corresponding learned weights model considering object center visualization. notice learned without explicit training spatial learning spatial relation learning works simply recovered intermediate step towards reranking ppar hypotheses. also note cannot handle multiple segmentation hypotheses work shows important addition approach general. olution captions semantic segmentation images integrates beliefs across modules pick best pair diverse hypotheses. full model signiﬁcantly improves accuracy ppar stanford parser pascal-s pascal-context-s achieves small improvement semantic segmentation deeplab-crf pascal-s. results demonstrate need information exchange between modules well need diverse hypotheses concisely capture uncertainties module. large gains ppar validate intuition vision helpful dealing ambiguity language. furthermore even larger gains possible oracle accuracies. demonstrated approach task involving simultaneous reasoning language vision approach general used applications. overall hope approach useful number settings. acknowledgements. thank larry zitnick mohit bansal kevin gimpel devi parikh helpful discussions suggestions feedback included work. majority work done intern virginia tech. work partially supported national science foundation career award army research ofﬁce award ofﬁce naval research grant n--- donations nvidia awarded supported dtra basic research grant hdtra-- provided views conclusions contained herein authors interpreted necessarily representing ofﬁcial policies endorsements either expressed implied u.s. government sponsor. appendix additional motivation mediator model. appendix background abstract-s. appendix details dataset curation process abstract-s pascals pascal-context-s datasets. appendix results study effect varying weighting module approach. appendix performances gains independent baseline pascal-contexts preposition. appendix qualitative examples approach. example providing additional motivation approach shown figure ambiguous sentence describes image standing next woman couch. ambiguity couch next reﬂected parse trees’ uncertainty. parse tree shows standing connected couch preposition whereas parse trees show woman connected couch preposition. ambiguity resolved look accurate semantic segmentation hypothesis associated image likewise might able better semantic segmentation choose segmentation consistent sentence segmentation hypothesis contains person couch next them unlike hypotheses abstract scenes dataset contains synthetic images generated human subjects drag-and-drop clipart interface. subjects given access subset clipart objects found park scenes well characters mike jenny variety poses expressions. example scenes found figure motivation allow researchers focus higher-level semantic understanding without deal noisy information extraction real images since entire contents scene known exactly also providing dense semantic space study used dataset precisely ﬁrst test ppar module isolation demonstrate problem helped sentence’s corresponding image. subsets pascal-s abstracts datasets used experiments carefully curated vision graduate students. subset pascal-context-s dataset curated amazon mechanical turk workers. following describes dataset curation process datset. pascal-s pascal-s ﬁrst obtained sentences contain prepositions intuitively would typically depend relative distance between objects. look sentences preposition phrase attachment ambiguities i.e. sentences parser output different sets prepositions different parsings. focus attachment attention parts sentence parse parses figure ﬁgure illustrate mediator model makes sense task captioned scene understanding. caption-image pair parse tree shows standing connected couch preposition whereas parse trees show woman connected couch preposition. ambiguity resolved look accurate semantic segmentation hypothesis associated image likewise might able better semantic segmentation choose segmentation consistent sentence segmentation hypothesis contains person couch next them unlike hypotheses change attachments remain same figure figure sentences thus obtained ﬁltered obtain sentences objects connected preposition belonging pascal object categories. since vision module semantic segmentation instance-level segmentation restrict dataset sentences involving prepositions connecting different pascal categories. thus ﬁnal dataset contains sentences describing unique images contains pascal categories described paper. manually annotated ground truth attachments. manual labeling student annotators expertise takes time results annotations linguistically highquality inter-human disagreement resolved strict adherence rules grammar. with next front behind under). semantic differences between datasets prepositions found present other. ﬁltering sentences done ensure sentences contain least preposition phrase attachment ambiguity clipart noun categories ﬁltering reduced original dataset sentences scenes ﬁnal experiment dataset sentences scenes. manually annotated ground truth attachments. pascal-context-s pascal-contexts ﬁrst selected sentences preposition phrase attachment ambiguities. plotted distribution prepositions sentences found drop percentage sentences prepositions appear sorted list down. therefore kept sentences visual prepositions list prepositions down. thus ended following prepositions with next front near down. sampled sentences ensure uniform distribution across prepositions. unlike pascal-s ﬁlter sentences based whether objects connected prepositions belong pascal context categories not. instead used wordvec similarity objects sentence pascal context categories features. thus ﬁnal dataset contains sentences describing unique images. ground truth attachments sentences annotated workers. unique prepositional relation sentence showed workers prepositional relation form primary object preposition secondary object associated image sentence asked specify whether prepositional relation correct correct. also asked choose third option primary object/ secondary object noun caption case happened. user interface used collect annotations shown figure collected answers prepositional relation. evaluation used majority response. found hufigure show percentage ambiguous sentences pascal-context-s dataset ﬁltering prepositions. found drop percentage sentences prepositions appear sorted list down. pascal-contexts dataset keep sentences visual prepositions list prepositions down. used natural setting gives equal weight modules. note parameter approach; design choice user/experiment-designer makes. effect weighting modules differently tested approach various values figure shows accuracies module vary depending mediator model pascal-s pascal-context-s. recall coefﬁcient semantic segmentation module coefﬁcient ppar resolution module loss function. expected putting little weight ppar module drastically hurts performance module. approach fairly robust setting peak lying weight performs fairly similar peak lying somewhere extremes. segmentation module similar behavior though sensitive choice believe small dynamic range module between -best oracle segmentation smaller figure interface collect ground truth annotations prepositional relations. five answers collected prepositional relation. majority response used evaluation. workers asked select preposition correct correct primary secondary object noun caption. examples three answer choices shown instructions presented workers. figure figure show qualitative examples experiments. figure figure show examples multiple modules examples figure figure show examples single module experiment. ﬁgure shows image associated sentence. multiple modules ﬁgures second third show diverse segmentations image bottom rows show different parsings sentence examples approach uses diverse solutions semantic segmentation module different solutions ppar module. highlighted pairs solutions show solutions picked mediator model. examining results give sense parsings help semantic segmentation module pick best solution viceversa. figure accuracies mediator coefﬁcient semantic segmentation module coefﬁcient ppar resolution module loss function. approach fairly robust setting long either extremes since limits synergy modules. shows results pascal-s shows results pascal-context-s.", "year": 2016}