{"title": "Learning Cost-Effective Treatment Regimes using Markov Decision  Processes", "tag": ["cs.AI", "cs.LG", "stat.ML"], "abstract": "Decision makers, such as doctors and judges, make crucial decisions such as recommending treatments to patients, and granting bails to defendants on a daily basis. Such decisions typically involve weighting the potential benefits of taking an action against the costs involved. In this work, we aim to automate this task of learning \\emph{cost-effective, interpretable and actionable treatment regimes}. We formulate this as a problem of learning a decision list -- a sequence of if-then-else rules -- which maps characteristics of subjects (eg., diagnostic test results of patients) to treatments. We propose a novel objective to construct a decision list which maximizes outcomes for the population, and minimizes overall costs. We model the problem of learning such a list as a Markov Decision Process (MDP) and employ a variant of the Upper Confidence Bound for Trees (UCT) strategy which leverages customized checks for pruning the search space effectively. Experimental results on real world observational data capturing judicial bail decisions and treatment recommendations for asthma patients demonstrate the effectiveness of our approach.", "text": "decision makers doctors judges make crucial decisions recommending treatments patients granting bails defendants daily basis. decisions typically involve weighting potential beneﬁts taking action costs involved. work automate task learning cost-effective interpretable actionable treatment regimes. formulate problem learning decision list sequence if-then-else rules maps characteristics subjects treatments. propose novel objective construct decision list maximizes outcomes population minimizes overall costs. model problem learning list markov decision process employ variant upper conﬁdence bound trees strategy leverages customized checks pruning search space effectively. experimental results real world observational data capturing judicial bail decisions treatment recommendations asthma patients demonstrate effectiveness approach. medical judicial decisions complex involve careful assessment subject’s condition analyzing costs associated possible actions nature consequent outcomes. further might costs associated assessment subject’s condition instance doctor ﬁrst figure regime treatment recommendations asthma patients output framework; refers milder forms treatment used quick-relief corresponds intense treatments controller drugs attributes blue least expensive. diagnoses patient’s condition studying patient’s medical history ordering relevant tests crucial diagnosis. also factors physical mental monetary costs incurred tests. based test results carefully deliberates various treatment options analyzes potential side-effects well effectiveness options. analogously judge deciding defendant granted bail studies criminal records defendant enquires additional information needed. recommends course action trades risk granting bail defendant cost denying bail practical situations human decision makers often leverage personal experience make decisions without considering data even massive amounts exist problem hand. exist domains machine learning models could potentially help would need consider three aspects discussed above predictions counterfactuals costs gathering information costs treatments. further models must interpretable order create reasonable chance human decision maker actually using them. work address problem learning cost-effective interpretable prior research addresses various aspects problem hand isolation. instance exists large body literature estimating treatment effects recommending optimal treatments learning intelligible models prediction however effective solution problem hand ideally incorporate aforementioned aspects. furthermore existing solutions learning treatment regimes neither account costs associated gathering required information treatment costs. goal work propose framework jointly addresses aforementioned aspects. address problem hand formulating task learning decision list maps subject characteristics treatments maximizes expectation pre-speciﬁed outcome used assign treatments population interest minimizes costs associated assessing subjects’ conditions minimizes costs associated treatments themselves. choose decision lists express treatment regimes highly intelligible therefore readily employable decision makers. propose novel objective function learn decision list optimized respect criterion highlighted above. prove proposed objective np-hard reducing weighted exact cover problem. optimize objective modeling markov decision process employing variant upper conﬁdence bound trees strategy leverages customized checks pruning search space effectively. empirically evaluate proposed framework real world datasets judicial bail decisions treatment recommendations asthma patients. results demonstrate regimes output framework result improved outcomes compared state-of-the-art baselines much lower costs. further treatment regimes output approach less complex require fewer diagnostic checks determine optimal treatment. treatment regimes. problem learning treatment regimes extensively studied context medicine health care. along lines literature treatment regimes categorized regression-based methods policy-search-based methods. regression-based methods model conditional distribution outcomes given treatment characteristics patients choose treatment resulting best possible outcome individual. policy-search-based methods search policy within pre-speciﬁed class policies. policy chosen optimize expected outcome across population interest. examples estimators include marginal structural mean models outcome weighted learning robust marginal mean models aforementioned solutions produce regimes intelligible. none aforementioned approaches explicitly account treatment costs costs associated gathering information pertaining patient characteristics. work learning treatment regimes done context medicine ideas apply policies ﬁelds. best knowledge work ﬁrst attempt extending work treatment regimes judicial bail decisions. dynamic treatment regimes. recent research personalized medicine focused developing dynamic treatment regimes goal learn treatment regimes maximize outcomes patients given population recommending sequence appropriate treatments time based state patient. little attention paid interpretability literature none prior solutions problem consider treatment costs costs associated diagnosing patient’s condition. subgroup analysis. goal line research whether exist subgroups individuals given treatment exhibits heterogeneous effects treatment effect varies across them. problem well studied however identifying subgroups heterogeneous treatment effects readily provide regimes. interpretable models. large body machine learning literature focused developing interpretable models classiﬁcation clustering various classes models decision lists decision sets prototype based models generalized additive models proposed. classes models conceived model treatment effects. recent work leveraging decision lists describe estimated treatment regimes solutions account treatment costs costs involved gathering patient characteristics. also constructed using greedy methods causes issues quality models. trust therefore employ models interpretable transparent. thus employ decision lists express treatment regimes decision list ordered list rules embedded within ifthen-else structure. treatment regime expressed decision list sequence rules last default rule applies subjects satisfy previous rules. rule tuple form represents pattern conjunction predicates. predicate takes form {==≤≥ denotes value assumed characteristic instance gender=female example pattern. subject said satisfy rule his/her characteristics satisfy predicates formally denote using indicator function satisfy returns satisﬁes otherwise. rules partition dataset groups ···rlrdefault}. group comprised subjects satisfy satisfy c··· cj−. formally written treatment assigned subject determined group he/she belongs instance subject characteristics belongs group induced i.e. subject assigned corresponding treatment regime formally function deﬁned section takes input treatment returns cost. also deﬁne cost incurred assessing condition subject regime note subject belongs group subject satisfy conditions first formalize notion treatment regimes discuss represent decision lists. propose objective function constructing cost-effective treatment regimes. consider dataset comprised independent identically distributed observations corresponds subject potentially observational study. note characteristics subject denotes possible values assumed characteristic characteristic either binary categorical real valued variable. medical setting example characteristics include patient’s gender blood cell count glucose level etc. denote treatment assigned subject corresponding outcome respectively. assume deﬁned higher values indicate better outcomes. example outcome patient regarded wellness improvement score indicates effectiveness assigned treatment. much expensive determine certain subject characteristics compared others. instance patient’s easily retrieved either previous records asking patient. hand determining glucose level requires comprehensive testing therefore expensive terms monetary costs time effort required patient well clinicians. assume access function returns cost determining characteristic cost associated given characteristic assumed subjects population though framework extended patient-speciﬁc costs. analogously treatment incurs cost assume access function returns cost associated treatment discuss notion treatment regime formally introduce class models employ express regimes. treatment regime function takes input characteristics given subject maps appropriate treatment discussed prior studies suggest decision makers doctors judges make high stake decisions likely denotes probability subject charˆ acteristics assigned treatment data represents propensity score model. practice multinomial logistic regression model learn function. framework impose constraints functional form similarly denotes predicted outcome obtained result assigning subject characterized treatment corresponds outcome regression model learned experiments ﬁtting linear regression model prior optimizing treatment regimes. could modeled using method; entirely separate step algorithm discussed here. expected assessment cost recall assessment costs associated subject. costs governed characteristics used assessing subject’s condition recommending treatment. assessment cost subject treated using regime given eqn. expected assessment cost across entire population computed important ensure learning process favors regimes smaller values expected assessment cost. keeping cost also ensures full decision list sparse assists interpretability. expected treatment cost cost associated assigning treatment given subject. treatment cost subject assigned treatment using regime given eqn. expected treatment cost across entire population computed complete objective assume access following inputs observational data frequently occurring patterns recall pattern corresponds conjunction predicates. example pattern gender=female. practice patterns obtained running frequent pattern mining algorithm apriori possible treatments satisﬁes condition reach conclusion characteristics present corresponding antecedents must measured subject evaluated appropriate predicate conditions. implies assessment cost incurred subject costs characteristics appear denotes characteristics appear assessment cost subject regime written formulate objective function learning cost-effective treatment regime. ﬁrst formalize notions expected outcome assessment treatment costs treatment regime respect dataset expected outcome recall treatment regime assigns subject characteristics treatment quality regime partly determined expected outcome subjects assigned treatments according higher value expected outcome better quality regime however caveat computing value expected outcome observe outcome resulting assigning data counterfactuals. regime hand assigns different treatment cannot evaluate policy solutions proposed compute expected outcomes settings categorized adjustment regression modeling adjustment inverse propensity score weighting doubly robust estimation. detailed treatment approaches presented lunceford success regression based modeling inverse weighting depends heavily postulated regression model postulated propensity score model respectively. either case postulated models identical true models biased estimates expected outcome. hand doubly robust estimation combines approaches estimated value expected outcome unbiased long postulated models identical true model. doubly robust estimator expected outcome regime denoted written deﬁne possible tuples possible combinations element thought rule decision list element thought list rules decision list search elements regime maximizes expected outcome minimizing expected assessment treatment costs computed objective function formally written optimize objective modeling markov decision process employing upper conﬁdence bound trees algorithm treatment regime maximizes eqn. also propose leverage customized checks guiding exploration algorithm pruning search space effectively. markov decision process formulation goal sequence rules maximize objective function eqn. formulate fully observable optimal policy posited formulation provides solution objective function. fully observable characterized tuple denotes possible states denotes possible actions represent transition reward functions respectively. deﬁne context problem. figure shows snapshot state space transitions small dataset. state space. conceptually state state space captures effect partial fully constructed decision list. illustrate consider partial decision list rule gender female partial list induces that subjects satisfy condition rule assigned treatment gender characteristics required determining treatments subjects population. capture information represent state list tuples σ)··· tuple corresponds subject binary vector length deﬁned characteristic required determining subject treatment otherwise. further captures treatment assigned subject treatment assigned note single start state corresponds empty decision list. vector indicating treatments assigned subject characteristics deemed requirements assigning treatments. furthermore state regarded terminal state non-zero indicating treatments assigned subjects. actions. action take following forms rule tuple form speciﬁes subjects obey conditions pattern prescribed treatment. action leads nonterminal state. treatment corresponds default rule thus action leads terminal state. transition reward functions. deterministic transition function ensures taking action state always lead state denote subjects treatments already assigned state i.e. denote subjects assigned treatment state denote subjects belong satisfy condition action denote characteristics present condition action action corresponds default rule notation place state characterized follows here discuss detailed experimental evaluation framework. first analyze outcomes obtained costs incurred recommending treatments using approach. then present ablation study explores contributions terms objective followed analysis real data. dataset descriptions ﬁrst dataset consists information pertaining bail decisions defendants captures information various defendant characteristics demographic attributes past criminal history personal health related information defendants. further decisions made judges cases corresponding outcomes also available. assigned costs characteristics treatments based discussions subject matter experts. characteristics harder obtain assigned higher costs compared ones readily available. similarly treatment placed higher burden defendant assigned higher cost. assigning scores outcomes undesirable scenarios received lower scores. second dataset captures details asthma patients patients various attributes demographics symptoms past health history test results recorded. patient dataset prescribed either quick relief medications long term controller drugs. further outcomes form time next asthma attack recorded. longer interval better outcome higher outcome score. baselines compared framework following state-of-the-art treatment recommendation approaches outcome weighted learning modiﬁed covariate approach interpretable parsimonious treatment regime learning none approaches explicitly account treatment costs costs required gathering subject characteristics iptl minimize number characteristics/covariates required deciding treatment given subject. hand utilizes characteristics available data assigning treatments. customized pruning basic idea behind upper conﬁdence bound trees algorithm iteratively construct search tree predetermined number iterations. procedure best performing policy sequence actions returned output. node search tree corresponds state state space links tree correspond actions. employs metric navigating search space. employ uct-based algorithm ﬁnding optimal policy formulation though leverage customized checks guide exploration process prune search space. recall non-terminal state state space corresponds partial decision list. exploit fact upper-bound value objective given partial decision list. upper bound objective given non-terminal state computed approximating reward follows subjects assigned treatments best possible treatments without incurring treatment cost additional assessments required subject population. upper bound incremental reward thus execution procedure whenever choice made action needs taken employ checks based upper bound objective value resulting state. consider scenario procedure currently state needs choose action. possible action state determine upper bound objective value resulting state value less either highest value encountered previously complete rule list objective value corresponding best default action state block action state state provably suboptimal. experimental setting objective function proposed eqn. three parameters parameters could either speciﬁed end-user learned using validation set. aside datasets validation estimate parameters. automatically searched parameter space parameters produced decision list maximum average outcome validation satisﬁed simple constraints average assessment cost datasets average treatment cost bail data; average treatment cost asthma data. used coordinate ascent strategy search parameter space update parameter holding parameters constant. values parameters chosen binary search interval procedure approach iterations. used gaussian linear kernels employed tuning strategy discussed zhao case iptl parameter limits number rules treatment regime evaluated performance model baselines using fold cross validation. analyzed performance approach citr various aspects outcomes obtained costs incurred intelligibility. computed following metrics avg. outcome recall treatment regime assigns treatment every subject population. used prediction model obtain outcome score given characteristics subject treatment assigned computed average outcome score subjects population. avg. assess cost determined assessment costs incurred subject based characteristics used determine treatment. averaged per-subject assessment costs obtain average assessment cost. avg. characs determined number characteristics used assigning treatment subject population computed average numbers. avg. treat cost computed average treatment costs incurred subjects population. list approach citr baseline iptl express treatment regimes decision lists. order compare complexity resulting decision lists computed number rules lists. results table presents values metrics computed approach well baselines. seen treatment regimes produced approach results better average outcomes lower costs across datasets. iptl explicitly reduce costs minimize number characteristics required determining treatment given subject. approach produces regimes least cost given average number characteristics required determine treatment also interesting approach produces concise lists fewer rules compared baselines. treatment costs baselines similar variation average assessment costs outcomes. iptl turns best performing baseline terms average outcome average assessment costs average characteristics. last line table shows average outcomes average treatment costs computed empirically observational data. datasets comprised decisions made human experts. interesting regimes learned algorithmic approaches perform better human experts datasets. table results treatment regimes. approach citr; baselines iptl owl; ablations approach citr treat citr assess citr outcome; human refers setting judges doctors assigned treatments. also analyzed effect various terms objective function outcomes costs incurred. experimented three different ablations approach citr treat obtained excluding term corresponding expected treatment cost objective eqn. citr assess obtained excluding expected assessment cost term objective eqn. citr outcome obtained excluding assessment treatment cost terms objective. table shows values metrics discussed earlier section ablations model. naturally removing treatment cost term increases average treatment cost datasets. naturally removing assessment cost part objective results regimes much higher assessment costs length list also increases datasets exclude assessment cost term. results demonstrate term objective function crucial producing cost-effective interpretable regime. seen figure methacholine test expensive appears regime. ensures small fraction population burdened cost. furthermore turns though spirometry test slightly expensive compared patient demographics symptoms would harder determine treatment patient without test. aligns research asthma treatment recommendations furthermore interesting note regime accounts test results spirometry peak also assesses patient previous history asthma respiratory issues. test results positive patient previous history asthma respiratory disorders patient recommended quick relief drugs. hand test results positive patient suffered previous asthma respiratory issues controller drugs recommended. figure treatment regime bail data; refers milder form treatment release personal recognizance release condition comparatively harsher. case bail dataset constructed regime able achieve good outcomes without even using expensive characteristics mental illness tests drug tests. personal information characteristics slightly expensive defendant demographics prior criminal history appear towards list checks apply population. interesting regime uses defendant’s criminal history well personal demographic information make recommendations. instance females minor current charges prior criminal records typically released bail without conditions bonds checking police. hand defendants committed crimes earlier granted conditional bail. tional data. best knowledge ﬁrst solution problem hand addresses following aspects maximizing outcomes minimizing treatment costs costs associated gathering information required determine treatment expressing regimes using interpretable model. modeled problem learning treatment regime employed variant prunes search space using customized checks. demonstrated effectiveness framework real world data judiciary health care domains.", "year": 2016}