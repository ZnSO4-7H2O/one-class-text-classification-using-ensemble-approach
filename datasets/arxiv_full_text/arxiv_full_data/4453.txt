{"title": "Propagating Uncertainty in Multi-Stage Bayesian Convolutional Neural  Networks with Application to Pulmonary Nodule Detection", "tag": ["cs.CV", "stat.ML"], "abstract": "Motivated by the problem of computer-aided detection (CAD) of pulmonary nodules, we introduce methods to propagate and fuse uncertainty information in a multi-stage Bayesian convolutional neural network (CNN) architecture. The question we seek to answer is \"can we take advantage of the model uncertainty provided by one deep learning model to improve the performance of the subsequent deep learning models and ultimately of the overall performance in a multi-stage Bayesian deep learning architecture?\". Our experiments show that propagating uncertainty through the pipeline enables us to improve the overall performance in terms of both final prediction accuracy and model confidence.", "text": "motivated problem computer-aided detection pulmonary nodules introduce methods propagate fuse uncertainty information multi-stage bayesian convolutional neural network architecture. question seek answer take advantage model uncertainty provided deep learning model improve performance subsequent deep learning models ultimately overall performance multi-stage bayesian deep learning architecture?. experiments show propagating uncertainty pipeline enables improve overall performance terms ﬁnal prediction accuracy model conﬁdence. introduce techniques fusing model conﬁdence information pixel-level image information enable uncertainty estimates propagate along image data multi-stage bayesian deep learning framework. using computer-aided detection pulmonary nodules example demonstrate bayesian modeling multi-stage setting provides model conﬁdence associated nodule detection decisions propagation uncertainty information networks also improves overall detection/classiﬁcation performance. important build physician trust model’s performance applications cancer detection knowing result high conﬁdence inﬂuence follow-on treatment decision. best knowledge none existing methods lung lesion detection utilize produce uncertainty/conﬁdence information associated nodule detection decisions. problem computer-aided detection pulmonary nodules using low-dose scans number unique challenges first scan large prohibiting used full size images deep learning computational resource constraints. second pulmonary nodules detected much smaller full scans high variability terms shape size texture properties. challenges motivated researchers divide original problem simpler subproblems multi-stage learning algorithms algorithm attempts solve simpler subproblem. speciﬁcally problem common ﬁrst segment slices regions interest followed performing nodule detection within region interest improve detection results. motivated problem consider multi-stage deep learning architecture shown figure comprising consecutive bayesian convolutional neural networks cascaded predictions segmentation network inform predictions nodule detection network. overall performance architecture depends individual performance network well coupling them. architecture network different local view full scan. segmentation network operates full axial slices whereas detection network operates small volumes. figure two-stage bayesian architecture. segmentation predictive mean standard deviation maps fused original image form -channel composite image bayesian ﬁnal nodule detection. goal segmentation predictions along uncertainties improve nodule detection performance. segmentation predictions incorporated additional features nodule detection concatenating/fusing segmentation predictive mean standard deviation original image form -channel composite image shown figure composite image bayesian nodule detection network. extra information provided segmentation predictions along associated uncertainties improves detection performance nodules segmentation network high conﬁdence also increases overall model conﬁdence nodule detection network. since segmentation predictions based local context result produce false positives lower conﬁdence true positives also original -channel image train second bayesian nodule detection network. combining predictions detection networks enables combine strengths approaches resulting improved overall accuracy higher model conﬁdence. although speciﬁc application consider pulmonary nodule detection approach propagating fusing uncertainty used multi-stage deep learning applications autonomous driving ﬁrst network detects classiﬁes objects scene followed second network makes decisions direction steer car. described previous section shown figure bayesian cnns architecture. network different local view full scan. segmentation employ -layer u-net architecture base network dropout probability convolutional layer. using stochastic dropout test time obtain monte carlo samples approximating segmentation prediction probability distribution note that knowledge bayesian u-net employed medical image segmentation before. segmentation alone sufﬁcient nodule detection results large number false positives perform nodule detection reduced false positive rates employ three convolutional fully connected layers. detection network operates small nodule candidates extracted based stacked segmentation predictions axial slices. reason volumes nodule detection suspicious nodules unique features differentiate normal lung lesions. similar approach segmentation perform approximate bayesian inference stochastic dropout test time obtain samples approximating nodule prediction probability distribution. since segmentation network bayesian approximate segmentation predictive mean standard deviation samples shown figure rows figure show example cases segmentation network able accurately identify true nodule pixels well normal lung tissue high conﬁdence exception nodule borders predictive uncertainty high. images segmentation network performs well high conﬁdence segmentation predictions help improve performance nodule detection network especially since segmentation network able larger context full slices whereas detection network local context. segmentation prediction statistics used additional features nodule detection concatenating segmentation predictive mean standard deviation original image form -channel composite image shown figure call step ‘uncertainty fusion’. goal make nodule detection easier cases shown figure row. structural similarities nodules normal lung features means segmentation network uses context produce false positives well lower conﬁdence true positives. show examples cases bottom figure figure bottom false positives high uncertainty whereas figure bottom true detection high uncertainty. improve performance since difﬁcult cases high overall uncertainty ones shown figure bottom employ second nodule detection network trained using original -channel image without propagation segmentation predictive uncertainty. shown next section combining predictions detection networks enables combine strengths approaches. figure example segmentation results. left original axial slices. green boxes depict true positives false positive segmentation respectively. center segmentation mean right segmentation uncertainty represented standard deviation indicates ideal case conﬁdent segmentation predictions true nodule location uncertain predictions edges whereas bottom indicates model overall uncertain. evaluate false positive reduction performance provided nodule detection network luna dataset comprising scans patients among patients nodules total number nodules. split dataset %/%/% train validation test split. segmentation recall precision test data respectively. figure shows performance bayesian nodule detection networks test data. note ﬁgures total number positives limited extracted segmentation network goal compare performance nodule detection networks. segmentation network misses nodule nodule longer recovered detection network since candidates detection network generated based stacked segmentation predictions. present precision-recall curves candidate extremely imbalanced performance benchmark also show results non-bayesian -channel called ‘baseline’. refer bayesian nodule detection network fuses uncertainty ‘bayesian uncertainty fusion’. bayesian nodule detection network uses original -channel image referred ‘bayesian cnn’. detection networks exactly architectures. figures show bayesian uncertainty fusion comparable -channel bayesian higher overall conﬁdence extra information provided segmentation network. compute average predictive uncertainty figure averaging standard deviations predictions candidates. example results validation revealed bayesian uncertainty fusion able make high conﬁdence predictions positive candidates similar shown figure whereas struggles candidates similar bottom row. similar candidates negatives shown bottom figure contrast -channel struggles small nodules -channel easily identiﬁes thanks uncertainty information provided segmentation network. assess dependence predictions bayesian cnns computed spearman’s rank corrrelation coefﬁcient validation resulting shows weak dependence predictions conﬁrming manual inspection. based information combined predictions convex combination create ensembled prediction. selected weight prediction maximized validation set. shown figure ensembling approach resulted signiﬁcant improvement relative either network operating independently. further denoting test predictions networks |x∗d independent random variables test input training data respectively. therefore calculate predictive variance ensembling approach ensemble prediction. figure shows ensembling approach results slight increase model uncertainty compared -channel bayesian uncertainty still much lower -channel bayesian cnn. performance bayesian cnns comparable better non-bayesian baseline model. importantly unlike non-bayesian baseline provide model uncertainty/conﬁdence information could extremely valuable medical applications. note performance improvement pronounced precision-recall curves since positive class extremely underrepresented data. also show brier scores test predictions table showing bayesian uncertainty fusion provides better performance -channel bayesian terms brier score ensembling methods provides best performance. focusing problem proposed method propagate fuse uncertainty information multi-stage bayesian convolutional neural network architecture. experiments showed propagating fusing uncertainty improved overall performance terms ﬁnal prediction accuracy model conﬁdence. although speciﬁc problem considered paper proposed method could used variety applications knowledge uncertainty important informs subsequent decision making processes overall system. example applications include medical image based diagnostics autonomous driving robotics. results pave several interesting research questions investigate future work. although performed ensembling combine predictions detection networks explore whether integrate ensembling process within single architecture single network learn best combine information different channels. also consider adaptive ensembling approaches predictions combined using information prediction’s uncertainty. addition investigate approximate bayesian inference techniques variational dropout assess close estimated uncertainties different approximations true uncertainties. information could crucial certain applications medicine overestimation uncertainty preferable underestimation. finally investigate whether separately model uncertainty lack training data uncertainty inherent noise data different implications subsequent decision making processes.", "year": 2017}