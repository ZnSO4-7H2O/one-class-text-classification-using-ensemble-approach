{"title": "Deep Manifold Traversal: Changing Labels with Convolutional Features", "tag": ["cs.LG", "cs.CV", "stat.ML"], "abstract": "Many tasks in computer vision can be cast as a \"label changing\" problem, where the goal is to make a semantic change to the appearance of an image or some subject in an image in order to alter the class membership. Although successful task-specific methods have been developed for some label changing applications, to date no general purpose method exists. Motivated by this we propose deep manifold traversal, a method that addresses the problem in its most general form: it first approximates the manifold of natural images then morphs a test image along a traversal path away from a source class and towards a target class while staying near the manifold throughout. The resulting algorithm is surprisingly effective and versatile. It is completely data driven, requiring only an example set of images from the desired source and target domains. We demonstrate deep manifold traversal on highly diverse label changing tasks: changing an individual's appearance (age and hair color), changing the season of an outdoor image, and transforming a city skyline towards nighttime.", "text": "abstract. many tasks computer vision cast label changing problem goal make semantic change appearance image subject image order alter class membership. although successful task-speciﬁc methods developed label changing applications date general purpose method exists. motivated propose deep manifold traversal method addresses problem general form ﬁrst approximates manifold natural images morphs test image along traversal path away source class towards target class staying near manifold throughout. resulting algorithm surprisingly eﬀective versatile. completely data driven requiring example images desired source target domains. demonstrate deep manifold traversal highly diverse label changing tasks changing individual’s appearance changing season outdoor image transforming city skyline towards nighttime. many tasks computer vision cast label changing problem given input image change label image label target label recent examples general task include changing facial expressions hairstyle example-based image colorization aging faces material editing editing outdoor scenes changing seasons image morphs relighting photos hallucinating night image image variety specialized algorithms exist tasks. however algorithms often incorporate substantial domainspeciﬁc prior knowledge relevant task require hand annotation images rendering unable perform task. example unlikely facial aging algorithm would able change season outdoor scene. motivates research general form changing image appearances. goal design method takes input source target images changes given test image semantically similar target source images. given image could transformed target image linear interpolation pixel space. however intermediate images would meaningful natural images span linear subspace pixel space. instead believed constitute dimensional sub-manifold order make meaningful changes image traversal path must conﬁned underlying manifold throughout. bengio hypothesizes deep convolutional networks linearize manifold natural images subspace deep features. suggests convolutional networks particular feature space learned networks natural choice solving label changing problem. however recent work demonstrated problem surprisingly hard machine learning algorithms. context object classiﬁcation convolutional neural networks shown possible change prediction image tiny alterations imperceptible humans. changes aﬀect appearance image leave class label untouched fact problem changing class labels persists discriminative machine learning algorithms still open problem date. paper investigate make meaningful changes input images staying underlying manifold. follow intuition bengio utilize deep convolutional network trained million images simplify manifold natural images linear feature space. avoid diﬃculty pointed szegedy using kernel maximum mean discrepancy estimate distributions source target images feature space guide traversal. traversal stays manifold conﬁned subspace deep features forced guide regions correspond likely images. point along path mapped back image reverse image reconstruction furthermore method linear space time naturally nutshell algorithm works three steps source target test images forward propagated convolutional network mapped deep feature space; used guide traversal test image deep feature space towards target away source distribution staying close manifold natural images; point along traversal path speciﬁed corresponding image generated reverse image reconstruction. resulting algorithm allows traverse manifold natural images freely completely data-driven way. require labeled images source target classes hand annotation method certainly replace specialized methods function baseline wide variety tasks perhaps enable tasks specialized algorithms derived. results indicate method highly general performs better current szegedy ﬁrst show deep networks ‘easily convinced’ input diﬀerent class making subtle imperceptible changes input. changed inputs termed ‘adversarial examples’ goodfellow showed examples generally problematic high-dimensional linear classiﬁers. results indicate inherently diﬃcult meaningfully change label input small changes. general generative networks somewhat orthogonal problem setting deal primarily generating novel images rather changing existing ones typically restricted resolution immahendran vedaldi recovered visual imagery inverting deep convolutional feature representations. goal reveal invariance comparing reconstructed image original image. gatys demonstrated transfer artistic style famous artists natural images optimizing feature targets reconstruction. draw upon works means demonstrate framework image domain. rather reconstructing imagery transferring style construct images qualities diﬀerent class. methods machine learning literature also deal data-driven changes images. reed propose learn model disentangle factors variation work directly minimize discrepancy image target sub-manifold inside semantic space learned convolutional network trained millions images. advantage approach ability much higher resolution images paper compared images analogical reasoning methods solve expression methods generate images controlled fashion method also multiple inputs solve analogies learn disentangled model. concept work similar methods video photo collections capture personality character person’s face apply diﬀerent person diﬃcult problem requires complex pipeline achieve high quality results. example suwajanakorn combines several vision methods ﬁducial point detection face reconstruction optical texture mapping. work conceptually similar also photo collections deﬁne source target. however produce plausible results without additional machinery usage high-level semantic feature space makes method applicable wide-variety domains. task related large body image morphing work image morphing warps images alignment color interpolates mapped points. unlike image morphing warp images map. recent work liao aligns based structural similarity goal achieve semantic alignment partially invariant lighting shape color. achieve high-level semantic feature space. method also requires manual annotations reﬁne mapping whereas method fully automated. kemelmacher creates plausible transformations images person selecting ordered sequence photos large photo collection. qualitatively person appear change expression image changing. unlike method actually change original image preserving clothing background. maximum mean discrepancy statistic tests whether probability distributions source target same. metric measures maximum diﬀerence mean function values distinguishes samples distributions. particular test function large evaluated samples drawn source distribution small evaluated samples drawn target distribution reproducing kernel hilbert space function maximizing intuitively measures degree representative either taking positive value taking negative value. |z−z| work make gaussian kernel deﬁned kernel bandwidth. kernel methods often generalize poorly images pixel space violated smoothness assumptions expect assumptions hold deep visual feature extraction thorough review statistic section discuss method manifold traversal class another. importantly transformation preserve class-independent aspects original image changing class-identifying features. setting given labeled images source domain source label labeled images target domain target label also given speciﬁc input image label informally goal change meaningful true label figure provides overview approach. fig. input image transformed convnet deep features middle manifold traversed source target feature space. bottom inverted recover subject total variation regularizer modifying deep visual features rather pixels directly make changes image space manifold natural images simpliﬁed easily allows images remain manifold. image transformation. approach image transformation change deep visual features look like deep visual features characteristic label deep convolutional network mapped original images linear subspace move linearly away source high-level features towards target high-level features. speciﬁcally rk×d matrix deep convolutional features source ¯zs]. linear combination target test images measure degree transformed features resembles objects source label target label witness function negative value transformed visual features characteristic label label transform target label therefore wish minimize however performed unbounded optimization moves along manifold mode target domain preserving little information contained ¯zs. therefore follow techniques used enforce budget change instead obtain minimizing minimizing witness function encodes forces pushed away visual features characteristic source label simultaneously pulled towards visual features characteristic target label need invert cnn. deep mapping invertible cannot obtain image pixel space directly. mapping however diﬀerentiable adopt approaches gradient descent minimizing loss function faces predicted annotations diﬀerent attributes annotations labels manifold traversal experiments. predicted annotations label noise take conﬁdently labeled images construct image set. example aging task below take bottom images senior class source target image sets. single transformation image results shown value experiments kernel width tasks below test images chosen random exception aaron eckhart included tests order show multiple tasks image. space constraints show small number results experiment. results supplemental. demonstrate ability algorithm make meaningful changes true label test instance ﬁrst consider task computationally aging faces. this ﬁrst follow procedure selecting source target images. select test images random plus aaron eckhart remainder lfw. perform manifold traversal towards senior images using value traversal. results aging experiment shown ﬁgure case deep manifold traversal generates older-appearing version original image adding wrinkles graying hair adding bags eyes. note images remain sharp despite relatively high resolution compared existing purely learning-based approaches facial morphing important aspect transformations made deep manifold traversal changes localized face hair. clothing background lighting features image irrelevant desired label change signiﬁcantly aﬀected. thus algorithm succeeds preserving much character original image possible still changing true label image. comparison aging. section compare several methods deep manifold traversal aging task. compare alternative data driven approaches motivate need performing traversal deep features. first compare shallow manifold traversal perform linear traversal algorithm original pixel space rather extracting deep convolutional features. also compare interpolation pixel space between original input image average senior image. also compare state-of-the-art technique image morphing requires target image requires manual annotation correspondances test target image. case aging image morphing algorithm requires young aged photo person would typically available. therefore chose evaluate aging task harrison ford young images readily available google image search. image morphing baseline show halfway image. annotationed correspondences shown dots original target image. results experiment shown ﬁgure deep manifold traversal clearly perorms better data-driven baselines producing sharp image characteristic aging features. suggests traversal deep convolutional feature space indeed necessary. compared image morphing task visual clarity face comparable. however image morphing algorithm introduces warping face intermediate stages. perhaps obvious diﬀerence methods deep manifold traversal preserves background clothing original image thus avoiding changes irrelevant desired change. comparison szegedy existing work shown possible make imperceptible changes images deep convolutional networks make high-conﬁdence misclassiﬁcations section demonstrate vary manifold traversal algorithm gradually change class label image machine learning classiﬁer’s prediction prediction alone. this convolutional layers feature extractor train using senior non-senior faces distinguish features extracted images positive senior attribute values negative ones. platt scaling transform decision values probabilities ranging lower probability value indicates likelihood senior. construct adversarial senior images–which display left ﬁgure well perform manifold traversal three diﬀerent lambdas display right ﬁgure manifold traversal results generated using lambda values fig. left aging images generated using method right aging images generated deep manifold traversal. image progression towards right generated gradually decreasing value numbers image show platt scaled probabilities trained features distinguish lower values indicate senior. note several important features result. first original images high probability senior. however adversarial modiﬁcations able change prediction completely conﬁdent transformed images seniors. deep manifold traversal makes meaningful change true label images well clearly aging person image. contrast comparable adversarial images fail change original images human-perceptibly meaningful way. show versatility manifold traversal also perform manifold traversal change hair color. task diﬀerent aging diﬀerent hair styles require manifold traversal focus larger variety shapes aging does. perform traversals towards blonde hair towards black hair. help ensure randomly selected test images already blonde black hair selected random test images among percentile brown hair attribute. results hair color experiment shown ﬁgure middle displays original images lfw. bottom show results manifold traversal towards lighter hair darker hair respectively. note hair color traversal generally succeeded despite variety hair styles preserving features image like clothing background. varying hair styles suggest manifold traversal able transform complex shapes simply faces. fig. changing hair color random images manifold traversal. top. manifold traversal lighter hair. middle. original image. bottom. manifold traversal darker hair. traversals performed value lambda. technique work outside context faces? test this also evaluate method tasks using data archive many outdoor scenes collection webcams dataset contains images thousands webcams taken nearly hourly course several years. data lacks rich annotations able construct tasks based image timestamps–traversing winter summer traversing dusk. section look learn transform images winter summer given speciﬁc webcam. collect images january february form source winter images june july form target summer set. select winter test images occur either source target perform deep manifold traversal. results deep manifold traversal image morphing algorithm task shown ﬁgure test images deep manifold traversal adds leaves trees foreground well dense foliage forest background. second test image grass made signiﬁcantly greener snow ground begins fade. notice partial traversal tree trunk added second experiment fades upon complete traversal. fig. changing winter summer deep manifold traversal tree branches replaced leaves dirt appears base large tree partial traversal tree trunk duplicated. viewpoint change. comparison show image morphing requires manual annotations uses single target image rather photo collection. image morphing algorithm also performs reasonably well adding leaves trees producing leaves comparable quality deep manifold traversal. however note notable image artifacts morphing algorithm results. first trunk foreground tree clearly still visible despite fact dense foliage. second image morphing algorithm duplicate trunk tree right signiﬁcant image warping near tree bank lake. possible reason fact image morphing technique relies single target image. means that natural event causes camera viewpoint change slightly algorithm must also morph viewpoint cause riverbank location morphed image. deep manifold traversal however robust changes full traversal small irregularities vital label change. changed make similar nighttime data-driven method selects multiple factors change. tone buildings changes daytime gray nighttime blue nighttime artiﬁcial lighting appears windows waterfront pavilion light headlamps reﬂected water test image. traversal images toward night images night selected timestamp dawn dusk excluded. test image source target images. figure shows traversal result. method found changing tone adding artiﬁcial lighting reﬂections light water cues make image like nighttime. interestingly remains blue would day. hypothesis that trained object recognition dataset treated background represented high-level feature space–for example classifying birds airplanes background. experiments source target images deﬁne manifold. possible fewer images cost reduced output quality ways address limitation. video sources generally produce thousands images easily. data augmenation could increase images must well aligned. example ﬁgure small tree right displaced source target image sets. result ghostly tree trunk appears lambdas note subject needs aligned. example variety backgrounds prevent method operating aligned faces. possible overcome limitation incorporating image alignment mapping automatically identify photos taken viewpoint although gain much using features features roughly larger input image. result holding thousands image feature vectors requires main memory. limitations overcome out-of-core methods cost speed. reducing size deep neural network feature space future research. many best state-of-the-art methods computational pipelines combine domain-speciﬁc knowledge specialized algorithms solve subproblems larger problem. exciting direction future research generic method simplify existing state-of-the-art methods replacing pieces pipeline data-driven approach. possible case deep manifold traversal data augmentation. typical data augmentation involves transforming images label-invariant changes horizontal ﬂipping goal constructing larger dataset. seek train deep neural network that examples distinguishes between young faces could augment data performing manifold traversal aspects–such facial expressions hair color. introduced single general purpose approach make semantically meaningful changes images automated fashion. contrast prior work approach speciﬁc given task. leverage combination deep features convolutional networks naturally conﬁne traversal path onto manifold natural images. resulting algorithm scales linearly space time extremely general requires minimal supervision example images source target domains. however believe true power method lies versatility. without modiﬁcations applied changing appearance faces city skylines nature scenes. future work plan investigate manifold traversal active learning automated image augmentation pre-processing supervised computer vision tasks. hope work", "year": 2015}