{"title": "Co-training for Demographic Classification Using Deep Learning from  Label Proportions", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Deep learning algorithms have recently produced state-of-the-art accuracy in many classification tasks, but this success is typically dependent on access to many annotated training examples. For domains without such data, an attractive alternative is to train models with light, or distant supervision. In this paper, we introduce a deep neural network for the Learning from Label Proportion (LLP) setting, in which the training data consist of bags of unlabeled instances with associated label distributions for each bag. We introduce a new regularization layer, Batch Averager, that can be appended to the last layer of any deep neural network to convert it from supervised learning to LLP. This layer can be implemented readily with existing deep learning packages. To further support domains in which the data consist of two conditionally independent feature views (e.g. image and text), we propose a co-training algorithm that iteratively generates pseudo bags and refits the deep LLP model to improve classification accuracy. We demonstrate our models on demographic attribute classification (gender and race/ethnicity), which has many applications in social media analysis, public health, and marketing. We conduct experiments to predict demographics of Twitter users based on their tweets and profile image, without requiring any user-level annotations for training. We find that the deep LLP approach outperforms baselines for both text and image features separately. Additionally, we find that co-training algorithm improves image and text classification by 4% and 8% absolute F1, respectively. Finally, an ensemble of text and image classifiers further improves the absolute F1 measure by 4% on average.", "text": "many models proposed based logistic hypothesis graphical models little work considers deep learning. paper propose approach converts deep neural network supervised classiﬁer llp. method readily implemented popular deep learning packages introducing regularization layer network. propose layer called batch averager. similar label regularization layer computes average input output. like regularization layers layer applied training time. batch averager typically appended last layer network convert supervised learning deep llp. kl-divergence error function train network produce predictions match provided label proportions. deep framework advantages simplicity batch averager based simple tensor operation unlike batch normalizer layer training weights noticeably affect training time. addition also propose co-training deep improve accuracy. applications multiple views data available example many social media sites contain image textual data. many deep learning methods directly combine text image features instead require model robust cases feature view missing. example users post images would still like classify based text. attractive alternative co-training traditional abstract—deep learning algorithms recently produced state-of-the-art accuracy many classiﬁcation tasks success typically dependent access many annotated training examples. domains without data attractive alternative train models light distant supervision. paper introduce deep neural network learning label proportion setting training data consist bags unlabeled instances associated label distributions bag. introduce regularization layer batch averager appended last layer deep neural network convert supervised learning llp. layer implemented readily existing deep learning packages. support domains data consist conditionally independent feature views propose co-training algorithm iteratively generates pseudo bags reﬁts deep model improve classiﬁcation accuracy. demonstrate models demographic attribute classiﬁcation many applications social media analysis public health marketing. conduct experiments predict demographics twitter users based tweets proﬁle image without requiring user-level annotations training. deep approach outperforms baselines text image features separately. additionally co-training algorithm improves image text classiﬁcation absolute respectively. finally ensemble text image classiﬁers improves absolute measure average. deep learning methods produced state-of-the-art accuracy many different classiﬁcation tasks especially image classiﬁcation networks typically millions parameters rely access large labeled data sets imagenet million annotated images. transfer learning help adapt network domain still requires labeled data target domain. attractive alternative learning label proportion training samples divided bags label distribution known. main advantage require annotations individual instances. furthermore many domains label proportions readily available example associating geolocated social media messages county co-training requires labeled data propose algorithm suitable setting. method image-based model create bags estimated label proportions call pseudo-bags. text-based model pseudo-bags turn create pseudo-bags image-based model. conduct experiments classifying twitter users demographic categories based proﬁle image tweets. proposed deep framework outperforms supervised baselines co-training improves accuracy models. remainder paper organized follows. section review related work co-training section provides deep framework co-training algorithm. section describe data collected experiments. section present empirical results; section concludes describes plans future work. deep learning methods produced state-of-the-art results many classiﬁcation tasks typically require many labeled training instances. image classiﬁcation researchers usually compare model training large datasets imagenet vgg- network achieves top- accuracy imagenet stacking layers other. resnet- network improves introducing residual networks inception networks present inception module convolutional neural network inceptionv achieves top- accuracy imagenet. inception module combined residual networks create inception-resnet-v accuracy xception network introduces extreme inception module using deepwise separable convolution layers achieves top- accuracy models highly rely vast amount labeled data. however transfer learning pre-trained weights move image classiﬁcation tasks still need annotated data target domain alternative approaches required absence labeled data. handful researchers attempt deep learning settings. kotzias propose model particular case label bags available. example text classiﬁcation task label multiple sentences propose model infer label sentence using objective function smooth posterior probability samples based sample similarity constraints. convolutional neural network infer sentence similarity text classiﬁcation. researchers provide models image segmentation. setting image split multiple small images classiﬁer tries infer labels regions using label proportion bag. suggest convolutional neural network probabilistic method estimate labels considering proportion bias using expectation maximization algorithm determine model parameters. approach satellite images know area ratio train classiﬁer predict label small segments images. methods promising results particular domain best knowledge method proposed framework readily applied diverse classiﬁcation tasks. inspired label regularization introducing batch averager regularizer layer. traditional regularization appears sufﬁcient deep neural network overﬁtting severe problem networks. srivastava introduce dropout layer randomly drops units backpropagation step show signiﬁcantly reduce overﬁtting. furthermore batch normalizer introduced normalize output cells reduce internal covariate shift weights similar normalization layers proposed batch averager layer applies training time recently demographic classiﬁcation deep learning proposed researchers. zhang offer method infer demographic attributes wild similarly propose convolutional neural network classify attributes gender race wild. ranjan provide fast rcnn localize recognize faces scene attributes attempts textual image features together. co-training semi-supervised method trains views features small labeled data iteratively adds pseudo labels large unlabeled data gupta demonstrate co-training algorithm trains captioned image recognize human actions svms. model also learns videos athletic events commentary. majority works captions leverage image classiﬁcation accuracy co-training methods cannot applied text classiﬁcation purpose. furthermore require annotated labeled data. hand proposed co-training model trains image text classiﬁers used separately. additionally need labeled data; testing sample image text features apply ensemble model improve classiﬁcation accuracy. section ﬁrst deﬁne proposed regularization layer batch averager. then illustrate deep framework layer. next provide algorithm create bags appropriate label distributions training. finally offer co-training approach training views data settings. tensor size batch size result need repeat average times. similarly need repeat prior times. number samples typically different sample need sample weight result entire sample weight one. formally train network similar fashion traditional supervised learning feature vectors labels sample weights additionally kl-divergence error theano backend. implementation simple extend deep learning packages. another implementation aspect take consideration default deep learning packages assume ﬁxed batch size. however size typically dynamic. support dynamic batch size implement generator code make batches network. also generator code automatically breaks large bags randomly smaller bags memory. implement layer dynamic batch size broadcasting feature tensor operations. suppose backend deﬁne function activation function batch averager layer input tensor layer. batch averager appended logit layer twodimensional tensor size number output classes. function ﬁrst creates zero tensor size computes average ﬁrst axis vector tensor size finally adds together using broadcasting feature creates tensor size average repeated ﬁrst axis times. section provide framework implement deep networks. framework uses batch average regularizer last layer applied classiﬁcation application furthermore propose text classiﬁcation image classiﬁcation networks. similar classiﬁcation deep network deep framework input network feature vectors feed network layers typically used classiﬁcation task hand. next layer logit layer compute class probabilities. finally batch averager label regularization sends average features output. learning label proportion setting training data divided bags label distribution known. samples bag; i.e. {xij} feature vector instance provided label proportion number samples e.g. binary classiﬁcation fraction positive instances implement deep assume assigned exactly batch gradient optimization. also deep neural networks typically trained cores limited memory usually maximum batch size determined number parameters memory. result large need break smaller bags. work inspired label regularization deﬁne regularization layer neural network. label regularization model estimates posterior probabilities average posterior probabilities instances bag. neural network implemented computing average output last layer batch. result name layer batch averager. output last layer supervised network. classiﬁcation tasks last layer typically logit function returns vector posterior label probabilities; i.e. instance class have expect posterior probability close prior probability again similar label regularization kl-divergence error function posterior prior target neural network minimize error function batch averager layer similar batch normalizer layer latter normalizes output batch zero mean unit variance; former converts input layer average. regularization layer batch averager applied training time testing time. typically batch averager would applied last layer network immediately logit layer. layer avoid overﬁtting. also temperature parameter suggested previous work temperature readily implemented logit layer tensor operation. image classiﬁcation xception state-of-the-art image classiﬁcation model pre-trained weights freeze ﬁrst blocks network train maximum batch size network color images dimension figure shows detailed network model. domains bags naturally available soft constraints geolocation allowing assign label proportions groups instances. example experiments below attach u.s. census statistics county demographics twitter users location. however domains constraint prior probability based attribute instance. example according census people last name ‘taylor’ white. problem construct combines many constraints associate accurate label proportion training. class unlabeled samples {xi} assume prior probability class goal select instances construct assign expected proportion class algorithm shows create bags class. algorithm takes input maximum size threshold results below experiments. algorithm ﬁrst removes samples probability lower threshold threshold typically greater then samples sorted decreasing order prior probability. next move ﬁrst sorted samples ﬁrst next samples next continue remaining samples assigned bags. finally compute label proportion average prior probability samples inside bag. bags used training data deep model. advantage creation approach allows associate label proportions instances using preexisting population statistics. course label proportions likely inexact contain selection bias twitter users representative population. however several prior works found methods robust type noise also case present work. conditionally independent feature views data. interesting case text image views data. views naturally bags others accurate label proportions associated them. thus goal combine advantages view produce accurate classiﬁer. apply algorithm assume sets bags textual features image features. bags label proportions unlabeled data view refer instances. propose algorithm co-training settings. algorithm proceeds using model trained view create pseudo bags view. algorithm initialized empty pseudo bags iteration ﬁrst train deep model union current view pseudo bags view. next predicts posterior probability unlabeled samples current view. then calls algorithm create pseudo bags using current view’s posteriors priors finally switches views next iteration. experiments below algorithm tends converge quickly evaluate deep framework consider task predicting gender race/ethnicity twitter user based tweets proﬁle image. section ﬁrst describe collect data twitter create bags well annotated data used validation. common image data comes metadata. metadata useful create bags. example images flickr caption description. also twitter users often proﬁle image. demonstrate metadata used constraint create bags collect data twitter. purpose study geolocation name metadata constraints create bags. first twitter streaming collect roughly tweets remove users without image proﬁle; approximately tweets image proﬁle remain. however users photo. decrease noise want ensure face image proﬁle. apply viola-jones object detection algorithm algorithm detects multiple faces scene false positive rate. finally roughly images exactly identiﬁed face remain. user download recent tweets text-based model. next county name metadata create bags. county constraint described recent work associating user county u.s. based geolocation information provided tweets. results bags average users bags. figure illustrate generated using county constraint prior probability class white. ﬁgure shows photos multiple faces cartoon faces errors face detection algorithm. expect photo bags contain noise. also name attribute estimate label proportions. gender classiﬁcation ﬁrst name data social security administration example according baby data ﬁrst name ‘casey’ probability algorithm create bags. figure shows using name constraints male prior probability. noise face detection. additionally race/ethnicity classiﬁcation last name described recent research estimate class priors users provide last name algorithm create bags. example according census people last name ‘taylor’ white. purpose study train image textual classiﬁers demographic attribute task. race classiﬁcation consider three categories however according census hispanic debated term refers spanish culture origin regardless race ethnicity. result consider another classiﬁcation task restricted black white classes. refer latter ‘race’ former ‘race’ classiﬁcation task. since labeled samples twitter datasets imbalanced report weighted average measure compare results. section ﬁrst provide experimental results text classiﬁcation task compare state baselines. then describe image classiﬁcation results compare third-party face apis. finally demonstrate co-training improves text image classiﬁcation well advantage ensemble approach. search constraints created searching google images textual features text classiﬁcation task county name constraints. table shows weighted measure different tasks combination constraints. according table county constraint results higher accuracy race classiﬁcation name bags higher accuracy gender classiﬁcation. means location informative race classiﬁcation ﬁrst name informative gender classiﬁcation. also race task using constraints together increases classiﬁcation accuracy gender classiﬁcation result combining constraints almost using name bags. since using constraints improves classiﬁcation task name county constraints subsequent text classiﬁcation experiments. maximum batch size generate table iii; larger bags randomly split smaller bags maximum size iteration training. figure figure show twitter proﬁle images often noisy. furthermore class distributions unbalanced since african-americans less frequent county name constraints. motivates third type constraint image classiﬁcation. submit keywords google images search identify images likely come desired class. then apply viola-jones algorithm remove photos without exactly face scene. google search sort images decreasing order relevance associate decreasing label proportions descend list. speciﬁcally group search results bags size contiguous results maximum results. ﬁrst assigned label proportion positive class proportion reduced subsequent minimum additional validation chicago face database contains high-quality frontal images genders four racial/ethnic categories facial expressions remove asian photos dataset additional testing set. advantage database samples hispanic category validation set. table shows class distribution database. however dataset different distribution training set. training mostly wild condition result expect different behavior classiﬁer set. discuss experimental results images high quality race/ethnicity classiﬁer according table gender classiﬁcation stable different batch sizes maximum batch size works better race tasks. result surprising batch size small batch size advantage randomly splitting bags avoid overﬁtting. interesting case batch size associates label distribution individual instances. problem approach less robust noise example label proportion positive applied negative instance classiﬁer attempt noisy example. however instance negative batch size classiﬁer given ﬂexibility predicting negative still optimizing loss function. indeed batch size effective task. finally compare deep model state-ofthe-art shallow models ridge regression label regularization comparison. table compares model maximum batch size models county name constraints. according table model ridge race task higher tasks. speciﬁcally average ridge label regularization score model highest measure section present image classiﬁcation results using proposed deep model. experiments xception model training weights imagenet. imagenet dataset commonly used image classiﬁcation million images objects class related human face body. best result maximum batch size last section image classiﬁcation task. reduce memory consumption freeze ﬁrst blocks xception network training phrase train remaining layers. shift shear zoom photos. also probability randomly crop violajones detected face avoid overﬁtting background images. adam adaptive stochastic gradient descent algorithm optimization algorithm train models epochs report accuracy validation table shows weighted average measure different tasks using constraint combinations. according table search constraint informative tasks using county name constraints together poor result race classiﬁcation. also except race task using constraints together best result. comparing text classiﬁcation search constraints apparent image classiﬁcation higher accuracy text classiﬁcation. table also presents metric dataset. race model high result measure. result reveals race classiﬁcation much easier high-quality frontal photos opposed noisier images twitter. hand gender classiﬁer high twitter images lower dataset. believe part images omit body features classiﬁer must rely solely face features. since average using constraints highest average measure tasks next experiments present results models trains constraints. figure illustrates validation accuracy training epoch different classiﬁcation tasks. clearly gender classiﬁcation highest accuracy converges faster classes race lowest accuracy converges slower. illustrate impact adding image distortion make model robust wild condition pictures table compares model trained random distortion using constraints model without distortion according table clearly need image manipulations almost tasks adding random distortion photos average absolute improvement measure. similarly figure shows training validation loss race classiﬁcation epoch. according ﬁgure model trains without image distortion overﬁts converging lower training loss higher validation loss. measure effect underlying deep neural network table demonstrates average deep models using various neural networks compare xception inception-v inception-v inceptionv-aux networks former inception-v auxiliary output layer proposed szegedy another batch averager auxiliary layer kl-divergence too. according table inception-v poor result inception-v converge race task highest measure race dataset. also need auxiliary layer inception-v clear improvement signiﬁcant. however average contrast imagenet reported results xception slightly better result inception-v-aux. maybe part inception-v-aux deep requires data training phase. figures illustrate training loss validation accuracy validation loss gender classiﬁcation task using different models. according ﬁgures xception converges faster better results inception-v worst results. also apparent adding auxiliary layer inceptionv improves xception. finally compare deep four baselines. ﬁrst baselines compare deep supervised deep learning; xception pre-trained weights train epochs using labeled data. xceptionwild model training data twitter evaluation labeled data wild conditions dataset high quality images train xception-hq model. next baselines public face apis. apis detect multiple faces scene multiple attributes. microsoft face identify gender predict race. race classiﬁcation sightcorp supporting race recognition best knowledge still beta phase accurate results. table viii compares baselines deep model using constraints. approach outperforms xception-wild xception-hq sightcorp tasks outperforms microsoft wild condition. however latter better result dataset clean frontal images method trained image view. iteration algorithm creates pseudo-bags used next iteration experiment twitter unlabeled data unlabeled samples. thus unlabeled data organize different bags different label proportions training. text bags county name constraints image bags county name search constraints. table presents result co-training algorithm image classiﬁcation. table ﬁrst column indicates iteration algorithm ﬁrst states measure deep model without co-training. table shows iterations co-training algorithm. according table biggest improvement comes ﬁrst iteration improves absolute race improves absolute race applying co-training algorithm growth belongs race absolute improvement twitter dataset. believe part text classiﬁer detect spanish words hispanic class make better pseudo-bags race classiﬁcation task co-training algorithm improves absolute twitter dataset. dataset already high measure growth co-training steps. gender classiﬁcation already high measure twitter co-training improves however increases dataset believe lower accuracy gender classiﬁcation task database part lack body features. absence body features classiﬁer often misclassiﬁes short hair woman long hair woman. also dataset images facial expression training data consider that classiﬁer sometimes misclassiﬁes woman angry fearful expression man. figure shows misclassiﬁcation samples predicted probability. table demonstrates result even iterations text classiﬁcation steps algorithm again ﬁrst shows result text classiﬁcation without co-training. according table second iteration co-training highest improvement highest growth belongs race classes improves absolute improvement likely image classiﬁer high task result creates accurate pseudo-bags text classiﬁer. finally gender classiﬁcation grows since little improvement image classiﬁcation. ﬁnal experiment select last iteration text classiﬁcation image classiﬁcation co-training algorithm. then twitter dataset blend predictions using soft voting. table shows result. according table ensemble improves image classiﬁcation average text classiﬁcation average ensemble produces highest tasks paper introduced enhancements deep learning methods image text classiﬁcation batch averager layer enable deep learning cotraining method combining deep models trained different views. found deep model trained population level data using proper constraints comparable traditional supervised learning. approach decreases burden human annotation readily implemented almost every publicly-available deep learning software packages. also found applications views features co-training algorithm leverages improvement classiﬁcation task views enhanced ensemble learning achieve highest precision. investigate additional co-training algorithms particularly investigating methods improving pseudo-bag generation applying larger unlabeled data. szegedy sermanet reed anguelov erhan vanhoucke rabinovich going deeper convolutions computer vision pattern recognition available http//arxiv.org/abs/. russakovsky deng krause satheesh huang karpathy khosla bernstein berg fei-fei imagenet large scale visual recognition challenge international journal computer vision vol. robust scalable semisupervised learning expectation regularization proceedings international conference machine learning ser. icml york available http//doi.acm.org/./. k.-t. m.-s. chen s.-f. chang video event detection inferring temporal instance labels proceedings ieee conference computer vision pattern recognition ser. cvpr washington ieee computer society available http//dx.doi.org/./cvpr.. ioffe szegedy batch normalization accelerating deep network training reducing internal covariate shift corr vol. abs/. available http//arxiv.org/abs/. al-rfou alain almahairi angerm¨uller others theano python framework fast computation mathematical expressions corr vol. abs/. available http//arxiv.org/abs/. abadi agarwal barham brevdo chen others tensorﬂow large-scale machine learning heterogeneous distributed systems corr vol. abs/. available http//arxiv.org/abs/. sakaki okazaki matsuo earthquake shakes twitter users real-time event detection social sensors proceedings international conference world wide ser. york available http//doi.acm.org/./. blum mitchell combining labeled unlabeled eleventh annual data co-training proceedings conference computational learning theory ser. colt’ york available http//doi.acm.org/./. kotzias denil freitas smyth from group individual labels using deep features proceedings sigkdd international conference knowledge discovery data mining ser. york available http//doi.acm.org/./. taylor alter-cnn approach learning label proportions application ice-water classiﬁcation neural information processing systems workshops learning privacy incomplete data weak supervision ranjan patel chellappa hyperface deep multi-task learning framework face detection landmark localization pose estimation gender recognition corr vol. abs/. available http//arxiv.org/abs/. gupta grauman mooney watch listen learn co-training captioned images videos proceedings european conference machine learning knowledge discovery databases part ser. ecml pkdd berlin heidelberg springer-verlag available http//dx.doi.org/./---- viola jones rapid object detection using boosted cascade simple features ieee computer society conference computer vision pattern recognition cd-rom december kauai usa. ieee computer society available http//dx.doi.org/./cvpr..", "year": 2017}