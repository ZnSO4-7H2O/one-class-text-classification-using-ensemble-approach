{"title": "Causal Consistency of Structural Equation Models", "tag": ["stat.ML", "cs.AI", "cs.LG", "stat.ME"], "abstract": "Complex systems can be modelled at various levels of detail. Ideally, causal models of the same system should be consistent with one another in the sense that they agree in their predictions of the effects of interventions. We formalise this notion of consistency in the case of Structural Equation Models (SEMs) by introducing exact transformations between SEMs. This provides a general language to consider, for instance, the different levels of description in the following three scenarios: (a) models with large numbers of variables versus models in which the `irrelevant' or unobservable variables have been marginalised out; (b) micro-level models versus macro-level models in which the macro-variables are aggregate features of the micro-variables; (c) dynamical time series models versus models of their stationary behaviour. Our analysis stresses the importance of well specified interventions in the causal modelling process and sheds light on the interpretation of cyclic SEMs.", "text": "complex systems modelled various levels detail. ideally causal models system consistent ansense agree predictions eﬀects interventions. formalise notion consistency case structural equation models introducing exact transformations sems. thisprovidesagenerallanguagetoconsider instancethediﬀerentlevelsofdescriptioninthe following three scenarios models large numbers variables versus models ‘irrelevant’ unobservable variables marginalised out; micro-level models versus macro-level models macrovariables aggregate features microvariables; dynamical time series models versus models stationary behaviour. analysis stresses importance well speciﬁed interventions causal modelling process sheds light interpretation cyclic sems. physical systems processes real world complex understood various levels detail. instance volume consists large number molecules. instead modelling motions particle individually choose consider macroscopic properties motions temperature pressure. decision macroscopic properties ﬁrst necessitated practical considerations. indeed extremely simple cases making measurement individual molecules practically impossible resources insuﬃcient modelling particles present litre ideal gas. furthermore decision macroscopic description level also pragmatic wish reason temperature pressure model particles ill-suited. statisticalphysicsexplainshowhigher-levelconceptssuch temperature pressure arise statistical properties system large number particles justifying macro-level model useful transformation micro-level model however many cases aggregate indirect measurements complex system form basis macroscopic description system little theory explain whether justiﬁed micromacro-descriptions stand relation other. deliberate modelling choice limited ability observe system diﬀering levels model descriptions ubiquitous occur amongst possibly others following three settings models large numbers variables versus modelsinwhichthe‘irrelevant’orunobservablevariables marginalised e.g. modelling blood cholesterol levels risk heart disease ignoring blood chemicals external factors stress. micro-level models versus macro-level models macro-variables aggregate features micro-variables e.g. instead modelling brain consisting billion neurons modelled averaged neuronal activity distinct functional brain regions. dynamical time series models versus models stationary behaviour e.g. modelling ﬁnal ratios reactants products time evolving chemical reaction. context causal modelling diﬀering model levels consistent another sense agree predictions eﬀects interventions. particular causal models focus experiments carried patients assigned diﬀerent diets order raise lower conﬂicting evidence found diﬀerent experiments found higher eﬀect lowering others found opposite point view problem arose trying perform ‘invalid’ transformation ‘true’ underlying model according american heart association current scientiﬁc consensus types bloodcholesterollow-densitylipoproteinandhighdensity lipoprotein negative positive eﬀect respectively. assigning diets raise raise diﬀerent eﬀects therefore possible transform model figure model figure without leading conﬂict order reason causes need consider variables separately. structural equation models sems widely used framework causal modelling applications neuroscience economics social sciences section introduce abstract mathematical object; section describe causal modelling tool. readers already familiar sems note deﬁnition general deviates standard deﬁnition sems following ways require possible perfect interventions modelled; assume independence exogenous variables; require acyclicity. deﬁnition vari\u0001\u0017\u0001ë\u0001 ables taking value triple index set. structural equations subset perfect interventions distribution exogenous variables ࡇ\u0001-probability intervention vened structural equations. ensures exogenous variables also referred noise variables intheliterature. ourrelaxationoftheassumptionofindependent exogenous variables means models considered type semi-markovian causal model. figure illustrated current consensus negative eﬀect heart disease considering causal variable leads problems diets promoting raised levels raised levels eﬀect opposite eﬀects heart disease. hence diﬀerent studies come contradictory conclusions eﬀect heart disease. paper structural equation models section introduce notion exact transformation sems providing general framework evaluate models thought causal descriptions system. important novel idea paper explicitly make natural ordering interventions. high level viewed exact transformation another provided explicit correspondence models causal reasoning levels consistent. discuss notion consistency detail sections section apply mathematical framework prove exactness transformations belonging three categories listed above practical implications following questions causal modelling model subsystem complex system? micro-level system admit causal description terms macro-level features? cyclic sems arise? fact distinct problems considered using language transformations sems demonstrates generality approach. close section discussion. following give example problems arise exists consistent correspondence causal models i.e. neither model viewed exact transformation other. example falls category diﬀering model levels listed used illustrate problems causal modelling process. historically level total cholesterol blood thought important variable determining risk heart disease investigate this diﬀersem function \u0001-variables exogenous variable mathematical model perfect intervention single variable realised replacing structural equation variable perfect interventions multiple variables e.g. similarly realised replacing structural equations variable individually. elements ofë\u0001 correspond perfectly intervening subset variables setting particular combination values. natural partial ordering which interventions intervenes subset variables intervenes sets equal values example theobservation structure important contribution paper. make crucial next section. purpose following example illustrate sems written notation provide example restricted interventionsë\u0001. sems causal modelling addition abstract mathematical objects sems used causal modelling describe distributions variables change interventions do-interventions abstract manipulations sems understood corresponding actual informally means performed withchange undo changes structural equations made pairs elements must comparable instance neither hypothetical) physical implementations real world i.e. model ‘rooted reality’. instance binary variable reﬂects whether light bulb emitting light could achieved ﬂipping light switch removing light bulb. example could thought simple causal model light bulbs presence light room window. suppose access light switch curtains room intervene removing light bulbs. model restricted interventions byë\u0001 i.e. do-intervention side corresponds removing light bulb partial ordering corresponds ability compose physical implementations interventions. fact ﬁrst remove light bulb )andthenafterwardsremovelightbulb reﬂected partial ordering relation transformations work towards deﬁnition exact transformation sems. core idea analyse correspondence diﬀerent levels modelling considering model transformation other. discuss section causal reasoning sems relate viewed exact transformation section illustrate wrong case. distributions implied usually statistical model implies single joint distribution variables parameters ﬁxed. sems diﬀerent that parameters ﬁxed implies family joint distributions random variables intervention. intervention semï\u0001 deﬁnes distribution overô denote throughout denote null-intervention corresponding unintervened setting write poset distributions implied semï\u0001 suppose function maps variables semï\u0001 another spaceõ. observe since random variable also random distribution variable \u0001\u0001ࡇ\u0001 variable. distribution thus obtain push-forward measure. wecanwrite particular intervention deﬁne theinduceddistribution poset distributions induced original semï\u0001 transformation whereࣘ\u0001 partial ordering inherited from\u0017\u0001 isjustastructuredcollectionofdistributionsoverõ indexed interventionsë\u0001 theô-level; importantly indices interventions theõ-level. although poset distributions necessarily exist implies instance intervention none variables constant distribution could possibly expressed arising do-intervention overõ. case exist semï\u0001 implies\u0017\u0001 special motivating main deﬁnition. deﬁnition andï\u0001 sems function. sayï\u0001 anexact \u0001-transformation ofï\u0001 exists asurjectiveorder-preserving would require change deﬁnition aﬀect results paper. avoid notational burden exposition omit treatment. example distribution variables observational setting implement intervention partial ordering contains information interventions composed. order-preserving means important converse need general hold would imply injective hence also bijective. would constrain ways ‘simpler’ thanï\u0001. surjective ensures do-intervention least corresponding intervention level namely element following results follow immediately deﬁnition lemma identity mapping permuting labels variables exact transformations. good sanity check; would problematic case labelling variables mattered. similarly compositions exact transformations also exact. lemma ifï\u0001 exact -transformation exact \u0001-transformation ofï\u0001 thenï\u0001 exact -transformation ofï\u0001. following theorem consequence fact order-preserving. mathematical formalisation sense exact transformation preserves causal reasoning elaborated upon next subsection. theorem suppose thatï\u0001 exact \u0001-transformation corresponding surjective order-preserving mapping interventions. interventions following diagram commutativity left square diagram follows immediately deﬁnition exact transformation. remains shown right square diagram commutes. deﬁnition thus ࡇdo) elements of\u0017\u0001 i.e. show ࡇdo) arrow ࡇdo) exists. foldo) ࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎࢎ࢐ ࡇdo) lows order-preservingness notion exact transformation sems motivated desire analyse correspondence between causal models describing system diﬀerent levels detail. purpose section show viewed exact transformation other sensibly thought causal models system. following assume thatï\u0001 exact \u0001-transformation ofï\u0001 corresponding interventions. surjectivity ensures intervention inë\u0001 beviewedasanï\u0001 -levelrepresentativeofsomeintervention theï\u0001-level. consequently do-interventions ï\u0001-level correspondence physical implementations surjectivity ensures dointerventions -level least corresponding physical implementation i.e. ifï\u0001 ‘rooted reality’ isï\u0001 commutativityofthelefthandpartofthediagramensures eﬀects interventions consistently modelled byï\u0001 andï\u0001 suppose want reason effects theï\u0001 -level caused intervention example wish reason temperature pressure volume gaseous particles aﬀectedbybeingheated. wecouldperformthisreasoning considering correspondingï\u0001-level intervention considering distribution implies example would correspond considering heating volume could modelled changing motions gaseous particles computing temperature pressure volumeofparticles. commutativityofthelefthandpartof thediagramimpliesthatï\u0001 andï\u0001 areconsistentinthe sense thatï\u0001 allows immediately reason eﬀect intervention equivalent performingthestepsabove. thatiswecanreasondirectly temperature pressure heating volume without perform intermediate steps involve microscopic description system. commutativity right hand side diagram ensures intervention ﬁxes subset variables performed still consistently reason eﬀects interventions remaining variables furthermore ensures compositionality do-interventions ï\u0001-level carries theï\u0001 -level i.e. intervention theï\u0001-level performed additionally intervention inï\u0001—that true representations inï\u0001 ifï\u0001 andï\u0001 models system established thatï\u0001 exact \u0001-transformation mapping commutativity wholediagramintheoremensuresthattheyarecausally consistent another sense described preceding paragraphs. wish reason effects interventions theõ-variables suﬃces modelï\u0001 rather model particular means view theõ-variables causal entities rather functions underlying ‘truly’ causal entities. case causal statements ‘raising temperature increases pressure’ ‘ldl causes heart disease’ meaningful. previous section argued deﬁnition exact transformations sems sensible formalisation causal consistency. section give reader intuition weakening conditions deﬁnition would problematic. particular focus requirement order-preserving view core ideas paper. therequirementthat \u0001besurjectiveisasdiscussedabove required interventions -level corresponding intervention ï\u0001-level. require surjective observational distribution mapped interventional distribution illustrated following example example consider {\u0017\u0001ë\u0001 overô figure graphical illustration parent-child relationships examples section micro-level modelï\u0001 depicted transformed macro-level modelï\u0001 depicted coarser descriptions considers section give examples wrong transformation exact. letï\u0001 overõ order-preserving sems example used model system would problematic observational setting ofï\u0001—a description system physically performed intervention—would correspond interventional setting inï\u0001 conversely suggesting system intervened upon. avoid conﬂict could demand addition surjectivity null intervention ofï\u0001 null intervention ofï\u0001 additional assumption would ensure commutativity left-hand part diagramintheorem. howeverasthefollowingexample shows thiswouldnotensurethattheright-handpartofthe diagram commutes pairs interventions since case arrow ࡇdo) exist. example letôõ example consider semï\u0001 {\u0017\u0001ë\u0001 true although order-preserving. sems used models system would suﬀer problem illustrated example suppose however performed intervention inï\u0001 corresponding intervention wish reason eﬀect intervention inï\u0001 problem. suggests could implemented performing additional action contrastï\u0001 suggests implementing corresponding intervention would conﬂict already performed intervention examples exact introduction motivated problem considered paper listing three settings diﬀering model levels naturally occur. introduced notion exact transformation sems provide section examples exact transformations falling categories. fact single frameworkcanbeusedtodrawanexplicitcorrespondence diﬀering model levels settings demonstrates generality framework. observe following examples particular interventions considered important. allow larger sets interventionsë\u0001 transformations given would exact. highlights importance causal modelling process carefully considering interventions. proofs found appendix. marginalisation variables following theorems consider operations performed sems namely marginalisation childless non-intervened variables prove figure suppose complex model wish model distribution changes interventions theorem ignore downstream grouping together multivarieﬀects treat upstream causes noise ﬂuctuations exactly transform complex simpler model marginalisation. function e.g. thermometer measure temperature motions individual particles. also arise deliberate modelling choice wish describe system using higher level features e.g. viewing motor cortex single entity responsible movements rather collection individual neurons. situations framework exact transformations allows investigate whether macro-level model admits causal interpretation. following theorem provides exact transformation microlevel modelï\u0001 macro-level modelï\u0001 variables aggregate features variables inï\u0001 obtained averaging =\u0001\u0017\u0001ë\u0001 theorem =\u0001\u0001\u0001 =\u0001\u0001\u0001 exact transformations. simpliﬁed fewer variables either operations without losing causal content concerning remaining variables. thus semï\u0001 obtained another successively performing operations following theorems exact transformation hence models causally consistent. formally explains sensibly consider causal models focus subsystem complex systemï\u0001 measuretheoretic treatment marginalisation sems theorem suppose indices variables children =\u0001\u0001\u0001 takes value. side structural equation appear right-hand transformation mapping ࢼ\u0001\u0001\u0001 naturally gives rise exact \u0001transformation ofï\u0001 corresponding marginalising childless variables theorem letï\u0001 acyclic =\u0001\u0001\u0001 takes value. intervened upon intervention suppose indices variables transformation mapping ࢼ\u0001\u0001\u0001 naturally gives rise exact \u0001transformation ofï\u0001 corresponding marginalising never-intervened-upon variables assumption acyclicity made theorem relaxed allow marginalisation non-intervened variables cyclic sems expense extra technical conditions remind reader deﬁnition notrequirethattheexogenous \u0001-variablesbeindependent. theorem would hold restriction made marginalising common parent node general result children dependent exogenous variables. intervention letï\u0001 =\u0001\u0017\u0001 variables\u0001\u0001 thenï\u0001 exact \u0001-transformation ofï\u0001. theorem demonstrates linear additive arise result making observations dynamical process. supports interpretation sems description dynamical process equilibrates quickly compared external environment. framework exact transformations allows explain precise sense equilibrium models used causal descriptions underlying dynamical process. linear relaxed general non-linear mappings. case however structural equations ofï\u0001 written terms implicit solutions structural equations ofï\u0001. purposes exposition stick simpler case linear dynamics. appendix show contraction mappingensuresthatthesequence deﬁnedbyï\u0001 converges everywhere intervention realisation sequence limit lim\u0001࢐ý sequence elements exists. this interpretation corresponds assumption noise dynamical model constant time used e.g. meaningfully interpret cyclic sems. figure illustration setting considered theorem micro-variables averaged derive macrovariables resulting macrolevel exact transformation microlevel semï\u0001. section provide example exact transformation semï\u0001 describing time-evolving system another semï\u0001 describing system equilibrated. setting could thought representing ability measure time-evolving system single point time transient dynamics taken place. particular consider discrete-time linear dynamical system identical noise provide explicit form models distribution equilibria intervention result also sheds light interpretation cyclic causal models. interpretation structural equations acyclic represent temporally ordered series mechanisms data generated. possible case exhibits cycles exist partial ordering variables hence cannot think variable generated temporally downstream parents. showing cyclic sems arise exact transformations acyclic sems provide interpretation cyclic sems suﬀer problem. discussion future work it’s turtles down thing ‘correct’modelbutinthispaperweintroducedthenotions exact transformations sems evaluate sems viewed causally consistent models system. illustrating notions used order relate diﬀering model levels proved section exactness transformations occurring three diﬀerent settings. implications following questions causal modelling model subsystem complex system? whendoesamicro-levelsystemadmitacausaldescription terms macro-level features? cyclic causal models arise? work implications problems causal modelling. suggests ambiguous manipulations maybethoughtofasarisingduetotheapplicationofaninexact transformation semï\u0001. illustrated section cholesterol measured resulting model suﬀered problem ambiguous manipulations since exact transformation underlying model related problem causal variable deﬁnition studied future line enquiry would generalise notion exact transformation order analyse tradeoﬀ model accuracy model complexity causal modelling using sems. transformation exact require posets equal. could imagine ‘softening’ requirement distributions posets required approximately equal. slightly inaccurate model smallnumberofvariablesmaybepreferabletoanaccurate complex model. discussed importance order-preserving ensure notion causal consistency sems. would interesting better understand conditions diﬀerent properties consistency causal models hold instance counterfactual reasoning discussed paper. introduced notion exact transformation provided criterion choose amongst possible exact transformations sem. foundational work similar direction done consider particular discrete setting. provide algorithms learn transformation micro-level model macro-level model desirable information-theoretic properties. conjecture framework lead extensions work e.g. continuous setting. finally suppose made observations underlying systemï\u0001 measurement device want semï\u0001 restricted model class data. using framework asking whether notï\u0001 admits causal interpretation consistent reducestoaskingwhetherthetransformationisexact. generally ﬁxing ofï\u0001 andï\u0001 properties must fulﬁlled third order models causally consistent. hope lead practical sems theoretically grounded. acknowledgements thank tobias mistele valuable early feedback. stephan bongers supported netherlands organization scientiﬁc research project received funding european research council european union’s horizon research innovation programme mooij janzing schölkopf. ordinary diﬀerential equations structural causal models deterministic case. proceedings twenty-ninth conference annual conference uncertainty artiﬁcial intelligencepages– bongers peters schölkopf mooij. structural causal models cycles marginalizations exogenous reparametrizations reductions. arxiv preprint arxiv. chalupka perona eberhardt. visual causal feature learning. proceedings thirtyfirst conference uncertainty artiﬁcial intelligence pages auai press lacerda spirtes ramsey hoyer. discovering cyclic causal models independent components analysis. proceedings twentyfourth conference annual conference uncertainty artiﬁcial intelligence mooij heskes. cyclic causal discovery continuous equilibrium data. proceedings twenty-ninth conference annual conference uncertainty artiﬁcial intelligence j.m.mooijd.janzingt.heskesandb.schölkopf. causal discovery cyclic additive noise modj. shawe-taylor zemel bartlett els. pereira weinberger editors advances naturally gives rise semï\u0001 exact \u0001-transformation ofï\u0001 corresponding relabelling variables. proof lemma consider semï\u0001 obtained fromï\u0001 replacing occurrence structural equations interventions leaving distribution exogenous variables unchanged. proof lemma mappings interventions corresponding exact transformations respectively deﬁne surjective order-preserving since surjective order-preserving. since exact follows ࡇdo) i.e.ï\u0001 \u0001\u0001\u0001-exact transformation ofï\u0001. proofs section marginalisation variables proof theorem lemma suﬃces proof marginalisation childless variable. without loss generality childless variable marginalised out. letï\u0001 structural equations\u0017\u0001 obtained from\u0017\u0001 removing structural equation corresponding childless variable image drops reference variable would mapped remaining noise variables distributed according marginal distribution construction surjective order-preserving. intervention. variable childless ensures remaining variables obtain marginalisation childless variable i.e. equivalent obtains simply dropping childless variable exactly underï\u0001 amounts i.e. proof theorem lemma suﬃces proof marginalisation never-intervened-upon variable. without loss generality never-intervened-upon variable marginalised out. acyclicity semï\u0001 structural equation corresponding variable form letï\u0001 noise variables distributed implied \u0001\u0001pa yielding structural equations\u0017\u0001 obtained from\u0017\u0001 removing structural equation replacing occurrence right-hand side structural equations children note structural equations resulting still acyclic form thenï\u0001 construction \u0001-exact transformation ofï\u0001 proof section micromacro-level proof theorem begin deﬁning mapping interventions note surjective order-preserving therefore remains show distributions implied intervention agree corresponding distributions implied show observational setting distribution overõ implied following equations note surjective order-preserving therefore remains show distributions implied intervention agree corresponding distributions implied show consider without loss generality distribution arising performing theï\u0001-level intervention since contraction mapping follows lemma intervention inë\u0001 sequence random variables deﬁnedbyï\u0001 convergeseverywhere. thatisthereexistsarandomvariable suchthat case intervention above random variable satisﬁes following lemmata show contraction mapping ensures sequence deﬁned byï\u0001 theorem converges everywhere intervention realisation sequence limit lim\u0001࢐ý sequence elements exists. hence contraction mapping. lemma consider semï\u0001 theorem suppose linear contraction mapping. then intervention sequence converges everywhere. proof. consider without loss generality intervention", "year": 2017}