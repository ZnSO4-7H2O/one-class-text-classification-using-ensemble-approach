{"title": "Identifying Spatial Relations in Images using Convolutional Neural  Networks", "tag": ["cs.AI", "cs.CV", "cs.NE"], "abstract": "Traditional approaches to building a large scale knowledge graph have usually relied on extracting information (entities, their properties, and relations between them) from unstructured text (e.g. Dbpedia). Recent advances in Convolutional Neural Networks (CNN) allow us to shift our focus to learning entities and relations from images, as they build robust models that require little or no pre-processing of the images. In this paper, we present an approach to identify and extract spatial relations (e.g., The girl is standing behind the table) from images using CNNs. Our research addresses two specific challenges: providing insight into how spatial relations are learned by the network and which parts of the image are used to predict these relations. We use the pre-trained network VGGNet to extract features from an image and train a Multi-layer Perceptron (MLP) on a set of synthetic images and the sun09 dataset to extract spatial relations. The MLP predicts spatial relations without a bounding box around the objects or the space in the image depicting the relation. To understand how the spatial relations are represented in the network, a heatmap is overlayed on the image to show the regions that are deemed important by the network. Also, we analyze the MLP to show the relationship between the activation of consistent groups of nodes and the prediction of a spatial relation. We show how the loss of these groups affects the networks ability to identify relations.", "text": "object detection scene description pose estimation tasks commonly solved using sift features. recent years deep neural networks tremendous success diverse ﬁelds computer vision natural language processing audio developments coupled availability large quantities data high performance computing hardware gpus made remarkable performance gains possible. popular deep neural network architectures convolutional neural network substantially improved image classiﬁcation compared existing methods shown krizhevsky cnns also able achieve state-of-the-art performance many aforementioned tasks however despite success intermittent work conducted understand deep neural networks learn features input data. focus extend understanding deep networks operate looking network’s representations spatial relations objects images. spatial relations difﬁcult learn deﬁned relative positions objects image independent object standing next child sitting next chair). consider ﬁgure desired output extract relation next-to directly image represent research focuses training network classify subset spatial relations only. depending frame reference spatial relations classiﬁed three types basic deictic intrinsic network trained deictic relations relation objects speciﬁed respect viewer’s point view paper show network learns relations overlaying generated heatmap original image highlights parts image considered important identify relations. analysis experiments reveal group nodes abstract—traditional approaches building large scale knowledge graph usually relied extracting information unstructured text recent advances convolutional neural networks allow shift focus learning entities relations images build robust models require little pre-processing images. paper present approach identify extract spatial relations images using cnns. research addresses speciﬁc challenges providing insight spatial relations learned network parts image used predict relations. pre-trained network vggnet extract features image train multi-layer perceptron synthetic images dataset extract spatial relations. predicts spatial relations without bounding around objects space image depicting relation. understand spatial relations represented network heatmap overlayed image show regions deemed important network. also analyze show relationship activation consistent groups nodes prediction spatial relation. show loss groups affects network’s ability identify relations. research area knowledge graphs largely focused mining large corpora text extract entities concepts relations them. linking entities extracted images knowledge graphs reasoning received little attention. knowledge graphs dbpedia yago store entities relations form triples. certain attributes contain pictures entity described systems lack ability reason using pictures. pictures provide information used improve system’s ability perform tasks image search visual veriﬁcation visual question answering improve visual reasoning knowledge graph representation reason object affordances system tries learn object estimate human pose perform action deﬁne relative position object respect formed network higher impact ability network predict them. figure shows example image overlayed heatmap. regions important identify relation behind. following sections discuss background related work architecture used train model predict spatial relations datasets models trained observations experiments conducted. convolutional neural network feed forward layers network uses combination convolutional pooling layers fully-connected layers. common train batch input images gradient calculated average loss across batch. multiple architectures proposed classify object images alexnet vggnet inception reasons cnns effective network trained large datasets directly applied perform object recognition images different domains well used various visual recognition tasks like many architectures vggnet trained imagenet dataset network uses small receptive ﬁeld size spatial pooling layers relu activation function. fully-connected layers output layer nodes representing labels imagenet. fully-connected layers size vggnet known robust. output speciﬁc layers used describe images pipeline also utilizes output layer fc-. layer pre-trained vggnet model used experiments. manually inspecting dataset humans though perceive relative positions objects ﬁtting positions pre-deﬁned templates i.e. identify relation malinowski create spatial templates relation bi-directional fragment embedding framework associate template text triplets train model perform spatial reasoning annotate dataset spatial relations. example image ﬁgure annotated bench in-front-of wall work identify spatial relation without using bounding surrounding objects image associated annotation. show learning identify presence object relative positions objects well space useful identify spatial relation. cnns solving large number tasks growing interest understand features represented network effect various hyper-parameters used train network. zeiler create deconvolutional network show mid-level representations convolutional neural network. show features learned intermediate layers lower level abstraction initial layers higher level abstraction layers ahead. also occlude parts image understand parts important classify objects image. simoyan backpropagate gradient class score respect image pixels generate artiﬁcial image representative learned particular class. method utilized weakly-supervised object localization. long prove despite using large receptive ﬁelds cnns learn correspondence object parts. escorcia provide empirical evidence attribute centric nodes inside trained recognize speciﬁc objects. acns represents different attributes image texture like furry black/brown wooden etc. experiments reveal network recognizes aforementioned attributes even though speciﬁcally trained acns sparse distribution across layers uniform likely found layers network. also show acns corresponding certain sets attributes ablated reduces classiﬁcation accuracy objects represented attributes. another interpret network learning isolating parts image important network classify although achieved class activation mapping technique ﬁnds regions single forward pass network fully convolutional neural network without fully connected layers required. approach similarly isolate parts image considered important purpose classiﬁcation. mask region image measure entropy change characterize impact region image ablate nodes check impact relations predicted. heatmap generated even though fully connected layers present. network separately trained dataset synthetic dataset generated purpose studying network. cross entropy softmax probability label actual value label. input image modiﬁed number reasons identifying important regions image isolating particular object image etc. modiﬁed version original image using cross entropy image calculated considered baseline cross entropy). training network reduces loss predicted true label. network trained magnitude shows importance change image. larger magnitude higher likely importance. call inﬂuence introduced change ability network perform prediction. three possible conditions ablation vector. vector contains every index position except nodes need ablated value ﬁnal output layer transferred forward next layer. relu node might ﬁnal output value greater thus method ablate nodes case output greater method sufﬁciently ablates nodes case output node node impact forward computation proceeding layers. important regions parts image network paying attention classifying images particular class labels. idea artiﬁcially mask small regions image measure inﬂuence mask patch placed speciﬁc part image makes region unrecognizable like gray colored rectangular mask images non-gray colored backgrounds. consider trained network given image cross entropy create gray mask size axb. mask sequentially slid image create images image single region masked. number regions depends size experiments ﬁrst mask region present upper left corner image slide rectangular mask image without overlapping previous regions. consider overlapping regions order limit number different images generated masking region image. corresponding values used draw heatmap show inﬂuence. regions high positive inﬂuence important parts image necessary classiﬁcation certain spatial relations. postulate network looking relative position objects well identifying space objects classify images spatial relations. ﬁneness coarseness heatmaps changed modifying size mask iteration step used. another understand network learns spatial relations analyze internals architecture isolate sets nodes positive inﬂuence classiﬁcation certain spatial relation. calculated measuring change cross entropy speciﬁc node group nodes ablated ablate single node time measure change entropy. thus image test dataset inﬂuence value respect ablated node. node inﬂuence corresponding inﬂuence values relations ﬁnal output average inﬂuence node relation nodes layer highest inﬂuence spatial relation. nodes identiﬁed clusters generated relation ablated simultaneously effect classiﬁcation relation. pre-trained model -layer vggnet used. requires input standard size pixels. hence transforming image resized process completed single forward pass. vggnet performs object recognition feature vector extracted layer second fully connected layer network. vggnet features rather images used input multi-layer perceptron features extracted robust terms kinds objects detected translation rotation invariant extracted image features inputs multi-layer perceptron shown ﬁgure contains fully connected layers. mlp’s hidden layers relu activated. dropout rate softmax classiﬁer present output layer. categorical cross entropy loss function. adamoptimizer calculates gradient batch learning rate behind front images randomly selected annotation. ﬁnal dataset consists structured queries distinct spatial relations. images training images test. dataset generated using google search predeﬁned objects manually selecting sample images combining them. consists types objects present training dataset test dataset. objects object variety images dataset. example different images different images. images contain objects either rotated translated different locations image template varying background colors. combined form single image. figure shows sample images. training dataset contains images test contains images. annotated object-relationobject. background colors used test completely different used training. advantages synthetic dataset pair-wise object constraint generating images. objects annotated foreground distinct dataset many annotations non-signiﬁcant objects analyzed training images spatial relations classes correctly classiﬁed mlp. objects used testing completely separate objects synthetic dataset used training. gray rectangular mask size pixels covers section image iteratively. since re-sized pixels total images generated region masked. figures show heatmap synthetic images. scale heatmaps differs image image. regions important progressively going blue least. range scale speciﬁc image decided based maximum minimum value image. consider image ﬁgure sofa beside lamp. heat shows regions image lamp located large increase cross entropy resulting positive thus network looking relative position object classifying image beside. heatmap generated consistent even object rotated moved separate location image. network tracking relative position objects respect ﬁxed point look learned network case spatial relation. refer image ﬁgure sofa. evident heat network looking relative positions well space sofa. addition this network also learns gaps present objects always case. case behind spatial relation corresponding heat shows high places ball present single important location image concentrated ball lamp. thus case behind spatial relation network looks position object ignoring rest image. heatmaps reveal relation learned network. network trained object placed different positions image rotated. figure example object different positions orientations classiﬁed correctly. training test accuracy table show network able look relative positions objects remains unaffected translation rotation objects. figure shows heatmaps sample images. apply method discussed section iii-e. experiment analyzed training dataset likelihood extract groups nodes avoid negative inﬂuence images network misclassiﬁed. class label consider nodes total size hidden layer zeroing result maximum increase cross entropy. group three groups class label. three groups nodes group nodes affects particular spatial relation others. figures show differences cross entropy group zeroed layer respectively. group bars i.e. absolute cost difference positive cost difference negative cost difference change characterized. graphs show groups little average negative cost conﬁrming inﬂuence positive. tables show accuracy respect relation groups nodes ablated. example group average entropy change results reduction accuracy nodes utilized classifying image label above. seen group accuracy network predict beside behind reduces classiﬁcation accuracy labels remains thus clearly existence sets nodes affect particular class label. existence sets nodes evident layer rather layer fc-. existence sets nodes clearly last fully connected layer. possible reason number nodes fewer number nodes common three groups nodes more. analyzed learns spatial relations objects image. extract image features using cnns train supervised manner spatial relation classiﬁcation datasets simpliﬁed synthetic dataset. show network pays attention certain parts images classifying spatial relations network looks relative positions objects identify relation. also show existence sets nodes representing particular relation conducting extensive tests isolate single nodes inﬂuence certain relation group behaves ablated. future would like represent visual data symbolic form training network identify relations objects designing network predict subject object labels well relation label. example want image ball representation triple ﬁrst order logic also network extended generate relations multiple subject-predicate-object combinations natural images improve descriptions images. also need create larger dataset real world images train better networks spatial relations. plan image captioning datasets coco flickrk annotate images spatial relations object pairs parsing image descriptions. would like apply analysis method real world dataset. antol agrawal mitchell batra lawrence zitnick parikh. visual question answering. proceedings ieee international conference computer vision pages dalal triggs. histograms oriented gradients human detection. computer vision pattern recognition cvpr ieee computer society conference volume pages ieee deng dong socher l.-j. fei-fei. imagenet large-scale hierarchical image database. computer vision pattern recognition cvpr ieee conference pages ieee escorcia niebles ghanem. relationship visual attributes convolutional networks. computer vision pattern recognition ieee conference pages ieee girshick donahue darrell malik. rich feature hierarchies accurate object detection semantic segmentation. proceedings ieee conference computer vision pattern recognition karpathy fei-fei. deep visual-semantic alignments generating image descriptions. proceedings ieee conference computer vision pattern recognition pages karpathy joulin deep fragment embeddings krizhevsky sutskever hinton. imagenet classiﬁcation deep convolutional neural networks. pereira burges bottou weinberger editors advances neural information processing systems pages curran associates inc. yang wang mori. image retrieval structured computer vision–eccv t.-y. maire belongie hays perona ramanan dollár zitnick. microsoft coco common objects context. european conference computer vision pages springer plummer wang cervantes caicedo hockenmaier lazebnik. flickrk entities collecting region-to-phrase correspondences richer image-to-sentence models. proceedings ieee international conference computer vision pages sadeghi divvala farhadi. viske visual knowledge extraction question answering visual veriﬁcation relation phrases. proceedings ieee conference computer vision pattern recognition pages socher perelygin chuang manning potts. recursive deep models semantic compositionality sentiment treebank. proceedings conference empirical methods natural language processing pages stroudsburg october association computational linguistics. szegedy sermanet reed anguelov erhan vanhoucke rabinovich. going deeper convolutions. proceedings ieee conference computer vision pattern recognition pages zhou lapedriza xiao torralba oliva. learning deep features scene recognition using places database. ghahramani welling cortes lawrence weinberger editors advances neural information processing systems pages curran associates inc.", "year": 2017}