{"title": "Treatment-Response Models for Counterfactual Reasoning with  Continuous-time, Continuous-valued Interventions", "tag": ["stat.ML", "cs.AI", "cs.LG"], "abstract": "Treatment effects can be estimated from observational data as the difference in potential outcomes. In this paper, we address the challenge of estimating the potential outcome when treatment-dose levels can vary continuously over time. Further, the outcome variable may not be measured at a regular frequency. Our proposed solution represents the treatment response curves using linear time-invariant dynamical systems---this provides a flexible means for modeling response over time to highly variable dose curves. Moreover, for multivariate data, the proposed method: uncovers shared structure in treatment response and the baseline across multiple markers; and, flexibly models challenging correlation structure both across and within signals over time. For this, we build upon the framework of multiple-output Gaussian Processes. On simulated and a challenging clinical dataset, we show significant gains in accuracy over state-of-the-art models.", "text": "treatment effects estimated observational data difference potential outcomes. paper address challenge estimating potential outcome treatment-dose levels vary continuously time. further outcome variable measured regular frequency. proposed solution represents treatment response curves using linear time-invariant dynamical systems—this provides ﬂexible means modeling response time highly variable dose curves. moreover multivariate data proposed method uncovers shared structure treatment response baseline across multiple markers; ﬂexibly models challenging correlation structure across within signals time. this build upon framework multiple-output gaussian processes. simulated challenging clinical dataset show signiﬁcant gains accuracy stateof-the-art models. computer storage becoming cheaper observational data tracking user behavior becoming increasingly available many problem areas. medicine electronic health records contain data tracking patient’s disease progression time. common websites track usage patterns time. data cheap valuable sources learning efﬁcacy interventions. example using health record data study effects different drugs accelerate ability generate hypotheses drug responsiveness design downstream experiments discover unknown biology linked efﬁcacy similarly leverage observational data visit click patterns measure user responses interventions allowing rapidly improve experiences; e.g. bottou schnabel recent years numerous studies sought non-experimental datasets evaluating effects interventions. example westreich parametric g-formula estimate effect antiretroviral therapy time aids death observational cohort study. hong propensity score methods examine effect kindergarten retention self-perceived social health. paper focus task estimating effects setting multiple attributes measured time. example tracking kidney function physicians measure several markers—creatinine potassium levels urine output— time. timing measurements made driven whether patient’s past measurements suggest deteriorating. means markers sampled regular intervals; rather missing random further similarities individual markers change response treatment example blood urea nitrogen creatinine waste products blood ﬁltered similar rates dialysis. therefore treatment response interventions markers likely correlated. example consider three signals patient receiving treatment dialysis shown fig. show proposed model learned treatment response curves trajectories creatinine closely tied similar responses dialysis heart rate less correlated slight response treatment. wish infer shared latent structure treatment response curves multivariate longitudinal data. allows better understanding markers coupled common latent process. causal inference problem estimating effect intervention studied extensively typically effect quantiﬁed difference potential outcomes outcome treatment outcome would treatment given speciﬁc assumptions data-generating process effect intervention said identiﬁed expressed function observational data. effect determined identiﬁable challenge posit accurate ﬂexible estimation model outcome conditioned history treatment information. recent causal inference challenges bayesian additive regression trees bayesian non-parametric method become increasingly popular choice model wide success however popular outcome models cross-sectional scenarios bart naturally extend functional data. recently proposed ﬂexible bayesian non-parametric approach estimating univariate treatment response curves predicting disease trajectories. approach attempts model impact treatment time limited discrete-time treatments. consistent existing methods model treatments discrete events potentially continuous doses treatments administered discretely practice many others dialysis intravenous diuretics administered continuously period time. naturally treatments modeled continuous processes. paper propose semi-parametric bayesian framework model treatment effects multivariate longitudinal data. proposed framework makes following contributions. contrary past work uniﬁes response modeling discrete continuouslyadministered treatments. build upon linear timeinvariant systems ﬂexibly represent dynamic response physiologic signals arbitrary treatments systems generally differential equations natural intuitive representation describing intervention causes figure proposed model multivariate longitudinal data extracts estimated treatment response vertical purple lines denote start hour dialysis sessions. second data sparse irregularly sampled rather using imputation methods multiple-output gaussian processes jointly model correlated multivariate signals shared low-dimensional latent function space. multiple advantages including ﬂexibility complex variation seen within signals across individuals clinical data. however scale poorly number observations. circumvent this employ fast approximate inference algorithm using sparse variational inference techniques rest paper organized follows. discuss related work section section describe proposed model. section present experimental results simulated clinical dataset. finally concluding remarks section related work continuous-dose treatment modeling standard causal inference methods estimating treatment effects primarily focus discrete-valued discrete-time interventions. here effect intervention typically estimated single point time treatment administered. example card measures effect individual’s number years education income. studies considered effect continuous-valued treatments. instance several studies focused estimating effect treatment outcome variable function treatment’s continuousvalued dose; e.g. others estimate effect continuous-valued dose multivariate longitudinal data using generalized propensity scores. works considered continuously-administered treatments limited special cases doseresponse learning. example johnson tsiatis consider problem treatment assignment randomized dose not. case treatment administered continuously duration modeled dose effect deﬁned respect outcome ﬁxed moment time. also considers continuously-administered treatments similar modeling time treatment discontinued time-to-event random variable developing dynamic treatment regimes. approaches apply setting treatment dose ﬁxed upfront vary within duration treatment administration period. modeling irregularly-sampled multivariate longitudinal data generalized mixed-effects models widely used model multivariate longitudinal data. however models rely strong parametric assumptions thus cannot easily applied challenging data physiologic signals. several ﬂexible probabilistic approaches proposed modeling sparse irregularly sampled longitudinal data. bayesian non-parametric models based gaussian processes particularly effective modeling physiologic time series. example ghassemi multi-task schulam saria coupled hauskrecht combine state-space models gps. ﬂexible methods recurrent neural networks also used modeling multivariate longitudinal data methods require alignment measurements across signals. observations aligned imputation smoothing methods used missing observations. paper leverage multi-output jointly model multivariate physiologic signals. contrast above-mentioned methods model shared structure across signals estimate dynamic response discrete-time continuous-time treatments. methods here ﬁrst review linear dynamic systems describe applicability learning treatment response curves. develop semi-parametric approach modeling multivariate longitudinal signals shared structure treatment response curves. however response instantaneous; rather creatinine decrease slowly treatment initiated. similarly treatment discontinued effect disappear immediately; e.g. fig. observed values creatinine start increase eventually return elevated level prior treatment. capture dynamic behavior linear time-invariant systems. bottom left subplots fig. show different dose functions. middle panel shows impulse response functions three systems. convolving input different impulse functions leads varying treatment response curves shown bottom right subplots. input-output relationship dynamical systems also characterized using differential equations. consider instance differential equations second order system positive constants. impulse response system here ψijd controls degree mixing between shared signal-speciﬁc terms χijd deﬁnes direction inﬂuences magnitude response. improve interpretability estimated treatment response terms place sparsity inducing priors aijd primarily determined either shared signal-speciﬁc component. second order systems introduced section form shared signal-speciﬁc treatment response components. compute convolution treatment input signal encodes dose duration information impulse response function βij−αij priors since treatment response parameters individual-speciﬁc posit population-level prior them. enables sharing statistical strength across individuals prevents over-ﬁtting. speciﬁcally posit gaussian prior weighting coefﬁcients χijd also place log-normal priors parameters treatment functions αijd βijd further impose beta prior mixing coefﬁcient ψijd beta deﬁne ﬁxed-effects term idcit deterministic linear regression term. here vector individual-speciﬁc covariates including observation time vector regression parameters. place gaussian priors parameters baseline regression random-effects component here indicator function equals true false respectively. family impulse response functions made ﬂexible adding higher order derivatives differential equation. section describe proposed approach modeling multiple outcomes estimating dynamic treatment responses multivariate longitudinal data. model disease trajectory every signal patient follows model described consists three major components treatment response ﬁxed-effects randomeffects components. treatment response component responses treatment type denote response signal treatment type given treatment input signal time example treatment inputs shown left column fig. ﬁxed-effects random-effects components together denote mixed-effects component model natural evolution signal independently treatments. example aging adults higher baseline creatinine levels. further creatinine drift upward left untreated ﬁxed-effects term speciﬁc signal whereas random-effects term captures correlations across within signal. finally assume additive gaussian noise term measures kidney function similarly affected dialysis. however responses differ vital signs heart rate. capture differences posit total treatment response signal mixture terms response shared across signals response speciﬁc particular random-effects component comprised latent function shared across signals signal-speciﬁc latent function every physiologic signals expected strongly correlated; e.g. creatinine heart rate blood pressure. shared latent component captures common structure correlations across signals. further marker unique structure cannot modeled signal-speciﬁc structure modeled vid. individual-speciﬁc denote {χijd ψijd αijd βijd id}. global parameters denoted parameters prior distributions shared across individuals; take maximum posteriori approach compute point-estimates model parameters. treat regularization terms. individual observe longitudinal samples treatment inputs. computing log-likelihood individual requires integrating latent stochastic function random effects component main bottleneck learning inference model fid. requiring covariance matrix inversion inference scales cubically number observations. reduce computational complexity develop learning inference algorithms model using sparse variational techniques here κid∀i mixing coefﬁcients shared latent function drawn i.e. prior zero mean kernel function nidnid number observations signal signal-speciﬁc component anlatent function prior id). contrast shared latent function latent functions drawn independently signalspeciﬁc kernel function. mat´ern-/ kernel latent function variance length-scale free parameter shared signal-speciﬁc latent functions). variance since scale latent function using mixing coefﬁcients learning overall objective function model additive lower bound elboi. stochastic gradient techniques learning. iteration algorithm randomly select mini-batch individuals update local parameters keeping global parameters ﬁxed. compute gradients elbo mini-batch respect perform step stochastic gradient ascent update global parameters. adagrad stochastic gradient optimization. repeat process either relative change global parameters less threshold maximum number iterations reached. section evaluate proposed model using datasets. first perform simulation study show presence known shared structure proposed model recover true decomposition. order this construct synthetic dataset mimics conditions expect clinical data. then demonstrate figure decomposition disease trajectory synthetic patient. show observations total ﬁt’s separation mixed-effects treatment response components signal. show estimated shared signal-speciﬁc treatment response components true treatment response curves used generate data. model accurately represent complex multivariate longitudinal data compare model stateof-the-art baselines task predicting disease trajectories treatment challenging publicly available clinical dataset. also assess model exploratory tool discovering shared structure data sort validating learned treatment responses clinical knowledge. simulation study data generate synthetic dataset consistent settings typically encountered clinical observational studies. generated sparse irregularly sampled observations marker; observation times drawn poisson process. speciﬁcally generated synthetic dataset consisting patients irregularly-sampled longitudinal signals. simulate unalignment signals every marker patient ﬁrst randomly chose number observations poisson distribution mean generated observation times poisson process rate assume signal consists mixed-effects treatment response component. generated signals shared mixed-effects components. particular signals opposite ﬁxed-effect trends similar rates shared random-effect component drawn patient computed mixedeffects component using signal-speciﬁc coefﬁcients shared patient-speciﬁc kernel length-scale variance assume patients population similar ﬁxed-effect components; draw signal figure plot estimated true shared signal-speciﬁc treatment response functions. signal clinical data treatments affect multiple physiologic markers whereas others change marker. simulate setting consider treatments continuous shared effect signals discrete treatment signal-speciﬁc effect ﬁrst marker. generate treatment treatment type treatment type shared effects signals treatment administered continuously time interval dose treatment hand signal-speciﬁc effect marker given discretely times dose train model trajectories patients setting maximum number iterations optimization mini-batch size results evaluate ability proposed model disease trajectories fig. show decomposition model’s patient. fig. shows signals observations total ﬁt’s separation mixed-effects treatment response components. purple vertical lines correspond treatment type shaded cyan regions indicate duration treatment type plots qualitatively show estimated signal values closely disease trajectory given treatments. note proposed model able uncover treatment type affects signal result learns shared effects. rather effect signal correctly captured using signal-speciﬁc component. analyze correctness decomposition fig. plot estimated shared signal-speciﬁc treatment response components true treatment response curves used generate data. model learn correct treatment responses. further compare true estimated parameters treatment functions patients using plots fig. ﬁgure shows model closely recover true since relationship quantiles distributions estimated true values linear dataset apply evaluate model mimic clinical database consists electronic health records patients beth israel deaconess medical center. particular examine effect types dialysis continuous renal replacement therapy intermittent hemodialysis dialysis used ﬁlter blood place kidneys patients suffering acute kidney injury crrt types hemodialysis differ administration typically administered times week session lasting hours whereas crrt must administered typically given hours crrt used alternative signiﬁcant differences effect elevated levels waste products like blood urea nitrogen creatinine indicate poor kidney function reduced course dialysis. similarly dialysis used regulate concentration electrolytes like potassium calcium blood. dialysis sometimes also indirectly affects signals primarily controlled kidneys; e.g. reduce blood pressure causing hypotension therefore chose model creatinine primary measures kidney function potassium calcium since dialysis-regulated solutes blood blood pressure heart rate signals affected dialysis typically primary factors interest prescribing dialysis. included acute kidney injury patients least measured values signal received treatments dialysis resulting relevant patients. every patient ﬁrst observed marker trajectories training rest prediction. average patient training observations test observations signal. training test regions average lengths days respectively. optimization local global variables. learning rate maximum number iterations global optimization step respectively. local optimization individual terminated relative change objective function less maximum number iterations reached. also regularization terms determined held-out training data subset patients. found model performance highly sensitive choice regularization terms within reasonable range. baselines compare proposed model’s ability predict marker trajectories state-of-the-art regression time series prediction methods bayesian additive regression trees long short-term memory baselines train separate models signal binning data hour intervals. nonempty intervals take average value. observations interval take value previous bin; i.e. last-observation-carriedforward imputation. midpoint time since last treatment dose last treatment marker value features. train bart lstm features previous bins covariates current value marker outcome. determine method cross-validation. methods trained one-step ahead prediction. predictions longer step model’s predicted value feature predicting next step. performance criterion compute root mean square error normalized standard deviation signal average across markers. also performed non-parametric bootstrap sample size test measure statistical signiﬁcance results. quantitative results fig. shows nrmse standard error prediction horizons days method. proposed method achieves better nrmse bart lstm. further rate increase nrmse function prediction horizon smaller proposed method baselines. neither bart lstm naturally model treatment response. especially apparent subset patients received treatment test region prediction horizon days patients model better bart better lstm. qualitative results order demonstrate potential model exploratory analysis tool examine detail latent treatment response structure uncovers kidney function data. fig. show model’s learned mixed-effects treatment response decompositions physiologic trajectories patients patient receiving patient receiving crrt proposed model overall trajectories signals well. learned decompositions qualitatively match clinical knowledge dialysis. types dialysis used lower creatinine levels blood. seen patients proposed model learns negative treatment response curve further observed values creatinine return elevated values treatment discontinued would clinically relevant. order quantitatively compare relative impact treatment type deﬁne criterion compute maximum effect every signal since order systems used treatment response components normalized maximum amplitude estimated treatment response curves bounded volume treatment input signal multiplied corresponding coefﬁcient thus compute iijd χijd individual since dialysis primarily used managing waste products like creatinine electrolytes like calcium potassium estimated effect crrt signals higher estimated effects vital signals. matches model learns average across population maximum treatment effect dialysis creatinine potassium calcium greater heart rate blood pressure indirectly affected dialysis. qualitatively fig. dialysis decreases creatinine. consistent average signals negative. maximum effect signiﬁcantly less using one-sided t-test p-value though signiﬁcant effect creatinine .-level p-value paper propose ﬂexible bayesian semiparametric approach modeling multivariate outcomes time. proposed method provides uniﬁed model continuous response time highly ﬂexible dose functions this model treatment response curves using linear time-invariant dynamical systems. further approach enables learning structure response function shared across multiple signals. finally using simulated real datasets show signiﬁcant gains performance predicting outcomes. worth noting potential outcomes framework estimation causal effect precluded need justify generally untestable assumptions e.g. schulam saria assumptions needed continuoustime potential outcomes. conditions hold proposed method provides highly ﬂexible accurate means jointly modeling multivariate potential outcomes. further approach relies regularization decompose observed data shared signal-speciﬁc components need methods constraining model order guarantee posterior consistency sub-components model.", "year": 2017}