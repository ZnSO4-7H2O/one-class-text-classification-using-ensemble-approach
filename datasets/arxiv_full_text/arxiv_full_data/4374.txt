{"title": "Recurrent Convolutional Networks for Pulmonary Nodule Detection in CT  Imaging", "tag": ["stat.ML", "cs.CV"], "abstract": "Computed tomography (CT) generates a stack of cross-sectional images covering a region of the body. The visual assessment of these images for the identification of potential abnormalities is a challenging and time consuming task due to the large amount of information that needs to be processed. In this article we propose a deep artificial neural network architecture, ReCTnet, for the fully-automated detection of pulmonary nodules in CT scans. The architecture learns to distinguish nodules and normal structures at the pixel level and generates three-dimensional probability maps highlighting areas that are likely to harbour the objects of interest. Convolutional and recurrent layers are combined to learn expressive image representations exploiting the spatial dependencies across axial slices. We demonstrate that leveraging intra-slice dependencies substantially increases the sensitivity to detect pulmonary nodules without inflating the false positive rate. On the publicly available LIDC/IDRI dataset consisting of 1,018 annotated CT scans, ReCTnet reaches a detection sensitivity of 90.5% with an average of 4.5 false positives per scan. Comparisons with a competing multi-channel convolutional neural network for multi-slice segmentation and other published methodologies using the same dataset provide evidence that ReCTnet offers significant performance gains.", "text": "computed tomography generates stack cross-sectional images covering region body. visual assessment images identiﬁcation potential abnormalities challenging time consuming task large amount information needs processed. article propose deep artiﬁcial neural network architecture rectnet fully-automated detection pulmonary nodules scans. architecture learns distinguish nodules normal structures pixel level generates three-dimensional probability maps highlighting areas likely harbour objects interest. convolutional recurrent layers combined learn expressive image representations exploiting spatial dependencies across axial slices. demonstrate leveraging intra-slice dependencies substantially increases sensitivity detect pulmonary nodules without inﬂating false positive rate. publicly available lidc/idri dataset consisting annotated scans rectnet reaches detection sensitivity average false positives scan. comparisons competing multi-channel convolutional neural network multislice segmentation published methodologies using dataset provide evidence rectnet oﬀers signiﬁcant performance gains. lung cancer second common cancer women europe united states second common malignancy cases disease common cause cancer-related death deaths alone survival disease second lowest across malignancies surviving year post-diagnosis surviving years post-diagnosis great part late diagnosis commencement appropriate management plans. later disease diagnosed managed poorer outcome patient hence requirement early accurate intervention possible. recent advances computed tomography imaging resulted early diagnosis disease instance reported detection rate lung cancer using times higher compared chest radiography scanners produce cross-sectional images must individually evaluated short time. despite diagnostic beneﬁts provided imaging increased workload required read hundreds slices exam lead larger number mistakes made. existing studies shown rate erroneous interpretation increases radiologist performs examinations order address issues last years burst research activity around development computer-aided diagnosis systems pulmonary nodule detection using imaging adoption systems facilitate reading proved signiﬁcantly improve sensitivity detect nodules diameter larger bogoni sahiner large number recently published image analysis approaches pulmonary nodule detection using imaging employ machine learning core share common two-stages process first region generating mechanism deployed produce large number candidate regions high likelihood containing pulmonary nodules. candidate regions typically identiﬁed using intensity-based and/or morphology-based imaging features often rely upon prior assumptions expected morphology nodules. second stage feature vector extracted candidate regions used train statistical classiﬁer attempt reduce number false positives resulting ﬁrst stage. main limitation two-stage approach inaccurate assumptions underlying morphological appearance characteristics anatomical structures result sensitivity rate ﬁrst stage. example commonly assumed nodules spherical appearances whereas wider variety abnormal anatomical structures broader morphological variety fact observed clearly training classiﬁer imaging features suﬃciently discriminative result detection performance. article explore feasibility deep artiﬁcial neural networks pulmonary object detection. recent years deep learning emerged powerful approach learning imaging representations directly large volumes data thus dispensing need hand-engineer predictive features convolutional neural networks shown able learn hierarchically organised high-level features directly images yield state-of-the-art performance image classiﬁcation object detection semantic segmentation tasks. object detection representational power convolutional feature maps exploited generate region proposals guide search object interests thereby avoiding exhaustive sliding window searches across images semantic segmentation tasks dilated convolutions utilized systematically expand receptive ﬁeld convolutional layers aggregate contextual information without losing resolution methods shown promising results natural images objects detected segmented typically well-deﬁned suﬃciently large compared entire image. however majority nodule volumes typically cover less lung area often striking similarity nodular normal structures seen slices e.g. nodules attached normal pulmonary structures pleura. work mimic reading process carried radiologists would typically explore slices stack draw inferences likely presence nodule picking changes radiological appearance adjacent slices. need integrating inter-slice information nodule detection characterisation often emphasised literature illustrative example this figure shows four adjacent cross-sectional slices extracted thoracic scan. images contain pulmonary nodule whose morphological characteristics diﬀerentiate surrounding normal tissue. hypothesis learning imaging features capture inter-slice spatial correlations eventually introduce performance gains nodule detection. order address problem propose artiﬁcial neural network combines representational power cnns capability learn dependencies sequential data typical recurrent neural networks rnns achieved tremendous success solving challenging sequential problems like machine translation speech recognition recently multi-dimensional rnns shown state-of-the-art performance scene lebeling images volumetric image segmentation modeling distribution natural images hybrid cnn-rnn architecture propose called rectnet operates pixel level combines convolutional layers able learn discriminative features scans recurrent layers facilitates learning anatomical dependencies across adjacent images entire stack cross sectional images. such rectnet learns withinacrossimages features thus taking full account anatomical context pixel. training carried end-to-end convolutional recurrent components learned jointly. three-dimensional probability maps generated output indicating likelihood nodule present certain areas. best knowledge hybrid system never utilized object detection imaging. figure internal anatomical structure pulmonary nodule shown four transverse consecutive sections scan. morphological characteristics nodule change gradually across slices. study used imaging data generated lung image database consortium image database resource initiative lidc/idri database result joint eﬀort seven academic institutions eight medical imaging companies supporting development training evaluation methods lung cancer detection diagnosis. february database contained scans acquired using single multi-slice scanners slice thickness ranging reconstruction interval ranges in-plane pixel size ranges scan provided along annotations independently generated four experienced radiologists aﬃliated diﬀerent institutions. complete outlines nodules diameter obtained alongside radiological characteristics. variability nodule size likely depend several factors characteristics nodule’s attenuation location scan acquisition parameters quality segmentation inter-scan inter-reader variability figure illustrates variability number axial slices scan nodule size lidc/idri database. initial blinded review radiologist read scan independently followed unblinded session radiologist re-examined figure variability nodule size number axial slices scan lidc/idri database frequency distribution number axial slices scan frequency distribution nodule volume size cumulative frequency distribution number axial slices scan cumulative frequency distribution nodule volume size cases upon disclosure reports generated readers. varying level disagreement among radiologists observed several ﬁndings unblinded reading phase forced consensus imposed ﬁnal review. purpose study designate voxel belong nodule voxel falls within contours drawn least four radiologists. ings subtlety likelihood malignancy scale subtlety score refers diﬃculty detecting nodules visual inspection only lower scores indicating greater diﬃculty. malignancy score obtained taking account patient’s smoking history lower scores indicate smaller likelihood malignancy. experiments ﬁrst averaged subtlety malignancy ratings across four radiologists grouped scores three classes nodule labelled medium high malignancy depending section details proposed neural network architecture. section describe preprocessing algorithm segmentation lung area. although strictly necessary step performed study exclude portions images expected present pulmonary nodules. level preprocessing help reduce number false positives keep computational cost training manageable. section detail procedure followed prepare training validation testing datasets used experiments presented section architectural components deep neural network rectnet presented section along alternative architecture solely using convolutional layers comparative purposes. output architectures consists three-dimensional probability maps indicating likelihood voxel belongs nodular region. finally section propose post-processing procedure clustering high-probability voxels spatially close homogeneous regions forming candidate nodules. scans initially pre-processed order identify extract lung areas used input training neural network described section scan database axial slices containing lungs represented tensor cross-sectional slice internal anatomy lungs relevant body parts depicted number slices scan depends scan index varies minimum maximum since intensity original slices proportional tissue density lung areas segmented thresholding-based region ﬁlling strategy various steps strategy illustrated figure pixel intensity lung tissue varies approxused remove non-lung regions thresholding. morphological dilation operation applied binary mask form binary mask includes lung area pleural layer. binary mask applied original slice. results robust segmentation lungs. ﬂood operation performed slice remove non-lung regions left thresholding resulting binary mask. finally morphological dilation operation applied form binary mask includes lung area pleural layer juxtapleural nodules found. objective build classiﬁer discriminates voxels belonging normal vascular tissue belonging nodular areas. purpose need training dataset consisting examples representative anatomical areas. making available voxels computationally feasible classes highly unbalanced overall approximately billion voxels representative normal tissue million voxels nodular areas. chosen follow sampling strategy whereby smaller balanced number voxels pre-selected segmented lung areas. illustrated figure slice apply uniform sampling grid sampling distance along directions taken times in-plane pixel length corresponding scan. using grid average sample voxels slice. sampled voxel slice associated corresponding binary class label voxels belonging nodule otherwise equals voxels fall within nodule ground truth sampled randomly higher spatial resolution order explore learn thoroughly anatomical characteristics. order capture local anatomical context around given voxel build stack small rectangular patches centered around spanning ﬁxed number axial slices slice containing coordinates. stack taken represent context surrounding voxel process illustrated figure experiments presented taken yielding total slices stack; found optimal application. furthermore strategies implemented build augmented examples view preventing overﬁting increasing network’s ability generalise unseen examples. first adopted multi-scale approach zeiler fergus represent anatomical context around voxel diﬀerent scales. achieved taking patches diﬀerent sizes i.e. larger patches subsequently scaled match smaller size. moreover previous work ciresan augmented training dataset creating examples existing ones. achieved simultaneously ﬂipping rotating patches within stack. resulting training dataset consists figure uniform sampling grid j-th axial slice. points correspond sampled voxels lung area; sampled voxel j-th axial slice extract image patches slices slices j-th slice including central sharing coordinates; resulting image stack containing contextual information target voxel. section introduce rectnet architecture illustrated figure initially component learns representation image patch individually taken within stack. component consists sequence convolutional max-pooling layers neuron convolutional layer receives information subset input image receptive ﬁeld. result neuron learns detect particular pattern local region input image. local connectivity captures local substructure preserves topology input image addition local connectivity convolutional layer also imposes groups neurons called feature maps share identical weight values. weight sharing across groups neurons reduces number free parameters thus increasing generalization ability network output values neurons m-th feature convolutional layer consists several feature maps rich variety features extracted location input image. role max-pooling layer component reduce dimensionality feature maps achieved retaining maximum value within non-overlapping sub-region prove generalization performance selecting superior invariant features component rectnet obtained stacking convolutional max-pooling layers thus creating multi-layer output module provides high-level representation individual patch. however learning representations independently optimal pulmonary nodules would normally span varying number axial slices resulting spatial dependencies leveraged learn better features. order address aspect output passed lstm component. component memory cell modulated gating scheme determining amount information entering/leaving cell. memory cell allows network learn forget previous hidden states update hidden states given information. context role memory cells selectively preserve amount information extracted image patch within entire stack order capture shortlong-range interdependencies. lstm neurons undergone many variations since interest. cnns feature extraction; stack lstm layers composed lstm neurons learning anatomical dependencies across adjacent image patches; output last lstm layer concatenated passed input fully connected multi-layer perceptron predicts voxel label. internal state forget gate controls contribution ccj− gate selectively prevent current memory cell propagate information previous image patches representations vcj−l stored previous memory cells ccj−l. input modulation gate represents input information could enter memory cell modulated input gate. context represents information image patch representation could stored eﬀect memory cell lstm neurons sequence. property lstm gating scheme independently read store delete information memory cell allows rectnet attend speciﬁc patches within stack downgrading importance others. results mechanism able learn complex interdependencies across adjacent image patches potential improve overall classiﬁcation performance demonstrated section following principle deeper model eﬃcient representing functions shallow lstm layers stacking other. expect higher lstm layer help capture complex dependencies input sequence. lstm components parameterization across mapping representation sequence forcing model learn generic dependencies consecutive image patches. strategy prevents parameter size growing proportion maximum number adjacent image patches. output neuron last lstm layer concatenated single vector obtain representation whole input sequence. representation passed input multi-layer perceptron consisting hidden layers; produces higher-order representation easily separable diﬀerent classes. activation m-th figure long short term memory neuron consisting memory cell. gating mechanism controls information across entire sequence independently reading writing erasing contents memory cell. represents non-linear activation function i-th unit vector connection weight unit unit ﬁrst hidden layer. connection weights hidden layers denoted general form parameterized maps concatenated sequence lstm neurons outputs ﬁxed detection nodules unseen scan carried three steps. first segment lungs using segmentation algorithm described section rather classifying voxels contained lung area sample subset voxels whilst ensuring achieve enough coverage detect small nodules. experiments used uniform sampling strategy described section sampling distance times in-plane pixel length corresponding scan grid directions. candidate voxel stack rectangular patches generated described section passed rectnet classiﬁcaﬁnal post-processing step candidate nodules generated probability maps. first ﬁlter sampled voxels assigned nodule probability less remaining voxels voxel’s coordinates. identify clusters spatially contiguous voxels generate candidate nodules. order this introduce notion voxels’s neighbourhood. given voxel neighbourhood n{ai} contains voxels directly adjacent direction randomly selected voxel adds cluster cluster expanded adding voxels n{ai} well neighbours; procedure continues iteratively voxels added cluster cannot increased. figure provides illustration process dimensions. order detect clusters figure sequence consecutive axial slices containing lung area cross-sections nodule circled red; corresponding probability maps generated rectnet; corresponding probability maps generated cnn. observed rectnet assigns high probability localized regions whilst maps produced result larger number false positives. number voxels classiﬁcation probabilities range prefer remove groups voxels contribute lowering average probability within cluster increasing variance. accomplished stratifying voxels within cluster according classiﬁcation probabilities. accordingly apply mode-seeking non-parametric procedure mean shift algorithm gaussian kernel mode identiﬁed algorithm compute average classiﬁcation probability. within cluster modes average probability succeeding given threshold merged treated potential candidate nodule voxels discarded. parameter controls sensitivity rate. anatomical structures healthy nodular lung areas characterised processing multiple adjacent slices. section propose alternative simpler convolutional network without lstm components also learn image representations leveraging information across multiple slice. similar fusing strategies utilized diﬀerent contexts e.g. video classiﬁcation chemotherapy response prediction multi-slice imaging multi-channel architecture used benchmark experiments provides means evaluate beneﬁts adding recurrent layers mechanism model inter-slice dependencies. fuses channels ﬁrst convolutional layer. information across entire sequence. feature ﬁrst convolutional layer obtained convolving image patch within passing element m-th feature ﬁrst convolutional layer encloses information local anatomical area lung depicted across adjacent image patches xcs. weight matrices feature learned order build library low-level features describe anatomical dependencies within image patch well across multiple adjacent image patches. section provide implementation details rectnet competing multi-channel cnns. introduce following notation call input channels convolutional layer ﬁlters output units layer softmax function. architecture fully trained softmax function removed lstm components placed directly layer pretrained cnns. lstm neuron units layer parameters competing multi-channel convolutional layers max-pooling layers output last max-pooling layer ﬂattened passed input hidden layers size units respectively. ﬁnal number parameters rectnet respectively. architectures trained randomly selected scans tested scans lidc/idri database. remaining scans used validation order tune network parameters. activation functions rectiﬁed linear units momentum used training initial learning rate halved training. momentum coeﬃcient remains stable training. training took days using single nvidia card. processing scan takes average minutes depending size total number sampled voxels ranges thousand. code based torch library supports computing table summaries performance results proposed neural network architectures alongside analogous performance metrics reported previous published studies using lidc/idri dataset. report sensitivity false positives scan number training test scans. generally desirable reach high sensitivity nodules identiﬁed high level agreement readers architectures report nodules conﬁrmed radiologists. short overview competing methodologies order. system developed messay initially identiﬁes segments candidate nodules combining intensity thresholding morphological features area volume circularity sphericity nodule candidates. second stage candidate region represented number imaging features quantifying geometry intensity gradient intensity. linear quadratic classiﬁers used identify nodules resulted sensitivity fps/scan nodules mean curvature feature combined nodule vessel enhancement ﬁlters deployed initially identify nodule candidates. second stage neural network classiﬁer trained invariant morphological features describing geometry nodule candidates reached sensitivity average fps/scan nodules golosio used multi-threshold surface triangulation ﬁrst identify nodule candidates. second stage several features volume roundness maximum density mass principal moments inertia extracted nodule candidates provided inputs ﬁxed-topology artiﬁcial neural network. obtained sensitivity fps/scan nodules torres algorithm deployed segment nodule candidates; shape intensity features extracted used inputs neural network classiﬁer achieving sensitivity fps/scan nodules teramoto fujita cylindrical ﬁlter used initially identify enhance nodule candidates. second stage features quantifying shape enhanced nodule candidates calculated used inputs classiﬁer achieving sensitivity fps/scan nodules diameter results table suggest performance rectnet compares well methods terms sensitivity given rates. particular rectnet reaches detection rate fps/scan lowering rate scan yields sensitivity. compared simpler architecture rectnet achieves higher identiﬁcation rate lower rate fps/scan; figure also noted that exception torres scans used validate system used largest validation compared previous studies. clearly exact comparisons performance metrics across studies cannot easily made number reasons. first size nature training test dataset often diﬀerent. instance scans available lidc database time ﬁrst studies published cases torres object detection algorithm trained using cases lidc/idri remaining taken sources; performance tested lidc/idri scans. noted detection targets training table report detection sensitivity rectnet subtlety malignancy classes. expected sensitivity rate achieved rectnet increases proportionally subtlety malignancy scores. easy-subtlety nodules detected higher sensitivity compared medium-subtlety class nodules detected sensitivity diﬃcult-subtlety class nodules detected lower sensitivity high malignancy nodules rectnet achieves sensitivity fps/scan. nodules medium malignancy identiﬁed sensitivity nodules malignancy detected sensitivity fps/scan. figure illustrates froc curves rectnet subtlety malignancy classes. figure provides examples probability maps generated rectnet cnns adjacent slices. observed here models able place high probability voxels falling regions containing nodules high-probability voxels typically form spatially homogeneous clusters. however yields substantially higher rate compared rectnet. figure shows examples individual slices containing pulmonary nodules rectnet able successfully detect. examples nodules missed rectnet given figure cases appear contrast others particularly diﬃcult figure froc curves showing performance rectnet cnns scans lidc/idri. expected nodule detection performance rectnet cnns decreases lower values fps/scan. remarkably rectnet achieves sensitivity fps/scan approximately sensitivity achieved cnn. detect small size fact nodules attached normal pulmonary structures. selected example lung abnormalities detected rectnet false positives illustrated figure figure respectively. first attempts cnns components larger systems nodule detection chest radiographs date back mid-nineties however early networks shallow. recently deep residual networks designed ease gradients backpropagation proposed identify nodules directly chest radiographs pulmonary figure froc curves rectnet cnns malignancy subtlety scores. general rectnet outperforms cnns. also detection rate cnns decreases faster compared detection rate rectnet lower values fps/scan. nodule detection using imaging cnns recently used feature extractor within larger system work upon identifying nodule candidates using traditional image analysis techniques selected image patches extracted sagittal coronal axial plane centred every possible location candidate regions used inputs pre-trained cnns extract imaging features; support vector machines used ﬁnal classiﬁcation task. medical applications cnns using three orthogonal patches utilized detection lymph nodes polyps scans lstms’ ability explore context voxel also recently proposed medical image segmentation using fully-volumetric images outside medical imaging arena combination cnns rnns explored represent video sequences implicitly learn spatio-temporal features video recognition description development rectnet number alternative architectural modiﬁcations training methods tested result substantial improvements. implemented deterministic attention mechanism somewhat similar approach described bahdanau order learn weighted lstm outputs input mlp. rationale introduce additional mechanism automatically down-weight importance certain image patches within input sequences. however modiﬁcation yield substantial improvements performance indicating gates lstm neurons able attend speciﬁc parts input sequence ignoring others independently reading writing erasing content memory cells. furthermore determine whether pre-training components without additional tuning suﬃcient trained lstms parameters using inputs ﬁxed-length representation pre-trained layers. approach gave lower performance compared tuning thus demonstrating importance end-to-end training. time also assessed impact lstm layers. -layer architecture reported resulted higher performance compared single layer demonstrating adding depth context eﬀect regularisation tested dropout mechanism applied non-recurrent connections lstm architecture previous studies dropout found reduce overﬁtting preventing lstm units co-adaptations however case strategy improve performance substantial way. finally experimented adaptive sampling strategy automated selection training voxels scans directly training time. starting uniform sampling grid training periodically increased sampling density addition certain number voxels associated high prediction errors. rationale boost generalization ability model training dynamically increasing number input data points appeared particularly diﬃcult classify. however experiments adaptive sampling strategy improve performance compared uniform sampling. study presented deep neural architecture learns identify anatomical objects interests scans. rectnet tested challenging task nodule identiﬁcation thoracic scans using large publicly available dataset achieved detection sensitivity generally higher previously proposed methodologies. found architecture also outperforms competing multi-channel thus indicating important role played recurrent components used rectnet. results suggest lstm layers enable better synthesize anatomical information across adjacent slices eventually resulting improved discrimination ability. besides application presented here proposed architecture suﬃciently ﬂexible used object detection tasks involving diﬀerent imaging modalities e.g. magnetic resonance imaging positron emission tomography characterised inter-slice dependencies. network trained end-to-end image patches. main requirement availability suﬃciently larger training database otherwise assumptions made objects interest underlying image modality. clearly architectural choices made application always optimal would need reconsidered. particular adjacent slices represent anatomical context voxel might always yield best performance. future work would like develop extension automatically identify much context required training voxel i.e. many adjacent slices included during training. also planning develop attention mechanism using reinforcement learning automatically identify portions scan would contain relevant information thus removing need perform initial lung segmentation process.", "year": 2016}