{"title": "Visual Explanations From Deep 3D Convolutional Neural Networks for  Alzheimer's Disease Classification", "tag": ["cs.CV", "cs.AI", "cs.LG", "stat.ML"], "abstract": "We develop three efficient approaches for generating visual explanations from 3D convolutional neural networks (3D-CNNs) for Alzheimer's disease classification. One approach conducts sensitivity analysis on hierarchical 3D image segmentation, and the other two visualize network activations on a spatial map. Visual checks and a quantitative localization benchmark indicate that all approaches identify important brain parts for Alzheimer's disease diagnosis. Comparative analysis show that the sensitivity analysis based approach has difficulty handling loosely distributed cerebral cortex, and approaches based on visualization of activations are constrained by the resolution of the convolutional layer. The complementarity of these methods improves the understanding of 3D-CNNs in Alzheimer's disease classification from different perspectives.", "text": "approaches give diagnosticians better understanding behaviors d-cnns provide greater confidence integrating automated alzheimer’s disease diagnostic systems. summary contributions study follows propose hierarchical image segmentation based approach sensitivity analysis d-cnns discriminate importances homogeneous brain regions different levels alzheimer’s disease classification. extend state-of-the-art approaches explaining cnns natural image classification images track spatial attention d-cnns predicting alzheimer’s disease. compare developed approaches qualitatively examining visual explanations generated. also conduct quantitative comparisons ability localize important parts brain diagnosing alzheimer’s disease. rest paper organized follows. section surveys related work study. section describes methods development data experimental setup. section presents qualitative quantitative comparisons proposed methods. section presents study conclusions. related work works closely connected study divided three parts d-cnns alzheimer’s disease classification brain segmentation visualizing understanding cnns natural image classification. major methods using convolutional neural networks alzheimer’s disease classification brain scans. uses d-cnns automatically extract generic features mris build classifiers trains d-cnns end-to-end manner takes scans labels input approaches achieve comparable performance user control first method thus understand better. latter needs little input humans easier use. brain segmentation fundamental problems neuroimaging brain segmentation building block many alzheimer’s disease diagnosis methods. semantic segmentation methods freesurfer enable brain volume calculations scans alzheimer’s disease subjects unsupervised hierarchical segmentation methods detect homogeneous regions separate coarse finer levels providing flexibility multilevel analysis one-level semantic segmentation abstract develop three efficient approaches generating visual explanations convolutional neural networks alzheimer’s disease classification. approach conducts sensitivity analysis hierarchical image segmentation visualize network activations spatial map. visual checks quantitative localization benchmark indicate approaches identify important brain parts alzheimer’s disease diagnosis. comparative analysis show sensitivity analysis based approach difficulty handling loosely distributed cerebral cortex approaches based visualization activations constrained resolution convolutional layer. complementarity methods improves understanding d-cnns alzheimer’s disease classification different perspectives. introduction years medical informatics researchers pursued data-driven methods automate disease diagnosis procedures early detection many deadly diseases. treatment alzheimer’s disease become sixth leading cause death united states conditions could benefit computeraided diagnostic techniques. particular challenge alzheimer’s disease difficult detect early stages mental decline begins. medical imaging holds promise earlier diagnosis alzheimer’s disease magnetic resonance imaging computed tomography positron emission tomography scans contain information effects alzheimer’s disease brainâăźs structure functioning. analyzing scans time consuming doctors researchers scan contains millions voxels. deep learning systems potential solution processing medical images automatically make diagnosing alzheimer’s disease efficient. convolutional neural networks taking brain scans disease labels input trained end-to-end reported performance traditional diagnostic methods alzheimer’s disease classification however process d-cnns arrive conclusions lacks transparency cannot straightforwardly provide reasoning explanations human experts diagnosis. therefore difficult human practitioners trust systems evidence-centered areas like medical research. goal study break black d-cnns alzheimer’s disease classification. particularly develop techniques produce visual explanations indicate d-cnn’s spatial attention brain scans making predictions. explain superior image classification performance dcnns researchers incorporate spatial structure convolutional layer visualize discriminate object activation maps sensitivity analysis another popular method because subject architectural constraints cnns. lime local interpretable model-agnostic explanations regression-based sensitivity analysis approach examines perturbed superpixels make results interpretable. perturbed superpixels could learned semantically meaningful methods create spatial heatmap visual explanation indicates focused make predictions. extended alzheimer’s disease classification. method section describe methods produce visual explanations predictions alzheimer’s disease brain scans deep convolutional neural networks first summarize deep learning models deploy alzheimer’s disease classification task. then present brain data study describe data experiments. finally introduce three approaches develop explaining d-cnns sensitivity analysis ultrametric contour class activation mapping gradient-weighted class activation mapping architecture deep convolutional neural networks alzheimer’s disease classification study based network architectures proposed korolev al.. particularly types d-cnns built classifying brain scans alzheimer’s disease cohort normal cohort design ideas types d-cnns rooted successful natural image classification models specifically vggnet deep convolutional networks resnet deep residual networks deep convolutional networks vggnet stacks many layer blocks containing narrow convolutional layers followed pooling layers. deep convolutional network alzheimer’s disease classification direct application idea brain scans. contains four blocks convolutional layers pooling layers followed fully connected layer dropout layer batch normalization layer another fully connected layer softmax output layer produce probabilities disease alzheimer’s disease cohort normal cohort full network architecture d-vggnet visualized figure optimize model parameters adam optimizer used learning rate batch size training epochs. two-class cross-entropy calculated probabilities output softmax layer ground-truth labels used loss functions. deep residual networks residual network important building block state-of-the-art natural image classification deep residual networks alzheimer’s disease classification prove effectiveness domain. deploy important type d-cnn study explain predictions. specifically sixresidual-block architecture built. residual block consists convolutional layers filters batch normalization layer rectified-linear-unit nonlinearity layer them. skip connections residual block element-by-element following residual block explicitly enabling following block learn residual mapping rather full mapping. eases learning process deeper architectures results better performance. full architecture d-resnet depicted figure optimization nesterov accelerated stochastic gradient descent used. optimization parameters learning rate batch size training epochs. loss function d-vggnet two-class cross-entropy function used. data experiment setup brain scans alzheimer’s disease neuroimaging initiative used study. specifically used data \"spatially normalized masked n-corrected images\" category train d-vggnet d-resnet models classify scans alzheimer’s disease cohort normal cohort brain scan tensor intensity values size subject could scan database avoid potential information leak training testing dataset include earliest associated subject study. result scans alzheimer’s disease cohort scans normal cohort selected study. randomly aside eight scans later visual explanation analysis. rest dataset used training testing deep convolutional neural networks training testing d-vggnet d-resnet models conduct five-fold cross-validation five different splits dataset totaling training testing rounds. batch size parameters chosen small numbers models enforce batch training contains samples alzheimer’s disease cohort normal cohort stabilize training process avoiding biased loss. explaining d-cnns section describe methods develop explaining predictions d-cnns detail. first revisit baseline method using sensitivity analysis shed light d-cnns’ attention show used unsupervised hierarchical volumetric image segmentation approach ultrametric contour improve baseline call sensitivity analysis ultrametric contour next describe successful visual explanation method class activation mapping generalization gradient-weighted class activation mapping extended explain predictions scans. call extended approaches d-cam d-gradcam respectively. mentioned major ways data used preparation article obtained alzheimer’s disease neuroimaging initiative database such investigators within adni contributed design implementation adni and/or provided data participate analysis writing report. complete listing adni investigators found http//adni.loni.usc.edu/wp-content/ uploads/how_to_apply/adni_acknowledgement_list.pdf figure left architecture d-vggnet; middle architecture d-resnet; right modified architecture d-resnet global average pooling layer d-resnet-gap produce class activation mapping difference global average pooling layer directly outputs softmax output layer replacing original pooling fully connected layers. analysis. thus reduce number forward passes needed d-cnn number voxels number segments usually three four orders magnitude less. ultrametric contour state-of-the-art unsupervised hierarchical volumetric image segmentation. provides compact hierarchical segmentation high quality. brain volume could generate hierarchy segmentation level full segmentation volume occlude segment denoting resulting volume re-evaluate probability alzheimer’s disease forward pass d-cnn. change probabilities compared obtained original volume assuming belongs level hierarchy calculate importance score since ducm hierarchical segmentation usually provides homogeneous segments brain expect importance heatmap distinguish important brain parts alzheimer’s disease classification. terms computational burden level hierarchy contains hundreds segments hierarchy levels. thus number forward passes needed re-evaluate probabilities greatly reduced. class activation mapping major problem one-at-a-time sensitivity analysis based methods correlations interactions segments volume ignored. although using hierarchical segmentation method cover semantic segments finer coarser level cannot guarantee combinations tested. therefore turn methods based architectural properties d-cnn directly visualize activations convolutional layers predictions made. class activation mapping designs global average pooling layer convolutional layers natural images classification enables remarkable localization performance important objects images spite fact trained image-level labels. fits problem well. alzheimer’s disease labels normal cohort used scan level training d-cnns. goal obtain visual explanations highlight brain parts important alzheimer’s disease classification. thus extending class activation mapping provides this. idea class activation mapping last convolution layer contains spatial information indicating discriminative regions make classifications. visualize discriminative parts class activation mapping creates spatial heatmap activations last convolutional layer. specifically class activation mapping adopts global average pooling layer between final convolutional layer output layer enables projection class weights output layer onto activation explain predictions deep convolutional neural networks. applies perturbations data conducts sensitivity analysis. baseline method proposed sa-ducm approach belong category. utilizes architectural properties cnns heuristically track attention neural networks. d-cam d-grad-cam fall category. baseline approach. baseline approach proposed alongside work d-vggnet d-resnet shed light dcnn’s attention classifying scans. specific every voxel scan neighborhood occluded image d-cnn re-evaluates probability alzheimer’s disease partially occuluded image. change probability used importance voxel. formally brain volume voxel occlude neighborhood vx−x +y−y+z−z+ resulting perturbed volume occluded around denoted want measure change probability alzheimer’s disease predicted d-cnn compared original volume change assigned voxel heatmap size store changes probabilities importance score voxels magnitude calculated approach direct application one-at-a-time sensitivity analysis single voxel level test uncertainty output probability d-cnn could assigned different voxels scan. straightforward implement; however approach suffers three important problems. first cubical neighborhoods necessarily semantically meaningful could across different brain segments e.g. half cerebral cortex half white matter. thus occlusion area results unaccountable change output probability. second approach could capture impact local areas. importances larger smaller areas tested. third evaluate output probability voxel approach extremely computationally intensive. scan size million voxels requiring number forward passes d-cnn could take hours even gpu-assisted systems. sensitivity analysis ultrametric contour notice shortcomings baseline approach could overcome using good segmentation brain volume instead local neighborhood around voxel. particularly occlude segment segmentation instead cubical neighborhoods re-evaluating probabilities. resolve three problems baseline approach segmentation method semantically meaningful hierarchical compact. specifically semantically meaningful segmentation separate different homogeneous parts brain volume well e.g. separating cerebral cortex white matter changes probability could ascribed specific segments. hierarchical segmentation method provide hierarchy segmentations capture coarse level parts whole white matter well finer level parts. test importances small large areas. compact segmentation method avoid oversegmentation generate manageable number segments d-grad-cam could applied wider range d-cnns d-cam long d-cnn fully convolutional layer. also proven applications special case grad-cam global average pooling layer require re-training quickly generates d-gradcam heatmap forward pass. however d-grad-cam still suffers resolution problem d-gradcam coarse heatmap size last convolutional layer. could calculated gradients activations lower convolutional layers guarantee spatial activations wouldn’t change upper layers. summary section introduce four approaches obtain visual explanation heatmaps predictions d-cnns. baseline approach sensitivity analysis ultrametric contour completely model-agnostic handle type d-cnns might problems correlations interactions different segments brain volume. class activation mapping gradient-weighted class activation mapping weighted visualizations activation maps convolutional layer avoids dealing correlations interactions problem. however limited resolution convolutional layers. upsampled heatmaps might able provide enough detail accurately identify important regions. computational efficiency baseline approach slowest because forward pass every voxel. d-cam needs forward pass generate heatmap requires time-consuming re-training. sa-ducm needs hundred forwarded passes. d-grad-cam best require re-training needs forward pass generating heatmap. next section compare models’ performances identifation discriminative brain parts alzheimer’s disease classification scans. results section present classification performance d-cnns visual comparisons heatmaps generated proposed visual explanation approaches quantitative benchmark localization ability heatmaps identifying important brain parts alzheimer’s disease classification. alzheimer’s disease classification compare classification performance four different dcnns. include d-vggnet d-resnet described. implementing d-cam modified d-resnet global average pooling layer shown figure denoted d-resnet-gap. counterpart d-vggnet maps convolutional layer. extension class activation mapping based d-resnet shown figure instead using pooling layer fully connected layer output modified d-resnet uses global average pooling layer specific given volume d-cnn activation unit last convolutional layer location global average pooling unit number voxels corresponding convolutional layer. global average pooling layer directly connected softmax output layer definition softmax function probability alzheimer’s disease given part quantity defined every spatial location proportional class score alzheimer’s disease. areas significantly negatively contribute class score also important adopt absolute value define class activation mapping cohort though d-cam easy obtain expect highlight important spatial areas classification potential problems approach. first modify d-cnn architecture global average pooling layer need retrain model possibly affecting classification performance. second resolution class activation mapping size last convolutional layer. need upsample original scan size identify discriminative regions means would lose details resulting heatmap. solution could remove layers build global average pooling layers convolutional layers higher resolution. could decrease classification performance. gradient-weighted class activation mapping overcome class activation mapping’s shortcoming decreased classification performance generalization gradient-weighted class activation mapping proposed natural image classification approach need modify d-cnn’s architecture thus harm classification performance. since re-training required efficient deploy deep learning systems. core idea still identify important activations feature maps convolutional layers. using notation previous part first calculated gradient score respect activation unit location included classification performance drops much compared d-vggnet. additionally obtain higher resolution d-cam remove layers conv voxres_out resulting shallow version d-resnet-gap call dresnet-shallow-gap. four d-cnns trained classifying alzheimer’s cohort comparison normal cohort classification performance measured area curve classification accuracy crossvalidation described section conducted. average standard deviations reported. results presented table d-vggnet d-resnet achieve good classification performances. however substantial drop performance dresnet-gap d-resnet-shallow-gap means global average pooling layer negative effect classification performance. visually check quality heatmaps generated introduced visual explanation methods take scan set-aside data visual explanation analysis present heatmap horizontal sagittal coronal sections. comparison present input brain volume highlighted areas cerebral cortex lateral ventricle hippocampus. parts believed important alzheimer’s disease diagnosis physicians ground-truth cerebral cortex lateral ventricle hippocampus regions segmented freesurfer software baseline. resulting heatmaps labeled vgg-baseline res-baseline presented figure figure respectively. figures situations baseline method find important areas. heatmaps irregularly shaped heterogeneous regions used sensitivity analysis. overall baseline method fails identify discriminative regions. sa-ducm. incorporating hierarchical segmentations sensitivity analysis find results greatly improves compared baseline. figure presents heatmap made applying sa-ducm d-vggnet heatmap figure made applying sa-ducm d-resnet situations approach differentiates importances different homogeneous regions. clear boundaries separating regions. lateral ventricle area stands discriminative part. however cerebral cortex areas well identified. cerebral cortex widely loosely distributed brain cerebral cortex usually segmented area hierarchical segmentations. sa-ducm tested importance different segments one. thus able capture correlations segments belong cerebral cortex. d-cam. apply class activation mapping d-resnet d-vggnet loses much classification performance using global average pooling layer. class activation mapping heatmap d-resnet-gap labeled resd-cam presented figure heatmap blurry because upsampled coarse heatmap. higher resolution class activation mapping heatmap figure obtained d-resnet-shallow-gap convolutional layers removed. upsampled heatmap thus provides detail. identifies lateral ventricle parts cortex important areas matches human experts’ approach. d-grad-cam. gradient-weighted class activation mapping also resolution problems especially applied d-vggnet. last convolutional layer d-vggnet size resulting heatmap vgg-d-grad-cam barely provides information apply approach lower convolutional layer convb d-vggnet resulting heatmap vgg-d-grad-camshallow able highlight part lateral ventricle. d-resnet situation. res-d-grad-cam res-d-grad-cam-shallow generated d-grad-cam approach applied voxres_out dresnet. size respectively. though identify lateral ventricle cerebral cortex discriminative res-d-grad-cam-shallow higher resolution accurate. however stated upper convolutional layers could change activation maps lower convolutional layers. thus sometimes trust heatmap lower layers good representation spatial attention d-cnn. summarize qualitative comparisons sa-ucm resolution original volume differentiates homogeneous regions well. however fails identify correlations fragmented cerebral cortex segments one-ata-time process sensitivity analysis. d-grad-cam d-cam produce blurry heatmaps sa-ducm upsampling. able highlight cerebral cortex loosely distributed brain. quantitative comparison localization visual comparisons heatmap give general idea well different visual explanation methods work. wonder well heatmaps could localize important regions cerebral cortex lateral ventricle hippocampus. quantitatively compare localization ability plot precision-recall curve heatmaps visualized previous section identify cerebral cortex lateral ventricle hippocampus regions scans aside visual explanation analysis. vgg-baseline res-baseline vgg-d-grad-cam included generate usable heatmaps visual comparisons. results presented figure results vgg-sa-ducm res-sa-ducm res-d-grad-cam-shallow high precision recall end. matches visual comparisons sa-ducm method puts homogeneous lateral ventricle regions res-d-grad-cam-shallow identifies cerebral cortex lateral ventricle parts high accuracy. however precision drops methods high recall implying method close perfectly identifying important regions. reasons would overall qualitative quantitative comparisons indicate visual explanation methods limitations. correct method chosen based specific goals. goal importance homogeneous region saducm suitable. tracking attention d-cnn goal d-grad-cam preferred choice. generally dgrad-cam better d-cam modify d-cnn architecture requires less computation better localizes important regions. conclusion discussion study develop three approaches producing visual explanations d-cnns alzheimer’s disease classification. approaches highlight important brain parts diagnosis. however limitations different aspects. one-at-atime sensitivity analysis procedure sa-ducm able handle correlated interacting images segments causing underestimation attention loosely distributed area cerebral cortex case. d-cam d-grad-cam build heatmaps convolutional layer activations lower resolution original scan resulting loss details decreased localization accuracy. therefore suggest users choose right approach based cases analysis. though approaches developed alzheimer’s disease classification generic enough type image analysis. sa-ducm completely model agnostic adapt classifiers taking volumetric images input. d-cam d-grad-cam work deep learning model convolutional layer. could applied types medical images even video analysis. common limitation approaches visual explanation still step away fully understanding d-cnn. human experts measure cerebral cortex thickness biomarker diagnosis generated visual explanations explicit summarized representation visual attention cerebral cortex. leads future work explicit biomarker representation learning medical imaging fully interpret d-cnns. mckhann david knopman howard chertkow bradley hyman clifford jack claudia kawas william klunk walter koroshetz jennifer manly richard mayeux diagnosis dementia alzheimerâăźs disease recommendations national institute aging-alzheimerâăźs association workgroups diagnostic guidelines alzheimer’s disease. alzheimer’s dementia journal alzheimer’s association alexander khvostikov karim aderghal jenny benois-pineau andrey krylov gwenaelle catheline. cnn-based classification using smri md-dti images alzheimer disease studies. arxiv preprint arxiv. sergey korolev amir safiullin mikhail belyaev yulia dodonova. residual plain convolutional neural networks brain classification. biomedical imaging ieee international symposium ieee heung-il seong-whan dinggang shen alzheimer’s disease neuroimaging initiative hierarchical feature representation multimodal fusion deep learning ad/mci diagnosis. neuroimage ehsan hosseini-asl georgy gimel’farb ayman el-baz. alzheimer’s disease diagnostics deeply supervised adaptable convolutional network. arxiv preprint arxiv. bruce fischl. freesurfer. neuroimage emma mulder remko jong dirk knol ronald schijndel keith cover pieter visser frederik barkhof hugo vrenken alzheimer’s disease neuroimaging initiative hippocampal volume change measurement quantitative assessment reproducibility expert manual outlining automated methods freesurfer first. neuroimage jason corso eitan sharon shishir dube suzie el-saden usha sinha alan yuille. efficient multilevel brain tumor segmentation integrated bayesian model classification. ieee transactions medical imaging chengliang yang manu sethi anand rangarajan sanjay ranka. supervoxelbased segmentation volumetric images. asian conference computer vision pages springer bolei zhou aditya khosla agata lapedriza aude oliva antonio torralba. learning deep features discriminative localization. computer vision pattern recognition ieee conference pages ieee ramprasaath selvaraju michael cogswell abhishek ramakrishna vedantam devi parikh dhruv batra. grad-cam visual explanations deep networks gradient-based localization. https//arxiv. org/abs/. marco tulio ribeiro sameer singh carlos guestrin. trust you? explaining predictions classifier. proceedings sigkdd international conference knowledge discovery data mining pages kaiming xiangyu zhang shaoqing jian sun. deep residual learning image recognition. proceedings ieee conference computer vision pattern recognition pages nitish srivastava geoffrey hinton alex krizhevsky ilya sutskever ruslan salakhutdinov. dropout simple prevent neural networks overfitting. journal machine learning research sergey ioffe christian szegedy. batch normalization accelerating deep network training reducing internal covariate shift. international conference machine learning pages saining ross girshick piotr dollár zhuowen kaiming aggregated residual transformations deep neural networks. computer vision pattern recognition ieee conference pages ieee vinod nair geoffrey hinton. rectified linear units improve restricted boltzmann machines. proceedings international conference machine learning pages susanne mueller michael weiner leon thal ronald petersen clifford jack william jagust john trojanowski arthur toga laurel beckett. alzheimer’s disease neuroimaging initiative. neuroimaging clinics kirsi juottonen mikko laakso kaarina partanen hilkka soininen. comparative analysis entorhinal cortex hippocampus diagnosing alzheimer disease. american journal neuroradiology qiwen jingxia zongyao yaqin weng zhang shuyun. quantitative study hippocampal formation amygdala temporal horn lateral ventricle healthy subjects years age. american journal neuroradiology", "year": 2018}