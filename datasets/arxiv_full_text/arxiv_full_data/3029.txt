{"title": "Deformable Part-based Fully Convolutional Network for Object Detection", "tag": ["cs.CV", "cs.AI", "cs.LG"], "abstract": "Existing region-based object detectors are limited to regions with fixed box geometry to represent objects, even if those are highly non-rectangular. In this paper we introduce DP-FCN, a deep model for object detection which explicitly adapts to shapes of objects with deformable parts. Without additional annotations, it learns to focus on discriminative elements and to align them, and simultaneously brings more invariance for classification and geometric information to refine localization. DP-FCN is composed of three main modules: a Fully Convolutional Network to efficiently maintain spatial resolution, a deformable part-based RoI pooling layer to optimize positions of parts and build invariance, and a deformation-aware localization module explicitly exploiting displacements of parts to improve accuracy of bounding box regression. We experimentally validate our model and show significant gains. DP-FCN achieves state-of-the-art performances of 83.1% and 80.9% on PASCAL VOC 2007 and 2012 with VOC data only.", "text": "taylor mordan taylor.mordanlip.fr nicolas thome nicolas.thomecnam.fr matthieu cord matthieu.cordlip.fr gilles henaff gilles.henafffr.thalesgroup.com existing region-based object detectors limited regions ﬁxed geometry represent objects even highly non-rectangular. paper introduce dp-fcn deep model object detection explicitly adapts shapes objects deformable parts. without additional annotations learns focus discriminative elements align them simultaneously brings invariance classiﬁcation geometric information reﬁne localization. dp-fcn composed three main modules fully convolutional network efﬁciently maintain spatial resolution deformable part-based pooling layer optimize positions parts build invariance deformation-aware localization module explicitly exploiting displacements parts improve accuracy bounding regression. experimentally validate model show signiﬁcant gains. dp-fcn achieves state-of-the-art performances pascal data only. recent years witnessed great success deep learning deep convolutional networks several visual tasks. originally mainly used image classiﬁcation widely used others tasks object detection semantic segmentation particular detection region-based deep convnets currently leading methods. exploit region proposals ﬁrst step focus interesting areas within images classify ﬁnely relocalize regions time. although yield excellent results region-based deep convnets still present issues need solved. networks usually initialized models pre-trained imagenet dataset therefore prone suffer mismatches classiﬁcation detection tasks. example pooling layers bring invariance local transformations help learning robust features classiﬁcation also reduce copyright document resides authors. distributed unchanged freely print electronic forms. figure architecture dp-fcn. composed extract dense feature maps high spatial resolution deformable part-based pooling layer compute representation aligning parts sibling classiﬁcation localization prediction branches initial rectangular region deformed focus discriminative elements object. alignment parts brings invariance classiﬁcation geometric information reﬁning localization deformation-aware localization module. spatial resolution feature maps make network less sensitive positions objects within regions accurate localization. furthermore rectangular bounding boxes limits representation objects boxes contain signiﬁcant fraction background especially non-rectangular objects. introduction deep learning object detection state approaches exploiting deformable part-based models methods contrast region-based deep convnets latter relies strong features learned directly pixels exploit region proposals focus interesting areas images explicitly takes account geometry objects optimizing graph-based representation usually applied sliding window fashion images. approaches exploit different hypotheses seem therefore complementary. paper propose deformable part-based fully convolutional network end-to-end model integrating ideas region-based deep convnets object detection answer aforementioned issues. learns part-based representation objects aligns parts enhance classiﬁcation localization. training done box-level supervision only i.e. without part annotation. improves upon existing object detectors contributions. ﬁrst introduction deformable part-based pooling layer explicitly selects discriminative elements objects around region proposals simultaneously optimizing latent displacements parts using ﬁxed geometry must sub-optimal especially objects rigid parts move relative others. alignment parts deformable part-based pooling increases limited invariance local transformations brought pooling beneﬁcial classiﬁcation. aligning parts also gives access conﬁguration brings important geometric information objects e.g. shapes poses points view. second improvement design deformation-aware localization module speciﬁc module exploiting conﬁguration information reﬁne localization. improves bounding boxes regression explicitly modeling displacements parts within localization branch order tightly boxes around objects. integrating previous ideas fully convolutional networks obtain state-of-the-art results standard datasets pascal data only. show architectures amenable efﬁcient computation parts deformations offer natural solutions keep spatial resolution. application deformable part-based approaches particular severely dependent availability rather feature maps region-based object detectors. region-based deep convnets currently leading approach object detection. since seminal works r-cnn fast r-cnn object detectors exploit region proposals directly learn generate compared sliding window approach region proposals allows model focus computation interesting areas images balance positive negative examples ease learning. improvements commonly used e.g. using intermediate layers reﬁne feature maps selecting interesting regions building mini-batches deformable part-based models. core idea represent class root ﬁlter describing whole appearances objects part ﬁlters ﬁnely model local parts. part ﬁlter assigned anchor point deﬁned relative root move around detection model deformations objects best them. regularization introduced form deformation cost penalizing large displacements. part optimizing trade-off maximizing detection score minimizing deformation cost. final output combines scores root parts. accurate localization done post-processing step. several extensions proposed e.g. using second hierarchical level parts ﬁnely describe objects sharing part models classes learning strongly supervised annotations better model exploiting segmentation clues improve detection part-based deep convnets. ﬁrst attempts deformable parts deep convnets simply exploited deep features learned alexnet dpms without region proposals. however tasks implying spatial predictions require feature maps order accurate localization fully connected layers therefore discarded keep enough spatial resolution lowering results. solve issue using well suited kinds applications naturally keeps spatial resolution. thanks several tricks easily integrable fcns skip pooling fcns recently successful various tasks e.g. image classiﬁcation object detection semantic segmentation weakly supervised learning introduces parts detection learning part models combining geometric constraints scoring. learned strongly supervised i.e. part annotations. although manually deﬁning parts interpretable likely suboptimal detection might correspond discriminative elements. parts often used ﬁne-grained recognition. proposes module localizing aligning parts respect templates classifying them ﬁnds part proposals activation maps learns graphical model recognize objects uses subnetworks detection classiﬁcation parts considers parts vocabulary latent discriminative features decoupled task learns unsupervised way. usage parts also common semantic segmentation e.g. work closest r-fcn also uses achieve great efﬁciency. improve upon learning ﬂexible representations ﬁxed geometry. allows model align parts objects bring invariance classiﬁcation exploit geometric information positions parts reﬁne localization. section present deformable part-based fully convolutional network deep network object detection. represents regions several parts aligns explicitly optimizing positions. alignment improves classiﬁcation localization part-based representations invariant local transformations conﬁgurations parts give important information geometry objects. idea inserted state-of-the-art network architectures. model end-toend trainable without part annotation adds small computational overhead only. complete architecture depicted fig. composed three main modules fully convolutional network applied whole images deformable part-based pooling layer sibling prediction layers classiﬁcation localization. describe three parts model details. model relies backbone architecture kind network enjoys several practical advantages leading several successful models e.g. first allows share computation whole images reduce per-roi layers noted r-fcn second important work directly provides feature maps linked task hand ﬁnal predictions simply pooled done within dp-fcn inferring positions parts region done particular kind pooling describe section fully convolutional structure therefore suitable computing responses parts classes single them. corresponding structure used localization. complete representation whole image obtained single forward pass shared regions image efﬁcient. since relocalization parts done within feature maps resolution maps practical importance. fcns contain spatial layers therefore well suited preserving spatial resolution opposed networks ending fully connected layers e.g. speciﬁcally stride large deformations parts might coarse describe objects correctly. reduce using dilated convolutions last convolution block skip pooling combine last three. figure deformable part-based pooling input feature corresponds part class positions parts optimized separately within detection maps deformation costs regularization values pooled within parts locations. output includes class computed displacements parts used localization. illustration deformations parts moved initial positions adapt shape object better describe deformable part-based pooling layer divide region proposals several parts locally relocalize best match shapes objects part models discriminative local element aligned corresponding location within image. deformable part-based representation invariant transformations objects parts positioned accordingly local appearances stable especially useful non-rigid objects box-based representation must sub-optimal. separation parts done regular grid size ﬁtted regions cell interpreted distinct part strategy simple effective since number parts ﬁxed hyper-parameter easy complete detection heatmap already computed region class parts need optimized within corresponding maps. allows parts slightly move around reference positions selects optimal latent displacements pools values selected locations. pooled score part class trade-off maximizing score feature minimizing displacement reference position represents strength regularization pool average pooling pooling function could used instead. deformation cost squared distance displacement feature functions could used equally. implementation details found appendix figure deformation-aware localization reﬁnement. relocalizations bounding boxes obtained averaging pooled values localization maps beneﬁt deformable parts. displacements parts forwarded fully connected layers element-wise multiplied previous output reﬁne separately class. localization done values class following locations. note deformations computed parts classes independently. however deformation computed background class would bring relevant information discriminative element class. displacements parts used pool values localization maps. directly linked magnitudes displacements parts therefore deformations rois controlling squared distance regularization increasing puts higher weight regularization effectively reduces displacements parts setting high prevents parts moving removes beneﬁts approach. noticeable deformable part-based pooling generalization position-sensitive pooling setting clamps leading formulation position-sensitive pooling hand setting removes regularization parts free move. results decrease indicating regularization practically important. however results appeared stable within large range values classiﬁcation localization predictions deformable parts predictions performed sibling branches classiﬁcation relocalization region proposals common practice classiﬁcation branch simply composed average pooling followed softmax layer. strategy employed r-fcn however deformations introduced bring invariance transformations objects boost classiﬁcation. regarding localization also average pooling compute ﬁrst localization output corresponding features. however conﬁguration parts obtained by-product alignment parts performed before. gives rich geometric information appearances objects e.g. shapes poses used enhance localization accuracy. introduce deformation-aware localization reﬁnement module region extract feature vector displacements parts class reﬁne previous output class. forwarded fully connected layers element-wise multiplied ﬁrst values yield ﬁnal localization output class. since reﬁnement mainly geometric done classes separately parameters shared classes. experimental setup. perform analysis fully convolutional backbone architecture resnet- exploit region proposals computed attractionet released authors. parts advised authors rfcn setting others hyper-parameters found appendix experiments section conducted pascal dataset training done union trainval sets testing test set. addition standard map. metric results also reported map. metrics thoroughly evaluate effects proposed improvements. comparison r-fcn. performances implementation r-fcn given setup shown ﬁrst tab. adding deformable part-based pooling r-fcn improves map. points. indeed metric rather permissive localization need accurate gain map. much smaller. improvements therefore mainly better recognition thus validating role deformable parts. localization reﬁnement module map. small improvement localization accuracy issue. however improves map. points validating need module. conﬁrms aligning parts brings geometric information useful localization. table ablation study dp-fcn pascal test average precision without deformable part-based pooling localization reﬁnement module equivalent r-fcn detailed breakdowns false positives provided fig. r-fcn dp-fcn. biggest gain comes reduced localization errors corresponding curves higher dp-fcn. ignoring errors recognition accuracy consistently around point better however models roughly keep number false negatives examples detection outputs illustrated fig. visually evaluate proposed improvements. appears r-fcn easily miss extremal parts objects dp-fcn better separating close instances thanks deformable parts. mances weakly supervised manner. therefore interpretation terms semantic parts systematic especially division regions parts ﬁner leading smaller part areas. deformed parts displayed fig. part division easier visualization. noticeable dp-fcn able better objects deformable parts simple bounding boxes. network architecture. compare dp-fcn several backbone architectures tab. particular -layer versions resnet wide resnet resnext detection dp-fcn signiﬁcantly increased using better networks. resnext- gives best results among tested ones large improvements metrics despite using dilated convolutions. experimental setup. bring following improvements setup section details appendix resnext- increase number iterations. include common tricks color data augmentations bounding voting averaging detections original ﬂipped images relative weight multi-task loss enlarge input boxes factor include context. pascal results dp-fcn along recent methods reported tab. tab. fair comparisons report results methods trained voc+ voc++ respectively using additional data e.g. coco images usually improves results dp-fcn achieves datasets yielding large gaps competing methods. particular dp-fcn outperforms r-fcn work closest ours signiﬁcant margins note results could improved additional common enhancements e.g. multi-scale training testing ohem paper propose dp-fcn deep model object detection. traditional region-based detectors generic bounding boxes extract features from dp-fcn ﬂexible focuses discriminative elements align them. learns part-based representation objects efﬁcient natural integration fcns withadditional annotations training. improves recognition building invariance local transformations localization thanks dedicated module explicitly leveraging computed positions parts reﬁne predictions geometric information. experimental validation shows signiﬁcant gains several common metrics. future work test model larger-scale dataset coco deformable part-based pooling layer normalize displacements widths heights parts make layer invariant scales images. also normalize classiﬁcation feature maps forwarding deformable part-based pooling layer ensure classiﬁcation regularization terms comparable. l-normalizing spatial location block maps part separately i.e. replacing optimization performed brute force limited ranges whole images. small regularization effectively restricts values displacements leaving results pooling unchanged. experiments deformation-aware localization reﬁnement localization module applied class separately takes normalized displacements class input size composed fully connected layers relu them. size ﬁrst layer experiments. output average pooling main outcome obtained visual features without considering deformations. fully connected layers encodes positions parts merged ﬁrst element-wise product adjust accordingly exact locations computed. ablation study fully convolutional backbone architecture resnet- whose model pretrained imagenet freely available. network trained iterations learning rate iterations momentum parameter weight decay mini-batch composed regions single image scale selected according fast r-cnn horizontal ﬂipping images probability used data augmentation. exploit region proposals computed attractionet released authors. regions used learning evaluated inference. parts advised authors r-fcn common practice detections post-processed nms.", "year": 2017}