{"title": "Abductive reasoning as the basis to reproduce expert criteria in ECG  Atrial Fibrillation identification", "tag": ["cs.AI", "cs.CV", "68T10"], "abstract": "Objective: This work aims at providing a new method for the automatic detection of atrial fibrillation, other arrhythmia and noise on short single lead ECG signals, emphasizing the importance of the interpretability of the classification results.  Approach: A morphological and rhythm description of the cardiac behavior is obtained by a knowledge-based interpretation of the signal using the \\textit{Construe} abductive framework. Then, a set of meaningful features are extracted for each individual heartbeat and as a summary of the full record. The feature distributions were used to elucidate the expert criteria underlying the labeling of the 2017 Physionet/CinC Challenge dataset, enabling a manual partial relabeling to improve the consistency of the classification rules. Finally, state-of-the-art machine learning methods are combined to provide an answer on the basis of the feature values.  Main results: The proposal tied for the first place in the official stage of the Challenge, with a combined $F_1$ score of 0.83, and was even improved in the follow-up stage to 0.85 with a significant simplification of the model.  Significance: This approach demonstrates the potential of \\textit{Construe} to provide robust and valuable descriptions of temporal data even with significant amounts of noise and artifacts. Also, we discuss the importance of a consistent classification criteria in manually labeled training datasets, and the fundamental advantages of knowledge-based approaches to formalize and validate that criteria.", "text": "abstract. objective work aims providing method automatic detection atrial ﬁbrillation arrhythmia noise short single lead signals emphasizing importance interpretability classiﬁcation results. approach morphological rhythm description cardiac behavior obtained knowledge-based interpretation signal using construe abductive framework. then meaningful features extracted individual heartbeat summary full record. feature distributions used elucidate expert criteria underlying labeling physionet/cinc challenge dataset enabling manual partial relabeling improve consistency classiﬁcation rules. finally state-of-the-art machine learning methods combined provide answer basis feature values. main results proposal tied ﬁrst place oﬃcial stage challenge combined score even improved follow-up stage signiﬁcant simpliﬁcation model. signiﬁcance approach demonstrates potential construe provide robust valuable descriptions temporal data even signiﬁcant amounts noise artifacts. also discuss importance consistent classiﬁcation criteria manually labeled training datasets fundamental advantages knowledge-based approaches formalize validate criteria. last decades capacity artiﬁcial intelligence provide low-cost methods automatic diagnosis cardiac diseases using standard records recurrent claim. thousands works many diﬀerent approaches addressing various common problems feature extraction beat classiﬁcation rhythm analysis among others nevertheless potential shown research results still largely untapped clinical routine current analysis tasks require intensive intervention expert clinicians. physionet/computing cardiology challenge tries every year reduce recognized problem edition deﬁed scientiﬁc community industry propose viable solutions provide reliable screening atrial fibrillation short single-lead signals acquired commercial low-cost device total records provided training labeled four classes normal sinus rhythm atrial ﬁbrillation rhythm noisy hidden test records used evaluate performance proposed algorithms using metric mean measure classes. besides pursuing competitive numeric accuracy present work makes special emphasis interpretability results proven major concern care staﬀ trust automatic assistance methods this classiﬁcation procedure based highlevel features obtained description terms used expert clinicians. description generated construe algorithm relies abductive reasoning obtain best interpretation observed evidence using knowledge-based approach. main diﬃculties recognized participants challenge absence speciﬁc classiﬁcation criteria beyond name class. even expert clinicians labeling training test datasets received instructions leading large level disagreement many label inconsistencies thus machine learning methods performance barrier could expected priori. case tried overcome limit elucidating expert criteria underlying training dataset improving label consistency according criteria rather tuning learning algorithms. strategy could even improved follow-up stage challenge signiﬁcant change criteria training test sets unveiled data proﬁle proposed classiﬁcation algorithm combination abductive knowledgebased approach interpret signal learning-based methods decision parameters challenge training set. figure shows global architecture algorithm described detail section along manual data relabeling process. afterwards section shows validation results obtained challenge training oﬃcial follow-up stages. finally section discusses results potential proposed approach possible roadmap development low-cost automatic screening method atrial ﬁbrillation possible target arrhythmias. abductive interpretation distinguishing feature proposal. result interpretation description multiple abstraction levels physiological processes underlying signal trace terms used expert clinicians. abstraction levels considered conduction level describes signal sequence waves complexes waves corresponding morphology amplitude duration; rhythm level describes signal concatenation segments showing diﬀerent rhythm patterns including normal sinus rhythm bradycardia tachycardia extrasystole couplet rhythm block bigeminy trigeminy atrial ﬁbrillation ventricular ﬂutter asystole. build description construe algorithm implements hypothesize-andtest cycle pursues best explanation observed evidence according available knowledge. domain knowledge deﬁned abstraction patterns describe time value constraints satisﬁed evidence observables support given hypothesis. abstraction patterns dynamically generated formal descriptions named abstraction grammars. knowledge base interpretation signals described results abductive interpretation also used detect possible inversions signal. lead inversion found quite common issue training aﬀecting approximately records. probably incorrect holding acquisition device consequence increases chances classify record abnormal presence infrequent wave morphologies well greater diﬃculty identify waves. detection performed construe results conduction level carrying rhythm interpretation. initial evidence beat annotations produced gqrs application physionet library tentative delineation wave complex wave heartbeat obtained. delineation results. features median axis; median amplitude; diﬀerence mean median signal normalized signal length signal amplitude; baseline value calculated mode signal; ratio energy signal baseline; dispersion signal; mean value signal samples exceeding standard deviations baseline; median amplitude ﬁrst second third waves inside complex; number waves complexes waves normalized signal length. classiﬁer showed cross-validation score signal found inverted signal samples multiplied continuing. lead inversion correction step construe algorithm executed rhythm level taking initial evidence complexes used delineation step. modiﬁed interpretation process thanks non-monotonic reasoning scheme combines bottom-up reasoning top-down reasoning obtain best matching observations knowledge. gives great robustness presence noise artifacts data allows false positive false negative detections shown figures figure high amount noise signal causes many false positive beat detections ﬁxed rhythm level selecting best explaining hypothesis single normal rhythm observation. figure ﬁrst ventricular beat detected probably lower amplitude slope. still bigeminy hypothesis evoked ﬁrst extrasystole allows look advanced beats explaining full fragment rhythm hypothesis. description resulting abductive interpretation stage contains information typically referred expert clinicians handbooks make decision normal/abnormal condition record. however since criteria leading label provided information converted quantitative features input selected machine learning methods order underlying criteria training set. methods evaluates record globally using aggregated features; evaluates record sequence using recurrent neural network architecture individual features detected heartbeat. methods detailed below. proposal submitted oﬃcial phase challenge total features calculated. ﬁnal results obtained test showed signiﬁcant overﬁtting training sign excessive complexity model. thus version global features reduced using recursive feature elimination technique resulting features detailed table features rr_irr rr_mirr included previous version correspond rhythm irregularity measure based sample entropy estimation described features require explanation. speciﬁcally term proﬁle refers absolute value derivative signal excellent signal quality indicator. regarding pdistd mpdist referred measure corresponds distance separating hyperplane class used construe perform delineation waves intuitively measure much really looks like wave. individual features used train sequence classiﬁer described section disaggregations features table rr_irr n_pr prof pw_prof pdist tp_freq. additionally various morphological features added enable identiﬁcation isolated conduction alterations. features include duration amplitude turning point individual wave inside complex axis waves duration amplitude segment deviation. also qualitative features included describe morphology name rhythm heartbeat interpreted. every non-random human labeling task underlying criteria. criteria subtle unconscious even variable along time necessary exist. objective machine-learning algorithm trying reproduce labeling therefore formalize quantify underlying criteria consequence formalized criteria priori easier development proportion record length interpreted regular tachycardia bradycardia). number milliseconds interpreted non-regular rhythm. median interval regular rhythms. median absolute deviation interval regular rhythms. rr_mirr max. irregularity measure. pnn{} global pnnx measures. min. interval regular rhythms. n_np proportion heartbeats detected p-wave inside regular rhythms. n_pr median duration inside regular rhythms. pdistd measure given wave delineation method. prof proﬁle full signal. maximum cross-correlation xcorr median complexes interpreted regular rhythms. global durations. median prevailing frequency intervals. pw_prof proﬁle measure signal p-wave area. n_txcorr median maximum cross-correlation t-waves inside regular rhythms. baseline proﬁle baseline regular rhythms. longtch longest period time heart rate bpm. rrd_std standard deviation instant variation. mrrd max. absolute variation interval regular rhythms. rr_irr median irregularity measure. o_pnn non-regular rhythms. o_mrr min. interval non-regular rhythms. n_at median amplitude waves inside regular rhythms. psmooth median ratio standard deviation mean value p-waves’ derivative signal. mpdist max. delineation method. pw_profd pw_prof. o_xcorr median maximum cross-correlation complexes interpreted non-regular rhythms. median corrected measure. tpfreq median frequency entropy intervals. proportion complexes detected waves. n_pxcorr median maximum cross-correlation p-waves inside regular rhythms. o_baseline proﬁle baseline non-regular rhythms. wqrs_xc median maximum cross-correlation wide complexes. w_pr proportion heartbeats long interval x_rrel median ratio previous next intervals ectopic beat. algorithm. probably labor-intensive task proposal elucidation expert criteria underlying training test sets ensuing data relabeling make criteria consistent possible along dataset. certainly diﬃcult class deﬁne appropriate discrimination knowledge class inasmuch provided information excessively vague include range pathophysiological processes showing diﬀerent morphologies rhythms. hence since class opposed atrial ﬁbrillation normal sinus rhythm expert consider rhythm alterations included class another expert contemplate event normality conduction delays chamber enlargements among others. thanks physiological meaning features provided interpretation possible throw light well-known alterations seem considered representatives training set. simple valuable tool per-class distribution feature. figure shows distributions three features deﬁne almost crisp threshold well-known anomalies. seen tachycardia bradycardia abnormal rhythms considered median interval approximately. also complex wider seems clear indicator anomaly duration also bias class respect although case separation less clear-cut. using procedure following recognized rhythm conduction conditions identiﬁed labeled training conditions suﬃcient classify record many cases shown above. however criteria consistent across entire dataset examples phenomena several classes. examples shown figure learning algorithms inasmuch trying arbitrary decisions lead complex overﬁtted models. hence partial manual relabeling process guided misclassiﬁed examples performed oﬃcial phase challenge. process tried conservative focused clear examples abovementioned anomalies labeled total number records relabeled stage named oﬃcial phase signiﬁcant portion records hidden test relabeled eight human experts following bootstrap approach based disagreement level scored algorithms. basic statistics process published organizers showing important reduction records labeled relative decrease suggest signiﬁcant change underlying classiﬁcation criteria conservative towards classes. since labels training modiﬁed accordingly cross-validation longer reliable predictor performance algorithms test intuition became much relevant. following intuition second relabeling stage performed follow-up phase challenge. reasonable think change criteria favor normal noise classes greater impact records showing regular sinus rhythm conduction criteria longer considered suﬃcient class. also taking account signal captured subjects participating actively handheld device phenomena like ventricular tachycardias considered implausible patterns like appearing record labeled noise. total number records relabeled stage named table shows comparison class distributions training relabeling phase challenge distribution hidden test set. additionally heuristics guiding construe algorithm slightly modiﬁed encourage normal rhythm hypotheses. speciﬁcally signal fragment shows evidence compatible presence complexes regular intervals frequency beats minute fragment considered fully explained rhythm hypotheses explored. adjustment potentially ignore important anomalies interpolated extrasystoles observed single lead infeasible morphologically distinguish many artifact patterns real ectopic complexes simplicity principle enforced case. shown figure label given record obtained combining diﬀerent classiﬁcation algorithms. ﬁrst global classiﬁer makes decision based summary information full record. deﬁned standard multilabel classiﬁer feature space deﬁned table o∼}. selected machine learning method tree gradient boosting algorithm particularly xgboost implementation achieved signiﬁcantly better results state-of-the methods support vector machines random forests without hyperparameter tuning. also algorithm provides certain degree interpretability assigning diﬀerent importances classiﬁcation features. table shows basic comparison score obtained class ﬁnal metric algorithms training relabeling using -fold cross-validation. random forest scikit-learn implementation used obtained results gave best mean score worst result hyperparameter combinations within standard deviation best result variability decided choose conservative values hyperparameters build general model. selected values highlighted bold gave score training global classiﬁer achieved score second classiﬁcation algorithm shown figure conceived complement global classiﬁer working beat-by-beat basis instead dealing features summarizing whole record. consider example almost normal record ectopic beat. unless summary record global classiﬁer extremely accurate type records probably misclassiﬁed. however classiﬁer specialized processing sequences beats could correctly classify record remembering abnormal heartbeat occurred. another compelling reason using sequence classiﬁer. although construe able extract meaningful features noisy segments reasonable give credence clean measurements noisy ones. unlike global features easy achieve sequence classiﬁer heartbeat receives signal quality indicator. need remembering occurrence distant events long short term memory networks basis sequence classiﬁer. idea behind lstms cell memory store useful information time several non-linear gating units decide information added removed cell. gating cells also important avoid vanishing exploding gradients important issue backpropagating time prevent network learning long-range dependencies. architecture sequence classiﬁer shown figure time step features associated single heartbeat transformed using time-distributed multilayer perceptron purpose transformation input features embedding space easier temporal dynamics. consists hidden units followed rectiﬁer linear unit maps input features dimensional output space. lstm_ network processes sequence transformed heartbeat features outputs another sequence used input remaining lstms. lstm_ returns ﬁnal state network subsequently used output ﬁnal classiﬁcation label. therefore central processing pipe figure seen stacked lstm model widely used machine learning tasks. processing pipes involve lstm_ lstm_ networks require explanation. lstms return sequences transformed feature vectors using pooling operation drops temporal dimension. mean pooling averages outputs lstm_ across temporal dimension whereas pooling picks maximum values dimension lstm_ outputs. intuitively trying achieve operations simulate reasoning clinicians that seeing complete record look extreme events subtle event occurs whole record lstms used hidden state units. finally another hidden units relu activation concatenates processes outputs lstms softmax layer predicts probability classes. proposed model large amount degrees freedom therefore preventing overﬁtting major concern. l-regularization applied layers model using regularization strength dropout also applied improve generalization. achieved randomly turning several neural units training prevents feature co-adaptation. neural unit becomes robust since training time cannot rely units correct mistakes amount dropout diﬀerent layer model layers used lstm_ used inputs recurrent states remaining lstms used inputs recurrent states. early stopping also employed ending training epochs without improvement validation obtained stratiﬁed random split. early stopping implies small fraction data would used training neural network. available data sequence classiﬁers trained using diﬀerent validation sets. limited number lstms avoid exceeding challenge entry size limit. ﬁnal prediction sequence classiﬁer obtained averaging predictions classiﬁers. besides using available data averaging diﬀerent models helps reducing variance results random initialization neural network layers random split training validation set. averaging similar models also known reduce overﬁtting. sense averaging seen simple sub-bagging. sequence classiﬁer trained using categorical cross-entropy loss function batch size records adam optimizer initial learning rate optimizer train validation also permitted monitor performance classiﬁer decrease learning rate validation loss stacked plateau. learning rate decreased factor hyperparameters previously discussed selected using tree parzen estimators hyperparameter optimization algorithm based approximating performance hyperparameters using bayesian modeling sequence classiﬁer implemented using keras global sequence classiﬁers blended together means stacking technique. stacking ensemble learning method combines several classiﬁers using another meta-classiﬁer stacked classiﬁers usually achieve better performance base classiﬁers using level model performs best. therefore level classiﬁers diverse enough complement combined. furthermore classiﬁer data better resultant stacked classiﬁer approach requirements fulﬁlled. linear discriminant analysis chosen meta-classiﬁer. inputs predicted probabilities level classiﬁers. however avoid possible collinearity issues probabilities model used. important point keep mind training stacked classiﬁers requires partition dataset. ﬁtted level classiﬁers using data second meta-classiﬁer biased towards best models. algorithm describes implemented partitions required sequence classiﬁer stacking classiﬁer. tables show validation results classiﬁcation algorithms public hidden challenge datasets. table shows stacking technique usually improves performance individual classiﬁers achieving better mean score lower variance. table shows results disaggregated target class magnitude improvement almost equal classes. also table shows improvement obtained follow-up stage challenge respect oﬃcial phase conﬁrming change criteria introduced bootstrap relabeling importance label consistency. notable performance decrease hidden test respect cross-validation suggest still criteria diﬀerences training test sets. inconsistency problems challenge dataset suggest giving complete independence human experts leads high level disagreement resulting labels even relatively bounded well-deﬁned problem clinical perspective like arrhythmia classiﬁcation. however presence/absence diseases like atrial ﬁbrillation subjective consideration medical guidelines prove consensuses achieved defend consensus ﬁrst step development eﬀective lowcost screening system removes need dozens experts thousands records achieve statistically acceptable agreement allowing less complex algorithms. would like point consensus referring strong quantiﬁcation decision thresholds general guidelines shared expert labelers. possible example could atrial ﬂutters considered class reduces probability inconsistencies figure guidelines basis achieved results challenge consider reduced three experts hundreds records enough achieve much higher performance classiﬁcation algorithm additionally would desirable labeling would made standard multi-lead records acquired simultaneously single-lead record quantify information loss handheld device speciﬁc problem. expect conduct study near future. interpretation signals task humans show outstanding proﬁciency. even qualities like personal experience intuition invaluable hardly formalizable pathophysiological processes observed eﬀects signal behavior widely accepted medical community. also systematic approaches described handbooks provide excellent results screening diagnosis expert knowledge susceptible formalized computational methods. oﬃcial results challenge show best-performing algorithms include domain-speciﬁc knowledge point. suggest knowledge-based approaches fundamental advantage pure learning-based approaches quantifying underlying criteria manually labeled datasets. present proposal demonstrated exploiting advantage feasible without sacriﬁcing beneﬁts sophisticated machine learning methods maintaining notable degree interpretability meaningful features. challenge construe algorithm reaﬃrmed ability accurately interpret highly contaminated data combining bottom-up reasoning top-down reasoning abductive cycle. forthcoming work integration signal types beyond example blood pressure potential improve robustness accuracy results. work supported spanish ministry economy competitiveness project tin--r. c.a. garcía also supported grant program spanish ministry education would also like acknowledge alberto cobos work lead inversion detection problem citius summer fellowship challenge organizing team great support encouragement given competitors times.", "year": 2018}