{"title": "Morphological Error Detection in 3D Segmentations", "tag": ["cs.CV", "cs.AI", "q-bio.NC", "stat.ML"], "abstract": "Deep learning algorithms for connectomics rely upon localized classification, rather than overall morphology. This leads to a high incidence of erroneously merged objects. Humans, by contrast, can easily detect such errors by acquiring intuition for the correct morphology of objects. Biological neurons have complicated and variable shapes, which are challenging to learn, and merge errors take a multitude of different forms. We present an algorithm, MergeNet, that shows 3D ConvNets can, in fact, detect merge errors from high-level neuronal morphology. MergeNet follows unsupervised training and operates across datasets. We demonstrate the performance of MergeNet both on a variety of connectomics data and on a dataset created from merged MNIST images.", "text": "deep learning algorithms connectomics rely upon localized classiﬁcation rather overall morphology. leads high incidence erroneously merged objects. humans contrast easily detect errors acquiring intuition correct morphology objects. biological neurons complicated variable shapes challenging learn merge errors take multitude diﬀerent forms. present algorithm mergenet shows convnets fact detect merge errors high-level neuronal morphology. mergenet follows unsupervised training operates across datasets. demonstrate performance mergenet variety connectomics data dataset created merged mnist images. neural network brain remains mystery even engineers succeeded building artiﬁcial neural networks solve wide variety problems. understanding brain deeper level could signiﬁcantly impact biology artiﬁcial intelligence perhaps appropriately artiﬁcial neural networks used biological neural networks. however humans still outperform computer vision algorithms segmenting brain tissue. deep learning attained intuition allows humans recognize trace intermingled branches neurons. ﬁeld connectomics aims reconstruct three-dimensional networks biological neurons high-resolution microscope images. automated segmentation necessity quantities data involved. recent study brain larval zebraﬁsh annotated hand requiring year human labor. estimated mapping single human brain would require zettabyte image data clearly manually segmented. state-of-the-art algorithms apply convolutional neural network predict voxel image whether boundary neuron. predicted membranes ﬁlled subsequent algorithms methods prone split errors true objects subdivided merge errors objects fused together. latter pose particular challenge. neurons highly variable unpredictably sprouting thousands branches correct shapes cannot catalogued. erroneously merged neurons obvious trained humans simply don’t look right hitherto impossible make determinations automatically. figure single relatively simple merge error detected localized mergenet. object within kasthuri dataset occurred within training data algorithm labeled merge error. mergenet nonetheless able correct label. capability allows mergenet trained uncertain segmentation used correct errors within segmentation without requiring manual annotation. figure probability localizing merge errors predicted mergenet object within dataset. orange indicates high probability merge error blue absence error. location illustrates merge neurons running parallel merge three neurons simultaneously merge large neuron segment small branch another neuron. mergenet able learn diverse morphologies represent merge errors locations normally occurring branch points within single neuron. introduce deep learning approach detecting merge errors leverages morphological intuition human annotators. instead relying upon voxelwise membrane predictions microscope images zoom capture much context possible. using threedimensional binary masks algorithm able learn distinguish shapes plausible neurons erroneously fused together. numerous recent advances using neural networks recognize general threedimensional objects. methods include taking projections input combined approaches purely networks accelerated implementation techniques networks introduced budden zlateski seung within ﬁeld connectomics maitin-shepard describe celis neural network approach optimizing local features segmented image. januszewski meirovitch present approaches directly segmenting individual neurons microscope images without recourse membrane prediction agglomeration algorithms. deep learning techniques likewise used detect synapses neurons localize voltage measurements neural circuits forms data also leveraged connectomics thanks advances biochemical engineering. many authors cite frequent problems posed merge errors however almost approaches proposed detecting automatically. meirovitch suggest hard-coded heuristic x-junctions variety merge error analyzing graph theoretical representations neurons skeletons recent work including considered problem deep learning graphs farhoodi ramkumar kording generative adversarial networks generate neuron skeletons. however methods date brought bear connectomic reconstruction neural circuits. algorithm mergenet operates image segmentation correct errors within given object within proposed segmentation mergenet determines whether points chosen within object location erroneous merges. points exist object determined free merge errors. whether assigned object. mergenet given data original image inducing network learn general morphological features present binary mask. network follows simple convolutional architecture containing convolutional layers rectiﬁed linear unit activation three max-pooling layers followed densely connected layer softmax output. desired output -hot vector classes merge merge trained cross-entropy loss. also constructed simpler version mergenet illustrate identiﬁcation merge errors within two-dimensional images. case input network square binary mask passes four convolutional layers max-pooling layers. network trained recognize merges binarized digits mnist dataset random digits drawn training dataset chained together merge errors given pixels points contact neighboring digits. testing performed similar merges created testing dataset. size input window network varied compare accuracy across variety contextual scales. apply mergenet connectomics data begin downsampling objects. segmentations neural data typically performed high resolution approximately ﬁnest morphological details neurons however order commonly data anisotropic resolution direction signiﬁcantly lower tested merdownsampling object performed max-pooling procedure. every voxel within downsampled image represents intersection object corresponding subvolume network trained artiﬁcially induced merge errors objects within segmentations neural tissue. merges consisted identifying immediately adjacent objects designating points overlap locations merge errors. negative examples consisted windows centered random points objects within segmentation. artiﬁcial merge errors used owing impracticality manually annotating data large enough volumes determine suﬃcient merge errors training. demonstrate training suﬃces eﬀective detection real trained instance mergenet objects within segmentation necessary apply network every voxel since predictions nearby points interpolated. sample points therefore taken within downsampled object mergenet windows centered points. real-valued predictions sample points interpolated entire object give heatmap probabilities merge errors. distribution training examples balanced positive negative examples true network applied practice output must normalized thresholded softmax layer. eﬀective classify merge error voxel prediction exceeds ﬁrst consider illustrative example merged mnist dataset. training million examples within dataset obtained maximum pixelwise accuracy percent test constructed held digits equally distributed positive negative examples. corresponds almost perfect identiﬁcation individual merge error regions shown figure figure show dependence accuracy window size used. intuitively larger window gives network morphological context work from plateaus case approximately dimensions pair fused mnist digits represents maximum scale morphology useful network. figure provides qualitative image shows predictions network input windows predicted merges shown yellow. middle image shows predictions input windows. ﬁnal image shows actual merges red. note networks quite accurate made input. illustrates greater morphological context leads comparison performance smaller larger window size. smaller window size erroneously predicts merges within digits large window size allows network recognize shapes digits identify merge errors digits. course tradeoﬀ accuracy time required train network. slowdown resulting larger window size considerable three-dimensional convnets. attempted choose parameters mergenet tradeoﬀ mind. trained mergenet segmentations kasthuri dataset tested performance artiﬁcially merged objects omitted training set. segmentation relatively poor training yielded performance percent. segmentation accurate yielding performance percent. training segmentations together yielded best performance test sets showing mergenet able leverage contextual information segmentation improve performance another. also note training low-quality segmentation mergenet able detect errors within training shown figure mergenet generalizes broadly across datasets well segmentations dataset applies artiﬁcial natural merge errors though latter harder quantify owing paucity large-scale annotation. training kasthuri dataset mergenet able detect naturally occurring merge errors within segmentations dataset obtained state-of-the-art u-net segmentation algorithm example output shown figures figure performance mergenet merged mnist digits shown function input window width note increasing window size increases performance size pixels. performance plateaus point morphological context captures information neighboring digits. case neurons larger complicated morphological context plateau; however tradeoﬀ context greater speed since time required convnet depends strongly upon input size. mergenet powerful tool detecting pinpointing merge errors. merge location ﬂagged high spatial precision algorithms used create accurate local segmentation thereby correcting errors occured. flood-ﬁlling networks maskextend examples algorithms high accuracy extremely time-consuming large volumes making ideally suited segment merge locations ﬂagged mergenet. alternatively agglomeration algorithm neuroproof used transforming membrane probabilities segmentations tuned less sensitive merge errors. merge-sensitive setting could applied locations ﬂagged algorithm. thresholding step omitted output mergenet thought probability distribution merge errors objects within segmentation. distribution treated bayesian prior updated information available; multiple proofreading algorithms work together. thus example synapse detection algorithms provide additional evidence merge error synapses kinds found segmented object normally found diﬀerent types neurons. scenario probability relevant location would increased value computed mergenet according conﬁdence synapse detection algorithm. envision mergenet ﬁrst step towards fully automated proofreading connectomics data become increasingly necessary data processed ever greater scale. mergenet trained merge errors created fusing adjacent objects within segmentation. allows training proceed without direct human annotation. testing mergenet performed training several automatically generated segmentations data obtained good results even though training data free merge errors mistakes. highly advantageous eliminate need data annotation since step connectomics traditionally consumed human eﬀort. ability segmentation also means mergenet trained larger datasets manual annotation could reasonably obtained. automated segmentations already exist volumes neural tissue large cubic microns automatic detection merge errors allows compare performance alternative segmentation algorithms absence ground truth annotation. mergenet parameter settings segmentations within dataset training data. alternative segmentations produced diﬀerent versions state-of-the-art unet segmentation algorithm simpler algorithm largest objects within segmentation ﬂagged unlikely while advanced algorithm largest objects ﬂagged. indicates latter pipeline produces plausible objects making fewer merge errors. size objects comparable case indication improvement came greater propensity erroneous splits within single objects. thus mergenet able perform fully automatic comparison segmentation algorithms conﬁrm outperforms other. already observed mergenet trained reasonably correct segmentation. fact possible leverage artiﬁcial merge errors within training detect real merge errors occur remarkable since predictions mergenet makes case conﬂict labels trained namely objects training artiﬁcially merged nonetheless result real merge errors. observations align results showing neural networks capable learning data even labels given unreliable since mergenet makes global morphology neurons reliant earlier stages connectomics pipeline microscope images membrane predictions. thus able correct errors arise early stages pipeline including experimental stage. images prone various catastrophic errors; notably individual tissue slices tear imaging leading distortion gaps predicted membranes. algorithms stitch together adjacent microscope images also sometimes fail leading pieces neurons image erroneously aligned pieces neighboring image. typically errors propagated magniﬁed later stages connectomics pipeline since algorithms watershed neuroproof assume input mostly true. contrast mergenet look broader picture common sense would human proofreader. output membrane-detection algorithm also induce errors object morphology. common sources error stage ambiguously stained tissue slices intracellular membranes mitochondria confused external cell membrane. figure shows error predictions u-net algorithm large predicted membrane allowed objects fused together utilizing overall context mergenet able detect localize error figure glial cell ﬂagged merge error mergenet. glia merge errors also neurons occur training mergenet. algorithm recognizes morphology glia markedly different neurons. speciﬁcally training mergenet recognize glia could useful segmenting cells occur along neurons brain tissue. figure output mergenet merge error superimposed erroneously predicted membranes merge error. mergenet output individual pixels thresholded denoting predicted merge error blue absence error. observe predicted membranes wide region mergenet ﬂagged; incorrect membrane extend objects separating them. note mergenet used threedimensional morphological information detect error make membrane predictions shown underlying microscope images. challenges traditional connectomics algorithms numerous diﬀerent imaging techniques applied nervous systems various organisms cases also structurally distinct regions nervous system within single organism. networks used connectomics image segmentation often necessary obtain ground truth annotations dataset consumes considerable time eﬀort. mergenet contrast highly transferrable datasets. algorithm trained unveriﬁed segmentation correct also trained dataset segmentation diﬀerent dataset without retraining. figures show images obtained training segmentation kasthuri dataset running dataset. microscope data underlying connectomics segmentation often anisotropic particular dimensions directions depend upon particular imaging procedure used. tron microscopy various techniques proposed work anisotropic data including convnets feeding convnets combination convolutional recurrent networks mergenet cancels eﬀect anisotropy necessary downsampling diﬀerentially along directions. thus network able transform segmentation morphology approximately isotropic making learning much easier. also anticipate possible train data imaging modality apply diﬀerent downsampling ratio data diﬀerent anisotropy. example mergenet could trained segmentation segmentation. mergenet algorithm designed scalable used proofread segmentations extremely large datasets. network applied objects downsampled large factor dimension applied sampled points within downsampled object. reductions cost allow convnet scale even though kernels slower implement kernels. tested speed mergenet object original voxels downsampled voxels sampled allowing generate dense probability across entire object. convnet seconds nvidia tesla gpu. corresponds speed three million voxels second within original image. thus network could applied volume billion voxels minute using gpus. comparison fastest membrane-prediction algorithm process billion voxels within minutes core machine demonstrating algorithm integrated scalable connectomics pipeline. note experiments performed using tensorflow attempted optimize time training running network though recent work indicates signiﬁcant speedup possible mergenet trained merge errors also seems able detect non-neuronal objects byproduct learning plausible shapes neurons. particular observe mergenet often detects glia morphologies distinctively diﬀerent neurons. figure shows example glial object dataset; notice mergenet ﬁnds morphology implausible even though trained neither positive negative examples glia. quantifying accuracy glia detection challenging however since little ground truth annotated task connectomics algorithms unable distinguish glia. finally consider mergenet succeeds fails diﬀerent inputs. algorithm simply label branch points within neuron merge errors else would eﬀectively useless. however network confused examples branches diverge main segment approximately point resembling cross distinct objects. mergenet also misses merge errors. example neuronal segments closely parallel points along boundary morphological clues objects present. worth noting however parallel neuronal segments fact detected mergenet shown point figure though merge errors occur universally automated segmentations neural tissue never addressed generality diﬃcult detect using existing connectomics methods. shown convnet proofread segmented image merge errors zooming ignoring image itself instead leveraging general morphological characteristics neurons. demonstrated algorithm mergenet able generalize without retraining detect errors within range segmentations across range datasets. relying solely upon unsupervised training nonetheless detect errors within training set. algorithm enables automatic comparison segmentation methods integrated scale existing pipelines without requirement additional annotation opening possibility fully automated error detection correction within neural circuits. mergenet detect localize merge errors cannot itself correct them. could conceive variation mergenet algorithm used mark exact boundary merge error allowing made automatically along boundary correct merge without additional eﬀort. however practice much challenging task. often impossible determine exact division objects merge error purely morphology. instance largely parallel objects touch evident continuation past point contact even erroneous merge obvious. likewise merge errors consist three objects confused complex e.g. virtue poor image quality location. cases merge-correction algorithm must recourse underlying microscope images membrane probabilities rather relying purely upon morphological cues. deep learning approaches leveraging morphology potential transform biological image analysis. instance become possible classify types neurons automatically identify anomalies cancer cells. anticipate growth algorithms scale biological data grows progress connectomics leads deeper understanding brain. grateful support national science foundation grants iis- intelligence advanced research projects activity grant would like thank dean peter pope jeremy maitinshepard adam marblestone hayk saribekyan helpful discussions contributions.", "year": 2017}