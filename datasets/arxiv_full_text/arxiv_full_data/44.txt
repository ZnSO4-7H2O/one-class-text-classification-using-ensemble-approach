{"title": "Comparing Rule-Based and Deep Learning Models for Patient Phenotyping", "tag": ["cs.CL", "cs.AI", "cs.NE", "stat.ML"], "abstract": "Objective: We investigate whether deep learning techniques for natural language processing (NLP) can be used efficiently for patient phenotyping. Patient phenotyping is a classification task for determining whether a patient has a medical condition, and is a crucial part of secondary analysis of healthcare data. We assess the performance of deep learning algorithms and compare them with classical NLP approaches.  Materials and Methods: We compare convolutional neural networks (CNNs), n-gram models, and approaches based on cTAKES that extract pre-defined medical concepts from clinical notes and use them to predict patient phenotypes. The performance is tested on 10 different phenotyping tasks using 1,610 discharge summaries extracted from the MIMIC-III database.  Results: CNNs outperform other phenotyping algorithms in all 10 tasks. The average F1-score of our model is 76 (PPV of 83, and sensitivity of 71) with our model having an F1-score up to 37 points higher than alternative approaches. We additionally assess the interpretability of our model by presenting a method that extracts the most salient phrases for a particular prediction.  Conclusion: We show that NLP methods based on deep learning improve the performance of patient phenotyping. Our CNN-based algorithm automatically learns the phrases associated with each patient phenotype. As such, it reduces the annotation complexity for clinical domain experts, who are normally required to develop task-specific annotation rules and identify relevant phrases. Our method performs well in terms of both performance and interpretability, which indicates that deep learning is an effective approach to patient phenotyping based on clinicians' notes.", "text": "objective investigate whether deep learning techniques natural language processing used efficiently patient phenotyping. patient phenotyping classification task determining whether patient medical condition crucial part secondary analysis healthcare data. assess performance deep learning algorithms compare classical approaches. materials methods compare convolutional neural networks n-gram models approaches based ctakes extract pre-defined medical concepts clinical notes predict patient phenotypes. performance tested different phenotyping tasks using discharge summaries extracted mimic-iii database. results cnns outperform phenotyping algorithms tasks. average f-score model model f-score points higher alternative approaches. additionally assess interpretability model presenting method extracts salient phrases particular prediction. conclusion show methods based deep learning improve performance patient phenotyping. cnn-based algorithm automatically learns phrases associated patient phenotype. such reduces annotation complexity clinical domain experts normally required develop task-specific annotation rules identify relevant phrases. method performs well terms performance interpretability indicates deep learning effective approach patient phenotyping based clinicians’ notes. secondary analysis data electronic health records crucial better understand heterogeneity treatment effects individualize patient care. growing adoption rate ehrs researchers gain access rich data sets medical information mart intensive care mimic database informatics integrating biology bedside datamarts– explored numerous ways. data comprise structured data international classification diseases codes laboratory results medications unstructured data clinician progress notes. structured data require complex processing prior performing statistical tests conducting machine learning tasks majority recorded data exist unstructured form. applying natural language processing unstructured data conjunction analyzing structured data lead better understanding health diseases accurate phenotyping patients compare tests treatments.– patient phenotyping classification task determine whether patient medical condition pinpointing patients risk developing one. further intelligent applications patient phenotyping support clinicians reducing time spend chart reviews takes significant fraction daily workflow. popular approach patient phenotyping using based extracting relevant medical phrases texts using input build predictive model. dictionary relevant phrases task-specific development requires significant effort deep understanding task domain experts. different involved approach develop rule-based algorithm condition. tedious laborious task required clinicians build generalizable model patient phenotyping models automated classification using rarely developed outside research area. however recent developments deep learning provide opportunity build generalizable phenotyping model less intense domain expert involvement. applications deep learning healthcare shown promising results; examples include mortality prediction patient note de-identification skin cancer detection diabetic retinopathy detection. drawback deep learning models lack interpretability. interpretability means understand features model arrive predictions. since results directly impact health clinicians come expect healthcare applications interpretable models. moreover european union considering regulations require algorithms interpretable. much work done understand deep learning models make trained deep learning model interpretable– rely complex interactions inputs thus inherently less interpretable model uses predefined phrase dictionaries. work investigate application convolutional neural networks textbased patient phenotyping. cnns learn identify phrases text lead positive negative classification similar phrase dictionary approach outperform traditional approaches classification problems domains.– compare cnns traditional rule-based entity extraction systems using mayo clinical text analysis knowledge extraction system methods logistic regression models using n-gram features. compare performance total different phenotypes show cnns outperform extraction-based n-gram-based methods. finally evaluate interpretability model assessing learned phrases associated phenotype compare phrase dictionaries developed clinicians. ccurate patient phenotyping required secondary analysis ehrs correctly identify patient cohort investigation better identify clinical context. studies employing manual chart review process patient phenotyping naturally limited small number preselected patients. therefore necessary identify information contained text inconsistently captured accuracy structured data recurrence cancer whether patient smokes classification within autism spectrum drug treatment patterns. however unstructured data ehrs progress notes discharge summaries typically amenable simple text searches spelling mistakes ambiguous terms. help address issues researchers utilize dictionaries ontologies medical terminologies umls snomed. xamples systems employ databases knowledgemap concept identifier metamap ctakes. three identify words phrases within text provide medical concepts linked significantly reduce work required data scientists previously develop task-specific extractors. extracted entities filtered include concepts related patient phenotype investigation either used features model predicts whether patient fits phenotype input rule-based algorithms. liao describe process extraction rule-generation prediction general approach patient phenotyping using ctakes– test approach various data sets. role clinicians task develop task-specific dictionary phrases relevant patient phenotype. arrell developed separate rule-based phenotyping algorithms pathology documents clinical documents combined order identify recurrence breast cancer. find modular approach identifies recurrence note cost time required develop algorithm limits applicability large repeated tasks. moreover usable system would offset development costs address problem different specialized system would developed every task hospital. alpern address heavy workload clinicians describe semi-supervised approach problem uses anchor learn framework. scheme clinicians need define anchors phrases identify concepts high positive predictive value train supervised model uses combination structured data bag-of-words notes predict whether anchor exists note. showed method drastically reduces required effort clinicians yielding equivalent results. supervised approach aims reduce complexity clinicians achieving high sensitivity correctly capture whole patient cohort. furthermore develop algorithm create phrase dictionary patient phenotyping compare ctakes-based models. baseline models ctakes extract concepts note. ctakes sentences phases split tokens then tokens variations normalized base form. normalized tokens tagged part-ofspeech shallow parse tree constructed represent grammatical structure sentence. finally named-entity recognition algorithm uses information detect named entities exist concept unique identifiers umls. hile traditionally rules mostly fully hand-crafted modern methods relevant concepts note input machine learning algorithm directly learn predict phenotype. therefore specify different approaches using ctakes output. first approach uses complete list extracted cuis input processing steps. second approach clinicians specify dictionary comprising clinical concepts relevant desired phenotype predictive models replicate process described liao represent note number occurrences cuis. fact ctakes detects negations count occurrences negated non-negated cuis separately. features transformed continuous features using term frequency–inverse document frequency compared original representation bag-of-words note described halpern tf-idf features reflects importance feature note. accurate comparison approaches literature train random forest logistic regression model features. proposed model convolutional neural network text classification replicating architecture proposed collobert kim. idea behind convolutions computer vision learn transformation adjacent pixels single value similar filter. natural language processing model learns combinations subsequent words associated given concept. overview architecture shown figure major advantage cnns words text first projected distributed representations often referred word embeddings. word embeddings shown improve performance tasks based ehrs example ner. words occur similar contexts trained similar word embeddings. therefore misspellings synonyms abbreviations original word learn similar embeddings lead similar results. consequently database synonyms common misspellings required. word embeddings pre-trained larger corpus texts improves results system reduces amount data required train model. pre-train embeddings wordvec discharge notes available mimic-iii database. word embeddings words text classify concatenated used input convolutional layer. convolutions detect signal combination adjacent inputs. combine multiple convolutions different lengths evaluate phrases anywhere five words long illustrated figure combination many filters varying length results multiple outputs combined max-pooling. specifically max-over-time-pooling extract predictive value filter. resulting prediction model utilizes linear combination pooled features sigmoid function similar logistic regression. igure architecture model perform patient phenotyping. word within discharge note looked within table word embeddings maps embedding. example instances word embedding. convolutions different widths used learn filter applied embeddings word sequences corresponding length. convolution width example sequence length look combinations neighboring words output value each. resulting multiple vectors reduced single using max-over-time pooling detect highest value different convolutions. final prediction made computing weighted combination pooled values applying sigmoid function similar logistic regression. figure adapted permission kim. notes study extracted mimic-iii database. mimic-iii contains deidentified clinical data hospital admissions adult patients intensive care units beth israel deaconess medical center mimic-iii includes several types clinical notes including discharge summaries nursing notes study focus discharge summaries since informative patient phenotyping. investigate phenotypes associated ‘frequent flier’ many third readmissions suggested preventable; identifying modifiable risk factors crucial step reducing them. extracted first discharge summary frequent fliers mimic-iii well randomly selected summaries subsequent visits. additionally selected random summaries yielding total notes. ctakes output notes contains total unique cuis. discharge summaries annotated clinicians phenotypes shown table annotators study included clinical researchers taken medical college admission test junior medical residents senior medical residents practicing intensive care medicine physician table shows definition phenotype annotating clinicians instructed look improve inter-rater reliability. ensure high-quality labels minimize risk error note labeled least twice phenotype. case annotators unsure senior clinicians decided final label. resulting number occurrences phenotypes varies cases. cancers high imminent mortality mention distant multi-organ metastasis palliative care would considered consideration needing heart transplant; description severe aortic stenosis severe cardiomyopathy sufficient past medical history congestive heart failure myocardial infarction stent coronary artery bypass graft common. severe chronic obstructive pulmonary disease defined gold stage iii-iv normal fev/fvc severe interstitial lung disease chronic central nervous system spinal cord diseases multiple sclerosis myasthenia gravis amyotrophic parkinson’s disease stroke/cerebrovascular accident residual deficits various neuromuscular diseases/dystrophies. etiology chronic pain including fibromyalgia requiring long-term opioid/narcotic analgesic medication control. current/recent alcohol abuse history; still active problem time admission include intravenous drug abuse accidental overdose psychoactive narcotic medications admitting marijuana history sufficient. clinical obesity. previous history considered gastric bypass. insufficient abdominal obesity mentioned physical exam. psychiatric disorders dsm- classification including schizophrenia bipolar anxiety disorders depression. diagnosis depression; prescription anti-depressant medication; description intentional drug overdose suicide self-harm attempts. evaluate sensitivity f-score models. f-score derived confusion matrix results test set. confusion matrix contains four counts true positive false positive true negative false negative fraction correct predictions samples predicted given category. sensitivity also known recall percentage positive predictions relation predictions predicted positive. f-score harmonic mean sensitivity models split data training validation test set. labeled data used training validation test set. reported numbers obtained testing test set. validation used choose hyperparameters models. achieve fair comparison different types models compare different approaches each. compare performance models simple baselines based n-gram models check complicated model actually necessary whether simple co-occurrences words pick signals. therefore report numbers eight models baselines shown table description model proposed convolutional neural network architecture baseline uses bigrams text input logistic regression baseline uses trigrams text input logistic regression random forest uses full output ctakes logistic regression uses full output ctakes random forest uses clinician-filtered output ctakes logistic regression uses clinician-filtered output ctakes model used filters widths prevent overfitting dropout probability used l-normalization normalize word embeddings norm model trained using adadelta initial learning rate epochs. model implemented using torch framework. baseline models implemented using python scikit-learn library. compare interpretability approaches assessing phrases salient positive prediction global model-wide scale. evaluate filter model learned parameters correspond direct indication salient irrelevant cuis already removed clinicians making sure cuis relevant. compute modified saliency phrases. saliency neural networks defined norm gradient loss function respect input. alternative methods search local space around input compute layer-wise backpropagation.– input case single word embedding; evaluate whole phrase calculate norm convolutional layer positive predictions instead. approximates much phrase contributed prediction works well case. obtain important phrases globally classify evaluate documents test store indicative phrases. assess saliency local document level extract indicative phrases exist given document using methodologies. show overview f-scores different models phenotypes figure every phenotype outperforms approaches. phenotypes obesity schizophrenia outperforms models large margin. filtered models require much effort clinicians minimal improvement noisy input identified ctakes concepts. detailed results shown table observe outperforms baselines sensitivity values half ppv’s. cases simple n-gram baselines achieve high sensitivity. means models could efficiently used detect patients matter model overlooks positives example detect small at-risk population interventions. figure comparison achieved f-scores across tested phenotypes. models models left phenotype shown blue. ctakes-based models right red. achieves highest scores across phenotypes. show salient phrases according filtered ctakes models advanced heart disease table alcohol abuse table tables contain many phrases mentioned definition shown table cardiomyopathy. also observe mentions cabg table models common medical conditions associated advanced heart disease sufficient requirements diagnosed annotated annotation scheme. model still learned associate phrases advanced heart disease since phrases also occur many notes patients labeled positive advanced heart failure. argue overall loss interpretability looking learned phrases. moreover cuis extracted ctakes generic atrium heart heart salient phrases specific. phrases table illustrate detect mentions condition many forms. without human input learned etoh alcohol used synonymously thus detects phrases containing either them leads higher sensitivity. filtered ctakes model surprisingly ranks victim abuse higher direct mention alcohol abuse note finds indicative ethanol measurement taken. magnesium cardiomyopathy hypokinesia heart failure acetylsalicylic acid atrium heart coronary disease atrial fibrillation coronary artery disease aortocoronary bypasses fibrillation heart catheterization chest artery scans x-ray hypertension creatinine measurement salient phrases detected wall hypokinesis port pacer ventricular hypokinesis post status post bifurcation aneurysm clipping cardiomyopathy doi./amiajnl--. rumshisky uzuner annotating temporal information clinical narratives. biomed inform. ;s–s. doi./j.jbi.... stubbs uzuner annotating risk factors heart disease clinical narratives diabetic patients. biomed inf. ;s–s. doi./j.jbi.... jensen jensen brunak mining electronic health records towards better research applications clinical care. genet. doi./nrg. ananthakrishnan savova improving case definition crohn’s disease ulcerative colitis electronic medical records using natural language processing novel informatics approach. inflamm bowel dis. doi./mib.befd. topaz dowding automated identification wound information clinical notes patients heart diseases developing validating natural language processing application. nurs stud. doi./j.ijnurstu.... carrell halgrim tran using natural language processing improve efficiency manual chart abstraction research case breast cancer recurrence. doi./aje/kwt. gulshan peng coram development validation deep learning algorithm detection diabetic retinopathy retinal fundus photographs. jama. doi./jama... caruana gehrke koch sturm elhadad intelligible models healthcare predicting pneumonia risk hospital -day readmission. proc sigkdd conf knowl discov data doi./.. goodman flaxman regulations algorithmic decision-making right explanation. icml work interpret mach learn http//arxiv.org/abs/.. accessed february strobelt gehrmann huber pfister rush visual analysis hidden state dynamics recurrent neural networks. arxiv prepr arxiv. http//arxiv.org/abs/.. karpathy toderici shetty leung sukthankar fei-fei large-scale video classification convolutional neural networks. proceedings ieee conference computer vision pattern recognitio. savova masanz ogren mayo clinical text analysis knowledge extraction system architecture component evaluation applications. inform assoc. doi./jamia... carrell halgrim tran practice epidemiology using natural language processing improve efficiency manual chart abstraction research case breast cancer recurrence. epidemiol. ;kwt. doi./aje/kwt. strauss chao kwan ahmed schottinger quinn identifying primary recurrent cancers using sas-based natural language processing algorithm. inform assoc. doi./amiajnl--. lingren chen bochenek electronic health record based algorithm identify patients autism spectrum disorder. smalheiser plos one. doi./journal.pone.. savova olson murphy automated discovery drug treatment patterns endocrine therapy breast cancer within electronic medical record. informatics assoc. ;e-e. doi./amiajnl-. moore ganesan nelson standardized drug nomenclature links systems different vocabularies patient gets doctor ordered. rxnorm prescription electronic drug information exchange. denny choma peterson natural language processing improves identification colorectal cancer testing electronic medical record. decis mak. doi./x. perlis iosifescu castro using electronic medical records enable large-scale studies psychiatry treatment resistant depression model. psychol med. ;./s. doi./s. kang singh afzal mulligen kors using rule-based natural language processing improve disease normalization biomedical text. inform assoc. doi./amiajnl--. lecun bottou bengio haffner gradient-based learning applied document recognition. proc ieee. doi./.. jiang zhang study neural word embeddings clinical text. amia annu symp proc. luan watanabe harsham efficient learning spoken language understanding tasks word embedding based pre-training. proceedings annual conference international speech communication association interspeech. -janua. arras horn montavon müller samek &quot;what relevant text document?&quot; interpretable machine learning approach. december http//arxiv.org/abs/.. accessed january bach binder montavon pixel-wise explanations non-linear classifier decisions layer-wise relevance propagation. suarez plos one. doi./journal.pone.. razavian blecker schmidt smith-mclallen nigam sontag population-level prediction type diabetes claims data analysis risk factors. data. doi./big...", "year": 2017}