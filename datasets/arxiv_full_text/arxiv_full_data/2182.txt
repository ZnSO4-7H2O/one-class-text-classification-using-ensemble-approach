{"title": "Probabilistic Search for Structured Data via Probabilistic Programming  and Nonparametric Bayes", "tag": ["cs.AI", "cs.DB", "cs.LG", "stat.ML"], "abstract": "Databases are widespread, yet extracting relevant data can be difficult. Without substantial domain knowledge, multivariate search queries often return sparse or uninformative results. This paper introduces an approach for searching structured data based on probabilistic programming and nonparametric Bayes. Users specify queries in a probabilistic language that combines standard SQL database search operators with an information theoretic ranking function called predictive relevance. Predictive relevance can be calculated by a fast sparse matrix algorithm based on posterior samples from CrossCat, a nonparametric Bayesian model for high-dimensional, heterogeneously-typed data tables. The result is a flexible search technique that applies to a broad class of information retrieval problems, which we integrate into BayesDB, a probabilistic programming platform for probabilistic data analysis. This paper demonstrates applications to databases of US colleges, global macroeconomic indicators of public health, and classic cars. We found that human evaluators often prefer the results from probabilistic search to results from a standard baseline.", "text": "databases widespread extracting relevant data difﬁcult. without substantial domain knowledge multivariate search queries often return sparse uninformative results. paper introduces approach searching structured data based probabilistic programming nonparametric bayes. users specify queries probabilistic language combines standard database search operators information theoretic ranking function called predictive relevance. predictive relevance calculated fast sparse matrix algorithm based posterior samples crosscat nonparametric bayesian model high-dimensional heterogeneously-typed data tables. result ﬂexible search technique applies broad class information retrieval problems integrate bayesdb probabilistic programming platform probabilistic data analysis. paper demonstrates applications databases colleges global macroeconomic indicators public health classic cars. found human evaluators often prefer results probabilistic search results standard baseline. surrounded multivariate data difﬁcult search. consider problem ﬁnding university city campus student debt high investment student instruction tuition fees within certain budget. college scorecard dataset contains variables plus hundreds others. however choosing thresholds quantitative variables debt investment tuition requires domain knowledge. furthermore results grow sparse constraints added. figure shows results select query plausible thresholds question yields single match. paper shows formulate broad class probabilistic search queries structured data using probabilistic programming information theory. core technical idea combines search operators ranking function called predictive relevance assesses relevance database records query records context deﬁned variable interest. figures show examples expanding reﬁning result figure combining predictive relevance sql. predictive relevance probability candidate record informative answers speciﬁc class predictive queries unknown ﬁelds query records. paper presents efﬁcient implementation applying simple sparse matrix algorithm results inference crosscat result scalable domain-general search technique sparse multivariate structured data combines strengths search probabilistic approaches information retrieval. users query example using real records database familiar domain partially-speciﬁed hypothetical records less familiar. users narrow search results adding boolean ﬁlters including multiple records query rather single record. overview technique integration bayesdb shown figure demonstrate proposed technique databases colleges public health macroeconomic indicators cars late paper empirically conﬁrms scalability technique shows human evaluators often prefer results proposed technique results standard baseline. standard sql. using clause search university city campus student debt high investment student instruction tuition within budget sparsity dataset chosen thresholds boolean conditions clause single matching result shown table below. user needs iteratively adjust thresholds order obtain results match search query. relevance hypothetical record. search query instead speciﬁed hypothetical record relevance probability query order give top- ranked matches. results top-tier schools high teaching investment city large suburban campus student debt. however user surprised highly stringent admission rates colleges mostly duke university princeton university harvard university univ chicago mass inst technology calif inst technology stanford university yale university columbia university university penn. relevance observed records combined sql. combining search colleges relevant schools context instructional investment must less stringent admissions city campuses only. quantitative search metrics interest colleges result signiﬁcantly better national average mostly selective schools duke university georgetown univ johns hopkins univ vanderbilt univ university penn. carnegie mellon rice university univ southern calif cooper union york university figure combining predictive relevance probability bayesian query language standard techniques search college scorecard dataset. full data contains colleges variables available download collegescorecard.ed.gov/data. section outline basic set-up notations database search problem establish formal deﬁnition probability predictive relevance between records database. suppose dataset containing records instantiation p-dimensional random vector possibly missing values. notational convenience refer arbitrary collections observations using sets indices denote multivariate entities variables capitalized unobserved index small collection query records objective rank item relevant formulating predictions values context particular dimension formally deﬁne context subset dimensions arbitrary record random variable statistically dependent formalize intuition previous section precisely. denote probability predictively relevant context furthermore denote index dimension length-p random vectors statistically dependent dimension existing variables database. since indexes novel variable value random variable denote deﬁne probability predictively relevant context posterior probability mutual information query record general deﬁnition statistical dependence non-zero mutual information context variable. however method detecting dependence variables context arbitrary e.g. using linear statistics pearson-r directly estimating mutual information others. symbol refers arbitrary hyperparameters govern distribution dimension context-speciﬁc hyperparameter controls prior structural dependencies rantual information well-established measure strength predictive relationships random variables deﬁned usual figure illustrates predictive relevance probability terms hypothesis test competing graphical models mutual information non-zero panel indicating predictive relevance; zero panel indicating predictive irrelevance. formulation predictive relevance terms mutual information variables related idea property induction cognitive science literature subjects asked predict whether entity property given entity property; e.g. likely cats disease given mice known disease? bayes sets deﬁnes bayes factor ratio marginal likelihoods used hypothesis testing without assuming structure prior. hand predictive relevance deﬁnes posterior probability whose value therefore requires prior dependence structure records bayes sets draws inferences using query candidate rows without considering rest data predictive relevance probabilities necessarily figure predictive relevance collection query records candidate record context variable computes probability drawn generative process versus different generative processes. latent variables indicators generative process records; distributional parameters data model variable hyperparameter dictates prior dictates prior distributional parameters symbol denotes dimension statistically dependent values observed either conditioned hyperparameters knowing carries information unknown values whereas not. conditioned finally bayes sets considers entire data vectors scoring whereas predictive relevance considers dimensions context variable making possible records predictively relevant context probably predictively irrelevant another. block crosscat’s combinatorial structure requires detailed notation track latent variables dependencies them. generative process exchangeable sequence random vectors summarized below. section describes cross-categorization prior outlines algorithms crosscat efﬁciently estimate predictive relevance probabilities sparse highdimensional heterogenously-typed data tables. crosscat nonparametric bayesian model learns full joint distribution variables using structure learning divide-and-conquer. generative model begins partitioning variables blocks using chinese restaurant process. step crosscat’s outer clustering since partitions columns data table variables correspond columns records correspond rows. denote partition whose k-th block variables mutually independent variables within block variables follow dirichlet process mixture model focus case joint distribution factorizes given latent cluster assignment step inner clustering crosscat since speciﬁes cluster assignment concentration hyperparameter column concentration hyperparameter index variable column partition list variables block column partition cluster index partition block list rows cluster block joint distribution data variable hyperparameters r-th observation variable unique items list figure bayesdb workﬂow computing context-speciﬁc predictive relevance database records. modeling inference bayesdb produces ensemble posterior crosscat model structures. structure speciﬁes column partition factorization joint distribution variables database using chinese restaraunt process; separate partition within block variables using dirichlet process mixture. column partition clusters variables different contexts variables context probably dependent another. context partition clusters records probably informative another. end-user queries predictive relevance expressed bayesian query langauge. interpreter aggregates relevance probabilities across ensemble ranking function probabilistic order query. assumption sufﬁces development predictive relevance applicable broad class statistical data types conjugate prior-likelihood representations betabernoulli binary dirichlet-multinomial categorical normal-inverse-gamma-normal real values gamma-poisson counts. given dataset refer obermeyer mansinghka scalable algorithms posterior inference crosscat assume access ensemble posterior samples realization variables table describe posterior samples crosscat efﬁciently estimate predictive relevance probability letting denote context variable formalize novel variable fresh column tabular population assigned block shown saad mansinghka structural dependencies induced crosscat’s variable partition related upper-bound probability exists statistical dependence estimate ﬁrst treat mutual information derived random variable function random cluster assignments section show greatly optimize naive nested for-loop implementation algorithm instead computing predictive relevance single matrix-vector multiplication. deﬁne pairwise cluster co-occurrence matrix block crosscat sample binary entries furthermore denote length-n vector indexes otherwise. vectorize across resulting length-n vector satisﬁes identify argument indicator function finally averaging across samples arrive vector relevance probabilities. large datasets constructing matrix using operations prohibitively expensive. algorithm describes efﬁcient procedure exploits crosscat’s sparsity build expected time using sparse matrix representation crosscat’s partition data structures avoid considering pairs rows. fast construction means practical implement large data tables. algorithm’s running time depends number clusters |set| line average number rows cluster line data structures used represent line prior expected number clusters implies average occupancy rows cluster. sparse binary matrix stored list-of-lists representation update line requires time. furthermore emphasize since depend cost construction amortized arbitrary number queries. ﬁnal implication follows directly definition mutual information note depend particular choice indeed hyperparameter never represented explicitly. moreover hyperparameter concentration dirichlet process crosscat partitions. denotes cluster assignment partition according sample ˆφh. algorithm outlines procedure formulating monte carlo based estimator predictive relevance query using crosscat. require ensure predictive relevance existing existing crosscat sample retrieve context block query different clusters irrelevant cluster relevant average relevances return assumed query records must consist items already exist database. section relaxes restrictive assumption illustrating compute relevance probabilities search records exist instead speciﬁed user per-query basis idea incorporate records crosscat sample using gibbs-step sample cluster assignments joint posterior compute updated samples; unincorporate records leaving original samples unmutated. served) rows query compute ﬁrst applying crosscat-incorporate-record sequentially. sequential incorporation corresponds sampling sequence predictive distributions which exchangeability ensures updated contains sample cluster assignments joint distribution guaranteeing correctness monte carlo estimator note since crosscat speciﬁes non-parametric mixture proposal clusters include existing clusters plus singleton cluster next update cooccurrence matrices time linear size sampled cluster evaluate unincorporate reverse lines restore co-occurrence matrices. figure conﬁrms runtime scaling asymptotically linear varying number rows fraction variables speciﬁed rows context block number clusters context block number variables context block. figure empirical measurements asymptotic scaling crosscat-incorporate-record gapminder dataset color measurement indicates number variables block context variable; column shows different number records incorporated algorithm. panels shows that ﬁxed number variables context runtime decays linearly sparsity hypothetical records lower panels show runtime increasing linearly number clusters context; number variables context dictates slope curve. section illustrates efﬁcacy predictive relevance bayesdb applying technique several search problems real-world sparse highdimensional datasets public interest. college scorecard federal dataset consisting colleges variables used measure improve performance institutions higher education. variables include broad categories appendix contains application dataset classic cars appendix formally describes integration relvance probability bayesdb expression bayesian query language concept low-income nations post-soviet nations western democracies small wealthy nations qatar bahrain kuwait emirates singapore israel gibraltar bermuda jersey cayman islands representative countries concept burundi ethiopia uganda benin malawi rwanda togo guinea senegal afghanistan malawi russia ukraine bulgaria belarus slovakia serbia croatia poland hungary romania latvia france britain germany netherlands italy denmark finland sweden norway australia japan figure pairwise heatmaps countries gapminder dataset contexts life expectancy birth exports goods services using crosscat predictive relevance cosine similarity. column matrix country cell value indicates strength match countries. crosscat learns sparse relevances; life expectancy broadly correspond common-sense taxonomies countries based shared geographic political macroeconomic characteristics. concepts manually labeled inspecting clusters countries matrix colors matrix correspond countries table belong concept color. note relevance structure differs signiﬁcantly ranking context exports shown colors matrix clusters mutually relevant countries form different pattern cosine similarity learns dense noisy sets spuriously high-ranking countries coarser structure shown refer appendix baselines. campus characteristics academic programs student debt tuition fees admission rates instructional investments ethnic distributions completion rates. analyzed subset schools variables categories listed above. suppose student interested attending city university desired speciﬁcations. starting standard boolean search figure matching record requires iteratively rewriting search conditions retrieve results. figure instead expresses search query hypothetical predictive relevance query topranking records contain ﬁrst-rate schools admission rates much stringent. figure user re-expresses query rank schools predictive relevance context instructional investment subset ﬁrst-rate schools discovered combining order predictive relevance boolean conditions clause returns anset top-quality schools city-campuses less competitive quantitative metrics much better national averages. gapminder extensive longitudinal dataset global macroeconomic variables population growth education climate trade welfare health countries. experiments based cross-section data year data sparse data missing. figure shows heatmaps pairwise predictive relevances countries dataset different contexts compares results cosine similarity. clusters predictively relevant countries form common-sense taxonomies; refer caption discussion. figure ﬁnds top- countries dataset ordered predictive relevance united states context life expectancy birth. table shows representative variables context; variables highest dependence probability context variable according monte carlo estimate using posterior crosscat samples. countries figure rich western democracies highly developed economies advanced healthcare systems. figure comparing human preferences top-ranked countries returned cosine similarity versus crosscat predictive relevance representative search queries query human subjects given relevant countries according cosine crosscat asked choose results preferred any. scored responses following countries returned cosine relevant countries returned crosscat relevant both results equally relevant x-axis shows scores averaged across humans surveyed cloud crowdflower.com. error bars represent standard error mean. queries human preferences biased favor crosscat’s rankings. details experimental design results given appendix paper shown perform probabilistic searches structured data combining ideas probabilistic programming information theory nonparametric bayes. demonstrations suggest technique effective sparse real-world databases multiple domains produce results human evaluators often preferred standard baseline. empirical evaluation clearly needed ideally including tests hundreds thousands queries complex query types comparisons query results manually provided human domain experts. fact search predictive relevance context variables drawn learned representations data could potentially provide meaningful compare representation learning techniques. also fruitful build distributed implementation suitable database representations web-scale data including photos social network users pages. relatively unstructured probabilistic models topic models proved sufﬁcient making unstructured text data accessible useful. hope paper helps illustrate potential structured probabilistic models improve accessibility usefulness structured data. measles mumps rubella vaccines mortality rate dead children woman access improved sanitation facilities access improved drinking water sources human development index body mass index murder rate food supply contraceptive prevalence alcohol consumption prevalence tobacco among adults figure using search countries gapminder dataset ranked relevance united states context life expectancy birth ﬁnds rich western democracies advanced healthcare systems. nique representative search queries obtained results query. figure shows queries human preferences results predictive relevance versus results cosine similarity country vectors. deﬁned context cosine similarity -dimensional vectors dimensions selecting variables dependent context variable according crosscat’s dependence probabilities. deal sparsity cosine similarity cannot handle natively imputed missing values using sample medians; imputation techniques like mice resulted little difference feras saad vikash mansinghka. detecting dependencies sparse multivariate databases using probabilistic programming non-parametric bayes. proceedings twentieth international conference artiﬁcial intelligence statistics. jmlr.org authors wish acknowledge ryan rifkin anna comerford marie huber richard tibbetts helpful comments early drafts. research supported darpa iarpa ofﬁce naval research army research ofﬁce gifts analog devices google. council economic advisers. using federal data measure improve performance u.s. institutions higher education. technical report executive ofﬁce president united states vikash mansinghka richard tibbetts baxter shafto baxter eaves. bayesdb probabilistic programming system querying probable implications data. corr abs/. vikash mansinghka patrick shafto eric jonas petschulat gasner joshua tenenbaum. crosscat fully bayesian nonparametric method analyzing heterogeneous high dimensional data. journal machine learning research radford neal. markov chain sampling methods dirichlet process mixture models. journal computational graphical statistics fritz obermeyer jonathan glidden eric jonas. scaling proceedings sevsubsample-annealing. enteenth international conference artiﬁcial syntaxes bayesian query language allow user express predictive relevance queries query arbitrary combination existing hypothetical records. implement predictive relevance expression following syntaxes depending speciﬁcation query records. expression formally implemented -row estimand speciﬁes record table. shown expressions above query records speciﬁed user ways giving collection existing rows whose primary indexes either speciﬁed manually retrieved using arbitrary <expression>; specifying hypothetical records <values> list column-value pairs. rows ﬁrst incorporated using algorithm section unincorporated query ﬁnished. <context-var> variable tabular population. -row function structured query language relevance probability expression used variety settings. typical use-cases shown following examples existing query rows simplicity. figure top- ranking countries returned predictive relevance cosine similarity queries used human evaluation figure country-context search query showed seventy subjects pair tables. asked subject select table contains relevant results search query report tables contain equally relevant results. tables show top-ranked countries using crosscat predictive relevance cosine similarity histogram human responses. caption figure describes converted histograms scores displayed main text. tables showing countries ranked using crosscat predictive relevance saudi arabia united states australia bangladesh bulgaria japan qatar hong kong singapore figure pairwise heatmaps countries gapminder dataset context life expectancy birth using various distance similarity measures country vectors. heatmap labeled imputation technique number variables context techniques struggle sparsity structures much noisier results relevance probability shown figure table suppose customer wishes purchase classic budget desired technical speciﬁcations. ﬁrst load cars variables bayesdb table specify search conditions boolean ﬁlters clause. sparsity table record returned. obtain relevant results user needs broaden speciﬁcations query. building crossscat models bayesdb cars_ population learns full joint probabilistic model variables. estimate dependence probability query allows user plot heatmap probable dependencies characteristics. context price probably contains majority variables search query. using order relevance probability ranks table relevance user’s speciﬁcations speciﬁed hypothetical row. top- ranked cars probability relevance search query context price shown table below. user inspect characteristics subset cars ones like best.", "year": 2017}