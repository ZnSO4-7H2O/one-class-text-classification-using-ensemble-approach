{"title": "Constraint Reduction using Marginal Polytope Diagrams for MAP LP  Relaxations", "tag": ["cs.CV", "cs.AI"], "abstract": "LP relaxation-based message passing algorithms provide an effective tool for MAP inference over Probabilistic Graphical Models. However, different LP relaxations often have different objective functions and variables of differing dimensions, which presents a barrier to effective comparison and analysis. In addition, the computational complexity of LP relaxation-based methods grows quickly with the number of constraints. Reducing the number of constraints without sacrificing the quality of the solutions is thus desirable.  We propose a unified formulation under which existing MAP LP relaxations may be compared and analysed. Furthermore, we propose a new tool called Marginal Polytope Diagrams. Some properties of Marginal Polytope Diagrams are exploited such as node redundancy and edge equivalence. We show that using Marginal Polytope Diagrams allows the number of constraints to be reduced without loosening the LP relaxations. Then, using Marginal Polytope Diagrams and constraint reduction, we develop three novel message passing algorithms, and demonstrate that two of these show a significant improvement in speed over state-of-art algorithms while delivering a competitive, and sometimes higher, quality of solution.", "text": "abstract relaxation-based message passing algorithms provide eﬀective tool inference probabilistic graphical models. however diﬀerent relaxations often diﬀerent objective functions variables diﬀering dimensions presents barrier eﬀective comparison analysis. addition computational complexity relaxation-based methods grows quickly number constraints. reducing number constraints without sacriﬁcing quality solutions thus desirable. propose uniﬁed formulation existing relaxations compared analysed. furthermore propose tool called marginal polytope diagrams. properties marginal polytope diagrams exploited node redundancy edge equivalence. show using marginal polytope diagrams allows number constraints reduced without loosening relaxations. then using marginal polytope diagrams constraint reduction develop three novel message passing algorithms demonstrate show signiﬁcant improvement speed state-of-art algorithms delivering competitive sometimes higher quality solution. school computer science technology northwestern polytechnical university xi’an china shaanxi provincial laboratory speech image information processing xi’an china school computer science university adelaide adelaide australia enforcing local consistency edges clusters. attractive property approach guaranteed optimal solution labels integers. particularly signiﬁcant light fact kumar showed relaxation provides better approximation quadratic programming relaxation second order cone programming relaxation despite success remain variety large-scale problems oﬀ-the-shelf solvers solve moreover shown relaxations large dual objective decoded primal objective fail optimal solution many real-world problems. response shortcoming number dual message passing methods proposed including dual decompositions generalised product linear programming methods still computationally expensive large number constraints relaxations. desirable reduce number constraints order reduce computational complexity without sacriﬁcing quality solution. however non-trivial inference problem dimension primal variable diﬀerent various relaxations. also presents barrier eﬀectively comparing quality relaxations corresponding message passing methods. furthermore message-passing methods stuck non-optimal solutions non-smooth dual objectives contributions propose uniﬁed form relaxations existing relaxations rewritten constrained optimisation problems variables dimension objective; present tool call marginal polytope diagram eﬀectively compare diﬀerent relaxations. show relaxation uniﬁed form marginal polytope diagram vice versa. establish propositions conveniently show equivalence seemingly diﬀerent marginal polytope diagrams; using marginal polytope diagrams show safely reduce number constraints without sacriﬁcing quality solution propose three message passing algorithms dual; show perform message passing dual without computing storing messages propose cluster pursuit strategy. assume variables x··· taking discrete states vals. {··· denote node collection subsets associated group potentials i∈c. given graph potentials consider following exponential family distribution compared marginal polytope arbitrary local marginal polytope marginal distributions common distribution much fewer constraints local marginal polytope. result relaxation solved eﬃciently. particular practical signiﬁcance state-of-the-art interior point simplex solvers handle problems hundred thousand variables constraints many real-world datasets demand variables constraints several message passing-based approximate algorithms proposed solve large scale relaxations. applies coordinate descent dual objective relaxation problem particular local marginal polytope. diﬀerent local marginal polytopes diﬀerent local marginalisation constraints leads diﬀerent dual problems hence diﬀerent message updating schemes. globerson jaakkola showed relaxations also solved message passing known product node edge potentials considered generalised mplp potentials clusters considered. µc\\ss known copy variable. βc\\ss dual variable associated ﬁrst group constraints above using standard lagrangian yields following dual problem λˆc→s. iteration dual objective always decreases thus guaranteeing convergence. certain conditions gmplp ﬁnds exact solution. sontag extended idea iteratively adding clusters reported faster convergence empirically. subgradient coordinate descent used minimise dual objective. since dual decomposition using coordinate descent closely related gmplp uniﬁed form present give update rule derived coordinate descent below minimum dual objective. showed ﬁnding tightest cycles maximise decrease dual objective np-hard. thus instead looked frustrated cycles correspond cycles smallest cycle inequalities. searching frustrated cycles adding cycles’ inequalities updating dual repeated algorithm converges. diﬀerent relaxations formulations objective also dimension primal variable vary makes comparison difﬁcult. illustration note primal variable gmplp call extended cluster called extended cluster. )c∈c subset refer sub-cluster. choices correspond existing even inference algorithms shown later additional restriction must satisﬁed result work cover relaxations gmplp redundant constraints like used derive message cluster approach however fact generalisation gmplp note suggests dual decomposition achieve lower quality solution slower convergence gmplp show using uniﬁed formulation relaxation dual decomposition derived arbitrary local marginal polytopes refer type dual decomposition generalised dual decomposition forms basic framework eﬃcient algorithms presented section contradict result reported dual decomposition cycle inequalities converges faster terms running time gmplp. datasets order clusters dual decomposition cycle inequalities runs faster better cluster pursuit strategy. datasets higher order potentials worse performance gmplp. variable λc→c always cancelled out. result λc→c arbitrary value. optimise coordinate descent. ﬁxing λc→s except )s∈s\\{c} yeilds sub-optimisation problem derivation proof proposition provided section supplementary material. often referred beliefs λc→s messages known depend λc→s. summarise message updating procedure algorithm dual decomposition seen special case speciﬁc local marginal polytope proposition single step coordinate descent dual decrease non-negative. thus message passing produces monotonically decreasing sequence since sequence lower bound sequence must converge. note proposition guarantee reaches limit ﬁnite steps however practice observe often converges ﬁnite steps. following proposition part explains decoding reasonable. involves updating many messages {c}). messages used compute beliefs bt∀t show directly update optimising determined supplementary). thus bs)s∈s\\{c} beliefs determined b∗cs beliefs determined λ∗cs. following proposition. proposition optimising beliefs b∗cs computed determined arbitrary following memory conservation message updating based methods message passing algorithm max-sum diﬀusion gmplp messages potentials need stored order compute messages example). however proposed belief propagation without messages needs store beliefs. beliefs simple take space potentials exact solution exists dual objective decoded primal objective. various approaches including tighten gap. approaches typically involve steps creating dictionary clusters search best cluster dictionary w.r.t. score function. typically fig. stealth clusters v.s. disagreeing stealth clusters dataset sidechain. left cluster pursuit ﬁrst time problems right multiple cluster pursuits problem dual decrease popular choice score function. example sontag brutal force search dictionary cluster maximum dual decrease. batra accelerate process computing primal dual clusters dictionary ﬁrst search clusters non-zero primal dual gaps cluster maximum dual decrease. section show cluster pursuit strategy dynamically generates dictionary clusters instead using ﬁxed one. cluster pursuit strategy based special type cluster call stealth clusters. proposition essentially says exist maximisers agree however situation decoding diﬀerent clusters disagree. consider clusters deﬁnition according proposition exists maximiser agrees maximiser agrees however multiple maximisers maximisers could diﬀerent. means disagree overlap. adding {s|s least maximiser become according proposition observation yields strategy dynamically generate dictionary clusters tighten relaxation. practice clusters lead largest dual decrease. observations cluster pursuit strategy call stealth cluster pursuit strategy summarised algorithm nutshell search disagreeing clusters maximise dual decrease. worst case slow many disagreeing stealth clusters exist. however practice fast. figure number disagreeing stealth clusters less total number stealth clusters leads signiﬁcant speed importantly stealth cluster pursuit makes feasible tighter relaxation gmplp turn tighter dual decomposition stealth cluster pursuit bigger bigger clusters would become prohibitively expensive solve. experiments it’s always computationally aﬀordable. isn’t order terms approximate furthermore frustrated cycle search strategy acceleration evaluating primal dual ﬁrst applicable well. convergence consistency stealth cluster pursuit seen adding constraints only. matter clusters added dual decrease always no-negative. thus stealth cluster pursuit still convergence consistency properties original presented section relaxation based message passings slow many constraints. motivates seek ways reducing number constraints reduce computational complexity without sacriﬁcing quality solution. ﬁrst propose tool call marginal polytope diagrams. tool show reduce constraints without loosening optimisation problem. remarks previous work vein includes region graphs hasse diagrams distinguishes marginal polytope diagrams however fact receivers edge subset senders region graphs hasse diagrams require edge’s receivers must proper subset senders. example deﬁnition region graph page requires receiver must proper subset sender region graph. likewise page authors state region graph must directed acyclic graph means edge’s receivers must proper subset senders particularly signiﬁcant since dual message passing algorithms send messages cluster itself. hasse diagrams restriction corresponds special case marginal polytope diagram algorithms local marginalisation constraints cluster required thus violating proper subset requirement. hasse diagrams region graphs inapplicable case. example section gmplp sends messages cluster itself requires local marginalisation constraint cluster itself. message λij→ij edge itself requires local marginalisation constraint edge itself. proposed marginal polytope diagram handles situations also provides fig. example marginal polytope diagram. left factor graph middle marginal polytope diagram associated local marginal polytope gmplp. right marginal polytope diagram associated local marginal polytope dual decomposition. marginal polytope diagrams rectangles represent nodes similar hasse diagrams example given figure marginal polytope diagram associated gmplp edges node itself allowed region graphs hasse diproof provided section supplementary. figure give examples types edge equivalence proposition furthermore following proposition always holds. equivalent deﬁnition edge equivalence given marginal polytope diagram graph following operations would change corresponding local marginal polytope. composing operations above able derive series operations would change corresponding local marginal polytope. illustration using operation ﬁrst using operation would lead operation replacing existing edge equivalent edge. repeating operation merge several equivalent edges edge. repeating operation using operation replace group equivalent edges equivalent edge. equivalent edges oﬀer eﬀective reduce constraints. composing basic operations section series operations would change corresponding local marginal polytope. illustration partition several equivalent classes equivalence edges simply pick arbitrarily many edges equivalent class marginal polytope diagram fewer edges. edge corresponds local marginalisation constraint number constraints eﬃciently reduced operations. shown figure time iteration. hand fewer constraints means fewer coordinates thus algorithm likely stuck corners non-smoothness dual objective nature coordinate descent means minimal number constraints always good choice. shall next section trade-oﬀ minimal number constraints maximal number constraints performs best. propose three eﬃcient algorithms inference using different constraint reduction strategies three algorithms based belief propagation procedure equivalent message passing thus theoretical properties section also hold three algorithms. derive algorithms ﬁrst construct local marginal polytope initial local marginal polytope diﬀerent constraint reduction strategies three diﬀerent algorithms. arbitrary graph {c|c )c∈c corresponding local marginal polytope becomes ml). fact sp∀c applying belief propagation without messages yields following belief propagation form thus deﬁne )c∈cπ corresponding marginal polytope becomes ml). fact sπ∀c applying belief propagation without messages results following belief propagation form thus deﬁne )c∈cm corresponding local marginal polytope becomes ml). fact sm∀c applying belief propagation without messages yields following belief propagation relaxation solved using standard solvers cplex gurobi lpsolve etc.. however inference problems experiments relaxations typically variables constraints. slow standard solvers case. even stateof-the-art commercial solvers cplex reported slower message passing based algorithms thus compare methods message passing based algorithms. compare proposed algorithms power algorithm π-system algorithm maximalcluster intersection algorithm competitors gmplp triplet cluster pursuit gmplp stealth cluster pursuit dual decomposition triplet cycle cluster pursuit algorithms belief propagation/message passing original constraints several iterations belief propagation dual decoded primal diﬀerent cluster pursuit strategy applied tighten relaxations. brief summary methods provided table max-sum diﬀusion shown empirically inferior gmplp similarly trw-s shown inferior gmplp higher order potential case thus compare primarily sontag gmplp. note sontag considered state-of-the-art. implement algorithms gmplp c++. sontag released code. algorithms framework similar algorithm describe termination criteria algorithms using notation algorithm algorithms threshold inner loop maximum number iterations light faster convergence observed empirically threshold outer loop cluster pursuit clusters maximum running time tmax hour. based algorithms implemented either message passing procedure belief propagation procedure without messages. implemented both observed similar speed course latter uses less storage. presentation clarity report result using belief propagation without messages here. computational eﬃciency optimised sontag al.’s released code done gmplp well ensure fair comparison. algorithms compiled option -fomit-frame-pointer -pipe -ﬀast-math using clang-. experiments running single thread ram. marginal polytope looser gmplp methods. shown figure proposed methods converge much faster gmplp+s gmplp+t sontag. also sontag’s dual objective decoded primal objective much larger methods gmplp consider protein-protein interaction inference problems used problem typically nodes potentials deﬁned nodes edges triplets. since highest order potentials local marginal polytopes methods tight. thus performance diﬀerence mainly diﬀerent cluster pursuit strategies computational complexity iteration. test methods problems. average running time iteration updating beliefs messages table proposed methods smallest average running time followed sontag gmplp. present dual objective plots problems figure here provide results problems supplementary overall proposed methods converge fastest exact solutions problems protein protein protein. sontag ﬁnds exact solutions protein protein achieved smallest dual objective values problems methods failed exact solutions. terms convergence sontag converges slower proposed methods faster gmplp. gmplp+t exact solution problems gmplp+s ﬁnds exact solution protein only. graph structure figure follow potentials colour terms computed details including parameter settings provided supplementary material. segment three images banana book bool msrc grabcut dataset resolution images varies inference problems nodes potentials. sontag failed exact solutions images. gmplp+s gmplp+t exact solution book only. proposed methods exact solution three problems. result shown figure third figure proposed method converges much faster competitors. fourth figure inference error rate reduced quickest zero proposed methods. fig. image segmentation results. first original images; second segmentations corresponding exact solutions inference problems; third decoded primal objectives dual objectives fourth error rate plots. column corresponds results image. correspondence case. however strategy gives rise danger potentially important points removed too. also small scale problem allows take states. experiment keep points situation face issues needs storage potentials beliefs; points source image corresponding points destination image. ﬁrst issue computational eﬃciency. second issue extend models handle potential lack correspondence. node higher order potentials deﬁned follows user speciﬁed parameters ]i∈f column vector computed solving figure converges fastest among methods images followed total running time number iterations required reach exact solution matching problems reported tables several cases takes abnormally long time trapped local optimum cluster pursuit applied escape basin attraction. proposed methods take less running time iterations cases number constraints variables suﬃciently reduced without loosening local marginal polytope. proposed uniﬁed formulation relaxations allows conveniently compare diﬀerent relaxation diﬀerent formulations objectives diﬀerent dimensions primal variables. uniﬁed formulation tool marginal polytope diagram proposed describe fig. image matching result. rows images matching results; middle rows decoded primal dual bottom rows error rate plots. means matching image image dataset nodes. relaxations. group propositions easily equivalence diﬀerent marginal polytope diagrams. thus constraint reduction carried removal redundant nodes replacement equivalent edges marginal polytope diagram. together uniﬁed formulation constraint reduction also proposed three message", "year": 2013}