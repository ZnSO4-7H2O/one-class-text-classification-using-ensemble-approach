{"title": "Collaborative Filtering Bandits", "tag": ["cs.LG", "cs.AI", "stat.ML"], "abstract": "Classical collaborative filtering, and content-based filtering methods try to learn a static recommendation model given training data. These approaches are far from ideal in highly dynamic recommendation domains such as news recommendation and computational advertisement, where the set of items and users is very fluid. In this work, we investigate an adaptive clustering technique for content recommendation based on exploration-exploitation strategies in contextual multi-armed bandit settings. Our algorithm takes into account the collaborative effects that arise due to the interaction of the users with the items, by dynamically grouping users based on the items under consideration and, at the same time, grouping items based on the similarity of the clusterings induced over the users. The resulting algorithm thus takes advantage of preference patterns in the data in a way akin to collaborative filtering methods. We provide an empirical analysis on medium-size real-world datasets, showing scalability and increased prediction performance (as measured by click-through rate) over state-of-the-art methods for clustering bandits. We also provide a regret analysis within a standard linear stochastic noise setting.", "text": "items. classical setting well-known coldstart problem namely lack accumulated interactions users items needs addressed instance turning hybrid recommendation methods practice many relevant recommendation domains dynamic sense user preferences active users change time. recommendation domains distinguished much often user preferences content universe change highly dynamic recommendation domains news videos active users user preferences ﬂuid hence classical collaborative ﬁltering-type methods matrix tensor-factorization break down. settings essential recommendation method adapt shifting preference patterns users. dits shown excellent solution dynamic domains eﬀective standard contextual bandits take collaborative information account users interacted similar items past deemed similar taste based fact alone items chosen group users also considered similar. signiﬁcant limitation current bandit methodology address work. past eﬀorts problem based using online clustering-like algorithms graph network structure data conjunction multi-armed bandit methods commercial large scale search engines information retrieval systems examples highly dynamic environments users items could described terms membership preference cluster. instance music recommendation scenario groups listeners clustered around music genres clustering changing across diﬀerent genres. hand individual songs could naturally grouped sub-genre performer based fact tend preferred group users. evidence collected suggests that least speciﬁc recommendation scenarios like movie recommendation data well modeled clustering user item sides paper introduce collaborative filtering based stochastic multi-armed bandit method allows ﬂexible generic integration information users items interaction data alternatively clustering user item sides. speciﬁcally describe analyze classical collaborative ﬁltering content-based ﬁltering methods learn static recommendation model given training data. approaches ideal highly dynamic recommendation domains news recommendation computational advertisement items users ﬂuid. work investigate adaptive clustering technique content recommendation based exploration-exploitation strategies contextual multi-armed bandit settings. algorithm takes account collaborative eﬀects arise interaction users items dynamically grouping users based items consideration time grouping items based similarity clusterings induced users. resulting algorithm thus takes advantage preference patterns data akin collaborative ﬁltering methods. provide empirical analysis medium-size real-world datasets showing scalability increased prediction performance state-of-the-art methods clustering bandits. also provide regret analysis within standard linear stochastic noise setting. filtering recommending; recommender systems; online learning; collaborative filtering; clustering; bandits; regret; computational advertising recommender systems essential part many successful on-line businesses e-commerce on-line streaming beyond. moreover computational advertising seen recommendation problem user preferences highly depend current context. fact many recommendation domains youtube video recommendation news recommendation classical description recommendation scenario whereby users essentially ﬁxed preferences interact ﬁxed permission make digital hard copies part work personal classroom granted without provided copies made distributed proﬁt commercial advantage copies bear notice full citation ﬁrst page. copyrights components work owned others must honored. abstracting credit permitted. copy otherwise republish post servers redistribute lists requires prior speciﬁc permission and/or fee. request permissions permissionsacm.org. sigir july pisa italy acm. isbn ----//. http//dx.doi.org/./. known vector hosted user users cluster w.r.t. diﬀerent clusters w.r.t. parameter independent standard linear bandit setting references therein) unknown vector determines behavior user concretely upon receiving context vector user reacts delivering payoﬀ value conditionally zero-mean bounded variance noise term that conditioned past quantity indeed expected payoﬀ observed user context vector notice unknown parameter vector associate user supposed time invariant model. since facing sequential decision settings learning system needs continuously adapt newly received information provided users assume learning process broken discrete sequence rounds round learner receives user change every round though user recur many times. assume sequence users determined exogenous process places nonzero independent probability user next serve. together system receives round xtkt recommend observes it’s feedback form payoﬀ whose expectation ¯xt. goal learnt= rounds. user feedback disposal click/no-click behavior payoﬀ naturally interpreted becomes binary feedback quantity clickthrough rate recommended item clicked user otherwise. measure performance adopted comparative experiments section theoretical standpoint instead interested bounding cumulative regret achieved algorithms. precisely regret learner time extent average payoﬀ best choice hindsight user exceeds average payoﬀ algorithm’s choice i.e. adaptive eﬃcient clustering bandit algorithm perform collaborative ﬁltering named cofiba importantly enough clustering performed algorithm relies sparse graph representations avoiding expensive matrix factorization techniques. adapt cofiba standard setting sequential content recommendation known multi-armed bandits solving canonical exploration exploitation dilemma. algorithm works assumption serve content users content item determines clustering users made relatively groups within users tend react similarly item gets recommended. however clustering users need across diﬀerent items. moreover universe items large also assume items might clustered function clustering determine users number distinct clusterings users induced items also relatively small compared total number available items. method aims exploit collaborative eﬀects bandit setting akin co-clustering techniques used batch collaborative ﬁltering. bandit methods also represent promising approaches research community recommender systems instance tackling cold-start problem whereby lack data users leads suboptimal recommendations. exploration approach cases seems appropriate. demonstrate eﬃcacy dynamic clustering algorithm three benchmark real-world datasets. algorithm scalable exhibits signiﬁcant increased prediction performance state-of-the-art clustering -style bandits. also provide regret analysis holding high probability standard stochastically linear noise setting. represent users. then given partitioned small number clusters upper bounded constant independent much smaller clusters users belonging cluster tend similar behavior w.r.t. feature vector users lying diﬀerent clusters signiﬁcantly diﬀerent behavior. usual assumption relaxed assuming existence thresholds within-cluster distance between-cluster distance. would fact possible lift whole machinery time-drifting user preferences combining known techniques feature vectors somehow known beforehand content universe large known priori frequent many collaborative ﬁltering applications often desirable also group items clusters based similarity user preferences i.e. items similar preferred many users. notion two-sided clustering well known literature; clustering process simultaneously grouping users based similarity item side items based similarity user side goes name co-clustering here consider computationally aﬀordable notion collaborate ﬁltering based adaptive two-sided clustering. content universe x|i|} partition clusters users induced item items belong cluster induce partition users i.e. denote number distinct partitions induced items cantly smaller |i|. case common resort classical non-contextual stochastic multiarmed bandit setting recovered contextual framework setting assuming content universe made d-dimensional vectors canonical basis consequence expected payoﬀ user item simply h-th component vector users belong cluster w.r.t. h-th component equals h-th component lack useful annotation data issue datasets disposal latter modeling assumption motivates algorithm actually implemented experiments reported section batch collaborative ﬁltering neighborhood methods rely ﬁnding similar groups users items target user-item pair e.g. thus eﬀect rely dynamic form grouping users items. collaborative filteringbased methods also integrated co-clustering techniques whereby preferences co-cluster modeled simple statistics preference relations co-cluster e.g. rating averages beyond general connection co-clustering paper related research multi-armed bandit algorithms trading exploration exploitation dynamic clustering. aware speciﬁc piece work combines bandits co-clustering based scheme collaborative ﬁltering; papers closely related authors work assumption users deﬁned using feature vector learn low-rank hidden subspace assuming variation across users low-rank. paper combines low-rank matrix recovery high-dimensional gaussian process bandits gives rise algorithms seem practical sizeable problems. authors analyze non-contextual stochastic bandit problem model parameters assumed clustered types. provided solutions completely diﬀerent ours. work combines online clustering contextual bandit setting clustering made user side. paper also relies bandit clustering user side emphasis diversifying recommendations user time. authors propose cascading bandits user behavior identify attractive items formulate stochastic combinatorial partial monitoring problem. finally algorithms seen special case cofiba clustering done user side centralized decentralized environments. similar spirit also authors deﬁne transfer learning problem within stochastic multiarmed bandit setting prior distribution deﬁned possible models tasks; authors rely clustering markov decision processes based model parameter similarity. authors discuss choose unknown distributions ones whose means largest certain metric; authors study particle thompson sampling raoblackwellization online matrix factorization exhibiting ensemble contextual bandits used address cold-start problem recommender systems. similar approach used deal cold-start recommender systems based probability matching paradigm parameter-free bandit strategy employs online bootstrap derive distribution estimated models. contrast work neither collaborative eﬀects explicitly taken account. cofiba relies upper-conﬁdence-based tradeoﬀs between exploration exploitation combined adaptive clustering procedures user item sides. cofiba stores round estimate vector associated user vectors updated based approximation corresponding every user hosts algorithm operates linear bandit algorithm available content speciﬁcally wit− determined inverse correlation subject rank-one adjustments vector matrix bit− subject additive updates. matrices initialized identity matrix vectors initial− also used deﬁne upper conﬁdence bound cbit− approximation wit− along direction based local information encoded weight vectors wit− conﬁdence bounds cbit− algorithm also maintains updates family clusterings users single clustering items sides clusterings represented connected components undirected graphs nodes either users items. pseudocode description algorithm contained figures figure illustrates algorithm’s behavior pictorial example. time cofiba receives index current user serve along available item vectors xtct must select among them. order algorithm computes neighborhood sets item based current aggregation users w.r.t. item xtk. regarded current approximation cluster belongs clustering criterion deﬁned item xtk. neighborhood deﬁnes compound weight vector ¯wnkt− which turn determines compound conﬁdence bound cbnkt−. vector ¯wnkt− conﬁdence bound cbnkt− combined upperconﬁdence exploration-exploitation scheme commit speciﬁc item user then payoﬀ received algorithm uses update mitt− mitt bitt− bitt. notice update performed user though aﬀect calculation neighborhood sets compound vectors users later rounds. receiving payoﬀ computing mitt bitt cofiba updates clusterings user side clustering item side. round multiple graphs user side single graph item side clustering user side corresponds single cluster item side clusters ˆigtt items clusterings users figure example. user item sides updates take form edge deletions. updates user side performed graph pointed selected item xtkt updates item side made likely neighborhoods user signiﬁcantly changed considered w.r.t. previously deemed similar items. speciﬁcally item directly connected item beginning round consequence edge deletion user side users likely close w.r.t. longer users likely close w.r.t. taken good indication item inducing partition users does hence edge gets deleted. notice need imply that result deletion items belonging diﬀerent clusters since would prohibitive even moderately large sets users make full usage approach instead starting complete graphs users time cluster items created randomly sparsify complete graph drawing erdos-renyi initial graph still retaining high probability underlying clusterings graph edge deletions only show high probability number clusters items remains upper bounded throughout cofiba actual storage required algorithm indeed also brings substantial saving running time since updating connected components scales number edges involved graphs. graph sparsiﬁcation techniques used tested along experimentation parts. currently holds scenario) nothing prevents practice adapt cofiba case content users show essentially amounts adding nodes graphs either item user side maintaining data-structures dynamic memory allocation. fact precisely implemented algorithm case item user sets compared algorithm standard bandit baselines three real-world datasets canonical benchmark dataset news recommendations advertising dataset living production system publicly available advertising dataset. cases features items used. closely followed experimenexample beginning single item cluster correspondingly single clustering made unique cluster round item clusters corresponding three clusterings depicted left corresponding user clustering neighbors user updating user clustering algorithm considers therein edges candidates elimination. suppose edge eliminated clustering induced updated graph becomes }{}}. user graph update algorithm considers item graph update. suppose connected connected depicted. edge edge candidates elimination. algorithm computes neighborhood according compares neighborhoods assume neighborhoods user diﬀerent algorithm deletes edge item graph splitting item freely available benchmark dataset released icml exploration exploitation challenge. challenge build state-of-the-art news article recommendation algorithms yahoo data building algorithm learns eﬃciently policy serve news articles site. dataset made random traﬃc records user visits today module yahoo implying visitors recommended news article selected randomly. available options correspond news articles available recommendation displayed small visited page. recommend interesting article user whose interest given piece news asserted click data million visits two-week time stretch. logged information contained record used user form -dimensional boolean vector containing his/her features relevant news articles system recommend randomly recommended article visit; boolean value indicating whether recommended article clicked visiting user displayed article chosen uniformly random candidate article pool unbiased oﬀ-line evaluation method compare bandit algorithms reliable way. refer reader detailed description dataset collected extracted. picked larger telefonica. dataset obtained telefonica s.a. number spanish broadband telecommunications provider business units europe south america. data contains clicks displayed user websites telefonica operates data collected back-end server logs consist ﬁles ﬁrst contains interactions second contains metadata item-id type-id type order-id creative type mask cost creator-id transaction type. overall number users scale millions number items approximately data contains records took ﬁrst parameter tuning rest testing. again available payoﬀs associated items served system. hence order make procedure eﬀective estimator sequential decision process simulated random choices system generating available item sets follows round stored served current user associated payoﬀ value created including served along extra items occurs item avazu. dataset prepared avazu leading multinational corporation digital advertising business. data provided challenge predict click-through rate impressions mobile devices i.e. whether mobile clicked not. number samples around took ﬁrst parameter tuning remaining testing. line data represents event impression site mobile application along additional context information. again payoﬀ binary. variables contained dataset sample following ad-id; timestamp click device-id; device connection type; device type; visited app/website; category visited app/website; connection domain visited app/website; banner position; anonymized categorical ﬁelds pre-processed dataset follows cleaned data ﬁltering records missing feature values removed outliers. identiﬁed user device-id null. number users dataset scale millions. similar telefonica dataset generated recommendation lists length distinct timestamp. used ﬁrst records tuning parameters remaining testing. data transferred amazon jobs amazon service. tuned optimal parameters training standard grid search indicated used test evaluate predictive performance algorithms. since system’s recommendation need coincide recommendation issued algorithms tested retained records recommendations indeed same. records discarded actual number retained records changes slightly across algorithms; around yahoo data telefonica data avazu data. experimental results report averaged runs results summarized figures further evidence contained figure figures plotted click-through rate retained records experiments aimed testing performance various bandit algorithms terms prediction performance also cold-start regimes experimental setting line previous ones data prepared gives rise reliable estimation actual behavior experimental conditions figure aimed supporting theoretical model section providing evidence kind clustering statistics produced cofiba run. whereas three datasets took consideration generated real online applications worth pointing datasets indeed diﬀerent customers consume associated content. generally speaking longer lifecycle item fewer items higher chance users similar preferences consume hence bigger collaborative eﬀects contained data. therefore reasonable expect algorithm eﬀective datasets collaborative eﬀects indeed strong. users yahoo data likely span wide range demographic characteristics; this dataset derived consumption news often interesting large portions users such create strong polarization subcommunities. implies often quite speciﬁc news users might express interest natural expect pieces news intended reach wide audience consumers. given state aﬀairs surprising yahoo dataset linucb-one linucb-v already performing quite well thereby making clustering-of-users eﬀort somewhat less useful. also explains poor performance linucb-ind performing clustering all. even nontrivial case cofiba still achieve signiﬁcant increased prediction accuracy compared e.g. club thereby suggesting simultaneous clustering user item sides might even eﬀective strategy earn clicks news recommendation systems. users telefonica data diverse sample people spain easy imagine dataset spans large number communities across population. thus assume collaborative eﬀects much evident cofiba able leverage eﬀects eﬃciently. dataset club performs well general dynucb deteriorates initial stage catches-up later cofiba seems surpass algorithms especially cold-start regime algorithms ballpark club. finally avazu data furnished professional digital advertising solution platform customers click impressions ios/android mobile apps websites serving either publisher advertiser leads daily high volume internet traﬃc. dataset neither linucb-one linucb-ind displayed competitive cold-start performance. dynucb underperforming throughout linucb-v demonstrates relatively high ctr. club strong beginning performance degrades. datasets experimental evidence collected quite consistent three cases cofiba signiﬁcantly outperforms competing methods tested. especially noticeable cold-start period relative behavior essentially shows whole time window experiments. cofiba involved implement contrasted competitors also somewhat slower hand cofiba eﬀective exploiting collaborative eﬀects embedded data still amenable large datasets. theoretical guarantee cofiba relate cumulative regret cofiba clustering structure users w.r.t. items simplicity presentation formulate result one-hot encoding case ed}. fact general statement proven holds case generic feature vectors x|i|} regret bound depends geometric properties vectors. order obtain provable advantage clusterability assumptions extra conditions needed generated. clusterability assumptions naturally take advantage where partitions relative sizes clusters users highly unbalanced. translated practical terms cluster unbalancedness amounts saying theorem cofiba algorithm figure users associated proﬁle vectors items h-th induced partition made clusters cardinality vhmh respectively. moreover number distinct partitions obtained. round generated uniformly random selected number items generated arbitrarily function past indices payoﬀs sets cit− well current index sequence items generated i.i.d. according given unknown distribution payoﬀ interval generated described section that conditioned history expectation ¯xt. finally parameters suitable functions log. then grows large probability least figure typical distribution cluster sizes users yahoo dataset. plot corresponds cluster item side. plots since number clusters items cofiba ended sweeping dataset hand. represents fraction users contained corresponding cluster. instance ﬁrst cluster items generated clusters users relative sizes etc. second cluster items generated clusters users relative sizes etc. relative size clusters items follows clustering pattern depicted plot applies items second items figure give typical distribution cluster sizes produced cofiba run. emerging pattern always same clusters items unbalanced sizes corresponding item cluster clusters users unbalanced sizes. recurring pattern fact motivation behind theoretical assumptions property data cofiba algorithm provably take advantage plots combined comparatively good performance cofiba suggest datasets actually possess clusterability properties sides. initiated investigation collaborative ﬁltering bandit algorithms operating relevant scenarios multiple users grouped behavior similarity different ways w.r.t. items turn universe items possibly grouped similarity clusterings induce users. carried extensive experimental comparison encouraging results also given regret analysis operates simpliﬁed scenario. algorithm principle modiﬁed combined standard clustering technique. however advantage encoding clusters connected components graphs expectation variance w.r.t. random index. feeling consider case partition users single cluster number small ones. make clear consider extreme scenario standard regret bound achieves learning single d-dimensional user extreme lies case partition n-many clusters looser upper bounds achieved case also interplay starts becoming relevant. finally observe number distinct partitions inﬂuences bound indirectly var. worth repeating plays crucial role computational complexity whole procedure. assumption involving parameter edges connecting users belonging diﬀerent clusters user side eventually deleted user served least times. edges disconnected item side essentially independent graph user side referring turn entails current user clusters encoded connected components graph eventually converge true user clusters aggregate weight vectors wnkt− computed algorithm trading explo¯ ration exploitation round essentially converge rate form minimal eigenvalue process correlation matrix moreover compared strive capture geometry user vectors regret bound hence extra factor occurring bound. quite eﬀective tackling so-called cold start problem newly served users likely connected ones makes cofiba position automatically propagate information users ones aggregate vectors ¯wnkt. fact seen adaptively clustering users items computationally aﬀordable sizeable datasets time amenable regret analysis takes advantage clustering assumption. experiments conducted setup one-hot encoding since datasets disposal come reliable/useful annotations data. algorithm presented clearly work items accompanied features. direction future research compensate lack features data ﬁrst inferring features initial training phase standard matrix factorization techniques subsequently applying algorithm universe line experimental research would combine diﬀerent bandit algorithms roughly best stages. would somewhat similar metabandit construction described another would combine matrix factorization techniques e.g. would like thank anonymous reviewers helpful constructive comments. ﬁrst author thanks support miur qcri-hbku. also ﬁrst third author acknowledge support amazon award machine learning research grant. work leading results received funding european union’s seventh framework programme crowdrec grant agreement maillard mannor. latent bandits. icml moroshko vaits crammer. second-order non-stationary online learning regression. journal machine learning research modelling relational data using bayesian clustered tensor factorization. nips pages press tang jiang zeng personalized recommendation parameter-free contextual bandits. sigir.", "year": 2015}