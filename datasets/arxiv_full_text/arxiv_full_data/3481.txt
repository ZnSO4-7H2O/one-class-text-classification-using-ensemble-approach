{"title": "GANs for Biological Image Synthesis", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "In this paper, we propose a novel application of Generative Adversarial Networks (GAN) to the synthesis of cells imaged by fluorescence microscopy. Compared to natural images, cells tend to have a simpler and more geometric global structure that facilitates image generation. However, the correlation between the spatial pattern of different fluorescent proteins reflects important biological functions, and synthesized images have to capture these relationships to be relevant for biological applications. We adapt GANs to the task at hand and propose new models with casual dependencies between image channels that can generate multi-channel images, which would be impossible to obtain experimentally. We evaluate our approach using two independent techniques and compare it against sensible baselines. Finally, we demonstrate that by interpolating across the latent space we can mimic the known changes in protein localization that occur through time during the cell cycle, allowing us to predict temporal evolution from static images.", "text": "figure real generated images ﬁssion yeast cells protein depicted channel proteins depicted green channel. synthetic images generated star-shaped gan. star-shaped model generate multiple green channels aligned channel whereas training images green channel. gans family successful models recently received widespread attention. unlike generative models gans rely training objectives connected likelihood. instead training seen minimax game models generator aims output images similar training given random noise; discriminator aims distinguish output generator training set. originally gans applied mnist dataset handwritten digits consequent dcgan model applied celeba dataset human faces lsun imagenet datasets natural images. aware works applying gans biological images. work recently created bioimage dataset used extract functional relationships proteins called dataset comprising ﬂuorescence microscopy images cells. dataset image corresponds cell composed signals independent ﬂuorescence imaging channels corresponding different proteins tagged green-emitting ﬂuorophores respectively. paper propose novel application generative adversarial networks synthesis cells imaged ﬂuorescence microscopy. compared natural images cells tend simpler geometric global structure facilitates image generation. however correlation spatial pattern different ﬂuorescent proteins reﬂects important biological functions synthesized images capture relationships relevant biological applications. adapt gans task hand propose models casual dependencies image channels generate multichannel images would impossible obtain experimentally. evaluate approach using independent techniques compare sensible baselines. finally demonstrate interpolating across latent space mimic known changes protein localization occur time cell cycle allowing predict temporal evolution static images. life sciences last years rise light ﬂuorescence microscopy powerful probe biological events living cells organisms unprecedented resolution. need analyze quantitatively deluge data given rise ﬁeld bioimage informatics source numerous interesting novel data analysis problems current machine learning developments could principle help solve. generative models natural images among long-standing challenging goals computer vision. recently community made signiﬁcant progress task adopting neural network machinery. examples recent models include denoising autoencoders variational autoencoders pixelcnns generative adversarial networks ´ecole normale sup´erieure cnrs research university paris †national research university higher school economics moscow ‡lob ´ecole polytechnique cnrs inserm universit´e paris-saclay dataset channel signal always corresponds protein named localizes areas active growth cells. green channel signal instead corresponds different polarity factors proteins mark speciﬁc areas cells’ cortex help deﬁne cell’s geometry. polarity factors include proteins like controls biological process cellular polarity albeit slightly different way. green-labeled polarity factors imaged independently others. biological study investigate polarity factors interact another. paper present novel application gans generate biological images. speciﬁcally want tackle concrete limitations large scale ﬂuorescent imaging screens want common information contained channel learn generate cell several green-labeled proteins together. would allow artiﬁcially predict localizations proteins might co-exist cells imaged together circumvent current technical limitations able image limited number signal channels time. second taking advantage relationship cell cycle stage want study dynamical changes cellular localization proteins undergo time cells grow divide. accomplish this make several contributions. modify standard dcgan architecture substituting interdependence channels causal dependence green allowing observe multiple modes green signal single setting. observing mode collapse effect gans separable architecture incorporate recent wasserstein objective propose approaches generate multi-channel images regular wgan-gp trained multi-channel images extra channels training mined nearest neighbor search training novel star-shaped generator trained directly two-channel images. carefully evaluate models using quantitative techniques neural network two-sample test reconstructing samples held test optimization approach reproducibility make source code data available online. paper organized follows. section discuss related works. section reviews relevant biological background application. section review gans present modeling contributions. present experimental evaluation section conclude section related work generative adversarial networks since seminal paper goodfellow detailed review) gans becoming increasingly popular model learning generate loss functions learned jointly model itself. models adversarial losses used wide range applications image generation domain adaptation text-to-image synthesis synthesis shapes texture image-to-image translation image super resolution even generating radiation patterns particle physics however models suffer issues mode collapse oscillations training making challenging practice. community currently tackling problems multiple angles. extensive effort placed carefully optimizing architecture network developing best practices optimize training procedure. another active area research improving training objective function paper build dcgan architecture combined wasserstein loss latter used help mode collapse issue appearing especially separable setting. conditioning gans. starting conditioning class labels researchers extended conditioning user scribbles images quality images generated high models suffer conditional mode collapse i.e. given ﬁrst image little variety second effect might related fact dataset contained target image available source image model indirect supervision generating multiple conditioned images. applied pixpix method dataset learned produce high-quality green images given input. however unable generate multiple realistic green images input. given difﬁculty learning robust latent spaces conditioning image opted alternate approach. propose architecture generator channel green channels given independent random noise channel allowed inﬂuence green channel figure factors variation. chen mathieu used unsupervised methods encourage disentangling factors variation learned latent spaces e.g. separating numerical value handwritten digit writing style. contrast works rely unsupervised training discover factors variations explicitly embed separation model. analysis synthesis biological images. large scale imaging studies becoming common biology automated analysis images crucial many studies prove existence effect process large datasets link models simulation although ﬁeld recently embraced deep learning neural networks starting make splash mainly classical discriminative settings while knowledge work ﬁrst reported gans samples ﬂuorescent microscopy generative models widely used biology example johnson learned generate punctuate patterns cells showing potential methods studying relative sub-cellular positions several proteins interest. recently sharing large biological datasets greatly improved further made large investment develop database built open source tools facilitate sharing terabyte sized datasets complex metadata. fluorescence microscopy based ﬂuorescent compounds i.e. compounds absorb light given wavelength re-emit almost immediately slightly different wavelength case ﬂuorescent proteins green fluorescent protein ﬁrst widely used ﬂuorescing compound attached protein interest genetic engineering. many various absorption emission spectra exist e.g. fluorescent protein genetically tagging different proteins interest different color image cell time thus investigate co-localization. however number proteins tagged imaged time limited limited number non-overlapping absorption spectra. multi-channel ﬂuorescent images different natural images. natural images color determined illumination properties particular material scene. order generate realistic natural samples must capture relationship materials make particular object hues. contrast ﬂuorescent images intensity light given channel corresponds local concentration tagged protein correlation signals different channels represents important information relationship proteins color reﬂect intrinsic property protein itself. fission yeast cells shaped unicellular eukaryotes spherical hemisphere caps. born long wide grow length maintaining width constant. newly born ﬁssion yeast cells start growing pre-existing reach critical size switch bipolar growth. bipolar growth continues cells reach ﬁnal length stop growing start form cytokinetic ring middle responsible cleaving mother cells daughters interestingly cell cycle length cell good proxy i.e. time spent growing since birth. protein tagged channel responsible cell wall remodeling localizes areas active growth thus observing accurately infer growth cycle stage predict cell growth occurring. experiments paper make recent dataset images ﬁssion yeast cells originally produced study polarity networks dataset consists around images image being centered cell; cell segmentation performed separately details) corresponding outline also available. image stack images pixel correspond physical size z-plane distant every image composed channels informally called green light emitted precise wavelength recorded. dataset types ﬂuorescent-tagged proteins used channel different polarity regulating proteins green channel. full description tagged proteins beyond scope paper refer interested readers paper concentrate subset different polarity factors spanning large different cellular localizations. gives images cells simplicity center crop resize resolution gans image generation preliminaries gan. framework generative adversarial networks formulated minimax two-player game neural networks generator discriminator. generator constructs images given random noise whereas discriminator tries classify input image real fake goal generator trick discriminator formally consider data-generating distribution training images coming generator neural network parameterized takes random noise distribution input produces image xfake discriminator neural network parameterized takes either training image generated image xfake outputs number segment zero associated fake images real images. introduced quantity negative crossentropy loss discriminator output discriminator maximizes w.r.t. generator time minimizes w.r.t. practice optimization tasks attacked simultaneously alternating steps optimizers. log; θd)) often leads initial stages training process generator ineffective samples easy discriminate real data. practical trick avoid saturated gradients train generator maximizing instead. goodfellow showed minimax formulation reformulated minimization jensenshannon divergence data-generating distribution distribution induced architectures generator discriminator largely reuse successful version radford called dcgan. generator dcgan based up-convolutions interleaved relu non-linearity batch-normalization refer additional details. wasserstein gan. recently arjovsky demonstrated cases divergence behaves badly cannot provide useful direction training e.g. discontinuous. overcome degeneracies consider earth mover’s distance distributions -lipschitz functions optimizing w.r.t. complicated. practical approximation -lipschitz functions arjovsky suggest neural networks parameters clipped ﬁxed segment. recently gulrajani proposed surrogate objective based l-distance norm discriminator gradient speciﬁc points one. arrive minimax game section present modeling contributions. first describe approach separate green channels generator. second discuss train multi-channel generator using two-channel data dataset. finally propose star-shaped architecture uses red-green channel separation obtain multiple channels output. channel separation. idea channel separation consists separating ﬁlters upconvolutional layers corresponding features halves. ﬁrst ﬁlters responsible generating channel second half generates green channel. make sure green channel matches connections convolutional ﬁlters towards green ones. figure depicts modiﬁcation comparison dcgan multi-channel models. dataset contains two-channel images type green time. obtaining channels simultaneously proteins would require creation nearly yeast strains. scaling even higher currently impossible imaging technique limited number non-overlapping absorption spectra. constraints training generator subset channels task practical importance. ﬁrst approach present consists training multi-channel using artiﬁcial training multi-channel images created real two-channel images. proceed follows two-channel image search every class nearest-neighbors channel. then create sample combining original image green channels nearest neighbors classes. dataset train multi-output dcgan. difference architecture generator outputs channels number green channels used experiment discriminator takes -channel images input. star-shaped model. multichannel approach perform well because even using nearest neighbors extra greens channels exactly consistent original signal emphasizing importance correlations channels. overcome effect propose star-shaped architecture generator consisting single tower feeds green towers unlike multi-channel model described above green outputs independent conditioned red. thus model trained using existing two-channel images. experiments found important batch normalization tower once compared naive times. latter leads interference several normalizations features prevents convergence training scheme. evaluating generative models general non-trivial. context gans likelihood-free approaches evaluation even harder models provide compute log-likelihood test common evaluation technique. recently number techniques applicable evaluating gans proposed among those chose following neural-network two-sampled test discussed combined surrogates earth mover’s distance optimization-based approach check test samples well reconstructed. modify techniques match needs check performance using sensible baselines finally section show cell growth cycle generated star-shaped model. neural-network two-sample test lopez-paz oquab recently applied classiﬁer two-sample test evaluate quality models. trained generator evaluated heldtest set. test test split test-train test-test subsets. test-train used train fresh discriminator tries distinguish fake images real images. afterwards ﬁnal measure quality generator computed performance discriminator test-test freshly generated images. applied images discriminator usually convnet even small convnets discriminate fake real images almost perfectly. obtain useful measure lopez-paz oquab deliberately weaken convnet ﬁxing parameters values obtained pre-training imagenet. imagenet-based features clearly suitable cell images weaken discriminator another way. negation wgan-gp discriminator objective surrogate earth mover’s distance. similar train discriminator test-train subset compute ﬁnal estimates test-test subset. runs repeat experiment different random splits test train discriminator steps optimizer used experiments involving multi-channel generators train separate discriminator green channel paired channel. figure samples generated separable wgangp models trained selected proteins shown figure samples identical channel different green ones. observe wgan-gp provides much larger variability green channel conditioned red. particular three bottom rows even type protein changes never observed samples difference captured evaluation model score compared wgan-gp. second baseline evaluation compare real images different classes. table shows evaluated w.r.t. test class estimates signiﬁcantly smaller compared evaluated w.r.t. different classes. note score metric. particular table symmetric reﬂecting biases train/test splits. speciﬁcally wgan-gp score also negative quadratic regularization term dominant part objective image sources similar. additional test include extra proteins known similar localization respectively. observe reﬂects similarity giving pairs similar proteins much smaller score compared pairs figure scores classiﬁer two-sample test generators hold-out test sets images. report scores separable wgan-gp different stages training. line show samples corresponding models demonstrate lower scores correspond better-looking images. best viewed color screen. extended version ﬁgure given appendix median absolute deviation represent variance. appendix additionally quantitatively qualitatively compare wgan-gp wgan crossentropy discriminators used cst. sanity checks two-sample test. evaluate baseline settings. first compare separable wgan-gp models different stages training process. models also show qualitative difference generated images. figure shows along training process quality wgan-gp improves i.e. generated images become sharper contain less artifacts consistent score. better visualize difference trained wgan-gp models figure show multiple samples green channel corresponding channel. evaluation captures several aspects visual quality provides meaningful score. figures also conclude quality samples worse quality wgan-gp according visual inspection. conﬁrms observation surprising given wgan-gp trained using methodology. surprisingly evaluated cross-entropy wgan-gp also performs better multi-channel model separable version starshaped model baselines align green channels different classes channel one-class generators trained individually class separable versions. models trained wgan-gp ratio width generator tower number output channels. observe individual one-class wgan-gp models lead higher quality compared models outputting synchronized channels classes. among models synchronize channels starshaped model performs best proteins signiﬁcant drop quality w.r.t. one-class models. optimization reconstruct test common failures gans loss modes distribution usually referred mode collapse. evidence image quality inversely correlated mode coverage. test mode collapse perform experiment proposed ﬁxed trained generator examine well reconstruct images held test set. image test minimize l-distance generated test images w.r.t. noise vector call task regular reconstruction. iterations l-bfgs times select best reconstruction. also performed additional task separable reconstruction examines ability separable networks reproduce modes green channel conditioned red. task two-step procedure ﬁrst minimize l-error channels holding green noise ﬁxed minimize l-error green channel keeping noise ﬁxed it’s optimized value. complete study also report negative likelihood w.r.t. prior noise vectors obtained reconstruction procedure. baseline reconstruction error show nearest neighbor cell training average l-distance nearest neighbors. baseline show averaged random point generated ipz. apply reconstruction procedure evaluate four models separable one-class star-shaped models trained wgan-gp algorithms. figure table present qualitative quantitative results respectively. measurements report median values median absolute deviation. figure plot reconstruction errors values hardest protein separable reconstruction task. analyzing results observe separable reconstruction harder task single step procedure. second wgan-gp models reconstruct better probably suffer less mode collapse. figure reconstruction errors negative likelihood latent vectors found reconstruction. show cells corresponding protein appears hardest star-shaped models. vertical gray line shows median l-error nearest neighbor. horizontal gray lines show mean noise sampled gaussian prior. separable setting star-shaped model trained provides reconstructions whereas model trained wgan-gp results high values. extended version ﬁgure given appendix figure examples cell reconstructions. test image; nearest neighbor; regular reconstruction oneclass separable wgan-gp; regular reconstruction starshaped wgan-gp; separable reconstruction star-shaped wgan-gp; separable reconstruction star-shaped gan. extended version ﬁgure given appendix table reconstruction experiment. four trained models report l-errors reconstructions negative likelihoods latent vectors found reconstruction. described section localization used accurately pinpoint cell cycle stage. however nearly much known localization proteins changes within cell cycle using separable architecture interpolate points latent space move across different stages growth division. architecture network output green channel always remain consistent output. show example reconstructed cell cycle figure several animated examples suppl. mat. validation approach seen gradually moving like pattern tips cell towards middle cell mitosis previously described literature multi-channel images such unable compare generated multi-channel images compare real ﬂuorescent images. hope datasets biology become open better baseline compare model too. although generative modeling seen explosion popularity last couple years mostly applied synthesis real world images. results paper suggest modern generative models fruitfully applied images obtained ﬂuorescent microscopy. leveraging correlation different image channels able simulate localization multiple proteins throughout cell cycle. could enable future exploration uninvestigated inaccessible unaffordable biological/biomedical experiments catalyze discoveries potentially enable diagnostic prognostic bioimaging applications.", "year": 2017}