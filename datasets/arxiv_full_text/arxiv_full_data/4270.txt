{"title": "Cooperative Starting Movement Detection of Cyclists Using Convolutional  Neural Networks and a Boosted Stacking Ensemble", "tag": ["cs.CV", "cs.AI"], "abstract": "In future, vehicles and other traffic participants will be interconnected and equipped with various types of sensors, allowing for cooperation on different levels, such as situation prediction or intention detection. In this article we present a cooperative approach for starting movement detection of cyclists using a boosted stacking ensemble approach realizing feature- and decision level cooperation. We introduce a novel method based on a 3D Convolutional Neural Network (CNN) to detect starting motions on image sequences by learning spatio-temporal features. The CNN is complemented by a smart device based starting movement detection originating from smart devices carried by the cyclist. Both model outputs are combined in a stacking ensemble approach using an extreme gradient boosting classifier resulting in a fast and yet robust cooperative starting movement detector. We evaluate our cooperative approach on real-world data originating from experiments with 49 test subjects consisting of 84 starting motions.", "text": "main contribution cooperative approach early robust starting movement detection cyclists. introduce method based convolutional neural network detect starting motions image sequences learning spatio-temporal features. moreover present extended method starting movement detection based human activity data originating smart devices. starting movement detections camera smart device based detectors combined using novel boosted stacking ensemble approach implementing decisionfeature-level cooperation. remainder article structured follows sec. related work ﬁeld cooperative intention detection methods convolutional neural networks cooperative methods presented. sec. describes overall cooperative approach smart device based starting movement detection method. sec. metrics data used evaluation presented. experimental results discussed sec. finally sec. main conclusions open challenges future work presented. detection vrus active ﬁeld research past decades. increasing automation vehicles becomes important know current position anticipate behavior forecast future positions. motion sequence activities basic movements standing walking. moreover motion motion certain body points space. second forecast trajectories points. both basic movement detection trajectory forecasting part refer intention detection. article focus detecting starting movement. k¨ohler used histograms oriented gradients features motion history images pedestrians combination support vector machine detect intentions cross road. image sequences generated stationary camera. able detect starting intention within ﬁrst step pedestrian accuracy adapted method moving vehicles different movement types. abstract—in future vehicles trafﬁc participants interconnected equipped various types sensors allowing cooperation different levels situation prediction intention detection. article present cooperative approach starting movement detection cyclists using boosted stacking ensemble approach realizing featuredecision level cooperation. introduce novel method based convolutional neural network detect starting motions image sequences learning spatio-temporal features. complemented smart device based starting movement detection originating smart devices carried cyclist. model outputs combined stacking ensemble approach using extreme gradient boosting classiﬁer resulting fast robust cooperative starting movement detector. evaluate cooperative approach real-world data originating experiments test subjects consisting starting motions. work envision future scenario trafﬁc participants different degrees automation share road vulnerable road users pedestrians cyclists. ensure safe interactions automated vehicles vrus crucial predict intentions vrus early possible vehicle able choose appropriate reaction avoid dangerous situations. however anticipating behavior vrus challenging able suddenly change directions. additionally overlooked easily occlusions. guarantee safety automated road users maintain digital surroundings using sensor systems cameras lidar radar. sensor limitations occlusions also necessary communicate different trafﬁc participants cooperatively update environment model maintained agent. addition model complemented infrastructural sensor systems stationary cameras laser scanners vrus equipped mobile devices smartphones smart watches. approaches using body worn sensors locate vrus often lack positional accuracy allow early intention detection. infrastructures equipped sensors help resolve occlusions. combining information able gain reliable model current trafﬁc situation. collective knowledge utilized different ways e.g. improve localization trafﬁc participants. zernetsch hubert doll faculty engineering university applied sciences aschaffenburg aschaffenburg germany stefan.zernetschh-ab.de andreas.huberth-ab.de konrad.dollh-ab.de joint positions combination balanced gaussian process dynamical models na¨ıve-bayes classiﬁers. able provide path predictions time horizon second mean errors walking stopping starting pedestrians. comes cyclist intention detection still research ﬁeld. pool presented method cyclist path prediction using local road topology additional information. tested algorithm real world data recorded moving vehicle. mixing different motion models canonical directions able improve prediction sharp turns average. concerning cooperative intention detection approaches including smart devices thielen presented prototype system incorporating vehicle ability communication cyclist wifi enabled smartphone authors able successfully test prototype application warns vehicle driver likely collision crossing cyclist within next authors proposed prototype system using smart device carpedestrian communication pedestrian tracking. purpose transmitted type movement approaching car. allows warning pedestrian driver. authors presented approach pedestrian path prediction using artiﬁcial neural networks. three approaches common predicted trajectory based smart device information. however cooperation level detected intentions different trafﬁc participants. authors proposed concept listing requirements cooperative intelligent transportation systems including smart devices. preliminary work introduced cooperative stage method detect starting motions cyclists forecast future positions. detection starting motions done using smart devices infrastructure based sensors. detected movement primitives used adaptive gating function weights trained trajectory forecasting models. using cooperative method achieved robust detection starting motions reduced forecasting error starting trajectories. article extend previous method convolutional neural network incorporating spatiotemporal features stacking ensemble approach realizing featuredecision-level cooperation cyclist starting intention detection bringing step closer toward envisioned future trafﬁc scenario cnns ﬁrst used visual pattern recognition tasks early drawn attention krizhevsky used deep called alexnet imagenet large-scale visual recogintion challenge widely used image classiﬁcation image based object detection. alexnet consists simple layout convolutional layers together pooling layers reduce dimensionality szegedy introduced called inception modules layer multiple ﬁlter operations performed parallel output concatenated end. created network called googlenet stacking inceptions modules other resulting deep architecture times fewer parameters alexnet. googlenet ilsvrc ilsvrc using residual network architecture resnet consists residual blocks output convolutional layers added input allowing much deeper network architectures. article resnet architecture classify starting movements. network described detail sec. iii-c. developed based model human action recognition video sequences. comes action recognition information contained single image often enough detect certain action. therefore performed convolutions extract spatial temporal features sequences. action recognition performed surveillance videos authors compared method classiﬁcation using four methods using spatial pyramid matching outperformed methods. different approach using long-term recurrent convolutional networks presented donahue uses multiple cnns single input frames video sequence extract visual features every time step passed long short-term memory encoder. lstm decoder used generate sentence natural language describing video. malchanov introduced method classify hand gestures video sequences using cnn. creating subnetworks high resolution network fusing outputs able achieve higher accuracy compared unfused outputs subnetworks. according multisensor data fusion process enables combination information different sources order form uniﬁed picture. cooperation refers process acting together common beneﬁt contrast bare data fusion also captures interactions different participants inherent envisioned future trafﬁc scenario reason cooperation umbrella term including fusion integral part. speaking cooperative methods specify level cooperate datafeaturelevel level models level model outputs decisions. approach focuses ﬁrst third level. section describe overall approach cooperative starting movement detection. exemplary scheme cooperative detection process including smart devices infrastructure automated vehicles depicted fig. order available sources information encompassing model environment perform cooperation different levels featuredecision-level. smart devices infrastructure cameras used cooperatively detect cyclist’s movement type i.e. waiting moving. first individual detection step performed different agents. detector camera-based recognition realized using novel based approach. smartdevice based detector based human activity recognition techniques using accelerometers gyroscope measurements. detections agent sent subsequently another agent e.g. automated vehicle stacking ensemble approach using extreme gradient boosting used combine detection results. fig. moving moving denote probabilistic outputs moving class detectors smart device ensemble classiﬁer respectively. stacking ensemble approach realizes cooperation level detected starting movements well feature-level cooperation. latter concatenation features originating smart device infrastructure camera system. features results smart device based classiﬁers used input extreme gradient boosting classiﬁer implementing cooperative starting movement detection. moreover input approach assume mechanism camera based cyclist recognition tracking bounding boxes head trajectories e.g. wideangle stereo system given. communication assume realized means network. approach assumes idealized communication without considerable communication delays synchronized devices using timestamps. cooperation mechanism avoids sending large amounts sensory data accelerometer’s magnitude cyclist’s head position current detector output transmitted. allows cope limited bandwidth concerning communication medium. first general modeling concerning different classes used subsequent classiﬁers starting movement detection described. following movement detection using sequence camera images residual described sec. iii-c. sec. iii-d present starting intention detection based sensors smart device. finally sec. iii-e cooperation mechanism realized means stacking ensemble model described. starting movement detection modeled three class problem i.e. waiting starting moving. starting class auxiliary class allows integrate early movement indicators head movements training process. fig. exemplary cooperative movement detection process incorporating smart device based detectors cooperative detector running automated vehicle. outputs order improve overall prediction quality. well known ensemble techniques stacking boosting bagging bayesian model averaging extension latter bayesian classiﬁer combination recently mixture experts models comprises gating model weighting outputs different submodels gained attention determine state-of-the-art performance language modeling multi-source machine translation approaches based deep neural networks hence require many training samples. besides machine learning based techniques also bayesian ﬁltering sequential estimation techniques mostly used conduct feature-level fusion. additionally dempster-shafer theory widely used research industry cooperative systems fusing various sources information. review techniques data fusion intelligent transportation systems found approach aims detect transitions waiting starting early possible early knowledge transitions support trajectory forecast detected movements used automated vehicle e.g. trajectory planning. work focus detecting transition waiting starting. detection mechanism recognize transitions within milliseconds ﬁrst starting movement retaining robustness i.e. avoiding false positive starting detections. robust fast starting intention detection propose cooperative approach. method output several classiﬁers different strengths weaknesses combined order receive reliable fast detector starting movements cyclists. cooperating trafﬁc participants consider following agents cars infrastructure vrus themselves. here restrict research intersection equipped cameras smart devices carried vrus. convolutional neural network since starting movements cyclists cannot captured single image added temporal dimension input stacking last images adding third dimension ﬁlter kernel. fig. shows example input xseq functional behavior convolution shown temporal dimension image sequence describes size ﬁlter kernel temporal dimension. applying kernel image sequence extracted features contain information movements certain position. residual architecture resnet architecture introduced propose network architecture easier train produces higher accuracy conventional cnns. authors identiﬁed degradation problem adding layers deep model leads higher training error. problem addressed adding residual building blocks original input bypasses series convolution layers added output resulting thus instead directly modeling target function force network model residual function. stacking residual blocks able train network layers resulting substantially better classiﬁcation results compared shallower networks. residual block depicted fig. right. block internal bottleneck structure reduce amount computation. ﬁrst convolution represents input lower dimension followed convolution. network architecture described fig. based network reduce number input features batch normalization layer initial convolution followed pooling layer applied. moreover simpliﬁes modeling transition waiting moving class. pwaiting pstarting pmoving denote probabilities assigned classiﬁers different classes. labels output data created manually deﬁned follows sequence labeled waiting neither wheel bicycle moving cyclist performing movement leads starting motion. every frame ﬁrst visible movement cyclist leads start ﬁrst movement wheel bicycle labeled starting. finally every frame ﬁrst movement bicycle wheel labeled moving. fig. shows exemplary output classiﬁer line represents pmoving blue line labeled starting frame green line labeled moving frame. output classiﬁer zero moving probability phase probability increase phase reach probability phase iii. however sometimes phase since visible movement cyclist wheel bicycle starts moving. section present resnet architecture classify starting movements cyclists. classiﬁcation done frame frame using last images stationary camera. convolutional neural network architecture mainly consists convolutional layers perform convolutions extract local features input generate feature maps pooling layers reduce dimensionality feature maps fully connected layer output. describes convolution image position input image ﬁlter kernel size ﬁlter kernel xy-direction described kernels size. bias added result convolution activation function case rectiﬁed linear unit applied. relu outputs gyroscope allows detecting rotation movements pedaling whereas accelerometer better suited detect linear movements e.g. forward movements. accelerometer sensor gravity compensated. three accelerometer gyroscope components transformed using estimated gravity vector transformed values coordinate frame leveled local earth ground plane i.e. z-axis pointing towards sky. coordinate frame referred local frame. compass considered sensitivity precise calibration possible magnetic perturbations. absence compass data transformation local frame global reference frame known i.e. known device oriented respect vru. considering magnitude accelerometer gyroscope values local horizontal plane orientation invariance achieved. moreover projection sensor values local vertical z-axis i.e. gravity axis considered. sliding window segmentation window sizes performed transformed signals features commonly used human activity recognition mean variance energy computed. addition features based orthogonal polynomial approximation degree extracted window lengths used whereas features computed smaller window sizes capture short term dependencies larger window sizes capture dependencies coarse timescale. additionally magnitude discrete fourier transform coefﬁcients also considered input features applied human walking speed estimation coefﬁcients normalized respect overall energy respective window. window size coefﬁcients order considered. total features computed. features extracted smart device’s integrated considered. reason always available noisy multipath effects. moreover sampling frequency detect fast changes cyclists movement. detection starting movements starting detection realized means frame-based extreme gradient boosting classiﬁcation frame-based classiﬁcation performed discrete points frequency reduce dimensionality increase generalization performance sequential forward feature selection procedure performed. score wrapper approach uses harmonic mean f-score mean time required detecting starting movement. whereas latter transformed using scale squash mean detection time unit time interval i.e. predicting starting intention exactly labeled time results score one. feature maps passed residual blocks convolution carried generate feature maps. residual block consists sequential repetitions residual layers bottleneck architecture. blocks resulting feature maps average pooling applied result passed fully connected layer followed softmax layer generate probabilities. order speed training process batch normalization layers added network input every residual block. overall network contains probabilities classes pwaiting pstarting pmoving. network trained input sequences xseq individual time step outputs feature vector ˆycnn contains class probabilities. section smart device based starting movement recognition described. focus section early detection cyclist movement types. detection realized means human activity recognition techniques based gyroscope accelerometer sensory data nowadays available nearly every smartphone. schematic performed steps starting movement detection based smart devices depicted fig. classiﬁer. resulting classiﬁer outputs probabilities refer conﬁdence prediction. order predict proper class probabilities probability calibration using logistic sigmoid performed. probabilities used soft voting ensemble approach aggregating prediction classiﬁer sliding window manner within last smooths output reduces false positive detections. schematic cooperative process depicted fig. classiﬁer combines detections smart device based detectors. realized extreme gradient boosting classiﬁer outputs smart device based clas respectively) used input siﬁer degree computed magnitude gravity compensated acceleration values window lengths goal make extensive many features smart device give classiﬁer information improve starting movement detection. additionally using features computed single sensor value reduces communication overhead. magnitude smart device acceleration sensor starting movement detection result transmitted. moreover classiﬁer uses past velocity measurements extracted head trajectory tracked input. information example supplied infrastructure based sensors vehicles. shown features based cyclist’s head trajectory valuable source information predicting cyclist intentions. head trajectory used calculate magnitude velocity subsequently features based orthogonal polynomial approximations window lengths extracted. order comply sampling rate smart devices predictions performed frequency i.e. camera measurements oversampled. case cyclist occluded cooperative classiﬁcation stage bypassed smart device prediction used. evaluate algorithm created datasets starting cyclists. ﬁrst dataset contains female male test subjects equipped smart device. instructed move certain points intersection public uninstructed trafﬁc following trafﬁc rules. trafﬁc lights intersection received starting motions maximum starting motions test subject. trajectories cyclists shown fig. besides sensor data smart devices recorded images cameras installed intersection part wide angle stereo camera system. smart device measurements used train validate test classiﬁer based data smart devices. order increase number validation section describe evaluation cnn. dataset used divided training validation strain sval. strain consists solely uninstructed cyclists makes measurements. sval consists instructed cyclists additional uninstructed cyclists split sets sval sval perform two-fold cross-validation. sval split instructed uninstructed cyclists evenly distributed. classiﬁcation evaluated sval. compare classiﬁcation results smart device classiﬁer additionally illustrate results instructed cyclists. overall results classiﬁer shown fig. generate plots f-score precision classiﬁer determined different probability thresholds. results plotted thresholds zero one. plot left contains results folds using sequences right plot contains results instructed cyclists respectively. evaluation shows classiﬁer reaches f-score average mixed data. evaluation instructed cyclists produces similar results f-score increase f-score precision increasing threshold fewer false positives. mean detection time increases threshold pmoving usually increases time maximum probability reached. analyses showed classiﬁer robust small movements cyclist even movements background cyclist e.g. pedestrian walking fig. shows snapshot scene. pedestrians pushing bicycle passing behind target cyclist. fig. corresponding network output shown. passing pedestrians cause slight increase pstarting however pmoving stays unaffected. fig. shows network output scene pedestrian passing close cyclist leads sharp increase pmoving resulting false positive detection. observed network strongly reacts movements area bicycle wheels. passing pedestrian depicted fig. another problem changing environmental conditions i.e. occlusion lighting weather conditions indirectly affecting detectors performance. evaluation data stormy weather example changing environmental conditions. here otherwise steady camera images start shake leads noisy output since smart device sensors affected passing vrus changing environmental conditions weather situations output smart device classiﬁer resolve issues. smart devices section describe evaluation smart device based starting movement detector. evaluation smart device based approach instructed cyclist considered. second dataset created enhance data consists image data uninstructed cyclists recorded intersection. second split training validation test sets cnn. assess quality classiﬁers created scenewise evaluation scene starts cyclist stopped ends cyclist leaving ﬁeld view. classify starting movement look predicted moving probability. certain threshold reached starting movement classiﬁed time step threshold reached starting detected phase scene rated false positive. detection phase rated true positive. threshold never reached rated false negative. since every waiting phase ends starting phase consider true negatives. overall quality classiﬁers rated f-score precision. assess detection time classiﬁer calculate mean time difference detection time start time phase tiii true positives sequences smaller values indicate faster classiﬁcation. following described methods evaluated using two-fold cross-validation instructed cyclists. first evaluate individual results classiﬁer sec. v-a. sec. assess cooperative movement primitive detection compare results individual classiﬁers. fig. example classiﬁcation scene pedestrians passing background cyclist. probabilities pwaiting pstarting pmoving shown. label references pedestrian left pushing bicycle. label pedestrian background right. overall results smart device based detector shown fig. evaluation shows classiﬁer reaches f-score mean detection time observe precision classiﬁer compared camera based approach. classiﬁer produces many false positives sensitive small motions cyclist. occur movements cyclists waiting e.g. cyclist preparing pedal start starting yet. false positives seesawing movement i.e. swaying other. results activity pattern similar observed starting. many false positives ﬁltered i.e. averaging last prediction. comes cost reduced detection speed. shows smart device based detector high threshold chosen order achieve larger f-score. eventually additional smoothing necessary. despite high number false positive detections detection valuable source information cooperative classiﬁer since less affected changing environmental conditions passing vrus. case occlusion smart devices source information left. hence camera smart device based classiﬁer complement other. section describe evaluation cooperative approach. before evaluation performed twofold cross-validation instructed cyclists. smart device cooperative movement detector share training set. compensated performing nested ﬁve-fold cross-validation vrus respective training fold. smart device based model ﬁtted training data nested training folds. predictions nested validations folds concatenated creating training basis ﬁtting stacking ensemble model. results cooperative approach depicted fig. classiﬁer reaches f-score evaluated instructed cyclists. cooperative stacking ensemble approach outperforms smart device based approaches concerning fscore. cooperative approach produces f-score mean detection time threshold values greater cooperative approach combines robustness retaining mean detection time. observe increased robustness false positive detections. fig. illustrated scene passing pedestrian behind waiting cyclist. moving probability peaks solely based approach cooperative approach offers also increased robustness concerning environmental conditions e.g. shaking camera. depicted fig. noise moving probability predictions tremendously reduced allowing clear starting detection. article presented approach cooperatively detect starting movements cyclists. approach consists novel based starting movement detector smart device based detector stacking ensemble realizing featuredecision-level cooperation. latter combines predictions camera smart device based detectors. based approach delivers extremely fast robust predictions i.e. f-score mean detection time showed approach smart device based starting movement detection using human activity recognition techniques. approach delivers fig. f-score mean detection times probability thresholds instructed cyclists different models cooperative stacking ensemble smart device based promising results e.g. cope occlusion situations. cooperative approach combines robustness retaining mean detection time. stacking ensemble approach combines estimators complement leading increased performance i.e. f-score mean detection time moreover demonstrated robustness single detectors cooperative approach sample scenes including passing pedestrians environmental conditions e.g. shaking camera. future work focus extending presented approach different trafﬁc scenarios locations e.g. cyclist turning applying cooperative approach types pedestrians. also intend include realistic communication models e.g. including delays packet loss. moreover integrate based perception. here environmental conditions even dynamic stressing advantages cooperative approaches. also investigate extending fast reliable starting movement detection advanced trajectory forecasting e.g. based deep learning models. concerning smart devices review different wearing positions especially explore effects regarding movement detection performance. moreover also integrate smart devices cooperative tracking mechanism. additionally also work smart device based trajectory forecasting. investigate different types cooperation e.g. cooperative trajectory forecasts. work results project decoint supported german research foundation within priority program kooperativ interagierende automobile grant numbers additionally work supported zentrum digitalisierung bayern. bieshaar reitberger zernetsch sick fuchs doll detecting intentions vulnerable road users based collective intelligence aaet automatisiertes vernetztes fahren braunschweig germany thielen lorenz hannibal koster plattner feasibility study cooperative safety application cyclists crossing intersections ieee international conference intelligent transportation systems anchorage engel kratzsch david warkow holzknecht carpedestrian positioning methods improving positioning radio-based protection systems tagung fahrerassistenzsysteme munich germany bieshaar zernetsch depping sick doll cooperative starting intention detection cyclists based smart devices infrastructure itsc yokohama yapan krizhevsky sutskever hinton imagenet classiﬁcation deep convolutional neural networks advances neural information processing systems lake tahoe russakovsky deng krause satheesh huang karpathy khosla bernstein berg feifei imagenet large scale visual recognition challenge ijcv vol. donahue hendricks guadarrama rohrbach venugopalan saenko darrell long-term recurrent convolutional networks visual recognition description cvpr z.-h. zhou ensemble methods foundations algorithms ser. machine learning pattern recognition series herbrich graepel eds. bocan raton chapman hall/crc bishop pattern recognition machine learning ser. information science statistics jordan kleinberg sch¨okopf eds. secaucus springer-verlag york vol. faouzi klein data fusion techniques research needs transportation research procedia vol. goldhammer strigel meissner brunsmann doll dietmayer cooperative multi sensor network trafﬁc safety applications intersections itsc anchorage fuchs gruber nitschke sick online segmentation time series based polynomial least-squares approximations ieee transactions pattern analysis machine intelligence vol. maarten bieshaar maarten bieshaar received b.sc. m.sc. degree computer science university paderborn germany respectively. currently working toward degree university kassel germany part intelligent embedded systems research group chaired bernhard sick. stefan zernetsch stefan zernetsch received b.eng. m.eng. degree electrical engineering information technology university applied sciences aschaffenburg germany respectively. currently working thesis cooperation faculty electrical engineering computer science university kassel germany. andreas hubert andreas hubert received b.eng. m.eng. degree electrical engineering information technology university applied sciences aschaffenburg germany respectively. conducts research pattern recognition shortterm behaviour recognition trafﬁc participants. bernhard sick bernhard sick received diploma degree degree habilitation degree computer science university passau germany. currently full professor intelligent embedded systems faculty electrical engineering computer science university kassel germany. associate editor ieee transactions systems cybernetics-part holds patent received several thesis best paper teaching. member ieee konrad doll konrad doll received diploma degree dr.-ing. degree electrical engineering information technology technical university munich germany respectively. joined semiconductor products sector motorola inc. appointed professor university applied sciences aschaffenburg ﬁeld computer science digital systems design. since research professor cooperative automated", "year": 2018}