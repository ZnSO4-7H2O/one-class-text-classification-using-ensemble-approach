{"title": "Predicting Surgery Duration with Neural Heteroscedastic Regression", "tag": ["stat.ML", "cs.LG", "cs.NE"], "abstract": "Scheduling surgeries is a challenging task due to the fundamental uncertainty of the clinical environment, as well as the risks and costs associated with under- and over-booking. We investigate neural regression algorithms to estimate the parameters of surgery case durations, focusing on the issue of heteroscedasticity. We seek to simultaneously estimate the duration of each surgery, as well as a surgery-specific notion of our uncertainty about its duration. Estimating this uncertainty can lead to more nuanced and effective scheduling strategies, as we are able to schedule surgeries more efficiently while allowing an informed and case-specific margin of error. Using surgery records %from the UC San Diego Health System, from a large United States health system we demonstrate potential improvements on the order of 20% (in terms of minutes overbooked) compared to current scheduling techniques. Moreover, we demonstrate that surgery durations are indeed heteroscedastic. We show that models that estimate case-specific uncertainty better fit the data (log likelihood). Additionally, we show that the heteroscedastic predictions can more optimally trade off between over and under-booking minutes, especially when idle minutes and scheduling collisions confer disparate costs.", "text": "nathan rodney gabriel julian mcauley charles elkan zachary lipton department computer science division biomedical informatics department anesthesiology university california diego gilman drive jolla {nhng ragabriel jmcauley elkan zlipton}ucsd.edu scheduling surgeries challenging task fundamental uncertainty clinical environment well risks costs associated underover-booking. investigate neural regression algorithms estimate parameters surgery case durations focusing issue heteroscedasticity. seek simultaneously estimate duration surgery well surgery-speciﬁc notion uncertainty duration. estimating uncertainty lead nuanced effective scheduling strategies able schedule surgeries efﬁciently allowing informed case-speciﬁc margin error. using surgery records large united states health system demonstrate potential improvements order compared current scheduling techniques. moreover demonstrate surgery durations indeed heteroscedastic. show models estimate case-speciﬁc uncertainty better data additionally show heteroscedastic predictions optimally trade under-booking minutes especially idle minutes scheduling collisions confer disparate costs. united states healthcare expensive hospital resources scarce. healthcare expenditure exceeds even surgery wait times appear increased last decade source inefﬁciency inability fully utilize hospital resources. doctors cannot accurately predict duration surgeries operating rooms become congested vacant over-booking lead long wait times higher costs labor under-booking decreases throughput increasing marginal cost surgery. present doctors book rooms according simple formula. default time reserved simply mean duration speciﬁc procedure. procedure code fact explain signiﬁcant amount variance surgery durations. ignoring signals hypothesize medical system leaves important signals untapped. address issue developing better nuanced strategies surgery case prediction. work focuses collection surgery logs recorded electronic health records large united states health system. patient consider collection pre-operative features including patient attributes well attributes clinical environment surgeon surgery location time. procedure also know much time originally scheduled addition actual ‘ground-truth’ surgery duration recorded procedure performed. particularly interested developing methods allow better estimate uncertainty associated duration surgery. typically neural network regression objectives assume homoscedasticity i.e. constant levels target variability instances. mathematically convenient assumption clearly violated data ours might surmise intuitively operations typically take long time tend exhibit greater variance shorter ones. example among common procedures epidural injections shortest procedures ones least variance among procedures exploratory laparotomy major burn surgery exihibit greatest variance. procedures exhibit long tails. model data revisit idea heteroscedastic neural regression combining expressive dropout-regularized neural networks. approach jointly learn parameters predictive distribution. particular consider gaussian laplace distributions parameterized mean standard deviation. also consider gamma distributions especially suited survival analysis. unlike gaussian laplace long tailed ends gamma long right tail positive support restriction positive values suits modeling durations survival-type data. gamma distribution applied medical data classical approaches bennett sahu knowledge ﬁrst approximate parameters gamma distribution using modern neural network approaches. heteroscedastic models better data compared current practice neural network baselines fail account heteroscedasticity. furthermore models produce reliable estimates variance used schedule intelligently especially over-booking under-booking confer disparate costs. uncertainty estimates come cost performance traditional measures. best-performing gamma model achieves lower mean squared error vanilla least squares despite optimizing different objective. dataset consists patient records extracted system large united states hospital. speciﬁcally selected records corresponding surgeries took place surgeries span distinct procedures performed distinct surgeons. histograms long-tailed procedures performed fewer times doctors performing fewer surgeries each. moreover data contains several clerical mistakes logging durations. example number surgeries record reported running less minutes. discussions hospital experts suggest indicate either clerical errors inconsistently applied convention logging canceled surgeries. additionally several surgeries reported hours suggesting clerical errors logging times procedures. remove surgeries reported take less minutes hours dataset. preprocessing left roughly original data experiments split remaining data %/%/% training/validation/testing. surgery extracted number pre-operative features corresponding ehrs. restrict attention features available majority patients exclude information charted following procedure. features fall several categories patient doctor procedure context. patient features patients include following features size patient height weight real-valued features. normalize mean variance categorical variable binned according ten-year wide intervals open left side score ordinal score represents severity patient’s illness. example denotes healthy patient denotes severe systemic disease denotes patient moribund without surgery. refers brain-dead patient preparation organ transplantation. anesthesia type categorical feature represents type anesthesia applied sedate patient. values assigned variable include general monitored anesthesia care patient undergoes local anesthesia together sedation neuraxial anesthesiologist other/unknown. patient class categorical feature indicates patient’s current status. values assigned variable include emergency department encounter hospital outpatient procedure hospital outpatient surgery hospital inpatient surgery trauma inpatient admission inpatient admission trauma outpatient. comorbidities model following co-morbidities binary variables smoker status atrial ﬁbrillation chronic kidney disease chronic obstructive pulmonary disease congestive heart failure coronary artery disease diabetes hypertension cirrhosis obstructive sleep apnea cardiac device dialysis asthma dementia. doctor represent doctor performing procedure using one-hot vector. doctor feature exhibits considerable class imbalance proliﬁc doctor performing surgeries least proliﬁc doctor performing feature weight height time week month location patient class rating anesthesia type surgeon procedure smoker heart arrhytmia chronic kidney disease congestive heart failure coronoary artery disease type diabetes hypertension liver cirrhosis sleep apena cardiac device dialysis asthma dementia cognitive impairment type abbreviation categorical binary numerical weight numerical height categorical hour categorical categorical month categorical location categorical class categorical categorical anesthesia categorical surgeon categorical procedure binary smoker binary binary binary binary binary diabetes binary binary cirrhosis binary cardiac_device binary binary dialysis binary asthma binary dementia cognitive binary procedure represent procedure performed one-hot vector. common operations tend minor procedures four frequent procedures colonoscopy upper endoscopy cataract removal abdominal paracentesis. distribution also long-tailed colonoscopies. context represent context procedure several categorical variables. first represent hour categorical variable values binned non-overlapping -hour width buckets. second represent week month year one-hot vectors. finally similarly represent location operations one-hot vector. summarize number kind features dataset table handle variables missing values including height weight hour incorporating missing value indicators following previous work clinical datasets paper addresses familiar task regression. start refreshing basic preliminaries. given examples {xi} corresponding labels {yi} desire model outputs prediction task machine learning algorithm produce function given dataset consisting examples labels generally seek predictions somehow close popular method producing function choose class functions parameterized values linear models simplest examples approach. train linear regression model deﬁne solve following optimization problem training data evaluate model performance previously unseen data. linear models error-minimizing parameters calculated analytically. modern deep learning models analytic solution exists optimization typically proceeds stochastic gradient descent. neural network models change function multilayer perceptrons example transform input series matrix multiplications followed nonlinear activation function. formally l-layer regression simple form might view loss function simply intuitive measure distance. alternatively it’s possible derive choice squared loss viewing regression probabilistic perspective. probabilistic view parametric model outputs distribution simplest case assume prediction mean gaussian predictive distribution variance view calculate probability density given thus choose parameters according maximum likelihood principle work relax assumption constant variance predicting simultaneously. apply idea mlps easily applied networks arbitrary architecture. predict standard deviation predictive distribution modify outputs ﬁrst output linear activation interpret output conditional mean second output models conditional variance enforce positivity output softplus activation function softplus log). extend idea laplace distributions turn better describe target variability surgery duration also maximum likelihood estimators optimizing mean absolute error mean absolute error corresponds average number minutes underbooked typically quantity interest type scheduling task. laplace distribution parameterized finally apply technique perform neural regression gamma predictive distributions. gamma distribution strictly positive support long-tailed right. since surgeries survival-type data nonnegative lengths probability distributions similarly nonnegative support gamma distribution might better describe surgery duration. formally expected time surgeries follows gamma distribution surgery start times modeled poisson process. present basic experimental setup. experiments %/%/% training/validation/test split. model weights updated training choose non-differentiable hyper-parameters architecture details based validation performance. ﬁnal tally features majority sparse accounted one-hot representations procedures doctors. express labels number hours procedure takes. baselines consider three sensible baselines comparison. ﬁrst follow current heuristic predicting average time procedure. note equivalent training unregularized linear regression model single feature procedure others. although main technical contribution paper concerned modeling heteroscedasticity also generally interested know much performance current approach leaves untapped. baseline helps address question. also compare linear regression. tried applying regularization choosing strength regularization holdout data lead improved performance. finally compare traditional multilayer perceptrons. calculate models assume homoscedasticity choose constant variance minimizes validation set. training details neural network experiments mlps relu activations. optimize network’s parameters stochastic gradient descent halving learning rate every epochs. experiment used initial learning rate determine architecture performed grid search number hidden layers number hidden nodes choosing determined hyper-parameter optimization homoscedastic models mlps hidden layer nodes. heteroscedastic models hidden layer nodes. models dropout regularization. basic quantitative evaluation report root mean squared error mean absolute error negative log-likelihood heteroscedastic models evaluate using predicted parameters distribution. gamma distribution calculate mean mean prediction calculating rmse. calculate median gamma distribution although median gamma distribution closed form efﬁciently approximated. summarize results table heteroscedastic gamma performs best measured rmse laplace performs best measured mae. heteroscedastic models outperform homoscedastic models heteroscedastic gamma achieving compared best performing homoscedastic model signiﬁcant quantity evaluating likelihood difference values corresponding likelihood ratio models. plots figure demonstrate predicted deviation reliably estimates observed error plots demonstrate laplace distribution appears targets better gaussian predictive distribution. gives insight laplace predictive distribution might better data gaussian. figure plots predicted absolute error heteroscedastic gaussian laplacian gamma models. averaging bins width shows reliable estimator observed error. previous work medical literature addresses prediction surgery duration accounting patient surgical team characteristics. knowledge ﬁrst paper address problem modern deep learning techniques ﬁrst model heteroscedasticity. idea neural heteroscedastic regression ﬁrst proposed weigend though share hidden layers outputs concerned gaussian predictive distributions. williams shared hidden layer consider case multivariate gaussian distributions predict full covariance matrix cholesky factorization. heteroscedastic regression long history outside neural networks. address formulation gaussian processes. related lakshminarayanan also revisits heteroscedastic neural regression also using softplus activation enforce non-negativity. show successful modiﬁcations work laplace distribution signiﬁcant contribution application idea clinical medical data. results demonstrate efﬁcacy machine learning heteroscedasticity surgery duration data. section explore results greater detail. speciﬁcally analyze models features predictive examine uncertainty estimates might used decision theory lower costs. first consider importance various features. perhaps common features corresponded largest weights linear model. results summarized figure surprisingly features dominated procedures. particular pulmonary thromboendarterectomy receives highest positive weight. procedure involves high risk mortality full cardiopulmonary bypass hypothermia full cardiac arrest. interestingly even accounting procedures doctors receive high weight. receives signiﬁcant negative weight indicating unusual efﬁciency another appears unusually slow. ethical reasons maintain anonymity doctors specialties. neural network models evaluate importance feature group performing ablation analysis group procedure codes important features. however location patient class surgeon anesthesia patient contribute signiﬁcantly. hour appears inﬂuence performance models week month appears merely introduce noise leading reduction test performance. interestingly comorbidities also made little difference performance. however possible features apply small subset patients highly predictive subset. predicting variance error provide uncertainty information could used make better scheduling decisions. compare various approaches economic/decision-theoretic perspective might consider plausible case cost over-reserve room minute differs cost under-reserve room demonstrate quantities traded figure models don’t output variance consider scheduled durations form data-independent constant. either case modulating books less aggressively. multiplicative approach performed better likely long procedures higher variance short ones. approach equivalent selecting certain percentile predicted distribution given constant sigma. heteroscedastic models make trade-off selecting constant percentile predicted distribution. cost over-reserving minute under-reserving minute equal problem reduces minimizing absolute error. around point curve homoscedastic laplacian outperforms models. however given cost sensitivity heteroscedastic gamma strictly outperforms models. encouraged efﬁcacy simple machine learning methods predict durations surgeries estimate uncertainty. several promising avenues future work. concretely currently engaged discussions medical institution whose data used introducing trial surgeries would scheduled according decision theory based estimates. regarding methodology look forward expanding research several directions. first might extend approach modeling covariances complex interactions among multiple real-valued predictions. might also consider problems like bounding detection requiring complex neural architectures.", "year": 2017}