{"title": "Deep Metric Learning for Practical Person Re-Identification", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "Various hand-crafted features and metric learning methods prevail in the field of person re-identification. Compared to these methods, this paper proposes a more general way that can learn a similarity metric from image pixels directly. By using a \"siamese\" deep neural network, the proposed method can jointly learn the color feature, texture feature and metric in a unified framework. The network has a symmetry structure with two sub-networks which are connected by Cosine function. To deal with the big variations of person images, binomial deviance is used to evaluate the cost between similarities and labels, which is proved to be robust to outliers.  Compared to existing researches, a more practical setting is studied in the experiments that is training and test on different datasets (cross dataset person re-identification). Both in \"intra dataset\" and \"cross dataset\" settings, the superiorities of the proposed method are illustrated on VIPeR and PRID.", "text": "however another challenge less studied existing work cross dataset person re-identiﬁcation. practical systems usually collect large datasets ﬁrst train model them. trained model applied datasets videos person re-identiﬁcation. call training datasets source domain test datasets target domain. source target datasets totally different usually captured different cameras different environments i.e. different probability distribution. practical person re-identiﬁcation algorithm good generalization respect dataset changes. therefore cross dataset person re-identiﬁcation important rule evaluate performance algorithms practice. since pixels person images unstable effective representations important needed person reidentiﬁcation. existing methods borrow many sophisticated features ﬁelds histogram gabor based features direct matching discriminative learning used evaluate similarity. existing methods mainly focus second step learn metric discriminate persons. many good metric learning methods proposed context kissme majority existing methods include separate steps feature extraction metric learning. features usually come separate sources color texture designed hand learned ﬁnally connected fused simple strategies. contrary paper proposes method combine separate modules together learning color feature texture feature metric uniﬁed framework called deep metric learning main idea inspired siamese neural network originally proposed signature veriﬁcation. given person images want siamese deep neural network assess similarity speciﬁc original work ﬁrst abstracts siamese network sub-networks connection function cost function carefully design architecture person images. adapt well person re-identiﬁcation. denoting connection function similarity equation written denote sub-networks dml. depending speciﬁc applications need share share abstract—various hand-crafted features metric learning methods prevail ﬁeld person re-identiﬁcation. compared methods paper proposes general learn similarity metric image pixels directly. using siamese deep neural network proposed method jointly learn color feature texture feature metric uniﬁed framework. network symmetry structure sub-networks connected cosine function. deal variations person images binomial deviance used evaluate cost similarities labels proved robust outliers. compared existing researches practical setting studied experiments training test different datasets intra dataset cross dataset settings superiorities proposed method illustrated viper prid. task person re-identiﬁcation judge whether person images belong subject not. practical applications images usually captured cameras disjoint views. performance person re-identiﬁcation closely related many applications cross camera tracking behaviour analysis object retrieval algorithms proposed ﬁeld also overlapped ﬁelds pattern recognition. recent years performance person re-identiﬁcation increased continuously increase further. essence person re-identiﬁcation similar biometric recognition problems face recognition. core good representation good metric evaluate similarities samples. compared biometric problems person re-identiﬁcation challenging quality high variety person images. person re-identiﬁcation usually need match person images captured surveillance cameras working wide-angle mode. therefore resolution person images lighting conditions unstable too. furthermore direction cameras pose persons arbitrary. factors cause person images surveillance scenarios distinctive properties large variations intra class ambiguities inter classes. summary challenges person re-identiﬁcation come following aspects learn similarity metric image pixels directly. layers optimized common objective function effective hand-crafted features traditional methods; multi-channel ﬁlters learned capture color texture information simultaneously reasonable simple fusion strategies traditional methods e.g. feature concatenation rule; tested popular person re-identiﬁcation datasets viper prid using common evaluation protocols. results show outperforms state-of-the-art methods appeal practical requirements evaluate generalization also conduct challenging cross dataset experiments training i-lids cuhk campus testing viper prid. results cross dataset experiments signiﬁcantly better existing methods similar experimental settings. knowledge ﬁrst work conduct strict cross dataset experiment ﬁeld person re-identiﬁcation. finally fuse features learned multiple datasets improve performance viper prid further. work uses deep learning learn metric person re-identiﬁcation. related works four aspects reviewed section feature representation metric learning person re-identiﬁcation siamese convolutional neural network cross dataset related methods. early papers mainly focus construct effective feature representation. numerous features used proposed person re-identiﬁcation features divided categories color based texture based features. popular features include color histogram color histogram sift histogram gabor features fusion. among features color contribution ﬁnal results. recent advance aspect color invariant signature combing color histogram covariance feature segmentation information achieved rank=% viper. hand proved using silhouette symmetry structure person improve performance signiﬁcantly therefore color texture features usually extracted predeﬁned grid ﬁnely localized parts. proposed mcmc based method part localization person re-identiﬁcation simultaneously obtained rank=% viper. work prove performance improved signiﬁcantly know geometric conﬁguration person explicitly implicitly. compared part based method salience based methods proposed zhao relaxed spatial constraint could deal larger pose variations. similar history face recognition future direction feature representation must based precise body parts segmentation person alignment pose normalization. based extracted features naive feature matching unsupervised learning methods usually moderate results state-of-the-art results achieved supervised methods boosting rank metric learning among methods metric learning main stream ﬂexibility. compared standard distance measures e.g. norm learned metric discriminative task hand robust large variations person images across view. papers used holistic metric evaluate similarity samples ﬁrst divided samples several groups according pose learned metrics group. using pose information explicitly obtains highest performance viper. recently proposed novel human loop style method illustrated performance person re-identiﬁcation improved drastically human intervention. although results paper hard reproduce supplies benchmark reﬂect performance human closing human performance target researchers. early siamese neural network proposed evaluate similarity signature samples. year neural network similar structure proposed ﬁngerprint veriﬁcation. different traditional neural networks siamese architecture composed sub-networks sharing parameters. subnetwork convolutional neural network. siamese neural network used face veriﬁcation research group. best property siamese neural network uniﬁed clear objective function. guided objective function end-to-end neural network learn optimal metric towards target automatically. responsibility last layer siamese neural network evaluate similarity output sub-networks form norm cosine. although good experimental results obtained disadvantages lacking implementation details lacking comparison methods. paper design siamese neural network person image apply person re-identiﬁcation problem. paper implementation details described extensive comparisons reported. young ﬁeld cross dataset problem attracted much attention. majority researchers best improve performance within single dataset i.e. training viper test viper too. long started concern issue. authors proposed transfer rank adapt model trained source domain target domain image pairs source domain negative image pairs target domain used training. different dtrsvm cross dataset experiments proposed network trained joint inﬂuence resolution illumination pose changes ideal metric person re-identiﬁcation highly nonlinear. deep learning exact effective tools learn nonlinear metric function. section introduces architecture parameters cost function implementation details proposed convolutional network deep metric learning. pattern recognition problems neural network works standalone mode. input neural network sample output predicted label. mode works well handwritten digit recognition object recognition classiﬁcation problems labels training test set. person re-identiﬁcation problem subjects training generally different test therefore sample label style neural network cannot apply deal problem construct siamese neural network includes sub-networks working sample pair label mode. ﬂowchart method shown figure given person images sent siamese convolutional neural network images scnn predict label denote whether image pair comes subject not. many applications need rank images gallery based similarities probe image scnn outputs similarity score instead. structure scnn shown figure composed convolutional neural networks cnns connected connection function. existing siamese neural networks constraint sub-networks share parameters i.e. weights biases. studied previous work constraint could removed conditions. without parameters sharing network deal view speciﬁc matching tasks naturally. parameters sharing network appropriate general task e.g. cross dataset person re-identiﬁcation. call modes general paper composed convolutional layers pooling layers full connected layer. shown figure number channels convolutional pooling layers output vector dimensions. every pooling layer includes cross-channel normalization unit. convolution input data padded zero values therefore output size input. ﬁlter size layer ﬁlter size layer relu neuron used activation function layer. capture different statistical properties body parts train part based way. previous work person images cropped three overlapped parts three networks trained independently. differently faster scheme paper three parts trained jointly. first three parts share layer. second part layer help learn part-speciﬁc ﬁlters. third high level features parts fused layer rule. then similarity fused features evaluated connection function. driven common cost function three parts contribute training process jointly. overall main differences proposed network figure network layer shared three parts not; contribution three parts fused feature level score level. parameter sharing level reduce complexity network. fusion feature level make three parts train jointly improve performance slightly. moreover training test single network convenient efﬁcient using three independent networks. pairs. mean hyper-parameters binomial deviance. numerator eqn. class divergence similarity matrix denominator total variance. minimizing eqn. eqn. learn network separating positive negative pairs possible. comparing eqn. eqn. binomial deviance cost focus false classiﬁed samples fisher criterion focus every elements similarity matrix equally. intuition binomial deviance cost make network trained mainly hard samples likely good model veriﬁed experiments. following sections connection function cosine cost function binomial deviance. connection cost functions determined back-propagation used learn parameters scnn. plugging eqn. eqn. forward propagation function calculate cost training set. trains network pairwise paper formulates cost gradient totally matrix form. network trained stochastic gradient descent mini-batch formulation process sample pairs batch. size batch batch includes positive negative sample pairs paper batch generate abstracted three basic components subnetworks connection function cost function. connection function used evaluate relationship samples cost function used convert relationship cost. choose connection function cost function closely related performance scnn. many distance similarity functions used candidates connect vectors euclidian distance cosine similarity absolute difference vector concatenate formulas equations negate distance functions make consistent similarity. advantage euclidian distance derivation simple form output unbounded could make training process unstable. absolute difference non-derivable points. cosine function bounded invariant magnitude samples. good property cosine function used widely many pattern recognition problems choose connection function. cost function given analysis square loss exponential loss binomial deviance chose binomial deviance ﬁnal cost function. discuss another popular cost function pattern recognition fisher criterion. given training corresponding similarity matrix mask matrix binomial deviance fisher criterion formulated based eqn. eqn. learn parameters scnn algorithm. general neural network error backward propagated single path. contrary error speciﬁc scnn backward propagated branches eqn. eqn. respectively described practice also assign asymmetry cost label positive negative pairs tune performance network e.g. positive pairs negative pairs. effect asymmetry cost performance discussed experiments. many popular datasets built person reidentiﬁcation viper prid i-lids cuhk campus among datasets evaluation protocols viper prid clearest therefore compare method methods them. experiments done settings intra dataset experiments conducted illustrate basic performance proposed method. cross dataset experiments illustrate generalization ability. except papers conduct experiments setting training test dataset. viper includes subjects images subject coming different camera views split viper disjoint training testing randomly repeat process times. ﬁrst split used parameter tuning number training epoch learning rate weight decay splits used reporting results. similar viper prid captured cameras camera shows subjects camera shows subjects. ﬁrst subjects appear cameras. follow testing protocols randomly select subjects ﬁrst subjects training remain subjects testing. test composed probe gallery information follows. training stage training images camera camera merged randomly shufﬂed sent generic scnn. corresponding mask matrix generated according label samples. pairs subjects assigned different subjects assigned mask matrix symmetric elements lower triangular part avoid redundant computation. testing stage image subject used gallery used probe. evaluate test view dev. view investigate three important factors affect performance network data augmentation asymmetric cost positive negative sample pairs cost function. besides parameters cost function eqn. data augmentation data augmentation widely used trick training neural network. experiments mirror person images double training test sets. although trick used effect performance analyzed. here compare performance dev. view viper without data augmentation. training number images subject increased testing stage original images mirrored version generate similarity scores ﬁnal score fused rule. results table signiﬁcant improvements brought data augmentation especially ranks. indicates scale dataset crucial train good networks. know geometry information person image i.e. pose person augment datasets guided pose generate virtual images improve performance. sense human pose estimation important direction person re-identiﬁcation following years. asymmetric cost described section iii-c generating mask matrix labels training samples number negative sample pairs positive pairs. however practice usually split training samples many batches ﬁrst positive negative sample pairs generated within batch. therefore negative sample pairs batches covered training process. cause negative pairs prone under-ﬁtting. balance weight positive negative sample pairs assign asymmetric costs them. ﬁxing cost positive pair tune cost negative pair asymmetric cost apply easily eqn. eqn. setting fig. similarity score distribution viper computed based human labelled attributes attributes binary similarity scores evaluated hamming distance. recognition rate. matter using cost function cost training always drop continually. contrary cost test drops signiﬁcantly beginning training process gradually becomes converged tens epochs. ﬁgure cost training test small using binomial deviance. fisher criterion obviously bigger binomial deviance reﬂects fisher criterion easily overﬁting training set. inspecting epoch-cost curves epoch= based experience following experiments. shown figure two-class similarity distributions cost functions different. distribution generated attributes viper also given figure reference. experiment shown using attributes hamming distance achieve high recognition rate i.e. rank≈ attributes labelled human seen baseline human performance distribution figure seen ideal two-class distribution viper. binomial deviance distribution negative similarity scores signiﬁcantly wider positive scores coincide ideal distribution generated attributes. fisher criterion distributions positive negative scores standard gaussian variance. although nearly perfect results obtained training using cost function performance test different performance binomial deviance suitable person reidentiﬁcation problem mainly focus samples near boundary less affected distributions positive negative samples. fisher criterion ideal distributions highly heteroscedastic conﬂicted assumption fisher. maybe modiﬁcations made fisher criterion solve problem leave work future. binomial deviance fisher criterion next compare cost functions discussed section iii-c binomial deviance fisher criterion like prior experiments comparison conducted dev. view viper too. comparison experiments mirror images double dataset cost negative pairs connection function ﬁxed cosine. differences binomial deviance fisher criterion evaluated three aspects epoch-cost curve similarity score distribution recognition rate. distinguish modiﬁed original rename proposed method paper improved dml. compared pairwise version improved training speed signiﬁcant performance improvement. notably rank- recognition rate increases results compared methods copied original papers. results unavailable leaved table proposed method outperforms compared methods viper including current state-of-the-art methods rank- rank- method outperforms remarkably except rank recognition rate higher slightly. among methods method nearly simple elegant doesn’t need pre-processing pose information segmentation. bottom layers network every building blocks contribute common objective function optimized algorithm simultaneously. prid similar results viper proposed method outperforms state-of-the method rpml however superiority method prid smaller viper reason scale prid dataset small train good network. using sample pairs network outperforms compared methods illustrate power deep metric learning. compared viper quality prid poorer size gallery bigger therefore recognition rates prid overall lower viper. tions. following i-lids cuhk campus used training viper prid used test set. i-lids captured airport indoor environment; cuhk campus captured campus; viper prid captured street. totally different capture environments devices cross dataset experiments challenging previous experiments. different don’t samples viper prid adapt classiﬁers target domains. people total images captured multiple non-overlapping cameras average images person. many images large illumination changes subject occlusions. scale i-lids smaller viper prid resolution images i-lids varied. cuhk campus large scale dataset captured cameras sessions includes subjects images. subject images camera views. resolution cuhk campus cross dataset networks trained parameters previous experiments. training resize images i-lids cuhk campus convenience. test setting intra dataset experiments. viper half subjects images randomly selected construct test includes subjects images. prid test includes subjects images. test process repeated times average recognition rate reported. results first i-lids cuhk campus training respectively test performance trained networks viper. recognition rates viper shown table results dtrsvm listed comparison. results method outperforms original slightly. training i-lids method dtrsvm rank- rank- recognition rates better dtrsvm slightly. training cuhk campus performance improved signiﬁcantly. possible reason compared i-lids quality aspect ratio images cuhk campus similar viper. combining similarity scores networks performance improved even approaches performance methods intra dataset setting test trained networks prid give results table vii. using i-lids training method better dtrsvm signiﬁcantly. different results viper training cuhk campus decreases recognition rates remarkably. performance decline caused difference cuhk campus prid datasets. fusing similarity scores i-lids chuk campus increases performance especially rank- recognition raises compared intra dataset experiments performance cross dataset experiments decline sharply. rank- recognition rate number viper prid drop indicates trained models hard generalize across datasets distinctive properties dataset. figure shows ﬁlters learned different datasets distributions color texture datasets diverse. besides experimental results diverse ﬁlters also prove model learned dataset hardly adapt another one. transfer model target domain fully multiple heterogeneous datasets hand improve performance target domain important research topics future. although paper doesn’t speciﬁc scnn experiment give gradients cost function reference. denote output sub-networks number samples view number samples view. dimensions corresponding similarity matrix mask matrix detail. extensive intra dataset cross dataset person reidentiﬁcation experiments conducted illustrate superiorities proposed method. ﬁrst work apply deep learning person re-identiﬁcation problem also ﬁrst work study person re-identiﬁcation problem fully cross dataset setting. experimental results illustrated network deal cross view cross dataset person re-identiﬁcation problems efﬁciently outperformed state-of-the-art methods signiﬁcantly. future apply applications; explore pre-train network; investigate embed geometry information network improve robustness pose variations. moreover continue research train general person matching engine good generalization across view dataset. general scnn sub-networks share parameters therefore output sample. input training denote output number samples. cost produced training calculated eqn. gradient eqn. respect derived follows. work supported chinese national natural science foundation projects national science technology support program project bakb chinese academy sciences project kgzd-ew-- jiangsu science technology support program project authenmetric funds. kostinger hirzer wohlhart roth bischof large scale metric learning equivalence constraints computer vision pattern recognition ieee conference gray brennan evaluating appearance models recognition reacquisition tracking ieee international workshop performance evaluation tracking surveillance janeiro hirzer beleznai roth bischof person re-identiﬁcation descriptive discriminative classiﬁcation image analysis ser. lecture notes computer science heyden kahl eds. springer berlin heidelberg vol. w.-s. zheng gong xiang person re-identiﬁcation probabilistic relative distance comparison computer vision pattern recognition ieee conference yuen domain transfer support vector ranking person re-identiﬁcation without target camera label information proceedings ieee international conference computer vision javed shaﬁque shah appearance modeling tracking multiple non-overlapping cameras computer vision pattern recognition cvpr ieee computer society conference vol. vol. farenzena bazzani perina murino cristani person re-identiﬁcation symmetry-driven accumulation local features computer vision pattern recognition ieee conference gray viewpoint invariant pedestrian recognition ensemble localized features computer vision eccv ser. lecture notes computer science forsyth torr zisserman eds. springer berlin heidelberg vol. nguyen cosine similarity metric learning face veriﬁcation computer vision accv ser. lecture notes computer science kimmel klette sugimoto eds. springer berlin heidelberg vol. friedman tibshirani hastie elements statistical learning data mining inference prediction ser. springer series statistics. york springer-verlag hirzer roth k¨ostinger bischof relaxed pairwise learned metric person re-identiﬁcation computer vision eccv ser. lecture notes computer science fitzgibbon lazebnik perona sato schmid eds. springer berlin heidelberg vol. cires¸an meier masci gambardella schmidhuber flexible high performance convolutional neural networks image classiﬁcation proceedings twenty-second international joint conference artiﬁcial intelligence-volume volume two. aaai press layne hospedales gong attributes-based reidentiﬁcation person re-identiﬁcation. springer mignon jurie pcca approach distance learning sparse pairwise constraints computer vision pattern recognition ieee conference dong received b.s. degree electronic engineering m.s. degree communication information system wuhan university wuhan china received ph.d. degree pattern recognition intelligent systems casia beijing china research areas unconstrained face recognition heterogeneous face recognition deep learning. authored acted reviewer tens articles international conferences journals. developed face biometric algorithms systems shenzhen-hongkong immigration control project beijing olympic games. zhen received b.s. degree automation university science technology china ph.d. degree institute automation chinese academy sciences assistant professor. research interests computer vision pattern recognition image processing face recognition particular. published papers international journals conferences. stan received b.eng. degree hunan university changsha china m.eng. degree national university defense technology china ph.d. degree surrey university surrey u.k. currently professor director center biometrics security research institute automation chinese academy sciences worked microsoft research asia researcher prior that associate professor nanyang technological university singapore. research interest includes pattern recognition machine learning image vision processing face recognition biometrics intelligent video surveillance. published papers international journals conferences authored edited eight books.", "year": 2014}