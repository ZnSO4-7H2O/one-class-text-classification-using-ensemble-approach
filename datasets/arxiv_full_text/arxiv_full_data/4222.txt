{"title": "Learning Pose Grammar to Encode Human Body Configuration for 3D Pose  Estimation", "tag": ["cs.CV", "cs.AI"], "abstract": "In this paper, we propose a pose grammar to tackle the problem of 3D human pose estimation. Our model directly takes 2D pose as input and learns a generalized 2D-3D mapping function. The proposed model consists of a base network which efficiently captures pose-aligned features and a hierarchy of Bi-directional RNNs (BRNN) on the top to explicitly incorporate a set of knowledge regarding human body configuration (i.e., kinematics, symmetry, motor coordination). The proposed model thus enforces high-level constraints over human poses. In learning, we develop a pose sample simulator to augment training samples in virtual camera views, which further improves our model generalizability. We validate our method on public 3D human pose benchmarks and propose a new evaluation protocol working on cross-view setting to verify the generalization capability of different methods. We empirically observe that most state-of-the-art methods encounter difficulty under such setting while our method can well handle such challenges.", "text": "figure illustration human pose grammar express knowledge human body conﬁguration. consider three kinds human body dependencies relations paper i.e. kinematics symmetry motor coordination isting large-scale pose estimation datasets provided sufﬁcient annotations; whereas pre-trained pose estimators also generalized mature enough deployed elsewhere. reconstruction inﬁnite pose pairs generated projecting pose poses different camera views. recent works shown well-designed deep networks achieve state-of-the-art performance human.m dataset using pose detections system inputs. paper develop deep grammar network explicitly encode knowledge human body dependencies relations illustrated figure knowledges explicitly express composition process joint-part-pose including kinematics symmetry motor coordination serve knowledge bases reconstructing poses. ground knowledges multi-level network end-to-end trained backpropagation. composed hierarchical structure describes paper propose pose grammar tackle problem human pose estimation. model directly takes pose input learns generalized mapping function. proposed model consists base network efﬁciently captures pose-aligned features hierarchy bi-directional rnns explicitly incorporate knowledge regarding human body conﬁguration proposed model thus enforces high-level constraints human poses. learning develop pose sample simulator augment training samples virtual camera views improves model generalizability. validate method public human pose benchmarks propose evaluation protocol working cross-view setting verify generalization capability different methods. empirically observe state-of-the-art methods encounter difﬁculty setting method well handle challenges. estimating human poses single-view image attracted growing interest past years wide applications robotics autonomous vehicles intelligent drones etc. challenging inverse task since aims reconstruct spaces data inherent ambiguity ampliﬁed factors e.g. clothes occlusions background clutters. availability large-scale pose datasets e.g. human.m deep learning based methods obtained encouraging success. methods roughly divided categories learning end-to-end networks recover input images poses directly extracting human poses input images lifting poses spaces. advantages decouple human pose estimation stages. pose estimation ex∗hao-shu fang yuanlu wenguan wang contributed equally paper. work supported muri project n--- darpa award hao-shu fang wenguan wang visiting students. correspondence author xiaobai liu. copyright association advancement artiﬁcial intelligence rights reserved. additionally empirically previous methods restricted poor generalization capabilities performing cross-view pose estimation i.e. tested human images unseen camera views. notably human.m dataset largest publicly available human pose benchmark performance state-ofthe-art methods heavily relies camera viewpoints. shown table change split training testing using cameras training testing forth camera performance state-ofthe-art methods drops dramatically much worse image-based deep learning methods. empirical studies suggested existing methods might over-ﬁt sparse camera settings bear poor generalization capabilities. handle issue propose augment learning process camera views explore generalized mapping spaces spaces. speciﬁcally develop pose simulator augment training samples virtual camera views improve system robustness. method motivated previous works learning synthesis. differently focus sampling pose instance given space following basic geometry principles. particular develop pose simulator effectively generate training samples unseen camera views. samples greatly reduce risk over-ﬁtting thus improve generalization capabilities developed pose estimation system. conduct exhaustive experiments public human pose benchmarks e.g. human.m humaneva mpii verify generalization issues existing methods evaluate proposed method cross-view human pose estimation. results show method signiﬁcantly reduce pose estimation errors outperform alternative methods large extend. contributions. major contributions proposed framework deep grammar network incorporates powerful encoding capabilities deep neural networks high-level dependencies relations human body; data augmentation technique improves generalization ability current -step methods allowing catch even outperforms end-to-end imagebased competitors. pose estimation. literature methods solving task roughly classiﬁed frameworks directly learning pose structures images cascaded framework ﬁrst performing pose estimation reconstructing pose estimated joints. speciﬁcally ﬁrst framework proposed multi-task convolutional network simultaneously learns pose regression part detection. ﬁrst learned auto-encoder describes pose high dimensional space mapped input image space using cnn. represented joints points discretized space proposed coarse-to-ﬁne approach iterative reﬁnement. mixed data trained uniﬁed network two-stage cascaded structure. methods heavily relies well-labeled image ground-truth pairs since need learn depth information images. avoid limitation work tried address problem step manner. example authors proposed exemplar-based method retrieve nearest pose pose library using estimated pose. recently proposed network directly regresses keypoints joint detections achieves state-of-the-art performance. work takes step towards uniﬁed d-to-d reconstruction network integrates learning power deep learning domain-speciﬁc knowledge represented hierarchy grammar model. proposed method would offer deep insight rationale behind problem. grammar model. track receives long-lasting endorsement interpretability effectiveness modeling diverse tasks authors approached problem image parsing using stochastic grammar model. that grammar models used human body parsing. proposed phrase structure dependency attribute grammar human body representing decomposition articulation body parts. notably represented human body simpliﬁed kinematic grammar learn relations lstm. paper representation analogized hierarchical attributed grammar model similar hierarchical structures brnns probabilistic grammar. difference lies model fully recursive without semantics middle levels. depth w.r.t. camera reference frame camera intrinsic parameter camera extrinsic parameters rotation translation respectively. note omit camera distortion simplicity. figure proposed deep grammar network. model consists major components base network constituted basic blocks pose grammar network encoding human body dependencies relations w.r.t. kinematics symmetry motor coordination. grammar represented bi-directional among certain joints. text detailed explanations. involves sub-problems estimating pose pose calibrating camera parameters estimating human joint positions. noticing subproblems entangled cannot solved without ambiguity propose deep neural network learn generalized mapping multi-to-multi mapping function parameterized model overview model follows line directly estimating human keypoints joint detections renders model high applicability. speciﬁcally extend various human pose grammar deep neural network basic pose detection network ﬁrst used extracting pose-aligned features hierarchy rnns built encoding high-level pose grammar generating ﬁnal reasonable pose estimations. networks work cascaded resulting strong pose estimator inherits representation power neural network high-level knowledge human body conﬁguration. base d-pose network building solid foundation high-level grammar model ﬁrst base network capturing well pose-aligned features. base network inspired demonstrated effective encoding information poses. illustrated figure base network consists cascaded blocks. block several linear layers interleaved batch normalization dropout layers relu activation stacked efﬁciently mapping d-pose features higher-dimensions. input pose detections ﬁrst projected features fully connected layer. ﬁrst block takes high-dimensional features input extra linear layer applied obtain explicit pose representation. order coherent understanding full body space re-project estimation -dimension space feed second block. initial pose estimation ﬁrst block second block able reconstruct reasonable pose. take full information initial pose detections introduce residual connections blocks. technique able encourage information facilitate training. additionally block base network able directly access gradients loss function leading implicit deep supervision reﬁned d-pose estimated base network re-projected features. combine features d-pose original feature d-pose together leads powerful representation well-aligned d-pose information preserves original d-pose information. feed feature d-pose grammar network. base network directly estimated depth joint pose detections. however natural human body rich inherent structures involved task motivates reason structure whole person global manner. extend bi-directional rnns model high-level knowledge human pose grammar towards reasonable powerful pose estimator capable satisfying human anatomical anthropomorphic constraints. going deep grammar network ﬁrst detail grammar formulations reﬂect interpretable high-level knowledge human body conﬁguration. basically given human body consider following three types grammar network. kinematic grammar gkin describes human body movements without considering forces deﬁne kinematic grammar represent constraints among kinematically connected joints gkin spine head thorax spine gkin l.arm l.shoulder l.elbow l.wrist kinematic grammar focuses connected body parts works forward backward. forward kinematics takes last joint kinematic chain account backward kinematics reversely inﬂuences joint kinematics chain next joint. symmetry grammar gsym measure bilateral symmetry human body human body divided matching halves drawing line center; left right sides mirror images other. motor coordination grammar gcrd represents movements several limbs combined certain manner paper consider simpliﬁed motor coordination human leg. deﬁne coordination grammar represent constraints people coordinated movements naturally supports chain-like structure provides powerful tool modeling grammar formulations deep learning. states encoded brnn. time step input feature output determined considering two-direction states figure illustration virtual camera simulation. black camera icons stand real camera settings white camera icons simulated virtual camera settings. layer totally four brnn nodes derived symmetry relations motor coordination dependencies. symmetry brnn nodes taking gsym node example takes concatenated d-joints gkin r.arm brnns bottom layer times input produces estimations d-joints taking symmetry relations account. similarly coordination nodes gcrd leverages estimations gkin r.leg brnns reﬁnes joints estimations according coordination grammar. shown figure build two-layer tree-like hierarchy brnns modeling three grammar brnns shares equation eqn. three grammar represented edges brnns nodes implicitly encoded brnn architecture. bottom layer brnns built modeling relations deﬁned kinematics grammar. speciﬁcally accept pose-aligned features base network input generate estimation joint time step. information forward/backfoward propagated efﬁciently states brnn thus kinematics relations implicitly modeled bi-directional chain structure corresponding brnn. note take advantages recurrent natures capturing chain-like grammar instead using modeling temporal dependency sequential data. entire learning process consists steps learning basic blocks base network loss. attaching pose grammar network trained base network ﬁne-tune whole network end-to-end manner. covariance matrix joint j-th multivariate gaussian distribution. constraint enforces independence among joint pose probability distribution efﬁciently learned using algorithm e-step estimating combination weights m-step updating gaussian parameters utilizes k-means clustering initialize parameters warm start. learned mean gaussian considered atomic pose representing group similar poses. visualize atomic poses figure given pose ground-truth sample generate simulated detections thus augment training mitigate discrepancy between training data testing data. effectiveness proposed validated section section ﬁrst introduce datasets settings evaluation report results comparisons state-of-the-art methods ﬁnally conduct ablation study components method. human.m current largest dataset human pose estimation consists million human poses corresponding video frames recorded different cameras. cameras located front back left right recorded subject around meters away meter height. dataset actors total different actions performed pose groundtruth captured motion capture system camera parameters provided. humaneva-i another widely used dataset human pose estimation also collected controlled indoor environment using mocap system. humaneva-i dataset fewer subjects actions compared human.m dataset. mpii challenging benchmark human pose estimation wild containing large amount human images wild. validate method dataset qualitatively since pose ground-truth provided. evaluation protocols human.m standard protocol using camera views subjects training camera views subjects testing. standard protocol called protocol works predictions post-processed rigid transformation comparing ground-truth referred protocol usually limited number cameras recording human subject. raises doubt whether learning dataset lead generalized pose estimator applicable scenes different camera positions. believe data augmentation process help improve model performance generalization ability. this propose novel pose sample simulator generate additional training samples. generation process consists steps projecting ground-truth pose onto virtual camera planes obtain ground-truth pose simulating pose detections sampling conditional probability distribution ﬁrst step ﬁrst specify series virtual camera calibrations. namely virtual camera calibration speciﬁed quoting intrinsic parameters real cameras simulating reasonable extrinsic parameters orientations illustrated figure white virtual camera calibrations determined real cameras. given speciﬁed virtual camera perform perspective projection ground-truth pose onto virtual camera plane obtain corresponding ground-truth pose second step ﬁrst model conditional probability distribution mitigate discrepancy between pose detections pose ground-truth assuming follows mixture gaussian distribution denotes number gaussian distributions denotes combination weight j-th component denotes j-th multivariate gaussian distribution mean covariance suggested efﬁciency issues covariance matrix assumed form protocol linkde tekin chen ramanan pavlakos bruce zhou martinez protocol ramakrishna bogo moreno-noguer pavlakos bruce martinez protocol pavlakos bruce zhou martinez direct. discuss eating greet phone photo pose purch. sitting sittingd. smoke wait walkd. walk walkt. avg. direct. discuss eating greet phone photo pose purch. sitting sittingd. smoke wait walkd. walk walkt. avg. direct. discuss eating greet phone photo pose purch. sitting sitingd. smoke wait walkd. walk walkt. avg. table quantitative comparisons average euclidean distance estimated pose ground-truth human.m protocol protocol protocol best score marked bold. learned estimator over-ﬁts training camera parameters. validate generalization ability different models propose protocol based different camera view partitions training testing. setting subjects camera views used training subjects camera view selected testing suggested protocol guarantees subjects also camera views different training testing eliminating interferences subject appearance camera parameters respectively. refer protocol protocol humaneva-i follow previous protocol evaluating action separately subjects. rigid transformation performed computing mean reconstruction error. implement method using keras tensorﬂow back-end. ﬁrst train base network epoch. learning rate exponential decay batch size ﬁrst step. dpose grammar network base network ﬁnetune whole network together. learning rate second step guarantee model stability training phase. adopt adam optimizer steps. perform pose detections using state-of-the-art pose estimator ﬁnetuned model human.m pre-trained model humaneva-i mpii. deep grammar network trained pose detections inputs pose ground-truth outputs. protocol protocol data augmentation omitted little improvement tripled training time. protocol addition original camera views augment training virtual camera views horizontal plane. consider circle centered human subject locates cameras evenly segmented sectors degree angles each cameras occupy sectors. generate training samples unoccupied sectors leave closest testing camera unused avoid overﬁtting. poses generated virtual camera views augmented pcss. epoch sample learned distribution generate batch synthesized data. results comparisons human.m. evaluate method three protocols. compare method state-of-the-art methods report quantitative comparisons table results method obtains superior performance competing methods protocols. verify claims re-train three previous methods obtain performance protocol protocol quantitative results reported table. large drop performance previous reconstruction models demonstrates blind spot previous evaluation protocols over-ﬁtting problem models. notably method greatly surpasses previous methods additionally large performance protocol protocol demonstrates previous d-to-d reconstruction networks easily over-ﬁt camera views. general improvements different settings demonstrate superior performance good generalization. humaneva-i. compare method state-ofthe-art methods quantitative comparisons humaneva-i reported table seen results outperforms previous methods across vast majority subjects average. mpii. visualize sampled results generated method mpii well human.m figure seen method able accurately predict pose indoor in-the-wild images. variants ours full w/o. grammar kinematics kinematics+symmetry w/o. extra pairs extra pairs extra pairs simple bruce w/o. bruce martinez w/o. martinez grammar model encodes high-level grammar constraints network. first exam performance baseline removing three grammar model error .mm. adding kinematics grammar provides parent-child relations body joints reducing error adding symmetry grammar obtain extra error drops combing three grammar together reach ﬁnal error .mm. pose sample simulator next evaluate inﬂuence d-pose samples simulator. comparing results using data original camera views human results adding samples generating ground-truth pairs extra camera views errors drop showing extra training data indeed expand generalization ability. next compare pose sample simulator simple baseline i.e. generating samples adding random noises joint arbitrary gaussian distribution white noise. unsurprisingly observe drop performance even worse using ground-truth pose. suggests conditional distribution helps bridge detection results groundtruth. furthermore re-train models proposed validate generalization pss. results also show performance boost methods conﬁrms proposed generalized technique. therefore ablative study validates generalization well effectiveness pss. paper propose pose grammar model encode mapping function human pose method obtains superior performance state-ofthe-art methods explicitly encoding human body conﬁguration pose grammar generalized data argumentation technique. explore interpretable effective network architectures future.", "year": 2017}