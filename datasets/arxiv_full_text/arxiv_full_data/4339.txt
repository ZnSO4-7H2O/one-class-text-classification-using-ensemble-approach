{"title": "Tree-Cut for Probabilistic Image Segmentation", "tag": ["stat.ML", "cs.CV"], "abstract": "This paper presents a new probabilistic generative model for image segmentation, i.e. the task of partitioning an image into homogeneous regions. Our model is grounded on a mid-level image representation, called a region tree, in which regions are recursively split into subregions until superpixels are reached. Given the region tree, image segmentation is formalized as sampling cuts in the tree from the model. Inference for the cuts is exact, and formulated using dynamic programming. Our tree-cut model can be tuned to sample segmentations at a particular scale of interest out of many possible multiscale image segmentations. This generalizes the common notion that there should be only one correct segmentation per image. Also, it allows moving beyond the standard single-scale evaluation, where the segmentation result for an image is averaged against the corresponding set of coarse and fine human annotations, to conduct a scale-specific evaluation. Our quantitative results are comparable to those of the leading gPb-owt-ucm method, with the notable advantage that we additionally produce a distribution over all possible tree-consistent segmentations of the image.", "text": "paper presents probabilistic generative model image segmentation i.e. task partitioning image homogeneous regions. model grounded mid-level image representation called region tree regions recursively split subregions superpixels reached. given region tree image segmentation formalized sampling cuts tree model. inference cuts exact formulated using dynamic programming. tree-cut model tuned sample segmentations particular scale interest many possible multiscale image segmentations. generalizes common notion correct segmentation image. also allows moving beyond standard single-scale evaluation segmentation result image averaged corresponding coarse human annotations conduct scale-speciﬁc evaluation. quantitative results comparable leading gpb-owt-ucm method notable advantage additionally produce distribution possible tree-consistent segmentations image. image segmentation problem formalized partitioning image nonoverlapping regions region homogeneous. mathematically expressed terms objective function input data one-dimensional ordering problem referred changepoint problem dynamic programming used optimal segmentation e.g. however approach tractable image regions arbitrary shape. instead given superpixels image make region tree superpixels leaves regions obtained cuts tree. given region tree formalize image segmentation sampling posterior cuts tree generative model. image segmentation amounts selecting segmentation many possible multiscale segmentations encoded region tree. tree structure inference sampling cuts exact formulated using dynamic programming. figure illustration tree-cut original image. superpixels corresponding leaves region tree. region trees showing active nodes tree-cutting different parameters. resulting forests segmentations. nodes subtree rendered color. coarse segmentation regions segmentation regions. obtained respectively meaning parameters explained section primary contribution paper formulation principled efﬁcient probabilistic hierarchical model image segmentation. model generative thus allows probabilistic sampling image segmentations particular scale interest scale deﬁned terms number regions resulting segmentation. efﬁciently done training parameter model ground-truth segmentations desired scale. second contribution generalize common notion correct segmentation result image. allows move beyond evaluation methods average result human annotations given image. contrast provide ﬁne-grained evaluation e.g. tuning model provide coarser ﬁner segmentations user speciﬁcations training. remainder paper organized follows section describe model treecuts likelihood regions efﬁcient computations inference sampling posterior segmentations. also include discussion related work. section describe experiments bsds datasets including evaluation tuning method provide coarser ﬁner segmentations. conclude discussion directions future work. start region tree whose leaves correspond superpixel decomposition image. region deﬁned activating node tree—this means superpixels governed node considered form region. active node corresponds tree disconnects subtree remainder tree. valid segmentation obtained activating nodes node active path leaf root refer oonapp constraint. convenient generating segmentations obeying oonapp constraint top-down fashion. starting root either activate node leave root inactive move consider children removing edges root. child face question whether activate not. process continues reach leaf node must activated otherwise superpixel would accounted image. ascribe probabilities conﬁguration following manner. node activation probability associated binary variable prior probability variables collected vector active nodes denoted nodes lying active nodes variables active nodes note nodes penalty term would identiﬁed easy show construction deﬁnes valid probability distribution tree-cuts. consider subtree rooted node assume distribution conﬁgurations subtrees valid probability distributions. probability probability probability evaluated product conﬁgurations children. denote break sums variables subtree. summing letting denote variables subtree rooted node obtain likelihood region node active denoted non-leaf node explain data governed either making active node passing responsibility children. thus total probability explaining data governed node given recursive formula leaf nodes compute bottom-up pass tree obtain optimal conﬁguration top-down backtracking pass stored argmax decisions made node tree. sampling root computed direct contribution j∈ch sample tree conﬁgurations ﬁrst sample root active stop alternatively recurse subtrees sample basis. variety segmentations obtained sampling illustrated figure need deﬁne likelihood model data given node. simplest assumption assume pixels region drawn gaussian distribution. pixels dimensional vectors values maximum likelihood solutions mean covariance matrix data likelihood empirical mean instead maximizing would possible integrate bayesian analysis; normal-wishart prior would conjugate likelihood. complex likelihoods involving spatial correlations pixels discussed sec. hmms speech recognition well-known useful adjust relative scaling likelihood structural terms likelihood term arises continuous observations structural terms arise discrete transition probabilities. recursive equations easily handled simply multiplying likelihood factor order assess effect various likelihoods also devised ground-truth likelihood term taking account segment labels annotations. denote number labels type region different labels. ascribe probability label region log-likelihood model maximized setting ˆπij nij/ni. note ground truth likelihood still omits spatial correlations although likely optimistic relative independent gaussian model upper bound achieved. formulation internal node associated parameter corresponding leaves must note also region tree different input image. thus possible learn parameters directly accumulating information images. simple approach unique globally images segmentations optimize measure performance covering score note maximization likelihood would lead setting always obtain higher likelihood speciﬁc model superpixel rather merging them. interesting alternative would predict based information tree scores node children parent fraction nodes tree governed suitable predictor would e.g. logistic regression. case model would hierarchical conditional random ﬁeld parameters would basis image data. leave direction future work. vast number papers topic image segmentation going back decades. summary e.g. generally based clustering color texture features mixture models distribution-mode ﬁnding graph partitioning boundary detection closing boundaries. work arbelaez notable example boundary-detection based methods. ﬁrst boundary detector produce boundary response map. detected boundaries closed using oriented watershed transform resulting regions organized ultrametric contour region labelled weight value. thresholding particular weight usually denoted obtains segmentation scale varying produces strict hierarchy regions organized region tree nesting properties. refer work gpb-owt-ucm method. worth noting gpb-owt-ucm deﬁne distribution segmentations unlike model. particular value selects segmentation tree. multiscale-segmentation approaches also single threshold identify right scale segmentation general make distinction image segmentation unsupervised procedure semantic scene segmentation label pixel discrete object class labels e.g. vegetation vehicle etc. pylon model uses notion cuts region tree deﬁne possible segment labellings carries inference tree optimal cuts. cuts oonapp constraint similar work task image segmentation opposed semantic segmentation entirely different. also much prior work using tree-structured models tasks image segmentation. example used quad-tree structured belief network carry semantic segmentation task; disadvantage approach quad-tree structure depend input image structure lead blocky artifacts. dynamic trees work aimed address problem using prior distribution many candidate trees. however meant approximate variational inference used; contrast exact inference data-driven tree. recursive neural network learns merge agglomeratively superpixels produce tree structure. however note ﬁnal segmentation depends learned features applied superpixel-by-superpixel basis. experiments carried widely-used berkeley segmentation dataset versions bsds dataset bsds additional test images bsds used training/validation data. images segmented several human annotators. produce segmentation image carry inference described sec. evaluation metrics number ways evaluate agreement output segmentation algorithm human annotations. following consider segmentation covering score variation information probabilistic rand index notice rand index introduced evaluation clusterings i.e. specialized image segmentation intersection-over-union score regions deﬁned iou) r|/|r covering score segmentation segmentation given evaluating segmentations arbelaez consider situations term optimal dataset scale optimal image scale difference scale parameter whole dataset optimized image basis ois. consider experiments. ﬁrst evaluation criteria secondly sec. show methods tuned speciﬁc sets segmentations produce methods e.g. provide coarser ﬁner segmentations. results bsds-style data evaluation shown table bsds bsds datasets. results respective test sets cases parameters optimized training set. results covering gpb-owt-ucm treecut basically similar numbers lying within other. table results bsds bsds datasets. human gpb-owt-ucm results except gpb-owt-ucm re-calculated gpb-owtucm best performing method shown bold; covering higher numbers better lower better. tree-cut results ground-truth likelihood described sec. also conducted experiments sampling segmentations given image rather computing map; mean scores similar result. give idea variability covering score average standard deviation around would expected using ground-truth likelihood improve performance tree-cut markedly suggests could beneﬁcial look better likelihood models observe measures tree-cut close human performance makes sense given making information human-provided segmentations. interest report parameters gpb-owt-ucm models maximize covering score. gpb-owt-ucm searched grid equally-spaced values tree-cut method considered scaling factors likelihood steps considered values denser gridpoints towards higher values optimal values bsds bsds optimal values scores section obtained averaging segmentations available given image. however natural want able control level detail obtained done method varying parameter gpb-owt-ucm varying models trained optimize covering score groups training data. test-set covering scores reported table evaluated bsds test images. gpb-owt-ucm models notable performance better training taken place type data used testing performance differences inside columns generally larger method gpb-owt-ucm; example testing coarse data difference gpb-owt-ucm difference implies effect tuning stronger gpb-owt-ucm. comparing last line tables either method trained data never hurts performance train speciﬁc subset data testing division. gpb-owt-ucm optimal values obtained coarse medium training respectively. make sense coarser segmentations correspond higher values. tree-cut greater interpretability chosen corresponding values resp. would expected coarser segmentations lead values nearer main contribution introduce principled efﬁcient hierarchical model image segmentation extending ideas changepoint analysis images. results sec. show produces similar results gpb-owt-ucm method terms standard bsds evaluation scores using segmentation. great advantage method produce segmentation sample segmentations order reﬂect different possible interpretations. second contribution delve deeper image segmentation task addressing fact bsds data contains multiple segmentations given image. shown sec. tree-cut gpb-owt-ucm methods tuned produce coarser ﬁner segmentations evaluated affects segmentation covering scores. number directions work extended. firstly model generative deﬁning distribution given tree. would possible create discriminative version aims optimize based training segmentations spirit secondly independent-pixel gaussian likelihood used sec. simple richer models take spatial correlations account could used. example could gaussian field experts model gaussian process model special features modelling image textures conditional autoregressive model pixel predicted basis context however using models would greatly increase computational cost model ﬁtting. thirdly setting values globally tree simple would interesting predict values information available tree discussed sec. could also mean selecting different values different parts image would useful complex scenes large variations object sizes finally method gpb-owt-ucm single data-driven tree. however natural consider distribution possible trees e.g. work dynamic trees incorporate idea tree-cut model number different trees sample segmentations them. relative weights could obtained likelihood computed sec. thank glencora borradaile helpful discussions. thanks rich zemel conversation importance producing multiple image segmentations. associate fellow neural computation adaptive perception program canadian institite advanced research work supported part grants", "year": 2015}