{"title": "Wavelet Residual Network for Low-Dose CT via Deep Convolutional  Framelets", "tag": ["stat.ML", "cs.AI", "cs.CV", "cs.LG"], "abstract": "Model based iterative reconstruction (MBIR) algorithms for low-dose X-ray CT are computationally expensive. To address this problem, we recently proposed the world-first deep convolutional neural network (CNN) for low-dose X-ray CT and won the second place in 2016 AAPM Low-Dose CT Grand Challenge. However, some of the texture were not fully recovered. To cope with this problem, here we propose a deep residual learning approach in directional wavelet domain. The proposed method is motivated by an observation that a deep convolutional neural network can be interpreted as a multilayer convolutional framelets expansion using non-local basis convolved with data-driven local basis. We further extend the idea to derive a deep convolutional framelet expansion by combining global redundant transforms and signal boosting from multiple signal representations. Extensive experimental results confirm that the proposed network has significantly improved performance and preserves the detail texture of the original images", "text": "medical imaging deep learning approaches extensively used image-based diagnosis. however deep learning approaches medical image reconstruction problems x-ray reconstruction relatively less studied although preliminary results available particular group introduced world-ﬁrst deep learning approach low-dose x-ray whose performance rigorously conﬁrmed winning second place award aapm low-dose grand challenge. however reconstruction results tend lose detail textures original images. therefore important contributions paper propose drastically improved deep network overcomes limitations previous work maintaining detailed textures edges. improvement comes novel observation interpreted special form deep convolutional framelets here deep convolutional framelets recent proposal signal representation recursively applying convolutional framelet expansion combined rectiﬁed linear unit nonlinearity designed achieve perfect reconstruction speciﬁcally original convolutional framelets tight frame representation signal convolving data-driven local basis given nonlocal basis. convolutional framelets intriguing link recent rank hankel matrix approaches since optimal bases obtained hankel matrix decomposition companion paper revealed non-local local basis structure convolutional framelets close link deep learning network observing non-local basis determines overall deep network architecture local basis learned optimally convolutional ﬁlters. seeing eyes deep convolutional framelets paper discovers limitation prior work lowdose x-ray provides theory performance improvement. particular show deep convolutional framelets expansion still possible redundant nonlocal transform applied beforehand decorrelate global redundancies deep convolutional framelets allows novel signal boosting scheme combining multiple signal representation. observation leads novel wavelet domain residual learning algorithm redundant abstract—model based iterative reconstruction algorithms low-dose x-ray computationally expensive. address problem recently proposed world-ﬁrst deep convolutional neural network low-dose x-ray second place aapm low-dose grand challenge. however texture fully recovered. cope problem propose deep residual learning approach directional wavelet domain. proposed method motivated observation deep convolutional neural network interpreted multilayer convolutional framelets expansion using non-local basis convolved data-driven local basis. extend idea derive deep convolutional framelet expansion combining global redundant transforms signal boosting multiple signal representations. extensive experimental results conﬁrm proposed network signiﬁcantly improved performance preserves detail texture original images. used various ways including whole-body diagnostic c-arm interventional imaging dental etc. however x-ray causes potential cancer risks radiation exposure. order ensure safety methods minimizing xray dose intensively investigated. conventionally reduction number x-ray photons using tube current modulation seen solution. drawback approach however signal-to-noise ratio projections induces noise reconstructed image. noise low-dose x-ray often approximated gaussian noise model suitable streaking noise originating photon starvation beam hardening various model based iterative reconstruction methods investigated obtain clear reconstructed image. however approaches usually computationally expensive iterative applications forward backward projections. recently deep learning approaches actively explored extensive data powerful graphical processing units network units rectiﬁed linear unit pooling batch convolutional framelets novel signal representation scheme using bases ﬁxed non-local basis data-driven learning-based local dictionaries related decomposition aforementioned hankel matrices. results energy compacting expansion coefﬁcients underlying hankel matrix dimensional structure then image denoising problem addressed retaining high energy expansion coefﬁcients. link convolutional framelets deep network signiﬁcantly extend original form convolutional framelets follows proposition rn×m rd×q satisfy following resolution identity notation means zero matrix. identity matrix referred in×n. given matrix rm×n notation refers generalized inverse. superscript denotes hermitian transpose. mainly interested real valued cases equivalent transpose inner product matrix space deﬁned trb) rn×m. matrix denotes frobenius norm. given matrix rn×m denotes j-th column elements matrix rpd×q partitioned sub-matrix rd×q convolution operation represented using hankel matrix operation. speciﬁcally hankel matrix easily obtained convolution paper avoid special treatment boundary condition theory mainly derived using circular convolution. speciﬁcally input image convolutional ﬁlter kernel. then single-input single-output convolution given matrix vector multiplication resulting convolutional framelet expansion indeed mimo convolution operations. thus combing suggests convolutional framelets extendted deep network multiple convolutional framelet expansions cascaded sequentially retaining encoder-decoder architecture local ﬁlters dual ﬁlters. addition non-local transform de-correlates ﬁltered signals local ﬁlters important note order local ﬁlter global ﬁlters interchanged matrix multiplication commute convolution. issue revisted later. important discoveries companion paper structure closely related convolutional layers cnn. speciﬁcally single layer convolutional framelet expansion represented in×n corresponds encoder decoder network without pooling shown fig. moreover popular pooling unpooling explained choosing appropriated non-local basis however also showed pooling unpooling non-local bases satisfy perfect reconstruction condition thus proposed haar wavelet basis improve upon existing deep learning architecture companion paper idea extended enable convolutional framelets decomposition multiple inputs using redundant bases. speciﬁcally rn×m rpd×q satisfy resolution identity i.e. in×n ipd×pd. suppose furthermore convolutional framelet good energy compaction property thus interested using contourlet transform without decimation following prior work vanishing moments wavelets wavelet transform annihilate smoothly varying signals maintaining image edges thus resulting good energy compaction. furthermore low-dose x-ray images exhibit streaking noise. therefore contourlet transform good detecting streaking noise patterns expands directional edge information x-ray images high energy compaction. implies exists inverse transform ˜tk}p collect subband signals recompose original signal. speciﬁcally signal decomposed directional components note role global transform nonlocal basis deep convolutional framelets similar since de-correlate global redundancies. thus paper uses setting in×n∀k. then goal obtain convolutional framelet representation input matrix another important contribution paper theory signal boosting using multiple signal representation. speciﬁcally conditions deep convolutional framelets denotes ﬁlter length number input channels i-th layer respectively. then given input target sample pairs yi}n training data inserting rectiﬁed linear unit nonlinearity max{ steps convolutions l-layer convolutional framelets training problem given deﬁned similar existing training exists fundamental differences. first even relu nonlinearity show still guaranteed sufﬁcient number ﬁlter channels available case target sample input training problem nothing ﬁlter bank design problem guarantee many important open questions deep learning number ﬁlter channels convolutional layer role rectiﬁed linear unit role pooling unpooling role by-pass connection residual network. show lower layers perform signal decomposition using various ﬁlter bank satisfying conditions high layers deep network exploit low-rank approximation extended hankel matrix multiple channel images. since low-rank approximation hankel matrix powerful tool inverse problems conjecture deep network trained signal decomposition well hankel matrix approximation optimally ﬁtted desired input/output relationship. section extend results non-local global transform applied ﬁrst local ﬁltering applied remove remaining local correlations. architecture many advantages compared aforementioned deep convolutional framelets architecture applies local ﬁltering ﬁrst. speciﬁcally global transform applied ﬁrst need backpropagate gradient global transform sophisticated global transform used exploit global redundancies. equivalent bypass connection residual residual wavelet coefﬁcients estimated denoised contourlet coefﬁcients obtained subtracting input noisy contourlet coefﬁcients. architecture deep neural network shown lower part fig. ﬁrst convolution layer uses convolution kernels produce channel feature maps. corresponds number minimum output channels satisfy moreover relu increases calculation) bigger channels. thus ﬁrst layer performs approximation ﬁrst layer hankel matrix. then following convolution layers convolution kernels believed perform hankel matrix approximation. next main module composed sets convolution batch normalization relu layers bypass connection convolution relu layer. again exploits advantages residual learning deep convolutional framelet uniquenesses wavresnet concatenation layer shown fig. speciﬁcally wavresnet concatenates outputs individual modules followed convolutional composed convolution kernels. discussed before corresponds signal boosting using multiple signal representation. optimization aspect also provides various paths gradient back-propagation. finally last convolution layer uses sets convolution kernels. correspond pair-wise decoder layers respect ﬁrst convolutional layers. applied stochastic gradient descent optimization method train proposed network. shift invariant contourlet transform allows patch processing used resulting wavresnet illustrated fig. here ﬁrst apply non-subsampled contourlet transform composed steps first step non-decimated multi-scale decomposition produce highpass lowpass subbands second step directional decomposition divide highpass subband directional components. k-th level ﬁlter banks generated iterating steps. down-sampling up-sampling ﬁlter banks; thus shift invariant. used level decomposition directional separations level produces total bands. thus non-local transforms shown upper part fig. rather estimating noisefree images network estimates noises. indeed average variance covariance variables stabilize division dynamic range pixel intensities. constants default routine dose x-ray images used ground truth denoised x-ray images quarter dose used calculate image metrics. compared proposed method denoising algorithms mbir regularized total variation recent image domain deep learning approach mbir regularized solved using alternative direction method multiplier chambolle’s proximal parameters red-cnn obtained original paper verify improvement algorithm perform comparative study previous deep network wavelet domain low-dose grand challenge call network aapm-net. main difference proposed aapm-net comes deﬁnition target images. aapm-net target images original wavelet coefﬁcients except lowest frequency band. speciﬁcally aapm-net lowest frequency band target residual whereas higher frequency band signals wavelet coefﬁcients themselves. therefore residual perspective deep convolutional framelets. hand wavresnet residual wavelet coefﬁcients routine-dose low-dose inputs estimated every subband. order demonstrate importance signal boosting also implemented symmetric network illustrated fig. except concatenation layers symmetric network also identical modules structures symmetric encoder encoder structures. fair comparison symmetric network also estimates residual wavelet coefﬁcients routine-dose low-dose inputs. conﬁrm improvement aapm-net present reconstruction images patient data test data data routine-dose images used subjective evaluation objective evaluation using psnr ssim. fig. various kinds slices liver pelvic bones described magniﬁed images expressed yellow boxes. aapm-net results noise level signiﬁcantly reduced results blurry loses details. hand result proposed wavresnet clearly shows improved noise reduction maintaining edge details textures patches training. size minibatch convolution kernels initialized random gaussian distribution. learning rate initially decreased continuously gradient clipping employed range high learning rate initial steps fast convergence. data augmentation training data randomly ﬂipped horizontally vertically. network implemented using matconvnet matlab environment used projection data obtained low-dose grand challenge. projection data measured cylindrical detector moves along helical trajectory using z-ﬂying focal spot projections approximated fanbeam projection data single slice rebinning technique reconstructed x-ray images using conventional ﬁltered backprojection algorithm. number pixels x-ray images slice thickness patient data sets routine dose quarter dose data training. eight patient data used training validation remaining patient data used testing. among eight patient data used slices training remaining slices validation. fig. transverse view reconstruction results routine-dose quarter-dose images. aapm-net algorithm applied lowdose grand challenge. intensity range example liver example intestine example pelvic bone. helpful diagnostic purpose. speciﬁcally case liver image fig. wavresnet result retains details vessels liver better sharpness aapm-net. fig. detail internal structure intestine observed quarter-dose images aapm-net results well-recovered wavresnet. examine streaking noise reduction ability presented slice pelvic bone fig. wavresnet good preserving edge details inside region bones texture organ located bones streaking artifacts completely removed. coronal sagittal view reconstruction results described fig. quarter-dose images show noise levels different depending slices. lower part images exhibit high noise level pelvic bones included. proposed method remove wide range noise levels maintain texture edge information. network. column describes slice fig. respectively. difference images symmetric network wavresnet contains noise low-dose x-ray images difference images aapm-net also contains edge information. fig. shows results comparative algorithms mbir regularized red-cnn state-of-art image denoising algorithm using nonlocal patch processing mbir currently standard algorithm low-dose x-ray images. red-cnn recently proposed deep network low-dose x-ray intensity transverse view fig. adjusted inside structures lung. result loses details lung vessels exhibited cartoon artifact. result mbir appears little blurred textures reconstructed incorrectly. hand deep learning based denoising algorithms better performances algorithms. however red-cnn results somewhat blurry proposed method provides clear proposed method look similar quantitative improvement image metric values clearly conﬁrms advantages signal boosting effect concatenation layer. quantitatively evaluate convergence behaviour reconstruction performance wavresnet compared baseline network identical structure directly estimate wavelet coefﬁcients. fig. conﬁrms learning performance wavresnet best. here also showed aapm-net results. wavresnet improvement psnr aapm-net. fig. coronal sagittal view reconstruction results routine-dose quarter-dose images. aapm-net algorithm applied low-dose grand challenge. intensity range reconstruction results. coronal sagittal view results conﬁrmed performance wavresnet. lower part coronal sagittal view images higher noise level pelvic bones. results mbir red-cnn still noises pelvic bones exhibited blurry images pelvic bones whereas proposed method clear results signiﬁcantly reduced noise levels. table presents averaged psnr ssim index values results slices. proposed method highest psnr ssim index value. symmetric network’s psnr ssim values slightly lower proposed method. difference images symmetric network fig. reconstruction results routine-dose quarter-dose image. transverse view reconstruction images’ intensity range adjusted details lung. intensity range coronal sagittal view reconstruction images’ intensity range shen y.-b. yang image restoration using deep convolutional encoder-decoder networks symmetric skip connections advances neural information processing systems ronneberger fischer brox u-net convolutional networks biomedical image segmentation international conference medical image computing computer-assisted intervention. springer deep convolutional framelets general deep learning inverse problems arxiv preprint arxiv. daubechies tale bases localnonlocal regularization image patches convolution framelets siam journal imaging sciences vol. compressive sampling using annihilating ﬁlter-based low-rank interpolation ieee transactions information theory vol. feb. reference-free single-pass nyquist ghost correction using annihilating ﬁlter-based rank hankel matrix magnetic resonance medicine vol. december j.-y. s.-h. park artifact correction using sparse+ low-rank decomposition annihilating ﬁlterbased hankel matrix magnetic resonance medicine vol. flohr stierstorfer ulzheimer bruder primak mccollough image reconstruction image quality evaluation -slice scanner z-ﬂying focal spot medical physics vol. paper proposed wavelet domain residual network low-dose x-ray reconstruction. provide theoretical background performance improvement employed recent proposal deep convolutional framelets interprets deep learning multilayer implementation convolutional framelets relu nonlinearity. combining redundant global transform residual network signal boosting concatenation layers wavresnet provided signiﬁcant improvement compared prior work retaining detailed texture. using extensive experimental results showed wavresnet good streaking noise reduction preserving texture details organs lesion information maintained. authors would like thanks cynthia macollough mayo clinic american association physicists medicine grant national institute biomedical imaging bioengineering providing low-dose grand challenge data set. work supported korea science engineering foundation grant number nrf-rab.", "year": 2017}