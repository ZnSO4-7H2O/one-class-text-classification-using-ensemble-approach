{"title": "Convexifying the Bethe Free Energy", "tag": ["cs.AI", "cs.LG"], "abstract": "The introduction of loopy belief propagation (LBP) revitalized the application of graphical models in many domains. Many recent works present improvements on the basic LBP algorithm in an attempt to overcome convergence and local optima problems. Notable among these are convexified free energy approximations that lead to inference procedures with provable convergence and quality properties. However, empirically LBP still outperforms most of its convex variants in a variety of settings, as we also demonstrate here. Motivated by this fact we seek convexified free energies that directly approximate the Bethe free energy. We show that the proposed approximations compare favorably with state-of-the art convex free energy approximations.", "text": "introduction loopy belief propagation revitalized application graphical models many domains. many recent works present improvements basic algorithm attempt overcome convergence local optima problems. notable among convexiﬁed free energy approximations lead inference procedures provable convergence quality properties. however empirically still outperforms convex variants variety settings also demonstrate here. motivated fact seek convexiﬁed free energies directly approximate bethe free energy. show proposed approximations compare favorably state-of-the convex free energy approximations. computing likelihoods marginal probabilities critical subtask applications graphical models. computing exact answers often infeasible growing need approximate inference methods. important class approximations variational methods pose inference terms minimizing free energy functional. last decade loopy belief propagation simple local message passing procedure proved empirically successful used variety applications seminal work yedidia merged lines work formulating loopy belief propagation terms optimizing bethe free energy approximate free energy functional. suffers inherent problems fails converge cases converge local optima non-convexity bethe free energy. several approaches introduced non-convergence issue provably converges local optimum bethe free energy however still leaves problem local optima therefore dependence solution initial conditions. alleviate problem several works construct convex free energy approximations single global optimum. convexity also paved introduction provably convergent message-passing algorithms calculating likelihood marginal probabilities moreover approximations provide upper bounds partition function despite algorithmic elegance convergence properties convex variants often provide better empirical results lbp. observation shared many practitioners theoretical justiﬁcation. motivated observation goal work construct approximations convex directly approximate bethe free energy. show approximate bethe norm best upper bound given random ﬁeld. illustrate utility proposed approximations comparing previously suggested ones across variety models parameterizations. probabilistic graphical models provide succinct language specify complex joint probabilities many variables. done factorizing distribution product local potentials. denote vector discrete random variables. focus markov random fields joint probability given correspond subsets parameters partition function serves normalize distribution. denote marginal distributions variables factors respectively vector marginals µµµ. required calculating likelihood evidence especially context parameter estimation. finding exact answers tasks theoretically practically hard thus many works often resort approximate inference. itself observation sufﬁcient provide efﬁcient algorithm since maximization hard original inference task. speciﬁcally difﬁcult characterize computation also intractable need approximated. first relax optimization problem outer bound marginal polytope. particular natural require resulting pseudo-marginals obey local normalization marginalization constraints. constraints deﬁne local polytope entropy term family entropy approximations long history statistical physics based crhr subsets variables coefﬁcients called counting numbers approximate optimization problem takes form entropy approximation deﬁned choice regions choice counting numbers. poses complementary challenges deﬁning regions assigning counting numbers regions. focus second problem arises choice regions. simplicity limit common choice regions variables factors although shortcoming bethe entropy concave thus local optima. possible consider instead entropy approximations provably concave. approximations studied extensively recent years along provable convergent algorithms solving cases. ﬁrst concave entropy approximations introduced tree-reweighting method wainwright al.. entropy approximation convex combination tree entropies concave. furthermore upper bound true optimum yields upper bound recently heskes derived sufﬁcient condition yield concave function. showed entropy approximation provably concave exist auxiliary counting numbers optimization problem solved using generic optimization tools. however message passing algorithms proved especially useful task. starting work yedidia many message passing algorithms proposed optimizing variational approximations. although algorithms provably convergent converge ﬁxed point furthermore entropy concave global optimum existing algorithms make assumption since work want explore broader range approximations derive message passing updates general case derivation follows closely yedidia results following update rules desirable property counting numbers result concave entropies discussed section several rationales choosing those. clearly optimization globally optimal. true entropy concave corresponding solve factorized model exactly. call values obey variablevalid variables counted correctly similar deﬁne factor-valid approximaintuitively approximations satisfy valid appealing property overunder-counting variables factors approximate entropy furthermore tree structured distributions shown valid counting numbers yield exact results figure illustrates structure constraints space counting numbers. note bethe approximation single choice counting numbers factorvariable-valid. approximation deﬁnition always variable-valid distribution spanning trees results different value finally note different model structures counting number space looks different. example bethe approximation tree structured distributions convex. better understand properties different counting numbers perform experiment counting number space dimensional visualized. toroidal grids variable connected four neighboring variables pairwise factors. joint probability distribution model given {±}. ﬁeld parameters drawn uniformly range interaction parameters drawn either range obtain mixed attractive potentials respectively model structure inherent symmetry factors pairwise variable appears exactly four factors. hence choose counting numbers approximation based solely structure model variables factors. figure shows performance various approximations models. ﬁrst model sampled easy regime relatively weak interaction parameters second model sampled difﬁcult regime stronger interaction parameters. observe convex free energy approximations large errors estimate logpartition marginal beliefs. looking subspaces tend empirically perform better figure quality different approximations instances toroidal grid different parametric scenarios. matrix x-axis denotes counting number nodes y-axis denotes counting number edges grid pixel matrix result running belief propagation counting numbers. subspace provably convex approximations bound solid lines variable-valid subspace marked dotted line. left column shows error approximate log-partition function middle column shows average error approximate marginals factors variables. rightmost column shows detail approximation quality variable-valid subspace. colored stars show various approximations others convex subspace seem generally give good approximations. however notice variable-valid approximations stand main region relatively error. fact note best knowledge free energy approximations suggested literature obey variable-valid constraint rightmost column figure shows performance variable-valid approximations. notice almodels tested approximation improves counting numbers closer bethe counting numbers. however cases bethe approximation outperforms convex counterparts. obtained similar results fully connected graphs non-pairwise models following insights previous section natural combine convexity constraints validity constraints deﬁned inside subspace straightforward choice counting numbers closest terms euclidean distance bethe counting numbers. clarity denote vector bethe counting numbers deﬁne convexbethe-c approximation solution optimization problem experiments previous section demonstrate bethe free energy performs well across variety parameter settings. since would like work convex free energies question convex free energies comes closest performance bethe. follows describe several approaches obtaining counting numbers satisfy requirements. divide static approximations determine counting numbers based structure however clear metric counting number space adequate approximating bethe. principle would like approximate bethe entropy rather counting numbers. since function would like function figure comparison estimation errors partition function marginal probabilities several approximation schemes. ﬁrst take attractive potentials second mixed potentials. graph x-axis corresponds interaction meta-parameters y-axis shows error partition estimation marginal estimation line describes average errors grid models sampled corresponding meta-parameters. approximation graph corresponds uniform distribution four spanning trees. integrate since optimization range thus relevant domain approximation. although integration seems daunting simplify problem noticing written hµµµ hµµµ respectively hµµµ vector local entropies. results following quadratic optimization problem matrix integration pairwise products local entropy terms. exact calculation intractable resort mcmc methods performing random walk inside starting random point inside sample legal direction boundaries along direction sample uniformly point within bounded interval. straightforward argument shows stationary distribution walk uniform within determine random walk close stationary distribution apply heuristic convergence test running parallel several chains different random starting points comparing statistics determine convergence samples different runs estimate finally solve optimization problem without enforcing variable-valid constraints term approximations convexbethe-µvv convexbethe-µ respectively. evaluate quality approximations calculating marginals partition function nontoroidal grids various parameterizations. compare performance bethe approximation approximation using uniform distribution four spanning trees following wainwright trial ﬁxed value gradually increase interaction strength comﬁrst observe bethe approximation outperforms convex counterparts terms partition function approximation settings. however ﬁeld meta-parameter small interaction meta-parameter large convex approximations better bethe terms marginal probabilities estimates. results consistent previous studies among convex free energies optimal approximation bethe free energy better optimal approximation bethe counting numbers range parameters. convexbethe-µ perform well interaction regime presumably fact forced variable-valid thus exact independent models. settings best performance among convexbethe-µ yields convex approximations. conclude seeks convex performs across range parameters advantageous approximate bethe entropy function rather counting numbers. however comes price lower approximation quality regimes. regarding computation time heuristics require extra calculations. note however computation depend model parameters extra calculations need performed model structure. counting numbers determined optimization approximate free energy exactly standard addition performance convexbethe-µ approximation depends quality estimation matrix introduces trade-off cost mcmc simulation quality approximation controlled mcmc convergence threshold. approximations examined based structure model alone tuned parameters. intuitively good approximation assign weight stronger interactions weaker ones. indeed wainwright introduce method ﬁnding optimal weights entropy upper bounds true entropy thus corresponding variational approximation results upper-bound true partition function. wainwright thus seek counting numbers minimize upper bound. present different simpler approach adaptively setting counting numbers. previous section motivation approximate performance bethe approximation convex free energies. strategy consider implies optimum always upper bound bethe optimum. come close possible bethe optimum minfigure comparison partition function marginal probabilities estimates several free energy approximations. panel x-axis spans values y-axis spans values pixel shows difference average absolute errors random trials meta-parameters. pixels show parameterizations error ﬁrst approximation larger blue pixels show parameterizations error second approximation larger. constrain upper bound bethe free energy? turns simple condition achieves this show next. proposition difference approximate free energies written tribution since always holds upper bound bethe entropy. property sufﬁcient also necessary want counting numbers bound holds regardless µµµ. note counting numbers satisfy constraint thus approximation also upper bound bethe free energy. finally notice convexity constraints resulting entropy approximation always non-negative µµµ∗ maximizes ˜fc. given gradient conditional gradient algorithm minimize maxµµµ gives upper bound bethe. algorithm identical trw-opt except choice search direction within conditional gradient algorithm. trw-opt involves ﬁnding maximum weighted spanning tree case involves solving denote result optimization process convexbethe-u empirically method faster iterative optimization algorithm requires less calls inference procedure. importantly ﬁnding optimal counting numbers computationally hard non-pairwise models method naturally applicable general setting. evaluate adaptive strategy compare convexbethe-c approximation bethe approximation setting used static approximations addition since choice ﬁeld meta-parameter greatly inﬂuences relative performance approximation conduct experiments better understand role. instead ﬁxing figure adaptive heuristics improve static ones. moreover convexbethe-u procedure often accurate trw-opt. adaptive methods still inferior bethe approximation models tested except particular regions discuss above. extensive comparison different choices parameters reinforces observation accuracy approximations differ under various model parameters. suggests given model structure single best choice counting numbers better parametric settings. however bethe approximation gives better equivalent estimates log-partition function compared convex approximations except region weak ﬁeld meta-parameter strong interaction metaparameter furthermore advantage convex approximations bethe marginals estimation also region weak strong. examine generality observations repeated experiments described models structure fully connected graph nodes dense models differ sparse grid structured models similar results. also conducted similar experiments smaller larger grids models non-pairwise potentials similar results. therefore believe conclusions draw valid wide range models. study convex free energies originally motivated realization loopy belief propagation optimizing non-convex bethe free energy. thus alleviate non-convexity problem bethe optimization procedure indeed resulted elegant algorithmic message-passing solutions convex free energies. another interesting application convex free-energies optimizing bethe free energies sequences local convex approximations although resulted faster optimization still inherited localoptima problem bethe optimization. recently convex free energy variants shown particularly useful context model selection despite merits terms quality approximation convex free energies still often competitive bethe fact result poorer performance wide range parameter settings also show here. leads natural question address work best convex approximation bethe shown several approaches problem depending whether seek counting numbers independent model parameters tuned adaptively. results show convex bethe approximations often work better schemes. example counting numbers approximate bethe entropy norm across values often work better choices. furthermore adaptive strategy choosing best counting numbers given model often works better methods trw. adaptive procedures also easily extendible nonpairwise regions unlike becomes intractable cases. might argue reasonable directly approximate true entropy rather bethe entropy. main difﬁculty approach generally known thus approximations typically quite loose. example clear approximating norm bethe here. bethe free energy hand tractable show approximated various ways. thus even though lose approximating true entropy gain obtaining tighter approximations bethe entropy typically provides good performance. another conclusion results variablevalid counting numbers usually outperform non-valid ones. possible explanation fact guaranteed give exact results independent models. interesting open question constraints pose counting numbers enforce exactness different scenarios whether optimize numbers. jordan ghahramani jaakkola saul. introduction variational approximations methods jordan editor learning graphical models. graphical models. kluwer dordrecht netherlands c.w. steingr´ımsson. volume relaxed boolean-quadric polytopes. discrete math. j.s. yedidia w.t. freeman weiss. constructing free energy approximations generalized belief propagation algorithms. ieee transactions information theory", "year": 2012}