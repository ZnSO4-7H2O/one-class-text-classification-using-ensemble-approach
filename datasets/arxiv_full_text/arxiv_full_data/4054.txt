{"title": "Bayesian Inference of Recursive Sequences of Group Activities from  Tracks", "tag": ["cs.AI", "cs.CV"], "abstract": "We present a probabilistic generative model for inferring a description of coordinated, recursively structured group activities at multiple levels of temporal granularity based on observations of individuals' trajectories. The model accommodates: (1) hierarchically structured groups, (2) activities that are temporally and compositionally recursive, (3) component roles assigning different subactivity dynamics to subgroups of participants, and (4) a nonparametric Gaussian Process model of trajectories. We present an MCMC sampling framework for performing joint inference over recursive activity descriptions and assignment of trajectories to groups, integrating out continuous parameters. We demonstrate the model's expressive power in several simulated and complex real-world scenarios from the VIRAT and UCLA Aerial Event video data sets.", "text": "structure. activities described hierarchically recursively entailing multiple levels granularity time membership. arbitrarily sized groups actors participate activities fulﬁll roles. hierarchical descriptions temporally changing groupings consist best joint explanation full individual trajectories found posterior probabilistic inference. rest paper organized follows. next section review prior research focus work modeling group membership hierarchically structured activities identiﬁcation roles. section present probabilistic generative model. section present mcmc sampling framework performing joint inference using model. section evaluate model synthetic real-world data virat ucla aerial event video data sets demonstrating model’s expressive power effectiveness. conclude discussion future work. number researchers proposed models distinguish different roles individuals play coordinated activity models capture semantics activities component structure. difﬁcult scale role identiﬁcation scenes arbitrary number individuals particular properly handling identiﬁcation non-participants consequence joint inference role assignments groups model naturally distinguishes separates participants different activities playing different roles. considerable work devoted developing expressive models activities decomposed hierarchical levels description across different spatial temporal granularities. prior models account speciﬁc number hierarchical levels description levels popular choice models permit potentially greater number levels activity description activity hierarchy ﬁxed prior inference cases including model levels acpresent probabilistic generative model inferring description coordinated recursively structured group activities multiple levels temporal granularity based observations individuals’ trajectories. model accommodates hierarchically structured groups activities temporally compositionally recursive component roles assigning different subactivity dynamics subgroups participants nonparametric gaussian process model trajectories. present mcmc sampling framework performing joint inference recursive activity descriptions assignment trajectories groups integrating continuous parameters. demonstrate model’s expressive power several simulated complex real-world scenarios virat ucla aerial event video data sets. human activity recognition comprises range open challenges active research area spanning topics visual recognition individual behavior pairwise interactions among individuals participating different roles joint activity coordinated sequences actions expressions planned activity multiple groups individuals interacting across broad time scales. paper address last these presenting framework automatically constructing interpretation high-level human activity structure observed surveillance video across multiple interleaved instances activities. assume lower-level visual processing provides high quality tracks individuals moving scene. goal construct accurate descriptions events video different levels granularity based tracks alone. develop probabilistic generative model combines multiple features knowledge previously incorporated single framework joint inference. activities composite structure roles representing semantically distinct aspects overall activcopyright association advancement artiﬁcial intelligence rights reserved. figure example depicts synthetic trajectories corresponding activity tree representation. node activity tree represents activity. central label indicates activity name time interval activity underneath. node also numbered unique displayed bottom-right corner node rectangle. shaded nodes indicate physical activities. outer rectangles represent activity sequences whose roles participants displayed left corner rectangles. example node activity label meet start time time node part activity sequence realizing role approacher individuals show frames corresponding scene. circle represents individual curves paths ground plane. dotted rectangles represent activities performed individuals inside them labeled activity name activity tree node number. example time individuals walking together meet individuals standing happens individuals participating another global meeting together frame depicted participants meeting. third branch work devoted modeling activities among individuals involving groups actors. models activities include groups interactions still considered individuals within groups models allow activities performed groups still others including model take group activity modeling step further allowing arbitrary numbers participants groups provided satisfy group membership criteria performing activity recent papers ryoo aggarwal come closest accommodating combination features model. developed methods simultaneous inference group structure roles hierarchically structured activities. difference former like model ﬂexibly accommodate multiple levels activity description course inference latter restricted ﬁxed levels description inference crucial difference approach consider possibility detecting multiple occurrences type activity description scene descriptions integrated single probabilistic joint model order inﬂuence inference overall activity structure. activities described ryoo aggarwal hierarchical component structure roles model accommodate level activity occurring course video changes group membership individuals high-level activities. present probabilistic generative model describing coordinated activities groups individuals give rise observed physical trajectories actors involved. section introduce terminology. then section give precise deﬁnitions representations employed model activities groups activity sequences spatial trajectories. next section deﬁne factors joint probability distribution comprise generative model. finally section deﬁne speciﬁc activities used model scenes evaluation section terminology activities optionally composed activities. example canonical meet activity model consists multiple participating groups must move-to location meeting unless already there possibly wait groups arrive. engaging move-to activity requires group carry sequence walk activities. semantics walk turn characterized group’s physical trajectory space. scene described activity tree recursive structure much syntactic tree describes recursive phrase structure natural language sentence added temporal component. example tree depicted figure refer abstract nonterminal activities deﬁned terms activities intentional leaf activities deﬁned terms observable movement physical. participants intentional activity divided subgroups plays particular role respect parent activity. carrying particular role entails engaging sequence subactivities physical intentional. intentional activities group decomposed smaller subgroups role subactivity sequence subactivities performed participants role constrained according dynamics associated role. cases role parent activity realized sequence includes activity type parent structure recursive allows arbitrary nesting activities different time scales. example figure group individuals participating meet activity performs sub-meet own. physical activities associated group trajectories coupled either shared membership intentional activity requires coordination. individual observed trajectory generated sequence connected sub-trajectories physical activity participates constrained near respective group trajectory. example observed individual trajectories shown figure important feature model group trajectories explicitly represented inference. assertion group trajectory induces correlations among individual trajectories members average possible group trajectories computing posterior probability description. allows activity descriptions different numbers groups compared based posterior probabilities activity trees alone without needing deal probability densities different numbers dimensions. start time activity respectively. simplest activities physical activities e.g. walking running standing directly constrain motion group individuals interval time. example activity expected yield trajectories speeds corresponding typical human running. denote physical activity labels aphys. similarly intentional activities include meet move-to. denote intentional activity labels aint. complete activities denoted aphys aint. groups participants activity denoted |zc| size group. partitioned subgroups zkc} number subgroups bounded number individuals group. specifying probability model convenient work instead indicator variables indicates subgroups participant afﬁliated with. note contains exactly information partition. following description omit subscript readability. activity sequences subgroup within activity performs sequence subactivities. example subgroup meet might perform sequence subactivities ﬁrst move-to designated meeting location stand location meeting subgroups also approached location. alternatively subgroups could involved side meeting subgroups approach merge union merges another subgroup top-level meet. figure provides example. sequences subactivities performed subgroups governed roles. subgroup assigned role deﬁned parent activity roles govern dynamics sequence subactivities group carries parameters associated role. parameters role specify allowable activities activity sequence group carrying role well hard soft constraints involving order activities occur subgroup example meet activity would assigned role approacher prescribes move-to followed stand. case constraint order subactivities deterministic degrees freedom times transitions take place. constraints represented markov chain degenerate initial distribution transition matrix nonzero off-diagonal entry column. general initial transition distributions give rise softer constraints activity sequences. trajectories ultimately physical activity realized interval associated group trajectory denoted array specifying -dimensional position ground plane time index inclusive. group trajectory represents central tendency members’ individual trajectory segments interval since individual path depends sequence activities participates individual trajectory consists segments consecutive pairs must connected transition points denotes start segment segment generative model describe generative process activities. high-level process three steps recursive expansion intentional activities generation group trajectories physical activities generation individual trajectories conditioned group assignments group trajectories. overview ﬁrst step activity generation intentional activity gives rise child activity sequences subgroup participants involved parent activity. child sequence assigned role based parent activity type. subgroups role assignments occur jointly. choice role governs sequence activities subgroup engages specifying markov transition function. segment activity sequence physical activity another intentional activity. intentional activity sequence recursively expanded physical activities generated. working example stage process consider meet activity node root tree figure node child sequences corresponding subgroups involved meeting carrying approacher role. child sequences consists single move-to activity consists activities meet followed move-to. general special top-level root activity free-for-all comprises actors duration entire video. activities children root ffa. removed parent ffa.) details tree expansion given generating activity tree below. make conditional independence assumption supposing contents parent activity fully specify distribution possible child sequences child sequences conditionally independent given parent. since child sequences contain intentional activities activity generation recursive process bottoms intentional activities generated. second step generative process group trajectories generated physical activity. process must satisfy constraints physical activity trajectories share members border time must spatially connected; groups need physically interact co-participants intentional activity meet must trajectories intersect appropriate points time. constraints feasible generate group trajectories conditionally independently given activity tree. instead generated jointly according global gaussian process covariance kernel depends activity tree enforce figure graphical model intentional activity. participants activity partitioned groups .zmkm indicator vector group assigned role performs activity sequence example tree figure four group trajectory segments needed physical activity leaf node. since walk activity part meeting participants must meet participants walk activity group trajectories must location. similarly walk must stand located. ﬁnal step generative process individual trajectories realized conditioned group trajectories. here conditional independence possible individual’s trajectory depending sequence group trajectories physical activities individual participant. process detailed section generating individual trajectories. generating activity tree parent intentional activity indexes activities. participant divided subgroups participant assigned group distinct realized groups numbered deﬁnes partition subgroups zmkm} subgroup assigned role deﬁne subgroup participants role produces activity sequence according stochastic process associated parameters πrmk markov transition function trmk initial activity distribution. denote resulting sequence number jumps generated process activity tuples figure illustrates graphical model production. meet activity participants must location. transitional compositional edges weight zero corresponding constraint connected edges must correspond trajectory position. weight assigned temporal edges function time elapsed intervening physical activity associated activity label figure shows example figure constraint graph example activity tree figure nodes graph represent endpoints group trajectories labeled according numbering tree; e.g. starting endpoint node solid lines represent temporal edges dashed lines transitional edges dotted lines compositional edges clarity temporal edges labeled corresponding physical activity name. according graph distance w+w+w meaning activities must start locations separated stand walks. deﬁned compute distance matrix physical activity endpoints entry weights along shortest path node node path exists nodes distance transform covariance matrix applying covariance function λe−d locations group trajectory endpoints distributed conditioned endpoints interiors mutually independent x−∗m vector interior points trajectory x−∗m generated according gaussian process activity i.e. x−∗m normally distributed. finally distribution physical trajectories factorizes roles assigned independently additionally model partition subgroups using chinese restaurant process whose concentration parameter depends activity label. mass function parameter αam. segment intentional activity expanded members subdivided recursively according replacing zmk. expansions contain exclusively physical activities recursion bottomed out. resulting tree consists intentional activities physical activities intentional activity membership partition role assignments subgroup activity sequences denote complete tree whose prior distribution generating group trajectories leaves activity tree physical activities associated group trajectory. general endpoints different group trajectories independent since constrained start location. consequently deﬁne joint distribution group trajectory endpoints conditioned endpoints treat interiors independent. model interiors realizations gaussian processes squaredexponential kernel function. results trajectories generally smooth ﬂexible enough allow different kinds motion. different scale parameters depending activity determines rate change trajectory. specify dependencies among trajectory endpoints ﬁrst deﬁning undirected weighted graph endpoints. graph construct constraint matrix transition points interpreting weights shortest path nodes distances. apply positive semideﬁnite isotropic covariance kernel point-wise distance matrix transform distances covariances. sequence ground-plane positions make group trajectory activity abusing notation slightly write endpoints group trajectory corresponding node introduce three kinds edges temporal transitional compositional. nodes connected temporal edge belong physical activity. start activity connected another activity transitional edge correspond moment time corresponding activities share least participant. finally endpoints connected compositional edge correspond moment time common ancestor speciﬁes must coincide e.g. three physical single role allows activities take place. meet activity assigns non-zero probability roles approacher waiter; approacher performs meets move-tos waiter performs stands. move-to produces role mover switches uniformly random three physical activities. finally physical activities scale parameters σstand σwalk σrun. given individual trajectories depicted figure wish activity tree depicted figure best describes them. speciﬁcally wish maximize posterior probability activity tree given observed data integrands given general integral cannot computed analytically. however since every factor normal also normal makes evaluation straightforward. cannot maxλ analytically. instead draw samples posterior using metropolis-hastings algorithm keep sample highest posterior probability. iteration draw proposal distribution current sample accept sample standard acceptance probability ability efﬁciently explore space depends largely choice proposal distribution although work mcmc sampling tree models general approach applied model. consequently employ proposal distribution speciﬁc model. proposal distribution proposal mechanism composed sampling moves perform edits current hypothesized activity tree produce tree sample. drawing sample choose move uniformly random apply. applying move must make sure resulting tree valid requires book-keeping beyond scope document. also developed bottom-up activity detectors help explore space efﬁciently. detectors provide rough estimates groupings individuals frame activities performed group detectors ways. first initialize sampler state obtained transforming output detectors activity tree figure graphical model generation trajectories. example shows sequence activities activities single child individuals performing sequence physical activities divided groups performs single activity culminating physical activities corresponding group trajectory potentially depends physical activities well fully connected finally individual trajectories depend group trajectories whose physical activities contained individuals. generating individual trajectories described above individual participates physical activity sequence sequence group trajectories individual trajectory consists segments spans temporal interval given group trajectories individual trajectory segments mutually independent also gaussian process individual trajectories mean group trajectory i.e. ijth entry covariance function evaluated frames using scale corresponding activity label associated figure example graphical model distribution. figure illustration sampling moves. birth move inserts intentional activity sequences cmkm parent death move opposite operation performed. merge move children intentional activity participant zmk. reverse move randomly partitioned. example sequence move takes child sequences intentional activity node forms single sequence participant zmk. reverse move randomly choose split point activity sequence right create separate sequences parent additionally bias proposal distribution toward groups activities found detectors. example proposing merge move might choose participants predicted group activity detector. sampling moves inference employ following moves birth/death birth move inserts intentional activity node intentional activity children. randomly choose sibling activity sequences cmkm whose parent intentional activity insert intentional activity node becomes parent cmkm child death move randomly choose intentional node remove tree connect children nodes parent. merge/split merge move take sibling activity nodes label combine single activity. activities label groups create node label participants split move performs opposite operation taking a-labeled node splitting nodes activity assigning participants either uniformly. sequence/unsequence temporally non-overlapping sibling activity sequences. sequence move concatenates sequence unsequence move randomly selecting split point separate sequence. relabel move relabel move randomly changes label. note label must valid e.g. cannot assign physical activity label intentional activity node. detectors bottom-up detectors provide estimate individuals video grouped across time well physical activity performing. frame cluster individuals groups using trajectories ground plane. apply density-based spatial clustering applications noise algorithm independently frame feature composed position velocity individual frame obtained smoothed trajectories importantly keep track individual identities time recording actors involved group previous frame assigning cluster found following frame majority individuals still involved. given groups computed above want identify physical activities individuals hidden markov model observation function naive bayes model individual’s speed modeled gamma distribution transition function prefers staying within current activity. evaluate model ways. first demonstrate model’s expressive power inferring different types complexly structured scenarios synthetic data. ﬁrst groups individuals engage activities disband forming different groups time. second demonstrates recursively structured activity meeting component higher-level meeting. evaluate model real data; speciﬁcally publicly available group activity datasets virat ucla aerial event dataset evaluation performance measured terms well activities labeled scene well individuals grouped irrespective activity label. following ground truth inferred activity trees respectively. activity labeling activity video frame compare individuals performing ﬁrst deﬁne performance counts terms individual frame compute overall counts associated performance measures. figure qualitative results virat dataset. shows frames virat video. boxes represent tracked individuals gray rectangles indicate groups individuals white boxes contain information track etc. show inferred activity tree illustrated similar figure false negatives true positives true negatives individuals. grouping follow similar approach evaluating grouping performance. person compare groups belongs frame since trees could different depths topologies necessarily clear groups compared which; however every individual part exactly physical activity group frame well highest level node. consequently compare groups levels tree without penalty difference activities within level. thus determine group associated person frame physical activity level tree compute score before. results performance algorithm summarized tables table shows activity labeling precision recall synthetic scenes video sequence obtained virat dataset four different video sequences ucla aerial event dataset table performance measured grouping evaluation metric described above. synthetic data synthetic dataset comprises videos video trajectories ground plane. ﬁrst synth actors participate series meetings participants repeatedly change group memberships across frames. second features actors meeting four participating side meeting joining global meeting. table table activity labeling results synthetic videos synth synth virat ucla aerial event datasets. table shows precision recall activity. section details. shows model performs well high-level activities meet even presented nested structure. virat also evaluate real data speciﬁcally frames video virat dataset. video features seven people participating meetings groups exchange members several times. fig. shows frames video along inferred activity tree. model correctly recognizes meetings well groups highest level description. activity labeling results show perfect performance grouping results show perfect highest-level intentional activity score. before divergence ground truth physical activity level affect grouping score. ucla aerial event dataset extracted four video sequences ucla aerial event dataset speciﬁcally searched subsequences videos featured properties like activity nesting groups interchanging members etc. result four video sequences roughly frames each. table shows overall precision recall scores four videos algorithm performs reasonably well across activities. note relatively recall score meet activity large part long missed meet third video sequence. similarly table shows presented probabilistic generative model complex multi-agent activities arbitrary time scales. activities specify component roles groups actors accommodate unboundedly deep recursive hierarchical structure. model accommodates arbitrary groups participating activity roles describing between-group between-individual interactions. physical intentional activities explain hierarchical correlations among individual trajectories. knowledge existing model track-based activity recognition provides expressiveness joint model. modeling framework naturally extensible. currently undertaking several extensions including developing additional activities including following exchanging items interacting vehicles building entrances adding prior knowledge spatial layscene naturally constrains activities possible roads sidewalks impassible buildings spatial features inﬂuence behavior order improve accuracy speed reducing search space using model prior bayesian tracker connecting natural language activity descriptions model accommodates activity descriptions across multiple events tracking individual participation throughout providing opportunities building natural language narratives activities different levels granularity. research supported grants darpa mind’s program wnf--c- darpa ssim program wnf--. give special thanks paul cohen christopher geyer helpful discussions advice.", "year": 2016}