{"title": "Recurrent Fully Convolutional Neural Networks for Multi-slice MRI  Cardiac Segmentation", "tag": ["stat.ML", "cs.CV", "cs.LG"], "abstract": "In cardiac magnetic resonance imaging, fully-automatic segmentation of the heart enables precise structural and functional measurements to be taken, e.g. from short-axis MR images of the left-ventricle. In this work we propose a recurrent fully-convolutional network (RFCN) that learns image representations from the full stack of 2D slices and has the ability to leverage inter-slice spatial dependences through internal memory units. RFCN combines anatomical detection and segmentation into a single architecture that is trained end-to-end thus significantly reducing computational time, simplifying the segmentation pipeline, and potentially enabling real-time applications. We report on an investigation of RFCN using two datasets, including the publicly available MICCAI 2009 Challenge dataset. Comparisons have been carried out between fully convolutional networks and deep restricted Boltzmann machines, including a recurrent version that leverages inter-slice spatial correlation. Our studies suggest that RFCN produces state-of-the-art results and can substantially improve the delineation of contours near the apex of the heart.", "text": "abstract. cardiac magnetic resonance imaging fully-automatic segmentation heart enables precise structural functional measurements taken e.g. short-axis images left-ventricle. work propose recurrent fully-convolutional network learns image representations full stack slices ability leverage inter-slice spatial dependences internal memory units. rfcn combines anatomical detection segmentation single architecture trained end-to-end thus signiﬁcantly reducing computational time simplifying segmentation pipeline potentially enabling real-time applications. report investigation rfcn using datasets including publicly available miccai challenge dataset. comparisons carried fully convolutional networks deep restricted boltzmann machines including recurrent version leverages inter-slice spatial correlation. studies suggest rfcn produces state-of-the-art results substantially improve delineation contours near apex heart. cardiovascular disease major causes death world. physicians imaging technologies magnetic resonance imaging estimate structural functional cardiac parameters diagnosis disease management. fully-automated estimation parameters facilitate early diagnosis disease potential remove mechanistic aspects radiologist’s assessment. such lately increasing interest machine learning algorithms fully automatic left-ventricle segmentation challenging task variability shape across slices cardiac phases patients scanning machines well weak boundaries presence blood papillary muscles trabeculations. review segmentation methods short-axis cardiac images found main image analysis approaches segmentation grouped three broad categories active contour models machine learning models hybrid versions combine elements approaches. active contour models either explicit implicit contour representations minimize energy function composed internal external constraints. internal constraints represent continuity smoothness contour external constraints represent appearance shape target object. however designing appropriate energy functions handle sources variability challenging. also quality segmentations produced methods typically depends region-of-interest used initialise algorithms. machine learning approaches proposed circumvent issues expense collecting large training datasets suﬃcient number examples. investigating hybrid methods combine elements approaches active research area current state-of-the-art segmentation approaches rely deep artiﬁcial neural networks typically solutions consists three distinct stages carried sequentially. initially localised within twodimensional slice; segmented ﬁnally segmentation reﬁned improve quality. instance pipeline consisting deep belief networks localisation segmentation followed level-set methodology shown generate high-quality segmentations recent work diﬀerent pipeline proposed consists convolutional neural networks initial detection followed segmentation step deploying stacked autoencoders ﬁne-tuning strategy also based level-sets methodology latter approach proved produce state-of-the-art results miccai segmentation challenge approaches share number common features. first segmentation carried using two-dimensional patches independently extracted slice. second separate architecture tasks localization segmentation. third diﬀerent neural network architectures trained cardiac slices containing base apex heart observed heterogeneity local shape variability. work investigate neural network architecture trained end-toend learns detect segment jointly entire stack short-axis images rather operating individual slices. recently fully convolutional networks proposed segmentation images take arbitrarily sized input images feature pooling coupled upsampling step produce size outputs delivering segmentation. compared traditional sliding-window approaches fcns eﬃcient. received increasing interest lately unify object localization segmentation single process extracting global local context eﬀectively applications fcns medical imaging segmentation problems also started appear instance identiﬁcation neuronal structures electron microscopic recordings independent work valipour recently adapted recurrent fully convolutional networks video segmentation. images. motivated desire exploit spatial dependences observed across adjacent slices learn image features capture global anatomical structure heart full image stack. investigate whether exploiting information beneﬁcial accurate anatomical segmentation especially cardiac regions weak boundaries e.g. poor structural contrast presence blood papillary muscles trabeculations. experiments based independent datasets consisting short-axis cardiac images endocardium manually segmented expert radiologists axial slice. details provided below. miccai segmentation challenge dataset made publicly available sunnybrook health sciences center extensively used compare number segmentation algorithms consists cine images number diﬀerent pathologies. individual exams pre-grouped training validation online testing subsets. subset contains cases heart failure infarction heart failure without infarction hypertrophy healthy subjects. however clinical information used algorithms discussed experiments. images obtained breath-hold sessions lasting seconds phase diastole systole contains short-axis slices inter-slice ﬁeld view pixel size samples endocardial contours drawn experienced cardiologist taking slices end-systolic end-diastolic phases independently conﬁrmed second reader. manual segmentations used ground truth evaluation proposed models. consists sequences average sequence length slices. second larger dataset used independent evaluation cardiac segmentation algorithms. dataset consists subjects used study perinatal factors modifying left ventricular parameter individuals years age. these followed prospectively since preterm birth characterised average gestational fig. stack short-axis cardiac slices corresponding left-ventricular binary masks cardiac phase. proposed rfcn leverages spatial correlations observed moving base heart apex. cardiovascular prospectively gated acquired end-expiration breath holding. slices endocardial masks resampled homogeneous in-plane resolution yield manually contoured expert reader using siemens analytic software dataset randomly divided training validation testing sets sizes respectively. proposed recurrent fully-convolutional network extension architecture originally introduced predicting pixel-wise dense outputs arbitrarily-sized inputs. main idea underlying fcns extend contracting path sequence pooling operators progressively reduces size network adding successive layers pooling operators replaced upsampling operators. respect architecture similar u-net expanding path characterised large number feature channels allowing network propagate context information higher resolution layers. fig. overview rfcn architecture. blue boxes represent feature maps white boxes represent copied feature maps. number feature maps dimensions displayed left-side respectively. arrows represent network operations gray arrows indicate copy operations blue arrows indicate convolutional operations arrows indicate max-pooling operations green arrows leveraging inter-slice spatial dependences. input entire sequence slices obtained particular cardiac phase output sequence corresponding left-ventricular masks. input output image assumed equal size. schematic illustration given figure seen there slices around base heart cover larger regions show relatively clear boundaries whereas slices around apex cover smaller regions present blurred boundaries. learning typical shape deformations observed move base towards apex expected improve overall quality segmentation challenging regions around apex. three main building blocks characterise proposed rfcn illustrated figure feature-extraction path global-feature component upsampling path. feature-extraction component independently applied image stack deploys successive convolution max-pooling operations learn higher level features remove local redundancy. architecture component consists repeated block complete global-feature extraction block. given training recurrent architectures particularly diﬃcult well-document vanishing gradient problem several options considered implementation recurrent function including long short-term memory gated recurrent units module grus particular shown achieve performance comparable lstm number tasks involving sequential data whilst requiring fewer parameters less memory chosen convolutional variant local correlation input images preserved whilst achieving notable reduction number parameters compared non-convolutional counter part. every slice dense feature maps learned convolutional module upsampled compensate input size reduction caused max-pooling operations. upsampled features concatenated high resolution parallel layer aligned feature-extraction component similarly u-net architecture upsampling component consists repeated block convolutional layer followed relu. feature concatenation module combines outputs upsample layer parallel feature-extraction block. block upsampling component takes three-dimensional input eration fractional stride employed compensate reduction input size pooling operation. even though upsampling procedure smooths boundaries object segmented concatenation up-sampled feature maps high-resolution feature maps helps mitigate smoothing problem providing better local boundary information. recently deep belief networks proposed automatic detection segmentation using short-axis images ﬁrst used detect region interest containing anatomical segmentation carried using distance-regularised level sets modiﬁed leverage prior shape information inferred separate dbn. models fcns slice short-axis stack segmented independently others. main building block model restricted boltzmann machine typically trained using contrast divergence algorithm experiments assessed performance dbns segmentation comparably fcns proposed rfcns. order investigate whether modelling dependence across slices typically yields improved performance motivated existing body work dbns also assessed performance recurrent version restricted boltzmann machines originally proposed learn human body motion never used segmentation. rrbms stacked together form call recurrent deep belief network similarly proposed rfcn rdbn takes entire sequence short-axis slices input leverages spatial correlations additional bias units. information refer reader original work convolutional architectures rfcn trained minimizing cross-entropy objective function. trained using stochastic gradient descent algorithm momentum whereas rfcn trained using stochastic gradient descent algorithm rmsprop back-propagation used compute gradient cross-entropy objective function respect parameters model including component case rfcn. also learned required ﬁrst slice sequence. block batch normalization added convolutional layer i.e. max-pooling upsampling layers. reported results refer best experiments models initialised random parameters. rfcn initialised using weights obtained reduces training time provided good initial weights. rdbn architectures trained using contrast divergence algorithm dropout found improve overall performance. models best results achieved using learning rate constant decay epoch momentum weight decay training phase miccai preterm datasets augmented generating additional artiﬁcial training images prevent model dice index average perpendicular distance manually drawn predicted contours order make experimental results comparable published studies miccai dataset models validated using online report results obtained validation set. table summarises experimental results. miccai dataset dbn-based results presented include dice index whereas pipeline described results dice index comparable dice index obtained rfcn yield higher smaller adp. rfcn outperforms substantially improved preterm dataset modelled using architectures withcustomisation. results application also summarised table dataset compared performance four diﬀerent architectures rfcn rdbn. latter models given input region interest containing thus conferring advantage compared rfcn. dataset able test recently proposed pipeline described relies multiple stages. miccai dataset fully convolutional architectures achieved superior performance. rfcn outperformed architectures terms dice index found small comparison known location yields rdbn yields higher lower compared thus providing additional evidence performance gains obtained modelling intra-slice dependences. order shed insights regional improvements introduced rfcn dice index computed separately diﬀerent local regions results summarised table here base- base- base- indicates slices taken starting base heart moving towards middle analogously apex. remaining slices contributed towards central class. cases dice index calculated using samples reﬂect overall pixels accuracy. datasets rfcn outperforms around central slices around apex expected. however miccai dataset yields better performance around base heart. preterm dataset rdbn gave worst performance compared rfcn despite using focused region interests instead full-sized images. observed rdbn improves upon across cardiac locations. paper investigated whether single neural network architecture trained end-to-end deliver fully-automated accurate segmentation left ventricle using stack short-axis images. proposed architecture rfcn learns image features important localisation table performance assessment miccai preterm datasets. miccai dataset completeness also report published results postprocessing stage based level-sets. rdbn models performed endocardium segmentation detection i.e. applied focused regions interest centered around left-ventricle. architectures performed detection endocardium segmentation full short-axis slices. experimental ﬁndings obtained independent applications demonstrate propagating information adjacent slices help extract improved context information positive eﬀect resulting segmentation quality. hypothetical value large inter-slice correlation further tested introducing recurrent version deep belief networks veriﬁed results showing rdbns generally outperform dbns segmentation task assuming already localised. expected notable improvements seen delineation cardiac contours around apex notoriously diﬃcult identify. surprising ﬁnding note performance rfcn apical slices better miccai preterm cohort could expect opposite regular homogeneous cohort preterm lead better performance leveraging inter-slice spatial dependence. aspect warrant investigations. compared models rfcn advantage carrying detection segmentation single architecture clear computational beneﬁts potential real-time application. future work planning investigate alternatives operations capture inter-slice cortable breakdown dice index regions miccai preterm datasets. base-x apex-x represent number slice included starting base apex left ventricle respectively. index calculated using slices samples hence measuring overall pixels accuracy. rdbn performed segmentation task using pre-deﬁned region interest containing region. relations convolutions extend rfcn incorporating bi-directional mechanism inclusion inverse path well temporal extension handle cardiac phases once.", "year": 2016}