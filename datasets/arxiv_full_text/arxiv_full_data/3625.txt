{"title": "GAN-based Synthetic Medical Image Augmentation for increased CNN  Performance in Liver Lesion Classification", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Deep learning methods, and in particular convolutional neural networks (CNNs), have led to an enormous breakthrough in a wide range of computer vision tasks, primarily by using large-scale annotated datasets. However, obtaining such datasets in the medical domain remains a challenge. In this paper, we present methods for generating synthetic medical images using recently presented deep learning Generative Adversarial Networks (GANs). Furthermore, we show that generated medical images can be used for synthetic data augmentation, and improve the performance of CNN for medical image classification. Our novel method is demonstrated on a limited dataset of computed tomography (CT) images of 182 liver lesions (53 cysts, 64 metastases and 65 hemangiomas). We first exploit GAN architectures for synthesizing high quality liver lesion ROIs. Then we present a novel scheme for liver lesion classification using CNN. Finally, we train the CNN using classic data augmentation and our synthetic data augmentation and compare performance. In addition, we explore the quality of our synthesized examples using visualization and expert assessment. The classification performance using only classic data augmentation yielded 78.6% sensitivity and 88.4% specificity. By adding the synthetic data augmentation the results increased to 85.7% sensitivity and 92.4% specificity. We believe that this approach to synthetic data augmentation can generalize to other medical classification applications and thus support radiologists' efforts to improve diagnosis.", "text": "datasets still limited size applicable speciﬁc medical problems. collecting medical data complex expensive procedure requires collaboration researchers radiologists researchers attempt overcome challenge using data augmentation. common data augmentation methods include simple modiﬁcations dataset images translation rotation scale. using classic data augmentation improve training process networks standard procedure computer vision tasks however little additional information gained small modiﬁcations images synthetic data augmentation high quality examples sophisticated type data augmentation. synthetic data examples learned using generative model enable variability enrich dataset improve system training process. promising approach inspired game theory training model syntheses images known generative adversarial networks model consists networks trained adversarial process network generates fake images network discriminates real fake images repeatedly. gans gained great popularity computer vision community different variations gans recently proposed generating high quality realistic natural images interesting applications include generating images style another style image inpainting using recently several medical imaging applications applied framework studies employed image-to-image technique create label-tosegmentation translation segmentation-to-image translation medical cross modality translations. costa trained fully-convolutional network learn retinal vessel segmentation images. learned translation binary vessel tree retinal image. trained create segmentation images lung ﬁelds heart chest x-ray images. referred networks segmentor critic learned translation brain images brain tumor binary segmentation map. patch-based trained translation brain images corresponding images. suggested auto-context model image reﬁnement. ben-cohen abstract—deep learning methods particular convolutional neural networks enormous breakthrough wide range computer vision tasks primarily using large-scale annotated datasets. however obtaining datasets medical domain remains challenge. paper present methods generating synthetic medical images using recently presented deep learning generative adversarial networks furthermore show generated medical images used synthetic data augmentation improve performance medical image classiﬁcation. novel method demonstrated limited dataset computed tomography images liver lesions ﬁrst exploit architectures synthesizing high quality liver lesion rois. present novel scheme liver lesion classiﬁcation using cnn. finally train using classic data augmentation synthetic data augmentation compare performance. addition explore quality synthesized examples using visualization expert assessment. classiﬁcation performance using classic data augmentation yielded sensitivity speciﬁcity. adding synthetic data augmentation results increased sensitivity speciﬁcity. believe approach synthetic data augmentation generalize medical classiﬁcation applications thus support radiologists’ efforts improve diagnosis. index terms—image synthesis data augmentation convolutional neural networks generative adversarial network deep learning liver lesions lesion classiﬁcation. cope small datasets limited amount annotated samples especially employing supervised machine learning algorithms require labeled data larger training examples. medical imaging tasks annotations made radiologists expert knowledge data task. annotations medical images time consuming. especially true precise annotations segmentations organs lesions multiple slices volumes. although public medical datasets available online grand challenges publicized also introduced cross modality image generation using abdominal image scan image highlights liver lesions. studies inspired method image inpainting. schlegl trained healthy patches retinal area learn data distribution healthy tissue. tested patches unseen healthy anomalous data anomaly detection retinal images. problem limited data medical imaging ﬁeld prompted explore methods synthetic data augmentation enlarge medical datasets. current study focus improving results speciﬁc task liver lesion classiﬁcation. applied framework synthesize high quality liver lesion images liver three common sites metastatic cancer along bone lungs according world health organization alone cancer accounted million deaths worldwide caused liver cancer focal liver lesions malignant manifest metastases benign computed tomography common robust imaging techniques detection diagnosis follow liver lesions thus great need interest developing automated diagnostic tools based images assists radiologists diagnosis liver lesions. previous studies presented methods automatic classiﬁcation focal liver lesions images gletsos used texture features liver lesion classiﬁcation four categories including normal liver parenchyma class. applied hierarchical classiﬁer neural networks level. chang obtained three kind features tumor including texture shape kinetic curve segmented tumors. backward elimination used select best combination features binary logistic regression analysis classify tumors. diamant applied bag-of-visual-words method learned image patches. used dictionaries lesion interior boundary regions. based dictionaries generated histograms lesion roi. ﬁnal classiﬁcation made using svm. current work used deep learning methodology task liver lesion classiﬁcation. deep learning convolutional neural networks emerged powerful tool computer vision. recent years many medical imaging studies applied cnns reported improved performance broad range medical tasks combine synthetic liver lesion generation using proposed liver lesion classiﬁcation. contributions work following synthesis high quality focal liver lesions images using generative adversarial networks design cnn-based solution liver lesion classiﬁcation task comparable results state-ofthe-art methods. section ﬁrst describe data characteristics. elaborate architecture liver lesion classiﬁcation task. main challenge small amount data available training cnn. next section describe methods artiﬁcially enlarge data. dataset used work contains cases liver lesions collected sheba medical center searching medical records cases cysts metastases hemangiomas. cases acquired using scanners general electric healthcare scanner siemens medical system scanner following parameters -mas slice thickness. cases collected approval institution’s institutional review board. figure shows examples input data extraction process. dataset made portalphase scans cysts metastases hemangiomas. expert radiologist marked margin lesion determined corresponding diagnosis established biopsy clinical follow-up. serves ground truth. liver lesions vary considerably shape contrast size also vary within categories. addition located interior sections liver near boundary surrounding parenchyma tissue lesions changes. type lesion characteristics cysts non-enhancing water-attenuation circumscribed lesions. metastases hypoattenuating softtissue attenuation less well-deﬁned margins cysts hemangiomas show typical features discontinuous nodular peripheral enhancement ﬁll-in delayed images despite detailed description characteristics confusing particular metastasis hemangioma lesions metastases contain areas higher density probably prominent blood vessels calciﬁcations mistaken hemangiomas attributes. hemangiomas benign tumors metastases malignant lesions derived different primary cancers. thus correct identiﬁcation lesion metastasis hemangioma especially important. input classiﬁcation system rois lesions cropped scans using radiologist’s annotations. rois extracted capture lesion surrounding tissue relative size. large variability lesion sizes results varying size rois architecture liver lesion classiﬁcation system propose shown figure cnns widely used solving image classiﬁcation tasks computer vision architectures medical imaging also introduced usually containing fewer convolutional layers small datasets smaller input size. classiﬁcation gets ﬁxed size input rois intensity range rescaled architecture consists three pairs convolutional layers convolutional layer followed max-pooling layer dense fullyconnected layers ending soft-max layer determine network predictions classify lesions three classes. relu activation functions. network approx. parameters. addition reducing overﬁtting incorporated dropout layer probability training. training procedure. mean value training images subtracted image cnn. training used batch size learning rate epochs. used stochastic gradient descent optimization nesterov momentum updates instead evaluating gradient current position evaluated lookahead position improves optimization process. main problem training network described lack large labeled training dataset. enlarge training data improve classiﬁcation results liver lesion classiﬁcation task augmented data ways classic augmentation includes varieties known image manipulations given data examples; synthesis examples learned data examples using generative models. start overview standard data augmentation techniques describe method generating synthetic liver lesion images using generative adversarial networks even small thousands parameters need trained. using deep networks multiple layers dealing limited numbers training images danger overﬁtting. standard solution reduce overﬁtting data augmentation artiﬁcially enlarges dataset classic augmentation techniques gray-scale images include mostly afﬁne transformations translation rotation scaling ﬂipping shearing lesion ﬁrst rotated nrot times random angles afterwards rotated ﬂipped times translated ntrans times sampled random pairs pixel values related lesion diameter generator trained maximize equivalently minimize −d). training generator improves ability synthesize realistic images discriminator improves ability distinguish real synthesized images. hence moniker adversarial training. generator architecture generator network takes vector random numbers drawn uniform distribution input outputs liver lesion image size shown figure network architecture consists fully connected layer reshaped size four fractionally-strided convolutional layers up-sample image kernel size. fractionally-strided convolution interpreted expanding pixels inserting zeros them. convolution expanded image result larger output image. batch-normalization applied layer network except output layer. normalizing responses zero mean unit variance entire mini-batch stabilizes learning process prevents generator collapsing samples single point relu activation functions applied layers except output layer uses tanh activation function. discriminator architecture discriminator network typical architecture takes input image size outputs decision lesion real fake? network consists four convolution layers kernel size fully connected layer. min. finally scaled nscale times stochastic range scales scale implemented changing amount tissue around lesion roi. result augmentation process total number augmentations nrot example lesion corresponding augmentations shown figure rois resized uniform size pixels using bicubic interpolation. gans speciﬁc framework generative model. generative model aims implicitly learn data distribution pdata samples generate samples drawn learned distribution. explored variants gans synthesizing labeled lesions shown figure generates labeled examples lesion class separately incorporates class conditioning generate labeled examples once. started ﬁrst variant deep convolutional followed architecture proposed radford networks deep cnns. suggested architectural guidelines stable training modiﬁcations original proposed goodfellow become basis many recent papers model consists neural networks trained simultaneously ﬁrst network termed discriminator denoted role discriminator discriminate real fake samples. inputted sample outputs probability real sample. second network termed generator denoted generator synthesizes samples consider real samples high probability. gets input samples known simple distribution usually uniform distribution maps image space distribution goal achieve pdata. strided convolutions applied convolution layer reduce spatial dimensionality instead using pooling layers. batch-normalization applied layer network except input output layers. leaky relu activation functions applied layers except output layer uses sigmoid function likelihood probability score image. training procedure trained dcgan synthesize liver lesion rois lesion category separately. training process done iteratively generator discriminator. used mini-batches lelesion type sion examples noise samples drawn uniform distribution preprocessing steps used involved scaling training images range tanh activation function leaky relu slope leak leak weights initialized zero-centered normal distribution standard deviation applied stochastic gradient descent adam optimizer adaptive moment estimation incorporates ﬁrst second moments gradients controlled parameters respectively. used learning rate epochs. second variant auxiliary classiﬁer conditional gans extension model enable model conditioned external information improve quality generated samples. architectures incorporate class labels produce labeled samples introduced odena suggested instead feeding discriminator side information discriminator tasked reconstructing side information. done modifying discriminator contain auxiliary decoder network outputs class label addition real fake decision followed architecture proposed minor modiﬁcations synthesizing labeled lesions three types. acgans generator architecture similar dcgans architecture described section iii-b class embedding addition input noise samples. acgan discriminator architecture modiﬁed dcgan kernels size strided convolutions every layer incorporates dropout every layer except last layer. acgan discriminator without modiﬁcations optimizing small dataset. discriminator auxiliary decoder classiﬁed three classes lesions. training procedure training parameters similar ones described iii-b except used learning rate epochs. training inputs included liver lesion rois corresponding labels lesion types noise samples drawn uniform distribution loss function needed modiﬁed incorporate label information. simpliﬁcation write basic following present experiments results. test classiﬁcation results employed architecture described section ii-b. analyzed effects data augmentation using synthetic liver lesions compared classical data augmentation methodology. implemented methods synthetic lesion generation described sections iii-b iii-c. experimentations found deep convolutional method performed better. therefore focus method results presented below. comparison acgan dcgan results presented section iv-e. experiments evaluations used -fold cross validation case separation patient level. number examples fold contained balanced number cyst metastasis hemangioma lesion rois. evaluated classiﬁcation performance using total classiﬁcation accuracy measure. additionally calculated confusion matrices sensitivity speciﬁcity measures lesion category. measures presented following equations implementation liver lesion classiﬁcation used keras framework implementation architectures used tensorflow framework training processes performed using nvidia geforce gpu. original produced large number augmentations resulting augmented images lesion overall examples folder. then selected images data groups sampling randomly augmented examples original lesion sampled augmentation volume. summarize augmentation data group preparation process number samples added fold training process conducted cross-validation -folds training group training examples folds. synthetic data augmentation second step experiment consisted generating synthetic liver lesion rois data augmentation using gan. refer network cnn-aug-gan. took optimal point classic augmentation doptimal used group data train gan. since dataset small effective training incorporated classic augmentation training process. employed dcgan architecture train lesion class separately using -fold cross validation process data partition. generator learned lesion class data distribution separately able synthesize examples using input vector normal distributed samples figure presents examples synthesized liver lesion rois class. approach applied step experiment constructing data groups also applied step collected large numbers synthetic lesions three lesion classes constructed data groups {dsynth} synthetic examples additively. keep classes balanced sampled number synthetic rois class. summarize synthetic augmentation data group preparation process number samples added fold results gan-based synthetic augmentation experiment shown figure baseline results shown red. total accuracy results lesion classiﬁcation task group data. figure presents ﬂowchart experiment conducted evaluate results synthetic data augmentation started examining effects using classic data augmentation liver lesion classiﬁcation task synthesized liver lesion rois using examined classiﬁcation results adding synthesized lesion rois training set. detailed description step provided next. classical data augmentation baseline used classical data augmentation refer network cnn-aug. recorded classiﬁcation results liver lesion classiﬁcation increasing amounts data augmentation training set. trained network evaluated results separately data images original follows {daug} data groups include increasing amounts augmented examples training. testing time used data examples evaluations. order examine effect adding increasing numbers examples formed data groups additively aug. ﬁrst data group made original rois. fig. total accuracy results liver lesion classiﬁcation cysts metastases hemangiomas increase training size. line shows effect adding classic data augmentation blue line shows effect adding synthetic data augmentation. augmentations applied result achieved; overﬁtting small number training examples results improved number training examples increased saturation around adding augmented data examples failed improve classiﬁcation results. note saturation starts samples fold. deﬁne point i=optimal smallest number augmented samples used. confusion matrix optimal point appears table blue line figure shows total accuracy results lesion classiﬁcation task synthetic data augmentation scenario. classiﬁcation results improved synthesized lesions doptimal synth samples fold. confusion matrix best classiﬁcation results using synthetic data augmentation presented table analyze results used t-sne visualization. t-sne algorithm dimensionality reduction enables embedding high-dimensional data dimensional space high-dimensional data visualization features extracted last layer trained liver lesion classiﬁcation cnn. trained scenarios classic augmented data examples synthesized data examples afterwards scenario extract features real images test classic augmentations. used t-sne illustrate features shown figure respectively. note cyst category shown shows distinct localization t-sne space. characteristic correlates well distinctive features cyst class compared metastases hemangiomas. metastases hemangiomas confusing features indicated perceived overlap accounts lower sensitivity speciﬁcity results cyst class. using synthetic data augmentation t-sne visualization exhibited general better separating power. provide intuition increase classiﬁcation performance. human annotators shown evaluate visual quality samples generated gans study interested explore points synthesized lesions appearance realistic one? lesions generated sufﬁciently distinct enable classiﬁcation amongst three lesion categories? issues explored help expert radiologists. created automatic application presented independent radiologists tasks. task classify presented lesion image three classes cyst metastasis hemangioma. second task distinguish real lesion images synthetic lesion images. experts given random order lesion rois original dataset real lesions additional synthesized lesions. algorithm results expert radiologists’ results compared ground truth classiﬁcation. table summarizes experts’ results. note overlow results order identifying whether lesions shown true fake. lesion categorization task expert expert classiﬁed correctly cases respectively. overall radiologists agreed lesion class lesions correct classiﬁcation lesions. addressing results important note task deﬁned consistent existing clinical workﬂow. radiologist trained make decision based entire volume support additional anatomical context medical history context more. here challenged radiologists reach decision based single image. scenario baseline solution similar performance human expert. using gan-based augmentation increase approx achieved. used synthetic augmentations generated using dcgan training classiﬁcation training classiﬁcation synthetic augmentations generated using acgan yield improved results comparison using classic augmentations degraded results comparison dcgan. acgan discriminator contains auxiliary classiﬁer. thus training acgan learned discriminator autonomous component test directly test performance. using method resulted decrease performance. ﬁnal experiment compared classiﬁcation results classic augmentation synthetic augmentation recently published state-of-the-art liver lesion categorization method termed bovw-mi bovw-mi method enhancement bovw model. learns task-driven dictionary relevant visual words task using mutual information measure. order compare approaches using datasets current work bovw-mi method using speciﬁed optimized parameters liver lesion classiﬁcation task found patch size word size coefﬁcient dictionary size words threshold trained bovw-mi -fold cross validation using lesion partitions. table compares sensitivity speciﬁcity results best results bovw-mi results. improve performance classiﬁcation tasks using cnn. relatively small dataset reﬂects size datasets available researchers medical imaging community tested hypothesis adding synthesized examples would improve classiﬁcation results. experimental setup depicted figure experiment carried limited dataset three liver lesion categories cysts metastases hemangiomas. class unique features also considerable intra-variability classes mostly metastases hemangiomas. classiﬁed three categories using architecture. running experiment found increasing size training data groups standard augmentation improved training results certain volume augmented data adding data improve results table shows results optimal point achieved using commonly used classic augmentation. second step experiment used gans generate examples learned small dataset. best generated liver lesion samples produced using deep convolution lesion class separately. starting optimal point classic augmentation reached saturation applied increasing sizes synthetic data. improvement classiﬁcation results total accuracy increase sensitivity speciﬁcity metastasis hemangiomas classes. seems synthetic data samples generated given dataset distribution using additional variability input dataset turn leads better performance. evaluations quality synthesized liver lesions made expert radiologists. although experiment conducted regular radiologist working environment proved challenging task them interest experts classiﬁcation accuracy results real well synthesized lesions indicating validity lesion generation process. study goal assess extent synthesized lesions improve performance another system behind scenes. results show synthesized lesions meaningful visualizations importantly meaningful features incorporated computer tested another generative model incorporated labels training process. gans trained using supervised learning liver lesion class labels. dcgan trained lesion class separately acgan trained three lesion classes once. recent computer vision studies training combines label information improved visualization quality samples gans utilize label information generate samples many classes together. somewhat surprisingly found dataset challenging discriminator network perform tasks resulted poor results comparison dcgan model. using synthetic augmentation generated using acgan able improve results cnn-aug-gan ﬁnal experiment compared performance based system propose work nonnetwork state-of-the-art methods liver lesion classiﬁcation suggested architecture classiﬁcation employs classic augmentation performed bovw-mi method input. using synthetic data augmentation architecture best performance. several limitations work. possible extension could increase input volumes using analysis cnn. trained separate gans lesion class increased training complexity. investigation architectures generate multi-class samples together would worthwhile. quality generated lesion samples could possibly improved incorporating unlabeled data improve learning process analysis modiﬁcations training loss incorporate regularization terms l-norm l-norm investigated well future plan extend work additional medical domains beneﬁt synthesis lesions improved training. conclusion presented method uses generation synthetic medical images data augmentation improve performance medical problem limited data. demonstrated technique liver lesion classiﬁcation task achieved improvement using synthetic augmentation classic augmentation. introduced cnn-based architecture liver lesion classiﬁcation task achieves state-of-the-art results. believe medical problems beneﬁt using synthetic roth seff cherry summers improving computer-aided detection using convolutional neural networks random view aggregation ieee transactions medical imaging vol. greenspan ginneken summers guest editorial deep learning medical imaging overview future promise exciting technique ieee transactions medical imaging vol. tajbakhsh shin gurudu hurst kendall gotway liang convolutional neural networks medical image analysis full training tuning? ieee transactions medical imaging vol. zhou zhang wang stacked deep polynomial network based representation learning tumor classiﬁcation small ultrasound image dataset neurocomputing vol. goodfellow pouget-abadie mirza warde-farley ozair courville bengio generative adversarial nets advances neural information processing systems denton chintala fergus deep generative image models using laplacian pyramid adversarial networks advances neural information processing systems schlegl seeb¨ock waldstein schmidt-erfurth langs unsupervised anomaly detection generative adversarial networks guide marker discovery international conference information processing medical imaging. springer alex chennamsetty krishnamurthi generative adversarial networks brain lesion detection spie medical imaging. international society optics photonics ferlay soerjomataram dikshit eser mathers rebelo parkin forman bray cancer incidence mortality worldwide sources methods major patterns globocan international journal cancer vol. murakami imai okada hyodo w.-j. m.-j. choi ultrasonography computed tomography magnetic resonance imaging hepatocellular carcinoma toward improved treatment decisions oncology vol. suppl. gletsos mougiakakou matsopoulos nikita nikita kelekis computer-aided diagnostic system characterize focal liver lesions design optimization neural network classiﬁer ieee transactions information technology biomedicine vol. sept c.-c. chang h.-h. chen y.-c. chang m.-y. yang c.-m. w.-c. y.-f. k.-l. r.-f. chang computer-aided diagnosis liver tumors computed tomography images computer methods programs biomedicine vol. bilello gokturk desser napel jeffrey beaulieu automatic detection classiﬁcation hypodense hepatic lesions contrast-enhanced venous-phase medical physics vol. mougiakakou valavanis nikita nikita differential diagnosis focal liver lesions using texture features feature selection ensemble driven classiﬁers artiﬁcial intelligence medicine vol. diamant hoogi beaulieu safdari klang amitai greenspan rubin improved patch-based automated liver lesion classiﬁcation separate analysis interior boundary regions ieee journal biomedical health informatics vol. diamant klang amitai konen goldberger greenspan task-driven dictionary learning based mutual inimage classiﬁcation ieee transactions formation medical biomedical engineering vol. june napel beaulieu rodriguez gupta korenblum greenspan rubin automated retrieval images liver lesions basis image similarity method preliminary results radiology vol. shin roth nogues mollura summers deep convolutional neural networks computer-aided detection architectures dataset characteristics transfer learning ieee transactions medical imaging vol. setio ciompi litjens gerke jacobs riel wille naqibullah snchez ginneken pulmonary nodule detection images false positive reduction using multi-view convolutional networks ieee transactions medical imaging vol. ioffe szegedy batch normalization accelerating deep network training reducing internal covariate shift international conference machine learning abadi agarwal barham brevdo chen citro corrado davis dean devin tensorﬂow large-scale machine learning heterogeneous distributed systems arxiv preprint arxiv.", "year": 2018}