{"title": "Learning Flexible and Reusable Locomotion Primitives for a Microrobot", "tag": ["cs.RO", "cs.AI", "cs.LG", "stat.ML"], "abstract": "The design of gaits for robot locomotion can be a daunting process which requires significant expert knowledge and engineering. This process is even more challenging for robots that do not have an accurate physical model, such as compliant or micro-scale robots. Data-driven gait optimization provides an automated alternative to analytical gait design. In this paper, we propose a novel approach to efficiently learn a wide range of locomotion tasks with walking robots. This approach formalizes locomotion as a contextual policy search task to collect data, and subsequently uses that data to learn multi-objective locomotion primitives that can be used for planning. As a proof-of-concept we consider a simulated hexapod modeled after a recently developed microrobot, and we thoroughly evaluate the performance of this microrobot on different tasks and gaits. Our results validate the proposed controller and learning scheme on single and multi-objective locomotion tasks. Moreover, the experimental simulations show that without any prior knowledge about the robot used (e.g., dynamics model), our approach is capable of learning locomotion primitives within 250 trials and subsequently using them to successfully navigate through a maze.", "text": "environments designed simulate dynamics scale generally unequipped usage robotics contexts. additionally working microrobots place severe limitations number iterations trials become much timeconsuming expensive run. microrobot locomotion addressed past much work primarily concerned mechanical design manufacturing microrobots. accomplishing sophisticated locomotion tasks subcentimeter scale remains open area research. analytical implementations various gait behaviors worked microrobots solutions become unwieldy robots higher legged walkers data-driven automatic gait optimization viable alternative analytical gait design optimization using techniques challenging high number trials might necessary perform order learn viable gaits. contributions two-fold validate controllers bayesian optimization microrobots wide range single multi-objective locomotion tasks. introduce novel approach efﬁciently learn gaits motor primitives scratch without need prior knowledge accomplished collecting data various motor primitives using contextual policy search using evaluations reformulate problem multi-objective optimization task providing model parameters predicted trajectory. using model optimize parameters various trajectories subsequent path planning. approach tied exclusively microrobots used walking robot. evaluate approach used simulated hexapod microrobot modeled recently developed microrobot shown figure ﬁrst validate controller microrobot reduce number parameters optimization. then validate bayesian optimization existing techniques curriculum abstract—the design gaits robot locomotion daunting process requires signiﬁcant expert knowledge engineering. process even challenging robots accurate physical model compliant micro-scale robots. data-driven gait optimization provides automated alternative analytical gait design. paper propose novel approach efﬁciently learn wide range locomotion tasks walking robots. approach formalizes locomotion contextual policy search task collect data subsequently uses data learn multi-objective locomotion primitives used planning. proofof-concept consider simulated hexapod modeled recently developed microrobot thoroughly evaluate performance microrobot different tasks gaits. results validate proposed controller learning scheme single multi-objective locomotion tasks. moreover experimental simulations show without prior knowledge robot used approach capable learning locomotion primitives within trials subsequently using successfully navigate maze. towards development fully autonomous microrobots however gait design robot locomotion sub-centimeter scale well-studied problem. completing complicated locomotion tasks like navigating complex environments even challenging. issues become exacerbated dealing legged locomotion even walking straight still active area study normal-sized robots. paper present novel approach autonomous optimization locomotion primitives gaits. locomotion larger-scale robots thoroughly investigated transferring many proven approaches millimeter scale poses many unique challenges. obstacle lack access sufﬁciently accurate simulated models millimeter scale. even simulation paper recommended publication editor upon evaluation associate editor reviewers’ comments. work supported berkeley sensor actuator center berkeley deepdrive. authors department electrical engineering computer sciences university california berkeley {brianhyang grant.wang roberto.calandra dscontreras ksjp}berkeley.edu svlevineeecs.berkeley.edu progressively difﬁcult tasks including learning singleobjective contextual multi-objective gaits. proof concept evaluated approach learning motor primitives trials subsequently using successfully navigate maze. abundance work published design development walking ﬂying millimeterscale microrobots much work focuses hardware considerations design micro-sized joints actuators rather control. knowledge previous work implemented cpg-based controller on-board control walking microrobot learning used locomotion microrobots. hexapod gaits thoroughly studied tested much work easily transfer microrobot drastically different dynamics. hexapods make rotational joints higher walker uses prismatic spring joints resulting less control unique constraints retraction actuation. sufﬁcient simple controllers parameters manually tuning controller parameters require immense amount domain expertise time. such automatic gait optimization important research ﬁeld studied wide variety approaches singleobjective multiobjective setting evolutionary algorithms successfully used train quadrupedal robots approach often requires thousands experiments producing good results unfeasible fragile microrobots. data-efﬁcient approach used learn gaits snake bipedal robots bayesian optimization bayesian optimization applied contextual policy search context robot manipulation contribution builds work applying extending contextual framework learning movement trajectories path planning. another extension bayesian optimization related work multi-objective bayesian optimization also previously applied context robotic locomotion however past work concerned using multi-objective optimization balance trade-off various competing goals. main contribution demonstrates entirely novel application multi-objective optimization learning motor primitives involve trade-off various goals instead uses multi-objective model learn area possible trajectories path planning. introduce hexapod microrobot considered paper. robot particular interest unique challenges arise attempting traditional gait design techniques. micro-scale walker makes challenging obtain accurate dynamics model. moreover based silicon microelectromechanical systems technology. robot’s legs made using linear motors actuating planar pin-joint linkages tethered single-legged walking robot previously demonstrated using technology hexapodal robot assembled using three chips. chips side assemblies granting degree-offreedom legs whole robot. chip acts hold chips together support route signals off-board power control. overall robot measures long wide stands tall overall weight approximately robot’s legs -dof plane fabrication shown figure dofs actuated thus motors actuate vertical lift robot’s body second actuate horizontal vertical stride. actuators used legs electrostatic gap-closing inchworm motors full cycle moves vertically horizontal stride details actuation mechanism used microrobot refer readers experimental simulations used robotics simulator v-rep constructing scaled-up simulated model physical microrobot since vrep designed simulation microrobots mind capable simulating dynamics joints accurately would even complete network amount parameter tuning necessary obtain efﬁcient locomotion. automate parameter tuning bayesian optimization approach often used global optimization black functions formulate tuning parameters optimization parameters optimized w.r.t. objective function choice iteration learns model dataset previously evaluated parameters corresponding objective values measured subsequently learned model used perform virtual optimization acquisition function controls trade-off exploration exploitation. model optimized ﬁnally evaluated resulting parameters real system added dataset together corresponding measurement starting iteration. common model used learning underlying objective consider gaussian processes information regarding refer readers special case optimization task equation multi-objective optimization often times robotics multiple conﬂicting objectives need optimized simultaneously resulting design trade-offs multiple objectives taken consideration longer necessarily single optimum solution rather goal optimization became pareto optimal solutions also takes name pareto front formally parameters dominated parameters said dominate intuitively preferable never performs worse least objective function performs strictly better. however different dominant variables equivalent terms optimality represent different trade-offs. produce wildly unstable models desired scale. chose scale size robot simulation factor order account issues scaling simulation believe re-scaling still allows meaningful results produced several reasons. first experiments performed paper meant demonstrate validity proposed controller learning approach training actual physical microrobot. policies trained meant work real robot without re-tuning modiﬁcation. second simulator still allows test implement microrobot. finally contribution lends credibility potential application bayesian-inspired optimization methods setting evaluations costly time consuming. central pattern generators neural circuits found nearly vertebrates produce periodic outputs without sensory input cpgs also common choice designing gaits robot locomotion chose cpgs controller capable reproducing wide variety different gaits simply manipulating relative coupling phase biases oscillators. allows easily produce variety gait patterns without manually program behaviors. addition cpgs computationally intensive onchip hardware implementations using vlsi fpga. makes well suited eventually used physical microrobot processing power limited. cpgs modeled network coupled non-linear oscillators dynamics network determined differential equations state variable corresponding phase oscillations target frequency oscillations. coupling weights phase biases change oscillators inﬂuence other. implement desired gaits need modify phase biases oscillators φij. state variables amplitude offset oscillator control parameters desired amplitude offset. constants constant positive gains allow control quickly amplitude offset variables modulated. detailed explanation network found crespi’s original work foremost beneﬁts using controller drastic reduction number parameters need optimize. overall parameters consider optimization frequency oscillators experiments wear-and-tear robot. result number evaluations allowed pareto solutions limited. luckily exist extensions address multi-objective optimization. particular multi-objective bayesian optimization algorithm consider parego main intuition parego every iteration multiple objectives randomly scalarized single objective subsequently optimized standard bayesian optimization algorithm information multi-objective bayesian optimization refer reader another special case optimization task equation contextual optimization. contextual optimization assume multiple correlated slightly different tasks want solve identiﬁed context variable example might walking inclined slopes contextual variable angle slope. contextual optimization hence formalized context potentially different param∗ exists. main advantage compared treating eters task independently that contextual optimization exploit correlation tasks generalize result quickly learn solve context. speciﬁcally paper consider contextual bayesian optimization extends classic framework section iv-b. contextual bayesian optimization learns joint model every iteration acquisition function optimized constrained optimization context provided environment. however model jointly model context-parameter space experience learned context generalized similar contexts. utilizing show section microrobot learn walk different environmental contexts walking uphill curving. present novel approach learn motor primitives path planning. approach relies possibility re-using evaluations collected using convert task multi-objective optimization problem. speciﬁcally consider task want optimize parameters reach different target positions objective function case deﬁned euclidean distance figure output vertical-horizontal oscillator pair network corresponds robot. retraction phase motors occurs concurrently rapidly order simulate physical constraints actual physical microrobot. re-use data generated contextual optimization learn motor primitive model form purpose learned model provide estimate ﬁnal displacement obtained parameters independently optimization process generated model learned compute parameters lead desired displacement optimizing parameters w.r.t. output model scalarization function choice equivalent learning continuous function generates motor primitives desired displacement. noted optimization performed model therefore require physical interaction robot. moreover optimize parameters series multiple displacements obtain path planning optimization. section vi-g performing path planning using learned motor primitives employ simple shooting method optimization randomly samples multiple candidate parameters selects best outcome. figure learning curve four gaits gaits learns walk scratch within iterations. optimization dual tripod ripple fastest gaits cm/s cm/s respectively. section discuss controller implementation well performance simulated microrobot various locomotion tasks. code used performing simulation videos various locomotion tasks available online https//sites.google.com/view/ learning-locomotion-primitives. built controller following setup described section iv-a using network coupled phase oscillators order translate output oscillators motor actuation calculate oscillator outputs vertical-horizontal motor pair using piecewise function oscillator outputs respective vertical motor oscillator outputs respective horizontal motor. allows discard parts oscillator output consistent physical constraints physical robot since actual actuators cannot partially retract choose mutually couple vertical oscillators refer reader comprehensive discussion oscillator coupling cpgs. horizontal oscillators also coupled respective vertical oscillator order encapsulate dynamics leg. chose implement four different gaits tripod ripple wave four-two detailed description gaits refer reader frequency phase difference whole network order reduce number parameters speed rate convergence. separate parameters amplitude controlling left right legs respectively. choice parameters allows control turning robot necessary path planning corrections walking straight. optimized four gaits considered using objective function walking speed robot since gaits result curved motions also penalized speed objective term proportional drift axis locomotion. optimization used parameters outlined section iv-a repeated times gaits. figure show median percentiles best solution obtained trials. results show optimizer able learn walk scratch within iterations. moreover noted optimized tripod ripple fastest gaits cm/s cm/s respectively. previous simulation considered walking speed objective. however practical gait design energy efﬁciency another objective great interest particularly comes designing gaits microrobot real energy restrictions. reason consider multi-objective optimization setting compare different gaits w.r.t. walking speed energy consumption. energy consumption robot computed measuring forces exerted motors along axis actuation calculating power used actuate motors. discovering gaits multi-objective optimization addition optimizing four nature-inspired gaits also tested multi-objective optimization walker without constraining using predeﬁned gaits. parametrize oscillator couplings thus discretized gait intervals constant length. within intervals assume steps exactly once keeping oscillators phase other. allows parametrize gaits assigning point interval begins stepping. parametrization excludes certain gaits cannot expressed form leave study sophisticated gait parameterizations gait discovery future works. resulting multi-objective optimization task parameters higher parameter dimensionality training intended on-line training optimization iterations order allow comprehensive exploration optimization space. also repeated optimization times total trials. figure pareto front resulting gaits. found fastest discovered gaits actually able outperform four nature-inspired gaits implemented substantial margin. even penalizing curved paths fastest discovered gait outperformed ripple almost however lowspeed gaits nature inspired gaits out-perform gaits produced unconstrained optimization indicating optimization fully converged optimal consider case contextual optimization speciﬁcally task gait optimization slopes different inclinations. framed learning walk inclined terrain contextual policy search angle inclination context. simulation decided dual tripod gait mostly open parameters previous simulations. used single figure unrestrained gait optimization versus best performance four nature-inspired gaits. faster solutions outperform fastest nature-inspired gaits albeit energy expenditure. however inability optimizer match performance gaits lower speeds within trials shows gait parametrization help limit search space better solutions easier. pattern discovered gaits. since retraction legs spring powered energy input cycle motor extension. hence consider cost extending legs. mass robot time trial held constant quantify energy efﬁciency gait estimate cost transport. optimized four gaits parameters previous optimization time using multi-objective optimization bayesian iterations. figure performance measured pareto fronts obtained different gaits. better compare different gaits also visualized together figure results tripod gait dominates gaits speed cm/s ripple dominates speed cm/s hence giving clear indication gait preferable different circumstances. figure comparison optimization performance contextual optimizer normal optimizer different tasks walking inclines walking curved trajectories. cases contextual optimizer leverage prior simulations obtain high-performing gaits fewer simulations. parameter represent amplitude entire network order keep number parameters addition contextual variable leaving parameters contextual parameter. respect real world constraints testing randomly sampled incline angles continuous interval excessively time-consuming chose training time perform simulations small number inclines degrees. optimizing gaits three inclines iterations studied contextual optimizer able generalize across context space testing performance contextual policy wide range inclines. figure policy performs well intermediary inclines seems smoothly interpolate training inclines desirable. gradual decrease performance inclines steeper attributed increasing physical difﬁculty climbing steeper inclines. also compared using standard train robot untested incline. shown figure contextual optimization able converge optimal performance signiﬁcantly faster standard result demonstrate ability efﬁciently data accumulated previous contexts quickly reach optimize gaits unseen contexts. another useful task framed contextual optimization learning motor primitives walk curved trajectories path planning. used parameters section vi-b contextual parameters case target displacements along axes point origin. order train particular trajectories selected evenly spaced target points along front quadrant ﬁeld vision. since primary objective reach desired destination chose distance ﬁnal position target position sole objective function. found repetitions walker able accurately move turn towards target points within iterations. figure compared performance standard previously unseen target position found that case inclinations contextual policy able learn optimal parameters novel trajectory within iterations. figure comparison performances approach learning motor primitives robot initial position evaluated error desired position reached position. darker color indicates better target accuracy. accurately learned trajectories near training targets generalize well unseen targets. contrast approach comprehensive coverage could leverage better information environment improve generalization. previous simulation learned motor primitives capable walking curved trajectories. model handled trajectories near targets quite well performance trajectories well within physical capabilities robot proximity targets left much desired shown figure demonstrate approach presented section used signiﬁcantly improve movement accuracy well motor primitives used perform path planning. first reused data previous simulation order reformulate task multi-objective optimization described section then used trained model sample trajectories randomly sampling parameter space. trajectories selected smallest expected error subject walking wall. evaluating resulting sequence motor primitives real system demonstrated expected trajectory capable navigating maze shown figure designing controllers locomotion daunting task. paper demonstrated simulated microrobot process signiﬁcantly automated. main contributions two-fold introduced coherent curriculum increasing challenging tasks evaluate controller microrobot using bayesian optimization. presented approach enables walking robots efﬁciently learn motor primitives scratch. using data collected contextual optimization reformulate problem multi-objective optimization task learn model parameters predicted trajectory. model subsequently used path planning. experimental simulation results demonstrate using approach microrobot successfully learn accurate locomotion primitives within trials subsequently navigate maze without prior knowledge environment dynamics. gaits obtained simulated microrobot might yield good results applied real microrobot low-ﬁdelity simulator used. however methodology used obtain realistically applicable real microrobots uniquely able address concerns exist sub-centimeter scale future work plan evaluate approach ﬁndings physical hexapod microrobot. saito iwata ishihara sugita takato uchikoba miniaturized rotary actuators using shape memory alloy insecttype mems microrobot micromachines vol. vogtmann pierre bergbreiter magnetically actuated microrobot walking body lengths/sec ieee international conference micro electro mechanical systems contreras drew pister first steps millimeterscale walking silicon robot international conference solid-state sensors actuators microsystems ieee ambroggi fortuna muscato plif piezo light intelligent ﬂea-new micro-robots controlled self-learning techniques international conference robotics automation vol. kilberg contreras greenspun pister mems aerodynamic control surfaces millimeter-scale rockets international conference manipulation automation robotics small scales tedrake zhang seung stochastic policy gradient reinforcement learning simple biped ieee/rsj international conference intelligent robots systems vol. ieee lizotte wang bowling schuurmans automatic gait optimization gaussian process regression international joint conference artiﬁcial intelligence tesch schneider choset using response surfaces expected improvement optimize snake robot gait parameters international conference intelligent robots systems ieee oliveira costa rocha santos ferreira multiobjective optimization quadruped robot locomotion using genetic algorithm soft computing industrial applications. springer vol. oliveira matos santos costa multi-objective parameter optimization gait generation biped robot ieee international conference robotics automation capi yokota mitobe humanoid robot gait generation based multiobjective optimization ieee/asme international conference advanced intelligent mechatronics tesch schneider choset expensive multiobjective optimization robotics international conference robotics automation contreras pister dynamics electrostatic inchworm motors silicon microrobots international conference manipulation automation robotics small scales robot simulator v-rep http//www.coppeliarobotics.com/ chen zhang survey cpg-inspired control models system implementation ieee transactions neural networks learning systems vol. horses nature vol. pareto manuale economia politica vol. knowles parego hybrid algorithm on-line landscape approximation expensive multiobjective optimization problems ieee transactions evolutionary computation vol. january wagner emmerich deutz ponweiser expectedimprovement criteria model-based multi-objective optimization parallel problem solving nature campos matos santos hexapod locomotion nonlinear dynamical systems approach annual conference ieee industrial electronics society", "year": 2018}