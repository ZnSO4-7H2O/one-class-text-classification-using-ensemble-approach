{"title": "HP-GAN: Probabilistic 3D human motion prediction via GAN", "tag": ["cs.CV", "cs.AI", "cs.HC", "cs.NE"], "abstract": "Predicting and understanding human motion dynamics has many applications, such as motion synthesis, augmented reality, security, and autonomous vehicles. Due to the recent success of generative adversarial networks (GAN), there has been much interest in probabilistic estimation and synthetic data generation using deep neural network architectures and learning algorithms.  We propose a novel sequence-to-sequence model for probabilistic human motion prediction, trained with a modified version of improved Wasserstein generative adversarial networks (WGAN-GP), in which we use a custom loss function designed for human motion prediction. Our model, which we call HP-GAN, learns a probability density function of future human poses conditioned on previous poses. It predicts multiple sequences of possible future human poses, each from the same input sequence but a different vector z drawn from a random distribution. Furthermore, to quantify the quality of the non-deterministic predictions, we simultaneously train a motion-quality-assessment model that learns the probability that a given skeleton sequence is a real human motion.  We test our algorithm on two of the largest skeleton datasets: NTURGB-D and Human3.6M. We train our model on both single and multiple action types. Its predictive power for long-term motion estimation is demonstrated by generating multiple plausible futures of more than 30 frames from just 10 frames of input. We show that most sequences generated from the same input have more than 50\\% probabilities of being judged as a real human sequence. We will release all the code used in this paper to Github.", "text": "predicting understanding human motion dynamics many applications motion synthesis augmented reality security autonomous vehicles. recent success generative adversarial networks much interest probabilistic estimation synthetic data generation using deep neural network architectures learning algorithms. propose novel sequence-to-sequence model probabilistic human motion prediction trained modiﬁed version improved wasserstein generative adversarial networks custom loss function designed human motion prediction. model call hp-gan learns probability density function future human poses conditioned previous poses. predicts multiple sequences possible future human poses input sequence different vector drawn random distribution. furthermore quantify quality non-deterministic predictions simultaneously train motion-quality-assessment model learns probability given skeleton sequence real human motion. test algorithm largest skeleton datasets nturgb-d human.m. train model single multiple action types. predictive power long-term motion estimation demonstrated generating multiple plausible futures frames frames input. show sequences generated input probabilities judged real human sequence. release code used paper github. accurate short-term predictions happen world given past events fundamental useful human ability. aptitude vital daily activities social interactions ultimately survival. example driving requires predicting cars’ pedestrians’ motions order avoid accident; handshaking requires predicting location person’s hand; playing sports requires predicting players’ reactions. order create machine interact seamlessly world needs similar ability understand dynamics human world predict probable futures based learned history immediate present. however future deterministic predicting future cannot deterministic except short term. predictions extend future uncertainty becomes higher. people walking turn fall; people throwing ball drop instead. however predictions plausible others higher probability. paper focus creating model predict multiple plausible future human poses given past. number poses taken immediate past predicted number poses future unrestricted parameters model. accomplish this modiﬁed version improved wasserstein generative adversarial network custom loss function takes consideration human motion human anatomy. generator novel adaptation sequence-tosequence model poses derived recurrent neural network critic discriminator multilayer network critic network train generator discriminator network learn distinguishing real sequence poses fake one. essence combine aspect original wgan-gp. train model actions once output conditioned speciﬁc human action. model takes input sequence previous skeletal poses plus random vector reduced sequence space samples possible future poses. value model generates different output sequence possible future poses. cessfully used machine translation caption generation images video classiﬁcation action recognition action detection video description sequence prediction others. structure learning using gans class unsupervised learning algorithms inspired game theory allow generation futures tied speciﬁc ground truth. among domains used generate impressive realistic images. however gans weaknesses. difﬁcult train unstable learning loss value necessarily indicate quality generated sample training collapse easily. recent literature tries improve training provide theoretical guaranty convergence. work address adding custom loss based skeleton physics addition loss order stabilize improve training. nondeterministic predictions simultaneously train motion-quality-assessment model learns probability given skeleton sequence real human motion. test motion prediction model large datasets captured different modality. ﬁrst nturgb-d dataset largest available rgb-d skeleton-based dataset data captured using microsoft kinect sensor. second human.m dataset largest available datasets derived motion capture data. since introduction kinect sensor much work recognizing human action predicting human poses skeleton data. example predicting human poses conditioned previous poses using deep rnns part availability large human motion datasets general human motion prediction categorized categories probabilistic deterministic prediction. probabilistic motion prediction work probabilistic human motion prediction uses non-deep learning approaches authors propose simple markov models model observed data proposed model action recognition task completion. limitation approach predicts motion single action only assumes human motion satisﬁes markov assumption. authors introduce gaussian process dynamical models model human pose motion. however train model action separately constrain model gaussian process. authors human motion dimensional space coordinates index binary tree predicts next pose thus casting prediction problem search problem. however approach generalize previously unseen motions. authors switching linear dynamic systems learned bayesian network author used conditional random ﬁelds model spatio-temporal dynamics. recent human motion prediction relies deep rnns deep neutral networks primarily deterministic. authors deterministic probabilistic human motion predictions. deterministic aspect based modiﬁed called recurrentdecoder adds fully connected layers lstm layer minimizes euclidean loss. probabilistic aspect uses gaussian mixture model mixture components minimizes negative log-likelihood. aspects predict single future human pose time. predict more recurrently feed single predicted pose back input. drawback approach error drifting prediction error current pose propagate next pose. contrast predict multiple human poses thus avoiding error drifting. addition impose statistical model constrains like motions. authors develop general framework converts structure graph called structurernn test framework different problem sets including human motion prediction show outperforms current state art. however need design structure graph manually taskspeciﬁcally. authors examine recent deep methods human motion prediction show achieve start-of-the-art results simpler model proposing three simple changes rnn. authors encoder-decoder network based feed-forward network compare results three different architectures symmetric time-scale hierarchical. human motion two-fold. future deterministic previous poses could lead multiple possible poses. using norm cause model average possible futures resulting blurred motions. non-human motion prediction prediction multiple possible futures using rnns precedents. authors lstm generate text handwriting input sequence. generate item time sampling resultant probability. then append predicted item input sequence remove ﬁrst item iterate. creates sequence desired length method eventually create input lstm contain original input. contrast pursue method trains model generate entire desired output sequence poses once. prediction single multiple possible futures using gans also precedents. authors trained convolution model generator discriminator order predict future frames. improved predictions adding image gradient difference loss adversary loss. however predict single possible future convolution network model predict ﬁxed length output. contrast support variable length input variable length output also generate multiple possible futures input. authors predict imagine multiple frames single image. generate afﬁne transformations frame apply original input image produce prediction. although imagine multiple futures input image single image sufﬁcient capture temporal dynamics scene. furthermore makes oversimpliﬁed assumption change images captured using afﬁne transform. human motion quality assessment compared amount work motion editing synthesis computer graphics research automatic motion quality evaluation received little attention existing techniques typically designed special types motions motions obtained software used edit character motion novel aspect motion quality assessment model trained simultaneously together motion prediction model. input poses sequence predicted poses corresponds single pose represented joint locations joint angles. goal learn probability future sequence conditioned input sequence shown figure prediction model modiﬁed version sequence-to-sequence network. takes input sequence human poses plus vector drawn uniform gaussian distribution drawn value mapped space output states encoder. simply mapped value encoder states result initial state decoder. shown ﬁgure layer encoder feed last output encoder ﬁrst input decoder. sequence-to-sequence network also tried lstm notice quality difference. network shown ﬁgure network parameters need learn. drawn value sample different valid future poses given input recent human pose predictions using deep rnns treat human motion prediction regression problem. however solving human motion prediction using regression suffers deﬁciencies. first learns outcome time predicted sequence length increases outcome becomes less probable. second using usual loss creates artifacts predicting average possible outcomes. believe better learn multiple possible future poses input poses. particular modiﬁed version improved wgangp tailored sequence prediction order train generative adversarial networks introduced unsupervised learning technique inspired minimax theorem generator network discriminator network outdo other. training alternates networks. original paper generator learns generate images close real images discriminator learns distinguish generated image real image dataset. steady state discriminator predict image generator network generated probability. however original algorithm stable difﬁcult train jensen-shannon divergence loss function. result zero inﬁnity ratio probabilities might overlap initially lead vanishing gradients discriminator network. wgan replaces distance earth mover distance deﬁned continuous almost everywhere. according author mitigates need carefully maintain balance training discriminator versus generator. discriminator wgan output probability discriminate synthetic input real input author renamed discriminator network critic network. nevertheless wgan address concerns since critic still must maintain lipschitz constraint. order author clips weights network adversely affects quality generator. address this wgan-gp algorithm replaces weight clipping generator added penalty loss critic based computed norm gradient respect critic input. able verify improvements domain human poses extensive experimentation. therefore adversarial training scheme three reasons. first allows generation multiple futures single past. second allows generator trained without explicitly using ground truth real futures. third implicitly learns cost function prediction based data. figure shows high level diagram proposed network called hp-gan human pose prediction. hp-gan combines features wgan-gp sequence-speciﬁc optimization order generate realistic human motion sequence figure hp-gan human prediction gan. diagram shows critic switching back forth generator critic training. output generator prior poses concatenated critic discriminator. similarly ground truth concatenation prior future poses. discriminator learn distinguish real fake sequences human motion. update generator wgan-gp loss addition consistency loss bone loss. generator block shown figure sequence-to-sequence network deﬁned figure described earlier takes input previous poses vector produces sequence human poses. vector -dimensional ﬂoat vector drawn uniform gaussian probability distribution. future poses generator loss three components. ﬁrst standard wgan-gp adversary loss. second consistency loss pose gradient loss measures delta consecutive poses. third bone loss measures delta bone length predicted skeleton ground truth. reason consistency loss bone loss that valid human motion change joint locations consecutive frames small bone lengths remain same. effect critical training. large effect loss becomes high obtain less variety future predictions; cases even obtain identical predictions regardless input value. conversely found critical train large dataset like classes nturgb-d; prior poses future poses concatenated together form real pose sequence. similarly prior poses generated poses concatenated together form fake pose sequence. real fake sequences used critic wgan-gp loss discriminator loss. wgan-gp loss used improve critic network generator network alternating critic loss generator loss whereas discriminator loss used train discriminator network. main purpose discriminator network measure quality generated human poses; involved training generator. critic network three-layer fully connected feedforward network outputs single value. value unbounded used wgan-gp loss. wgan-gp loss loss train generator produce realistic human pose additional losses wgan-gp loss. ﬁrst consistency pose gradient loss focuses smoothing sequence predicted poses. second loss bone loss focuses reducing changes bone lengths predicted skeleton ground truth. details losses described below. discriminator network also three-layer fully connected feedforward network outputs single value. however output probability value means input sequence real means input sequence fake. primarily goal discriminator network measure quality predicted future sequence generator. probability resulting discriminator used improve generator order keep training generator wgan-gp loss stability avoidance model collapse. small subset like classes value becomes critical avoiding motion discontinuities ﬁrst predicted human pose. furthermore make sure loss reach zero minimum value loss follow max∇typ) hyper parameter reason avoid pushing consecutive human poses match exactly. discriminator judge quality predicted skeleton poses decide stop training. discriminator loss loss used exception generator loss training. deﬁned training algorithm closely follow training methods. inside training loop iterate times critic network time generator discriminator network. tried different iteration values tried dynamically update iteration count based losses critic generator none methods made noticeable improvement. order make discriminator training procedure stable reduced learning rate half compared critic generator learning rate. three networks adam learning rate critic generator network half discriminator network. verify model capability multiple experiments largest human motion datasets microsoft kinect dataset nturgb-d motion capture dataset human.m human poses nturgb-d dataset based skeleton data kinect perfect shown ﬁgure problems occlusions people carrying objects interacting another person. however even noisy skeletons model generalizes well dataset. nturgb-d action recognition dataset consists actions action comes corresponding video depth sequence skeletal data infrared video. skeleton data. contain locations major body joints frame deﬁned microsoft kinect api. nturgb-d action classes different subjects action recorded three kinects different viewpoints. human.m contains million human poses corresponding images captured vicon mocap system. skeletons joints. actions performed professional actors covering action classes. using code read human.m skeleton data converted angle representation absolute joint positions. datasets trained model directly absolute joint locations. model point cloud training data model learns relationships joints order predict valid human pose. difﬁcult training angle less degrees freedom. train directly joint positions order pipeline ntu-rgb-d human.m datasets generic model. preprocessing normalized values joint range subtracted center gravity. nturgb-d dataset normalized joint range using dimensions kinect frustum maximum meter depth. human.m dataset obtained range data ﬁrst ﬁnding minimum maximum values dimension computing minimum maximum values dimensions. human.m dataset fewer clips nturgb-d dataset however clip much longer. order pipeline datasets split human.m clips shorter segments every frame training. main problems gans loss provide indication quality generated data. according authors wgan wgangp improvements wgan made original loss value fact provide quality measure. human motion prediction problem loss provides indication much generated sequence looks like valid human pose. however observed strictly monotonic; smaller loss always indicate better quality. therefore usefully measure quality added discriminator network whose sole purpose learn probability given sequence valid human motion. best model inside training loop generate predictions compute probability evaluating discriminator predictions. then compute number predictions probability keep track model maximum training start tracking best model certain number epochs order give discriminator chance learn discriminate real fake human motion. figure shows result training hp-gan classes nturgb-d dataset. ground truth subsequent corresponds predicted human poses different value drawn uniform distribution. left blue line input sequences. shown ﬁgure value generates separate possible future sequence human poses. ﬁrst predicted poses close ground truth expected. predict poses start differ ground truth. results consistency loss important smaller datasets training subset actions. discontinuity last input pose ﬁrst predicted pose. ﬁgure plot loss values function number epochs critic generator discriminator losses. even though generator loss continues improving difﬁcult compute best parameters either generator loss critic loss without visual inspection graphs. discriminator loss provides stable signal. training human.m dataset requires different adjustments training nturgb-d dataset. example bone loss important human.m dataset ntu-rgb-d dataset. since nturgb-d skeletons generated kinect bone lengths poses subject match exactly. also human.m actions slower nturgb-d actions little variation poses predictions even different values. mitigate this every frame. figure shows results human.m dataset. generated human poses smooth especially train subset actions. figure shows discontinuity last pose input ﬁrst pose prediction. mitigated increasing figure shows predictions throw action nturgb-d dataset corresponding estimated probabilities discriminator network. ground truth shows probability being valid human sequence subsequent correspond different value. discriminator probability output always accurate especially start training. tried discriminator addition figure training classes nturgb-d dataset predicting poses input poses. ground truth subsequent corresponds random value drawn uniform distribution. poses left blue line input sequences. pose right blue line starting second predicted future poses value. probability given skeleton sequence real human motion. tested architecture different datasets based kinect sensor based mocap data. experiments show model performs well datasets. however using wgan-gp improvements added still good tell training converged. even worse training diverge already converged continue training loop. therefore future work plan explore better mechanism measure model convergence ensure stability. another area research understanding semantic space vector. compute reverse mapping sequences might able values action classiﬁcation clustering. furthermore hp-gan generates dataset original source area exploration hp-gan data augmentation order increase diversity action. lastly used standard sequence-tosequence network investigate architecture might provide better human pose prediction skip connection part-aware lstm something else another area plan investigate future. developed novel sequence-to-sequence model probabilistic human motion prediction predicts multiple plausible future human poses input. knowledge ﬁrst deep neural networks probabilistic motion predictions. quantify quality non-deterministic predictions simultaneously trained motion-quality-assessment model learns", "year": 2017}