{"title": "Deep Spatio-Temporal Residual Networks for Citywide Crowd Flows  Prediction", "tag": ["cs.AI", "cs.LG"], "abstract": "Forecasting the flow of crowds is of great importance to traffic management and public safety, yet a very challenging task affected by many complex factors, such as inter-region traffic, events and weather. In this paper, we propose a deep-learning-based approach, called ST-ResNet, to collectively forecast the in-flow and out-flow of crowds in each and every region through a city. We design an end-to-end structure of ST-ResNet based on unique properties of spatio-temporal data. More specifically, we employ the framework of the residual neural networks to model the temporal closeness, period, and trend properties of the crowd traffic, respectively. For each property, we design a branch of residual convolutional units, each of which models the spatial properties of the crowd traffic. ST-ResNet learns to dynamically aggregate the output of the three residual neural networks based on data, assigning different weights to different branches and regions. The aggregation is further combined with external factors, such as weather and day of the week, to predict the final traffic of crowds in each and every region. We evaluate ST-ResNet based on two types of crowd flows in Beijing and NYC, finding that its performance exceeds six well-know methods.", "text": "places given time interval. outﬂow denotes total trafﬁc crowds leaving region places given time interval. ﬂows track transition crowds regions. knowing beneﬁcial risk assessment trafﬁc management. inﬂow/outﬂow measured number pedestrians number cars driven nearby roads number people traveling public transportation systems together data available. figure presents example. mobile phone signals measure number pedestrians showing inﬂow outﬂow respectively. similarly using trajectories vehicles types ﬂows respectively. simultaneously forecasting inﬂow outﬂow crowds region city however challenging affected following three complex factors spatial dependencies. inﬂow region affected outﬂows nearby regions well distant regions. likewise outﬂow would affect inﬂows regions inﬂow region would affect outﬂow well. temporal dependencies. crowds region affected recent time intervals near far. instance trafﬁc congestion occurring affect addition trafﬁc conditions morning rush hours similar consecutive workdays repeating every hours. furthermore morning rush hours gradually happen later winter comes. temperature gradually drops rises later people later later. forecasting crowds great importance trafﬁc management public safety challenging affected many complex factors inter-region trafﬁc events weather. propose deep-learning-based approach called st-resnet collectively forecast inﬂow outﬂow crowds every region city. design end-to-end structure st-resnet based unique properties spatio-temporal data. speciﬁcally employ residual neural network framework model temporal closeness period trend properties crowd trafﬁc. property design branch residual convolutional units models spatial properties crowd trafﬁc. st-resnet learns dynamically aggregate output three residual neural networks based data assigning different weights different branches regions. aggregation combined external factors weather week predict ﬁnal trafﬁc crowds every region. experiments types crowd ﬂows beijing york city demonstrate proposed st-resnet outperforms well-known methods. predicting crowd ﬂows city great importance trafﬁc management public safety instance massive crowds people streamed strip region year’s celebrations shanghai resulting catastrophic stampede killed people. mid-july hundreds pokemon players york city’s central park hopes catching particularly rare digital monster leading dangerous stampede there. predict crowd region tragedies mitigated prevented utilizing emergency mechanisms conducting trafﬁc control sending warnings evacuating people advance. paper predict types crowd ﬂows inﬂow outﬂow shown figure inﬂow total trafﬁc crowds entering region ∗this research supported nsfc association advancement artiﬁcial intelligence rights reserved. trajectory geospatial coordinate; means point lies within grid vice versa; denotes cardinality set. time interval inﬂow outﬂow regions denoted tensor r×i×j xinij inﬂow matrix shown figure formally dynamical system spatial region represented grid types ﬂows grid time. thus observation time represented tensor r×i×j. problem given historical observations {xt|t predict deep residual learning deep residual learning allows convolution neural networks super deep structure layers even over- layers. method shown state-ofthe-art results multiple challenging recognition tasks including image classiﬁcation object detection segmentation localization input output residual unit respectively; residual function e.g. stack convolution layers central idea residual learning learn additive residual function respect tackle challenges propose deep spatiotemporal residual network collectively predict inﬂow outﬂow crowds every region. contributions four-fold st-resnet employs convolution-based residual networks model nearby distant spatial dependencies regions city ensuring model’s prediction accuracy comprised deep structure neural network. summarize temporal properties crowd ﬂows three categories consisting temporal closeness period trend. st-resnet uses three residual networks model properties respectively. st-resnet dynamically aggregates output three aforementioned networks assigning different weights different branches regions. aggregation combined external factors evaluate approach using beijing taxicabs’ trajectories meteorological data bike trajectory data. results demonstrate advantages approach compared baselines. formulation crowd flows problem deﬁnition many deﬁnitions location terms different granularities semantic meanings. study partition city grid based longitude latitude grid denotes region shown figure closeness period trend external inﬂuence respectively. illustrated top-right part figure ﬁrst turn inﬂow outﬂow throughout city time interval -channel image-like matrix respectively using approach introduced deﬁnitions divide time axis three fragments denoting recent time near history distant history. -channel matrices intervals time fragment ﬁrst three components separately model aforementioned three temporal properties closeness period trend respectively. ﬁrst three components share network structure convolutional neural network followed residual unit sequence. structure captures spatial dependency nearby distant regions. external component manually extract features external datasets weather conditions events feeding two-layer fully-connected neural network. outputs ﬁrst three components fused xres based parameter matrices assign different weights results different components different regions. xres integrated output external component xext. finally aggregation mapped tanh function yields faster convergence standard logistic function process back-propagation learning structures first three components ﬁrst three components share network structure composed sub-components convolution residual unit shown figure convolution. city usually large size containing many regions different distances. intuitively crowds nearby regions affect other effectively handled convolutional neural network shown powerful ability hierarchically capture spatial structural information addition subway systems highways connect locations distance leading dependency distant regions. order capture spatial dependency region need design many layers convolution accounts spatial near dependencies limited size kernels. problem also found video sequence generating task input output resolution several methods introduced avoid loss resolution brought subsampling preserving distant dependencies different classical subsampling convolutions shown figure three multiple levels feature maps connected convolutions. node high-level feature depends nine nodes middle-level feature depend nodes lower-level feature means convolution naturally captures spatial near dependencies stack convolutions capture distant even citywide dependencies. closeness component figure adopts channel ﬂows matrices intervals recent time model temporal closeness dependence. recent fragment xt−] also known closeness dependent sequence. ﬁrst concatenate along ﬁrst axis tenc rlc×i×j followed convolution denotes convolution; activation function e.g. rectiﬁer learnable parameters ﬁrst layer. residual unit. well-known fact deep convolutional networks compromise training effectiveness though well-known activation function regularization techniques applied hand still need deep network capture large citywide dependencies. typical crowd ﬂows data assume input size kernel size convolution ﬁxed want model citywide dependencies needs consecutive convolutional layers. address issue employ residual learning model demonstrated effective training super deep neural networks over- layers. residual function includes learnable parameters residual unit. also attempt batch normalization make input output size convolutional operator employ border-mode allows ﬁlter outside border input padding area outside border zero. likewise using operations construct period trend components figure assume time intervals period fragment period therefore period dependent sequence ·p··· xt−p]. convolutional operation residual units like eqs. output period component meanwhile output trend component input ·q··· xt−q] length trend dependent sequence trend span. note actually different types periods. detailed implementation equal one-day describes daily periodicity equal one-week reveals weekly trend. trafﬁc ﬂows affected many complex external factors weather event. figure shows crowd ﬂows holidays signiﬁcantly different ﬂows normal days. figure shows heavy rain sharply reduces crowd ﬂows ofﬁce area compared latter week. feature vector represents external factors predicted time interval implementation mainly consider weather holiday event metadata details introduced table predict ﬂows time interval holiday event metadata directly obtained. however weather future time interval unknown. instead forecasting weather time interval approximate weather time interval formally stack fully-connected layers upon ﬁrst layer viewed embedding layer sub-factor followed activation. second layer used high dimensions shape output external component figure denoted xext parameters θext. fusion section discuss fuse four components figure ﬁrst fuse ﬁrst three components parametric-matrix-based fusion method further combined external component. figures show ratio curves using beijing trajectory data presented table x-axis time time intervals y-axis average ratio value arbitrary inﬂows time gap. curves different regions show empirical temporal correlation time series namely inﬂows recent time intervals relevant ones distant time intervals implies temporal closeness. curves different shapes demonstrates different regions different characteristics closeness. figures depict inﬂows time intervals days. obvious daily periodicity regions. ofﬁce area peak values weekdays much higher ones weekends. residential area similar peak values weekdays weekends. figures describe inﬂows certain time interval tuesday march june time goes inﬂow progressively decreases ofﬁce area increases residential area. shows different trends different regions. summary inﬂows regions affected closeness period trend degrees inﬂuence different. also properties regions well outﬂows. different regions affected closeness period trend degrees inﬂuence different. inspired observations propose parametric-matrix-based fusion method. parametric-matrix-based fusion. fuse ﬁrst three components figure follows xres wc◦x hadamard product learnable parameters adjust degrees affected closeness period trend respectively. algorithm optimization algorithm outlines st-resnet training process. ﬁrst construct training instances original sequence data then st-resnet trained backpropagation adam settings datasets. different sets data shown table dataset contains sub-datasets trajectories weather detailed follows. taxibj trajectoriy data taxicab data meteorology data beijing four time intervals jul. otc. mar. jun. mar. jun. nov. apr. using deﬁnition obtain types crowd ﬂows. choose data last four weeks testing data data training data. bikenyc trajectory data taken bike system apr. sept. trip data includes trip duration starting ending station start times. among data last days chosen testing data others training data. baselines. compare st-resnet following baselines predict inﬂow outﬂow crowds average value historical inﬂow outﬂow corresponding periods e.g. am-am tuesday corresponding periods historical time intervals historical tuesdays. sarima seasonal arima. vector auto-regressive advanced spatio-temporal model capture pairwise relationships among ﬂows heavy computational costs large number parameters. deepst deep neural network -based prediction model spatio-temporal data shows state-of-the-art results crowd ﬂows prediction. variants including deepst-c deepstcp deepst-cpt deepst-cptm focus different temporal dependencies external factors. preprocessing. output st-resnet tanh ﬁnal activation whose range here min-max normalization method scale data range evaluation re-scale predicted value back normal values compared groundtruth. external factors onehot coding transform metadata holidays weather conditions binary internal structure residual unit attempt three different types residual units. adopts standard residual unit compared residual unit l-single-e contains relu followed convolution residual unit l-e-bn added batch normalization layers inserted relu. observe l-single-e worse l-e-bn best demonstrating effectiveness batch normalization. external factors considers external factors including meteorology data holiday events metadata. model degraded results indicate better pointing external factors always beneﬁcial. parametric-matrix-based fusion different l-e-nofusion donot parametric-matrixbased fusion instead l-e-nofusion straightforward method fusing shows error greatly increases demonstrates effectiveness proposed parametric-matrix-based fusion. results bikenyc table shows results model baselines bikenyc. different taxibj bikenyc consists different types crowd ﬂows including newﬂow end-ﬂow here adopt total -residual-unit st-resnet consider metadata external features like deepst st-resnet relatively lower rmse baselines demonstrating proposed model good generalization performance prediction tasks. crowd flow prediction. previously published works predicting individual’s movement based location history mainly forecast millions even billions individuals’ mobility traces rather aggregated crowd ﬂows region. task require huge computational resources always necessary application vectors min-max normalization scale temperature wind speed range hyperparameters. python libraries including theano keras used build models. convolutions conv residual units ﬁlters size conv uses convolution ﬁlters size batch size select training data training model remaining chosen validation used early-stop training algorithm model based best validation score. afterwards continue train model full training data ﬁxed number epochs extra hyperparamers st-resnet empirically ﬁxed one-day one-week respectively. lengths three dependent sequences evaluation metric measure method root mean square error results taxibj ﬁrst give comparison models taxibj shown table give variants st-resnet different layers different factors. taking example considers available external factors residual units comprised convolutional layers. observe models better baselines. comparing previous stateof-the-art models l-e-bn reduces error signiﬁcantly improves accuracy. effects different components. compared model. number residual units results show rmse decreases number residual units increases. using residual learning deeper network accurate results scenario public safety. researchers predict travel speed trafﬁc volume road predicting single multiple road segments rather citywide ones. recently researchers started focus city-scale trafﬁc prediction work different proposed methods naturally focus individual region city partition city using grid-based method needs complex method irregular regions ﬁrst. deep learning. cnns successfully applied various problems especially ﬁeld computer vision residual learning allows networks super deep structure. recurrent neural networks used successfully sequence learning tasks incorporation long short-term memory enables rnns learn longterm temporal dependency. however kinds neural networks capture spatial temporal dependencies. recently researchers combined networks proposed convolutional lstm network learns spatial temporal dependencies simultaneously. network cannot model long-range temporal dependencies training becomes difﬁcult depth increases. previous work general prediction model based dnns proposed spatiotemporal data. paper model speciﬁc spatiotemporal prediction effectively mainly propose employing residual learning parametric-matrix-based fusion mechanism. survey data fusion methodologies found propose novel deep-learning-based model forecasting crowds every region city based historical trajectory data weather events. evaluate model types crowd ﬂows beijing achieving performances signiﬁcantly beyond baseline methods conﬁrming model better applicable crowd prediction. code datasets released https//www.microsoft.com/enus/research/publication/deep-spatio-temporal-residualnetworks-for-citywide-crowd-ﬂows-prediction.", "year": 2016}