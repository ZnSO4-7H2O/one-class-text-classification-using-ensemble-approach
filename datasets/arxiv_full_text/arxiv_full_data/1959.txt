{"title": "An Ensemble-based System for Microaneurysm Detection and Diabetic  Retinopathy Grading", "tag": ["cs.CV", "cs.AI", "stat.AP", "stat.ML"], "abstract": "Reliable microaneurysm detection in digital fundus images is still an open issue in medical image processing. We propose an ensemble-based framework to improve microaneurysm detection. Unlike the well-known approach of considering the output of multiple classifiers, we propose a combination of internal components of microaneurysm detectors, namely preprocessing methods and candidate extractors. We have evaluated our approach for microaneurysm detection in an online competition, where this algorithm is currently ranked as first and also on two other databases. Since microaneurysm detection is decisive in diabetic retinopathy grading, we also tested the proposed method for this task on the publicly available Messidor database, where a promising AUC 0.90 with 0.01 uncertainty is achieved in a 'DR/non-DR'-type classification based on the presence or absence of the microaneurysms.", "text": "candidates. well-known ensemble techniques would require classiﬁcation pixel misleading context since different algorithms extract different approaches centers coincide exactly. overcome difﬁculty gather close candidates individual detectors apply voting scheme them. fusion results several detectors lead increased average sensitivity measured seven predeﬁned false positive rates. paper propose framework build detector ensembles based combination internal components detectors output earlier research combining detectors provide reassuring results increase accuracy ensembles must identify weak points detection. ﬁrst difﬁculty originates shape characteristics mas. appear small circular dark spots surface retina hard distinguish fragments vascular system certain features. detectors tackle problem following ﬁrst green channel fundus image extracted preprocessed enhance like characteristics. then coarse level step ma-like objects detected image. finally level algorithm removes potentially false detections based assumptions mas. former investigations showed sensitivity detectors originates candidate extractor part however could increase sensitivity applying proper preprocessing methods candidate extraction. technique causes slight increment number false positives decreased classiﬁcation voting. paper propose effective microaneurysm detector based combination preprocessing methods candidate extractors. provide ensemble creation framework select best combination. exhaustive quantitative analysis also given prove superiority approach individual algorithms. also investigate grading performance method proven competitive screening systems. rest paper organized follows selected preprocessing methods candidate extractors presented section respectively. details proposed ensemble creation framework discussed section present evaluation methodology section section summarize experimental results. detailed discusabstract—reliable microaneurysm detection digital fundus images still open issue medical image processing. propose ensemble-based framework improve microaneurysm detection. unlike well-known approach considering output multiple classiﬁers propose combination internal components microaneurysm detectors namely preprocessing methods candidate extractors. evaluated approach microaneurysm detection online competition algorithm currently ranked ﬁrst also databases. since microaneurysm detection decisive diabetic retinopathy grading also tested proposed method task publicly available messidor database promising uncertainty achieved ’dr/non-dr’-type classiﬁcation based presence absence microaneurysms. originates diabetes mellitus common cause blindness developed countries. early treatment prevent patients become affected condition least progression slowed down. thus mass screening patients suffering diabetes highly desired manual grading slow resource demanding. therefore several efforts made establish reliable computer-aided screening systems based color fundus images promising results reported fleming jelinek indicates automatic screening systems getting closer used clinical settings. feature recognize detect microaneurysms fundus eye. importance handling two-fold. first normally earliest sign hence timely precise detection essential. hand grading performance computer-aided screening systems highly depends detection paper propose microaneurysm detector provides remarkable results aspects. ensure high reliability raise accuracy detector consider ensemble-based systems proven efﬁcient several ﬁelds. however usual ensemble techniques combine class labels real values cannot adopted case. detection detectors provide spatial coordinates centers potential b´alint antal andr´as hajdu university debrecen faculty informatics debrecen hungary. e-mail {antal.balint hajdu.andras}inf.unideb.hu. corresponding author b´alint antal. phone investigate effect processing images complete vessel system removed based idea proposed extrapolate missing parts holes caused removal using inpainting algorithm presented appearing near vessels become easily detectable way. candidate extraction process aims spot objects image showing ma-like characteristics. individual detectors consider different principles extract candidates. section provide brief overview candidate extractors involved analysis. again preprocessing methods adding candidate extractors lead improvement future. summary differences candidate extractor algorithms performance measured training dataset shown table candidate extraction accomplished grayscale diameter closing. method aims sufﬁciently small dark patterns green channel. finally double threshold applied. selected preprocessing methods consider applied executing candidate extraction. selection preprocessing method candidate extractor components framework challenging task. comparison preprocessing methods dedicated microaneurysm detection published yet. since preprocessing methods need highly interchangeable must select algorithms used candidate extractor change characteristics original images also found techniques generate noisy images detection adaptive histogram equalization color normalization thus selected methods well-known medical image processing preserve image characteristics. naturally proposed system improved future adding methods. summary differences algorithms given table contrast limited adaptive histogram equalization popular technique biomedical image processing since effective making usually interesting salient parts visible. image split disjoint regions region local histogram equalization applied. then boundaries regions eliminated bilinear interpolation. input fundus image vascular extracted applying twelve morphological transformations twelve rotated linear structuring elements then vascular subtracted input image followed application gaussian matched ﬁlter. resulting image binarized ﬁxed threshold. since extracted candidates precise representations actual lesions region growing step also applied them. original paper written detect ﬂuorescein angiographic images implementation based modiﬁed version published fleming following idea presented established approach based detection small circular spots image. candidates obtained detecting circles images using circular hough transformation. technique circular objects extracted image. order extract candidates method constructs maximal correlation response image input retinal image. accomplished considering maximal correlation coefﬁcient gaussian masks different standard deviations pixel. maximal correlation response image thresholded ﬁxed threshold value obtain candidates. vessel detection region growing applied reduce number candidates determine precise size respectively. pixel-wise cross-section proﬁles multiple orientations used construct multi-directional height map. assigns height values describe distinction pixel surroundings particular direction. modiﬁed multilevel attribute opening step score constructed extracted thresholding. meaning preprocessing method candidate extractor pair ﬁrst apply preprocessing method input image apply candidate extractor result. pair extract candidates original image. ensemble contain preprocessing method candidate extractor pairs outputs fused following candidate candidates participants collected whose euclidean distance smaller predeﬁned constant denote points collected candidate then centroid calculated ensemble creation process ensembles ensemble pool evaluated best performing ebest regarding evaluation function training selected. evaluate ensemble output candidate must compared ground truth following exists point ground truth whose euclidean distance smaller predeﬁned constant considered true positive. otherwise false positive ground truth point false negative close candidate selection optimal ensemble ebest would require possible preprocessing method candidate extractor ensembles evaluated optimal one. however currently consider preprocessing methods candidate extractors experiments. preprocessing method candidate extractor pairs number possible combinations form ensemble. would resource-demanding evaluate large number combinations used simulated annealing search algorithm ﬁnal ensemble proven effective large search spaces. however describe selection procedure exhaustive search latter parts since better evaluate conﬁgurations enough resources available several choices search algorithms possible. energy function used competition performance metric deﬁned average sensitivity level seven predeﬁned false positive image rate process ensemble creation also shown figure ensemble creation part results preprocessing method candidate extractor pairs. ensemble ebest used detect unknown images. ﬁnal ensemble applied real detection training phase. namely ﬁnal detected fusion candidates individual pairs building ensemble ebest. similarly every detected conﬁdence value described above. thus ﬁnal decision presence output needs thresholded according assigned conﬁdence values. choice threshold value discussed section detail. evaluated detection capabilities proposed method competition detectors well publicly available private database. section provide brief overview databases methodology used evaluation detection performance proposed approach. retinopathy online challenge worldwide competition dedicated measure accuracy microaneurysm detectors. database consists training test images different resolutions jpeg compression. average number training test sets respectively. images training test sets marked experts. diaretdb database diaretdb database contains losslessly compressed training test images resolution fov. average number training test sets respectively. images training test sets marked experts. private database provided moorﬁelds hospital database consists losslessly compressed images resolution fov. average number training test sets respectively. images training test sets respectively marked experts. testing database provide freeresponse receiver operating characteristic curves plots sensitivity average number false positives image. measure sensitivity different average false positive image levels thresholded output detector based conﬁdence values assigned candidate. dataset also provide current ranking competition along values serves basis ranking. addition also calculated partial algorithms range normalizing average false positive image ﬁgure dividing maximum applying trapezoidal integration. empirical calculated likely underestimate true auc. however uncertainty partial aucs quite high number images. also evaluated ensemble-based approach grading performance recognize determined image-level classiﬁcation rate ensemble messidor dataset containing images. presence means image contains signs absence indicates healthy case. words pure yes/no decision system tested. ensemble creation training provided messidor database used independent dataset train algorithm. note that quite strong handicap comparison usual approach train part database. however feel much closer measure true performance system real circumstances. testing used publicly available messidor database testing. database consists losslessly compressed images different resolutions image grading score ranging provided. grades correspond following clinical conditions patient grade mild severe cases non-proliferative retinopathy respectively. finally evaluation classiﬁed retinal images whether contain signs detector classiﬁes image diseased least detected healthy otherwise. measured sensitivity speciﬁcity accuracy detector different levels thresholding conﬁdence values assigned candidates described section using following formulas also measured percentage correctly recognized cases grade. provided ﬁtted receiver operating characteristic curve along empirical ﬁtted proposed method messidor database. curve ﬁtting used jrocfit table exhibit preprocessing method candidate extractor pairs included selected ensembles three datasets respectively. rows table show preprocessing methods section columns label candidate extractor algorithms listed section iii. table contains ranked quantitative results participants competition proposed ensemble highlighted current leader. performance ensemble also shown figure terms froc curve. table proposed ensemble earned higher score higher partial individual algorithms. table provide sensitivity speciﬁcity accuracy measures detector corresponding different threshold values respectively. ﬁtted curve detector seen figure empirical area curve ﬁtted curve table also contains percentage correctly recognized cases class. experimental results show proposed ensemblebased detector outperforms current individual approaches detection. also proven framework high ﬂexibility different datasets. seen table ensemble members vary suggests relatively high variance among databases ﬁeld. despite variability performance ensemble still remained stable. authors measured human expert average false positive rate dataset consensus three human experts. level approximately image database level ensemble achieved best score competition. thus recommend level thresholding ensemble creation phase detecting unknown images. grading ensemble also performed well. also important different classes recognized different levels. desired severity affects performance detector. threshold level sensitivity less severe case recognized higher probability. selection appropriate threshold also important issue detector provide sufﬁcient sensitivity speciﬁcity rate. authors suggest sensitivity important screening system speciﬁcity. opposition british diabetic association recommends sensitivity speciﬁcity screening table accurate result achieved threshold value applying ﬁrst idea might consider results corresponding threshold value best experiment sensitivity speciﬁcity achieved. recognized almost cases present half healthy ones. closest second recommendation performance achieved level sensitivity speciﬁcity. difﬁcult compare method screening systems. first best knowledge results reported complete messidor database. screening systems tested private images. unfortunately proportion non-dr/dr cases varying experiments. abramoff reported population cases least minimum signs databases agurto tested cases contained signs achieved aucs respectively. closest match requirements system jelinek sensitivity speciﬁcity approximately patients similar proportion strong point proposed method performs well difﬁcult circumstances. figure shows example image application clahe made easier distinguish background. however vessel removal inpainting preprocessing method caused missing true detection remaining easier absence thin retinal vessels. thus using different preprocessing methods candidate extractors creates diversity among members ensemble desired systems using multiple estimators diversity ensures suppression false detections since diverse detectors tend make different mistakes. thus false detections likely receive lower conﬁdence values voting procedure. despite promising results system still misclassiﬁes stage serious case present. improve grading performance must take account presence absence dr-speciﬁc lesions essential clinical setting. however detector serve main component system. paper proposed ensemble-based microaneurysm detector proved high efﬁciency open online challenge ﬁrst position. novel framework relies preprocessing method candidate extractor pairs search algorithm selects optimal combination. since approach modular expect improvements adding preprocessing methods candidate extractors. also evaluated grading performance detector images messidor database. achieved value competitive previously reported results databases. grading results presented paper already promising. however proper screening system contain components expected increase performance approach well. work supported part j´anos bolyai grant hungarian academy sciences tech project drscreen developing computer based image processing system diabetic retinopathy screening national ofﬁce research technology hungary abramoff niemeijer suttorp-schulten viergever russel ginneken evaluation system automatic detection diabetic retinopathy color fundus photographs large population patients diabetes diabetes care vol. fleming goatman philip prescott sharp olson automated grading diabetic retinopathy largescale audit using arbitration clinical experts british journal ophthalmology vol. jelinek cree worsley luckie nixon automated microaneurysm detector tool identiﬁcation diabetic retinopathy rural optometric practice. clin optom vol. antal lazar hajdu torok csutak peto multi-level ensemble-based system detecting microaneurysms fundus images ieee international workshop soft computing applications antal hajdu improving microaneurysm detection using optimally selected subset candidate extractors preprocessing methods pattern recognition vol. youssif ghalwash ghoneim comparative study contrast enhancement illumination equalization methods retinal vasculature segmentation proc. cairo international biomedical engineering conferemce niemeijer ginneken cree mizutani quellec sanchez zhang hornero lamard muramatsu cazuguel mayo hatanaka cochener roux karray garcia fujita abramoff retinopathy online challenge automatic detection microaneurysms digital color fundus photographs ieee transactions medical imaging vol. spencer olson mchardy sharp forrester image-processing strategy segmentation quantiﬁcation microaneurysms ﬂuorescein angiograms ocular fundus computers biomedical research vol. fleming philip goatman automated microaneurysm detection using local contrast normalization local vessel detection ieee transactions medical imaging vol. kauppi kalesnykiene j.-k. kmrinen lensu sorri raninen voutilainen uusitalo klviinen pietil diaretdb diabetic retinopathy database evaluation protocol proc. conf. medical image understanding analysis agurto barriga murray nemeth crammer bauman zamora pattichis soliz automatic detection diabetic retinopathy age-related macular degeneration digital fundus images investigative ophthalmology visual science vol.", "year": 2014}