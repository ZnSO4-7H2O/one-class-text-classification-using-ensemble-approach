{"title": "Automatic construction of Chinese herbal prescription from tongue image  via CNNs and auxiliary latent therapy topics", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "The tongue image is an important physical information of human, it is of great importance to the diagnosis and treatment in clinical medicine. Herbal prescriptions are simple, noninvasive and low side effects, and are widely applied in China. Researches on automatic construction technology of herbal prescription based on tongue image have great significance for deep learning to explore the relevance from tongue image to herbal prescription, and can be applied to healthcare services in mobile medical system. In order to adapt to the tongue image in a variety of photographing environments and construct the herbal prescriptions, a neural network framework for prescriptions construction is designed, which includes single / double convolution channels and fully connected layers, and propose the mechanism of auxiliary therapy topic loss to model the therapy of Chinese doctors then alleviate the interference of sparse output labels to the diversity of results. The experimental data include the patient tongue images and their corresponding prescriptions from real world outpatient clinic, and the experiment results can generate the prescriptions that are close to the real samples, which verifies the feasibility of the proposed method for automatic construction of herbal prescription from tongue image. Also, provides a reference for automatic herbal prescription construction from more physical information (or integrated body information).", "text": "abstract—the tongue image provides important physical information humans. great importance diagnoses treatments clinical medicine. herbal prescriptions simple noninvasive side effects. thus widely applied china. studies automatic construction technology herbal pre-scriptions based tongue images great significance deep learning explore relevance tongue images herbal prescriptions applied healthcare services mobile medical systems. order adapt tongue image vari-ety photographic environments construct herbal prescrip-tions neural network framework prescription construction designed. includes single/double convolution channels fully connected layers. furthermore proposes auxiliary therapy topic loss mechanism model therapy chinese doctors alleviate interference sparse output la-bels diversity results. experiment real world tongue images corresponding prescriptions results generate prescriptions close real samples verifies feasibility proposed method automatic construction herbal prescriptions tongue images. also provides reference automatic herbal prescription construc-tion physical information. hina vast increasing population. making full medical resources meet needs patients always urgent concern healthcare informatics especially rapid development mobile medical services help immobile mobile people obtain cheap high-quality medical services china herbal prescriptions contain side effects provide simple cheap natural noninvasive treatment health preservation option tongue image po-tentially important body sign clinical diagnosis treat-ment. therefore already extensive studies collection processing analysis tongue images assist diagnosis treatment. zhang integrated color texture geo-metric features tongue images detect diabetes mellitus nonproliferative diabetic retinopathy combined color texture geometric features tongue image facial parts sublingual information detect diabetes early glycemia however previous studies usually require professional tongue image acquisition device lack robustness requirements camera shooting angle illumination conditions conducive expanding mobile terminals. therefore research feature coding low-quality tongue images auxiliary construction herbal prescriptions research significance application value. zhang school computer science engineering south china university technology guangzhou china. e-mail scutwenoutlook.com phone changjun wang guangdong general hospital guangzhou china. phone deep learning based neural networks widely applied medical informatics especially medical image processing recent years. covers medical image preprocessing medical image classification directions provides great technical support auxiliary diagnoses treatments. tang encoded multiscale medical image features using sparse autoencoders different receptive field sizes generated feature maps classification using convolution op-eration zhang enhanced multi-scale feature ensembles utilization efficiency integrated im-proved attention mechanism read images generate diagnostic reports also artificial intelligence plays important role medi-cine recommendations clinical prescription decision support hoang used social media in-formation source mine sequences drugs adverse effects signal detrimental prescription cascades long described accurate computationally efficient scalable algorithm construct medication history timeline in-form clinical decision making pioneered knowledge graph integrated terms da-ta-bases resources. provides services vis-ualization knowledge retrieval recommendations; thus system great significance studies medical clinical decision support china best knowledge work using tongue images construct herbal prescription. order robustly model tongue images patients various photographic environments accurately excavate association tongue information herbal prescriptions following main work carried paper. neural framework single/double convolution channels multiple fully connected layers applied encode tongue features generate herbal prescription considering restrictive effect extremely sparse output labels diversity generated prescriptions auxiliary loss latent therapy topics proposed improve precision stimulate diversity prescription construction. conduct experiments verify convolution network tongue feature encoding herbal prescription construction. compare effects single/double channel models auxiliary topic loss mechanism accuracy completeness diversity prescription construction. rest paper organized follows. section detail materials methods. sections illustrate analyse discusses results prescription construction models. conclude paper section patients’ tongue images manually taken volunteers photographed outpatient departments cooperating hospital. shooting tools ordinary digital cameras smart phones universal image quality. handwritten chinese herbal prescriptions also taken volunteers entered database profes-sionals. prescription doses temporarily masked names herbs kept. matrices color channel deep convolutional network used extract latent features original image matrix multi-layer convolutional structure defined convolutional channel. convolutional channel constructed several duplicate modules include convolutional maxpooling layers. convolution operation parameterized kernel weight matrices uses kernel filters scan image matrices reconstruct feature maps convolution operations convolutional channels abstracted following functions relu activation functions many circumstances chinese doctors directly prescribe herbs based rich experience sometimes still need draw support diagnosis patient's condition guide direction prescription. based consideration auxiliary convolutional channel added prescription construction model. used simulate diagnosis process provide information construction herbal prescriptions. architecture neural prescription construction model shown fig. consists convolutional channels encoding layers. outputs last layer sampled herb dictionary threshold obtain final pre\"\" accounts vast majority output labels suppress confidence neural network produce diverse correct herbs. moreover besides real prescriptions ground truth auxiliary ground truths needed help network framework model therapies. considering prescription obvious context regarded textual model based words. latent dirichlet allocation model classical topic modeling approach based words successfully applied modeling prescriptions fig. architecture neural prescription construction -output model tongue image inputs equipped auxiliary ground truth prescription topics distribution. kullback–leibler divergence used measure therapy distributions generated prescriptions real prescriptions. also therapy distribution divergence real prescription follows topic distribution ground truths prescriptions joined optimize weights auxiliary convolutional channel. help double-output neural network better model doctors’ therapies shown fig. loss function double-output network integrated loss auxiliary main outputs used regulate proportion auxcoefficient iliary loss. then union final image data generator used data augmenta-tion tongue images randomly copy trans-form original tongue images. iteration image generator randomly selects images original images. randomly transforms returns training set. augmented images keep original labels. order concurrently ensure image quality data diver-sity restrictive parameters image augmentation table shows. preprocessing tongue images corresponding prescriptions includes following steps. enable models process directly captured tongue images perform slight cut-to-correct low-quality tongue images. normalization names herbs. herb retains unique appellation others re-moved. real-world tongues-prescriptions experiment dataset collected volunteers contains tongue images corresponding prescriptions. since tongue images prescriptions precious pseudo -fold cross-validation used experiment. specifically samples randomly selected time test others construct training selected test sets contain samples other. training augmented image generator described section iteration image gener-ator randomly transforms original images returns training set. repeating operation times augmented tongue images. experiment also examine effectiveness prescription construction ability bi-convolutional channels auxiliary therapy topics image augmentation. brief introductions comparison methods follows -cnns neural prescription construction model contains convolutional channel fully connected encoding layers. also sigmoid function used output layer. -cnns aux_lda based model cnns therapies modeled introducing auxiliary ground truths prescription topics auxiliary convolution channel optimized. fig. validation losses model w.r.t. training epochs without data augmentation -cnns mlp; -cnns mlp; cnns aux_lda. line represents main loss green line represents total loss. shadow indicates confidence field validation loss blue shadow indicates range training epochs reach least validation loss. fig. validation losses model w.r.t. training epochs data augmentation -cnns mlp; -cnns mlp; cnns aux_lda. line represents main loss green line represents total loss. shadow indicates confidence field validation loss blue shadow indicates range training epochs reach least validation loss. order take account performance model consumption computing resources parameters neural prescription construction models experience many experimental iterations. main parameters listed table fig. comparative examples topic distributions various models’ prescription construction results cnns without data augmentation; -cnns aux_lda data augmentation. green dots represent generated real samples respectively. sometimes three metrics cannot perfectly evaluate performance prescription construction. additional metrics taken account used indicate completeness prescription exactitude therapies. follows figs. show trend validation losses regard training process neural prescription construction models. fig. variations min-values validation losses different models close. however training process data augmentation obtain relatively lower validation loss model -cnns aux_lda model obtains lowest validation loss regardless whether data augmentation used. particular optimal performance negative log-likelihood cnns aux_lda model without data augmentation close -cnns model using data augmentation. green lines part fig. fig. show fairly similar trend validation loss indicates integration negative log-likelihood prescriptions auxiliary loss therapy topics. therefore learning objective auxiliary output consistent generation prescription promote optimization prescription construction models. blue shadows figs. show training model converge round. wider shadow reveals greater fluctuation convergence time -fold experiments convergence time training data augmentation generally stable. moreover training processes withdata augmentation -cnns aux_lda model stable. another note confidence field model reveals training cnns aux_lda model smaller undulations cases. fig. appendix shows complete topic distributions -fold experiments neural prescription construction models. convenient observation fig. illustrates comparative examples therapy topic distributions -cnns without data augmentation cnns aux_lda data augmentation models. figure clearly exhibits differences therapy distributions ordinary result optimal result. therapy topic distribution real samples shows concentration. means frequently-used herbs real prescriptions prescriptions composed seldom-used herbs sparsely distributed marginal area. cnns without data augmentation model topic distribution generated samples partially real samples concentrated reveals generated prescriptions frequent common herbs. moreover part results gathered marginal regions real samples outlier real samples fitted. contrast -cnns aux_lda data augmentation model although topic distribution generated samples still little concentrated real samples appears quite homogeneous well fitting regardless whether concentrated area real samples slightly sparse area. even vicinity outlier real samples still generated samples them. therefore diversity generated samples reflected closer real prescription samples. shown table performances neural prescription construction models better rfbaseline shows result collapse metric data augmentation used performance -cnns -cnns -cnns aux_lda models increasing. improvement -cnns aux_lda model metrics obvious performance even better -cnns model data augmentation. data augmentation used performances various models generally enhanced increased training samples. note aux_lda mechanism significant effect model’s performance improvement -cnns aux_lda data augmentation model achieves best performance main metrics. conditions part main metrics cannot well reflect model's prescription construction ability well. example coincidental correct herbs generated prescription lead false high many herbs generated prescription output labels inhibit confidence prescription construction model prefer prescribe less herbs rather take risk prescribing wrong herb. contrast size prescription produced -cnns aux_lda data augmentation model closest real. furthermore aux_lda mechanism encourages models prescribe herbs also effectively improve number correct herbs described section topic distributions prescriptions -cnns aux_lda model also acquire better performance metric regardless data augmentation. tables vividly illustrate prescription construction results various models experiment. seen -cnns model accurately prescribe herbs -cnns model. furthermore -cnns aux_lda model accurately prescribe less-common herbs even wrong herbs occasionally prescribed sculellaria barbata semen zizyphi spinosae interestingly wrong herbs prescribed -cnns aux_lda model similar benefits missing correct herbs like baked licorice liquorice using auxiliary therapy topic output mechanism hyper-parameters affect results prescription construction. optimal hyper-parameters obtained experimental iterations. fig. shows shown part fig. auxiliary loss rate ideal values best average performance recorded value thus large small value auxiliary loss rate lead diminished experimental results. small value weaken role aux_lda mechanism almost vanishes excessive value disrupt main loss prescription construction. part fig. shows impacts number topics experiment results. case values model better results case aux_lda reach peak performance topic number then incorrect number topics worsen performance model compared neural prescription construction models like -cnns without data augmentation. indicates auxiliary therapy loss topic number disrupt optimization process -cnns aux_lda model respect main loss. tongue images provide important bodily information serve important basis clinical diagnosis treatment. paper neural network models used model relationship tongue images chinese herbal prescriptions. then automatically construct herbal prescriptions. that verified validity experiments. however tongue image basis doctor make diagnosis treatment. reasonable believe integrating body sign information improve model double convolution channel improve precision prescription construction auxiliary therapy topic output mechanism improve precision diversity generated prescription. although experiment paper used dataset chinese patients' tongue images chinese herbal prescriptions proposed model easily extended datasets application scenarios. paper attempts apply neural network models fulfill automatic construction chinese herbal prescriptions. improve accuracy diversity prescription construction double convolutional channel frame applied auxiliary therapy topic output mechanism proposed. then abilities proposed models verified experiments automatic construction chinese herbal prescriptions. future work plan following. collect data verify improve performance proposed models larger richer datasets. absorb medicine transcendental knowledge ontology guide neural prescription construction models. invite experienced chinese doctors provide professional artificial score generated prescription would introduce online reinforcement learning mechanism basic system. fig. topic distributions various models’ prescription construction results -fold experiments. green dots represent generated real samples respectively. mean models -cnns -cnns -cnns aux_lda models data augmentation. authors grateful constructive advice received anonymous reviewers paper. work supported china national science foundation grants science technology planning projects guangdong province guangzhou science technology planning project authors grateful hard work data chen xiao telehealth attitudes among medical professionals medical students patients china cross-sectional survey international journal medical informatics wang aotf based hyperspectral tongue imaging system applications computer-aided tongue disease diagnosis. biomedical engineering in-formatics zhang kumar zhang detecting diabetes mellitus nonproliferative diabetic retinopathy using tongue color texture geometry features. ieee transactions biomedical engineering liang chen integrative data analysis multiplatform cancer data multimodal deep learning approach. ieee/acm transactions computational bi-ology bioinformatics greenspan ginneken summers guest editorial deep learning medical imaging overview future promise exciting technique. ieee transactions medical imaging zhang shen detecting anatomical landmarks limited medical imaging data using two-stage task-oriented deep neural networks. ieee transactions image processing iglesias galvez avila immunological approach full nurbs reconstruction outline curves noisy data points medical imaging. ieee/acm transactions computational biology bioinformatics shin roth deep convolutional neural networks computer-aided detection architectures dataset characteristics transfer learning. ieee trans-actions medical imaging zhang xing mdnet semantically vis-ually interpretable medical image diagnosis network. //international conference computer vision pat-tern recognition arxiv preprint. early diagnosis alzheimer's disease based resting-state brain networks deep learn-ing. ieee/acm transactions computational biology bioinformatics guan chen detection recognition life state cell cancer using two-stage cascade cnns. ieee/acm transactions computational biology bio-informatics zhang discovering treatment pattern traditional chinese medicine clinical cases exploiting supervised topic model domain knowledge. journal biomedical informatics breiman random forests. machine learning mairal bach ponce online dictionary learning sparse coding. international conference machine learning abadi agarwal barham tensorflow large-scale machine learning heterogeneous distribut-ed systems. arxiv distributed parallel cluster computing", "year": 2018}