{"title": "On the Choice of Regions for Generalized Belief Propagation", "tag": ["cs.AI", "cs.LG"], "abstract": "Generalized belief propagation (GBP) has proven to be a promising technique for approximate inference tasks in AI and machine learning. However, the choice of a good set of clusters to be used in GBP has remained more of an art then a science until this day. This paper proposes a sequential approach to adding new clusters of nodes and their interactions (i.e. \"regions\") to the approximation. We first review and analyze the recently introduced region graphs and find that three kinds of operations (\"split\", \"merge\" and \"death\") leave the free energy and (under some conditions) the fixed points of GBP invariant. This leads to the notion of \"weakly irreducible\" regions as the natural candidates to be added to the approximation. Computational complexity of the GBP algorithm is controlled by restricting attention to regions with small \"region-width\". Combining the above with an efficient (i.e. local in the graph) measure to predict the improved accuracy of GBP leads to the sequential \"region pursuit\" algorithm for adding new regions bottom-up to the region graph. Experiments show that this algorithm can indeed perform close to optimally.", "text": "generalized belief propagation proven promising technique approximate inference tasks machine learning. however choice good clusters used remained science day. paper proposes sequential approach adding clusters nodes interactions approximation. ﬁrst review analyze recently introduced region graphs three kinds operations leave free energy ﬁxed points invariant. leads notion weakly irreducible regions natural candidates added approximation. computational complexity algorithm controlled restricting attention regions small region-width. combining eﬃcient measure predict improved accuracy leads sequential region pursuit algorithm adding regions bottom-up region graph. experiments show algorithm indeed perform close optimally. many exciting applications emerged recent years ranging vision operation research decision making communication game theory learning error-correcting-decoding. despite favorable properties silver bullet. highly connected graphs strong conﬂicting interactions produce accurate converge alternatives searching solutions developed relatively slow converge shortcomings resulted many interesting improvements plain vanilla algorithm. instance convex lower bound free energy expectation propagation continuous valued random variables exponential family generalized algorithm improves accuracy including entropy larger clusters approximation concerning latter noted choice clusters nodes interactions algorithm science. handpicked regions form suboptimal leading inaccuracies ineﬃciencies best. paper formulate answer question good regions algorithm? propose sequential process regions selected large pool candidates added approximation. belief propagation growing family variants thereof established recent years viable alternative traditional approaches approximate inference graphical models. like mean ﬁeld methods likely exhibit certain bias estimates. however unlike sampling schemes suﬀer high variance often much eﬃcient. result variable nodes factor graph corresponding random variables {xi} similarly factor nodes corresponding potential functions {ψa} subset variables denoted factor graphs condition ensures marginal distributions deﬁned regions computed consistent. condition variables makes sure over-count degrees freedom associated random variable guarantees case vanishing interactions retain exact results. condition factors ensures factor contributes approximation. edges associated messages algorithm. possible execute algorithm follows. initialize messages randomly message update region child region ﬁrst compute marginal distributions follows regions consist parents parents descendants except parents contained dec. equation used compute terms marginals message update given following equation convergence used compute ﬁnal estimates marginal distributions. chosen present equations particular form compactness transparency eﬃcient implement instance makes explicit fact messages enforce constraint convergence need recompute marginals every iteration. depending speciﬁc structure graph consideration eﬃcient update schemes exists terms messages terms messages marginals latter stored equations becomes apparent messages potentials fulﬁll similar roles. fact interpret potentials messages never change alternatively interpret messages dynamic potentials. thus could view messages subsets nodes eﬀective induced interactions variables subset. bi-partite neighbors factor precisely variables contained factor neighbors variable node precisely factors contain variable. following often shorthand variables argument factor expression probability distribution corresponding factor graph given region graphs introduced natural graphical representation algorithms deﬁne region variables together subset factors contain subset variables thus although insist fact factors contain variables necessarily include factors region graph directed acyclic graph vertices corresponding regions. directed edges exist regions direct subregions direct subregion deﬁned region contains subset nodes factors present parent region region parent region directed edge conversely said child ancestors descendants also deﬁned usual region said ancestor region exists directed path conversely said descendant case. outer regions deﬁned regions parents i.e. without incoming edges inner regions remaining regions parents. ancestor regions region given deﬁnition counting numbers deﬁne region graph conditions subgraphs consisting regions containing variable factor must connected satisfy could violated node factor would present outer regions rα∪β rα∪β since possible. next show free energy outer region remains unchanged split. fact separates clusters implies decompose belief pα∪β pα∪β results frα∪β frα∪β expression free energy regions. finally need show counting numbers regions remain unchanged. first note ancestor non-descendants region change regions observe become descendants rα∪β rα∪β {rα∪β rα∪β rβ}. true since children connected least three regions descendant implies descendant rα∪β rα∪β well since parents regions become descendants rα∪β rα∪β must contained must also descendants since connected direct sub-regions dec. facts fact counting numbers depend total counting number region’s ancestors prove claim. reason region potentially larger smallest conditioning-set possibility child regions cease subregions either rα∪δ rα∪δ resulting change expression entropy. thus need choose large enough ensure fact. cannot expect regions incoming arrows reducible always message joint function nodes region. example assume outer region union disjoint sub-regions i.e. intersection empty case simply split region pieces without changing ﬁxed points gbp. example pointless variables outer region factor accompanying them. proposition merge consider identical regions parent assume descendants contained descendants dec\\rβ dec. then region based free energy change following operation merge regions region family exhibits certain redundancy sense diﬀerent corresponding diﬀerent message passing algorithms support solutions gbp. simple example redundancy given below reason invariance addition links distant descendants change ancestor sets thus none counting numbers. implies still hold free energy remains invariant results show ﬁxed points alter. following present number elaborate operations leave free energy invariant later related ﬁxed points gbp. proposition split consider outer region deﬁne partitioning variables factors region three sub-sets s.t. variables separate assume furthermore choose large enough variable factor nodes child regions {rγ} contained either rα∪β rα∪β. then free energy change following operation split region subregions rα∪β rα∪β child region remove edges emanating connect direct subregions connect regions rα∪β rα∪β remaining childnodes {rγ} receive connections regions rα∪β rα∪β and/or become subregions existing regions become children redirect incoming outgoing edges proof ﬁrst note condition cannot violated regions merged. next check condition deﬁne ancestors region excluding anc. free energy contributions change rule assign counting numbers regions depend regions downstream. free energy regions merge given deﬁned canc total counting number ancestors region equal expression clearly equal free energy merged region. finally need show true descendants dec). using note counting numbers depend total counting number upstream region. shown total counting number regions total counting number merged region together fact ancestor doesn’t change proves claim. merge operation allows simplify graph results split operation described above. instance child region already exists child region dec\\rβ merge regions. proposition death consider region counting number then free energy change following operation remove incoming outgoing edges connect parents children proof condition violated since ancestors descendants region remain connected removal counting numbers ancestors change eq.. free energy change removal. counting numbers descendants depend total counting number ancestors. however change ancestors region removed counting number implying counting numbers remain unchanged thus corollary invariance consider sequence split merge and/or death operations resulting contain copies regions regions counting number ﬁxed points algorithm corresponding regions graphs ﬁxed points. proof connecting ﬁxed points stationary points valid copies without regions however also noted algorithm well deﬁned presence regions. true copies avoid making claims cases lack proof. however alternative algorithms directly minimize free energy algorithms clearly claim solution space unaltered split merge death moves introduced above. deﬁnition outer region deﬁned weakly irreducible cannot split smaller regions sequence split merge death moves without introducing child regions. region cannot split smaller pieces even introduction child regions allowed call strongly irreducible. example consider outer region consisting nodes edges form cycle edges denote pairwise interactions. it’s children regions containing pairs nodes interaction each. region clearly weakly irreducible. however split cycle triangles intersection child. thus cycle reducible strong sense. applying operations repeatedly outer regions able simplify original improve computational eﬃciency. extreme case this deﬁne region contains factors variables. resulting sequence split merge death operations correspond exact algorithm. example decomposable models reduced layer corresponding junction trees cliques outer regions separators second layer. special case trees conclusion previous section different outer regions nevertheless result exactly ﬁxed points gbp. allows somewhat organize search promising candidate regions added limit consideration simple building blocks take weakly irreducible regions. although acknowledge choice number reasons chosen allowing further reduction weakly irreducible smaller building blocks cause certain diﬃculties. instance introduce copies guarantees accompanying algorithm also decompose region subregions triangulate children remain sub-regions region. many ways triangulate would result messy protocol. unfortunately even weakly irreducible building blocks leaves large number candidates consider need organize search. achieved taking complexity corresponding algorithm consideration. bottleneck calculation marginalization operation thus resulting messages joint functions variables child regions implies corresponding algorithm scales exponentially number. however also note often exploit structure outer regions compute messages don’t necessarily represent full joint distributions variables outer regions. leads deﬁne width region deﬁnition region-width region tree-width induced graph every variable vertex variables arguments factors variables arguments child regions form cliques number vanishes implying removed using death move. computational complexity sending message dominated marginalizing problem equivalent inference problem factors incoming messages form cliques induced graph. incoming messages joint functions variables child regions subsets thereof computational complexity inference problem precisely governed tree-width induced graph deﬁned above. observations suggest specify computational complexity willing spend terms maximal allowed region-width hand. general procedure determining weakly irreducible regions region-width smaller equal pre-speciﬁed value probably intractable. instead could heuristic select promising weakly irreducible candidate regions remove regions consideration large regionwidth. paper propose build sequentially bottom-up’ instead usual topdown strategies described since incorporating regions change approximation need make sure resulting still valid. following lemma conditions true lemma consider valid sub-graphs consist regions containing factor consist regions containing variable factors variables sub-graphs contain exactly leaf node adding outer region connecting direct sub-regions recomputing counting numbers according result valid proof since child must sub-region parent sub-graph rg\\rleaf must ancestor rleaf counting number rleaf exactly rα∈anc) implies total counting number precisely reasoning valid implies still holds true trivial check also still true. remain valid outer regions called extendable hereafter. corresponding bethe approximation simplest extendable fact suggests bethe approximation base approximation build complex adding outer regions. next assume using considerations previous sections list candidate regions evaluated inclusion since don’t access exact marginal distributions need approximate measure predicts improvement approximation including candidate. moreover measure cheap evaluate since need compute every candidate region. make progress ﬁrst make following assumption assumption accord intuition treating larger clusters nodes jointly approximation improve accuracy cost increased computational complexity. however means true circumstances. instance regime strong interactions adding larger clusters deteriorate approximation rather improve also counting numbers become large happen densely connected graphs approximation typically poor guarantees adding regions helpful. thus assumption make operate regime expected give good results improved adding larger regions. assumption want region induces maximal change marginal distributions free energy assume closely correlated. ﬁgure compare absolute changes marginals free energy entropy loop size varying strengths interactions incoming messages. order evaluate proposed measure still require iterate convergence candidate region wish consider. clearly quite expensive computationally leads following assumption intuition behind assumption counting numbers descendants region change counting numbers remaining nodes remain ﬁxed. free energy contribution aﬀected change marginal distribution. another seeing assume mofigure impact changing interaction strength strength external messages error free energy entropy marginal distributions region loop size binary states interactions edges sampled log-domain gaussian std. std. messages nodes also randomly sampled log-domain gaussian std. std. results averaged random instantiations. error entropy free energy correlates well marginals except origin. vanishing error accidental symmetry ﬂipping states equal free energy implying ment messages converged. entering region need compute messages region children send messages children etc. leafs reached. point marginal distributions descendants become consistent region. next stage propagate changes rest graph back-reaction region descendants etc. propose thus ignore back-reaction keep messages region descendants frozen compute change free energy. important eﬀect change computed locally graph thus save computation. following denote local change free energy experiments verify approximation reasonable. combine considerations previous sections region pursuit algorithm example consider factor graph pairwise interactions take bethe free energy base approximation. thus starting point factors pairs variables layer single variables bottom layer. candidate regions results section conclude strip away treelike structures attached single node region consideration. implies simplest candidate outer regions must weakly irreducible region-width still diﬃcult weakly irreducible width- regions start ones variables interactions among pair variables i.e. loop size next consider loops size without chords etc. adding loops regions accordance intuition primary cause inaccuracies bethe approximation since evidence travel around double counted result. hence adding loops approximation seems natural ﬁrst step towards improving bethe approximation. following experiments designed test assumptions presented section evaluating candidate regions. used factor graph models pairwise interactions binary states. following sgn×m denote square grid model size denote fully connected model nodes. node edge potentials generated weights {wij} {αi} log-domain clusters nodes strong interactions others weak interactions. experiments sequentially squares triangles compare change accuracy approximation following methods iteration graph containing diﬀerent candidate region compute single variable marginal distributions running gbp. compared ground truth region smallest average error chosen. iteration region pursuit algorithm section choose region. iteration graph containing diﬀerent candidate region convergence change free energy evaluate merit. like without approximation compute change free energy. procedure region pursuit choose region induces smallest change free energy. rand pick region random equal probability. results averaged random draws. results reported ﬁgures respectively. square grid expected improve approximation hence assumption expected hold. case ﬁgure always pick regions implying performing optimally assumption holds. moreover given observed convergence somewhat problematic especially many generations. convergent alternatives replace known exhibit slow convergence. improved damping schemes help elevate problem. interesting extensions region pursuit algorithm worth considering. particular regions high region-widths currently excluded computational regions method conceivable treat regions approximation allowing inclusion.", "year": 2012}