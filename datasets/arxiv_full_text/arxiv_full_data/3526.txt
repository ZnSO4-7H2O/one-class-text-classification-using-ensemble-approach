{"title": "End-to-End Abnormality Detection in Medical Imaging", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Nearly all of the deep learning based image analysis methods work on reconstructed images, which are obtained from original acquisitions via solving inverse problems. The reconstruction algorithms are designed for human observers, but not necessarily optimized for DNNs. It is desirable to train the DNNs directly from the original data which lie in a different domain with the images. In this work, we proposed an end-to-end DNN for abnormality detection in medical imaging. A DNN was built as the unrolled version of iterative reconstruction algorithms to map the acquisitions to images, and followed by a 3D convolutional neural network (CNN) to detect the abnormality in the reconstructed images. The two networks were trained jointly in order to optimize the entire DNN for the detection task from the original acquisitions. The DNN was implemented for lung nodule detection in low-dose chest CT. The proposed end-to-end DNN demonstrated better sensitivity and accuracy for the task compared to a two-step approach, in which the reconstruction and detection DNNs were trained separately. A significant reduction of false positive rate on suspicious lesions were observed, which is crucial for the known over-diagnosis in low-dose lung CT imaging. The images reconstructed by the proposed end-to-end network also presented enhanced details in the region of interest.", "text": "deep neural networks shown promising performance computer vision. medical imaging encouraging results achieved deep learning applications segmentation lesion detection classiﬁcation. nearly deep learning based image analysis methods work reconstructed images obtained original acquisitions solving inverse problems reconstruction algorithms designed human observers necessarily optimized dnns often observe features incomprehensible human eyes. hence desirable train dnns directly original data different domain images. paper proposed end-to-end abnormality detection medical imaging. align acquisition annotations made radiologists image domain built unrolled version iterative reconstruction algorithms acquisitions images followed convolutional neural network detect abnormality reconstructed images. networks trained jointly order optimize entire detection task original acquisitions. implemented lung nodule detection low-dose chest computed tomography numerical simulation done generate acquisitions chest images radiologists’ annotations. proposed end-to-end demonstrated better sensitivity accuracy task compared two-step approach reconstruction detection dnns trained separately. signiﬁcant reduction false positive rate suspicious lesions observed crucial known over-diagnosis low-dose lung imaging. images deep neural networks shown promising performance computer vision various applications segmentation detection recognition. medical imaging dnnbased computer vision also desirable radiologists’ routine work requires handling large amount data possibility exists intensive labor lead misdiagnosis furthermore radiation related applications computed tomography low-dose scans always preferred decrease potential harm ionized radiation human body. increased noise level lowdose data made even challenging radiologists make correct decisions almost dnns medical image analysis constructed image domain domain radiologists observations. however medical imaging modalities acquired data different domain images inverse problems solved reconstruct images. example magnetic resonance imaging acquires data fourier domain acquires data radon transform domain reconstruction great possibility information lost presence noise measurements especially low-dose scans compensate noise iterative methods exploit prior knowledge human body proposed achieve better representation medical images based reconstruction methods also proposed recently however still objective image quality improvement utility diagnosis means radiologists computer aided diagnosis systems working sub-optimal images. emerging trend task-based signal processing dnns recent years decisions directly made dnns without explicit intermediate representations. graves jaitly used speech recognition directly audio data without intermediate phonetic representations. bojarski trained self-driving cars learned commands directly images without recognition land markers. iizuka used classiﬁcation criteria colorization grey-scale images. wang detected words directly scenes without two-step text detection optical character recognition demonstrated end-to-end dnns improved performance compared multiple-step learning applications. paper proposed end-to-end predicts location abnormalities images acquisitions. reconstruction built ﬁrst acquired data images order align data annotations made radiologists. approximated -iteration unrolled sequential quadratic surrogates algorithm convolutional neural network used detect abnormalities reconstructed images. entire optimized jointly regard total detection cross entropy loss. method implemented lung image database consortium image collection cancer image archive simulated ultra low-dose scans original patients’ data task lung nodule detection essential early stage cancer screening performance end-to-end method evaluated entropy loss receiver operating characteristic compared two-step approach reconstruction trained ﬁrst detection trained reconstructed images. furthermore intermediate reconstructed images features end-to-end network studied comprehensive understanding dnn. data consequence applying directly acquisition data withprior knowledge requires impractically large receptive ﬁeld network. furthermore data aligned radiologists’ annotations image domain. hence proposed end-to-end abnormality detection reconstruction network applied ﬁrst data image domain followed detection network detect lesions. x-ray source detector array placed opposite side patient rotate detect signals different angles. detected data line integral attenuation coefﬁcients inside patient image reconstructed. reconstruction problem written measurement matrix noise weighting matrix usually diagonal related function incorporates prior knowledge hyper-parameter control balance data ﬁdelity prior knowledge terms. all-ones vector dimension diag diagonal elements matrix long division element-wise operation. choices prior function include total variation wavelet transform etc.. reconstruction model takes iterative solution compatible end-to-end dnns. hand-crafted prior function also constrained expression power reconstruction model. solutions approximate iterative solutions ﬁnite steps expressed feasibility demonstrated several algorithms ista steepest descend admm primal-dual etc. substituting operations neural networks updating formula became cnns. several studies indicated necessary take exact form algorithm reduce computation load omitted denominator realization. furthermore adaptive step size added improve capacity dnn. ﬁnal formula reconstruction network initial image taken results ﬁltered backprojection data hann ﬁlter. training reconstruction network alone l-distance reconstructed images simulated low-dose data original ground truth minimized. structure reconstruction shown ﬁgure structure sub-cnns constructed following work adler ¨oktem figure structure reconstruction neural network. reconstructed projection data fbp. convolutional layers used symmetric padding image boundary. constructing system matrix used multi-slice fan-beam geometry shown ﬁgure projection data multi-slice fan-beam geometry approximately acquired rebinning helical geometry adopted clinical scanners. multi-slice fan-beam geometry system matrix became layer image would greatly reduce amount memory needed training since layers needed feed instead entire volume. utilize correlation adjacent slices reconstruction input contained successive layers images composed channels cnns figure schematics joined training reconstruction detection neural networks. arrows stand backpropagation neural networks. gθrk stand gradients accumulated step algorithm pulmonary nodules abnormal tissues lung develop cancer. important detect lung nodules early stage cancer screening several systems automatic lung nodule detection works deep neural networks recently necessary detect lung nodules better discrimination vessels reduction false positive rate. work solution second place national data science bowl held kaggle used patch-based solution worked patches size spatial resolution. patches contained nodules labeled whereas rest patches labeled coarse segmentation lung performed detection would perform lung region. cross entropy minimized predictions labels training. structure detection neural network shown ﬁgure end-to-end joined version reconstruction detection proposed section cross entropy nodule detection minimized training end-toend dnn. problem insufﬁcient memory graphics processing unit arise reconstruction cannot trained local patches memory consuming. denote reconstruction network detection network algorithm proposed overcome problem. graphical demonstration algorithm presented ﬁgure algorithm step forward propagation step backpropagation. weights neural network initialized two-step trained results. number layers iteration least larger depth cubes used detection case. sub-layers overlapped reduce computational load complexity algorithm. algorithm joined training reconstruction detection networks require pre-trained weights reconstruction detection networks require necessary data conﬁgurations training initialization initialize converged return network parameters reconstruction detection networks aggregate reconstructed image extract patches xd··· corresponding labels z··· deﬁne crossentropy gxdm gxdm according position successive layers gxrk patches extracted within lung regions masks lung regions pre-calculated. patches need entire image also overlapped. denser sampling lung nodules used lack positive samples compared negative samples. patches also augmented ﬂips detection network ﬂips applied gxdm aggregating step step step backpropagated gradients patches entire image. tcia lidc-idri dataset used simulation. dataset contains chest scans various scanners annotated experienced thoracic radiologists. lesion annotated non-small nodule small nodule non-nodule images resampled spatial resolution padded zeros axial planes. pixel value images converted hounsﬁeld unit attenuation coefﬁcient simulate low-dose scans images forward projected multi-slice fan-beam geometry shown ﬁgure mean photon counts x-ray source detector unit corresponded ultra low-dose scan compared commercial scanners. detected photon counts assumed following poisson distribution mean value reconstruction network reconstruction iteration repeated times independent iteration. input reconstruction neural network successive layers corresponding algorithm adam algorithm step size used training weights initialized following gaussian distribution except prelu units initialized relu iteration random successive layers used iterations total training reconstruction neural network. data reconstructed trained reconstruction network training nodule detector. considered non-small nodules detection. annotation non-small nodules positive sample extracted center annotation augmented times applying randomly ﬂips translation near center. non-small nodule annotated times total different radiologist positive samples generated non-small nodule. negative samples composed parts radiologists-annotated non-nodules tissues lung tissues edge lung. non-nodules augmented times ﬂips translation. image patches randomly selected lung region segmented reconstruction network results another patches randomly selected edges mask. negative patches kept away center non-small nodules safety margin positive samples negative samples generated total training detection network. adam algorithm step size used training. mini-batch size used epochs run. training reconstruction detection networks ﬁne-tune carried based trained weights according algorithm successive layers used iteration. ensure certain portion positive samples training iterations image ensured non-small nodules inside sub-images rest extracted randomly. epoch ﬁne-tuning step. patches extracted testing dataset training dataset. patch-wise cross entropy loss calculated two-step end-to-end trained neural networks. analysis also performed changing decision threshold mentioned section reconstructions carried non-overlapped layers reduce computational load. however observed study obvious streaking artifacts presented coronal sagittal planes fact control intensities reconstructed images end-to-end training. presence streaking artifacts indicated detection network insensitive different biases across slices. thus overlapped reconstruction step size performed eliminate artifacts analyzed trained detection neural network. reconstruction neural network operations implemented tesla cuda tensorﬂow. reconstruction operations embedded tensorﬂow framework user interface. patch extraction gradient aggregation steps based. gradient backpropagation step reconstruction neural network implemented overriding gradient dummy operation gxrk. patch-wise entropy losses validation dataset calculated two-step end-to-end training. cross entropy losses calculated image validation dataset results presented ﬁgure signiﬁcant improvement cross entropy end-to-end training scheme compared two-step training. according analysis end-to-end method signiﬁcant gain sensitivity lung nodule false positive rate controlled small crucial abnormality detection task. analyze source improvement cross entropy calculated samples different sources non-small nodules positive samples non-nodules suspicious lesions nodules random negative samples lung region random negative samples edge lung. statistical results presented ﬁgure biggest advantage end-to-end detection compared tow-step detection signiﬁcantly reduced outputs reconstruction networks validating images plotted ﬁgure based reconstruction results greatly reduced noise lung region compared standard reconstruction algorithm clinical scanners. results end-toend training still resemble standard images better contrast details lung region compared tow-step results smoother appearance lower noise level. figure demonstrated examples correct classiﬁcation methods incorrect classiﬁcation one. end-to-end network reconstructed details helped discrimination suspicious lesions shown ﬁgure however demonstrated ﬁgure increased noise background also suppress nodule’s presence. figure demonstrated images different number iterations reconstruction network. images similar appearance ordinary images except presence small biases early iterations. noise also gradually removed images normal iterative reconstruction algorithms. figure plotted feature maps reconstruction could give insights difference image reconstruction step two-step end-to-end networks. correlations feature maps calculated channel correlated uncorrelated feature maps presented ﬁgure observed ﬁgure correlated components structures images whereas deviated part high-frequency components edges. tissues lung much better contrast end-to-end network compared two-step network indicated end-to-end training emphasized lung tissue preservation. figure reconstructed images validating images. bottom axial coronal sagittal views respectively. images reconstructed hann ﬁlter designed noise suppresion. lung nodule annnotated white dashed boxes zoomed lower right view. display window images. paper novel end-to-end proposed abnormality detection medical imaging. reconstruction network detection network trained jointly maximize abnormality detection accuracy. implemented method simulated chest data achieved higher non-small lung nodule detection accuracy compared two-step training scheme. significant false positive rate reduction suspicious lesions fair improvement overall detection sensitivity accuracy. images reconstructed end-to-end method resembled ordinary images details increased noise level compared two-step approach. figure recosntructed images different iterations reconstruction network. left right columns images initial results iterations. display window among validation cases mean entropy loss nodule detection end-to-end method smaller similar two-step method cases indicated statistical improvement nodule detection proposed method. however case end-to-end entropy loss signiﬁcantly higher two-step loss. studied case conﬁrmed strong misclassiﬁcation positive samples shown ﬁgure although signiﬁcant improvement total shown table study ﬁgure indicated signiﬁcantly improved true positive rate small false positive rate. u.s. carried national lung cancer screening low-dose considered cause overdiagnosis high false positive rate sensitivity improvement false positive rate indicated end-to-end great potential value cancer screening tasks. great difference appearance reconstructed images methods. two-step training gave images smaller overall noise level details lung smoothed caused misclassiﬁcation detection network shown ﬁgure end-to-end training revealed details lung higher spatial resolution images suitable automatic nodule detection task. though misclassiﬁcation increased noise level overall performance nodule detection improved end-to-end training scheme. analysis intermediate results reconstruction network revealed difference approaches. whereas methods kept similar structural component end-to-end method focus edges tissues inside lung compared two-step method. observed ﬁgure structures lung tissue much clearer end-to-end networks. observation indicated sharper edge structures importance detection network noise level reconstructed images accordance human perceptions radiologists perform task. selecting appropriate representations data tasks detection crucial philosophy end-to-end training leave representation selection problem machine rather hand-crafting work demonstrated feasibility end-to-end abnormality detection medical imaging speciﬁc lung nodule detection problem chest figure feature maps intermediate convoltuional layers reconstruction neural network feature maps highest correlation channel two-step end-to-end networks. feature maps lowest correlation channel networks. feature maps ﬁrst prelu iteration ﬁrst prelu iteration second prelu iteration respectively left right columns. feature maps normalized independently. concluded better results achieved systems nowadays systems trained reconstructed images designed tuned radiologists rather machines. integrating reconstruction process detection pipeline better detection accuracy could achieved systems increase value radiologists. references mart´ın abadi ashish agarwal paul barham eugene brevdo zhifeng chen craig citro greg corrado andy davis jeffrey dean matthieu devin tensorﬂow large-scale machine learning heterogeneous distributed systems. arxiv preprint arxiv. samuel armato geoffrey mclennan bidaut michael mcnitt-gray charles meyer anthony reeves binsheng zhao denise aberle claudia henschke eric hoffman lung image database consortium image database resource initiative completed reference database lung nodules scans. medical physics samuel armato geoffrey mclennan bidaut michael mcnitt-gray charles meyer anthony reeves laurence clarke data lidc-idri. cancer imaging archive. http//doi.org/./k/tcia..loqlsx mariusz bojarski davide testa daniel dworakowski bernhard firner beat flepp prasoon goyal lawrence jackel mathew monfort muller jiakai zhang learning self-driving cars. arxiv preprint arxiv. guang-hong chen tang shuai leng. prior image constrained compressed sensing method accurately reconstruct dynamic images highly undersampled projection data sets. medical physics chen zhang weihua zhang huaiqiaing peixi liao jiliu zhou wang. learned experts’ assessment-based reconstruction network sparse-data arxiv preprint arxiv. francesco ciompi bartjan hoop sarah riel kaman chung ernst scholten matthijs oudkerk jong mathias prokop bram ginneken. automatic classiﬁcation pulmonary peri-ﬁssural nodules computed tomography using ensemble views convolutional neural network out-of-the-box. medical image analysis kenneth clark bruce vendt kirk smith john freymann justin kirby paul koppel stephen moore stanley phillips david mafﬁtt michael pringle cancer imaging archive maintaining operating public information repository. journal digital imaging alex graves navdeep jaitly. towards end-to-end speech recognition recurrent neural networks. proceedings international conference machine learning hayit greenspan bram ginneken ronald summers. guest editorial deep learning medical imaging overview future promise exciting technique. ieee transactions medical imaging metin gurcan berkman sahiner nicholas petrick heang-ping chan ella kazerooni philip cascade lubomir hadjiiski. lung nodule detection thoracic computed tomography images preliminary evaluation computer-aided diagnosis system. medical physics kerstin hammernik teresa klatzer erich kobler michael recht daniel sodickson thomas pock florian knoll. learning variational network reconstruction accelerated data. arxiv preprint arxiv. mannudeep kalra michael maher thomas toth leena hamberg michael blake jo-anne shepard sanjay saini. strategies radiation dose optimization. radiology xiang aoxiao zhong ming ning arkadiusz sitek jieping james thrall quanzheng self-paced convolutional neural network computer aided detection medical imaging analysis. international workshop machine learning medical imaging springer heber macmahon john austin gordon gamsu christian herold james jett david naidich edward patz stephen swensen. guidelines management small pulmonary nodules detected scans statement ﬂeischner society. radiology edward patz paul pinsky constantine gatsonis jorean sicks barnett kramer martin tammem¨agi caroline chiles william black denise aberle. overdiagnosis lowdose computed tomography screening lung cancer. jama internal medicine perry pickhardt meghan lubner david tang julie ruma alejandro mu˜noz guang-hong chen. abdominal model-based iterative reconstruction initial results prospective trial comparing ultralow-dose standard-dose imaging. amerijournal roentgenology schlemper jose caballero joseph hajnal anthony price daniel rueckert. deep cascade convolutional neural networks dynamic image reconstruction. arxiv preprint arxiv. arnaud arindra adiyoso setio francesco ciompi geert litjens paul gerke colin jacobs sarah riel mathilde marie winkler wille matiullah naqibullah clara s´anchez bram ginneken. pulmonary nodule detection images false positive reduction using multi-view convolutional networks. ieee transactions medical imaging emil sidky xiaochuan pan. image reconstruction circular cone-beam computed tomography constrained total-variation minimization. physics medicine biology bram ginneken arnaud setio colin jacobs francesco ciompi. off-the-shelf convolutional neural network features pulmonary nodule detection computed tomography scans. biomedical imaging ieee international symposium ieee jing wang tianfang hongbing zhengrong liang. penalized weighted least-squares approach sinogram noise reduction image reconstruction low-dose x-ray computed tomography. ieee transactions medical imaging dufan kyungsang georges fakhri quanzheng iterative low-dose reconstruction priors trained artiﬁcial neural network. ieee transactions medical imaging ying joyita dutta ning chenhui zhou arkadiusz sitek quanzheng classiﬁcation exacerbation frequency copdgene cohort using deep learning deep belief networks. ieee journal biomedical health informatics", "year": 2017}