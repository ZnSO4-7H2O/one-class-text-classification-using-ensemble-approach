{"title": "Temporal Matrix Completion with Locally Linear Latent Factors for  Medical Applications", "tag": ["cs.LG", "cs.CV", "stat.ML"], "abstract": "Regular medical records are useful for medical practitioners to analyze and monitor patient health status especially for those with chronic disease, but such records are usually incomplete due to unpunctuality and absence of patients. In order to resolve the missing data problem over time, tensor-based model is suggested for missing data imputation in recent papers because this approach makes use of low rank tensor assumption for highly correlated data. However, when the time intervals between records are long, the data correlation is not high along temporal direction and such assumption is not valid. To address this problem, we propose to decompose a matrix with missing data into its latent factors. Then, the locally linear constraint is imposed on these factors for matrix completion in this paper. By using a publicly available dataset and two medical datasets collected from hospital, experimental results show that the proposed algorithm achieves the best performance by comparing with the existing methods.", "text": "regular medical records useful medical practitioners analyze monitor patient’s health status especially chronic disease records usually incomplete unpunctuality absence patients. order resolve missing data problem time tensorbased model suggested missing data imputation recent papers approach makes rank tensor assumption highly correlated data. however time intervals records long data correlation high along temporal direction assumption valid. address problem propose decompose matrix missing data latent factors. then locally linear constraint imposed factors matrix completion paper. using publicly available dataset medical datasets collected hospital experimental results show proposed algorithm achieves best performance comparing existing methods. regular medical records contain patients’ medical examinations diagnosis treatments etc. across time important sources assessing patient’s health status. based assessment medical practitioners effectively monitor disease progress treatment response provide valuable advices proper treatments patients. furthermore patients chronic disease develop fatal illness without proper guidance monitoring. example patients non-alcoholic fatty liver disease risk cirrhosis hepatocellular carcinoma without proper management although regular medical records beneficial patients missing data intractable problem hamper precise decisions medical practitioners. problem happens many reasons patients e.g. forgetful character busy work fear certain tests etc. even though self-report quality-of-life-questionnaires used assess patients affected time disease employed missing data common unavoidable tackle missing data problem existing popular methods mean imputation consider relationship among attributes. recent years many research works temporal matrix completion applicable compressed sensing seismic data reconstruction network data completion traffic data completion medical signal reconstruction temporal collaborative filtering visual data video restoration works tensor-related approach dominant solving temporal matrix completion problem canonical polyadic tensor decomposition techniques commonly used. since tensor rank computation np-hard suggested tensor trace norm tensor completion visual data. however wang pointed minimizing trace norm tensor fulfill assumption video frames highly correlated temporal axis. assumption true video clip multiple different episodes. medical record imputation dauwels garg suggested tensor decomposition imputing quality-of-life questionnaire used assess quality life patient treatment disease progress quality care details algorithm referenced intrisinic apply matrix completion methods matrix along temporal direction method ignores correlation matrices. hand dauwels garg suggested tensor decomposition quality-of-life questionnaire imputation. decomposition minimal rank-one tensors forms tensor 𝓧𝓧∈ℝ𝐼𝐼×𝐼𝐼×…×𝐼𝐼𝑁𝑁 𝓧𝓧=𝒗𝒗∘𝒗𝒗∘…∘𝒗𝒗𝑁𝑁 𝒗𝒗𝑚𝑚∈ℝ𝐼𝐼𝑚𝑚×𝑅𝑅 𝒗𝒗𝑖𝑖∘𝒗𝒗𝑗𝑗 denotes outer product vectors 𝒗𝒗𝑖𝑖 𝒗𝒗𝑗𝑗. then reconstruction error mini𝒗𝒗𝒗𝒗…𝒗𝒗𝑁𝑁.‖𝜦𝜦−𝒗𝒗∘𝒗𝒗∘…∘𝒗𝒗𝑁𝑁‖𝐹𝐹 frobenius norm 𝑁𝑁-mode observed others missing. although decomposition break tensor several individual components rank- tensor assumption useful highly correlated data only. time interval medical records long assumption reasonable medical records along temporal directon. since rank- tensor assumption always true considered define trace norm using equation three different methods including silrtc falrtc falrtc developed based different conditions. however wang huang pointed approach relies highly correlated data temporal direction tensor norm average trace norms tensor unfolded along mode minimized. instead wang huang suggested make temporal information consecutive video frames introducing smoothness regularization assume successive data video change much. applied temporally consistent constraint regularize recently. argued tensor decomposition exploit correlations data. however periods health checkups follow-up consultations long data correlation high along temporal direction. paper novel algorithm proposed impose locally linear constraint latent factors medical record matrix completion. since time interval records long data correlation assumption valid along temporal direction tensor decomposition latent factors medical record change nonlinearly time. thus proposed algorithm applies locally linear constraint latent factors medical record regularization converts tensor decomposition problem matrix completion problem using block matrix techniques. solve matrix completion problem alternate least squares approach applied sylvester questions. experimental results show proposed algorithm outperforms existing works compared experimental results. organization paper follows. next section reviews related works. section proposed algorithm explained. finally section gives experimental results conclusion. rank rank elements observed others missing. since rank nuclear norm ‖𝒁𝒁‖∗ used minimize rank. mazumber ‖𝒁𝒁‖∗=min𝑨𝑨𝑩𝑩 𝒁𝒁=𝑨𝑨𝑩𝑩′. using equation hastie ω‖𝐹𝐹+ .𝜆𝜆. �𝑭𝑭�𝑡𝑡�∗=min𝑶𝑶𝑡𝑡𝑷𝑷𝑡𝑡 𝑭𝑭�𝑡𝑡= 𝑶𝑶𝑡𝑡𝑷𝑷𝑡𝑡′. then equation becomes min𝑶𝑶𝑡𝑡𝑷𝑷𝑡𝑡 ‖𝑾𝑾𝑡𝑡⨀‖𝐹𝐹 +‖𝑷𝑷𝑡𝑡′‖𝐹𝐹) 𝑶𝑶𝑡𝑡 𝑷𝑷𝑡𝑡 latent factors paintroducing locally linear constraint 𝑶𝑶𝑡𝑡 𝑷𝑷𝑡𝑡 min𝑶𝑶𝑡𝑡𝑷𝑷𝑡𝑡 ‖𝑾𝑾𝑡𝑡⨀‖𝐹𝐹 .𝜆𝜆+ .𝛾𝛾−‖𝐹𝐹 .𝛽𝛽−‖𝐹𝐹 scalar values. since change latent time block matrix employed 𝑡𝑡=. defining 𝑶𝑶=′ 𝑷𝑷=′ matrix medical records 𝑭𝑭∈ℝ× approximated 𝑶𝑶𝑷𝑷′ i.e. 𝑭𝑭~𝑶𝑶𝑷𝑷′. then defined 𝑭𝑭=�𝑭𝑭𝑭𝑭…𝑭𝑭𝑇𝑇 𝑭𝑭𝑭𝑭…𝑭𝑭𝑇𝑇 𝑭𝑭𝑭𝑭…𝑭𝑭𝑇𝑇� 𝑾𝑾=�𝑾𝑾𝑚𝑚×𝑛𝑛…𝑚𝑚×𝑛𝑛 𝑚𝑚×𝑛𝑛𝑾𝑾…𝑚𝑚×𝑛𝑛 𝑚𝑚×𝑛𝑛𝑚𝑚×𝑛𝑛…𝑾𝑾𝑇𝑇� norm minimization. however constraint applicable medical records time interval year. main difference constraints proposed algorithm consistency constraint applied whole video frame proposed constraint imposed latent factors medical record cause change medical record time. thus proposed constraint effectively regularize optimization nonlinear changes latent factors. order impute missing data proposed algorithm makes locally linear constraint regularize norm minimization. initially record missing data approximated using latent factors. then locally linear constraints imposed latent factors form optimization equation. solve equation frobenius norms employed rank minimization block matrix techniques applied reformulate equation. then equation solved using optimize parameter fixing others time. latent factors found optimization used form final solution. decomposed three components since medical record 𝑭𝑭𝑡𝑡 time contains missing values approximated 𝑭𝑭�𝑡𝑡=𝑼𝑼𝑡𝑡𝑫𝑫𝑡𝑡𝑽𝑽𝑡𝑡′ 𝑼𝑼𝑡𝑡 𝑽𝑽𝑡𝑡 la𝑭𝑭𝑡𝑡~𝑭𝑭�𝑡𝑡 time illustrated fig. impute tent factors patient-to-patient item-to-item relationship. note item questions healthcare questionnaires blood test results health indicators medical records. decomposition medical record nuclear norm hadamard product scalar value element 𝑾𝑾𝑡𝑡 equal corresponding entry 𝑭𝑭𝑡𝑡 missing otherwise. furthermore 𝑭𝑭�𝑡𝑡 decomposed 𝑶𝑶𝑡𝑡𝑷𝑷𝑡𝑡′ 𝑭𝑭�𝑡𝑡∈ ℝ𝑚𝑚×𝑛𝑛 𝑶𝑶𝑡𝑡∈ℝ𝑚𝑚×𝑟𝑟 𝑷𝑷𝑡𝑡∈ℝ𝑛𝑛×𝑟𝑟 𝑶𝑶𝑡𝑡=𝑼𝑼𝑡𝑡�𝑫𝑫𝑡𝑡 𝑷𝑷𝑡𝑡= 𝑽𝑽𝑡𝑡�𝑫𝑫𝑡𝑡 implies 𝑶𝑶𝑡𝑡 𝑷𝑷𝑡𝑡 latent factors patient-to-patient item-to-item relationship time 𝑭𝑭�𝑡𝑡𝑭𝑭�𝑡𝑡′=𝑼𝑼𝑡𝑡𝑫𝑫𝑡𝑡𝑼𝑼𝑡𝑡′= 𝑶𝑶𝑡𝑡𝑫𝑫𝑡𝑡𝑶𝑶𝑡𝑡′ 𝑭𝑭�𝑡𝑡′𝑭𝑭�𝑡𝑡= 𝑽𝑽𝑡𝑡𝑫𝑫𝑡𝑡𝑽𝑽𝑡𝑡′= 𝑷𝑷𝑡𝑡𝑫𝑫𝑡𝑡𝑷𝑷𝑡𝑡′. equation shown min𝑶𝑶� .�𝑭𝑭�′−𝑷𝑷𝑶𝑶′�𝐹𝐹+ .𝜆𝜆��𝑷𝑷�𝐹𝐹+�𝑶𝑶′�𝐹𝐹�+ .𝛼𝛼′𝑸𝑸𝑶𝑶′�𝐹𝐹)+.𝛽𝛽��𝑷𝑷′𝑸𝑸𝑷𝑷�𝐹𝐹�. equation obtained solving 𝑷𝑷′𝑭𝑭�′=′𝑷𝑷)𝑶𝑶′ +𝑶𝑶′. equation sylvester equation 𝑨𝑨𝑨𝑨+𝑨𝑨𝑩𝑩= reformed 𝑨𝑨=𝑪𝑪 kronecker tensor product identity matrix represent single column algorithm initial value randomly generated. then assigned 𝑼𝑼�𝑫𝑫�. 𝑽𝑽�𝑫𝑫�.. iteration updated solving equation convergence rate implementation threshold value final values obtained 𝑭𝑭�=𝑶𝑶𝑷𝑷′ calculated found 𝑼𝑼𝑫𝑫𝑽𝑽′. order obtain rank representation diagonal values removed less threshold final result 𝑼𝑼𝑺𝑺𝜆𝜆𝑽𝑽′. 𝑖𝑖=. initialize 𝑶𝑶=𝑼𝑼�𝑫𝑫�. 𝑷𝑷=𝑽𝑽�𝑫𝑫�. initialize filling missing values solve update fixing update 𝑭𝑭�′=𝑾𝑾′⨀𝑭𝑭′−⨀�𝑷𝑷𝑶𝑶′� solve update fixing update 𝑭𝑭�=𝑾𝑾⨀𝑭𝑭−⨀�𝑶𝑶𝑷𝑷′� compute convergence rate =‖𝑾𝑾⨀𝑲𝑲𝑛𝑛𝑛𝑛𝑛𝑛−𝑾𝑾⨀𝑲𝑲𝑜𝑜𝑜𝑜𝑜𝑜‖𝐹𝐹/‖𝑾𝑾⨀𝑲𝑲𝑜𝑜𝑜𝑜𝑜𝑜‖𝐹𝐹 𝑲𝑲𝑛𝑛𝑛𝑛𝑛𝑛=𝑶𝑶𝑷𝑷′ 𝑲𝑲𝑜𝑜𝑜𝑜𝑜𝑜=𝑶𝑶𝑷𝑷′ 𝑖𝑖=𝑖𝑖+ obtain 𝑲𝑲𝑛𝑛𝑛𝑛𝑛𝑛=𝑼𝑼𝑫𝑫𝑽𝑽′ output soft-threshold 𝑼𝑼𝑺𝑺𝜆𝜆𝑽𝑽′ 𝑺𝑺𝜆𝜆 operator replace 𝑫𝑫𝑖𝑖𝑖𝑖 min. initialization used mask 𝑸𝑸𝑶𝑶 ∈ℝ×𝑚𝑚)× 𝑸𝑸𝑷𝑷∈ℝ×𝑛𝑛)× �𝐈𝐈𝑚𝑚×𝑚𝑚−𝐈𝐈𝑚𝑚×𝑚𝑚 𝐈𝐈𝑚𝑚×𝑚𝑚 𝑚𝑚×𝑚𝑚…… 𝑚𝑚×𝑚𝑚 𝑚𝑚×𝑚𝑚…… 𝑚𝑚×𝑚𝑚 𝐈𝐈𝑚𝑚×𝑚𝑚−𝐈𝐈𝑚𝑚×𝑚𝑚 𝐈𝐈𝑚𝑚×𝑚𝑚� 𝑚𝑚×𝑚𝑚… 𝐈𝐈𝑚𝑚×𝑚𝑚−𝐈𝐈𝑚𝑚×𝑚𝑚 𝐈𝐈𝑚𝑚×𝑚𝑚… 𝑚𝑚×𝑚𝑚 �𝐈𝐈𝑛𝑛×𝑛𝑛−𝐈𝐈𝑛𝑛×𝑛𝑛 𝐈𝐈𝑛𝑛×𝑛𝑛 𝑛𝑛×𝑛𝑛....… 𝑛𝑛×𝑛𝑛 𝑛𝑛×𝑛𝑛……. 𝑛𝑛×𝑛𝑛 𝐈𝐈𝑛𝑛×𝑛𝑛−𝐈𝐈𝑛𝑛×𝑛𝑛 𝐈𝐈𝑛𝑛×𝑛𝑛� 𝑛𝑛×𝑛𝑛… 𝐈𝐈𝑛𝑛×𝑛𝑛−𝐈𝐈𝑛𝑛×𝑛𝑛 𝐈𝐈𝑛𝑛×𝑛𝑛… 𝑛𝑛×𝑛𝑛 𝐈𝐈𝑚𝑚×𝑚𝑚 𝐈𝐈𝑛𝑛×𝑛𝑛 𝑚𝑚×𝑚𝑚 𝑛𝑛×𝑛𝑛 identity matrix 𝑚𝑚×𝑚𝑚 𝑛𝑛×𝑛𝑛 𝑚𝑚×𝑚𝑚 𝑛𝑛×𝑛𝑛 zero matrix. using 𝑸𝑸𝑶𝑶 𝑸𝑸𝑷𝑷 equation reformulated min𝑶𝑶𝑷𝑷 .‖𝑾𝑾⨀‖𝐹𝐹+ .𝜆𝜆+ .𝛼𝛼+.𝛽𝛽. =𝑾𝑾⨀𝑭𝑭−⨀−𝑶𝑶𝑷𝑷′ suppose current estimates iteration computed fixing replacing first occurrence 𝑶𝑶𝑷𝑷′ current estimate i.e. 𝑭𝑭�= 𝑾𝑾⨀𝑭𝑭−⨀�𝑶𝑶𝑷𝑷′�. then equation bemin𝑷𝑷� .�𝑭𝑭�−𝑶𝑶𝑷𝑷′�𝐹𝐹+ .𝜆𝜆��𝑶𝑶�𝐹𝐹+�𝑷𝑷′�𝐹𝐹�+ .𝛼𝛼�𝐹𝐹)+.𝛽𝛽��𝑷𝑷′𝑸𝑸𝑷𝑷�𝐹𝐹�. equation obtained solving 𝑶𝑶′𝑭𝑭�=�𝜆𝜆𝐈𝐈+𝑶𝑶′𝑶𝑶�𝑷𝑷′+ identity matrix. fixing replacing first occurrence 𝑶𝑶𝑷𝑷′ equation cur�′=𝑾𝑾′⨀𝑭𝑭′−⨀�𝑷𝑷𝑶𝑶′� computed. similarly order evaluate proposed algorithm previous section mean imputation method decomposition method softimpute-als method softimpute-svd method low-rank tensor completion method low-rank tensor completion spatiotemporal consistency method employed comparisons. since meanimpute popular methods data imputation included comparison. softimpute-als softimpute-svd used evaluation publicly available software imputation since lrtc related tensor completion relies strong data correlation assumption mentioned compared proposed algorithm assumed strong data correlation along temporal direction. besides lrtc-stc recent study consistency constraint compared proposed algorithm locally linear constraint. implementation source softimpute-als softimpute-svd lrtc available. tensor-ct dauwels garg made decomposition obtained online lrtc-stc implemented first author according best knowledge. experiments softimpute-als softimpute-svd performed 𝜆𝜆=... since general ated 𝑅𝑅=. lrtc three different imevaluated default parameters except three methods 𝜌𝜌=−− ters 𝑝𝑝=... 𝛼𝛼=. proposed algorithm parameters 𝛼𝛼=− 𝛽𝛽=− experiments. compute imputation error root-mean-square error applied computed solution 𝑭𝑭sol ground truth i.e. ‖𝐹𝐹/𝑁𝑁miss). 𝑁𝑁miss number missing data diagonal order evaluate performance imputation three datasets used. first dataset beneficiary files data entrepreneurs’ synthetic public file provides realistic claims data public domain. records contain health conditions beneficiaries records beneficiaries attributes randomly extracted first dataset called dataset dimensions paper evaluation. attributes race health-related records second third datasets called hepb-i hepb-ii datasets paper contain medical records patients suffered hepatitis evaluation probable hepatocellular carcinoma prince wales hospital hong kong patient records patient records extracted form hepb-i dimensions hepb-ii datasets dimensions. attributes hepb-i datasets blood test results alpha-fetoprotein albumin alkaline phosphatase alkaline phosphatase alanine aminotransferase creatinine international normalized ratio platelet prothrombin time potassium sodium urea attributes hepb-ii datasets blood test results attributes blood test results hepb-i dataset except perform experiments observed data chosen dataset five datasets different observed data randomly generated percentage. then imputation error algorithm calculated taking average rmses five datasets. dataset normalized zero mean unit scaling before used experiments. corresponding experimental results shown table table experimental results reported based dataset. observed data proposed algorithm performs worse lrtc. obtains best result observed data outperforms second best method least observed data. table hepb-i dataset used evaluation. observed data proposed algorithm best performance. proposed algorithm outperform second best least observed data. table evaluation performed hepb-ii dataset. dataset proposed algorithm performs best observed data better methods least observed data. regular medical records systematically documents patients’ medical history care across time useful medical practitioners analyze health status patient provide proper care treatment. however missing data problem common regular medical records. order tackle missing data problem regular medical records algorithm imposes locally linear constraints latent factors medical records proposed. since latent factors change nonlinearly time cause change medical records locally linear constraint effectively regularize nonlinear changes. experiments performance proposed algorithm better comparison methods except observed data dataset. experimental results show usefulness locally linear constraint public dataset medical datasets. wang huang low-rank tensor completion spatio-temporal consistency. proceedings twenty-eighth aaai conference artificial intelligence palo alto california aaai press. wong wong chan chim yeung chan chan. prevalence non-alcoholic fatty liver disease advanced fibrosis hong kong chinese population study using proton-magnetic resonance spectroscopy transient elastography. wong chan chan leung wong accuracy risk scores patients chronic hepatitis receiving entecavir treatment. gastroenterology wong chan. chan wong on-treatment alpha-fetoprotein specific tumor marker hepatocellular carcinoma patients chronic hepatitis receiving entecavir. hepatology xiong chen huang schneider carbonell temporal collaborative filtering bayesian probabilistic tensor factorization. proceedings siam international conference data mining. columbus ohio u.s.. yang stanley seismic data reconstruction matrix completion. inverse problems imaging. yuan zhang tensor completion nuclear norm minimization. foundations computational mathematics.", "year": 2016}