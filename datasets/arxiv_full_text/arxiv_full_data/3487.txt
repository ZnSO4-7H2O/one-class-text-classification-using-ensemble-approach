{"title": "Framing U-Net via Deep Convolutional Framelets: Application to  Sparse-view CT", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "X-ray computed tomography (CT) using sparse projection views is a recent approach to reduce the radiation dose. However, due to the insufficient projection views, an analytic reconstruction approach using the filtered back projection (FBP) produces severe streaking artifacts. Recently, deep learning approaches using large receptive field neural networks such as U-Net have demonstrated impressive performance for sparse- view CT reconstruction. However, theoretical justification is still lacking. Inspired by the recent theory of deep convolutional framelets, the main goal of this paper is, therefore, to reveal the limitation of U-Net and propose new multi-resolution deep learning schemes. In particular, we show that the alternative U- Net variants such as dual frame and the tight frame U-Nets satisfy the so-called frame condition which make them better for effective recovery of high frequency edges in sparse view- CT. Using extensive experiments with real patient data set, we demonstrate that the new network architectures provide better reconstruction performance.", "text": "recently deep learning approaches achieved tremendous success various ﬁelds classiﬁcation segmentation denoising super resolution etc. applications kang provided ﬁrst systematic study deep convolutional neural network low-dose showed deep using directional wavelets efﬁcient removing low-dose related noises. work followed many novel extensions low-dose unlike low-dose artifacts reduced tube currents streaking artifacts originated sparse projection views show globalized artifacts difﬁcult remove using conventional denoising cnns address problem independently proposed residual learning networks using u-net streaking artifacts globally distributed architecture large receptive ﬁeld shown essential works empirical performance signiﬁcantly better existing approaches. spite intriguing performance improvement deep learning approaches origin success inverse problems poorly understood. address this recently proposed so-called deep convolutional framelets powerful mathematical framework understand deep learning approaches inverse problems fact convolution framelets originally proposed generalize low-rank hankel matrix approaches representing signal using ﬁxed non-local basis convolved data-driven non-local basis novelty deep convolutional framelets discovery encoder-decoder network structure emerges hankel matrix decomposition addition controlling number ﬁlter channels neural network trained learn optimal local bases gives best low-rank shrinkage discovery demonstrates important link deep learning compressed sensing approach hankel structure matrix decomposition ingredients deep convolutional framelets so-called frame condition non-local basis however found existing u-net architecture satisfy frame condition overly emphasises frequency component signal context sparse-view artifact manifested blurring artifacts reconstructed images. address paper investigates types novel problem abstract—x-ray computed tomography using sparse projection views recent approach reduce radiation dose. however insufﬁcient projection views analytic reconstruction approach using ﬁltered back projection produces severe streaking artifacts. recently deep learning approaches using large receptive ﬁeld neural networks u-net demonstrated impressive performance sparseview reconstruction. however theoretical justiﬁcation still lacking. inspired recent theory deep convolutional framelets main goal paper therefore reveal limitation u-net propose multi-resolution deep learning schemes. particular show alternative unet variants dual frame tight frame u-nets satisfy so-called frame condition make better effective recovery high frequency edges sparse viewct. using extensive experiments real patient data demonstrate network architectures provide better reconstruction performance. x-ray potential risk radiation exposure main research thrust reduce radiation dose. among various approaches low-dose sparse-view recent proposal lowers radiation dose reducing number projection views sparse view useful existing multi-detector fast continuous acquisition projection views many interesting applications sparse-view spectral using alternating switching dynamic beam blocker etc. moreover c-arm dental applications scan time limited primarily relative slow speed plat-panel detector rather mechanical gantry speed sparse-view gives opportunity reduce scan time however insufﬁcient projection views sparse-view produces severe streaking artifacts reconstruction. address this researchers investigated compressed sensing approaches minimize total variation sparsity-inducing penalties data ﬁdelity term approaches however computationally expensive repeated applications projection back-projection iterative update steps. since hankel matrix essential component theory deep convolutional framelets brieﬂy review make paper self-contained. here avoid special treatment boundary condition theory mainly derived using circular convolution. simplicity consider signal processing extension straightforward signal vector. then explained hankel matrix closely related convolution operations cnn. speciﬁcally given convolutional ﬁlter singleinput single-output convolution represented using hankel matrix network architectures satisfy frame condition. first propose dual frame u-net architecture required modiﬁcation simple intuitive additional bypass connection low-resolution path generate residual signal. however dual frame u-net optimal relative large noise ampliﬁcation factor. address this tight frame u-net orthogonal wavelet frame also proposed. particular tight frame u-net haar wavelet basis implemented adding additional highfrequency path existing u-net structure. numerical experiments conﬁrm dual frame tight frame unets exhibit better high frequency recovery standard u-net sparse-view applications. matrix denotes range space denotes projection range space identity matrix referred given matrix notation refers generalized inverse. superscript denotes hermitian transpose. matrix submatrix rd×q refers j-th column vector referred ﬂipped version vector i.e. indices reversed. similarly given matrix rd×q notation rd×q refers matrix block structured matrix rpd×q slight abuse notation deﬁne σmin σmax denote minimum maximum singular values respectively. frame lower bound non-zero recovery original signal done frame coefﬁcient using dual frame satisfying so-called frame condition note general form signals associated rank-r hankel structured matrix interested specifying bases optimal performance. theory deep convolutional framelets correspond user-deﬁned generalized pooling unpooling satisfy frame condition hand ﬁlters need estimated data. limit search space ﬁlters consider consists signals positive framelet coefﬁcients then main goal neural network training learn training data assuming associated rank-r hankel matrices. speciﬁcally regression problem training data low-rank hankel matrix constraint given relu impose positivity framelet coefﬁcients. network fully trained inference given noisy input simply done equivalent denoised solution rank-r hankel structured matrix. sparse-view problems consistently shown residual learning by-pass connection better direct image learning investigate phenomenon systematically assume input image sparse-view contaminated streaking artifacts denotes j-th input channel ﬁlter. extension multi-channel convolution operation image domain straight-forward since similar matrix vector operations also used. required change deﬁnition hankel matrices deﬁned block hankel matrix. detailed convolution operation form hankel matrix intriguing properties hankel matrix often low-rank structure low-rankness related sparsity fourier domain property extremely useful evidenced applications many inverse problems low-level computer vision problems thus claim property origins success deep learning inverse problems understand claim brieﬂy review theory deep convolutional framelets make paper selfcontained. speciﬁcally inspired existing hankel matrix approaches consider following regression problem denotes ground-truth signal. classical approach address problem singular value shrinkage matrix factorization however deep convolutional framelets problem addresssed using learning-based signal representation. speciﬁcally feasible solution hankel structured matrix singular value decomposition rn×r rd×r denote left right singular vector bases matrices respectively; rr×r diagonal matrix singular values. consider matrix pairs rn×n satisfying frame condition bases refered non-local bases since interacts n-elements multiplying left rn×d addition need another matrix pair rd×r satisfying lowdimensional subspace constraint work learnable convolutional ﬁlters. moreover generalized pooling operation frame condition important prerequisite enabling recovery condition controllable shrinkage behavior main criterion constructing u-net variants next section. figs. show reconstruction images artifact-only images projection views available. signiﬁcant streaking artifact emanates images entire image area. suggests receptive ﬁeld convolution ﬁlter cover entire area image effectively suppress streaking artifacts. important characteristics multi-resolution architecture like u-net exponentially large receptive ﬁeld pooling unpooling layers. example fig. compares network depth-wise effective receptive ﬁeld multi-resolution network baseline single resolution network without pooling layers. size convolutional ﬁlters effective receptive ﬁeld enlarged network pooling layers. thus multi-resolution architecture good sparse view reconstruction deal globally distributed streaking artifacts understand u-net detail consider simpliﬁed u-net architecture illustrated fig. next level u-net thanks annihilating property accordingly neural network trained learn structure true image annihilate them still retain artifact signals. idea extended multi-layer deep convolutional framelet expansion. speciﬁcally llayer decomposition space recursively deﬁned denote ﬁlter length number input output channels respectively. recursively narrowing search space convolution frames layer described above obtain deep convolution framelet extension associated training scheme. details suggests network structure dual frame u-net. speciﬁcally unlike u-net residual signal resolution upsampled unpooling layer. easily implemented using additional by-pass connection low-resolution signal shown fig. implementation fig. simple allows network satisfy frame condition however exists noise ampliﬁcation condition number equal similar u-net ﬁnal step dual frame u-net concatenation multi-channel convolution equivalent applying inverse hankel operation i.e. processed framelet coefﬁcients multiplied local basis speciﬁcally concatenated signal given recursively applied low-resolution signal here input ﬁrst ﬁltered local convolutional ﬁlters reduced half size approximate signal using pooling operation mathematically step represented u-net by-pass connection compensate lost high frequency detail pooling implementation fig. combining convolutional framelet coefﬁcients represented fig. simpliﬁed u-net architecture variants. standard u-net dual frame u-net tight frame u-net concatenation. dashed lines refer skipped-connection square-box within correspond sub-band ﬁlters. next level u-net units added recursively low-frequency band signals. fig. simpliﬁed u-net architecture variants. standard u-net dual frame u-net tight frame u-net concatenation. dashed lines refer skipped-connection square-box within correspond sub-band ﬁlters. next level u-net units recursively added low-frequency band signals. several important tight ﬁlter bank frames. simplest haar wavelet transform high sub-band decomposition low-pass subband equivalent average pooling then high pass ﬁltering given easily haar wavelet frame tight. corresponding tight frame u-net structure illustrated fig. implementation fig. contrast standard unet additional high-pass branch. similar original u-net tight frame u-net subband signal by-passed individual concatenation layers shown fig. implementation fig. then convolutional layer concatenation provide weighted whose weights learned data. simple makes frame tight. another improve performance u-net minimum noise ampliﬁcation using tight ﬁlter-bank frames non-local basis wavelets. speciﬁcally composed ﬁlter bank data provided aapm dose grand challenge images reconstructed projection data synthetic projection data generated re-projecting using radon operator matlab. artifact-free original images reconstructed iradon operator matlab using views. sparse-view input images generated using iradon operator projection views respectively. sparse view reconstruction images correspond downsampling factor experiments label images deﬁned difference sparse view reconstruction full view reconstruction. among patient data eight patient data used training patient data validation whereas remaining used test. corresponds slices images training data slices images validation data. test data slices images. training data augmented conducting horizontal vertical ﬂipping. training data used reconstruction using projection views simultaneously input residual image full view reconstruction sparse view reconstructions used label. quantitative evaluation normalized mean square error value used deﬁned shown figs. original dual-frame tight-frame u-nets consist convolution layer batch normalization rectiﬁed linear unit contracting path connection concatenation speciﬁcally stage contains four sequential layers composed convolution kernels batch normalization relu layers. finally last stage sequential layers last layer contains convolution layer kernel. number channels convolution layer illustrated figs. note number channels doubled pooling layers. differences original dual-frame tight-frame u-net pooling unpooling layers. proposed network trained stochastic gradient descent regularization parameter learning rate gradually reduced epoch. number epoch mini-batch data using image patch used size image patch since convolution ﬁlters spatially invariant ﬁlters inferencing stage. case input size table give average psnr values u-net variants applied sparse view different projection views. methods offer signiﬁcant gain fbp. among three types u-net variants tight frame u-net produced best psnr values followed standard u-net. however restrict within body area removing background patient tight frame u-net best followed dualframe u-net. also interesting dual frame unet best downsampling factor. implies proposed u-net variants provide quantitatively better reconstruction quality standard u-net. addition visual inspection provides advantages u-net variants. speciﬁcally fig. compares reconstruction results original dual-frame tight-frame unets. shown enlarged images difference images u-net produces blurred edge images many areas dual-frame tight-frame u-nets enhance high frequency characteristics images. despite fig. reconstruction results original dual-frame tight frame u-nets various sparse view reconstruction. yellow green boxes illustrate enlarged view difference images respectively. number written images nmse value. fig. reconstruction follows method proposed tight-frame u-net. yellow green boxes illustrate enlarged view difference images respectively. number written images nmse value. psnr values case. however tight-frame u-net provides better average psnr values minimum nmse values also improved visual quality standard u-net. thus tight frame u-net experiments. proposed method. hand method provide accurate reconstruction. fig. shows reconstruction results coronal sagittal directions. accurate reconstruction obtained using proposed method. moreover compared method proposed results fig. fig. provides signiﬁcantly improved image reconstruction results much smaller nmse values. average psnr ssim values table also conﬁrm proposed tight frame u-net consistently outperforms method view down-sampling factors. hand computational time proposed method ms/slice sec/slice respectively approach took sec/slice reconstruction. implies proposed method times faster approach signiﬁcantly better reconstruction performance. next investigated importance multi-scale network. baseline network single-scale residual learning network without pooling unpooling layers shown fig. used. similar proposed method streaking artifact images used labels. fair comparison number network parameters similar proposed method ﬁxing number channels layer across stages. fig. image reconstruction quality nmse values provided tight-frame u-net much improved compared single resolution network. fig. coronal sagittal views reconstruction method according method proposed tight-frame u-net. yellow green boxes illustrate enlarged viewand difference pictures. number written images nmse value. denote reconstructed images measured sinogram projection matrix. regularization parameter chosen trial error best traderesolution nmse values resulting value method solved alternating direction method multipliers optimizer number projection views decreases observed number iterations gradually increase; algorithm converge number views respectively. results fig. clearly showed proposed network removes streaking artifact patterns preserves detailed structures underlying images. magniﬁed difference views fig. conﬁrmed detailed structures well reconstructed using fig. coronal sagittal views reconstruction method according method proposed tight-frame u-net. yellow green boxes illustrate magniﬁed view difference images. number written images nmse value. average psnr ssim values table show single scale network consistently inferior tight-frame u-net view down-sampling factors. smaller receptive ﬁeld single resolution network difﬁcult correct globally distributed streaking artifacts. fig. shows average psnr values tightframe u-net various view downsampling factors. here compared three distinct training strategies. first tightframe u-net trained reconstruction using projection views. second network trained using reconstruction views. proposed network trained using reconstruction views. shown fig. ﬁrst networks provide competitive performance projection views respectively. however combined training offered best reconstruction across wide ranges view down-sampling. therefore make network suitable down-sampling factors trained network using data projection views simultaneously. challenge penalized least squares non-local means penalty aapm-net winners ﬁrst second place respectively. however task aapm challenge reduce noises tubecurrent modulated low-dose rather sparse-view demonstrate dedicated network necessary sparse-view conducted comparative study sparse-view using winning algorithms aapm challenge. fair comparison re-trained aapm-net sparse-view data optimal hyper-parameters penalized least squares non-local means penalty determined trial error. fig. shows reconstructed images non-local means aapm-net proposed tight-frame u-net view full-dose input images. since non-local means algorithm aapm-net designed remove noises tube-current modulated low-dose applications results blurring artifacts. also investigated lesion detection capability algorithms. aapm challenge quarter-dose images lesions. therefore generated projection data quarter-dose images algorithm tested removing streaking artifacts view projection data. shown figs. non-local means algorithm aapm-net good detecting lesions streaking artifacts whereas lesion region clearly detected using proposed method. byproduct proposed tight-frame u-net successfully removes low-dose noise offers clear images. fig. reconstruction results non-local means aapm-net proposed tight-frame u-net. view full-dose data view quarter-dose data. yellow green boxes illustrate enlarged view difference images respectively. boxes indicate lesion region. number written images nmse value. paper showed large receptive ﬁeld network architecture multi-scale network essential sparse view reconstruction globally distributed streaking artifacts. based recent theory deep convolutional framelets showed existing u-net architecture meet frame condition. resulting disadvantage often found blurry false image artifacts. overcome limitations proposed dual frame u-net tight frame u-net. dual frame u-net designed meet frame condition resulting modiﬁcation intuitive extra skipped connection. tight frame u-net wavelets additional path needed process subband signals. extra path allows improved noise robustness directional information process adapted image statistics. using extensive experiments showed authors would like thanks cynthia macollough mayo clinic american association physicists medicine grant national institute biomedical imaging bioengineering providing low-dose grand challenge data set. work supported korea science engineering foundation grant number nrf-rab. authors would like thank kyungsang providing code x.-j. shen y.-b. yang image denoising using deep fully convolutional encoder-decoder networks symmetric skip connections arxiv preprint arxiv. deep convolutional framelets general deep learning framework inverse problems siam journal imaging sciences also available arxiv preprint arxiv. daubechies tale bases localnonlocal regularization image patches convolution framelets siam journal imaging sciences vol. compressive sampling using annihilating ﬁlter-based low-rank interpolation ieee transactions information theory vol. feb. reference-free single-pass nyquist ghost correction using annihilating ﬁlter-based rank hankel matrix magnetic resonance medicine vol. december j.-y. s.-h. park artifact correction using sparse+ low-rank decomposition annihilating ﬁlterbased hankel matrix magnetic resonance medicine vol. worstell ouyang rakvongthai fakhri sparse-view spectral reconstruction using spectral patch-based low-rank penalty ieee transactions medical imaging vol. szczykutowicz g.-h. chen dual energy using slow switching acquisition prior image constrained compressed sensing physics medicine biology vol. ronneberger fischer brox u-net convolutional networks biomedical image segmentation international conference medical image computing computer-assisted intervention. springer caballero husz´ar totz aitken bishop rueckert wang real-time single image video superresolution using efﬁcient sub-pixel convolutional neural network proceedings ieee conference computer vision pattern recognition kang wavelet domain residual network low-dose x-ray reconstruction international meeting fully three-dimensional image reconstruction radiology nuclear medicine w¨urﬂ ghesu christlein maier deep learning computed tomography international conference medical image computing computer-assisted intervention. springer chen pock learning optimized reaction diffusion processes effective image restoration proceedings ieee conference computer vision pattern recognition", "year": 2017}