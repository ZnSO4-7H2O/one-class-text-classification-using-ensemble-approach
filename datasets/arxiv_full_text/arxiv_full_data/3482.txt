{"title": "Large Margin Learning in Set to Set Similarity Comparison for Person  Re-identification", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Person re-identification (Re-ID) aims at matching images of the same person across disjoint camera views, which is a challenging problem in multimedia analysis, multimedia editing and content-based media retrieval communities. The major challenge lies in how to preserve similarity of the same person across video footages with large appearance variations, while discriminating different individuals. To address this problem, conventional methods usually consider the pairwise similarity between persons by only measuring the point to point (P2P) distance. In this paper, we propose to use deep learning technique to model a novel set to set (S2S) distance, in which the underline objective focuses on preserving the compactness of intra-class samples for each camera view, while maximizing the margin between the intra-class set and inter-class set. The S2S distance metric is consisted of three terms, namely the class-identity term, the relative distance term and the regularization term. The class-identity term keeps the intra-class samples within each camera view gathering together, the relative distance term maximizes the distance between the intra-class class set and inter-class set across different camera views, and the regularization term smoothness the parameters of deep convolutional neural network (CNN). As a result, the final learned deep model can effectively find out the matched target to the probe object among various candidates in the video gallery by learning discriminative and stable feature representations. Using the CUHK01, CUHK03, PRID2011 and Market1501 benchmark datasets, we extensively conducted comparative evaluations to demonstrate the advantages of our method over the state-of-the-art approaches.", "text": "fig. challenges person re-identiﬁcation public space blue bounding boxes denote training samples camera orange bounding boxes denote training samples camera existing person re-id works broadly grouped following lines developing robust feature representation handle variations persons’ appearance designing discriminative distance metrics measure similarity intra/inter-class image distance. ﬁrst category different cues adopted extract stable discriminative features representative works including local binary pattern ensemble local feature local maximal occurrence second category labeled images used train distance metric intra-class distance minimized inter-class distance maximized. typical metric learning methods include locally adaptive decision function large margin nearest neighbor information theoretic metric learning since lines works regard feature extraction metric learning processes disjoint steps performance limited. deep convolutional neural network based methods becoming popular solving person re-id problem although methods usually consist major components analogue traditional person re-id literature i.e. deep extract appearance feature similarity measure enforce learned feature similar/dissimilar intra/interclass samples incorporating feature extraction step metric learning step integrated framework deep based method exhibits signiﬁcantly improved abstract—person re-identiﬁcation aims matching images person across disjoint camera views challenging problem multimedia analysis multimedia editing content-based media retrieval communities. major challenge lies preserve similarity person across video footages large appearance variations discriminating different individuals. address problem conventional methods usually consider pairwise similarity persons measuring point point distance. paper propose deep learning technique model novel distance underline objective focuses preserving compactness intra-class samples camera view maximizing margin intra-class inter-class set. distance metric consisted three terms namely class-identity term relative distance term regularization term. classidentity term keeps intra-class samples within camera view gathering together relative distance term maximizes distance intra-class class inter-class across different camera views regularization term smoothness parameters deep convolutional neural network result ﬁnal learned deep model effectively matched target probe object among various candidates video gallery learning discriminative stable feature representations. using cuhk cuhk prid market benchmark datasets extensively conducted comparative evaluations demonstrate advantages method state-of-the-art approaches. person re-identiﬁcation aims matching stated person among various candidates disjoint camera views person re-id technology many advanced multimedia applications person association multi-target tracking behavior analysis theses tasks appearance object usually possesses large variations background clutter lighting condition view angle mutual occlusion shown fig. challenges made person re-id difﬁcult problem attracted attention researchers computer vision. improve identiﬁcation performance learn discriminative stable feature representation describe appearance person difference intra/inter-class distance maximized. sanping zhou jinjun wang qiqi yihong gong nanning zheng institute artiﬁcial intelligence robotics xi’an jiaotong university xi’an shaanxi china. despite progress achieved deep learning based methods observed lacking labeled training data usually limits generalization ability practical person re-id applications. situation motivated focus following aspects improve generalization ability person re-id system deep loss function incorporate additional prior knowledge efﬁcient training. paper propose novel distance metric supervise trained learn discriminative robust appearance feature based amount training data. speciﬁcally ﬁrst build part-based extract image feature different body parts separately modeled lower convolutional layers fused higher fully connected layers. resulting feature representations loss layer focuses preserving compactness intra-class samples camera view maximizing margin intra-class inter-class set. method naturally incorporates feature extraction metric learning joint framework. considering similarity proposed model extract features robust appearance variations evidenced improved person re-id performance several public benchmark datasets. novel part-based extract discriminative stable features body appearance. constitutes global sub-network local sub-network fusion sub-network. global local feature representations ﬁrstly extracted global sub-network local sub-network respectively fused fusion sub-network. also make deep residual neural network construct part-based cnn. novel loss layer similarity comparison. preserves compactness intra-class samples keeps large margin intra-class interclass training samples maximizing relative distance samples margins intra-class inter-class set. extensive comparative experiments evaluate various aspects method four benchmark datasets including cuhk cuhk prid market. ﬁnal evaluation results show method outperforms state-of-the-art person re-id methods large margin. rest paper organized follows. section brieﬂy review related works. section introduces deep feature learning fusion network distance metric followed discussion learning algorithm section experimental results parameter analysis presented section conclusion comes section past years works closely related solving person re-id problem organized four classes namely feature learning based method metric learning based method deep learning based method set-based classiﬁcation method. following paragraphs respectively introduce works. feature learning based method line works mainly focus developing robust feature representations invariant view angles lighting conditions body poses background variations. examples zhao learned mid-level ﬁlter patch cluster achieve cross view invariance. liao constructed feature descriptor analyzed horizontal occurrence local features maximized occurrence make robust representation viewpoint changes. presented person image covariance descriptor robust illumination changes background variations. farenzena augmented maximally stable color regions histograms person representation. zhao learned distinct salience feature distinguish matched person others. chen employed pre-learned pictorial structure model localize body parts accurately. introduced viewpoint-invariant descriptor took viewpoint human account using called pose prior learned training data. kviatkovsky investigated intradistribution structure color descriptor invariant certain illumination changes. matched person images observed different camera views complex cross-view transformation applied person re-id. methods improve performance person re-id developing ﬁxed robust feature descriptor however adaptive feature learning addressed methods. metric learning based method metric learning based methods mapping function feature space distance space feature vectors person closer different ones example zheng proposed relative distance learning method probabilistic prospective. mignon learned distance metric sparse pairwise similarity constraints. pedagadi utilized local fisher discriminant analysis high dimensional features discriminative dimensional space. xiong extended lfda several metric learning methods using kernel tricks different regularizers. nguyen measured similarity face pairs cosine similarity closely related inner product similarity. casted person re-id problem image retrieval task considering listwise similarity. chen proposed kernel based metric learning method explore nonlinearity relationship samples feature space. hirzer learned discriminative metric using relaxed pairwise constraints. prosser developed ranking model using support vector machine. methods learn speciﬁc distance metric mainly based feature representation extracted several ﬁxed feature descriptors inﬂuence performance metric learning. deep learning based method deep learning based methods incorporate feature extraction metric learning integrated framework adaptive feature representations learned supervision certain similarity metric. example proposed novel filter pairing neural network model body part displacements using patch matching layers match ﬁlter responses local patches across camera views. ahmed proposed improved deep neural network took pairwise images inputs output similarity value indicating whether input images depict person not. xiao proposed domain guided dropout algorithm improve performance deep extract robust feature representation person re-id. constructed siamese neural network learn pairwise similarity used body parts train model. ding applied triplet loss train deep neural network person re-id. wang proposed uniﬁed triplet siamese deep architecture could jointly extract singleimage cross-image feature representations. zhao proposed local patch matching method used learned mid-level ﬁlters local discriminative features person re-id. zhang incorporated deep hash learning triplet formulation person re-id. chen proposed uniﬁed deep ranking model feature extraction metric learning handled joint deep learning framework. methods feature extraction metric learning incorporated joint framework mainly based general deep alexnet without using effective part strategy inappropriate person re-id. set-based classiﬁcation methods exploring relationship well handle intra-class inter-class appearance variations. different conventional point-based methods model intra-class inter-class appearance variations considering point point distance. example zhou proposed point distance metric measures similarity anchor point corresponding positive negative person reid. extended distance metric distance metric incorporated standard support vector machine. proposed novel image based collaborative representation classiﬁcation method modeling query convex regularized hull face recognition. wang measured manifold manifold distance applied face recognition based image set. proposed set-based discriminative ranking method deal person re-id face recognition problem. yang regularized nearest points image based face recognition. regarded spectrally similar pixels within homogeneous samples proposed novel setbased spectral-spatial classiﬁcation method hyper spectral images. proposed multi-manifold deep metric learning method image classiﬁcation could recognize object image instances varying viewpoints illuminations. mian proposed self-regularized nonnegative coding deﬁne distance measuring nearest points robust face recognition. methods usually deﬁne kind setbased distance traditional metric learning methods wide combination popular deep learning methods. order incorporate feature learning fusion end-to-end framework introduce novel part-based deep extract discriminative robust feature representation object shown fig. given training samples task simultaneously compute compactness intra-class samples maximize margin intra-class inter-class across different camera views. global sub-network ﬁrst part neural network global sub-network consists convolutional layer pooling layer. designed bridge low-level features input images provide multi-level feature representations discriminately learned following local sub-network. input images size ﬁrstly passed learned ﬁlters size then resulting feature maps passed pooling kernel size stride finally feature maps passed rectiﬁed linear unit local sub-network second part neural network local sub-network consisted four teams convolutional layers pooling layers. ﬁrstly divide input feature maps four equal horizontal patches across height channel introduces local feature maps different body parts. then pass local feature maps convolutional layers learned ﬁlters size afterwards outputs ﬁrst local convolutional neural network summarized outputs second local convolutional neural network using eltwise operation. resulting feature maps passed pooling kernels size stride finally rectiﬁed linear unit pooling layers. order learn feature representations different body parts discriminatively share parameters among four teams convolutional neural layers. fusion sub-network third part neural network fusion sub-network consisted four teams fully connected layers. firstly local feature maps different body parts discriminatively learned concatenating fully connected layers team. dimension fully connected layers rectiﬁed linear unit added fully connected layers. then fig. deep feature extraction fusion neural network. architecture comprised three sub-networks global sub-network local sub-network fusion sub-network. global sub-network local sub-network convolutional layers max-pooling layers extract global local feature representations object. fusion sub-network uses fully connected layers generate ﬁnal combined feature representations body parts well entire body. finally resulting features loss layer similarity comparison keeping compactness intra-class samples camera view maximizing large relative margin intra-class inter-class set. metric consisted three terms namely class-identity term relative distance term regularization term formulated follows class-identity term denotes relative distance term represents regularization term constant weight parameters. training process class-identity term keeps compactness intraclass training samples camera view relative distance term maximizes distance intra-class inter-class regularization term smoothes parameters deep cnn. class-identity term order strengthen compactness intra-class samples camera view assume gathered together training process. therefore hinge-like loss class-identity term formulated follows normalization factor denotes class center constant margin parameter. result feature representations intra-class training samples camera view gathered together therefore compactness samples held. relative distance term goal relative distance term maximize relative distance intraclass inter-class set. considering fact unambiguous deﬁnition distance formulate relative distance term follows discriminatively learned local feature representations ﬁrst four fully connected layers concated summarized adding another fully connected layers whose dimension finally resulting feature representation concated outputs second four fully connected layers generate ﬁnal dimensional feature representations. similarly share parameters among four fully connected layers keep discriminative feature representations different body parts. input training samples denotes number different persons {xij| denotes ﬁlter weights layer refers corresponding biases denotes convolution operation element-wise non-linear activation function relu represents feature maps generated layer sample similarity simplify parameters neural network whole deﬁne {w··· {b··· although proposed algorithm handle multiple camera views present discussion within camera views situation assume number images every person camera views simplicity. fig. illustration metric. samples different camera views denoted different colors different identities denoted different shapes. specially shows optimization goal method namely maintaining compactness intra-class samples camera view maximizing large margin intra-class inter-class across different camera views; deﬁnes distance distance metric including choose marginal samples hard negative set; represents ﬁnal feature distributions training samples feature space. considering fact optimization marginal samples using pairwise term easily lead network fall plateau propose triplet distance term built avoid kind over-ﬁtting problem randomly sampling anchor positive negative samples training image sets. formulated symmetric triplet formulation follows normalization factor constant margin parameter denotes relative distance positive pair corresponding negative pair. relative distance deﬁned follows adaptively learned weights denote negative positive indicator matrix. given anchor class camera view indicate randomly chosen negative candidates positive candidates camera view respectively. deﬁned follows fig. comparison conventional triplet formulation symmetric triplet formulation. specially shows gradient training sample triplet unit denote three basic denotes triplet distance term designed keep stability deep randomly choosing samples image sets symmetric triplet formulation; represents pairwise distance term used boost ranking performance deep adaptively choosing training samples margins image pairwise formulation; constant weight parameter. deﬁnition-symmetric triplet given triplet trainin}n samples denotes negative pair. positive pair conventional triplet formulation maximizes large relative using margin symmetric triplet formulation satisfy max{m gradient back-propagation method optimize parameters deep carried mini-batch pattern. therefore need calculate gradients loss function respect features corresponding layers. simplicity consider parameters network whole deﬁne three terms denote gradient class-identity term relative distance term regularization term respectively. gradient back-propagation class-identity term formulated follows gradient back-propagation proposed relative distance term consisted parts denotes gradient triplet distance term represents gradient marginal pairwise distance term. similarly deﬁne therefore gradient triplet term formulated conventional pairwise formulation deﬁned follows normalization factor parameters used deﬁne down-margin upper-margin. particular denotes down-margin represents up-margin. given identities indicator matrix refers correspondence image camera image camera deﬁned follows means image identity camera view referred person image identity camera view means opposite. given class camera view respectively denote farthest positive nearest negative candidate sets camera view shown fig. given marginal sample camera view represent positive negative candidate images located margin image camera view image camera view respectively. distance metric keep compactness intra-class samples camera view also maximize large relative margin intra-class inter-class across different camera views. therefore given probe image learned deep model easily matched candidate gallery ranking distances testing process. training samples learning rate maximum iterations initialization weight parameters updating rate margin parameters mcmtcp weight parameters output described above weights adaptively learned training process update using gradient back-propagation method. order simplify problem deﬁne therefore updated updating partial derivative triplet distance term respect formulated follows updating rate. clearly seen namely decreased increased; vice verse. result strength back-propagation sample triplet unit adaptively tuned accordingly anchor positive clustered negative away hyper-line expanded anchor positive. fig. illustration evaluate method. query image test probe compute pairwise distance candidates test gallery set. distances ranked corrected matches. pairwise triplet units. algorithm needs images sets accumulate gradients iteration call gradient descent algorithm. show overall process algorithm cuhk dataset contains persons captured camera views campus environment images person every camera view. utilized protocol person images used training rest testing. market dataset contains images persons. person captured least cameras most. used provided training/testing partition under single-query multi-query evaluation settings parameters used paper obtained based performance cuhk dataset achieve better results choosing suitable parameters using cross validation method. protocol dataset separated training testing images person appear either set. testing divided probe gallery sets contained images person different views. result evaluated cumulatively matching characteristic curve estimation ﬁnding corrected math match shown fig. ﬁnal performance averaged experiment attempts. comparison results compared results method several state-of-the-art works four benchmark datasets speciﬁcally kissme ladf klfda scsp cdvm lmnn idla fpnn lomo+xqda lsscdl order analyze ingredient contributes ﬁnal performance improvement report results method aspects evaluate performance method proposed point point constraint class-identity term pairwise term method therefore information remained method; reveal constraint contributes performance improvement report ﬁnal performance jointly using class-identity term triplet term pairwise term method. report detailed comparison results four datasets table table tables second best performance highlighted blue best performance red. cuhk dataset compared methods traditional methods deep learning based methods results shown table results that methods outperformed deep learning based methods idla cdvm particular methods outperformed cdvm method accuracy respectively. addition considering information method outperformed method accuracy method achieved best performance comparison groups compared previous best method cdvm method scored lower accuracy method outperformed shows beneﬁt information gives improvement metric accuracy. prid dataset specially designed video based person re-id however video information method therefore could compare method state-of-the-art methods multi-shot setting comparison results shown table method second best performance method achieved best performance categories compared previous best method proposed methods outperformed signiﬁcantly accuracy respectively. addition method method accuracy incorporating information relative distance term. market dataset large scale dataset person re-id. best existing performance achieved conventional method. show comparison results table evaluated performance using curve value single-query multi-query evaluation settings respectively. compared best existing method ldns proposed methods outperformed accuracy single-query setting accuracy multi-query setting respectively. addition method method accuracy single-query multi-query evaluation settings respectively. evaluation second best performance achieved method compared existing methods method outperformed method analysis obtain insight methods typical ranking examples four benchmark datasets shown fig. speciﬁcally green rectangle denotes query image probe rectangle represents matched candidate gallery set. dataset give comparison ranking results methods i.e. method result method ﬁrst second respectively. according results method robust method dealing appearance variations caused view angle body pose mutual occlusion light condition. importantly method effectively select matched candidate compared method cuhk dataset matter view angle changes gallery set. side none methods distinguish image details. example method ranks person wearing yellow pant correct candidate light blue hand prid dataset method ranks people wearing green short similar candidates white dress market dataset. considering fact deep perform salient information detection none methods recognize subtle differences targets. future work strive optimal saliency detection modular framework deep boost ranking performance alleviating inﬂuence details. emperically margin parameters mcmtcpmp weight parameters direction control parameters major effects ﬁnal ranking performance method. following paragraphs give experimental analysis method cuhk dataset changing parameter time study inﬂuence. inﬂuence margin parameters mcmtcpmp shown fig. method achieved best performance setting derive following three conclusions parameter signiﬁcant intra-class difference camera view small. according experience could experiments. parameters cpmp small down-margin lead over-ﬁtting problem large upper-margin cause numerical stability issue. similarly large also lead numerical stability problem small make positive negative candidates less distinguishable distance space. weight parameters inﬂuence ﬁnal results shown fig. method achieved best performance setting results little inﬂuence ﬁnal ranking performance. analysis show since intraclass difference individuals camera view signiﬁcant smaller inter-class clustered together even small contrary sensitive parameter greater value lead overﬁtting problem smaller value cause information missing method. different conventional triplet formulation used person re-id symmetric triplet framework introduces weighed negative distance term optimize backpropagation pattern sample triplet unit. therefore conventional triplet formulation special case symmetric triplet formulation setting method. comparison results reported table show that symmetric triplet framework outperforms conventional accuracy four datasets respectively. beneﬁt weight updating strategy initial values subtle impact ﬁnal performance. accuracy falls setting four datasets respectively. paper propose novel person re-identiﬁcation method similarity comparison deep framework perform integrated feature learning fusion. deep neural network learns global features local features fused features global sub-network local sub-network fusion sub-network respectively. distance metric jointly keep compactness intraclass samples camera view maximize relative distance intra-class inter-class across different camera views back-propagate gradients optimize parameters deep cnn. result learned deep ranking model effectively distinguish different persons learning discriminative robust feature representations. extensive experimental fig. curves cuhk dataset varying margin parameters shows matching results varying setting shows matching results varying setting shows matching results varying setting liang wang leng xiao chen person re-identiﬁcation ranking aggregation similarity pulling dissimilarity pushing ieee transactions multimedia vol. morris trivedi survey vision-based trajectory learning analysis surveillance circuits systems video technology ieee transactions vol. zhang wang wang gong multi-target tracking trajectory models pattern recognition chang liang huang smith learning locally-adaptive decision functions person veriﬁcation proceedings ieee conference computer vision pattern recognition zhang zhang zhang bit-scalable deep hashing regularized similarity learning image retrieval person re-identiﬁcation ieee transactions image processing vol. liao person re-identiﬁcation local maximal occurrence representation metric learning ieee conference computer vision pattern recognition june fig. ranking results four benchmark datasets single-shot setting person green rectangle denotes query image person rectangle represents matched candidate. zhang c.-k. shiu zhang image set-based collaborative representation face recognition ieee transactions information forensics security vol. wang shan chen manifold-manifold distance application face recognition based image computer vision pattern recognition cvpr ieee conference fang bruzzone benediktsson set-to-set distance-based spectral–spatial classiﬁcation hyperspectral images ieee transactions geoscience remote sensing vol. wang deng moulin zhou multi-manifold deep metric learning image classiﬁcation proceedings ieee conference computer vision pattern recognition mian hartley owens image based face recognition using self-regularized non-negative coding adaptive distance metric learning ieee transactions image processing vol. zhang delving deep rectiﬁers surpassing human-level performance imagenet classiﬁcation proceedings ieee international conference computer vision hirzer beleznai roth bischof person reidentiﬁcation descriptive discriminative classiﬁcation scandinavian conference image analysis. springer gray brennan evaluating appearance models recognition reacquisition tracking proc. ieee international workshop performance evaluation tracking surveillance vol. citeseer paisitkriangkrai shen hengel learning rank person re-identiﬁcation metric ensembles proceedings ieee conference computer vision pattern recognition chen yuan chen zheng similarity learning spatial constraints person re-identiﬁcation ieee conference computer vision pattern recognition june farenzena bazzani perina murino cristani person re-identiﬁcation symmetry-driven accumulation local features computer vision pattern recognition ieee conference invariant human reidentiﬁcation camera networks using pose priors subjectdiscriminative features pattern analysis machine intelligence ieee transactions vol. koestinger hirzer wohlhart roth bischof large scale metric learning equivalence constraints computer vision pattern recognition ieee conference ieee w.-s. zheng gong xiang person re-identiﬁcation probabilistic relative distance comparison computer vision pattern recognition ieee conference ieee pedagadi orwell velastin boghossian local ﬁsher discriminant analysis pedestrian re-identiﬁcation computer vision pattern recognition ieee conference ieee chen yuan zheng wang similarity learning explicit polynomial kernel feature person reidentiﬁcation proceedings ieee conference computer vision pattern recognition xiao ouyang wang learning deep feature representations domain guided dropout person re-identiﬁcation ieee conference computer vision pattern recognition june", "year": 2017}