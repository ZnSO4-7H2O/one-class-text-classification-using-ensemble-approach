{"title": "Pattern Decomposition with Complex Combinatorial Constraints:  Application to Materials Discovery", "tag": ["cs.AI", "cs.LG", "stat.ML"], "abstract": "Identifying important components or factors in large amounts of noisy data is a key problem in machine learning and data mining. Motivated by a pattern decomposition problem in materials discovery, aimed at discovering new materials for renewable energy, e.g. for fuel and solar cells, we introduce CombiFD, a framework for factor based pattern decomposition that allows the incorporation of a-priori knowledge as constraints, including complex combinatorial constraints. In addition, we propose a new pattern decomposition algorithm, called AMIQO, based on solving a sequence of (mixed-integer) quadratic programs. Our approach considerably outperforms the state of the art on the materials discovery problem, scaling to larger datasets and recovering more precise and physically meaningful decompositions. We also show the effectiveness of our approach for enforcing background knowledge on other application domains.", "text": "identifying important components factors large amounts noisy data problem machine learning data mining. motivated pattern decomposition problem materials discovery aimed discovering materials renewable energy e.g. fuel solar cells introduce combifd framework factor based pattern decomposition allows incorporation a-priori knowledge constraints including complex combinatorial constraints. addition propose pattern decomposition algorithm called amiqo based solving sequence quadratic programs. approach considerably outperforms state materials discovery problem scaling larger datasets recovering precise physically meaningful decompositions. also show effectiveness approach enforcing background knowledge application domains. recent years seen enormous growth data generation rates many ﬁelds science instance combinatorial materials discovery scientists search materials desirable properties obtaining measurements hundreds samples single batch experiment using composition spread technique providing computational tools automatically analyzing determining structure materials formed composition spread important exciting direction emerging ﬁeld computational sustainability example approach successfully applied speed discovery materials improved catalytic activity fuel cell applications oxygen evolution catalysts applications solar fuel generation long-term solutions several sustainability issues energy transportation likely come copyright association advancement artiﬁcial intelligence rights reserved. accelerate discovery materials materials scientists developed high-throughput experimental procedures create composition-spread libraries materials process intuitively understood generating enormous number compounds single experiment mixing different amounts small number basic elements promising libraries characterized using x-ray diffraction determine underlying crystal structure composition. speciﬁcally x-ray diffraction signals sampled different material compositions corresponding different mixture basic elements. problem materials discovery called phase identiﬁcation problem deﬁned ﬁnding basic phases x-ray measurements explained mixture basic phases. decomposition subject physical constraints govern underlying crystallographic process. phase identiﬁcation effectively source separation spectral unmixing problem sources non-negative basic x-ray diffraction signals observation non-negative combination sources. therefore standard approach literature non-negative matrix factorization nevertheless approach overlooks physical constraints crystal formation. example guarantee connectivity phase regions phase handle basis patterns slightly changing crystal lattice constants change. recent development enforcing constraints shown resilient peak shifting example. obtain physically meaningful decompositions researchers looked constraint programming formulations incorporate necessary constraints. side approaches fully discrete cannot directly deal continuous measurement data. side spectrum respect unsupervised nature lost scalability becomes issue example fully discrete problem notion gradient anymore. addition approaches robust presence noise data noise considerably impacts efﬁciency ﬁltering propagation mechanisms. work achieve best worlds bridging previous approaches providing hybrid formulation integrate additional domain knowledge additional constraints basic approach. introduce combifd novel pattern decomposition framework allows speciﬁcation general constraints. include constraints used matrix factorization clustering approaches well general ones require richer representation language powerful enough capture complex combinatorial dependencies. example show encode complex a-priori scientiﬁc domain knowledge specifying combinatorial dependencies variables imposed physical laws. also propose novel solution technique called amiqo involves solution sequence quadratic programs. overall constrained factorization algorithm clearly outperforms previous approaches scales large real world datasets recovers physically meaningful signiﬁcantly accurate interpretations data prior knowledge taken account. given data points represented mdimensional vector real-valued features represent input data compactly matrix rm×n column corresponding data point feature. context phase identiﬁcation corresponds observed x-ray diffraction patterns vector scattering intensity values. interested low-dimensional representations approximate input data identifying essential components factors. namely given number basic phases want approximate rm×k represents basic phases rk×n combination coefﬁcients data point. problem belongs family low-rank approximation problems important research theme machine learning data mining numerous applications including source separation denoising compression dimensionality reduction low-rank approximation given non-negative matrix rm×n desired rank seek matrices rm×k rk×n give best rank approximation i.e. typically formulated basic problem solved so-called truncated singular value decomposition approach produces best approximation terms squared distance. computed efﬁciently robustly obtaining representation data points interpreted linear combinations small number basis vectors. many applications input data non-negative instance representing color intensities word counts x-ray scattering intensities motivating application. basis vectors computed however generally guaranteed non-negative leads undesirable lack interpretability. example possible interpret image superposition simpler patches x-ray diffraction pattern composition several basic compounds obtaining negative values basis vectors coefﬁcients. overcome limitation researchers introduced approach explicitly enforces nonnegativity constraints basis vectors coefﬁcients. non-negativity common constraint many domains applications additional valuable priori information features instance might also know priori upper bound value features boolean features incompatible non-negativity holds subset features. particular materials science domain basis vectors correspond chemical compounds underlying crystal structures. chemical systems thermodynamic equilibrium compositional variation concentration lattice parameters compound follow well-deﬁned rules constraints coexistence variation basis patterns deﬁned constraints non-negativity individually enforced approaches others connectivity complex rules deﬁning shifting basis patterns considered before. best knowledge general factor analysis framework handle combination constraints. motivates deﬁnition following general pattern decomposition subject combinatorial constraints problem. combifd pattern decomposition combinatorial constraints given matrix rm×n desired rank seek matrices rm×k rk×n minimize h||p entry-wise norm moreover factors need satisfy additional linear inequality constraints possibly requiring binary integer variables. formalized related work many rank approximation schemes available including decomposition independent component analysis truncated singular value decomposition nonnegative matrix factorization basic methods unsupervised growing interest incorporating prior knowledge user guidance frameworks example semi-supervised clustering applications user guidance often given partial labeling information incorporated using hard constraints typical constraints used case must-link cannot-link enforcing data points must cannot cluster respectively. example present integrated framework clustering non-homogenous data show turn must-link cannot-link constraints dependent disparate clustering problems. recently researchers also considered interactive matrix factorization schemes topic modeling take account user feedback quality decomposition semi-supervised label information constraints constraint clustering another example approach. alternatively regularizations penalty terms also used obtain solutions certain desired properties sparsity convexity temporal structural properties shift invariances work literature however conﬁned single type constraints simple conjunctions limits usability. combifd propose approach ﬁnding dimensional approximation data able incorporate existing types constraints also complex logical combinations. solving general combifd optimization problem challenging reasons. first objective function convex hence minimization difﬁcult even presence simple non-negativity constraints second allowing expressive class constraints potentially specify complex intricate dependencies among variables. unfortunately general nonconvex mixed-integer non-linear programming seen much progress linear quadratic counterparts approaches either application speciﬁc scale well. even presence simple constraints problem rarely solved optimality practice heuristic approaches used. simple heuristic approaches multiplicative update rules widely used algorithms apply case integer variables. similarly projected gradient techniques cannot directly applied vector additional real-valued variables vector binary variables denotes vectorization linear inequalities involving entries coefﬁcients given right-hand side given integer linear programming well known np-complete general constraints encoded appropriately choosing additional constrains extremely useful encode prior knowledge might domain. include non-negativity upper bounds sparsity semi-supervised clustering well many others. examples intricate constraints found experimental section below. example sparsity suppose want explicitly formulate sparsity constraint coefﬁcient matrix. want column non-zero entries i.e. ||hi|| i-th column instance topic modeling application basis vectors correspond topics constraint ensures document topics. encoded follows example semi-supervised clustering example semi-supervised clustering problem easily include partial labeling information constraints e.g. enforcing must-link cannot-link constraints suppose prior information pairs data points {··· known belong cluster pairs data points {··· known belong cluster encode prior knowledge combifd framework follows biis bijs biis bijs thereofore introduce approximate technique called amiqo exploits special structure problem takes full advantage advanced miqp optimization techniques literature. solve general combifd optimization problem introduce amiqo pseudocode reported algorithm amiqo iterative two-block coordinate descent procedure enhanced sophisticated combinatorial optimization techniques beyond standard convex optimization methods. fact advantage combifd framework either ﬁxed problem mixedinteger quadratic program. mixed-integer quadratic programs widely studied operations research literature leverage wide range techniques developed implemented stateof-the-art mixed-integer quadratic programming solvers cplex. integer programs solved optimality sufﬁcient improve objective function respect factorization found previous step notice binary variables optimization problems inner loop amiqo correspond standard quadratic programs solved efﬁciently even presence constraints form general non-negativity. amiqo inspired seminal work paatero tapper initially proposed block coordinate descent procedure later followed upon number researchers including unconstrained least squares version solution techniques based projected gradient descent quasi-newton active-set however approach novel uses mixed integer solver coordinate descent step take account combinatorial constraints guaranteeing feasibility solution every iteration even presence intricate combinatorial constraints. although objective function monotonically nonincreasing amiqo guaranteed converge global minimum. consistent hardness problem speciﬁcally quality ﬁnal solution found might depend initialization issue common standard matrix factorization algorithms several heuristic initialization schemes proposed mitigate issue nevertheless experimental evaluation initialization play major role typically converged solution regardless initial conditions. order show generality approach provide experimental results three application domains increasingly complex constraints capturing a-priori domain knowledge. start semi-supervised clustering partial labeling information i.e. simple must-link cannot-link constraints. consider another clustering problem include complex logical constraints features describing higher-level biological knowledge. finally consider motivating application phase identiﬁcation problem. clustering partial labeling information become popular approach clustering application domains ranging document clustering graph clustering gene expression data clustering cluster membership determined coefﬁcient matrix reﬂects data point decomposes basis vectors. several ways obtain hard clustering assignments coefﬁcient matrix follow normalize matrix entries interpreted posterior probability data point belongs cluster speciﬁcally diag estimate cluster membership probability result data point assigned cluster argmaxssj. consider semi-supervised clustering task assume prior information labels subset datapoints. speciﬁcally assume information pairs data points either belong cluster information obtained using standard labeled datasets repository ground truth clustering known. generate various amounts prior knowledge randomly select pairs data points using labels specify mustlink cannotlink constraint. compare combifd formulation problem previous approaches literature cnmf nmfs ﬁrst approach based enforcing combinatorial constraints second approach captures constraints using penalty terms modiﬁed objective function approximately minimized using multiplicative updates. report figure accuracy obtained using methods function amount supervision i.e. number must-link cannot-link constraints used. accuracy deﬁned corresponds /n·maxσ |ri∩cσi| bijection mapping clusters ground-truth classes namely cluster assigned label labeling best matches ground truth labels. note accuracy computed efﬁciently using example hungarian algorithm. results averaged runs. combifd signiﬁcantly outperforms competing techniques across levels prior knowledge. intuitively properly taking account combinatorial nature problem combifd automatically make logically sound inferences data example take account transitive closure logical implications. deeper reasoning power greater accuracy provided amiqo however involves small computational overhead typical runtime order couple minutes amiqo versus tens seconds competing techniques. solve clustering problem using combifd approach enforce non-negativity well additional constraints capturing well known biological facts. speciﬁcally enforce following constraints basis vectors using combifd framework hasf eathers haseggs since aware matrix factorization technique take account kind complex logically structured prior knowledge compare standard totally unsupervised technique. table reports accuracy runtime approaches averaged runs. results show combifd approach incorporates limited amount logically structured prior knowledge signiﬁcantly improves accuracy standard still running within seconds using amiqo. spectral unmixing materials discovery ﬁrst present incorporate complex constraints capturing physical laws govern datagenerating process phase identiﬁcation problem. sparsity according so-called gibbs phase rule equilibrium conditions ﬁxed temperature pressure mixtures phases occurring data point library involving basic elements. encoded ||hs|| shifting basis pattern slightly stretched different amount composition sample. indeed chemical alloying within given compound alter crystal lattice constants leading systematic shift peak positions measured x-ray patterns. isotropic lattice expansion signals measured versus scattering vector magnitude peak shifts proportional peak positions corresponding linear stretch signal. therefore basis vectors free constrained shifted versions free basis vectors. encoded follows interpolatei/γ)zq ai/γ)zq) constant shifting granularity interpolate denotes linear interpolation choosing smaller ratio maximum peak shift minimum peak width linear mutually-constrained basis patterns accurately model instance shifting phase pattern. connectivity compositions phase observed form connected region composition space lattice parameters vary smoothly across region. hence build graph vertices edges sample points similar compositions. subgraph induced vertex used). want enforce connected ﬁrst formulation consider based. intuitively ﬂow-based encoding deﬁnes phase pass vertices phase present. source node injects positive network outgoing every vertex phase used. order satisfy conservation path source node belonging phase network. constraint enforces connectivity expensive include miqp formulation large number points. figure results combifd ground truth al-li-fe oxide system. plots corresponds concentration basis pattern size proportional phase concentration estimated point coefﬁcient matrix seen standard overlooks physical constraints e.g. often mixtures basis patterns phase regions disconnected. combifd recovers accurately phases except last one. therefore also consider following variation. triples points straight line composition space every phase enforce constraint min{hv hv}. although constraints strictly enforce connectivity simpler often strong enough solution obtained actually connected. consider synthetic data generated aluminium-lithium-iron oxide system ground truth known. dataset points underlying phases phase diffraction peaks. report fig. data interpretation obtained using regular combifd ground truth. average number iterations amiqo runtimes ranging minutes hours. although cannot recover exactly ground truth solution interpretation obtained considering prior domain knowledge much accurate. example using sparsity constraint violated many sample points. terms evaluation metric adapt previous deﬁnition accuracy case soft cluster assignment reﬂect fact sample point might assigned multiple clusters. namely cσi|/|ri cσi|. note deﬁne maxσ metric explicitly reﬂect amount violated combinatorial constraints would interesting evaluate future work. report results table overall combifd outperforms conﬁrming visual incorporating prior knowledge indeed improves accuracy interpretation. compared previous constraint programming formulation combifd algorithm exhibits much better scalability allowing quickly analyze realistic sized datasets hundreds sample points hours. fact could solutions hours instances one. finally show results obtained combifd real dataset phase unknown system fig. shows excellent match phase basis pattern combifd solution pattern known bivo phase chemical alloying compound form biv−xfexo−x also observed related identiﬁcation phase basis pattern wide composition range library results fig. demonstrate ability combifd identify well-connected phase regions experimental data investigations underway evaluate presence minority phases weak signals composition library. ability integrate complex prior knowledge unsupervised data analysis approaches rich challenging research problem pervasive variety domains scientiﬁc discovery. particular motivating applifigure results obtained combifd phases fe-bi-v oxide system. x-ray diffraction data collected slac national accelerator laboratory. plot left shows patterns phases values center diagrams indicate phase appears. right plot shows phase matches phase literature. cation work discovery fuel cell solar fuel materials thereby addressing pressing issues sustainability need renewable clean energy. introduced combifd novel factor-based pattern decomposition framework signiﬁcantly generalizes extends prior approaches. framework allows speciﬁcation general constraints used specify a-priori domain knowledge factorization sought. include traditional constraints non-negativity well intricate dependencies ones coming known phase behavior chemical systems. introduced general factorization algorithm called amiqo based solving sequence quadratic programs. showed amiqo outperforms state-of-the-art approaches problem materials discovery scales large real world datasets handle complex logically structured prior knowledge including prior knowledge model obtain signiﬁcantly accurate interpretations data. many directions extend work namely concerning representation formalism capture combinatorial constraints good performance/runtime trade-offs well algorithms solve combinatorial optimization problem. infrastructure supported computing research infrastructure computational sustainability grant collaboration energy materials center cornell energy frontier research center funded u.s. department energy ofﬁce science ofﬁce basic energy sciences research conducted cornell high energy synchrotron source supported national institutes health/national institute general medical sciences award dmr. based upon work performed joint center artiﬁcial photosynthesis energy innovation supported ofﬁce science u.s. department energy stanford synchrotron radiation lightsource slac national accelerator laboratory supported u.s. ofﬁce science ofﬁce basic energy sciences contract de-ac-sf. proof proposition proof induction. suppose feasible follows augmented additional constraint still feasible therefore minwxb subject admits optimal solution ˜xj+ ˜bj+. since ˜xj+ ˜bj+ feasible follows augmented additional constraint also feasible. therefore minhxb subject admits optimal solution bj+. also follows feasible finally since optimizing every step follows j||p j||p j+||p. proof theorem initial values seen initial assignment data points clusters data point belongs cluster optimal solution minwb subject choose column centroid data points assigned corresponding cluster iteration i.e. s-th column whose centroid closest data point i.e. setting hs∗i bs∗i mins ||ws ai||. operations exactly correspond k-means clustering initialized hard cluster assignment given", "year": 2014}