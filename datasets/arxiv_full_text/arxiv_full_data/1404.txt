{"title": "Fast Video Classification via Adaptive Cascading of Deep Models", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "Recent advances have enabled \"oracle\" classifiers that can classify across many classes and input distributions with high accuracy without retraining. However, these classifiers are relatively heavyweight, so that applying them to classify video is costly. We show that day-to-day video exhibits highly skewed class distributions over the short term, and that these distributions can be classified by much simpler models. We formulate the problem of detecting the short-term skews online and exploiting models based on it as a new sequential decision making problem dubbed the Online Bandit Problem, and present a new algorithm to solve it. When applied to recognizing faces in TV shows and movies, we realize end-to-end classification speedups of 2.4-7.8x/2.6-11.2x (on GPU/CPU) relative to a state-of-the-art convolutional neural network, at competitive accuracy.", "text": "classiﬁcation structure classiﬁer cascade simple classiﬁers easy examples lead early exits therefore classiﬁed faster. cascaded classiﬁers require training test data strongly biased toward small number easy detect classes. face detection task example class face common face often quite easy classify small number comparisons inexpensive haar-style features. fact traditional cascades applicable detection tasks background much common easier classify foreground. distinct detection setting traditional cascading recent advances convolutional neural networks opened possibility using single pre-trained oracle classiﬁer recognize thousands classes people objects scenes. training oracle classiﬁers googlenet vggface small number classes usually dominate training broad applicability classiﬁer trained assuming classes less equally likely. even skew toward small classes existed priori reason dominant classes fast classify. seem therefore cascading promising optimization improving speed entity recognition video cnns. demonstrate however many recognition tasks day-to-day video often exhibits signiﬁcant shortterm skews class distribution. present measurements diverse videos show instance -minute windows least objects interacted humans belong fewer objects. underlying imagenet-based recognizer hand recognize objects. show similar skews hold faces scenes videos. recent advances enabled oracle classiﬁers classify across many classes input distributions high accuracy without retraining. however classiﬁers relatively heavyweight applying classify video costly. show day-to-day video exhibits highly skewed class distributions short term distributions classiﬁed much simpler models. formulate problem detecting short-term skews online exploiting models based sequential decision making problem dubbed online bandit problem present algorithm solve applied recognizing faces shows movies realize end-toend classiﬁcation speedups .-.×/.-.× relative state-of-the-art convolutional neural network competitive accuracy. consider recognizing entities objects people scenes activities every frame video footage day-to-day life. footage come instance media wearable cameras movies surveillance cameras. principle entities could drawn thousands classes many encounter hundreds thousands distinct people objects scenes activities life. short intervals minutes however tend encounter small subset classes entities. instance wearable camera objects desk work hour movie focus cooking-related activities ﬁve-minute kitchen sequence media footage event focus celebrities participating event. paper characterize exploit short-term class skew signiﬁcantly reduce latency classifying video using convolutional neural networks cnns uniformly distributed ones. therefore also demonstrate class distribution highly skewed specialized cnns trained classify inputs distribution much compact oracle classiﬁer. instance present executes fewer flops state-of-the vggface model comparable accuracy faces come fewer people. present similar order-of-magnitude faster specialized cnns object scene recognition. given ability produce fast accurate versions cnns specialized particular test-time skews seek estimate skew testtime produce specialized model appropriate exploit model long skew lasts detect skew disappears revert oracle model. standard bandit-style sequential decision-making problems challenge balancing exploration exploitation formalize problem oracle bandit problem propose exploration/exploitation-based algorithm windowed \u0001-greedy address using combination synthetic data real-world videos empirically validate algorithm. particular show reduce end-toend classiﬁcation overhead face recognition episodes movies .-.× relative unspecialized classiﬁcation using vggface classiﬁer show synthetic data similar gains object scene recognition well. provide detailed analysis weg’s functioning including accounting much features contribute. knowledge system ﬁrst test-time sequential class skews video produce faster classiﬁers. long line work cost-sensitive classiﬁcation epitome perhaps cascaded classiﬁcation work viola jones essence line work treat classiﬁcation sequential process exit early conﬁdent inference typically learning sequences cost expectation training data. recent work even proposed cascading cnns techniques assume testing data i.i.d. training happens testing rely skews training data capture cost structure. such equipped exploit short-term class skews test data. models recurrent neural networks aimed classifying instances independent other. given labeled sequences training data techniques learn accurate classiﬁers treat sequence elements independent. however knowledge none approaches produces classiﬁers yield less expensive classiﬁcation response favorable inputs similar adaptive cascading online learning methods customize models test time. training labeled data sequential stream typically contains labeled unlabeled data. adaptive cascading test-time cost incrementally training model systems needs low. fundamental diﬀerence work make assumption input stream partly labeled. instead assume availability large resource-hungry model seek compress resource-light cascade stage. estimating distributions sequential data exploiting focus multi-armed bandit community oracle bandit problem deﬁne diﬀers classic setting arms exploration exploitation happen same whereas oracle allows exploration whereas specialized models allow exploitation. capturing connection arms heart formulation. windowed \u0001-greedy algorithm strongly informed windows handle non-stationarities well-known \u0001-greedy scheme balance exploration exploitation. finally much recent work focused reducing resource consumption neural networks techniques oblivious test-time data skew complementary specialization. expect even pared-down versions optimized models provide good accuracy specialized test-time. specialization depends skew temporal distribution classes presented classiﬁer. section analyze skew videos day-to-day life culled youtube. assembled videos length minutes minutes classes daily activities socializing home repair biking around urban areas cooking home tours. expect kind footage come variety sources movies amateur productions kind dominate youtube wearable videos. table oracle classiﬁers versus compact classiﬁers top- accuracy number flops execution time. execution time feedforward time single image without batching caﬀe linux server -core intel xeon nvidia gpu. specialized models must exploit skews deliver appreciable speedups oracle. typically generated much less minute handle varying amounts skew gracefully deliver substantial speedups inputs belong subsets classes fewer possible several hundred oracle. order exploit skews input cascade expensive comprehensive oracle model less expensive compact model. cascaded classiﬁer designed input belongs frequent classes incoming distribution return early classiﬁcation result compact model else invoke oracle model. thus skew dictates frequent classes dominant classes comprise percentage input skew model execution cost overhead executing compact model roughly time overhead executing compact model oracle sequentially rest time. large lower cost compact model incurred high probability. concrete state convolutional neural networks oracles. particular googlenet oracle model object recognition; -layer version scene recognition vggface network face recognition. compact models also cnns. these architectures derived corresponding oracles systematically removing layers decreasing kernel sizes increasing kernel strides scene object recognizers every sampled frame. note oracle recognizers recognize faces scenes objects respectively. face recognition record top-scoring label face detected others record top-scoring class frame. object recognition particular substantially undercounts objects scene; count applies applications identify distinctive subset objects seek compare numbers number distinct recognized faces scenes objects dominate epochs seconds minute minutes. figure shows results object recognition scene recognition. partition sequence frames segments length show plot segment length. line plot corresponds percentage skew line plots shows cumulative distribution representing fraction segments labels comprised percent labels segment. instance -second segments typically roughly frames objects comprised objects segment time whereas comprise objects time practice detecting skews training models exploit within seconds often challenging. ﬁgures show skew less pronounced albeit still signiﬁcant longer segments. instance -minute segments objects comprise objects seen. trend similar faces scenes skew signiﬁcantly pronounced apparent comparing ﬁgures figure compact model trained various skews cascaded oracle accuracy cascaded classiﬁer tested various skews dominant classes; accuracy trained skew tested various skews diﬀerent number dominant classes. dashed line shows accuracy googlenet baseline. experiments repeated randomly selected dominant sets. reducing size fully-connected layers. results architectures objects scenes faces) noticeably less resources also yield signiﬁcantly lower average accuracy trained validated unskewed data i.e. training validation sets oracle models. instance requires roughly fewer flops execute vggface achieves roughly accuracy. however approach train compact models classify skewed distributions observed execution denoted specialized classiﬁer performance skewed distributions critical measure. particular generate specialized model create training dataset data dominant classes original data randomly chosen subset remaining classes label other dominant classes comprise percent data set. train compact architecture dataset. figure accuracy scene classiﬁers trained ﬁxed skew dominant classes face classiﬁers trained ﬁxed skew dominant classes. dashed lines show accuracy oracle classiﬁer scene face recognition task. validation data diﬀerent skews. figure analyzes case various combinations training validation skews model recall table delivers accuracy unskewed inputs. however training testing skewed inputs numbers much favorable. trained skewed data dominant classes delivers accuracy average significantly higher oracle’s average denoted horizontal black line. also observed figure trained skewed data cascaded classiﬁer maintains high accuracy across wide range testing skews therefore follows skew ﬁxed training skew specialize object compact models rest paper figure shows that varied cascaded classiﬁer degrades gracefully finally figure reports similar measurements compact models shows trends carry scene face recognition. finally note since skews evident test-time specialized models must trained extremely fast techniques accomplish this. first begin processing inputs train model architectures full unskewed datasets oracles. test time skew identity dominant classes available retrain layers compact model. lower layers feature calculation layers need change skew. second pre-processing step inputs training dataset lower feature-calculation layers re-training layers test time avoid combination techniques allows re-train specialized model roughly many orders magnitude faster fully re-training models. sequential model specialization oracle bandit problem stream images classiﬁed. corresponding classiﬁcation results. partition stream. associate distribution partition pair sampled intuitively partitions segments sequence epochs elements epoch drawn independently corresponding stationary distribution thus overall series samples drawn abruptlychanging piece-wise stationary distribution. test time neither results partitions known. classiﬁer designated oracle classiﬁer trained distribution intuitively mixture distributions comprising oracle’s cost assumed invariant across needed execute test time input always consult cost label accuracy model architectures table suppose architecture trained oﬄine obtain template classiﬁer assume re-targeting template size-j dominant classes cost finally dominant classes corresponding specialized classiﬁer trained retargeting template using dataset draws half examples classes rest cost executing rhd. chaining gives cascaded classiﬁer return otherwise return note executing either cost case false. given developing using specialized classiﬁers thus reduce costs signiﬁcantly. since drawn distribution classiﬁer also cost belongs corresponding distribution write applies classiﬁer selected could also include oracle. expected total cost policy seek minimal-cost policy minp maintains average accuracy within threshold oracle accuracy windowed \u0001-greedy algorithm close look policy cost provides useful intuition good policies first given high ﬁxed cost re-targeting models opposed running them re-targeting infrequent. expect re-targeting occur roughly epoch. second cost running cascade much lower running oracle input dominant class higher otherwise. important therefore identify promptly dominant exists produce specialized model lose much accuracy revert back oracle model underlying distribution changes longer dominant. provide heuristic exploration-exploitation based algorithm based intuitions. dominant classes current epoch. oracle ﬁxed number wmin examples. domclasses helper identiﬁes dominant classes window appear least twice window. dominant classes within previous epoch conclude previous epoch continuing fold information collected current epoch template selection given candidate dominant classes estimate accuracy cascaded classiﬁer various template classiﬁers specialized current empirical probability skew derived measured data estimating costs instead explicitly training corresponding specialized classiﬁers signiﬁcantly cheaper. estimate within threshold oracle produce specialized model specialized classiﬁcation phase. continue running oracle inputs collecting information incoming class skew. specialized classiﬁcation specialized classiﬁcation phase simply applies current cascaded model inputs determines distribution trained adequately match actual current distribution. determination non-trivial specialization phase wish avoid consulting oracle order reduce costs. however oracle unbiased source samples actual current distribution. therefore oracle addition cascaded model probability standard \u0001-greedy policy multi-arm bandits. given resulting empirical estimate skew estimate accuracy current cascade equation estimated accuracy cascade classiﬁcation results cascade diﬀerent oracle often assume underlying distribution shifted return window initialization phase. ein→out aout accuracy specialized classiﬁer dominant classes ein→out fraction dominant inputs classiﬁes non-dominant ones aout fraction non-dominant inputs classiﬁes non-dominant observed previously parameters ein→out aout specialized classiﬁer mainly aﬀected size dominant class identity elements thus pre-compute parameters ﬁxed values linear interpolation test time. evaluation implemented algorithm classiﬁcation runtime based caﬀe system videos produce classiﬁcation results recognizing frames. goal measure well large specialized model speedups table translated speedups diverse settings long real videos. wished characterize extent elements design contributed speedups. synthetic experiments first evaluate system synthetically generate data order study diverse settings. experiment generate time-series images picked standard large validation sets cnns use. test comprises segments segment deﬁned number dominant classes skew duration minutes. segment assume images appear ﬁxed interval image picked testing based skew segment. example segment dominant classes skew pre-select classes dominant classes pick image probability dominant classes image probability classes time image arrival minutes duration. images class picked uniform random way. also generate traces consecutive segments diﬀerent conﬁgurations study eﬀect moving context other. table shows average top- accuracies perimage processing latencies using recognition tasks without specializer enabled. results averaged iterations experiment. specializer conﬁgured able detect exploit skews -minute intervals signiﬁcant speedups oracle preserving accuracy. single segment cases latency speedup per-image object scene face respectively. however weg’s overhead numbers noticeably lower speedups specialized models number dominant classes increase specializer latency increases alternates exploration exploitation recognizes dominant classes. latency also increases skew dominant classes decreases specializer cascades times oracle model using cascaded classiﬁer. quite stable handling random inputs essentially resorting oracle accuracy latency unchanged. able detect abrupt input distribution changes accuracy remains comparable oracle accuracy signiﬁcant speedups distribution skewed understand limit algorithm studied frequently class distributions change technique stops showing beneﬁt. evaluated face recognition synthetic traces changing distribution every sec. algorithm yields speedups ././.× video experiments turn evaluating real videos. however unable suitable existing dataset show specialization. need several minutes video contains small subsets classes change time. videos real-world activity happens naturally; popular benchmarks much. example videos youtube faces short typically contain person. similarly clips ucf- mean length focus classifying actions oracle model exists. finally sports dataset assigns labels video instead frame. consequence hand-labeled video clips three movies show interview manually labeled faces videos names video clips lengths listed table note used entire videos friends ellen show used video chunk movies. experiments used compact classiﬁer. disk using viola jones detector. faces measured total execution time. dividing number faces gave average numbers shown here. important point even real-world videos able achieve signiﬁcant speedups oracle ranging .×-.× .×-.× understand speedup summarize statistics execution table special rate indicates percentage time specializer exploits cascaded classiﬁer reduce latency cascade rate reveals percentage time cascaded classiﬁer cascades oracle classiﬁer thus hurting performance. higher special rate lower cascade rate yield speedup. cascade rate ocean’s eleven signiﬁcantly higher videos. investigated found specialized compact repeatedly made mistakes person video high cascade rate. trans. special counts number times needed switch specialized unspecialized classiﬁcation handle distribution changes insuﬃcient exploration. average dominant classes sizes show real videos skewed fewer dominant classes conﬁgurations used synthetic experiments. explains system achieved higher speedup real videos synthetic data. overall statistics show dataset exercise features skew estimation cascading specialization. understand better utility weg’s features performed ablation study disable adaptive window exploration ﬁxed window size skew dominant classes input distribution training skew specializing compact cnns instead using ﬁxed training skew suggested section apply simple criterion exit specialized classiﬁcation phase exits current skew lower skew entered specialized classiﬁcation phase instead using estimated accuracy soft indicator. figure shows comparison variants algorithm accuracy speedups recognizing faces friends video. ﬁgure show absolute diﬀerences accuracy relative diﬀerences speedup. fixed window size variants achieve similar accuracy lower speedup. table shows adaptively estimated size window general small window fails capture full dominant classes yielding specializers exit prematurely. large window requires work oracle window. using variable rather ﬁxed skew training achieves speedup suﬀers loss accuracy. training skew usually high. discussed section training highly skewed data produces models vulnerable false positives other classes. simple exit variant achieves almost comparable accuracy latency higher system. demonstrates value accuracy estimate modeling accuracy cascaded classiﬁers prevent premature exit specialized classiﬁcation phase. summary design elements role producing fast accurate results. characterize class skew day-to-day video show distribution classes often strongly skewed toward small number classes vary life video. show skewed distributions well classiﬁed much simpler convolutional neural networks large oracle models necessary classifying uniform distributions many classes. suggests possibility detecting skews runtime exploiting using dynamically trained models. formulate sequential model selection problem oracle bandit problem provide heuristic exploration/exploitation based algorithm windowed \u0001-greedy solution speeds face recognition episodes movies .-.× little loss accuracy relative modern convolutional neural network.", "year": 2016}