{"title": "Answering Image Riddles using Vision and Reasoning through Probabilistic  Soft Logic", "tag": ["cs.CV", "cs.AI"], "abstract": "In this work, we explore a genre of puzzles (\"image riddles\") which involves a set of images and a question. Answering these puzzles require both capabilities involving visual detection (including object, activity recognition) and, knowledge-based or commonsense reasoning. We compile a dataset of over 3k riddles where each riddle consists of 4 images and a groundtruth answer. The annotations are validated using crowd-sourced evaluation. We also define an automatic evaluation metric to track future progress. Our task bears similarity with the commonly known IQ tasks such as analogy solving, sequence filling that are often used to test intelligence.  We develop a Probabilistic Reasoning-based approach that utilizes probabilistic commonsense knowledge to answer these riddles with a reasonable accuracy. We demonstrate the results of our approach using both automatic and human evaluations. Our approach achieves some promising results for these riddles and provides a strong baseline for future attempts. We make the entire dataset and related materials publicly available to the community in ImageRiddle Website (http://bit.ly/22f9Ala).", "text": "invoked images set. often common concept something even human observe ﬁrst glance come thought images. hence word riddle phrase image riddles. figure shows example image riddle. images individually connect multiple concepts outdoors nature trees road forest rainfall waterfall statue rope mosque etc. thought common concept emerges example fall. here ﬁrst image represents fall season waterfall second image. third image shows rainfall fourth image depicts statue falling word fall invoked images shows logical connections objects regions actions concepts speciﬁc image. addition answer also connects signiﬁcant aspects images. possible answers like nature outdoors demonstrate properties. general. essence image riddles challenging task tests ability detect visual items images also tests knowledge ability think reason. based analysis argue system following capabilities answer image riddles appropriately ability detect locate objects regions properties; ability recognize actions; iii) ability infer concepts detected words; ability rank concept based relative appropriateness; words ability reason process background commonsense knowledge semantic similarity relations words phrases. capabilities fact also desired automated system aims understand scene answer questions example dataset does children vegetarian pizza? examples needs explicit commonsense knowledge. work explore genre puzzles involves images question. answering puzzles require capabilities involving visual detection knowledge-based commonsense reasoning. compile dataset riddles riddle consists images groundtruth answer. annotations validated using crowd-sourced evaluation. also deﬁne automatic evaluation metric track future progress. task bears similarity commonly known tasks analogy solving sequence ﬁlling often used test intelligence. develop probabilistic reasoning-based approach utilizes probabilistic commonsense knowledge answer riddles reasonable accuracy. demonstrate results approach using automatic human evaluations. approach achieves promising results riddles provides strong baseline future attempts. make entire dataset related materials publicly available community imageriddle website component computer vision understanding images comes various tasks image captioning visual question answering paper propose task image riddles requires deeper conceptual understanding images. task images provided needs concept work also related ﬁeld visual question answering. recently researchers spent signiﬁcant amount efforts creating datasets proposing models interestingly adapted ms-coco images created open domain dataset human generated questions answers. recurrent networks encode sentence output answer. even though questions challenging actually require logical reasoning order answer correctly popular approaches still hoping learn direct signal-to-signal mapping image question answer given large enough annotated data. necessity common-sense reasoning could easily neglected. introduce image riddle problem well-deﬁned cognitively challenging task requires vision reasoning capability impossible model problem direct signal-to-signal mapping data sparsity system’s performance could still bench-marked automatically comparison. qualities make image riddle dataset good testbed vision reasoning research. ∧i∈i equivalently ∨i∈i rule associated non-negative weight relaxes boolean truth values ground atom interval denoted compute soft truth values logical formulas lukasiewiczs relaxation conjunctions disjunctions negations used riddles thought visual counterpart test question types sequence ﬁlling analogy solving needs commonalities items. task different traditional queries provide clues regarding look image question. riddles task require superior detection reasoning capabilities whereas large percentage traditional dataset tests system’s detection capabilities. task differs captioning task requires analysis multiple images. video analysis require analysis multiple images task image riddles focuses analysis seemingly different images. hence task image riddles simple explain; shares similarities well-known pre-deﬁned types questions requires combination vision reasoning capabilities. paper introduce promising approach tackling problem. approach ﬁrst state-of-the-art image classiﬁcation techniques identiﬁed classlabels image. given probabilistic detections knowledge connections relations words infer probable words conceptnet source commonsense background knowledge encodes relations words short phrases using structured graph. note possible range candidates entire vocabulary conceptnet representation reasoning huge probabilistic knowledge probabilistic soft logic framework. given inferred words image infer ﬁnal answers riddle. contributions threefold introduce image riddles dataset; present probabilistic reasoning approach solve riddles reasonable accuracy; iii) reasoning module inputs detected words logically infers relevant concepts related work problem image riddles similarities genre topic modeling zero-shot learning however dataset imposes unique challenges possible target labels entire natural language vocabulary; image grouped different images different label; iii) almost target labels dataset unique challenges make hard nell conceptnet extensive coverage english language words phrases. properties make knowledge graph perfect source required probabilistic commonsense knowledge. wordvec uses theory distributional semantics capture word meanings produce word embeddings pre-trained word-embeddings successfully used numerous natural language processing applications induced vector-space known capture graded similarities words reasonable accuracy throughout paper wordvec-based similarities million word-vectors trained google-news corpus approach given images objective determine ranked words based well word semantically connects image. work present approach uses probabilistic reasoning probabilistic knowledge base also uses additional semantic knowledge words wordvec. using knowledge sources predict answers riddles. linear constraint functions associated index sets denoting equality inequality constraints. hinge-loss markov random field probability density deﬁned then logical rule database used deﬁne i.e. linear constraints given weighted logical formulas builds graphical model deﬁning probability distribution continuous space values random variables model. ﬁnal optimization problem deﬁned terms distance satisfaction. rule distance satisfaction measured using term conceptnet multilingual knowledge graph encodes commonsense knowledge world built primarily assist systems attempts understand natural language text. knowledge conceptnet semi-curated. nodes graph words short phrases written natural language. nodes connected edges labeled meaningful relations example edges. edge associated conﬁdence score. also compared knowledge-bases like wordnet yago outlined algorithm image follow three stages infer related words phrases image classiﬁcation class labels conﬁdence image classiﬁer rank retrieve using labels conﬁdence scores rank retrieve related words conceptnet iii) probabilistic reasoning inference using labels related words design inference model logically infer ﬁnal words image. lastly another probabilistic reasoning model combined inferred words images riddle. figure overview framework followed image; demonstrated using example image aardvark similar pipeline image infer ﬁnal results using ﬁnal probabilistic inference stage neural networks trained ample source images numerous image classes effective. studies found convolutional neural networks produce near human level image classiﬁcation accuracy related work used various visual recognition tasks scene labeling object recognition exploit advances stateof-the-art class detections provided clarifai deep residual network architecture image detections call detections seeds. example provided figure detection accompanied classiﬁer’s conﬁdence score rank retrieve related words goal logically infer words phrases represent concepts best explain co-existence seeds scene. hand care implied words could massage ache etc. transportation implied words/phrases could plane etc. reader might inclined infer concepts. however infer derive logical conclusions. hence prefer concepts shares strong explainable connections seedwords. logical choice would traversing knowledge-graph like conceptnet common reachable nodes seeds. computationally quite infeasible association-space matrix representation conceptnet words represented vectors. similarity words approximately embodies strength connection paths connecting words graph. similar words seed approximating reachable nodes. visual similarity observe that conceptnet-similarity gives poor result deﬁne metric called visual similarity. call similar words targets. metric represent seed target vectors. deﬁne dimensions seed relations query conceptnet related words relations seed-word superclasses. relation-word pairs becomes separate dimension. values seed-vector weights assigned assertions. target query conceptnet populate target-vector using edge-weights dimensions deﬁned seed-vector. words using visual similarity cosine similarity seed-vector target-vector re-rank retrieved similar target-words using conceptnet-similarity. abstract seed-words relations conceptnet similarity directly. table shows similar words using conceptnet wordvec visual-similarity word men. moreover ranked list based visual-similarity ranks chap husband godfather male person male ranks formulation seed words conceptnet using visual similarity metric similarity vector together image constitute matrix simvis∀si tsk. next describe deﬁned similarity metric. large percentage error image classiﬁers visually similar objects objects category cases visual similarity metric predict possible visually similar objects inference model infer actual object. rank targets approximate vector representation image seed-words dimensions. columns provides vector representations target words space. calculate cosine similarities target image-vector re-rank targets. consider targets call given candidate targets weighted seeds build inference model infer probable targets model joint distribution using formalism adopts markov random field obeys properties gibbs distribution. addition model declared using rules. given ﬁnal answer system satisﬁed rules show logical connections detected words ﬁnal answer demonstrates system’s explainability. figure joint modeling seeds targets depicted undirected graphical model. deﬁne seed-target targettarget potentials using rules. connect seed target potential depends similarity target’s popularity bias. connect target θt-t maximally similar targets. potential depends similarity. formulation using sets rules deﬁne seed-target potentials rules form wtij word target deﬁne target-target potentials target take similar θt-t targets target rules wtjm wtjm tjk. next describe choices detail. perspective optimization rule wtij adds term wtij max{i objective. means conﬁdence score target greater rule satisﬁed penalize model wtij times difference conﬁdence scores. rule seeds targets combined weighted similarity exceeds certain threshold θsimpsl. encode commonsense knowledge words phrases obtained different knowledge sources weights rules wtij. knowledge sources considered conceptnet embodies commonsense knowledge wordvec encodes word-meanings. also important inference model biased towards popular targets compute eigenvector centrality score word context conceptnet higher indicates higher connectivity word graph. yields higher similarity score many words might give unfair bias target inference model. hence higher word provides less speciﬁc information image. hence weight becomes simcn normalized conceptnet-based similarity. simwv normalized wordvec similarity words eigenvector-centrality score argument conceptnet matrix. model dependencies among targets observe concepts similar meaning system infer infer given observed words. therefore rules wtjm wtjm designed force conﬁdence values close possible. wtjm equation without penalty popularity. learn probable common targets jointly consider targets seeds images together. assume seeds targets nodes knowledge-graph. then appropriate targetnodes observe similar properties appropriate answer riddle target-node connected high-weight seeds image i.e. relate important aspects image; target-node connected seeds images. formulation here rules wtij word target targets compete minimize overall penalty maximize conﬁdence scores targets satisfy rules summation conﬁdence scores bounded inferred targets non-zero conﬁdence. section provide results validation experiments newly introduced image riddle dataset followed empirical evaluation proposed approach vision-only baselines. collected riddles internet riddle images groundtruth label associated verify groundtruth answers deﬁne metrics correctness correct appropriate answers difﬁculty difﬁcult riddles. conduct amazon mechanical turker-based evaluation. rate correctness difﬁculty rated according turkers mean correctness rating difﬁculty ratings show following distribution toddler younger child older child teenager adult linguist no-one short average answer riddles seems closer -yrs. also riddles seem incredibly hard. interestingly average perceived reported recently proposed dataset yrs. although experiment measures turkers’ perception required conclude riddles comparably harder. presented approach suggests following hypotheses requires empirical tests proposed approach attain reasonable accuracy solving riddles; individual stages framework improves ﬁnal inference accuracy answers. addition also experiment observe effect using commercial classiﬁcation methods like clarifai published state-of-the-art image classiﬁcation method. completely gibberish incorrect relates image connects three images respectively connects images could better answer connects images appropriate answer. these gradings adopted instructions toddler solve younger child solve older child solve teenager solve adult solve linguist solve no-one solve propose several variations proposed approach compare simple vision-only baseline introduce additional bias-correction stage after image classiﬁcation aims re-weight detected seeds using additional information images. variations then created test effects varying bias-correction stage effects individual stages framework ﬁnal accuracy also vary initial image classiﬁcation method bias-correction experimented variations greedy bias-correction bias-correction. follow intuition re-weighting seeds image inﬂuenced others. develop greedyunriddler approach. approach consider images together dictate weight seed. take image example. reweight seeds calculate weights using following equation vector weights assigned i.e. conﬁdence scores seed image. element vskj conceptnet-similarity score seed i.e. seed image. re-weighted seeds image passed rest pipeline infer ﬁnal answers. effect stages observe accuracy stage pipeline normalized weighted seeds weighted centroid vector wordvec embeddings seeds image. obtain mean vector centroids. similar words wordvec vocabulary mean vector constitutes ﬁnal answers. mean vector predicted targets images. again similar words wordvec vocabulary constitutes answers. baseline create vision-only baselines. directly class-labels conﬁdence scores predicted using neural network-based classiﬁer. image calculate weighted centroid wordvec embeddings labels mean centroids images. automatic evaluation centroid human evaluation similar word vector wordvec vocabulary. baseline experiment automatic evaluation evaluate performance proposed approach image riddles dataset using automatic amazon mechanical turker -based evaluations. evaluation metric wordvec similarity measure. answer riddle several semantically similar answers. hence reasonable metric. riddle calculate maximum similarity groundtruth detections approach. calculate phrase similarities similarity method gensim.models.wordvec package. average maximum similarities reported percentage form. scenario three separate robots attempted answer riddle. rate answer based correctness degree intelligence shown answer.. correctness deﬁned before. addition turkers asked rate intelligence scale plot percentage total riddles value correctness intelligence figure histograms plots expect increase rightmost buckets correct intelligent systems. number targets conceptnet-similarity weight wordvec-similarity weight number maximum similar targets seed-target similarity threshold conﬁdence scores stage select parameters parameter vector employed random search parameter-space ﬁrst riddles combinations. ﬁnal parameters used values tabulated table conduct amt-based comparative evaluation results proposed approach vision-only baselines. deﬁne metrics correctness intelligence. turkers presented analysis experiment shows variant achieves best results terms wordvec-based accuracy. similar trend reﬂected amt-based evaluations system increased percentage puzzles rightmost bins i.e. produces correct intelligent answers number puzzles. wordvec-based accuracy puts performance resnet baseline close variant. however evident figure evaluation correctness shows clearly resnet baseline lags predicting meaningful answers. experiment also includes turkers think intelligence systems tried solve puzzles. also puts variant top. experiments empirically show figure positive negative results approach riddles. groudtruth labels closest label among clarifai baseline provided images. results check appendix imageriddle website approach achieves reasonable accuracy solving riddles table observe accuracy varies stage pipeline table shows jump accuracy stage leads believe primary improvement approach attributed probabilistic reasoning model. also provide detailed results approach using riddles figure work presented probabilistic reasoning based approach solve class image puzzles called image riddles. collected riddles. crowd-sourced evaluation dataset demonstrates validity annotations nature difﬁculty riddles. empirically show approach task image riddles equivalent conventional test questions analogy solving sequence ﬁlling; often used test human intelligence. task image riddles also line current trend datasets require visual recognition reasoning capabilities. however focuses combination vision reasoning capabilities. addition task proposed approach introduces novel inference model infer related words given class labels using semantic knowledge words. method general terms applications. systems collection high-level concepts boost performance; beneﬁt approach. london khamis bach huang getoor davis. collective activity detection using hinge-loss markov random ﬁelds. proceedings ieee conference computer vision pattern recognition workshops pages mitchell cohen hruschka talukdar betteridge carlson dalvi gardner kisiel krishnamurthy mazaitis mohamed nakashole platanios ritter samadi settles wang wijaya gupta chen saparov greaves proceedings welling. never-ending learning. twenty-ninth aaai conference artiﬁcial intelligence", "year": 2016}