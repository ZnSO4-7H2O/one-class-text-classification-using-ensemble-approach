{"title": "Product Characterisation towards Personalisation: Learning Attributes  from Unstructured Data to Recommend Fashion Products", "tag": ["stat.ML", "cs.CL", "cs.CV", "cs.IR", "cs.LG"], "abstract": "In this paper, we describe a solution to tackle a common set of challenges in e-commerce, which arise from the fact that new products are continually being added to the catalogue. The challenges involve properly personalising the customer experience, forecasting demand and planning the product range. We argue that the foundational piece to solve all of these problems is having consistent and detailed information about each product, information that is rarely available or consistent given the multitude of suppliers and types of products. We describe in detail the architecture and methodology implemented at ASOS, one of the world's largest fashion e-commerce retailers, to tackle this problem. We then show how this quantitative understanding of the products can be leveraged to improve recommendations in a hybrid recommender system approach.", "text": "company make data-driven decisions across problems including personalisation demand forecasting range planning logistics. paper show predict coherent complete product attributes illustrate enables personalise customer experience providing relevant products customers. achieve coherent characterisation products leverage manually annotated attributes cover part product catalogue illustrated figure data consistently available products images text description well product type brand shown figure shared model neural network layers shared across tasks leverage relationship tasks well reduce total number free parameters; training algorithm custom model fitting procedure achieve balanced solution across tasks deal partially-labelled data. remainder paper organised follows section presents product attribute prediction pipeline related literature section illustrates product information improve recommendations related literature section presents discussion. predicting attributes quote niels bohr prediction difficult especially future. case rather past present remains non-trivial affair. section present challenges face approaches consider give overview current results. abstract paper describe solution tackle common challenges e-commerce arise fact products continually added catalogue. challenges involve properly personalising customer experience forecasting demand planning product range. argue foundational piece solve problems consistent detailed information product information rarely available consistent given multitude suppliers types products. describe detail architecture methodology implemented asos world’s largest fashion e-commerce retailers tackle problem. show quantitative understanding products leveraged improve recommendations hybrid recommender system approach. concepts information systems recommender systems; computing methodologies learning rank; supervised learning classification; multi-task learning; neural networks; applied computing online shopping; keywords multi-modal multi-task multi-label classification deep neural networks weight-sharing missing labels fashion e-commerce hybrid recommender system asymmetric factorisation introduction asos global e-commerce company creates curates clothing beauty products fashion-loving -somethings. company’s sales originated online mobile apps country-specific websites. asos’s websites attracted million visits december december million active customers. moment time asos’s catalogue offer around products customers around propositions introduced every week across platforms. years amounts million unique styles without accounting size variants. products different divisions within company produce consume different product attributes even customer-facing hence always present consistent. however incomplete attributes still carry information relevant business. motivation fact different divisions within company produce consume different product attributes presents particular challenges regarding coverage consistency information. retail instance uses specific personas represent core customer groups targets. pre-defined characters epitomise particular fashion taste style often association particular brands. retail persona customer segment despite name implemented product attribute dress identify ‘girly girl’ persona rather ‘glam girl’ information whenever applicable available products customers interact with would allow better understanding customers’ behaviour preferences. would provide actionable insight improve customers’ experience providing relevant products match customers’ unique taste. unfortunately take category dresses representative example customer segment missing across catalogue history. moreover segment’s taxonomy changes time accordance fashion trends. likewise even straightforward product aspects design pattern often missing dresses carry empty pattern label. keeps able analyse forecast sales performance ‘floral’ dresses instance explicitly recommend dresses ‘animal’ prints etc. addition model requires multiple attributes time would input samples learn from since even within category different products might missing values different attributes. example design pattern customer segment jointly available dresses. figure provides illustration situation essentially applies product attributes customer-facing. order enable in-depth analytics better data products content-based hybrid product recommendations discussed section necessary consolidate available product data filling missing attribute values. implemented multi-task multi-modal neural network leverage unstructured information available product pages namely product images product name brand description illustrated figure methodology detailed following sections. image classification. fashion visual domain popularity deep learning already exist literature several approaches classify predict clothing attributes images models trained end-to-end intermediate representations e.g. setup peculiar along images textual information leverage need able scale. therefore image processing becomes part bigger pipeline visual features extracted products’ shots precomputed stored order speed training attribute prediction model also order said features readily available applications. visual feature generation step example representation learning; apply convolutional neural network weights pre-trained imagenet. although state-of-the-art classification architecture still widely applied related tasks object detection image segmentation retrieval transferability convolutional features product shot extract features last convolution layer fully-connected ones perform global max-pooling operation those. results visual features product shot image thereby projected onto so-called embedding space. text classification. convolutional neural networks proved effective classifying images also text indeed sentences treated word sequences word turn represented vector multidimensional word embedding space. convolution representation filters covering multiple word embeddings time efficient take word order consideration following experimented fixed i.e. pre-trained embeddings free randomly initialised ones; latter performed significantly better case. also made sure chosen architecture advantage well-tuned linear classifier normalised bag-of-words provides strong baseline since words product description often contain directly relate target attribute value. central branch diagram figure depicts text processing pipeline simple convolution word embedding layer followed max-over-time pooling convolutional features fully-connected layer. fact since product captions often short need custom pooling layer despite multi-label nature problem order build enough capacity able learn multiple attributes time increased number filters number neurons convolutional dense layer respectively multi-modal fusion. merging visual features image semantic information extracted text accompanying said image already proved helpful object recognition tasks especially number object classes large fine-grained information hard gather images alone. regarding applications fashion particular exist multimodal approaches sales forecasting product detection search asos mini dress yellow floral print dress asos collection floral print fabric crew neck button-keyhole back fit-and-flare style regular true size machine wash viscose elastane model wears dress type casual dresses pattern floral back school/college customer segment girly girl use/occasion casual style dresses seasonal event high summer range main collection price range high street category dresses jersey print length mini look oversized dropped shoulder sweatshirt ecru sweatshirt look loop-back sweat crew neck dropped shoulders ribbed trims step oversized falls generously body cotton polyester model wears size medium product length longline pattern plain back school/college customer segment street style sweatshirts seasonal event cold weather range main collection price range high street product oversized neckline crew sleeve length long sleeve figure example instances associated product images product details appear product pages. using inputs together product’s type brand division network predicts product attributes investigate possible fusion policies merge respective outputs. solution besides deal partially annotated labels discussed next section also consumes additional product metadata merges encodings inputs architecture depicted figure particular product type information used merging pre-computed image embeddings since full-body shots contain multiple products merging visual features semantic information processed text along brand division embeddings trained end-to-end. notably different structure output layers discussed next. multi-task learning missing labels. straightforward solution multi-label scenario would one-hot encode concatenate target labels single output train network binary cross-entropy loss function sigmoid activation last layer however approach would treat classes across labels mutually independent whereas reality target attribute takes subset possible target values. related work multi-label image classification annotation state-of-the-art approaches also model labels dependencies instance stacking recurrent layer processes labels predicted nevertheless prominence missing labels training data would require implementing custom loss function masking layers order avoid propagating errors label available. reason opted simpler multi-task approach still allows degree label hierarchy matches target attribute cross-entropy loss whereby predicted class chosen amongst possible values attribute only. target becomes separate imbalanced multi-class problem. hence implement custom weighting schemes loss different targets depending labels frequencies specific attribute multi-task network provides effective learn products least target attributes labelled thereby performing implicit data augmentation also implicit regularisation since simultaneously fitting multiple targets favour general internal representation conversely even disregarding added complexity maintain multiple models production single-task networks individual attributes could leverage fraction data higher risk overfitting. even worse previously discussed single-task multi-label model would enough training data without clever deal missing labels. practice illustrated figure build model attribute share parameters output layer following ‘hard’ parameter-sharing paradigm also prepare dataset attribute. training random sequential order update model gradient descent table list attributes predict. attribute number labelled samples number classes weighted score test test accuracy given. last column provides frequency majority class test indicative accuracy naive model. selling period price range style collection buying period sleeve length exclusive back school/college customer segment pattern leather/non leather neckline product dress length seasonal event womenswear category gifting product length dress type shirt style use/occasion jewellery finish jewellery type denim wash colour shirt type heel height denim accessories type weight bags/purses size high summer suit type cold weather empirically tuned hyper-parameters architecture balance computational cost performance. evaluation took data train test. mini-batch size learning rate implementation uses keras tensorflow backend. evaluation task predict attributes applicable. report weighted score i.e. task average individual scores calculated possible label value weighted number true instances label value. experimental evaluation results evaluation summarized table model always outperforms naive baseline terms accuracy. evolution performance training shown figure model performance test plateaus optimisation steps figure multi-modal multi-task architecture. grey inputs network blue hidden layers output layers parenthesis output size layer reflects input encoding input layers embedding dimensionality embedding layers number filters neurons convolutional dense layers respectively. step randomly sampled mini-batch corresponding dataset. hard sharing implies stochastic gradient descent step also updates common layers’ parameters; small learning rate randomised update order ensure training stable. matter fact preliminary experiments produced instability using adaptive optimisers momentum namely validation accuracy seemed stall faster oscillate across various models. empirical evidence adaptive methods might yield solutions generalise worse simple momentum however clear whether applies multi-task setting parameter sharing. case simple addition momentum seemed already hurt training performance. hence eventually resorted using vanilla constant learning rate momentum. experimental setup collected data products ever available platforms september product type four image shots text description available resulting samples. problem inputs outputs illustrated figure products also collected manually annotated attributes contained missing values illustrated figure although attributes might apply product types coverage manual annotations historical data always come fixed taxonomy always curated cases might contain incorrect labels. construct ground-truth heuristics determine attributes apply product figure evolution weighted scores measured intervals steps attribute model achieves average weighted score still increasing train plateaus test. attribute. confusion matrices attributes shown figure neckline mass heavily concentrated diagonal. off-diagonal significant mismatch ‘button collar’ ‘point collar’ types shirts neckline. samples class least support often misclassified ‘button collar’ five times frequent. use/occasion attribute represents higher-level categorization harder capture data; still performance chance level accuracy ‘wedding’ easiest class spot. average weighted scores using inputs important input text without score drops images second important without them score drops finally metadata least important without score drops relative importance image text line observed related problem modelling approach text alone classify e-commerce products better image alone multi-modal fusion brings marginal improvement. impact removing input seen detail figure figure examples test-set normalised confusion matrices target attributes; true labels predicted labels attributes might related product shape visual characteristics also higherlevel properties directly expressed product data regarding former although model well overall still observe biases towards popular classes ‘crew’ neck ‘standard’ neck. regarding latter easiest predict ‘wedding’ whereas challenging ‘going bar’ often confused ‘evening occasion’. figure ablation study. density distribution test scores across predicted attributes removing inputs turns average scores full model without product metadata without image features without text input. illustrate next applications attribute extraction pipeline improving personalised product recommendations. first start motivating need content-aware recommendation solution. then describe design recommendation algorithm includes information content products. finally provide experimental evidence effectiveness approach. motivation recommender systems common approaches helping customers discover products vast e-commerce catalogues. asos rely personalised recommendations provide source inspiration customers anticipate needs. established e-commerce sites abundance data collaborative filtering proven good starting approach delivering accurate personalised recommendations customers collaborative filtering algorithms produce recommendations customers based customers’ interactions either finding direct relationships customers between products —e.g. products bought customers tend similar— finding latent associations customers products based interactions —e.g. using dimensionality reduction techniques. despite popularity also well known main weaknesses collaborative filtering so-called cold-start problem fact type algorithms tend perform poorly customers products little interaction data. content-based algorithms contrary suffer product cold-start situation overall tend perform worse collaborative filtering-based counterparts. furthermore depend importantly consistent structured product descriptions metadata. figure hybrid recommender architecture. content-based collaborative inputs network depicted grey hidden layers blue functional layers purple final layer red. parenthesis output size layer denotes dimensionality encoded attributes number negative samples batch ranking loss dimension product factors. asos dynamic product catalogue ability offer customers latest fashion trends aspects business. indicates neither collaborative filtering —which suffers product cold-start notably case newly-added products— content-based approaches —often suffering accuracy sensitive data quality— isolation sufficient providing customers optimal discovery experience. solution propose hybrid recommendation approach combines approaches overcomes respective limitations. moreover solution extracting product attributes contributes success content-aware approach ensuring quality data used compute recommendations. design proposed approach falls within family factorisation models matrix factorisation basic best-known approach them. essence factorisation models represent customers products high-dimensional vector space number dimensions orders magnitude smaller number either customers products— relevant latent properties customers products encoded. vectors typically optimised products customer vectors product vectors define meaningful scores help determine rankings top-n selection products displayed individual customers. collaborative filtering setup case classic matrix factorisation approaches customer product vectors learned parameters model. neural networks terminology means recommendation model includes embedding layers customers products. nevertheless beyond configuration extend purposes. example instead embedding layers products also rely content-based approach features associated products produce said product vectors. mapping product features vectors achieved e.g. feed-forward neural network. moreover possible combine vectors coming embedding layer coming feature-fed neural network thus producing hybrid representation products. forms basis hybrid recommendation algorithm found embedded content-derived vectors combined summing particular approach leverages product type price recency popularity text descriptions image-based features importantly predicted product attributes content-based component takes input attributes product. second modification perform respect classic matrix factorisation so-called asymmetric matrix factorisation method aims reduce complexity model eliminating need learn embedding layer customers. instead vectors customers computed intermediate representation. specifically gathering vectors products customer interacted with combining them e.g. simply taking average avgi∈iu note that cases customer attributes taken account possible combine customer attributes product vectors using neural network approach covington proposed rendle kula vector composition. notably eliminating customer embedding layer model reduces drastically size model positive consequences terms improving scalability approach reducing risk over-fitting. finally provide details optimisation criterion using train model. following recent stream learning rank approaches minimise training loss function models ranking problem positive interactions training —such products purchased customer training data— ranked higher sampled selection negative items particular chosen wmrb loss function batch-oriented adaptation warp loss function proven effective producing good item rankings. function given customer positive product random selection negatively sampled products tries find appropriate scores factorisation model rank positive item ordered products decreasing score possible. given exact rank differentiable wmrb optimises following approximation instead experimental setup order show effectiveness proposed hybrid design performed experiment sample data. particular collected months interactions male customers starting march first months used train validate recommendation algorithms whereas last month used evaluation purposes. interactions kept show strong intention buying together actual purchases. then randomly sampled customers ensuring half interactions training test. total amounted interactions products training interactions products test set. normalise product features follows first normalise unit-norm feature independently normalise unit-norm sample training procedure using first months data goes follows. interactions last month training window taken positive examples wmrb function negative instances randomly sampled non-observed interactions products available whole training window. inputs predictions i.e. interactions products produce customer vectors chose every customer randomly sample interactions preceding positive whose rank want optimise loss function. means customers less interactions discarded training. evaluation task predict purchases customers made test period note type evaluation provides lower bound performance recommendation assumes recommended products purchased interesting customer. another particularity task freezes learned model representations customer test period. helpful illustrate ability hybrid solution dealing cold-start products i.e. added catalogue immediately test period. reality update models daily alleviate cold-start much possible. precision recall cut-off used metrics assess task. provide meaningful comparisons discussing validity hybrid approach baselines included using training evaluation approach. first compare approach obvious baseline ranking tasks i.e. popularitybased ranking second order benefit fusing collaborative filtering content also compared hybrid design collaborative-only content-only versions. variations approach used vector size number negative items batch size variable number epochs determined validation customers training. figure examples similar products defined recommendation models. product largest number customer interactions training set. middle product median number customer interactions. bottom least popular product training period. collaborative performs better products interactions content hybrid affected factor. seen table first noticeable result given numbers precision recall predicting customer activity days advance difficult task. results however allow comparison different approaches. instance pure content-based approach offers results slightly better non-personalised popularitybased ranking offers confirms previous assumptions weakness approach. looking pure collaborative filtering based solution approach superior baseline also content-based one. finally observed hybrid model effective compared approaches outperforms collaborative filtering approach showing bringing content model clear positive effect delivering fashion recommendations. table results recommendation experiments averages standard deviations runs. best result average bold. scores prec statistically different methods significance level differences recall methods. results found figure select three seed products based number customer interactions product highest number interactions product median product lowest value training set. selection allows explore trade-offs collaborative filtering content-based approaches number interactions products varies. retrieved seed product algorithm three products whose vectors highest cosine similarity respect seed product’s vector. results offer interesting insights. hand collaborative filtering approach produces less obvious —but necessarily bad— recommendations especially number interactions hand content-based approach defines similarities explainable. combining methods hybrid recommender appears benefit interpretability content producing recommendations different —and better than seen before— isolated approaches. discussion future work business needs understand customers able better serve them; digital domain revolves around leveraging data tailor digital experience customer. presented body work currently productionised enables personalisation predicting characteristics products. foundational capability used instance provide relevant recommendations shown hybrid approach proposed. picture contains relevant product since fashion model shots contain multiple products. another possible refinement fine-tune image network —now pre-trained imagenet— data train whole model end-to-end even higher computational cost. regarding application hybrid approach datasets expect relative improvement hybrid collaborative filtering grow sparsity user-item interaction matrix depend relevance product features. optimisation hybrid model might also prove challenging unlike dataset require regularisation activation/weights content/collaborative components. future work plan capability characterize products enable additional cases data-assisted design; better product analytics; sales forecasting; range planning; finding similar products; improving search predicted metadata. regarding hybrid recommender system approach plan study trade-offs content collaborative regimes ranging cold-start highly popular products. references martín abadi paul barham jianmin chen zhifeng chen andy davis jeffrey dean matthieu devin sanjay ghemawat geoffrey irving michael isard tensorflow system large-scale machine learning.. osdi vol. françois chollet keras. paul covington adams emre sargin. deep neural networks youtube recommendations. proceedings conference recommender systems york https //doi.org/./. andrea frome greg corrado shlens samy bengio jeff dean tomas mikolov devise deep visual-semantic embedding model. advances neural information processing systems. naoto inoue edgar simo-serra toshihiko yamasaki hiroshi ishikawa. multi-label fashion image classification minimal human supervision. proceedings ieee conference computer vision pattern recognition. alexandros karatzoglou linas baltrunas shi. learning rank recommender systems. proceedings conference recommender systems york https//doi.org/./ katrien laenen susana zoghbi marie-francine moens. cross-modal search fashion attributes. proceedings workshop machine learning meets fashion. acm. ruifan fangxiang feng ibrar ahmad xiaojie wang. retrieving real world clothing images multi-weight deep convolutional neural networks. cluster computing greg linden brent smith jeremy york. amazon.com recommendations item-to-item collaborative filtering. ieee internet computing https//doi.org/./mic.. jingzhou wei-cheng chang yuexin yiming yang. deep learning extreme multi-label text classification. proceedings international sigir conference research development information retrieval. kuan prem natarajan. wmrb learning rank scalable batch training approach. proceedings poster track conference recommender systems ceur workshop proceedings http//ceur-ws.org/vol-/ ziwei ping xiaogang wang xiaoou tang. deepfashion powering robust clothes recognition retrieval rich annotations. proceedings ieee conference computer vision pattern recognition. bharath ramsundar steven kearnes patrick riley dale webster david konerding vijay pande. massively multitask networks drug discovery. arxiv preprint arxiv. steffen rendle. factorization machines. proceedings ieee international conference data mining ieee computer society washington https//doi.org/./icdm.. antonio rubio longlong edgar simo-serra francesc moreno-noguer. multi-modal embedding main product detection fashion. proceedings ieee conference computer vision pattern recognition. alexander schindler thomas lidy stephan karner matthias hecker. fashion apparel classification using convolutional neural networks. proceedings forum media technology around audio symposium jiang wang yang junhua zhiheng huang chang huang cnn-rnn unified framework multi-label image classification. computer vision pattern recognition ieee conference ieee jason weston samy bengio nicolas usunier. wsabie scaling large vocabulary image annotation. proceedings twenty-second international joint conference artificial intelligence volume volume three aaai press https//doi.org/./----/ ijcai- ashia wilson rebecca roelofs mitchell stern nati srebro benjamin recht. marginal value adaptive gradient methods machine learning. advances neural information processing systems. zahavy alessandro magnani abhinandan krishnan shie mannor. picture worth thousand words? deep multi-modal fusion architecture product classification e-commerce. arxiv preprint arxiv. andrew zhai dmitry kislyuk yushi jing michael feng eric tzeng jeff donahue trevor darrell. visual discovery pinterest. proceedings international conference world wide companion. international world wide conferences steering committee", "year": 2018}