{"title": "ClassSim: Similarity between Classes Defined by Misclassification Ratios  of Trained Classifiers", "tag": ["cs.CV", "stat.ML"], "abstract": "Deep neural networks (DNNs) have achieved exceptional performances in many tasks, particularly, in supervised classification tasks. However, achievements with supervised classification tasks are based on large datasets with well-separated classes. Typically, real-world applications involve wild datasets that include similar classes; thus, evaluating similarities between classes and understanding relations among classes are important. To address this issue, a similarity metric, ClassSim, based on the misclassification ratios of trained DNNs is proposed herein. We conducted image recognition experiments to demonstrate that the proposed method provides better similarities compared with existing methods and is useful for classification problems. Source code including all experimental results is available at https://github.com/karino2/ClassSim/.", "text": "deep neural networks achieved exceptional performances many tasks particularly supervised classiﬁcation tasks. however achievements supervised classiﬁcation tasks based large datasets well-separated classes. typically real-world applications involve wild datasets include similar classes; thus evaluating similarities classes understanding relations among classes important. address issue similarity metric classsim based misclassiﬁcation ratios trained dnns proposed herein. conducted image recognition experiments demonstrate proposed method provides better similarities compared existing methods useful classiﬁcation problems. introduction deep neural networks demonstrated improved performance various tasks. particular supervised classiﬁcation tasks computer vision said solved. statement correct datasets ideal i.e. include large number images well-annotated accurate labels wellseparated semantically different target classes identical distributions training test data. ideal case imagenet classes used evaluate classiﬁcation tasks well-organized usually visually distinct distinguishable taxonomy perspective. however real-world applications typically involve nonideal datasets. example consumer generated medias generate huge wild data type data forms supervised datasets wherein labels manually assigned users. result datasets labels given similar images vary classes disorganized. addition classes objective variables models always well-separated semantically means herein focus difﬁculties associated handling ﬂuctuated labels given similar images estimating similarities classes. good similarities obtained visual relations among classes evident performance various machine learning tasks classiﬁcation improved. note deﬁning similarities important difﬁcult. previous studies imposed rather strong assumptions e.g. data probabilistic distributions gaussian simple dimensional features represent various images. similarity metric based misclassiﬁcation ratios trained proposed herein. proposed similarity depends assumption classiﬁers capture characteristics data distribution. believe assumption correct dnns particularly convolutional neural networks demonstrated high performance image classiﬁcation proposed similarity useful various vision tasks understanding semantic gaps creating robust models using misclassiﬁed examples reorganizing target classes. best knowledge previous studies investigated inter-class similarity computations based dnns predictions. exists types similarities recognition problems; similarity elements similarity classes figure similarity elements employed search visually similar products visual authentication systems similarity classes applied understand semantic gaps visual taxonomies. classes also different granularity. however although study relevant issue considered paper. note ignore fooling images adversarial examples created artiﬁcially fool classiﬁers. similarities images many methods compute similarity images proposed. recently dnns used extract image features compute similarities example dnns based similarities applied image retrieval person reidentiﬁcation facial recognition visual similarity product design similarities classes methods exist compute similarity classes. compared image-to-image similarity estimating class-toclass similarity much difﬁcult class include various images number images ﬁxed. however method estimate similarities classes proposed method images divided patches features extracted patch using traditional methods color moment. addition compute distance classes must assume images generated gaussian mixture models note number components must determined manually relative number target classes. addition distance classes expresses inverse relation similarities; normalized absolute values meaningless. here distances involved i.e. parametric distance quadratic distance means variances approximation divergence. methods return similar results. here strong assumptions simpliﬁcations used treat inter-class similarities realistically. however solution employs features extracted using meta-recognition proposed solution useful eliminate dissimilar unknown unknowns particular effective fooling images. attempted discriminate target class classes including unknown unknowns. studies interpreted attempts methods improve rest classiﬁers handle unknown unknowns. words attempt generalize classiﬁers isolating target class classes various perspectives. note studies employ dnns. problem formulation target problem deﬁning similarities classes include arbitrary number images. here class comprising images whose labels image. goal formulate quantitative similarity following consider case image label. consider three types labels. ﬁrst latent labels. assume images generated unknowable generative models whose latent variables correspond labels. image generated following probabilistic distribution here functional form distribution assumed. generally latent labels difﬁcult estimate nature. second annotated labels. here labels assigned manually used supervised datasets train model corresponding labels generated image always annotated owing stochasticity. assume assigning probabilities annotated labels controlled probabilities third label type predicted labels. here labels distribution deterministic manner. predicted label determined follows understand equation consider image space discretized ﬁnite number volumes distributions remain constant volume. then consider image satisfying small volume around point distributions remain constant. effective number within volume denoted ∆ncj|ci expressed follows ensured bayes’ theorem assumed identical priors. argument interchanging derive equation general deﬁnition classsim here generalize ideal binary case. generally prior different class exact form cannot obtained. therefore deﬁne classsim constructed misclassiﬁcation ratios trained classiﬁers approximate distribution ncj|ci ratio number elements predicted classiﬁer. generally different classiﬁers used compute ncj|ci nci|cj thus require classiﬁers compute similarities pairs classes case. factor ensures value range possible maximum value ncj|ci nci. deﬁnition obviously possesses symmetry classiﬁer perspective proposed similarity interpreted difﬁculty classiﬁcation classes. addition scores across different pairs classes compared absolute values meaning ratio misclassiﬁcation. figure three types labels. vertical axis probability horizontal axis image space shown dimension simplicity. gray shaded area intersection area distributions. intersection area represents occurrence frequency condition wherein impossible uniquely identify latent labels generated images. size area reﬂects indistinguishability classes. larger area similarity classes show. proposed similarity following properties normalization possible value range symmetry provide value. since intractable exact computation similarity difﬁcult. therefore problem estimate similarity approximately possible using proposed approach section propose classsim approximately represent equation classsim deﬁned using classiﬁers trained learn given datasets. main contribution paper. addition propose level model enhances performance classiﬁers application proposed classsim. classsim ﬁrst describe ideal case. here prior distributions identical class pair i.e. ideal binary classiﬁer returns score according true distribution images annotated label misclassiﬁcation occurs classiﬁer returns although knows true distribution misclassiﬁcaf ideal tion unavoidable generated region important points proposed similarity uses trained classiﬁers assumption made functional forms distributions geometric structures feature space signiﬁcant differences observed previous methods. owing recent advances classiﬁers easier create good classiﬁers capture distribution directly estimating generative distribution rest classiﬁer case concrete classiﬁer case introduce classiﬁers case classsim computation. note case used experiments discussed next section. case classes classiﬁers fcother compute classsim using fciother other. here number misclassiﬁed samples given compared ideal binary classiﬁer case interpret classiﬁer other approximation averaging c/{cj}. similar ideal rather different classes similarity tends large classiﬁcations easy misclassify. misclassiﬁcation ratio ncj|ci understood similar compared classes. observation classsim still good metric similarity classes. multi-class classiﬁer case here consider multi-class classiﬁer case. require classiﬁer r|c| case. number misclassiﬁed samples pair similar classes similarity multiclass case shows tendency classiﬁer case; however value relatively smaller. demonstrate phenomenon true compare cases detail next section. level model proposed classsim useful understanding similarities classes various applications improving classiﬁers. application classsim introduce level model enhances classiﬁcations. stated previously improvements classiﬁcations lead better solutions open problems. among many different potential improvement directions focus classiﬁcation datasets include similar classes difﬁcult problem real-world applications proposed similarity high afﬁnity. baseline model simple classiﬁers introduced previous subsection used baseline model. target class classiﬁer fciother trained using datasets prediction phase trained classiﬁers applied order. here classiﬁer trained individually; thus scores across different classiﬁers cancompared. therefore ﬁrst classiﬁer returning score threshold found select target label predicted label. although heuristics based domain knowledge practical applications simple alphabetical order class names used herein. classiﬁer score greater threshold predicted label deﬁned none. level model propose enhancement classiﬁers constructing classiﬁers cother applied ﬁrst classiﬁers fcother. construction procedure considered herein cother distinguish small differences among similar classes. note threshold used target classes classsim compare across different pairs classes collect similar classes without human intervention. experiments experiments conducted demonstrate effectiveness proposed methods. ﬁrst experiment involved estimating similarities classes results compared previous study second experiment focused enhancing classiﬁers using classsim. compare results previous study attempted collect datasets unfortunately longer available; therefore bing image search collect nearly equivalent datasets. attempted collect images class employed previous study classes contained less images. total obtained divided images datasets. similarities classes trained classiﬁers using training classiﬁers trained using transfer learning pretrained inception computed classsim validation using trained classiﬁers pair classes. comparison reproduced results previous study. previous study image divided patches traditional image features color moment used compute classes. used distance values similarities addition also conducted experiment using single trained multi-class classiﬁer. show computed similarities differences results case multi-class case. subsection show three similar classes target class. full results computed similarities shown appendix similar pair results classsim computed classiﬁers shown table overlaps results. example pair similar common pair cases natural result human sense. addition methods provided city clouds bay} similar class {boeing helicopter buildings ocean} respectively. observed signiﬁcant differences relative combinations. example similar class city buildings ocean indicates proposed method obviously yielded better result table furthermore provided similar pair whereas provided class similar sunset sunrise. demonstrates proposed method bridge semantic gaps better previous method. comparison within here compare relative scores among classes single target class leads another advantage proposed similarity. example three classes similar buildings scores {city. ships. bay.}. here score difference classes seems sensible city similar buildings ships not. contrast provided {city ocean}. since score difference city less ocean cannot distinguish well proposed comparison across rows here investigate differences across rows focus birds sunrise highest score birds sunrise respectively. note latter times greater former. result interpretable birds similar class sunrise similar sunset. contrast proposed method clear meaning absolute value. deﬁnition value directly represents misclassiﬁcation ratio. think value quantitative measure challenges distinguishing classes. overall results show good agreement. case yielded similar classes target class except {birds city ships}. although exists differences results multi-class case also leads better performances conclude proposed similarity useful different types classiﬁers. note similarities multi-class case lower case. natural consequence because equation images whose annotated labels predicted labels counted misclassiﬁcations; therefore images predicted c/{ci increase value similarity. contrast misclassiﬁcations case include images predicted binary classiﬁer other. note used model practical applications classes approximately images. shown performance relative unknown unknowns improved. future plan compare proposed model previous studies open problem setting comprising publicly available dataset. differences scores obvious case multi-class case. three classes similar scores {boeing helicopter. ships.} case {boeing. helicopter. mountain.} multi-class case. case gave clearer differences {boeing helicopter} explain differences results. similar class city buildings case multi-class case. result reasonable found images contain building. similar class ships case multiclass case. case it’s easy judge result better. enhancement classiﬁers experiment evaluated test dataset accuracy proposed level model following algorithm here used classiﬁers previous subsection ﬁrst classiﬁers. results {training validation} table trained datasets birds face similar classes threshold. observe ways level model improved classiﬁcations show images table since cother trained using datasets include similar classes distinguish ﬁner differences. summary herein formalized similarities pair classes proposed classsim based misclassiﬁcation ratio trained classiﬁers well express similarities. experimental results demonstrate proposed similarity yields better performance previous methods. scores easier compare across multiple classes differences much clearer prior studies. thus proposed method bridge semantic gaps better previous methods. presented effectiveness level model based cother classiﬁers trained using similar classes. using proposed similarity could collect similar classes without human intervention. experimental results showed table three similar classes scores classsim parametric distance shows three similar classes class ﬁrst column. similarity score ranging positive real number table three similar classes scores classsim computed using classiﬁers classsim computed using multi-class classiﬁer. shows three similar classes class ﬁrst column. similarity score ranging full results experiments appendix provide full tables similarity computations cs-pd experiment cscs experiment. split full table three tables cases. experiment beach. beach ocean. mountain city. birds mountain. ocean ships. helicopter buildings. ships city sunrise. boeing sunset boeing. clouds buildings sunrise face beach bay. ocean. mountain mountain. birds sunrise. helicopter sunset. sunset city. boeing sky. ocean helicopter. ships buildings. clouds ships. sunrise clouds. city boeing. buildings face. face birds. boeing birds ocean. helicopter helicopter. face. clouds ocean. sunset. helicopter boeing ships. sunset sunset city. boeing. sunrise clouds bay. sunrise. birds beach birds. helicopter. mountain face. ships. beach sky. city. face ships buildings. sky. sunrise mountain buildings. mountain. ocean bay. face mountain. city clouds. beach. buildings buildings city. city ships. bay. ocean sunset. beach beach. mountain sunrise. ships ocean. birds mountain. helicopter boeing. sunset sky. boeing helicopter. birds. clouds face. sunrise face clouds. city buildings. ocean bay. ships. mountain beach. buildings mountain. beach ocean. birds sunrise. ships sunset. helicopter boeing. sunset face. boeing helicopter. sunrise sky. clouds birds. face clouds. table comparison similarities classsim computed rest classiﬁers parametric distance column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranging positive real number clouds sky. ocean. boeing sunset. helicopter sunset mountain. sunrise beach. ships. birds face face. mountain beach city. ships boeing. ocean birds. city bay. buildings face ocean. sunrise. helicopter birds. clouds city. boeing sunset. sunset birds mountain. sunrise boeing. mountain ships. beach sky. helicopter. beach. ships bay. ocean buildings. city clouds. buildings boeing. clouds helicopter. boeing ships. helicopter ocean. sunset sunset. sunrise bay. birds birds. beach. face face. beach city. mountain sunrise. ships mountain. sky. ocean clouds. city buildings. buildings helicopter boeing. boeing ships. clouds beach. sunset mountain. birds city. sunrise sunrise. ships birds. mountain face. sky. beach ocean. face buildings. sunset. ocean bay. city clouds. buildings mountain bay. beach beach. ocean. birds sunrise. helicopter clouds. sunset city. ships sky. boeing sunset. ocean helicopter. ships. clouds buildings. sunrise face. city buildings boeing. face birds. clouds. clouds sunset. sunrise. boeing ocean. helicopter mountain. sunset bay. sunrise beach. birds boeing. face city. mountain buildings. beach face. ships helicopter. ocean birds. city ships. buildings table comparison similarities classsim computed rest classiﬁers parametric distance column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranging positive real number helicopter birds city. beach buildings. mountain boeing boeing. beach. sunset ocean mountain. clouds face. city birds. buildings face sunrise clouds. sunset sunrise. sky. boeing ocean. clouds clouds. helicopter beach. sunrise bay. birds mountain. beach city. mountain face buildings. ships birds. face. ships. ocean helicopter. city boeing. buildings sunrise sunset. sky. boeing ocean. clouds clouds. sunset beach. helicopter mountain. birds bay. mountain city. face. beach buildings. ships. face ships birds. ocean helicopter. city boeing. buildings ocean bay. sky. beach clouds. mountain beach. city sunset. ships sunrise. birds ships. helicopter mountain. buildings boeing. sunset city. boeing face. clouds birds. sunrise buildings. face helicopter. table comparison similarities classsim computed rest classiﬁers parametric distance column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranging positive real number beach. multi beach. ocean. city. multi city. multi mountain. mountain. multi ocean. ships. multi ships. buildings. multi sunset. multi sunrise. multi sunrise. sky. multi multi boeing. multi face. multi face. birds. multi helicopter. multi clouds. multi boeing. beach bay. bay. ocean. ocean. mountain. buildings. mountain. sunrise. sunset. sunset. mountain. city. sunrise. sky. city. helicopter. ships. buildings. sky. birds. ships. helicopter. clouds. face. boeing. face. clouds. birds. boeing. boeing. boeing. sunrise. clouds. helicopter. sunset. ships. sky. city. ships. sky. beach. buildings. mountain. bay. bay. sunrise. mountain. helicopter. clouds. city. beach. buildings. boeing helicopter. sky. ocean. helicopter. ships. buildings. city. birds. bay. sunset. birds. sunrise. face. ships. sky. ocean. buildings. mountain. mountain. helicopter. sunset. birds. helicopter. face. face. clouds. clouds. birds. city buildings. bay. bay. buildings. ships. ships. beach. sunset. mountain. helicopter. ocean. mountain. sunrise. beach. sunset. boeing. sky. face. sunrise. ocean. helicopter. face. sky. clouds. birds. boeing. clouds. birds. table comparison similarities classsim computed rest classiﬁers computed multi-class classiﬁer. column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranges sky. multi sky. ocean. multi ocean. sunset. multi mountain. sunrise. multi sunset. mountain. multi beach. multi birds. ships. multi helicopter. multi ships. face. multi multi face. city. multi buildings. multi boeing. multi birds. multi bay. multi face ocean. ocean. sunrise. birds. birds. sunset. city. sky. sunset. mountain. bay. mountain. sunrise. boeing. ships. ships. sky. helicopter. helicopter. clouds. beach. city. bay. buildings. buildings. boeing. clouds. beach. boeing. boeing. helicopter. helicopter. ships. mountain. ocean. ships. sunset. buildings. bay. ocean. birds. bay. beach. face. face. city. city. birds. sunrise. sunset. mountain. sunrise. sky. sky. clouds. clouds. buildings. beach. helicopter boeing. ships. ships. bay. beach. city. mountain. boeing. city. mountain. sunrise. sunset. birds. sunrise. face. sky. sky. ocean. ocean. face. buildings. clouds. sunset. buildings. bay. birds. clouds. beach. mountain bay. bay. beach. clouds. ocean. ocean. sunrise. clouds. sky. city. beach. sky. city. sunset. birds. helicopter. face. ships. sunrise. buildings. helicopter. face. sunset. buildings. boeing. ships. birds. boeing. clouds. clouds. sunset. sunset. sunrise. sunrise. ocean. bay. mountain. ocean. bay. mountain. beach. face. boeing. boeing. city. buildings. buildings. beach. face. city. birds. helicopter. ships. birds. helicopter. ships. table comparison similarities classsim computed rest classiﬁers computed multi-class classiﬁer. column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranges multi bay. ocean. multi helicopter. helicopter. multi city. buildings. multi buildings. multi bay. multi city. boeing. multi beach. beach. multi birds. sunrise. multi sunset. mountain. multi face. multi sky. birds. multi mountain. sunset. face. multi sky. multi clouds. clouds. multi boeing. sunset sunrise. sunrise. sky. sky. ocean. ocean. clouds. clouds. beach. beach. bay. bay. mountain. face. city. city. mountain. buildings. helicopter. birds. birds. face. ships. ships. helicopter. buildings. boeing. boeing. sunrise sunset. sunset. sky. sky. ocean. bay. clouds. ocean. beach. beach. mountain. mountain. bay. face. city. buildings. face. clouds. buildings. ships. ships. helicopter. birds. city. helicopter. boeing. boeing. birds. ocean bay. bay. sky. clouds. clouds. beach. beach. sunset. sunset. sky. sunrise. ships. ships. mountain. mountain. sunrise. boeing. buildings. city. face. face. birds. birds. helicopter. buildings. city. helicopter. boeing. table comparison similarities classsim computed rest classiﬁers computed multi-class classiﬁer. column name represents target class. pairs {class similarity} shown descending order similarities column. similarity score ranges bernhard sch¨olkopf john platt john shawe-taylor alex smola robert williamson. estimating support high-dimensional distribution. neural computation florian schroff dmitry kalenichenko james philbin. facenet uniﬁed embedding face proceedings ieee recognition clustering. conference computer vision pattern recognition pages christian szegedy vincent vanhoucke sergey ioffe shlens zbigniew wojna. rethinking inception architecture computer vision. proceedings ieee conference computer vision pattern recognition pages zhiyong wang genliang guan jiajun wang dagan feng. measuring semantic similarity concepts visual domain. multimedia signal processing ieee workshop pages ieee jiang wang yang song thomas leung chuck rosenberg jingbin wang james philbin chen ying learning ﬁne-grained image similarity deep ranking. proceedings ieee conference computer vision pattern recognition pages pengcheng steven peilin zhao dayong wang chunyan miao. online multimodal deep similarity learning application image retrieval. proceedings international conference multimedia pages deng dong richard socher liimagenet large-scale fei-fei. hierarchical image database. computer vision pattern recognition cvpr ieee conference pages ieee genliang guan zhiyong wang tian dagan feng. improved concept similarity measuring multimedia signal processing visual domain. mmsp’. ieee international workshop pages ieee xufeng thomas leung yangqing rahul sukthankar alexander berg. matchnet unifying feature metric learning patch-based proceedings ieee conference matching. computer vision pattern recognition pages hamid izadinia bryan russell farhadi matthew hoffman aaron hertzmann. deep classiﬁers image tags wild. proceedings workshop community-organized multimodal mining opportunities novel solutions pages nguyen jason yosinski jeff clune. deep neural networks easily fooled high conproﬁdence predictions unrecognizable images. ceedings ieee conference computer vision pattern recognition pages", "year": 2018}