{"title": "Classification of COPD with Multiple Instance Learning", "tag": ["cs.CV", "stat.ML"], "abstract": "Chronic obstructive pulmonary disease (COPD) is a lung disease where early detection benefits the survival rate. COPD can be quantified by classifying patches of computed tomography images, and combining patch labels into an overall diagnosis for the image. As labeled patches are often not available, image labels are propagated to the patches, incorrectly labeling healthy patches in COPD patients as being affected by the disease. We approach quantification of COPD from lung images as a multiple instance learning (MIL) problem, which is more suitable for such weakly labeled data. We investigate various MIL assumptions in the context of COPD and show that although a concept region with COPD-related disease patterns is present, considering the whole distribution of lung tissue patches improves the performance. The best method is based on averaging instances and obtains an AUC of 0.742, which is higher than the previously reported best of 0.713 on the same dataset. Using the full training set further increases performance to 0.776, which is significantly higher (DeLong test) than previous results.", "text": "§biomedical imaging group rotterdam erasmus rotterdam netherlands email v.cheplyginatue.nl {d.m.j.tax m.loog}tudelft.nl {laugesmarleen}diku.dk technique handle learning weakly labeled data called multiple instance learning goal build classiﬁer collection feature vectors also referred instances. often assumed positive least instances positive. assumption positive instances found region feature space called concept. copd concept could part feature space containing rois typical example emphysema. scenario soon scan contains whole image diagnosed copd. methods broadly divided categories instance-based bag-based. instance-based methods constraints posed labels assumptions build instance classiﬁer combine instance classiﬁcations classify bags hand bag-based methods classify bags directly often deﬁning kernels dissimilarities bags. every classiﬁer makes explicit implicit assumptions data. instance-based classiﬁers typically rely assumption concept positive bags contain instances concept. therefore concept instances important determining label. bagbased classiﬁers assume bags class similar similarity deﬁnition speciﬁes assumption. deﬁnitions bag’s instances involved deﬁning similarity therefore whole distribution instances important label. shown many well-known problems fall categories property determines many methods perform data. abstract—chronic obstructive pulmonary disease lung disease early detection beneﬁts survival rate. copd quantiﬁed classifying patches computed tomography images combining patch labels overall diagnosis image. labeled patches often available image labels propagated patches incorrectly labeling healthy patches copd patients affected disease. approach quantiﬁcation copd lung images multiple instance learning problem suitable weakly labeled data. investigate various assumptions context copd show although concept region copd-related disease patterns present considering whole distribution lung tissue patches improves performance. best method based averaging instances obtains higher previously reported best dataset. using full training increases performance signiﬁcantly higher previous results. chronic obstructive pulmonary disease disease lungs caused among others smoking pollution. copd characterized chronic inﬂammation lung airways degradation lung tissue called emphysema result airﬂow limitation disease progresses several stages eventually lead death however detecting disease early stage increase survival rate limitations traditional spirometry visual assessment computed tomography scans texture classiﬁcation proposed quantify copd approach classify patches lung tissue regions interest image combine classiﬁcations overall probability copd however supervised approaches require manually annotated rois difﬁcult costly obtain. alternative weakly labeled medical images i.e. global image label provided training image classiﬁer. absence labeled rois image label propagated rois classiﬁer trained usual call straightforward approach simplemil. however disregards fact scans detection copd using lung texture tackled classifying patches combining outputs approach call simplemil specialized method applied problem dissimilarity-based approach shows promising results. dissimilarity kernel-based approaches focus airways rather extension support vector machines attempts hidden labels instances constraints posed labels. another example milboost instances reweighed boosting rounds. instance weights indicate informative instances predicting labels. recognized standard assumption might strict certain types problems. therefore relaxed assumptions emerged fraction particular number positive instances needed satisfy concept multiple concept regions considered. case copd would correspond presence certain fraction rois containing affected tissue and/or different types disease patterns. however number concepts fraction positives concept given advance extra parameters also need using training data increasing risk overtraining. therefore methods compare bags without explicitly relying standard relaxed assumptions proposed. methods include citation-knn kernels citation-knn uses hausdorff distance bags. classiﬁcation referencing nearest neighbors citing neighbors taken account. kernel deﬁned either instance kernels standard kernel summarized representation bag. summary created feature averaging bag’s instances using minimum maximum instance values cases kernel deﬁned affects assumptions made problem. drawback real-world applications kernels must positive semideﬁnitive therefore excluding domain-speciﬁc similarity functions. bag-based methods addressed representing similarities prototypes so-called dissimilarity space therefore represented single feature vector similarity measure. space supervised classiﬁer used. miles training instances used prototypes creating high-dimensional representation. sparse classiﬁer used select discriminative similarities therefore instances. bag-of-words approach prototypes words clusters instances dissimilarity measure word number instances belonging cluster. using bags prototypes reduces dimensionality therefore possibility overtraining. paper training bags prototypes i.e. prototype selection used reduce |r|. advantage methods gained training data nearest neighbor approaches restrictions similarity function paper example deﬁnitions necessarily metric average minimum instance distance earth mover’s distance deﬁned herein instance dissimilarity squared euclidean distance. lung texture also successful copd classiﬁcation work investigate broader range methods classiﬁcation lung texture copd. examine assumptions commonly used instance-based bag-based methods suitable problem demonstrate state-of-the-art results copd dataset danish lung cancer screening trial represented {xik|k instances k-th instance described d-dimensional feature vector xik. training ...n} consists positive negative bags. deal type input propagate labels instances building instance classiﬁer. label obtained classifying bag’s instances combining instance classiﬁcations example fusing posterior probabilities noisyrule instances contribute label. fusion rule used classifying rois nearest neighbor classiﬁer combining outputs classify entire image. refer strategy simplemil experiments. standard assumption hidden instance labels relate labels follows positive contains least positive concept instance strategy earlier approaches model concept region feature space contains least instance positive instances negative bags. diverse density proposed measure property. given point feature space measures ratio number positive bags instances near distances negative instances point maximized therefore corresponds target concept. instances classiﬁed using distance however optimization problem suffers local optima original algorithm several restarts algorithm needed. therefore expectation-maximization version algorithm em-dd proposed. emdd shown perform well range problems also computationally intensive. simplemil logistic nearest neighbor classiﬁers. consider noisy-or average fusion rules. em-dd instances used initialization misvm polynomial kernel degree polynomial regularization parameter. consider noisy-or average fusion rules. dataset describes lung images danish lung cancer screening trial processed. parts images highlighting healthy emphysemous lung tissue shown figure fig. examples patches containing centrilobular emphysema characterized black holes within lung tissue healthy tissue images approximately times size rois used classiﬁcation intensity values rescaled facilitate viewing. dataset consists three parts training validation xval test xte. originally parts consists copd healthy images. previous work subset training data copd healthy images selected improve class separability training set. therefore refer full training data subsampled training data xsub. image represented rois sampled random locations within lungs. described histograms responses ﬁlters scales capture texture image. ﬁlters used following gaussian gradient magnitude laplacian gaussian ﬁrst second third eigenvalue hessian gaussian curvature eigen magnitude. scales range responses ﬁlter scale stored histogram bins. approach creates dimensional feature vector roi. validation used select appropriate ﬁlters scales. features selected particular classiﬁer full feature classiﬁers. perform evaluation three ways. first classiﬁer trained xsub depending experiment. classiﬁer evaluated xval. evaluation metric area receiveroperating characteristic curve auc. report best performances xval select corresponding parameters. report performance classiﬁer best parameters independent test xte. difference xval indicator overtraining i.e. ﬁtting parameters well validation set. lastly randomly select half bags xsub times. subsample train classiﬁer select parameters using xval evaluate xte. average standard deviations performances reported. result gives indication situation less training data available variance performance different sampling data. performances shown table training dataset compare performances column. best performance performances signiﬁcantly worse best shown bold. test signiﬁcant differences using delong test curves performances xval using dependent t-test cross-validation performances signiﬁcance level results reported. em-dd time requirements high datasets. misvm instance kernel matrix large memory. classiﬁer simple logistic noisy simple logistic simple k-nn noisy simple k-nn misvm noisy misvm milboost citation k-nn mean-inst extremes miles meanmin meanmin k-nn k-nn classiﬁer simple logistic noisy simple logistic simple k-nn noisy simple k-nn milboost citation k-nn mean-inst extremes miles meanmin meanmin k-nn k-nn classiﬁers suffer high dimensionality. example words approach uses mixture gaussians estimate words feature space able dimensions. milboost em-dd could handle dimensionality computationally performed additional experiments -dimensional feature resulted feature selection procedure used results suggesting classiﬁers beneﬁt feature selection. course generally interesting study feature selection classiﬁers well. full training dataset main differences respect xsub higher class overlap bags therefore instances total. several classiﬁers simplemil logistic mean-inst extremes dissimilarity space show increases performances higher sample size. hand miles suffers increased sample size dimensionality dissimilarity representation equal number instances. also explains miles performs better training subsampled performances many methods degrade much bags used training. suggests subsampled dataset still representative whole data distribution class described well samples. furthermore classiﬁers suffer overtraining difference performance xval quite small. notable exceptions k-nn classiﬁers trained full training simplemil performs quite well especially posterior probabilities instances taken account averaging fusion rule. methods assume concept em-dd misvm also perform reasonably suggests region feature space high density disease patches density normal patches. however performances lower bag-based methods suggesting detecting concept sufﬁcient diagnosis copd. also supported fact misvm averaging rule outperforms misvm noisy rule shows beneﬁcial take instance classiﬁcations account. methods assumptions level best performances particular averaging instances already able separate classes quite well. suggests negative instances positive bags negative instances negative bags originate distribution. words scans affected copd contain types healthy patches healthy scans. disease appears diffuse affecting large part lung rather small isolated regions. bag-based methods mean-inst representation dissimilarity-based perform particularly well. miles suffers high dimensionality expect performance would improve instance selection techniques would used. another interesting observation dissimilarity-based signiﬁcantly outperforms k-nn dissimilarities. able dissimilarities training create robust classiﬁer consistent results although slightly different dissimilarities used there. expect investigation different dissimilarity measures could improve results. unfortunately results directly comparable dissimilarity-based approach earlier version dataset used. results however obtained training xsub performances compared. there best approach obtains results show superior performances training xsub mean-inst demd dissimilarity space. however performances signiﬁcantly better result using improves results simplemil logistic classiﬁer mean-inst dmeanmin dissimilarity space. best approach using obtains performances signiﬁcantly better according delong test. bestperforming classiﬁers images still misclassiﬁed. rather looking positive label copd copd stages mild moderate results show confusion healthy scans stage scans supports intuition class overlap largest. classiﬁers differ errors interest combine decisions. next classiﬁer performances important consider classiﬁers would used medical setting. despite slightly lower performances instance-based methods interest ability provide instance labels rois. expert could inspect instance labels different regions lungs allowing better diagnosis treatment planning. instance labels however used caution. specialized methods trained classify bags correctly instances best classiﬁer necessarily best instance classiﬁer therefore correct instance labels would sacriﬁced greater good correct labels. although bag-based methods perform better interpretability difﬁcult. example average histograms separate classes well method provide information affected tissue distributed within lungs could important determining best treatment well monitoring disease progression therapy effect. dissimilarity-based methods provide opportunities terms interpretability compared mean-inst extremes. methods investigate prototypes i.e. images patch clusters individual patches correspond typical healthy copd cases. using linear classiﬁers dissimilarity space diagnosis would explained terms linear combination dissimilarities prototypes. studied possibility classifying copd means various classical recent approaches. study revealed offers classiﬁcation methods problem potentially better techniques previously proposed. diversity methods also enabled reason nature copd problem. although found concept region patches showing typical disease patterns considering whole distribution instances classiﬁcation improved results. best performing method kernel based average instance bag. method obtains higher previous best performance dataset. using full training data achieve signiﬁcantly higher rabe hurd anzueto barnes buist calverley fukuchi jenkins rodriguez-roisin weel global strategy diagnosis management prevention chronic obstructive pulmonary disease gold executive summary american journal respiratory critical care medicine vol. pauwels buist calverley jenkins hurd global strategy diagnosis management prevention chronic obstructive pulmonary disease respir. crit. care med. vol. order better understand classiﬁer performances examine projection instances obtained tdistributed stochastic neighbor embedding clusters instances smaller cluster left larger cluster. small cluster density instances positive bags clearly higher suggests part could concept region. investigate whether patches display emphysema examined intensity histograms gaussian ﬁlters smallest scale. emphysema results darker patches would expect patches emphysema intensity histograms skewed left. exactly averaging instances cluster plotting corresponding histograms figure visual inspection patches small cluster lower right part cluster figure conﬁrmed tendency average gaussian ﬁlter response histograms figure patches small cluster generally affected emphysema whereas patches lower part cluster showed faint signs emphysema. park chae s.-h. kang texture-based quantiﬁcation pulmonary emphysema high-resolution computed tomography comparison density-based quantiﬁcation correlation pulmonary function test investigative radiology vol. uppaluri mitsa sonka hoffman mclennan quantiﬁcation pulmonary emphysema lung computed tomography images american journal respiratory critical care medicine vol. mendoza washko ross diaz lynch crapo silverman acha serrano estepar emphysema quantiﬁcation multi-scanner hrct cohort using local intensity distributions international symposium biomedical imaging sørensen loog ashraf dirksen duin bruijne image dissimilarity-based quantiﬁcation lung disease medical image computing computer-assisted intervention feragen petersen grimm dirksen pedersen borgwardt bruijne geometric tree kernels classiﬁcation copd airway tree geometry information processing medical imaging pedersen ashraf dirksen bach hansen toennesen thorsen brodersen skov døssing danish randomized lung cancer screening trial-overall design results prevalence round journal thoracic oncology vol. loog ginneken static posterior probability fusion signal detection applications detection interstitial diseases chest radiographs international conference pattern recognition vol. learning method generalized multi-instance problems europearn conference machine learning wang zucker solving multiple-instance problem lazy learning approach international conference machine learning ekalska harol duin spillmann bunke non-euclidean non-metric measures informative structural syntactic statistical pattern recognition rubner tomasi guibas earth mover’s distance metric image retrieval international journal computer vision vol. tragante fierens blockeel instance-level accuracy versus bag-level accuracy multi-instance learning proceedings benelux conference artiﬁcial intelligence", "year": 2017}