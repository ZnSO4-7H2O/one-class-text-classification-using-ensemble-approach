{"title": "Lose The Views: Limited Angle CT Reconstruction via Implicit Sinogram  Completion", "tag": ["cs.CV", "stat.ML"], "abstract": "Computed Tomography (CT) reconstruction is a fundamental component to a wide variety of applications ranging from security, to healthcare. The classical techniques require measuring projections, called sinograms, from a full 180$^\\circ$ view of the object. This is impractical in a limited angle scenario, when the viewing angle is less than 180$^\\circ$, which can occur due to different factors including restrictions on scanning time, limited flexibility of scanner rotation, etc. The sinograms obtained as a result, cause existing techniques to produce highly artifact-laden reconstructions. In this paper, we propose to address this problem through implicit sinogram completion, on a challenging real world dataset containing scans of common checked-in luggage. We propose a system, consisting of 1D and 2D convolutional neural networks, that operates on a limited angle sinogram to directly produce the best estimate of a reconstruction. Next, we use the x-ray transform on this reconstruction to obtain a \"completed\" sinogram, as if it came from a full 180$^\\circ$ measurement. We feed this to standard analytical and iterative reconstruction techniques to obtain the final reconstruction. We show with extensive experimentation that this combined strategy outperforms many competitive baselines. We also propose a measure of confidence for the reconstruction that enables a practitioner to gauge the reliability of a prediction made by our network. We show that this measure is a strong indicator of quality as measured by the PSNR, while not requiring ground truth at test time. Finally, using a segmentation experiment, we show that our reconstruction preserves the 3D structure of objects effectively.", "text": "computed tomography reconstruction fundamental component wide variety applications ranging security healthcare. classical techniques require measuring projections called sinograms full view object. however obtaining full-view always feasible scanning irregular objects limit ﬂexibility scanner rotation. resulting limited angle sinograms known produce highly artifact-laden reconstructions existing techniques. paper propose address problem using ctnet system convolutional neural networks operates directly limited angle sinogram predict reconstruction. x-ray transform prediction obtain completed sinogram came full °view. feed standard analytical iterative reconstruction techniques obtain ﬁnal reconstruction. show extensive experimentation challenging real world dataset combined strategy outperforms many competitive baselines. also propose measure conﬁdence reconstruction enables practitioner gauge reliability prediction made ctnet. show measure strong indicator quality measured psnr requiring ground truth test time. finally using segmentation experiment show reconstruction also preserves structure objects better existing solutions. introduction computed tomography common imaging modalities used industrial healthcare security settings today. typical parallel-beam imaging system x-ray measurements obtained viewing angles effectively combined produce cross-sectional image objects x-ray measurements collectively referred sinogram. inverse problem reconstructing cross-sectional images sinograms extensively studied imaging researchers several decades popular technique filtered back projection derived discretization closed-form solution inverse x-ray transform. alternatively iterative techniques weighted least squares also developed improve upon cases making successive approximations increasing accuracy obtain ﬁnal image. traditional setting assumes access measurements collected full range views object i.e. increasingly newer techniques developed recover images part views missing i.e. θmax referred limited angle projections reconstruction cases highly ill-posed evidenced inferior performance existing methods. need limited angle scans advantage setup drastically reduce scan time restricting physical movement scanner. scans used study organs heart objects highly dynamic implying slightly longer scan time introduces blurring image further limited angle setting help limit area scan region interest like healthcare applications breast dental tomography. also support applications involving objects physical constraints restricting angles scanned example electron microscopy recent works attempt solve problem variety formulations explicit sinogram regression limited view full-view reduction artifacts obtained using convolutional neural networks reﬁne poorly initialized reconstructions obtained however techniques simpler datasets less variability operate regimes majority viewing angles captured example instead paper performs reconstruction half views training i.e. challenging real world checked-in luggage dataset challenges generally speaking edge object recovered accurately image x-ray tangential edge captured. several x-rays contiguous views missing limited angle scenario signiﬁcant amount information regarding scene missing. loose analogy traditional computer vision like reconstructing scene partially occluded camera. last years datadriven approaches made signiﬁcant strides solving similar challenging image recovery problems image completion image-inpainting superresolution recovery methods leverage availability large datasets expressive power deep learning impose implicit constraints recovery problem. however reconstruction presents several additional challenges. unlike standard images images transportation luggage cargo etc. complex apparent dimensional structure. result even classical setting full-view scans training neural network end-to-end predict ﬁnal image challenging. exacerbated fact collecting large dataset images corresponding projections signiﬁcantly harder. consequently many state-of-the-art methods rely analytical techniques e.g. provide initial coarse estimate reﬁned using deep neural networks. extreme setting considered here highly misleading rendering subsequent techniques ineffective. example limited angle setting shown figure finally typically used critical applications necessitates need practitioners understand conﬁdence reliability reconstructions test time. proposed work paper address challenges ct-net system consisting convolutional neural networks coupled adversarial training recover slices limited angle sinograms. since sinograms certain consistency conditions hard enforce directly within neural network propose solve problem completing sinograms limited angle full view implicitly image space. words employ three-stage approach ﬁrst ct-net produces reconstruction based limited-angle sinogram. next project image sinogram space came full-view measurements using x-ray transform. lastly existing techniques obtain ﬁnal image. train network sinograms containing half viewing angles directly predict ground truth consisting reconstructions obtained full-view measurements. inspired success cnns language modeling network interprets sinogram sequence. formulation allows model projections individual views also enabling capture relationships across views simple attention model. consequently approach supports different number views test time even lower viewing angles seen figure proposed sinogram completion strategy able recover slices high ﬁdelity much better fbp. finally order generate conﬁdence measure recovery process propose estimate per-pixel variabilities perturbations latent space sinograms compute aggregated conﬁdence score. interestingly proposed score highly correlated actual reconstruction quality measured respect ground truth. figure overview proposed approach. training train ct-net predict slice directly limited angle sinograms. mean squared error adversarial loss. test time forward project ouput ct-net using x-ray transform complete sinogram. next completed sinogram obtain ﬁnal reconstruction. architectures generator discriminator described supplementary material. detailed list them. related different problem few-view reconstruction signiﬁcant interest. differs limited-view problem that reduces number viewing angles uniformly sampling possible range angles zhao proposed convolutional neural network framework recover poorly reconstructed images chen used similar approach denoise images low-dose recovery process closely resembles techniques used solving inverse problems vision recently super-resolution recovering images compressive measurements linear inverse problems compared sparse-view reconstruction limited angle problem challenging equivalent extrapolation sinogram space. tomographic reconstruction community numerous studies focused algebraic approaches inverse problems particular utilizing algebraic reconstruction techniques variants multiplicative examples include work mart-ap simultaneous mart further chen proposed adaptive non-local means based reconstruction method compensate over-smoothed image edges few-view reconstructions addition exist methods utilize dictionary learning techniques coupled sparse representations total variation optimization few-view low-dose reconstruction tasks despite availability varied solutions best knowledge work ﬁrst addresses problem limited-view reconstruction directly operating limited-view sinogram using viewing angles figure experimental setup x-ray computed tomography. object rotated along axis exposed parallel beam x-rays. intensity attenuated x-rays exiting object measured detector regular angular intervals. projection angle measured distance detector line integral values along line perpendicular detector x-ray non-destructive imaging modality used reconstruct interior morphology object scanned using x-ray radiation. experiments object imaged placed source parallel beam x-rays planar detector array. x-rays attenuated propagate object intensity attenuated x-rays exiting object measured detector. perform tomographic imaging object rotated along axis repeatedly imaged regular angular intervals rotation. rotation angle object measurements detector expressed line integration linear attenuation coefﬁcient values along propagation path. assume object stationary cartesian coordinate system described axes then projection distance detector given object clockwise angle equivalent rotating source detector pair counterclockwise angle vice versa. notice equation separable coordinate. hence projection relation essentially function plane repeatedly applied along z−axis. next describe popular reconstruction algorithms. filtered back-projection analytic algorithm reconstructing sample projections rotation angles directly inverts relation solve values ﬁrst compute fourier transform projection function ﬁltered back projection reconstruction given equation ﬁltered version smeared back plane along direction reconstruction thus consists cumulative smeared contributions projections ranging projections acquired limited angular range integration incomplete angular space. since projection contains cumulative values rotation angle also contains information edges oriented along angular direction figure suppose data acquisition starts stops angle θmax then edge information contained projections angles missing ﬁnal reconstruction. reason behind edge blur reconstructions shown ﬁgure weighted least squares iterative method reconstructing sample formulating reconstruction solution cost minimization problem. belongs class model-based reconstruction algorithms albeit without form regularization. overview proposed approach described figure section describe details approach outline training testing strategies. limited angle sinogram collection measurements given object stored matrix form range views spanning corresponds single view. completing sinogram directly challenging since consistency conditions sinogram space cannot easily enforced training process. therefore resort implicit sinogram completion process converts limited-angle sinogram full view described next. ct-net ﬁrst embeds limited angle sinogram latent space using fully convolutional cnn. convolutions meaningful context since allow simple attention model study correlations across neighboring views. interpret sinograms sequence projections corresponding different viewing angles similar sentence modeling literature architecture multiple ﬁlters varying window sizes order capture information across different sized neighborhoods. ﬁlter produces embedding corresponding window size resulting ﬁnal embedding dimensions ilters denotes different number window sizes considered. details implementation. case ilters ﬁlters window sizes resulting dimensional embedding. design formulation supports varying number rows input sinogram. latent representation decoded corresponding image using predict desired image. decoder fully convolutional projection layer beginning consists residual units training losses trained ct-net standard mean squared error loss lmse denote predicted ground truth images respectively. training naturally results highest psnr ssim metrics optimizes speciﬁcally them however result highly smoothed images resulting solution obtained average many possible solutions. also adversarial loss uses discriminator guide ct-net generate realistic looking reconstructions. practice results sharper edges visibly high frequency content. similar observations reported case super resolution found psnr weak surrogate visual quality using adversarial loss produces sharper rendering. adversarial loss measured ladv log) represents discriminator whose role distinguish generated image actual slice training dataset. loss discriminator log) log). ﬁnal loss generator hence obtained lmse λladv. found suitable choice resulting best reconstructions. details networks inside ct-net found supplementary material. sinogram completion prediction ct-net sinogram obtain fullview sinogram using corresponds x-ray transform computes sinogram views available current image slice rows corresponding obtain completed sinogram scomplete obtain ﬁnal reconstruction scomplete using using equations respectively. conﬁdence score reconstructions reconstruction often used critical applications healthcare security incorrect misleading reconstruction negative consequences. fact even important perform reconstruction incomplete data operating highly under-constrained setting. order address this propose conﬁdence score measures reliability reconstruction given limited angle sinogram. score evaluated test time require ground truth estimation. test time d-cnn embeds limited-angle sinogram latent space randomly perturb vector using dropout strategy reconstruct image perturbed latent representations. experiments dropout probability given sinogram repeat multiple times measure per-pixel variance resulting reconstructions. intuition network sufﬁcient information recover slice small perturbations latent space affect ﬁnal output signiﬁcantly. however sinogram reliably capture information scene corresponding latent representation tends unstable thus leading signiﬁcant changes reconstruction small perturbations latent vector. though simple heuristic norm per-pixel variances directly used conﬁdence metric highly sensitive number objects present scan. hence propose following metric conﬁdence score reconstruction given per-pixel variance matrix actual predicted image obtained latent space perturbation deﬁne variances normalized total norm reconstructed image. metric acts strong indicator actual reconstruction quality measured psnr respect ground truth image. since evaluation metric require ground truth used practitioner evaluate reconstruction test time without actually generating ground truth. dataset evaluate methods dataset scans common checked-in luggage collected using imatron electron-beam medical scanner device similar found transportation security systems. dataset provided alert center excellence northeastern university development testing automatic threat recognition systems. repurpose dataset generating reconstructions sinograms. dataset comprised bags roughly slices average. total dataset consists full view sinograms along corresponding reconstructions. original slices perform experiments downsampled versions size correspondingly sinograms subsampled size corresponds views obtained every .°sampled figure reconstruction results psnr shown reconstruction measured ground truth. noted sinogram completion much better preserving geometric shape baselines apart superior terms psnr. sinogram completion ct-net -mse ct-net -adv performed nearly followed wls. also show nearest reconstruction training based distance sinogram latent space. uniformly split bags training bags test rest. split resulted image slices training around image slices testing. bags contain variety everyday objects clothes food electronics etc. arranged random conﬁgurations. experiments assume access half sinogram results observing half views partial sinogram train ct-net different baselines. initial processing step perform basic ﬁltering remove intensity noise ground truth reconstructions obtained using views. ground truth middle proposed reconstruction bottom pixel-wise conﬁdence map. light indicates conﬁdent. figure properties ct-net pixel-wise conﬁdence measures values shown scale values proposed measure conﬁdence acts strong indicator quality reconstruction demonstration behavior proposed approach varying number views testing. physically represent viewing angles going -°clockwise shown ﬁgure consistently drop views across training images testing images. training details parameters trained networks using tensorﬂow nvidia tesla gpu. perform scaling sinograms reconstructions since value ranges globally consistent across entire dataset. further decoder networks regardless loss function. used ﬁlter sizes employed adam optimizer learning rate using loss. adversarial loss learning rate exponential decay rate ﬁrst moment estimates reconstruction results obtained using different baseline solutions proposed approach shown figure baseline techniques include state-ofpractice methods namely variants ct-net adversarial losses. observe that general implicit sinogram completion followed analytical reconstruction produces accurate reconstructions compared methods directly predict image particular ct-net-mse ct-net-adv performed nearly followed therefore show ct-net -adv+wls ﬁgure brevity. reconstruction compute psnr value structural similarity measures respect ground truth. figure evident proposed solution particular signiﬁcantly better existing approaches baseline architectures. furthermore table show mean psnr ssim randomly chosen slices test set. even though performance better measured psnr ssim image space reﬂective large improvements reconstruction quality. hence also measure psnr sinogram space forward projecting images using x-ray transform comparing ground truth sinogram. denoted spsnr table sinogram space psnr shows ctnet signiﬁcantly better existing baseline approaches overall proposed solution sinogram completion performs best terms metrics. conﬁdence score reconstruction described section proposed conﬁdence score provide guidance qualitatively evaluate reconstructions withactually generating ground truth test sample. illustrate pixel-wise conﬁdence measures figure different images decreasing levels reliability obtained using ct-net -adv. notice cases noisy reconstructions i.e. cases partial views considered sufﬁciently capture properties scene directly correspond lower conﬁdence shown measure displayed variance maps. figure test hypothesis proposed conﬁdence measure strong indicator actual reconstruction quality measured psnr. strong correlation psnr proposed metric test images validates hypothesis overwhelming evidence null hypothesis related p-value=. table psnr ssim measures comparing randomly sampled test slices ground truth. completing sinogram ct-net followed superior baseline methods. psnr ssim metrics image space s-psnr sinogram space. ssim s-psnr testing fewer views training design formulation allows variable number views sinogram. practice translates reasonably stable reconstructions reduction number views test time. note that views dropped random consecutive sequence. retraining network every unique views arduous task. network handle cases well producing reconstructions whose quality degrades gracefully incremental loss number views. example shown ﬁgure show reconstructions obtained using views ranging test time. figure segmentation limited-view reconstructions employ region growing segmentation cases resulting segmentations shown color rendering reconstructed images underneath. clearly evident method performs similar ground truth determining object boundaries compared wls. clearly demonstrate usefulness practice. consider segmentation process since often critical step prior performing complex inference tasks threat detection popular regiongrowing based segmentation proposed identify high intensity objects bags reconstructions partial views. show example image slices rendered using slices reconstructed proposed ct-net -adv+wls alone respectively figure compare segmentations obtained using method segmentation labels obtained using wls. seen example preserves edges poorly resulting spurious segments whereas proposed reconstruction signiﬁcantly better resembling ground truth. additional segmentation results found supplementary material. paper proposed accurately recover images viewing angle limited pose problem sinogram completion solve image domain. empirical studies demonstrate effectiveness three-stage approach ﬁrst computes neural network based reconstruction obtains full-view sinogram using x-ray transform based reconstruction obtains ﬁnal reconstruction completed sinogram. also proposed conﬁdence score gauge reliability recovery process reasonable surrogate image quality. failure cases method works best scenes large objects appear frequency content images. observe signiﬁcant gain complicated scenes contain multiple small objects intricate designs since manifest high frequency image content hard recover ill-posed problem setup. however even limitation able recover structure well shown figure realistic data practical use. finally since dataset intended limited angle reconstruction examples objects view network information recover them. future work several important directions forward work include forward projection step ﬁnal layer inside ct-net optimize reconstruction setup end-to-end; along reconstruction jointly infer segmentations sinograms multi-task learning setting.", "year": 2017}