{"title": "Robust Probabilistic Modeling with Bayesian Data Reweighting", "tag": ["stat.ML", "cs.AI", "cs.LG"], "abstract": "Probabilistic models analyze data by relying on a set of assumptions. Data that exhibit deviations from these assumptions can undermine inference and prediction quality. Robust models offer protection against mismatch between a model's assumptions and reality. We propose a way to systematically detect and mitigate mismatch of a large class of probabilistic models. The idea is to raise the likelihood of each observation to a weight and then to infer both the latent variables and the weights from data. Inferring the weights allows a model to identify observations that match its assumptions and down-weight others. This enables robust inference and improves predictive accuracy. We study four different forms of mismatch with reality, ranging from missing latent groups to structure misspecification. A Poisson factorization analysis of the Movielens 1M dataset shows the benefits of this approach in a practical scenario.", "text": "consider movie recommendation system. gather data people watching movies account imagine situation observations corrupted example child logs account regularly watches popular animated ﬁlms. parents account watch horror movie. recommendation models like poisson factorization struggle kind corrupted data begins recommend horror movies. done detect mitigate effect? strategy design models less sensitive corrupted data replacing gaussian likelihood heavier-tailed distribution probabilistic models sophisticated structures; template solutions speciﬁc distributions readily applicable. classical robust techniques mostly distances observations approaches struggle high-dimensional data. still make favorite probabilistic models making less sensitive messy nature reality? main idea. propose reweighted probabilistic models idea simple. first posit probabilistic model. adjust contribution observation raising likelihood term weight. finally infer weights along latent variables original probability model. posterior adjusted model identiﬁes observations match assumptions; downweights observations disagree assumptions. probabilistic models analyze data relying assumptions. data exhibit deviations assumptions undermine inference prediction quality. robust models offer protection mismatch model’s assumptions reality. propose systematically detect mitigate mismatch large class probabilistic models. idea raise likelihood observation weight infer latent variables weights data. inferring weights allows model identify observations match assumptions down-weight others. enables robust inference improves predictive accuracy. study four different forms mismatch reality ranging missing latent groups structure misspeciﬁcation. poisson factorization analysis movielens dataset shows beneﬁts approach practical scenario. probabilistic modeling powerful approach discovering hidden patterns data. begin expressing assumptions class patterns expect discover; design probability model. follow inferring posterior model; discover speciﬁc patterns manifest observed data set. advances automated inference enable easy development models machine learning artiﬁcial intelligence paper present recipe robustify probabilistic models. mean robustify? departure model’s assumptions undermine inference prediction performance. arise corrupted jointly weights latent variables work together automatically identify unlikely measurements focus observations match original model’s assumptions. section presents intuitions full detail along theoretical corroboration. section study four models various forms mismatch reality including missing modeling assumptions misspeciﬁed nonlinearities skewed data. rpms provide better parameter inference improved predictive accuracy across models. section presents recommendation system example improve predictive performance identify atypical enthusiasts movielens dataset. related work. jerzy neyman elegantly motivates main idea behind robust probabilistic modeling ﬁeld attracted much research attention past century. every attempt mathematics study real phenomena must begin building mathematical model phenomena. necessity model simpliﬁes matters greater lesser extent number details ignored. solution mathematical problem correct violent conﬂict realities simply original assumptions mathematical model diverge essentially conditions practical problem considered. top-level latent variable ties together variables localization decreases effect imprecise measurements. rpms present broader approach mitigating mismatch improved performance localization rupted measurements undermine original model; bayesian data reweighting automatically trades likelihood corrupted data near focus uncorrupted data near zero. detects mismatch mitigates effect compared poor original model posterior inference loosely speaking seeks maximize respect prior weights plays critical role trades extremely likelihood terms caused corrupted measurements encouraging weights close one. study three options prior section bayesian data reweighting induce robustness? first consider weights affect equation logarithm priors dominated term price moving towards zero. shrinking gain increase paying price gain outweighs price negative. priors prefer stay close one; shrinks unlikely measurements. consider latent variables affect equation weights unlikely measurements shrink likelihood term afford assign mass corrupted measurements focus rest dataset. figure rpms begin probabilistic model introduce weights latent variables. gives model explores data observations match assumptions. localization instead builds hierarchical model. reweighted model introduces weights; latent variables support gain intuition consider weights affect posterior proportional product likelihood every measurement. weight close zero ﬂattens corresponding likelihood weight larger makes likelihood peaked. this turn enables posterior focus measurements others. prior ensures many likelihood terms ﬂattened; sense plays important regularization role. study three options prior weights bank beta distributions scaled dirichlet distribution bank gamma distributions. bank beta priors. option constrains weight posit independent prior weight third theme data reweighting. involves designing individual reweighting schemes speciﬁc tasks models. consider robust methods toss away outliers. strategy involves manually assigning binary weights datapoints another example covariate shift adaptation/importance sampling reweighting transforms data match another target distribution ﬁnal example maximum lqlikelihood estimation solutions interpreted solution weighted likelihood whose weights proportional power transformation density. contrast rpms treat weights latent variables. weights automatically inferred; custom design required. rpms also connect ideas around ensemble learning boosting boosting procedures reweight datapoints build ensemble predictors supervised learning whereas rpms apply bayesian models general. reweighted probabilistic models offer approach robust modeling. idea automatically identify observations match assumptions model base posterior inference observations. reweighted density integrates normalizing factor ﬁnite. always true likelihood exponential family distribution lesbegue base measure class models study paper. similar argument holds exponential family priors sufﬁcient statistic. formalize intuition generalize following theorem establishes sufﬁcient conditions improves inference latent variables theorem denote true value posterior mean weighted unweighted model respectively. assume mild conditions corruption level holds high probability. then exists denotes second order stochastic dominance. likelihood bounding assumption common robust statistics theory; satisﬁed likely unlikely measurements. much improvement give? quantify inﬂuence function ¯βw. consider distribution statistic function data comes take ﬁxed distribution e.g. population distribution then measures much additional observation affects statistic deﬁne limit exists. roughly measures asymptotic bias caused speciﬁc observation come consider statistic robust bounded function i.e. outliers exert limited inﬂuence here study posterior mean true data generating distribution value likelihood nearly zero; think parameters offer expressive language describe different attitudes towards weights. example setting parameters less makes beta like spikes slab prior encouraging weights close zero between. another example setting greater encourages weights lean towards one. scaled dirichlet prior. option ensures weights equals posit symmetric dirichlet prior weights scalar parameter vector ones. original model weights weights dirichlet option maintains balance; certain likelihoods become peaked others ﬂatten compensate. concentration parameter gives intuitive conﬁgure dirichlet. small values allow model easily updown-weight many data observations; larger values prefer smoother distribution weights. dirichlet option connects bootstrap approaches rubin kucukelbir blei also preserves weights bank gamma priors. posit independent gamma prior weight bank beta dirichlet options perform similarly. prefer beta option conservative dirichlet less sensitive parameters. explore options empirical study theory justify bayesian data reweighting? investigate robustness properties. analyses intend conﬁrm intuition section appendices present proofs full technical detail. intuition. recall logarithm joint density equation compute maximum-a-posterior using real data. default no-u-turn sampler inference experiments except sections leverage variational inference additional computational cost inferring weights unnoticeable relative inference original model. router receives packets network measures time waits packet. suppose typically observe wait-times follow poisson distribution rate model measurement using poisson likelihood poisson posit gamma prior rate gam. imagine percent time network fails. failures wait-times come poisson much higher rate thus data actually contains mixture poisson distributions; model assumes one. figure outliers simulation study. compare beta priors reweighted probabilistic model. posterior distributions show marked difference detecting correct wait-time rate posterior conﬁdence intervals across failure rates show consistent behavior beta dirichlet priors. expect behave situation? suppose network failed time. figure shows posterior distribution rate original posterior centered troubling rate wrong also conﬁdent posterior localization introduces greater uncertainty still estimates rate around correctly turn inferring posterior posterior lacks analytic closed-form expression simplest models; even original model admits posterior reweighted posterior take different form. approximate posterior appeal probabilistic programming. probabilistic programming system enables user write probability model computer program compile program inference executable. automated inference backbone systems takes probability model expressed program outputs efﬁcient algorithm inference. automated inference stan probabilistic programming system empirical study follows highlight rpms detect mitigate various forms model mismatch. common metric compare predictive accuracy held data original localized reweighted model. calized latent variable datapoint. prior form equation bayesian data reweighting gives following posterior predictive likelihood prpm pprpmp prpm marginal posterior integrating inferred weights training dataset prior form equation study rpms four types mismatch reality. section involves simulations realistic scenarios; next section presents recommendation system example simulate scenario drawing binary indicators color blindness bernoulli) pn’s come latent groups exhibit stronger dependency family history women simulate family history unif. consider bayesian logistic regression model without intercept. posit prior slope assume beta prior weights. figure missing latent groups study. posterior credible intervals always include dominant βmen vary percentage females data. dataset size replications. figure shows posterior credible intervals vary percentage females horizontal line indicates correct slope dominant group βmen size missing latent group increases original model quickly shifts credible interval away reweighted localized posteriors contain βmen percentages localized model exhibits much higher variance estimates. analysis shows rpms mitigate effect missing latent groups. original logistic regression model would perform equally poorly groups able automatically focus dominant group. figure kernel density estimate distribution weights across measurements missing latent groups study. percentage females denoted hypothetical clean dataset receives weights concentrate around one; actual corrupted dataset exhibits two-hump distribution weights. figure shows posterior credible intervals failure rates robust corrupted measurements; instead focuses data explain within assumptions. corruption performs well original model. visualizing weights elucidates point. figure shows posterior mean estimates weights sorted groups ease viewing. weights corrupted observations essentially zero; downweighting allows shift posterior towards ﬁve. figure posterior means weights dirichlet prior. visualization purposes sorted data groups ﬁrst contain observations normal network; remaining observations network fails. despite downweighting posteriors overdispersed localized case. interplay described introduction. downweighting observations lead smaller effective sample size would increase posterior uncertainty. downweighted datapoints corrupted observations; including also increases posterior uncertainty. insensitive prior weights; beta dirichlet options perform similarly. focus beta option. shape parameter scale data size encodes mild attitude towards unit weights. move forms mismatch reality. color blindness unevenly hereditary much higher women suppose aware fact. dataset genders individual’s color blindness status his/her relevant family history. gender information available. consider analyzing data using logistic regression. capture hereditary group. thus logistic regression misrepresents groups even though exhibit strong heredity. contrast detect mitigate tions original model. figure shows kernel density estimate inferred posterior weights. hypothetical dataset corrupted measurements receives weights close one. contrast actual dataset measurements missing latent group exhibit bimodal distribution weights. testing bimodality inferred weights used diagnose mismatch reality. consider study lung cancer risk. tobacco usage exhibits clear connection factors also contribute. instance obesity tobacco usage appear interact evidence towards quadratic dependence obesity denote tobacco usage obesity study three models lung cancer risk dependency covariates. primarily interested understanding effect tobacco usage; thus focus regression coefﬁcient tobacco. model form covariance misspeciﬁcation discriminates true structure assumed structure. model simulate dataset size random covariates regression coefﬁcients unif. consider bayesian linear regression model prior table summarizes misspeciﬁcation shows absolute differences estimated regression coefﬁcient. yields better estimates ﬁrst models. highlight leverages datapoints useful estimating third model particularly challenging obesity ignored misspeciﬁed model. here gives similar results original model; highlights rpms available information. since original model lacks dependence cannot compensate this. finally show rpms handle skewed data. dirichlet process mixture model versatile model density estimation clustering real data indeed come ﬁnite mixture clusters reason assume cluster distributed gaussian. inspired experiments miller dunson show reweighted dpmm reliably recovers correct number components mixture skewnormals dataset. standard gaussian mixture model large sparse dirichlet prior mixture proportions approximation dpmm simulate three clusters two-dimensional skewnormal distributions maximum automatic differentiation variational inference nuts struggles inference mixture models figure shows posterior mean estimates original gmm; incorrectly ﬁnds clusters. contrast identiﬁes correct three clusters. datapoints tails cluster down-weighted; datapoints match gaussianity assumption model. table posterior predictive likelihoods clean corrupted test data. outliers missing latent groups misspeciﬁed structure missing interaction term. results similar levels types mismatch reality. sponding rpm. boxplot figure shows inferred weights. majority users receive weight users down-weighted. enthusiasts appear indiscriminately watch many movies many genres. users contribute towards identifying movies together; explains down-weights them. recall example introduction. child typically watches popular animated ﬁlms parents occasionally account watch horror ﬁlms. simulate corrupting small percentage users. replace ratio users’ movies randomly selected movies. boxplot figure shows weights infer corrupted users based many movies randomly replace. weights decrease corrupt movies. table shows leads higher heldpredictive accuracy; down-weighting corrupted users leads better prediction. reweighted probabilistic models offer systematic approach mitigating various forms mismatch reality. idea raise data likelihood weight infer weights along hidden patterns. demonstrate strategy introduces robustness improves prediction accuracy across four types mismatch. rpms also offer detect mismatch reality. distribution inferred weights sheds light onto datapoints fail match original model’s assumptions. rpms thus lead model development deeper insights data. turn study real data recommendation system. consider video streaming service; data comes binary matrix users movies choose watch. identify patterns data? poisson factorization offers ﬂexible solution idea infer k-dimensional latent space user preferences movie attributes inner product determines rate poisson likelihood binary measurement; gamma priors promote sparse patterns. result ﬁnds interpretable groupings movies often clustered according popularity genre. classical compare reweighted counterpart? input movielens dataset contains million movie ratings users movies. place gamma priors preferences attributes. here option reweighting users items. focus users place beta prior weights. model estimation. figure inferred weights clean corrupted data. users receive weights close one. corrupted users receive weights much smaller one. larger ratios corruption imply lower weights. rpms also work non-exchangeable data time series. time series models admit exchangeable likelihood approximations models non-overlapping windowing approach would also work. idea reweighting could also extend structured likelihoods hawkes process models. thank adji dieng yuanjun inchi christian naesseth rajesh ranganath francisco ruiz dustin tran joshua vogelstein insightful pointers comments. work supported iis- n--- darpa ppaml fa--- darpa simplex n--c- alfred sloan foundation. references berger james moreno elías pericchi luis raul bayarri jesús bernardo josé cano juan horra julián martín jacinto ríos-insúa david betrò bruno overview robust bayesian analysis. test carpenter gelman andrew hoffman matt daniel goodrich betancourt michael brubaker marcus jiqiang peter riddell allen. stan probabilistic programming language. journal statistical software kucukelbir tran dustin ranganath rajesh gelman andrew blei david automatic differentiation variational inference. journal machine learning research neyman jerzy. problem estimating number schools ﬁsh. neyman loeve yerushalmy university california publications statistics volume chapter university california press odegaard andrew pereira mark woon-puay gross myron duval mimi yuan jian-min. all-cause cause-speciﬁc mortality chinese singaporean women. plos yichen priebe carey maximum q-likelihood estimation expectation-maximization algorithm journal robust estimation mixture models. american statistical association shimodaira hidetoshi. improving predictive inference under covariate shift weighting log-likelihood function. journal statistical planning inference song qing wenjie wenfang. robust support vector machine bullet hole image classiﬁcation. systems cybernetics part applications reviews ieee transactions sugiyama masashi krauledat matthias müller klaus-robert. covariate shift adaptation importance weighted cross validation. journal machine learning research veach eric guibas leonidas optimally combining sampling techniques monte carlo rendering. proceedings annual conference computer graphics interactive techniques localized generalized linear model localization generalized linear models equivalent reweighting constraints weight function induced prelude theorem simple illustration linear regression. consider observations assumption holds assumption includes following cases close true parameter i.e. corruption almost coincide. assumption precisely explains assumption var) general assumption particularly restrictive. instance normal likelihood var) theorem assume assumption -assumption exists ¯βu− denotes second order stochastic dominance. proof sketch. resort estimates {wn}n bernstein-von mises theorem exists s.t. implies posterior means close whole proof theorem formalize intuitive argument downweight observation whenever deviates truth posterior estimate closer without downweighting given presence disruptive observations. skewed distributions generate data size mixture three skewed normal distributions location parameters scale parameters shape parameters mixture proportions true number components data poisson factorization models matrix count data low-dimensional inner product consider data matrix sized non-negative integer elements xui. recommendation example users items entry rating user item title crime|thriller usual suspects drama|mystery|sci-fi|thriller space odyssey comedy|romance|thriller ghost animation|children’s|musical lion king drama|romance leaving vegas action|adventure|sci-fi star trek generations african queen action|adventure|romance|war action|adventure|thriller comedy comedy|romance comedy|romance musical|romance comedy|romance animation|children’s|musical documentary drama comedy|drama comedy|drama film-noir|romance|thriller comedy comedy|romance comedy|drama action|drama|mystery comedy drama|romance animation|children’s|musical animation|children’s|musical drama comedy action|comedy|musical|sci-fi action|adventure comedy|drama musical|romance children’s|drama drama drama comedy drama comedy comedy drama|romance drama|thriller drama comedy drama comedy|drama|romance adventure|comedy|musical thriller drama|romance comedy|drama|war comedy|drama sci-fi|thriller comedy goldeneye birdcage much nothing hudsucker proxy fair lady philadelphia story james giant peach crumb remains adventures priscilla queen desert reality bites notorious brady bunch movie roman holiday apartment rising bringing baby bridges madison county pocahontas hunchback notre dame smith goes washington girl friday tank girl adventures robin hood drink woman american paris secret garden short cuts degrees separation first wives club innocence father bride favorite year shadowlands folks call sling blade little women kids hall brain candy roof corrina corrina muppet treasure island steps farewell concubine renaissance honors virtuosity cold comfort farm drama without face drama east eden drama three colors white action shadow comedy|romance boomerang action|horror|sci-fi hellraiser bloodline drama basketball diaries comedy godfrey comedy brady sequel sci-fi|thriller screamers children’s|comedy richie rich drama beautiful girls musical meet louis drama|romance ghost mrs. muir comedy|drama waiting exhale mystery|romance|thriller boxing helena drama belle jour goofy movie animation|children’s|comedy spitﬁre grill drama horror|sci-fi village damned comedy|horror dracula dead loving comedy|drama|romance twelfth night western dead miracle street drama horror|thriller halloween curse michael myers crime|drama warriors adventure|comedy|fantasy king arthur’s court comedy road wellville restoration drama animation|children’s oliver company drama basquiat adventure|animation|fantasy pagemaster drama giant action|adventure|thriller surviving game drama|thriller city hall herbie rides adventure|children’s|comedy drama|musical drama|musical drama comedy|romance drama|romance drama|mystery|romance adventure|children’s|drama comedy action|sci-fi|thriller drama drama drama comedy|drama comedy comedy sci-fi|thriller western comedy|romance adventure|children’s|fantasy horror comedy backbeat umbrellas cherbourg ruby paradise mrs. winterbourne roses chungking express free willy adventure home party girl solo stealing beauty burnt naked kicking screaming jeffrey made america lawnmower beyond cyberspace davy crockett king wild frontier vampire brooklyn neverending story candyman farewell flesh there high school high young poisoner’s handbook jane eyre jury duty girl farinelli castrato chamber blue face little buddha king hill shanghai triad scarlet letter blue chips house spirits huck life mikey love money princess caraboo addiction mrs. parker vicious circle cops robbersons wonderful horrible life leni riefenstahl strawberry chocolate bread chocolate human bondage live flipper wrong maya strong clear vision horseman roof moonlight valentino andre house arrest celtic pride amateur white man’s burden heidi fleiss hollywood madam adventures pinocchio national lampoon’s senior trip angel badman poison bitter moon perez family georgia love afternoon inkwell bloodsport company underneath widows’ peak alaska jefferson paris penny serenade green comedy crime drama|romance comedy comedy drama|musical drama comedy drama drama drama drama drama drama|romance adventure|children’s comedy comedy drama horror drama comedy documentary drama drama drama drama drama adventure|children’s comedy drama|mystery documentary drama drama|romance adventure|children’s comedy comedy crime|drama|thriller drama documentary adventure|children’s comedy western thriller drama comedy|romance drama comedy|romance comedy|drama action action mystery|thriller drama adventure|children’s drama drama|romance children’s|comedy happened was... comedy|drama|romance documentary great harlem underground comedy house party comedy|drama roommates comedy getting even drama beloved country stalingrad documentary endless summer drama browning version children’s|drama fluke drama scarlet letter comedy|romance pyromaniac’s love story horror castle freak drama double happiness comedy|drama month lake drama upon time... colored comedy|romance favor drama manny comedy|sci-fi visitors comedy|crime carpool drama|romance total eclipse drama panther lassie adventure|children’s drama drama comedy crime|thriller drama documentary comedy|drama drama comedy comedy crime romance comedy drama action colonel chabert drama|romance|war comedy comedy|romance drama comedy comedy|romance comedy action drama|romance drama comedy|drama amazing panda adventure adventure|children’s documentary documentary drama comedy drama drama|thriller thriller it’s party kaspar hauser takes purple noon nadja haunted world edward wood dear diary faces love human remains house curdled jack sarah denise calls aparajito hunted clean slate crime crime|drama killer journal murder mystery crime|drama jersey drive adventure|children’s gold diggers secret bear mountain spirits dead horror fear horror journals jean seberg documentary celestial clockwork comedy crime|drama made criminal year documentary drama comedy|drama reluctant debutante savage nights drama faithful comedy land freedom boys drama comedy|drama squeeze animation|children’s gumby movie things fair drama children’s|drama inﬁnity drama peanuts bank zahlt alles comedy ed’s next move comedy drama|mystery hour walk drama death garden drama collectionneuse drama bite drama original gangstas crime gordy comedy last klezmer documentary butterﬂy kiss thriller talk angels drama line duty action tarantella drama domin tree drama dingo drama billy’s holiday drama venice/venice drama life drama phat beach comedy catwalk documentary fall time drama scream stone drama frank ollie documentary bye-bye drama documentary|drama tigrero film never made wend kuuni drama sonic outlaws documentary getting away murder comedy fausto comedy brothers trouble drama foreign student drama tough deadly action|drama|thriller mystery moonlight murder schlafes bruder drama metisse comedy promise romance drama|romance keiner weint nach hungarian fairy tale fantasy liebelei romance paris france comedy girl cadillac drama hostile intentions action|drama|thriller bits drama rent-a-kid comedy drama|horror beyond bedlam touki bouki drama convent drama open season comedy lotto land drama frisk drama shadow angels drama comedy|drama yankee zulu last high kings drama sunset park drama happy weekend comedy criminals documentary happiness field comedy associate comedy action|drama target horror|thriller relative fear honigmond comedy vichy documentary sweet nothing drama harlem drama condition action|drama|thriller drama comedy drama drama comedy drama drama guardian angel action|drama|thriller drama drama drama action|crime drama", "year": 2016}