{"title": "Convolutional Experts Constrained Local Model for Facial Landmark  Detection", "tag": ["cs.CV", "cs.AI"], "abstract": "Constrained Local Models (CLMs) are a well-established family of methods for facial landmark detection. However, they have recently fallen out of favor to cascaded regression-based approaches. This is in part due to the inability of existing CLM local detectors to model the very complex individual landmark appearance that is affected by expression, illumination, facial hair, makeup, and accessories. In our work, we present a novel local detector -- Convolutional Experts Network (CEN) -- that brings together the advantages of neural architectures and mixtures of experts in an end-to-end framework. We further propose a Convolutional Experts Constrained Local Model (CE-CLM) algorithm that uses CEN as local detectors. We demonstrate that our proposed CE-CLM algorithm outperforms competitive state-of-the-art baselines for facial landmark detection by a large margin on four publicly-available datasets. Our approach is especially accurate and robust on challenging profile images.", "text": "constrained local models well-established family methods facial landmark detection. however recently fallen favor cascaded regression-based approaches. part inability existing local detectors model complex individual affected expression illumination facial hair makeup accessories. work present novel local detector convolutional experts network brings together advantages neural architectures mixtures experts end-to-end framework. propose convolutional experts constrained local model algorithm uses local detectors. demonstrate proposed ce-clm algorithm outperforms competitive state-of-the-art baselines facial landmark detection large margin four publicly-available datasets. approach especially accurate robust challenging proﬁle images. facial landmark detection essential initial step number research areas facial expression analysis face modeling facial attribute analysis multimodal sentiment analysis emotion recognition person identiﬁcation well-researched problem large amounts annotated data seen surge interest past couple years. figure appearance facial landmark naturally clusters around appearance prototypes order model appearance variations effectively introduce convolutional experts network brings together advantages neural architectures mixtures experts model landmark alignment probability. facial landmark individually using local detectors shape model perform constrained optimization. clms contain many beneﬁts extensions many approaches lack modeling appearance landmark individually makes clms robust occlusion natural extension shape model multi-view local detectors allow clms deal naturally pose variations landmark self-occlusions expectation maximization-based model leads smoothness tracking videos makes appealing facial landmark detection tracking method. despite beneﬁts clms recently outperformed various cascaded regression models believe relative under-performance based methods local detectors able model complex variation local landmark appearance shown figure robust accurate local detector explicitly model different appearance prototypes present landmark. paper extended version cvpr-w submission introduce novel local detector called convolutional experts network brings together advantages neural architectures mixtures experts end-to-end framework able learn mixture experts capture different appearance prototypes without need explicit attribute labeling. tackle facial landmark detection present convolutional experts constrained local model model uses local detector. evaluate beneﬁts local detector ce-clm facial landmark detection algorithm extensive experiments four publiclyavailable datasets ijb-fl menpo challenge latter datasets include large portion proﬁle face poses extremely challenging conditions. furthermore latter three cross-dataset experiments. structure paper follows discuss related work section ce-clm introduced section section evaluate local detector compare ce-clm facial landmark detection approaches. conclude paper section facial landmark detection plays crucial role number research areas applications facial attribute detection facial expression analysis emotion recognition sentiment analysis facial reconstruction full review work facial landmark detection outside scope paper refer reader recent reviews ﬁeld modern facial landmark detection approaches split major categories model-based regressionbased. model based approaches often model appearance shape facial landmarks explicitly latter constraining search space providing form regularization. regression-based approaches hand require explicit shape model landmark detecmodel-based approaches best parameters face model match appearance image. popular model-based method constrained local model various extensions constrained local neural fields discriminative response fitting advanced methods computing local response maps inferring landmark locations. another noteworthy model-based approach mixture trees model uses tree based deformable parts model jointly perform face detection pose estimation facial landmark detection. extension approach gauss-newton deformable part model jointly optimizes part-based ﬂexible appearance model along global shape using gauss-newton optimization. recently-proposed dense face alignment method updates parameters morphable model using shown good performance facial landmark detection proﬁle faces. regression-based models predict facial landmark locations directly appearance. majority approaches follow cascaded regression framework landmark detection continually improved applying regressor appearance given current landmark estimate explicit shape regression cascaded regression approaches include stochastic descent method uses sift features linear regression compute shape update coarse-to-fine shape searching attempts avoid local optima performing coarse shape search. project cascaded regression another cascaded regression example updates shape model parameters rather predicting landmark locations directly. recent work also used deep learning techniques landmark detection. coarse-to-fine auto-encoder networks visual features extracted auto-encoder together linear regression. proposed based cascaded regression approach sparse landmark detection. similarly zhang proposed multi-task learning framework improve facial landmark performance training network also learn facial attributes. finally trigeorgis proposed mnemonic descent method uses recurrent neural network perform cascaded regression based visual features extracted around landmark locations. convolutional experts constrained local model algorithm consists main parts response computation using convolutional experts network shape parameter update. ﬁrst step individual landmark alignment estimated independently posifigure overview convolutional experts network model. input image given based estimate landmark position region interest size extracted small region goes contrast normalizing convolutional layer kernel shape performs z-score normalization correlation operation outputs afterwards response maps input convolutional layer relu units. mixture expert layer learns ensemble capture variations uses convolutional layer sigmoid probability decision kernels. output response non-negative non-linear combination neurons me-layer using sigmoid activation. tion landmarks. parameter update positions landmarks updated jointly penalized misaligned landmarks irregular shapes using point distribution model. optimize following objective above optimal parameters controlling position landmarks current estimate. alignment probability landmark location input facial image computed cen. regularization enforced point distribution model optimization equation performed using non-uniform regularized landmark mean shift algorithm convolutional experts network ﬁrst important step ce-clm algorithm compute response helps accurately localize individual landmarks evaluating landmark alignment probability individual pixel locations. model done takes pixel region interest around current estimate landmark position input outputs response evaluating landmark alignment probability pixel location. figure illustration. ﬁrst convolved contrast normalizing convolutional layer shape performs z-score normalization calculating correlation input kernel. output response convolved convolutional layer relu neurons. model different landmark appearance prototypes. achieved using special neural layer called mixture expert layer convlutional layer using sigmoid activation outputting individual experts vote alignment probability response maps individual experts combined using nonnegative weights ﬁnal layer followed sigmoid activation. seen combination experts leading ﬁnal alignment probability. experiments show me-layer crucial performance proposed convolutional experts network. simple terms given image iteration equation input outputs probabilistic response evaluating individual landmark alignment. thus ﬁtting landmark position follows equation indicator landmark number aligned. image location image response maps used minimizing equation detailed network training procedure presented section including chosen parameters train test time. experiments show making model deeper change performance network. study effects me-layer section using ablation study. point distribution model point distribution models used control landmark locations regularize shape ce-clm framework. irregular shapes ﬁnal detected landmarks penalized using term equation landmark locations parametrized mean value landmark principal component matrix m-dimensional vector non-rigid shape parameters; rigid parameters scale rotation matrix deﬁned axis angles translation. table comparison using square correlation rmse evaluate necessity me-layer also compare model non-negative constraint weights me-layer. performance drop signals crucial role me-layer. equation optimized using non-uniform regularized landmark mean shift given initial ce-clm parameter estimate nu-rlms iteratively ﬁnds update parameter approaches solution equation nu-rlms update ﬁnds solution following problem jacobian landmark locations respect parameters matrix priors gaussian prior non-rigid shape uniform shape parameters. equation weighting matrix weighting mean shift vectors diag landmark detector accuracy calculated model training based correlation coefﬁcient. mean-shift vector calculated using gaussian kernel density estimator using response maps experiments ﬁrst evaluate performance convolutional experts network compare performance local detectors also evaluate importance crucial me-layer performance. ﬁnal facial landmark detection experiments explore model settings images videos. experiments performed challenging publicly available datasets compared number state-of-the-art baselines within cross-datasets. ce-clm training codes available https//github.com/azadeh/ ce-clm multicomp.cs.cmu.edu/ceclm part openface package https//github. com/tadasbaltrusaitis/openface. section ﬁrst describe training inference methodology local detector. compare performance patch experts followed ablation study investigate crucial role me-layer. training procedure experiments trained lfpw helen training sets well multi-pie dataset. training landmark located center convolutional region probability landmark presence high otherwise low. total convolution regions extracted training chosen test set. trained sets cens landmark seven orientations ±◦±◦±◦ yaw; four scales pixel interocular distance. reduce number local detectors needed trained mirrored local detectors different angles used expert left right side face frontal view. optimizer adam small learning rate trained epochs mini-batches landmark scale view local detectors trained. training model takes hours geforce titan trained inference quickly done parallelized. compare performance improvement local detectors patch experts. table shows average performance individual landmark. since alignment probability inference regression task square correlation rmse ground truth validation local detector output measure accuracy train test data important part model capturing ranges variation texture illumination appearance input support region removing prevents model dealing variations. figure visualize improvement local detectors across different landmarks eyebrow region lips face outline. ground truth response normal distribution centered around position landmark. output response shows better certainty position landmark response concentrated around ground truth position. output showing concentrated behavior. therefore conclude major improvement comes accurate local detection directly transfers improvement landmark detection task. section ﬁrst describe datasets used train evaluate ce-clm method. brieﬂy discuss comparable state-of-the-art approaches landmark detection. finally present facial landmark detection results images videos. evaluate ce-clm four publicly available datasets within-dataset evaluation three crossdataset evaluations believe cross-dataset evaluations present strongest case ce-clm generalization compared baselines. datasets described detail below. meta-dataset four different facial landmark datasets annotated faces wild ibug lfpw helen datasets. used full ibug dataset test partitions lfpw helen. images testing respectively. contain uncontrolled images faces wild indoor-outdoor environments varying illuminations presence occlusions different poses different quality cameras. lfpw helen test sets together ibug model evaluation menpo benchmark challenge dataset recent comprehensive multi-pose dataset landmark detection images displaying arbitrary poses. training consists images proﬁle images labeled landmark points; rest images labeled landmarks. images dataset mainly re-annotated images challenging aflw dataset. figure comparison response maps local detector patch experts across different landmarks. shows better localization landmark probability concentrated around correct position landmark. models same. average local detector performs better almost better shows signiﬁcant improvement. average certain landmarks views scales performance improvement lnf. speciﬁcally case pixel interocular distance scale since able model location landmark based bigger appearance landmark neighborhood image also evaluate importance me-layer model. table shows difference show removing nonnegative constraint connection weights ﬁnal decision layer retraining network drops performance signiﬁcantly almost level svr. signals me-layer crucial possibly figure cumulative error curves normalized facial landmark detection errors test helen lfpw ibug. ce-clm performs better approaches especially difﬁcult landmark case. best viewed color. figure results facial landmark detection menpo dataset. ce-clm outperforms baselines frontal proﬁle image case large margin latter. best viewed color. test contains videos labeled facial landmarks every frame. test videos categorized three types laboratory naturalistic well-lit conditions; unconstrained conditions varied illumination dark rooms overexposed shots; completely unconstrained conditions including illumination occlusions occlusions hand. compared approach number established baselines facial landmark detection task including cascaded regression model based approaches. cases author provided implementations meaning compare best available version baseline using methodology. cfss coarse fine shape search recent cascaded regression approach. current state-of-theart approach competition data model trained helen lfpw training sets afw. clnf extension constrained local model uses continuous conditional neural fields patch experts model trained lfpw helen training sets multi-pie po-cr recent cascaded regression approach updates shape model parameters rather predicting landmark locations directly projected-out space. model trained lfpw helen training sets. ddfa dense face alignment shown state-of-the-art performance facial landmark detection proﬁle images. method uses extended dataset synthesized large-pose face images tcdcn tasks-constrained deep convolutional network another deep learning approach facial landmark detection uses multi-task learning improve landmark detection performance. baselines trained detect either landmarks without face outline face outline comparison used biggest overlapping landmarks approaches share subset feature points. evaluating detections proﬁle images subset shared landmarks ground truth images detected ones. since annotations menpo proﬁle faces differ slightly landmark scheme unify removing chin landmarks using linear interpolation follow annotated curve convert eyebrow landmarks face outline landmarks still constitutes fair comparison none approaches trained menpo. attempted compare mnemonic descent method unable compile code provided authors older tensorflow framework. authors provide results publicly available datasets able compare work theirs. figure results facial landmark detection tracking dataset. ce-clm outperforms baselines three categories. report results inner facial landmarks. best viewed color. table size normalized median landmark error menpo dataset. present results proﬁle frontal images separately. approach outperforms baselines frontal proﬁle images. table size normalized median landmark error ijb-fl dataset. present results proﬁle frontal images separately. approach outperforms baselines frontal proﬁle images. nu-rlms based grid-search training data. given bounding initialized ce-clm landmark locations seven different orientations frontal pitch roll perform early stopping discarding hypothesis evaluation converged maximum posteriori score threshold determined validation. early stopping improves model speed four times average. ﬁtting compute response maps self-occluded landmarks parameter update. fairness model comparison baselines model initialized using protocol. dataset initialized approaches using bounding boxes provided challenge organizers. menpo initialized approaches using multi-task convolutional neural network face detector able detect faces images. performed figure example images ce-clm approach outperforms cfss clnf challenging images difﬁculties pose resolution occlusion ce-clm able align facial landmarks. afﬁne transformation bounding match bounding around facial landmarks. ijb-fl initialized approaches generating face bounding adding noise ground truth landmarks detected face every frame video using multi-task convolutional neural network face detector. face detected frame used closest frame successful detection instead. performed linear mapping detected bounding tighter around landmarks baseline initialized detection allowed track frames either using previously detected landmarks using bounding box. common work commutative error curves size normalized error image display landmark detection accuracy. also report size normalized median image error. report median instead mean errors normally distributed mean susceptible outliers. datasets containing close frontal faces normalize error inter-ocular distance images containing proﬁle faces eyes might visible instead average width height face. results landmark detection menpo dataset seen table figure ce-clm model outperforms baselines difﬁcult task well. performance improvement especially large proﬁle faces cfan drmf po-cr approaches completely unable handle. also outperform recent ddfa model designed large pose face ﬁtting. results cross-dataset evaluation demonstrate well method generalizes unseen data well performs challenging proﬁle faces results landmark detection tracking videos dataset displayed figure ce-clm consistently outperforms baselines three categories biggest improvement category finally approach outperforms recently proposed iccr landmark tracking method adapts particular person tracks however video approach fair comparison work baselines treat video frame independently. note approach consistently performing well frontal proﬁle face approaches perform well frontal proﬁle also true across different categories approaches performance varies across categories ce-clm consistently performs better approaches. paper introduced convolutional experts constrained local model member family uses novel local detector called convolutional experts network proposed local detector able deal varying appearance landmarks internally learning ensemble detectors thus modeling landmark appearance prototypes. achieved mixture expert layer consists decision neurons connected non-negative weights ﬁnal decision layer. experiments show crucial part outperforms previously introduced local detectors margin. better performance ce-clm able perform better state-ofthe-art approaches facial landmark detection accurate robust speciﬁcally case proﬁle faces figure shows visual comparison ce-clm cfss clnf landmark detection methods challenging images. ce-clm able accurately align landmarks even extreme proﬁle faces.", "year": 2016}