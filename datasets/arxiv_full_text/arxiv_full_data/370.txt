{"title": "Multi-Evidence Filtering and Fusion for Multi-Label Classification,  Object Detection and Semantic Segmentation Based on Weakly Supervised  Learning", "tag": ["cs.CV", "cs.AI", "cs.LG", "stat.ML"], "abstract": "Supervised object detection and semantic segmentation require object or even pixel level annotations. When there exist image level labels only, it is challenging for weakly supervised algorithms to achieve accurate predictions. The accuracy achieved by top weakly supervised algorithms is still significantly lower than their fully supervised counterparts. In this paper, we propose a novel weakly supervised curriculum learning pipeline for multi-label object recognition, detection and semantic segmentation. In this pipeline, we first obtain intermediate object localization and pixel labeling results for the training images, and then use such results to train task-specific deep networks in a fully supervised manner. The entire process consists of four stages, including object localization in the training images, filtering and fusing object instances, pixel labeling for the training images, and task-specific network training. To obtain clean object instances in the training images, we propose a novel algorithm for filtering, fusing and classifying object instances collected from multiple solution mechanisms. In this algorithm, we incorporate both metric learning and density-based clustering to filter detected object instances. Experiments show that our weakly supervised pipeline achieves state-of-the-art results in multi-label image classification as well as weakly supervised object detection and very competitive results in weakly supervised semantic segmentation on MS-COCO, PASCAL VOC 2007 and PASCAL VOC 2012.", "text": "given image level supervision only researchers proposed many weakly supervised algorithms detecting objects labeling pixels. algorithms employ different mechanisms including bottom-up top-down hybrid approaches useful information. bottom-up algorithms pixels usually grouped many object proposals classiﬁed classiﬁcation results merged match groundtruth image labels. top-down algorithms images ﬁrst forward pass deep neural network result propagated backward discover pixels actually contribute ﬁnal result also hybrid algorithms consider bottom-up top-down cues pipeline. although exist many weakly supervised algorithms accuracy achieved weakly supervised algorithms still signiﬁcantly lower fully supervised counterparts. reﬂected precision recall results. terms precision results weakly supervised algorithms contain much noise outliers indirect incomplete supervision. likewise algorithms also achieve much lower recall because insufﬁcient labeled information learn comprehensive feature representations target object categories. however different types weakly supervised algorithms return different complementary subsets ground truth. observations motivate approach ﬁrst collect many evidences results possible multiple types solution mechanisms together remove noise outliers fused results using powerful ﬁltering techniques. contrast deep neural networks trained end. although approach needs collect results multiple separately trained networks ﬁltered fused evidences eventually used training single network used testing stage. therefore running time ﬁnal network during testing stage still comparable state-ofthe-art end-to-end networks. supervised object detection semantic segmentation require object even pixel level annotations. exist image level labels only challenging weakly supervised algorithms achieve accurate predictions. accuracy achieved weakly supervised algorithms still signiﬁcantly lower fully supervised counterparts. paper propose novel weakly supervised curriculum learning pipeline multi-label object recognition detection semantic segmentation. pipeline ﬁrst obtain intermediate object localization pixel labeling results training images results train task-speciﬁc deep networks fully supervised manner. entire process consists four stages including object localization training images ﬁltering fusing object instances pixel labeling training images task-speciﬁc network training. obtain clean object instances training images propose novel algorithm ﬁltering fusing classifying object instances collected multiple solution mechanisms. algorithm incorporate metric learning density-based clustering ﬁlter detected object instances. experiments show weakly supervised pipeline achieves state-of-the-art results multi-label image classiﬁcation well weakly supervised object detection competitive results weakly supervised semantic segmentation ms-coco pascal pascal deep neural networks give rise many breakthroughs computer vision usinging huge amounts labeled training data. supervised object detection semantic segmentation require object even pixel level annotations much labor-intensive obtain image level labels. hand exist image level labels only incomplete annotations challenging predict accurate object locations pixel-wise labels even image level labels multi-label image classiﬁcation. obtain object localization pixelwise semantic labeling results training images ﬁrst using image level labels intermediate results train object detection semantic segmentation multi-label image classiﬁcation networks fully supervised manner. since image level object level pixel level analysis mutual dependencies performed independently organized single pipeline four stages. ﬁrst stage collect object localization results training images bottom-up topweakly supervised object detection algorithms. second stage incorporate metric learning density-based clustering ﬁlter detected object instances. obtain relatively clean complete object instances. given object instances train single-label object classiﬁer applied object instances obtain ﬁnal class labels. third obtain relatively clean pixel-wise probability every class every training image fuse image level attention object level attention maps object detection heat map. pixel-wise probability maps used training fully convolutional network applied training images obtain ﬁnal pixel-wise label maps. finally obtained object instances pixel-wise label maps training images used training deep networks object detection semantic segmentation respectively. make pixel-wise label maps training images help multi-label image classiﬁcation perform multi-task learning training single deep network branches multi-label image classiﬁcation pixel labeling. experiments show weakly supervised curriculum learning system capable achieving state-of-the-art results multi-label image classiﬁcation well weakly supervised object detection competitive results weakly supervised semantic segmentation ms-coco pascal pascal summary paper following contributions. propose novel weakly supervised pipeline multilabel object recognition detection semantic segmentation. pipeline ﬁrst obtain intermediate labeling results training images results train task-speciﬁc networks fully supervised manner. obtain clean object instances detected training images propose novel algorithm ﬁltering fusing classifying object instances collected multiple solution mechanisms. algorithm incorporate metric learning density-based clustering ﬁlter detected object instances. obtain relatively clean pixel-wise probability every class every training image propose novel algorithm fusing image level object level attention maps object detection heat map. fused maps used training fully convolutional network pixel labeling. related work weakly supervised object detection segmentation. weakly supervised object detection segmentation respectively locates segments objects image-level labels important reasons ﬁrst learning complex visual concepts image level labels components image understanding; second fully supervised deep learning data hungry. weakly supervised object detection/localization usually performed bottom-up manner. methods treat weakly supervised localization problem image classiﬁcation problem obtain object locations speciﬁc pooling layers networks. methods extract object instances images using selective search edge boxes convert weakly supervised detection problem multi-instance learning problem method ﬁrst learns object masks uses algorithm force network learn object segmentation masks obtained previous stages. since hard network directly learn object locations pixel labels without sufﬁcient supervision paper decompose object detection pixel labeling multiple easier problems solve progressively multiple stages. neural attention. neural attention aims relationship pixels input image neural responses every layer network. many efforts made explain neural networks work. method extends layer-wise relevance propagation comprehend inherent structured reasoning deep neural networks. further ignore cluttered background positive neural attention back-propagation scheme called excitation backpropagation introduced method locates activations convolutional maps activation areas input image using bilinear interpolation. neural attention provides top-down mechanism obtain pixel-wise class probabilities using image level labels only. pipeline adopt excitation calculate pixel-wise class probabilities. however images multiple category labels deep neural network could fuse activations different categories neurons. solve problem train single-label object instance classiﬁcation network perform excitation network obtain accurate pixel level class probabilities. curriculum learning. curriculum learning part figure proposed weakly supervised pipeline. left right image level stage fuse object heatmaps image attention generate object instances instance level stage provide maps information fusion pixel level stage. instance level stage perform triplet loss based metric learning density based clustering outlier detection train single label instance classiﬁer instance ﬁltering. pixel level stage integrate object heatmaps instance attention image attention pixel labeling uncertainty. broad family machine learning methods starts easier subtasks gradually increases difﬁculty level tasks. yoshua describe concept curriculum learning classiﬁcation problem show advantage decomposing complex problem several easier ones. fact idea behind curriculum learning widely used hinton trained deep neural network layer layer using restricted boltzmann machine avoid local minima deep neural networks. many machine learning algorithms follow similar divide-and-conquer strategy curriculum learning. paper adopt strategy decompose pixel labeling problem image level learning object instance level learning pixel level learning. learning tasks three stages relatively simple using training data current stage output previous stage. given image associated image level label vector weakly supervised curriculum learning aims obtain pixel-wise labels labels assist weakly supervised object detection semantic segmentation multi-label image classiﬁcation. total number object classes total number pixels binary. means l-th object class exists otherwise. label pixel denoted c-dimensional binary vector number object classes existing number positive components denoted following divide-and-conquer idea curriculum learning decompose pixel labeling task three stages image level stage instance level stage pixel level stage. image level stage decomposes multi-label image classiﬁcation single-label object instance classiﬁcations also provides initial pixel-wise probability maps pixel level stage. object heatmaps. unlike fully supervised case weakly supervised object detection produces object instances higher uncertainty also misses higher percentage true objects. reduce number missing detections propose compute object heatmap every object class existing image. number locations input image place anchor windows h/λs× w/λs. denote short side image following setting used anchor windows single location four scales three aspect ratios proposals image borders removed usually remaining proposals image. deﬁne stack object heatmaps c×h×w matrix values zero initially. object detection classiﬁcation network used weakly supervised object testing vgg- every proposal object class probability vector added pixels corresponding window heatmaps. every heatmap normalized follows heatmap c-th object class. note heatmaps object classes existing normalized. heatmaps ignored zeros. multiple evidence fusion. object heatmaps highlight regions contain objects even level supervision weak. however since generated using sliding anchor windows multiple scales aspect ratios tend highlight pixels near outside true objects shown given image classiﬁcation network trained using image level labels neural attention calculates contribution every pixel ﬁnal classiﬁcation result. tends focus inﬂuential regions necessarily entire objects. note false positive regions occur excitation obtain accurate object instances integrate top-down attention maps object heatmaps object classes existing image corresponding heatmaps attention maps thresholded distinct values. heatmaps smooth indicate accurate object boundaries provide important spatial priors constrain object instances obtained attention maps. assume regions sufﬁciently high value object heatmaps least include parts objects regions sufﬁciently values everywhere contain objects. following assumption threshold heatmaps values identify highly conﬁdent object proposals relatively conﬁdent object connected component extraction. attention maps thresholded attention proposals shown proposal numbers object proposals corresponding class labels. fusion object class attention proposals cover proposals preserved. denote proposals modiﬁed slightly completely enclose corresponding proposal meanwhile completely contained inside corresponding proposal instance level stage since multiple object categories present image make hard neural attention obtain accurate pixel-wise attention class train singlelabel object instance classiﬁcation network compute attention maps network obtain accurate pixel level class probabilities. fused object instances image level stage ﬁltered metric learning density-based clustering. remaining labeled object proposals used training object instance classiﬁer also used remove remaining false positive object instances. metric learning feature embedding. metric learning popular face recognition person reidentiﬁcation object tracking embeds image multi-dimensional feature space associating image ﬁxed size vector feature space. embedding makes similar images close dissimilar images apart feature space. thus similarity images measured distance space. tripletloss network proposed additional property well separate classes even intraclass distances large variations. exist training samples associated incorrect class labels loss stays high value distances correctly labeled mislabeled samples remain large even training process long time. denote fused object instances training images image level stage labels. total number fused instances label vector instance train triplet-loss network using googlenet batchnorm mini-batch ﬁrst chooses object classes randomly chooses instances classes randomly. instances cropped training images fig. visualizes mini-batch composition corresponding pairwise distances among instances. clustering outlier removal. clustering aims remove outliers less similar object instances class. speciﬁcally perform density based clustering form single cluster normal instances within object class independently instances outside cluster considered outliers. different denote instances class label number instances calculate pairwise distances among instances obtain distance matrix instance distance another instance less density increased rank instances densities descending order choose instance ranked seed cluster. instances cluster following descending order distance element cluster less density higher nc/. instance classiﬁer re-labeling. since metric learning clustering screen object instances aggressive heavily decrease recall normal instances surviving previous clustering step train instance classiﬁer turn used re-label object proposals generated image level stage again. single-label classiﬁcation problem object instance allowed single label. googlenet softmax loss serves classiﬁer ﬁnetuned image level classiﬁer. every object proposal generated previous image level stage label predicted instance classiﬁer match original label labeled outlier permanently discarded. previous stages already built image classiﬁer weakly supervised object detector object instance classiﬁer. deep networks produces inference result input image. example image classiﬁer generates global attention object detector generates object heatmaps. pixel level stage still perform multi-evidence ﬁltering fusion integrate inference results component networks obtain pixelwise probability indicating potential object categories every pixel. global attention image classiﬁer full knowledge objects image sometimes focuses important object parts. object instance classiﬁer local view individual object. help object-speciﬁc local attention maps generated instance classiﬁer avoid missing small objects. instance attention map. deﬁne instance attention matrix values zero initially. every surviving object instance instance level stage object instance classiﬁer used extract local attention corresponding region instance attention normalize range object heatmaps. probability integration. ﬁnal attention obtained calculating element-wise maximum between image attention instance attention max. heatmap attention classes existing image considered. background maps deﬁned follows become matrices. l-th channel perform softmax maps along channel dimension independently. ﬁnal probability deﬁned result applying softmax elementwise product treating ﬁlter. softmax pixel labeling uncertainty. pixel labels initialized probability every pixel maximum element label vector larger threshold simply maximum element elements otherwise class label uncertain. given pixel-wise labels generated pixel level stage training images train fully convolutional network similar network perform semantic segmentation. note pixels uncertain class labels excluded training. prediction part adopt atrous spatial pyramid pooling resulting trained network used labeling pixels testing image well pixels uncertain labels training images. pixels uncertain labels training images re-labeled using network semantic segmentation generate object instances images computing bounding boxes connected pixels sharing semantic label. train fast rcnn using bounding boxes associated labels. since bounding boxes generated semantic label maps contain noise ﬁlter using object instance classiﬁer section still base network object detector trained scales multi-label classiﬁcation main component multi-label classiﬁcation network structure resnet- branches layer resb relu main component branch classiﬁcation semantic segmentation. branches share structure after layer resb relu. adopt multi-task learning train branches. idea using training data segmentation branch make convolutional kernels main component discriminative powerful. network architecture shown supplemental materials. layer pool resnet- classiﬁcation branch removed output layer resc matrix. directly convolutional layer classiﬁcation obtained. semantic label play role attention summation channel semantic label normalized ﬁnal image level probability vector result spatial average pooling element-wise product att. used identify important image regions assign larger weights. probability vector fully connected output layer performs binary classiﬁcation classes. cross-entropy loss used training multi-label classiﬁcation network. segmentation branch uses atrous spatial pyramid pooling perform semantic segmentation softmax applied enforce single label pixel. experiments implemented using caffe nvidia titan memory. hyper-parameters section according common sense conﬁrmed visually verify segmentation results training samples valid. parameter setting used datasets tuned validation sets. semantic segmentation datasets performance measures. pascal dataset serves benchmark existing work weakly-supervised semantic segmentation. classes training images validation testing. image tags used training data experiments. report results validation test sets. implementation details. network based vgg. layers relu layer pool removed. dilations layers conv conv conv feature stride layer relu atrous spatial pyramid pooling deeplab layer relu dilations atrous spatial pyramid pooling layers implemented py-faster-rcnn data augmentation image scales horizontal longer side testing original size input image preserved. network ﬁne-tuned pre-trained model imagenet learning rate ﬁrst iterations next iterations. weight decay mini-batch size post-processing using added testing. result comparison. compare method existing state-of-the-art algorithms. table lists results weakly supervised semantic segmentation pascal proposed method achieves mean comparable state recent algorithms including ae-psl conduct end-to-end training learn object figure detection semantic segmentation results pascal test pascal test detection results gotten select proposals highest conﬁdence every class. semantic segmentation results post-processed score maps. method demonstrates ﬁlter integrate multiple types intermediate evidences different granularities weakly supervised training results become equally competitive even better. object detection datasets performance measures. performance object detector section evaluated popular pascal pascal datasets datasets divided train test sets. trainval sets used training image tags used. measures used test model corloc. according standard pascal protocol mean average precision used testing trained models test sets correct localization used measuring object localization accuracy trainval sets whose image tags already used training data. implementation details. code py-fasterrcnn implement fast r-cnn network still vgg-. learning rate ﬁrst iterations next iterations. momentum weight decay respectively. follow data augmentation setting image scales horizontal longer image side result comparison. object detection results pascal test pascal test reported. object localization results pascal trainval pascal trainval also reported pascal test algorithm achieves highest least higher latest state-of-the-art algorithms including oicr hcp+dsd+ossh. trained model also achieves highest among weakly supervised algorithms pascal test higher latest result object localization accuracy trained model pascal trainval pascal trainval respectively higher previous best. multi-label classiﬁcation dataset performance measures. microsoft coco popular dataset multi-label classiﬁcation. ms-coco primarily built object recognition tasks context scene understanding. training composed images classes average object labels image. since groundtruth labels test available performance evaluation conducted validation images. train models training test validation set. quite different single-label classiﬁcation. following employ macro/micro precision macro/micro recall macro/micro f-measure evaluate trained models. precision recall fmeasure labels conﬁdence higher considered positive. represent average per-class precision recall f-measure represent average overall precision recall f-measure. measures require ﬁxed number labels image. compare existing state-of-the-art algorithms also report results top- labels conﬁdence higher implementation details. main network multi-label classiﬁcation resnet- described earlier. resolution input images ﬁrst train network classiﬁcation branch only. common practice pre-trained model imagenet ﬁne-tuned learning rate ﬁrst iterations next iterations. weight decay segmentation branch train branch ﬁxing layers before layer resb relu classiﬁcation branch. learning rate frist iterations next iterations. last train entire network branches using cross-entropy loss multi-label classiﬁcation iterations learning rate still ﬁxing layers layer resb relu. result comparison. addition two-branch network also train resnet- classiﬁcation network baseline. multi-label classiﬁcation performance networks ms-coco reported table since input resolution baseline comparison latest work performance baseline slightly better. speciﬁcally baseline higher resnet-srn. comparison baseline two-branch network achieves overall better performance. speciﬁcally two-branch network higher baseline lower higher. f-measures two-branch network highest among state-of-the-art algorithms. perform ablation study pascal detection test replacing removing single component pipeline every time. first verify importance object instances remove steps related object instances including entire instance level stage operations related instance attention pixel level stage. decreased shown table second clustering outlier detection step instance level stage removed. directly train instance classiﬁer using object proposals image level stage. decreased third instead labeling subset pixels pixel level stage assign unique label every pixel even case conﬁdence. drops lower performance original pipeline. paper presented pipeline weakly supervised object recognition detection segmentation. different previous algorithms fuse ﬁlter object instances different techniques perform pixel labeling uncertainty. resulting pixelwise labels generate groundtruth bounding boxes object detection attention maps multi-label classiﬁcation. pipeline achieved clearly better performance tasks. nevertheless simplify steps pipeline deserves investigation.", "year": 2018}