{"title": "Person Re-Identification by Deep Joint Learning of Multi-Loss  Classification", "tag": ["cs.CV", "cs.AI"], "abstract": "Existing person re-identification (re-id) methods rely mostly on either localised or global feature representation alone. This ignores their joint benefit and mutual complementary effects. In this work, we show the advantages of jointly learning local and global features in a Convolutional Neural Network (CNN) by aiming to discover correlated local and global features in different context. Specifically, we formulate a method for joint learning of local and global feature selection losses designed to optimise person re-id when using only generic matching metrics such as the L2 distance. We design a novel CNN architecture for Jointly Learning Multi-Loss (JLML) of local and global discriminative feature optimisation subject concurrently to the same re-id labelled information. Extensive comparative evaluations demonstrate the advantages of this new JLML model for person re-id over a wide range of state-of-the-art re-id methods on five benchmarks (VIPeR, GRID, CUHK01, CUHK03, Market-1501).", "text": "existing person re-identiﬁcation methods rely mostly either localised global feature representation alone. ignores joint beneﬁt mutual complementary effects. work show advantages jointly learning local global features convolutional neural network aiming discover correlated local global features different context. speciﬁcally formulate method joint learning local global feature selection losses designed optimise person re-id using generic matching metrics distance. design novel architecture jointly learning multi-loss local global discriminative feature optimisation subject concurrently re-id labelled information. extensive comparative evaluations demonstrate advantages jlml model person re-id wide range state-of-the-art re-id methods benchmarks introduction person re-identiﬁcation matching identity classes detected person bounding images nonoverlapping camera views distributed open spaces. inherently challenging task person visual appearance change dramatically different camera views different locations unknown changes human pose illumination occlusion background clutter existing person re-id studies typically focus either feature representation matching distance metrics combination deep learning framework regardless overall objective obtain viewlocationinvariant representation. consider learning matching distance metric intrinsically learning global feature transformation across domains therefore obtaining normalised feature representation matching. re-id features typically hand-crafted encode local topological and/or spatial structural information different image decomposition schemes horizontal stripes body parts patches localised features effective mitigating person pose detection misalignment re-id matching. recent deep re-id models beneﬁt availability larger scale datasets cuhk market- lessons learned vision tasks contrast local hand-crafted features deep models particular convolutional neural networks favour intrinsically learning global feature representations exceptions. shown effective re-id. consider either local global feature learning alone suboptimal. motivated human visual system leverages global local information concurrently intuition joint learning aims extract correlated complementary information different context whilst satisfying learning constraint therefore achieving reliable recognition. need address number non-trivial problems model learning behaviour satisfying label constraint different local global levels; complementary correlation local global features unknown vary among individual instances therefore must learned optimised consistently across data; people’s appearance public scenes diverse pattens conﬁgurations. makes challenging learn correlations local global features appearances. jointly optimising local global feature selections concurrently improve person re-id using generic matching metrics distance. explore deep learning approach potential superiority learning large scale data bounding image based person re-id consider entire person bounding global scene context body parts person local information sources subject surrounding background clutter within bounding potentially also misalignment partial occlusion bounding detection. setting wish discover optimise jointly correlated complementary feature selections local global representations subject label constraint concurrently. whilst former aims address pose/detection misalignment occlusion localised ﬁne-grained saliency information latter exploits holistic coarse-grained context robust global matching. formulate deep two-branch architecture branch learning localised feature selection learning global feature selection importantly branches independent synergistically correlated jointly learned concurrently. achieved imposing interbranch interaction local global branches enforcing separate learning objective loss function branch learning independent discriminative capabilities whilst subject class label constraint. balancing interaction independence allow branches learned concurrently maximising joint optimal extraction selection different discriminative features person re-id. call model joint learning multi-loss model. minimise poor learning inherent noise potential covariance introduce structured feature selective discriminative learning mechanism local global branches subject joint sparsity regularisation. contributions work propose idea learning concurrently local global feature selections optimising feature discriminative capabilities different context whilst performing person re-id tasks. currently under-studied person re-id literature best knowledge. formulate novel joint learning multi-loss model learning global local discriminative features different context optimising multiple classiﬁcation losses person label information concurrently also utilising complementary advantages jointly coping local misalignment optimising holistic matching criteria person re-id. introduce structured sparsity based feature selection learning mechanism improving multiloss joint feature learning robustness w.r.t. noise data covariance local global representations. extensive comparative evaluations demonstrate superiority proposed jlml model wide range existing state-ofthe-art re-id models benchmark datasets viper grid cuhk cuhk market- proposed jlml model considers learning local global feature selections jointly optimising correlated complementary advantages. goes beyond existing methods mostly relying level feature representation. speciﬁcally jlml method related saliency learning based models terms modelling localised part importance. however existing methods consider patch appearance statistics within individual locations global feature representation learning alone correlation complementary information discovery local global features modelled jlml. whilst recent spatially constrained similarity model multi-channel parts network consider levels representation jlml model differs signiﬁcantly method focuses supervised metric them learning whilst jlml aims joint discriminative feature learning needs generic metrics re-id matching. also hand-crafted local global features extracted separately without inter-feature interaction correlation learning involved opposite joint learning global local feature selections concurrently subject supervision information jlml; local global branches model supervised optimised triplet ranking loss contrast proposed multiple classiﬁcation loss design critically one-loss model learning likely impose negative inﬂuence discriminative feature learning behaviour branches potential over-low pre-branch independence over-high inter-branch correlation. lead suboptimal joint learning local global feature selections model optimisation suggested evaluation section addition jlml capable performing structured feature sparsity regularisation along multi-loss joint learning local global feature selections providing additional beneﬁts whilst similar theory sparsity constraint supervised metric learning perform differently sparse generic feature learning without need supervised metric optimisation. terms loss function model similarly exploit pair-wise re-id labels deﬁnes single identity label training person regression loss based reid feature embedding optimisation. importantly relies pre-deﬁned feature without capability jointly learning global local feature representations discovering correlated complementary advantages speciﬁcally designed jlml. also model uses classiﬁcation loss model optimisation. however model considers global feature representation learning one-loss classiﬁcation opposite proposed joint global local feature learning multi-loss classiﬁcation concurrently subject maximising person identity matching. model design problem deﬁnition assume training images {ii}n corresponding identity labels {yi}n training images capture visual appearance different people non-overlapping camera views. formulate joint learning multi-loss model aims discover capture concurrently complementary discriminative information person image local global visual features image order optimise person re-id signiﬁcant viewing condition changes across locations. contrast existing re-id methods typically depending either local global features alone. risks. especially critical learning person re-id models labelled training data limited. multi-task independent learning subject shared label constraints. maximise learning complementary discriminative features local global representations remaining layers branches learned independently subject given identity labels. jlml model aims learn concurrently multiple identity feature representations different local image regions entire image maximise identity matching individually collectively time. independent multi-task learning aims preserve local saliency feature selection global robustness image representation. jlml model designed perform multi-task independent learning subject shared identity label constraints allocating branch separate objective loss function. per-branch learning behaviour conditioned independently respective feature representation. call branch-wise loss formulation multiloss design. network construction. adopt residual unit jlml’s building blocks capacity deeper model design whilst retaining smaller model parameter size. speciﬁcally customise resnet architecture layer ﬁlter numbers design jlml model layers resnet tailored re-id tasks. conﬁguration jlml-resnet given table note that relu overall design proposed jlml model depicted figure jlml model consists twobranches network local branch streams identical structure stream learning discriminative local visual features local image regions person bounding image; another global branch responsible learning discriminative global level features entire person image. concurrently optimising per-branch discriminative feature representations discovering correlated complementary information local global feature selections joint learning scheme subjects local global branches identity label supervision considered underlying principles shared low-level features. construct global local branches shared lower conv layer particular ﬁrst conv layer facilitating inter-branch common learning. intuition that lower conv layers capture lowlevel features edges corners common patterns images. shared learning similar spirit multi-task learning local global feature learning branches related learning tasks. sharing low-level conv layer reduces model parameter size therefore model overﬁtting figure group sparsity regularisations layer parameter matrices selectively learning feature representations. solid dashed rectangles denote norm norm respectively. combined group sparsity based feature selection regularisations ﬁnal loss function global local branch sub-networks llocal λlocalwl lglobal λglobalwg λglobal λlocal control balance identity label loss feature selection sparsity regularisation. empirically λlocal λglobal crossvalidation evaluations. choice loss function. jlml model learning deploys classiﬁcation loss function. differs signiﬁcantly contrastive loss functions used existing deep re-id methods designed exploit pairwise re-id labels deﬁned positive negative pairs pairwise veriﬁcation triplet ranking jlml model training labelled negative pairs inherent person re-id training data extract identity class labels positive pairs. motivations jlml classiﬁcation loss based learning signiﬁcantly simpliﬁed training data batch construction e.g. random sampling notorious tricks required shown deep classiﬁcation methods makes jlml model scalable real-world applications large training population sizes available. also eliminates undesirable need carefully forming pairs and/or triplets preparing re-id training splits existing methods inherent imbalanced negative positive pair size distribu visual psychophysical ﬁndings suggest reptions. resentations optimised classiﬁcation tasks generalise well rectiﬁcation non-linearity conv layer omitted brevity. feature selection. optimise jlml model learning robustness noise diverse data source introduce feature selection capability jlml structure sparsity induced regularization idea competing-to-survive mechanism feature learning discourages irrelevant features whilst encourages discriminative features concurrently different local global context maximise shared identity matching objective. sparsify global feature representation group lasso rcg×dg parameter feature representation. speciﬁcally norm applied norm learn selectively feature dimension importance subject sparsity principle identity label constraint simultaneously. parameter matrix local branch feature layer m×dl input output dimensions eter vector contributing i-th output feature dimension j-th local input feature vector particular regulariser performs sparse feature selection individual image regions below perform feature selective learning local region level enforcing norm directly conceptually similar group lasso global level. apply nonsparse smooth fusion norm combine effects different local features weighted sparse lastly exploit norm level learn local feature representation selection. figure shows structured sparsity regularisations local global feature selections. loss function. model training utilise crossentropy classiﬁcation loss function global local branches optimise person identity classiﬁcation given training labels multiple person classes extracted pairwise labelled re-id dataset. formally predict posterior novel categories consider reid tasks model generalisation unseen test identity classes given training data independent seen identity classes. jlml model learning exploits general classiﬁcation learning principle beyond strict pair-wise relative veriﬁcation loss existing re-id models. model training adopt standard stochastic gradient descent optimisation algorithm perform batch-wise joint learning local global branches. note that naturally synchronise optimisation processes branches constraining learning behaviours subject identity label information update. likely avoid representation learning divergence branches help enhance correlated complementary learning capability. re-id generic distance metrics jlml model learned obtain joint representation concatenating local global feature vectors person re-id deploy deep feature representation using generic distance metric without camera-pair speciﬁc distance metric learning e.g. distance. speciﬁcally given test probe image camera view test gallery images non-overlapping camera views ﬁrst compute corresponding feature vectors forward-feeding images trained jlml model denoted compute normalisation global local features separately. lastly compute cross-camera matching distances generic matching metric e.g. distance. rank gallery images ascendant order distances probe image. probabilities true matches probe person images rank- among higher ranks indicate goodness learned jlml deep features person re-id tasks. experiments datasets. evaluation used benchmarking re-id datasets viper grid cuhk cuhk market- figure shows examples person bounding images datasets. datasets collected different data sampling protocols different environments where viper image person view low-resolution severe lighting change. grid provides image person view additional images distracting persons poor lighting underground stations. cuhk contains images person view university campus. cuhk consists images person view obtained manually labelled auto-detected person bounding boxes latter posing challenging re-id task detection bounding market- variable misalignment occlusion. numbers images person view captured supermarket bounding boxes automatically detected. datasets present wide range re-id evaluation scenarios different population sizes different challenging viewing conditions evaluation protocol. adopted standard supervised re-id setting evaluate proposed jlml model training test data splits testing settings dataset given table speciﬁcally viper split randomly whole population halves training another testing repeated trials random people splits used averaged results. cuhk considered training/test splits again reported results averaged random trials either split. grid training/test split distractor people included test gallery. used benchmarking people splits averaged performance. cuhk following repeated times random training/test splits reported averaged accuracies single-shot evaluation setting. market- used standard training/test split used cumulative matching characteristic measure re-id accuracy benchmarks except market also used addition recall measure multiple truth matches mean average precision i.e. ﬁrst computing area precision-recall curve probe calculating mean average precision probes competitors. compared jlml model existing state-of-the-art methods listed table range hand-crafted deep learning features domainspeciﬁc distance metric learning methods. summarise three categories hand-crafted domain-speciﬁc distance learning deep learning domain-speciﬁc deep veriﬁcation metric learning; deep learning generic non-learning distance implementation. used caffe framework jlml model implementation. started table person re-id method categorisation features metrics. category; deep learning; cpsl camera-pair speciﬁc learning; deep veriﬁcation metric; dvml ensemble fusion colour silpt features. pre-training jlml model imagenet subsequently cuhk market used imagenet training data model ﬁne-tuning i.e. cuhk/market; cuhk viper grid pretrained jlml cuhk+market ﬁne-tuned respective training images i.e. imagenet cuhk+market cuhk viper grid. input person images resized pixel. local branch according coarse body part layout evenly decomposed whole shared convolutional feature maps four horizontal strip-regions. used parameter settings pre-training training jlml model datasets. also adopted stepped learning rate policy e.g. dropping learning rate factor every iterations jlml pre-training every iterations jlml training. utilised distance default matching metric unless stated otherwise. conventional intra-domain re-id evaluations conducted extensively comparative evaluations conventional supervised learning based person re-id tasks. evaluation cuhk. table shows comparisons jlml existing methods cuhk. evident jlml outperforms existing methods categories labelled detected bounding boxes surpassing best performers x-corr corresponding labelled detected images rank- respectively. x-corr/gog/jlml also suffer least auto-detection misalignment indicating robustness competitiveness joint learning approach mining complementary local global discriminative features. evaluation market-. evaluated jlml four existing models market-. table shows clear performance superiority jlml state-ofthe-arts signiﬁcant rank- advantages methods compared cuhk giving gains best scnn. validates advantages joint learning multi-loss classiﬁcation optimising re-id especially re-id test population size increases evaluation cuhk. compared jlml model state-of-the-art methods cuhk. table shows jlml surpasses clearly compared models training/test splits singlemulti-short settings. moreover jlml outperforms rank- best hand-crafted feature method nfst training population size small training population size increases jlml even effective deep competitors exploiting extra training classes inducing identity-discriminative joint person features distinct context. example jlml gains rank- best method x-corr single-shot re-id improved gain split. results show consistent superiority robustness proposed jlml model existing methods. evaluation viper. evaluated performance jlml strong competitors viper challenging test scenario fewer training classes lower image resolution. dataset best performers hand-crafted feature methods rather deep models. contrast tests cuhk cuhk market-. small training data insufﬁcient learning effectively discriminative deep models millions parameters; greater disparity cuhk camera viewing conditions makes knowledge transfer less effective nevertheless jlml model remains best among deep methods without deep veriﬁcation metric learning. validates superiority robustness deep joint global local representation learning multi-loss classiﬁcation given sparse training data. attribute property jlml’s capability mining complementary features different context handling local misalignment optimising global matching. evaluation grid. compared jlml competing methods grid. addition poor image resolution poor lighting small training size grid also extra distractors testing population therefore presenting challenging realistic re-id scenario. table shows signiﬁcant superiority jlml existing state-of-the-arts rank- better best method relative improvement. demonstrates unique practically desirable advantage jlml handling realistically challenging open-world re-id matching large numbers distractors usually present. worth pointing step-change advantage re-id matching rate grid achieved deep learning limited number training identity classes highly imbalanced images sampled distributed camera views e.g. images camera camera. imbalanced sampling directly results scarce pairwise training grid dataset evaluated extensively others like viper cuhk cuhk although grid setting large numprovides realistic test distractors testing. possible reason challenging re-id setting imposed grid resulting signiﬁcantly poorer matching rates published methods also veriﬁed evaluation table data also insufﬁcient training samples pairwise camera views resulting signiﬁcant degradation re-id performance pairwise supervised learning based models xqda x-corr. contrast jlml designed avoid need pairwise labelled information model learning instead learning multi-loss classiﬁcations. moreover joint learning multi-loss classiﬁcation beneﬁts concurrent local global feature selections different context resulting robust accurate re-id matching heterogeneous search space. architecture comparisons compared proposed jlml-resnet model four seminal classiﬁcation architectures googlenet resnet model size complexity. table shows jlml smallest model size smallest flops although containing streams layers analysis discussions examined component effects jlml model market- following aspects. complementary beneﬁts global local features. evaluated complementary effects jointly learned local global features comparing individual re-id performance joint features. table shows feature representations alone competitive re-id e.g. local jlml feature surpasses s-cnn rank- performance gain obtained joint feature representation yielding rank- increase boost. results show complementary advantages jointly learning local global features different context using jlml model. importance branch independence. evaluated importance branch independence comparing multiloss design uniloss design merges branches single loss table shows proposed multiloss model signiﬁcantly improves discriminative power global local re-id features e.g. rank- increase improvement shows branch independence plays critical role joint learning multi-loss classiﬁcation effective feature optimisation. plausible reason negative effect single loss imposed learning behaviour branches caused potential divergence discriminative features different context shown signiﬁcant performance degradation global local features uniloss model imposed. full jlml feature. table shows generate similar competitive re-id matching accuracies. suggests ﬂexibility jlml model adopting generic matching metrics. effects body parts number. evaluated sensitivity local decomposition i.e. body parts number table shows decomposition body-parts optimal choice approximately corresponding head+shoulder upper-body upper-leg lower-leg beneﬁts shared low-level features. evaluated effects interaction global local branches introduced shared conv layer deliberately removing comparing re-id performance. table shows beneﬁts jointly learning low-level features common conv layers e.g. improving rank- single-/multiquery re-id. conﬁrms similar ﬁnding multi-task learning study effects selective feature learning. evaluated contribution structured sparsity based selective feature learning table shows mechanism bring additional re-id matching beneﬁts e.g. improving rank- rate choice generic matching metrics. evaluated choice generic matching distances person re-id using complementary effects jlml deep features supervised metric learning. evaluated complementary effects jlml deep features conventional supervised metric learning kissme craft results table show that given strong deep learning features jlml additional distance metric learning beneﬁt training data. moreover even suffer adversary effect. local features global features. strength local features capability mitigating misalignment occlusion compared global features. inherently learned data jlml local branch. figure shows single-query re-id results randomly selected probe persons misalignment and/or occlusion. evident local features achieve better re-id matching ranks global counterparts cases. clearly demonstrates robustness local features misalignment occlusion within person bounding box. feature extraction time cost. average time extracting jlml feature milliseconds image nvidia pascal card. conclusion work presented novel joint learning multiloss model person reidentiﬁcation feature learning. contrast existing re-id approaches often employ either global local appearance features alone proposed model capable extracting exploiting maximising correlated complementary effects learning discriminative feature representations different context subject multi-loss classiﬁcation objectives uniﬁed framework. made possible proposed jlml-resnet architecture design. moreover introduce structured sparsity based feature selective learning mechanism reduce feature redundancy improve joint feature selections. extensive comparative evaluations re-id benchmark datasets conducted validate advantages proposed jlml model wide range state-of-the-art methods manually labelled challenging auto-detected person images. also provided component evaluations analysis model performance order give insights model design. cheng yihong gong sanping zhou jinjun wang nanning zheng. person re-identiﬁcation multichannel parts-based improved triplet loss function. cvpr figure comparing gallery true match ranks probe image occlusion and/or misalignment local global features. probe multiple truth matches gallery. smaller numbers mean better ranking performances. yangqing evan shelhamer jeff donahue sergey karayev jonathan long ross girshick sergio guadarrama trevor darrell. caffe convolutional architecture fast feature embedding. zhao xiaogang wang. human reidentiﬁcation transferred metric learning. accv zhao tong xiao xiaogang wang. deepreid deep ﬁlter pairing neural network person reidentiﬁcation. cvpr tong xiao hongsheng wanli ouyang xiaogang wang. learning deep feature representations domain guided dropout person re-identiﬁcation. cvpr xiong mengran octavia camps mario sznaier. person re-identiﬁcation using kernel-based metric learning methods. eccv. springer xiaolong xiatian shaogang gong xudong jianming kin-man yisheng zhong. person re-identiﬁcation unsupervised video matching. pattern recognition christian szegedy yangqing pierre sermanet scott reed dragomir anguelov dumitru erhan vincent vanhoucke andrew rabinovich. going deeper convolutions. cvpr antonio torralba aude oliva monica castelhano john henderson. contextual guidance movements attention real-world scenes role global features object search. psychological review", "year": 2017}