{"title": "Scan Order in Gibbs Sampling: Models in Which it Matters and Bounds on  How Much", "tag": ["cs.LG", "cs.AI", "stat.ML"], "abstract": "Gibbs sampling is a Markov Chain Monte Carlo sampling technique that iteratively samples variables from their conditional distributions. There are two common scan orders for the variables: random scan and systematic scan. Due to the benefits of locality in hardware, systematic scan is commonly used, even though most statistical guarantees are only for random scan. While it has been conjectured that the mixing times of random scan and systematic scan do not differ by more than a logarithmic factor, we show by counterexample that this is not the case, and we prove that that the mixing times do not differ by more than a polynomial factor under mild conditions. To prove these relative bounds, we introduce a method of augmenting the state space to study systematic scan using conductance.", "text": "gibbs sampling markov chain monte carlo sampling technique iteratively samples variables conditional distributions. common scan orders variables random scan systematic scan. beneﬁts locality hardware systematic scan commonly used even though statistical guarantees random scan. conjectured mixing times random scan systematic scan differ logarithmic factor show counterexample case prove mixing times differ polynomial factor mild conditions. prove relative bounds introduce method augmenting state space study systematic scan using conductance. gibbs sampling glauber dynamics markov chain monte carlo method draws approximate samples multivariate distributions difﬁcult sample directly major gibbs sampling marginal inference estimation marginal distributions variables interest applications include various computer vision tasks information extraction latent dirichlet allocation topic modeling gibbs sampling simple implement quickly produces accurate samples many models widely used available popular libraries openbugs factorie jags madlib gibbs sampling iteratively selects single variable resamples conditional distribution given variables model. method selects variable index sample called scan order. scan orders commonly used random scan systematic scan random scan variable sample selected uniformly independently random iteration. systematic scan ﬁxed permutation selected variables repeatedly selected order. existence distinct options raises obvious question—which scan order produces accurate samples quickly? question components hardware efﬁciency statistical efﬁciency hardware efﬁciency perspective systematic scans clearly superior systematic scans good spatial locality access variables linear order makes iterations faster hardware. result systematic scans commonly used practice. comparing scan orders much interesting perspective statistical efﬁciency focus rest paper. statistical efﬁciency measured mixing time number iterations needed obtain accurate sample mixing times random scan systematic scan studied longstanding conjecture systematic scan never mixes constant factor slower random scan never mixes logarithmic factor faster random scan. conjecture implies choice scan order large effect performance. recently roberts rosenthal described model systematic scan mixes slowly random scan polynomial factor; disproves direction conjecture. independently constructed models scan order signiﬁcant effect mixing time. raises question true bounds difference mixing times? paper address question make following contributions. section study effect variable permutation chosen systematic scan mixing time. particular section construct model systematic scan mixes polynomial factor faster random scan disproving direction conjecture section construct model systematic scan worst-case permutation results mixing time slower polynomial factor best-case systematic scan permutation random scan. section prove weaker version conjecture described above providing relative bounds mixing times random systematic scan. speciﬁcally mild condition different scan orders change mixing time polynomial factor. obtain bounds introduce method augmenting state space gibbs sampling method conductance applied analyze dynamics. recent work made progress analyzing mixing time gibbs sampling still major limitations understanding. particular known results speciﬁc models random scan. example mixing times known mallow’s model colorings graph random systematic scan applicable general models. hand random scan shown polynomial time models satisfy structural conditions close-to-modular energy functions bounded hierarchy width factor weights corresponding results systematic scan known. major exception limitations dobrushin’s condition guarantees mixing random scan systematic scan however many models interest close-to-modular energy functions bounded hierarchy width satisfy dobrushin’s condition. similar choice scan order appears stochastic gradient descent standard algorithm uses random scan incremental gradient method uses systematic scan. contrast gibbs sampling avoiding permutations known important ensure fast convergence paper bring intuition existence permutations gibbs sampling. despite lack theoretical results regarding effect scan order mixing times generally believed scan order small effect mixing time. section ﬁrst deﬁne relevant terms state common conjectures regarding scan order. afterwards give several counterexamples showing scan order asymptotic effects mixing time. mixing time minimum number steps needed guarantee total variation distance true estimated distributions given threshold starting distribution. formally mixing time stochastic process transition matrix steps stationary distribution maximum taken distribution initial state process. comparing statistical efﬁciency systematic scan random scan would useful establish systematic scan process random scan process n-variable model relative bound form functions similarly bound effect choice permutation mixing time would useful know systematic scan processes different permutations model function diaconis levin conjecture systematic scan never constant factor slower logarithmic factor faster random scan. equivalent choosing inequality functions also commonly believed systematic scans asymptotic rate equivalent choosing conjectures imply using systematic scan instead random scan result signiﬁcant consequences least asymptotically particular permutation used systematic scan important. however show neither conjecture true constructing models scan order substantial asymptotic effects mixing time. rest section models detail highlight diversity behaviors different scan orders have. first warm-up construct model call sequence dependencies model single good permutation systematic scan mixes faster polynomial factor random scan systematic scans using permutations. serves counterexample conjectured lower bounds mixing time systematic scan. second construct model islands model small permutations slowly comparison random scan systematic scans. contradicts conjectured upper bounds completeness also discuss discrete pyramid model introduced roberts rosenthal table also lists mixing times additional models constructed models explore space asymptotic comparisons among scan orders brevity defer appendix. ﬁrst model describe sequence dependencies model goal model explore question fast systematic scan constructing model systematic scan mixes rapidly particular good permutation. sequence dependencies model achieves property that time progress towards mixing made particular variable sampled; variable always chosen good permutation. result systematic scan using good permutation makes progress every step random scan systematic scans often fail make progress leads mixing times. thus model exhibits surprising behaviors systematic scan polynomially better random scan systematic scans using different permutations polynomial differences mixing times. describe model detail. variables binary variables independently variable strong prior true. however variable never true unless also true. unnormalized probability distribution following large constant. state space states non-zero probability state ﬁrst variables true remaining variables false. stationary distribution almost mass strong priors variables reaching essentially equivalent mixing. notice sampling almost always move state rarely move effect. worst-case starting state variables must sampled order model mix. random scan number steps needed transition distributed geometric random variable mean similarly number steps needed transition distributed geometric random variable mean total transitions steps needed mix. worst systematic scan worst systematic scan uses order ﬁrst sweep uses second sweep uses general sweep makes progress using transition. finally n-th sweep used ﬁrst step. thus process mixes steps islands sequence dependencies model showed single good permutation much faster scan orders. next describe islands model reverse behavior permutations yield much slower mixing times. islands model achieves disjoint blocks variables consecutively sampling variables block accomplishes little. result systematic scan uses permutation frequently consecutively samples block mixes polynomial factor slower random scan systematic scans. describe model detail. variables binary variables grouped blocks conditioned variables false variable equally likely true false. however variables variables contradict other. result true must false true must false. unnormalized probability distribution model following. model interpreted machine learning inference problem following way. variable represents whether reasoning sentence sound. sentences corresponding sentences corresponding reach contradicting conclusions. variable true conclusion correct sentences reached opposite conclusion must sound corresponding variables must false. however guarantee sentences reached conclusion sound reasoning possible variables block true others false. assumptions alone natural model system islands distribution state space think states divided three groups states island states island single bridge state islands well-connected internally impossible directly move island move island bridge. simplify analysis assume bridge state mass. assumption allows assume islands rapidly comparison time required move onto bridge chains always move bridge variable sampled. asymptotic behavior results bridge state mass states. bridge move island other acts bottleneck. result efﬁciency bridge usage critical mixing time. bridge efﬁciency refer probability chain moves island reaches bridge. assumption mixing within islands rapid comparison time needed move onto bridge mixing time inversely proportional bridge efﬁciency chain. random scan random scan variable selected getting bridge independent previous variable. result probability chain move onto island probability chain return island bridge efﬁciency best systematic scan several different systematic scans achieve fastest mixing time. scan since sampled variables alternate blocks chain moves onto bridge always proceed sample variable block cause move onto island. thus bridge efﬁciency generally systematic scan alternates sampling variables sampling variables bridge efﬁciency worst systematic scan several different systematic scans achieve slowest mixing time. scan case chain moves onto bridge almost always proceed sample variable block return island. fact chain move across islands moves island bridge using transition moves island using transition moves island bridge using transition moves island using transition thus transitions cross bridge bridge efﬁciency generally systematic scan consecutively samples variables variables bridge efﬁciency comparison mixing times mixing times chains inversely proportional bridge efﬁciency. result random scan takes twice long best systematic scan mixes times faster worst systematic scan. discrete pyramid model introduced roberts rosenthal binary variables mass uniformly distributed states true. model mixing time random scan asymptotically better systematic scan permutation mixing time section several experiments illustrate effect scan order mixing times. first figure plot mixing times models section function number variables. experiments validate results asymptotic scaling mixing time well show scan order signiﬁcant effect mixing time even small models. following experiments consider modiﬁed version islands model mass bridge state mass states allow effect scan order clear even small number variables. figure illustrates rate different scan orders explore modiﬁed model. symmetry know half mass island stationary distribution getting half mass onto island necessary mixing. experiment illustrates random scan good systematic scan move island quickly systematic scan requires many iterations. figure illustrates effect permutation chosen systematic scan mixing time. experiment mixing time permutation found plotted sorted order. sequence dependencies model small number good permutations quickly compared permutations random scan. however permutation compared random scan. islands model would expect based analysis section small number permutations slowly compared permutations random scan. permutations slightly better random scan none scan orders substantially better. addition mixing times systematic scan approximately discretized fact mixing time depends heavily bridge efﬁciency. section described models systematic scan polynomial factor faster slower random scan thus invalidating conventional wisdom scan order asymptotically signiﬁcant effect mixing times. raises question different mixing times different scans section derive following weaker correct version conjecture stated diaconis levin obstacles proving result systematic scan chain reversible. standard method handling non-reversible markov chains study lazy version markov chain instead lazy version markov chain step probability staying current state acts normal step otherwise. equivalent stopping random time distributed binomial random variable. fact systematic scan reversible bounds lazy systematic scan rather standard systematic scan. islands models mixing time scan order determined ability move single bridge state restricted ﬂow. suggests technique ability model behavior bridge state needed bound relative mixing times different scans. conductance also known bottleneck ratio topological property markov chains used bound mixing times considering mass around model ability model bottlenecks markov chain makes conductance natural technique studying islands model bounding mixing times general. conductance directly applied analyze random scan. transition matrix corresponding sampling variable state space used without modiﬁcation transition matrix stationary distribution expected target distribution hand conductance cannot directly applied systematic scan. systematic scan true markov chain uses sequence transition matrices rather single transition matrix. standard method converting systematic scan true markov chain consider full scan step markov chain. however makes difﬁcult compare random scan completely changes states connected single steps transition matrix. allow systematic random scan compared easily introduce alternative converting systematic scan true markov chain augmenting state space. augmented state space represents ordered pair normal state index variable sampled. transition probability indicator shows correct variable sampled next. additionally augmenting state space random scan allows easier comparison systematic scan cases. augmented random scan state space also systematic scan. transition probability means next variable sample selected uniformly. stationary distributions augmented random scan systematic scan chains n−π. state space stationary distribution same augmented random scan augmented systematic scan compared directly lets prove following lemma. lemma random scan gibbs sampler systematic scan sampler stationary distribution denote conductance random scan process φrs-a denote conductance augmented random scan process φss-a denote conductance augmented systematic scan process. then lemma upper bound states conductance systematic scan larger conductance random scan. next section show systematic scan cannot much quickly random scan. prove lemma show random scan containing corresponding augmented states systematic scan conductance systematic scan random scan. lower bound lemma states conductance systematic scan smaller function conductance augmented random scan. function depends number variables minxi minimum holding probability state. prove lemma show augmented systematic scan bound conductance augmented random scan. studied effect scan order mixing times gibbs samplers found particular models scan order asymptotic effect mixing times. models invalidate conventional wisdom scan order show cannot freely change scan orders without considering resulting changes mixing times. addition found bounds mixing times different scan orders replaces common conjecture mixing times random scan systematic scan. authors acknowledge support darpa fa---; iis-; ccf-; ccf-; darpa fa---; iis-; ueb; dge-; darpa’s simplex program; oracle; nvidia; huawei; labs; sloan research fellowship; moore foundation; american family insurance; google; toshiba. views conclusions expressed material authors interpreted necessarily representing ofﬁcial policies endorsements either expressed implied darpa afrl u.s. government.", "year": 2016}