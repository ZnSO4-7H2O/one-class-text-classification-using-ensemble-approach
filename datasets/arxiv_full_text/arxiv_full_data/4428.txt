{"title": "Deep Convolutional Neural Networks for Interpretable Analysis of EEG  Sleep Stage Scoring", "tag": ["cs.CV", "stat.ML"], "abstract": "Sleep studies are important for diagnosing sleep disorders such as insomnia, narcolepsy or sleep apnea. They rely on manual scoring of sleep stages from raw polisomnography signals, which is a tedious visual task requiring the workload of highly trained professionals. Consequently, research efforts to purse for an automatic stage scoring based on machine learning techniques have been carried out over the last years. In this work, we resort to multitaper spectral analysis to create visually interpretable images of sleep patterns from EEG signals as inputs to a deep convolutional network trained to solve visual recognition tasks. As a working example of transfer learning, a system able to accurately classify sleep stages in new unseen patients is presented. Evaluations in a widely-used publicly available dataset favourably compare to state-of-the-art results, while providing a framework for visual interpretation of outcomes.", "text": "often presents signiﬁcant bursts rhythmic components particular frequency band ‘alpha’ prominent. american academy sleep medicine recommends segmentation sleep stages alpha rhythm present high-amplitude muscle contractions movement artefacts blinking also appreciated frequency alpha rhythm attenuated replaced mixed frequency theta signal decrease muscle tone slow movements. presents k-complexes range sleep spindles sigma band. slow wave activity exists manually scoring sleep stages tedious task requiring sleep experts visually inspect data recorded whole sleep study. thus considerable effort past years develop machine learning methods automatic sleep scoring. recent survey available literature refer recent research based fully-connected artiﬁcial neural networks variety hand-crafted features extracted signal includes recently recurrent neural network variants used capture long-term dependencies stage transition rules discuss test hypothesis sleep stage classiﬁcation assisted transfer learning take advantage fact sleep scoring visual classiﬁcation problem hence strong progress developing artiﬁcial visual perception using convolutive neural networks particular timefrequency spectrogram images created windowed sleep studies important diagnosing sleep disorders insomnia narcolepsy sleep apnea. rely manual scoring sleep stages polisomnography signals tedious visual task requiring workload highly trained professionals. consequently research efforts purse automatic stage scoring based machine learning techniques carried last years. work resort multitaper spectral analysis create visually interpretable images sleep patterns signals inputs deep convolutional network trained solve visual recognition tasks. working example transfer learning system able accurately classify sleep stages unseen patients presented. evaluations widely-used publicly available dataset favourably compare state-of-the-art results providing framework visual interpretation outcomes. studies sleep assist doctors diagnose sleep disorders provide baseline appropriate follow clinical sleep study design based polysomnography several biological signals acquired patient asleep including electroencephalography monitoring brain activity electrooculogram movements electromyogram measure muscle tone. measurements used classify sleep score i.e. classify sleep stages patient goes study assess existence dysfunction. increasing accessibility signals growing interest sleep quantiﬁcation based alone. signal project received funding european union’s horizon research innovation programme marie sklodowska-curie grant agreement gratefully acknowledge support nvidia corporation donation gpus used research. signals pre-trained visual object recognition task allowing powerful model sleep stage classiﬁcation data would otherwise lead overﬁtting limited availability data. despite quite extensive research efforts sleep scoring exist several challenges related evaluation comparison large variety datasets used evaluate methods; another frequent obstacle design experiments evaluation procedures speciﬁcally proper cross-validation procedures. single train/test split cross-validation performed; others completely lack independent test hence unbiased performance measure. finally others neglect important dependency structures data cross-validating e.g. completely random sampling. random sampling ignores strong dependence data subject even obtained night. paper selected recent results comparison performance. cross-validated proper sense provide relevant information reproducibility. authors conduct time-frequency analysis signal extract relevant features feed ensemble stacked sparse autoencoders. later investigation authors construct end-to-end combining architecture using signals stack frequency-speciﬁc activity time. studies obtain state-of-the-art results. anns often criticized work black boxes input data output values obtained end. understanding complex internal transformations anns perform data crucial domain practitioners need comprehend anns functioning order rely them engineers require deep knowledge system correcting errors improving models. therefore different efforts made provide visualisation techniques matter contributions paper following provide framework automatic analysis single sensor sleep stage scoring highly accurate visually interpretable ﬁrst using multitaper spectral estimation generate colour image spectrograms containing natural image-like features emphasizing sleep patterns experts analyse; secondly given natural image look inputs employ reﬁne super-accurate models trained natural images proven excel natural image visualisation classify different sleep stages; ﬁnally make sensitivity analysis inﬂuential features network back input space providing highly interpretable images network’s functioning. particular employ highly used publicly available database classify sleep stages mentioned average accuracy independent test imcnns originally introduced late biologically inspired models perform image recognition. however major breakthrough ﬁeld occurred deep alexnet imagenet largescale visual recognition challenge margin competing models. since then cnns become workhorse visualisation tasks ilsvrc preferred benchmark test performance. alexnet consisted convolutional layers max-pooling layers three fully-connected layers. zfnet competition similar architecture alexnet better optimised hyperparameters; authors also provided approach visualise working cnn. googlenet competition composed layers; many contained inception module several convolutions pooling parallel well replacing fully-connected layers average-pooling. nevertheless highly successful model year vggnet thanks simplicity -layer network composed exclusively convolutions max-pooling fully-connected layers. challenge resnet -layer uses residual blocks convolutions activations compute transformation function feature maps rather deviation identity function. challenge training ﬂexible models avoid overﬁtting previously mentioned cnns large amounts training data apply data augmentation dropout techniques address issue. still exist many domains acquiring input data costly training deep neural network novo simply feasible. therefore transfer learning interest. case cnns trained natural images seems consistent behaviour lower layers network hierarchy learn general features similar gabor ﬁlters colour blobs higher layers capture domain speciﬁc representations. observation studied layers’ generality-speciﬁcity trade-offs quantitatively evaluated. authors also analysed decrease transferability performance target task differs original one. different study authors features learned object recognition task extract features varying visual problems datasets obtaining superior results task-speciﬁc state-of-the-art systems. finally used transfer learning cnns extract features unrelated tasks presenting insufﬁcient data approach allowing ﬂexible models. current study resort sensitivity analysis visualisation tool better understand decisions made network. precisely tn}n dataset -dimensional input vectors corresponding class labels built acts function approximator estimate relative importance network places every input feature discriminate among existing classes loss function choice absolute value sensitivity maps created disposing corresponding colour matrix forming image. fact current frameworks supplying building capabilities provided automatic differentiation procedures reduces calculation sensitivity maps simple function call. sleep recordings sleep-edf database physionet repository particular subset data study effects sleep healthy subjects containing whole-night recordings fpz-cz pz-oz channels sampled corresponding hypnograms subjects years sleeping time retrieved recording interval annotated lights lights times minutes before/after ﬁrst/last scored sleep epoch annotations provided. class labels obtained hypnograms every images created fpz-cz sensor explained section setting tapers purpose capture sleeping dynamics microevent time scale maintaining somewhat resolution window stepsize order match ﬁnal image resolution size corresponding current epoch plus previous posterior epochs shown improve overall accuracy better classifying transition stages spectrogram values data represented time-frequency images. spectral estimation based fourier analysis assumes series properties data inﬁnite signals continuity periodicity stationarity. however none assumptions typically fulﬁlled data therefore practise spectrogram becomes highly biased estimator. common strategy reduce spectrogram’s bias convolving signal window function performing spectral estimation. another important drawback spectrogram produces estimates high variance across frequencies even increased tapers. method called multitaper spectral estimation used reduce bias variance applying multiple taper functions signal averaging results. technique recently proven highly successful analysing neurophysiological dynamics sleep using exists hyperparameters highly inﬂuence results multitaper spectral estimation window size seconds window stepsize seconds minimum frequency resolution resolved timehalf-bandwidth product usually deﬁned number tapers used often according heuristic function rounds closest integer estimating multitaper spectrogram convert values logarithmic scale split equally-length bins size called epochs. then convert epoched spectrogram colour matrix applying preferred colourmap interval colours). ccmccmcccmcccmcccmfcrfcrfcs means convolutional ﬁlter stride using relu activation function stands maxpooling layer stride correspond fully-connected layers relu soft-max activations respectively; sub-indexed values represent number channels block. transfer learning employed using weight values convolutional layers previously trained ilsvrc- data provided authors http//www.robots.ox.ac.uk/˜vgg/ research/very_deep. fully-connected layers initialised scratch using xavier’s initialisation following used leave-one-subject-out sampling schema partition data train test datasets splitting training dataset randomly selecting subjects validation remaining actual training. mentioned works address skewed performance favouring represented classes training imbalanced datasets using different approaches ﬁrst study employs class-balanced random sampling ensemble classiﬁers second uses different classbalanced batch stochastic gradient descent epoch. virtually strategies randomly balancing classes epoch obtaining ensemble behaviour thanks dropout layers cnns trained optimising categorical crossentropy predicted values class labels using adam mini batches training examples learning rate decay rate ﬁrst second moments respectively. validation employed choose hyper-parameters loss stopping criterion avoid overﬁtting. evaluated method different scenarios ﬁrst used vggnet feature extractor convolutional layers kept ﬁxed last fullyconnected layers network trained scratch speciﬁc sleep scoring problem. second scenario weights network updated obtaining ﬁne-tuned network preliminary results including randomly initialised network consistently showed suboptimal classiﬁcation accuracy pronounced smaller training was. convergence time network average times slower vgg-ft. split results binary one-vs-all classiﬁcation renormalised order calculate per-class precision sensitivity f-score accuracy comparison existing literature presented table conﬁdence interval measure computed using bootstrapping. bootstrap iterations confusion matrices subjects sampled values aggregated. then evaluation metric calculated. bootstrap samples evaluation metric ordered values positions reported. shown table block correctly sleep stage classiﬁed vgg-fe epochs properly assigned. followed difﬁcult stage classify epochs correctly assigned. highest misclassiﬁcation rate stage assigning epochs stage followed ﬁnally behaviour consistent literature results seem indicate that transitions acceptably captured method clearly misses important information. turn attention towards per-class metrics observe precisions range except reaches inconsiderable however sensitivities scoring signiﬁcantly lower values lying interval exception presents score highly impacting accuracy f-score class. table bottom block shows results obtained vgg-ft. improvement network respect vgg-fe homogeneous across classes prominent increase sensitivity class achieved reducing misclassiﬁcation followed increase sensitivity precision better understand internal representation network selected best performing subject calculated sensitivity maps class independently. fig. depicts accurately classiﬁed spectrogram sleep stage characteristic examples inputs classiﬁcation system. notice current epoch classiﬁcation centre spectrogram previous epochs span between posterior epochs placed within interval. fig. bottom shows per-class sensitivity generated according using instances subject speciﬁc class summing colour channels followed normalisation converted back image using ‘jet’ colour map. analyse according sleep stage deﬁnitions section fig. presents high sensitivity alpha band characteristic stage mainly centred current epoch immediately following maybe order able identify transition stage. sensitivity frequency activity corresponding blinks also evident. stage seems show slightly decreased sensitivity alpha band compared rather higher sensitivity theta preceding epochs. interestingly fig. exhibits increased sensitivity around upper sigma band current epoch frequencies across whole image might correspond network identifying spindles k-complexes respectively characteristic features stage. slow wave activity seems present sensitivity highest impact current succeeding epochs. finally wide power band spanning approximately present fig. probably accounting mixedfrequency signal distinctive stage. demonstrated classiﬁcation sleep stages effectively framed visual task ﬁrst creating natural colour like images using multitaper spectral estimation applying recent achievements object recognition ﬁeld obtain state-of-the-art classiﬁcation accuracy. moreover approach greatly enhances interaction domain expert providing interpretable patterns make sense well framework based sensitivity analysis easily inspect network’s reasoning. think tools presented transcend sleep scoring applied tasks within analysis generally biological domains time-frequency signals recorded. improvement method includes better hyperparameter optimisation generating spectral images. thorough study obtained vggnet layers might also interest gain deeper understanding internal structure network. ebrahimi automatic sleep stage classiﬁcation based signals using neural networks wavelet packet coefﬁcients annual international conference ieee engineering medicine biology society tsinalis p.m. matthews automatic sleep stage scoring using time-frequency analysis stacked sparse autoencoders annals biomedical engineering vol. hashem sensitivity analysis feedforward artiﬁcial neural networks differentiable activation functions proceedings international joint conference neural networks vol. j.m. zurada sensitivity analysis minimization input data dimension feedforward neural network proceedings ieee international symposium circuits systems vol.", "year": 2017}