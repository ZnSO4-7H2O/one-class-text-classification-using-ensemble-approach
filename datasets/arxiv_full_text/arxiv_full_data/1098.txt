{"title": "Deep learning with convolutional neural networks for decoding and  visualization of EEG pathology", "tag": ["cs.LG", "cs.NE", "stat.ML", "I.2.6"], "abstract": "We apply convolutional neural networks (ConvNets) to the task of distinguishing pathological from normal EEG recordings in the Temple University Hospital EEG Abnormal Corpus. We use two basic, shallow and deep ConvNet architectures recently shown to decode task-related information from EEG at least as well as established algorithms designed for this purpose. In decoding EEG pathology, both ConvNets reached substantially better accuracies (about 6% better, ~85% vs. ~79%) than the only published result for this dataset, and were still better when using only 1 minute of each recording for training and only six seconds of each recording for testing. We used automated methods to optimize architectural hyperparameters and found intriguingly different ConvNet architectures, e.g., with max pooling as the only nonlinearity. Visualizations of the ConvNet decoding behavior showed that they used spectral power changes in the delta (0-4 Hz) and theta (4-8 Hz) frequency range, possibly alongside other features, consistent with expectations derived from spectral analysis of the EEG data and from the textual medical reports. Analysis of the textual medical reports also highlighted the potential for accuracy increases by integrating contextual information, such as the age of subjects. In summary, the ConvNets and visualization techniques used in this study constitute a next step towards clinically useful automated EEG diagnosis and establish a new baseline for future work on this topic.", "text": "regression neural networks more. large variety used methods indicates search best decoding approach diverse types diagnosis still ongoing. overcome lack large datasets representative variety eeg-diagnosable diseases heterogeneity clinical populations temple university hospital published unprecedented public dataset clinical recordings dataset clinical recordings abnormal corpus recordings created speciﬁcally foster development methods distinguishing pathological normal eeg. size rich annotation data potential contribute progress automated diagnosis. baseline results dataset already reported using convolutional neural network multiple fully connected layers uses precomputed bandpower-based features input reached accuracy deep learning approaches recently receive increasing attention many types machine learning problems healthcare deep convnets trained end-to signals promising deep learning technique. convnets exploit hierarchical structure present many natural signals. recently deep convnets trained end-to-end were example able accurately diagnose skin cancer types images human dermatologists could segment retinal vessels better human annotators deep convnets nowadays also applied analyses decoding task-related information recently developed validated braindecode toolbox purpose showed performance deep convnets trained end-to-end comparable algorithms using hand-engineered features decode task-related information. also introduced novel visualization methods gain better understanding convnet decoding behavior. study apply deep convnets problem distinguishing normal pathological abnormal corpus show reach better accuracies published baseline result aware abstract—we apply convolutional neural networks task distinguishing pathological normal recordings temple university hospital abnormal corpus. basic shallow deep convnet architectures recently shown decode task-related information least well established algorithms designed purpose. decoding pathology convnets reached substantially better accuracies published result dataset still better using minute recording training seconds recording testing. used automated methods optimize architectural hyperparameters found intriguingly diﬀerent convnet architectures e.g. pooling nonlinearity. visualizations convnet decoding behavior showed used spectral power changes delta theta frequency range possibly alongside features consistent expectations derived spectral analysis data textual medical reports. analysis textual medical reports also highlighted potential accuracy increases integrating contextual information subjects. summary convnets visualization techniques used study constitute next step towards clinically useful automated diagnosis establish baseline future work topic. electroencephalography widely used clinical practice cost lack side eﬀects noninvasive nature. important screening method well hypothesis-based diagnostics e.g. epilepsy stroke. main limitations using diagnostics required time specialized knowledge experts need well-trained diagnostics reach reliable results. therefore machine-learning approach aids diagnostic process could make diagnosis widely accessible reduce time eﬀort clinicians potentially make diagnoses accurate. recent years researchers increasingly addressed ﬁeld computer-aided diagnosis. applications mostly limited speciﬁc diagnoses alzheimer’s disease depression traumatic brain injuries stroke used large variety machine-learning techniques including k-nearest neighbors random forests support vector machines linear discriminant analysis logistic used convolutional network architectures recently showed decode task-related information time-domain least good accuracies previous state-of-the-art algorithms relying hand-engineered features deep convnet fairly generic architecture shallow convnet speciﬁcally tailored decode band-power features details models accommodate longer duration inputs compared previous study adapted architectures changing ﬁnal layer ﬁlter length convnets input length input samples correspond seconds input. additionally moved pooling strides deep convnet convolutional layers directly pooling. modiﬁcation initially considered mistake allowed grow convnet input length without strongly increased computation times provided good accuracies preliminary experiments training data; therefore decided keep optimized convnet parameters using stochastic gradient descent optimizer adam make best available data trained convnets maximally overlapping time crops using cropped training described code reproduce results study available https //github.com/robintibor/auto-eeg-diagnosis-example. also evaluated convnets reduced versions datasets using ﬁrst minutes ﬁrst minute recording reduced either training data test data both. analyses carried study long recordings need training predicting pathologies good accuracies. also carried preliminary study automatic architecture optimization improve convnet architectures. used automatic hyperparameter optimization algorithm smac optimize architecture hyperparameters deep shallow convnets ﬁlter lengths strides types nonlinearities. objective function optimize smac used -fold crossvalidation performance obtained ﬁrst recordings training data time limit hours conﬁguration single fold. runs timed crashed scored accuracy understanding convnet behavior decoding predictions important automatic diagnosis become practically useful assistive diagnosis technology. better understand convnets used study used input-perturbation network-prediction correlation maps recently developed speciﬁcally convnets decoding. method shows eﬀect perturbing input amplitudes diﬀerent frequencies convnet decoding predictions. visualization provide spatial maps show scalp amplitude change given frequency range correlates negatively positively convnet classiﬁcation decision. details furthermore better understand kind recordings easier harder convnets correctly decode analyzed textual clinical reports recording included abnormal corpus. speciﬁcally investigated words relatively less frequent incorrectly compared correctly predicted recordings. performed analysis independently normal pathological class recordings. concretely class ﬁrst computed relative frequencies word incorrectly predicted |wi−| |wi−| |wi−| denotes recordings i.e. number occurrences word incorrectly predicted recordings. computed frequencies computed ratios fi−/fi+. finally analyzed words large ratios small ratios inspecting contexts occurrences clinical reports. allowed gain insights clinical/contextual aspects recordings correlated convnets failures. fig. deep convnet architecture. black cuboids inputs/feature maps; brown cuboids convolution/pooling kernels. corresponding sizes indicated black brown respectively. spatial ﬁlter weights possible pairs electrodes ﬁlters preceding temporal convolution. note schematics proportions maps kernels approximate. temple university hospital abnormal corpus dataset manually labeled normal pathological clinical recordings. taken data corpus contains clinical recordings subjects years abnormal corpus contains recordings labeled normal labeled pathological. corpus split training evaluation table recordings acquired least standard electrode positions sampling rate cases recording around minutes data. inter-rater agreement medical report certiﬁed neurologist another annotator training recordings evaluation recordings. results evaluation abnormal corpus. deep shallow convnets mean independent runs diﬀerent random seeds. sensitivity speciﬁcity commonly deﬁned ratio number true positives number positives ration number true negatives number negatives respectively. deep shallow convnet outperformed feature-based deep learning baseline n.a. applicable. deep shallow convnet outperformed results published abnormal corpus convnets better baseline method convolutional network included multiple fully connected layers took precomputed features entire recording input convnets applied reduced error rate also tested linear classiﬁer -second inputs convnets. linear classiﬁer reach accuracies substantially diﬀerent chance fig. confusion matrices deep shallow convnets summed independent runs. entry column upper-left xsquare number trials target predicted class bold diagonal corresponds correctly predicted trials classes. percentages colors indicate fraction trials cell relative trials. lower-right value overall accuracy. ﬁrst values bottom correspond sensitivity speciﬁcity. rightmost column corresponds precision deﬁned number trials correctly predicted class r/number trials predicted class convnets made errors pathological recordings seen fig. convnets reached speciﬁcity sensitivity confusion matrices approaches similar. relative baseline reached similar sensitivity higher speciﬁcity interestingly convnet architectures already reached higher accuracies baseline evaluating single predictions -second crops. average per-crop accuracy individual predictions lower average per-recording accuracy furthermore individual prediction accuracies already higher per-recording accuracies baseline. implies predictions high accuracies made seconds data. deep convnets already reached best trialwise accuracies minute data used prediction. reduction amount length training data croptrialwise accuracy decreases test data reductions test data eﬀect remarkably croptrialwise accuracies slightly decreased going minute minutes fig. results reduced datasets deep convnet. train and/or test dataset reduced minutes recording minutes recording results shown test set. notably reducing duration test recordings maximal accuracies observed using minute. note results based only; slightly better performance table thus noise. fig. moving average cropwise accuracies deep convnet. minute moving averages cropwise accuracies deep convnet averaged test recordings. dashed lines represent individual training runs diﬀerent random seeds solid black line represents mean results runs. x-axis shows center -minute averaging window. test data. investigate whether earlier parts recordings might informative also computed -minute moving average cropwise accuracies test data deep convnet trained full data. show average recordings moving averages fig. noticeably expected accuracies slightly decreased increasing recording time. however decrease thus interpreted cautiously. models discovered automated architecture optimization markedly diﬀerent original deep shallow convnets designed based experience previous study decoding task-related information example optimized architectures used seconds data optimized deep shallow convnet respectively contrast seconds original versions. improved performance modiﬁed architectures -fold cross-validation training dataset generalize evaluation modiﬁcations original network architectures already provided interesting insights exploration example case shallow convnet modiﬁed architecture original nonlinearities used pooling nonlinearity conﬁguration considered manual search far. moving convnet visualization examined spectral power changes pathological compared normal recordings. power broadly increased pathological class frequency bands decreased beta gamma ranges alpha power decreased occipital electrodes increased frontal electrodes. scalp maps input-perturbation eﬀects predictions pathological class diﬀerent frequency bands showed eﬀects consistent power spectra fig. networks strongly relied lower frequencies delta theta frequency range decoding decisions. notably small amount much larger word frequency incorrectly predicted pathological recordings compared correctly predicted pathological recordings. closer inspection showed sensible small amount often used describe subtle abnormalities subtlety changes likely cause classiﬁcation errors. secondly words notably diﬀerent frequency sleep typically indicate clinician used subject fact asleep recording interpret obviously convnets trained access context information leaving disadvantage finally consistent strong usage delta theta frequency range convnets seen inputperturbation network-prediction correlation maps slowing temporal frequently occurring words textual reports pathological recordings never occurring textual reports normal recordings best knowledge convnet architectures used study achieved best accuracies published abnormal corpus. architectures used slightly modiﬁed versions convnet architectures previously introduced decode task-related information. suggests architectures might broadly applicable physiological clinical eeg. identiﬁcation all-round architectures would greatly simplify application deep learning decoding problems expand potential cases. remarkably convnets already reached good accuracies based limited time segments recordings. accuracy improvements could thus possible improved decoding models extract integrate additional information longer timescales. exact nature models well amount would require remains determined. accurate decoding models could either convnets designed intelligently larger input length recurrent neural networks since known inherently work well data information shorter longer term scales. furthermore combinations approaches example using recurrent neural network convnet used domains like speech recognition promising. automated architecture optimization provided interesting insights yielding conﬁgurations markedly diﬀerent hand-engineered architectures reached similar accuracies. since marked improvements training performance improve evaluation accuracies study future work plan training recordings optimization study diﬀerent cross-validation methods also improve evaluation accuracies. full-blown architecture search could also improve accuracy. improved methods would also important decode pathological normal binary fashion also evaluate possibility derive ﬁnegrained clinical information type pathological change likely underlying disorder pathological normal relative spectral bandpower diﬀerences training set. shown logarithm ratio median bandpower pathological normal recordings. input-perturbation network-prediction correlation maps deep shallow convnet. correlation predictions pathological class amplitude perturbations. scalp maps revealed example bilateral positive correlation delta theta frequency ranges spatially broadly distributed negative correlation beta gamma frequency ranges indicating convnets used frequency components decisions still yield clinically useful insights diagnosis explanations improvements convnet visualizations needed. deep learning models attention mechanism might interpretable since models highlight parts recording important decoding decision. deep learning visualization methods like recent saliency methods explain individual decisions conditional generative adversarial networks understand makes recording pathological normal might improve clinical beneﬁt deep learning methods decode pathological eeg. summary deep convnets presented study yielded best accuracies published largest available dataset decoding pathology that made next step towards clinically useful automated diagnosis. improvements might eventually bring machine-learning decoding performance pathological closer human-level performance. since clinicians make judgments patterns available context information clear reason machine learning models access information could reach human-level accuracy. human-level performance benchmark decoding accuracies exist brain-signal decoding tasks e.g. decoding task-related information brain-computer interfaces inherent uncertainty information even present human-level benchmark exists. perturbation visualizations convnets’ decoding behavior showed used spectral power changes delta theta frequency range particularly temporal channels possibly alongside features observation consistent expectations implied spectral analysis data textual reports frequently mentioned temporal slowing respect pathological samples never normal ones. perturbation visualization showed results consistent expectations convnets would bandpower diﬀerences classes already visible spectra perform decoding. similarly textual reports also yielded plausible insights e.g. small amounts abnormalities indicated written clinical reports diﬃcult networks decode correctly. additionally inspection textual reports also emphasized importance integrating contextual information subject. constructing long short-term memory based deep recurrent neural networks large vocabulary speech recognition ieee international conference acoustics speech signal processing apr. sainath vinyals senior convolutional long short-term memory fully connected deep neural networks ieee international conference acoustics speech signal processing apr. miikkulainen liang meyerson rawal fink francon raju shahrzad navruzyan duﬀy hodjat evolving deep neural networks arxiv. mar. arxiv available http//arxiv.org/abs/. p.-j. kindermans schãĳtt alber k.-r. mãĳller dãďhne patternnet patternlrp improving interpretability neural networks corr vol. abs/. available http//arxiv.org/abs/.", "year": 2017}