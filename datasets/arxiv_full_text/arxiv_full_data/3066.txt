{"title": "A Classification Refinement Strategy for Semantic Segmentation", "tag": ["cs.CV", "cs.AI", "cs.LG"], "abstract": "Based on the observation that semantic segmentation errors are partially predictable, we propose a compact formulation using confusion statistics of the trained classifier to refine (re-estimate) the initial pixel label hypotheses. The proposed strategy is contingent upon computing the classifier confusion probabilities for a given dataset and estimating a relevant prior on the object classes present in the image to be classified. We provide a procedure to robustly estimate the confusion probabilities and explore multiple prior definitions. Experiments are shown comparing performances on multiple challenging datasets using different priors to improve a state-of-the-art semantic segmentation classifier. This study demonstrates the potential to significantly improve semantic labeling and motivates future work for reliable label prior estimation from images.", "text": "figure example contextual errors reﬁnenet pascal-context. in-context sofa back left image classiﬁed floor incorrect even though label correctly appears elsewhere image. out-of-context portion right image classiﬁed motorbike valid label anywhere image. given classiﬁer similar performance characteristics related images analysis classiﬁcation errors label confusions across dataset support secondary reﬁnement stage re-estimate output label conﬁdences better classify pixels reducing in-context out-of-context errors. proposed approach based underlying motivations. method derived direct marginalization probability label given input data resulting decomposition formulation classiﬁer output label probabilities learned classiﬁer/truth confusions. applied together framework treats conﬁdence levels original classiﬁer output partial evidence incorporates confusion information determine ﬁnal probability witnessing object label location image. sense confusion approach considered form context-aware re-estimation. present robust method compute confusion probabilities also outline various label priors used bias reﬁnement. abstract—based observation semantic segmentation errors partially predictable propose compact formulation using confusion statistics trained classiﬁer reﬁne initial pixel label hypotheses. proposed strategy contingent upon computing classiﬁer confusion probabilities given dataset estimating relevant prior object classes present image classiﬁed. provide procedure robustly estimate confusion probabilities explore multiple prior deﬁnitions. experiments shown comparing performances multiple challenging datasets using different priors improve stateof-the-art semantic segmentation classiﬁer. study demonstrates potential signiﬁcantly improve semantic labeling motivates future work reliable label prior estimation images. semantic segmentation challenging computer vision problem wherein class label assigned pixel image. provides much richer scene information traditional image classiﬁcation therefore inherently difﬁcult task. image classiﬁcation requires detection primary object semantic segmentation requires precise localized pixel-wise detections. annotating training images semantic segmentation supervised manner expensive time-consuming hence public datasets relatively small comparison image classiﬁcation current semantic segmentation methods show promising results multiple datasets however systematic errors output readily found. example reﬁnenet mis-classiﬁes ground sidewalk often pascal-context dataset pixels classiﬁed sidewalk likely actually ground. example pixel accuracy would improved simply relabeling sidewalk pixels ground. however preferable confusion knowledge better reason certain situations probabilistic manner. categorize labeling errors types mistakes. in-context labeling error pixel assigned incorrect label actual labels given image out-of-context labeling error given semantic segmentation classiﬁer generates pixel-wise label hypotheses images. output pixel site provides conﬁdence/probability every possible class image data pixel site possible label denote classiﬁer output probabilities l|di). note differentiate typical classiﬁer output notation ﬁnal predictions usually made choosing label assigned highest conﬁdence/probability site. propose bayesian method exploit confusions exhibited classiﬁer probabilistically reﬁne improve estimate best label site. begin |di) probability site examining given image data note probability classiﬁer output probability hence currently independent particular classiﬁer. ﬁrst term two-part decomposition eqn. represents confusion relationship ground truth label classiﬁer outputs. second term contains classiﬁer’s output probabilities initially described. denominator computed integration numerator possible labels relax probabilities site-independent data-independent ease learning generalization. hence probability pixel label given classiﬁer’s selected class label rest paper organized follows. section describes related work semantic segmentation. section describes framework classiﬁer reﬁnement using label confusion probabilities priors. section presents experimental results showing performance improvements approach multiple datasets followed conclusion sect. convolutional neural networks achieved unprecedented results semantic segmentation. however also introduce tension precise localization inclusion broader image context many recent innovations network architecture motivated issue including dilated convolution multi-scale prediction zoom-out features recursive convolutional networks convolutional upsampling context techniques k-nearest-neighbors methods conditional random ﬁelds precision matrices approaches remain relevant part ﬂexibility. research continued investigate estimating employing co-occurrence statistics crfs recent methods attempted integrate crfs directly neural models proposed method provides bayesian framework incorporate context formed confusion probabilities label priors inﬂuence pixellevel decisions. related work proposed framework approach labelbank methods process secondary information adjust conﬁdence values produced base classiﬁer. labelbank uses architecture estimate classes present image essentially ﬁlters labels output base semantic segmentation classiﬁer belong list. method therefore focuses removal out-of-context errors. strategy ﬂexible include additional confusion probabilities relax requirement binary estimation classes together allow method general remove in-context outof-context errors. furthermore approach supported within bayesian framework rather applying masking technique. show experiments upper bound performance capability approach labelbank optimum. describe procedure reﬁne classiﬁer output label probabilities tempted view form boosting. similar boosting approach staged process ﬁrst running base classiﬁer reﬁning output hypotheses however boosting trains efﬁciently formulate process employing single transformation matrix possible label combinations. reﬁnement matrix deﬁned given instantiations within eqn. pixel site test image construct vector site-dependent base classiﬁer output probabilities c|di)∀c following eqn. employing matrix equivalent reﬁne original classiﬁer output probabilities linear transformation reﬁnement process conducted site test image classiﬁed. since matrix computed entire image using siteindependent data re-estimation procedure quite fast computationally efﬁcient. reﬁnement framework straightforward derive show used signiﬁcantly improve performance. next present means robustly compute confusion probabilities detail various forms prior expectations needed process. site-independent classiﬁer/truth confusion probabilities required eqn. readily learned data collecting sites speciﬁc ground truth label determining frequency sites classiﬁer assigned label ensure probabilities deﬁned minimum value used confusion pairing number sites particular classiﬁcation output given ground truth label. region border artifacts. region border labeling artifacts common semantic segmentation classiﬁers imprecise manual ground truth labeling along borders objects spatial pooling etc. example fig. show example training image fig. present ground truth region labels. ground truth region borders shown fig. pixel labeling errors image made segmentation classiﬁer reﬁnenet-res highlighted fig. typical semantic segmentation classiﬁers consistently labeling errors along borders regions. example classiﬁer performed particularly well image whole nearly errors occurring region borders learning classiﬁer/truth confusions border pixel errors ignored pollute desired statistics. merely artifacts considered. therefore limit computation confusions non-border pixel sites avoid negatively inﬂuencing confusion probabilities. accomplish this ﬁrst ground truth region border pixels image perform spatial dilation border pixels. complement pixel image employed computation confusion probabilities. resultant confusion probabilities computed across images analyzed provides single robust confusion representation entire dataset additionally note underlying labeling issue region borders therefore suggests pixel-wise evaluations comparisons semantic segmentation approaches would appropriate ignoring pixels training test/validation data. also important compute confusion probabilities data used train base classiﬁer confusions training data well representative types confusions occur additional data. illustrate begin representing confusion probabilities matrix rows representing class labels given base confusion probabilities computed remaining component necessary classiﬁcation reﬁnement label prior term represents prior expectation given class label deﬁned several ways. uniform prior simplest naive approach would employ non-informative uniform prior. refer version punif /|l|. prior effort reﬁning classiﬁer probabilities would placed onto learned confusions. global prior prior could also interpreted globally probability observing class randomly selected pixel across dataset prior computed simply l-normalizing histogram class labels collected throughout entire training dataset. refer prior pglobal. however formulation bias reﬁnement dominant class labels dataset. binary prior alternatively could specify prior locally estimating image individually. binary prior constant value classes present image zero elsewhere refer prior pbinary. easier estimate image-level prior dense per-pixel label assignments prior also explored labelbank histogram prior similar binary prior construct informative non-binary prior using lnormalized histogram classes present image. refer prior phist. posit estimating class-frequency histogram labels image difﬁcult binary prior similarly easier estimate full per-pixel label assignments image. unconstrained prior lastly prior could viewed abstractly separated binary frequencybased constraint interpretation. case given collection annotated classiﬁed sites image along confusion probabilities best possible prior could solved using non-linear multi-variate techniques minimizing negative log-loss ﬁnal reﬁned class probabilities target ground truth labels. based eqn. given solving within loss classiﬁer output columns signifying ground truth classes therefore cell matrix holds value scenario absolutely confusions matrix would strictly diagonal. offdiagonal entries denote errors exist output classiﬁer. note matrix different earlier reﬁnement matrix demonstrate need computing confusion probabilities separate validation data show fig. confusion probability matrix generated pascal-context training using reﬁnenet-res notice strong diagonal structure showing classiﬁer indeed training data well. however compare trained classiﬁer employed pascal-context test resulting confusion probabilities shown fig. results show much greater off-diagonal confusions demonstrating classiﬁer prone making qualitatively different types mistakes unseen data. hence confusion probability differences demonstrate need learn confusions examples separate training data ideally validation available however found many semantic segmentation approaches follow standard machine learning practice withholding separate validation training data. instead tend available training data validate directly test previously stated recommended proposed approach retain small validation data learn confusion probabilities. validation data available using pre-trained model small random sample test data could employed. present experimental results analyses proposed reﬁnement approach across challenging datasets commonly used semantic segmentation. adek recent dataset varied scenes training testing images dense labeling classes. pascal-context densely-labeled dataset various scenes labels comprised training testing images. nyudv contains rgb-d images indoor rooms training testing images selected reﬁnenet semantic segmentation model base classiﬁer reﬁned approach. reﬁnenet resnet-based architecture employs residual chained pooling localize coarse predictions using high-resolution features multiple paths. model previously trained aforementioned datasets publicly-released online note reﬁnenet includes background class valid output label work removed background label outputs renormalized remaining label conﬁdences. ﬁrst present computed confusion probability matrices three datasets. discussed sect. training data compute confusion probabilities lead poor performance. since validation hold-out sets used reﬁnenet datasets instead used suggested random sample test data compute confusion probabilities dataset. number randomly sampled test images dataset adek pascal-context nyudv. resulting confusion probability matrices using approach outlined sect. iii-a shown fig. clearly many off-diagonal confusions present dataset. example confusion situations include {animal/rug river/water} adek {sofa/computer ground/sidewalk} pascal-context {door/wall box/other-prop} nyudv. also note similarity sampled confusion probabilities pascal-context fig. confusions derived entire test analyzed standard score metrics pixel accuracy mean intersection-over-union various reﬁnements base classiﬁer using different priors described sect. iii-b. resulting scores base classiﬁer three datasets presented tables using uniform prior punif /|l| global prior pglobal corresponding dataset confusion probability matrix provided second third rows tables. methods generally within base classiﬁer hence signiﬁcant change reﬁnement pixel accuracy scores pglobal higher punif result bias dominate classes dataset. lower mean scores pglobal also reﬂect bias. next examined informative imagebased priors present ceiling metrics reﬁnement across datasets. used ground truth data available compute optimal priors deﬁnition leaving estimation particular priors future work. study used demonstrate full potential proposed strategy motivate future efforts. proach removes out-of-context label errors using optimal binary mask output label probabilities. signiﬁcant improvement ceilings pixel accuracy mean base classiﬁer. note method equivalent reﬁnement approach using optimal/known binary priors pbinary identity confusion probability matrix employing binary priors pbinary above computed confusion matrix performance improved. ﬁfth table shows increase .-.% pixel accuracy .-.% mean previous optimal labelbank method shows confusion probabilities indeed used increase performance additionally removing many in-context errors using histogram priors phist provides increase pbinary results additional increase .-.% pixel accuracy .-.% mean iou. expected given prior better adjusted reﬂect true distribution labels image. lastly unconstrained priors give expected best upper bound performance prior versions yielding additional increase phist .-.% pixel accuracy .-.% mean iou. priors solved optimize given reﬁnement formulation improvements close maximum theoretically possible results. overall possible reﬁnement gains base classiﬁer .-.% pixel accuracy .-.% mean across datasets. upper bound results show still much room improvement classiﬁer achieved using reﬁnement confusion probabilities appropriate priors. prior deﬁned globally punif pglobal used together confusion probabilities reﬁne test images minimal beneﬁt notable gains achieved priors computed independently test image. presented results image-based priors pbinary phist demonstrate increasingly higher gains possible pixel accuracy mean proposed strategy. based results future work address detail particular prior expectations reliably estimated image data. consider constructing priors base classiﬁer’s existing semantic segmentation results phist histogram labels given classiﬁer test image) reﬁnement yields improvement obviously biased base classiﬁer results. possible method similar training images test image weighted combination priors images appear similar likely related label priors. another path explore specialized deep learning technique estimate prior directly input image itself. unlike semantic segmentation task though approach already exists estimate pbinary normalized label histogram prior phist shows higher performance ceiling hence method estimate prior would beneﬁcial. expect unconstrained priors resulted highest performance metrics difﬁcult estimate test images priors function image labels present base classiﬁer confusion probabilities. hence suggest estimation histogram-based priors phist best focus future research. proposed method continues produce label probabilities/conﬁdences therefore easily integrated processing strategies context-based reasoning. example instead probabilistically reﬁning pixel site independently sites holistic approach formulating spatial random ﬁeld could employed produce spatiallyconsistent solution. semantic segmentation complex visual task requiring reliable consistent pixel-wise label predictions. current models produce systematic errors exploited reﬁne initial conﬁdences classiﬁer. presented general bayesian strategy classiﬁer reﬁnement deriving straight-forward compact description comprised confusion probabilities label priors classiﬁer conﬁdences. understanding types mistakes made classiﬁer label assignments demonstrated strong potential proposed method successfully reﬁning state-of-theart classiﬁcation model multiple datasets. results motivate future research reliably estimating prior expectations images. l.-c. chen papanderou kokkinos murphy yuille deeplab semantic image segmentation deep convolutional nets atrous convolution fully connected crfs arxiv. maturana scherer multi-scale convolutional architecture semantic segmentation robotics institute carnegie mellon university tech. rep. cmu-ritr-- october", "year": 2018}