{"title": "Bootstrapping Labelled Dataset Construction for Cow Tracking and  Behavior Analysis", "tag": ["cs.CV", "cs.AI", "cs.LG"], "abstract": "This paper introduces a new approach to the long-term tracking of an object in a challenging environment. The object is a cow and the environment is an enclosure in a cowshed. Some of the key challenges in this domain are a cluttered background, low contrast and high similarity between moving objects which greatly reduces the efficiency of most existing approaches, including those based on background subtraction. Our approach is split into object localization, instance segmentation, learning and tracking stages. Our solution is compared to a range of semi-supervised object tracking algorithms and we show that the performance is strong and well suited to subsequent analysis. We present our solution as a first step towards broader tracking and behavior monitoring for cows in precision agriculture with the ultimate objective of early detection of lameness.", "text": "abstract—this paper introduces approach longterm tracking object challenging environment. object environment enclosure cowshed. challenges domain cluttered background contrast high similarity moving objects greatly reduces efﬁciency existing approaches including based background subtraction. approach split object localization instance segmentation learning tracking stages. solution benchmarked range semi-supervised object tracking algorithms show performance strong well suited subsequent analysis. present solution ﬁrst step towards broader tracking behavior monitoring cows precision agriculture ultimate objective early detection lameness. domain modern animal husbandry early detection treatment serious challenging problem. lack adequate treatment lead substantial losses farms reduced well-being animals detection treatment animal lameness traditionally involved hiring expensive specialists disease already become highly pronounced. negative consequences late detection recently increased interest applying statistical machine learning methods lameness detection. methods range regressions longitudinal studies neural networks support vector machines analysis mainly rely main sensor types accelerometers weight platforms remote sensors video cameras. work particularly focused video data since convenient humans cows; need lengthy installation equipment equipment cheap viewed long term importantly animal method non-invasive. main drawback video based analysis domain complexity information retrieval needs extract animal’s shape behavior period time relatively complex environments. such best knowledge previous video recordings lameness detection performed open space good contrast multiple shown elsewhere features correlate lameness i.e. gait head tilt weight distribution behavior. principle analyzed video suggest analysis behavior particularly interesting difference behavior lame so-called sound cows observed extensively example shown frequency duration actions like lying walking correlates lameness onset. long term research goal monitor animal behavior directly video predict early onset lameness which given above harder accelerators weight platforms scientiﬁc technical points view. among things cannot approached straightforward manner extraction features generation labelled corpus video data full challenges problems straightforward solution. current article method combines deep learning algorithms heuristic methods ensemble learning algorithm track movement construct labelled dataset. method constructed benchmarked video corpus animal behavior. detail content construction video corpus section present details novel approach object tracking section section experimental results presented together comparison relevant algorithms. finally section outline conclusions plans future work. computer vision monitoring animal behavior varied history. rather providing comprehensive review work here instead focus challenge hand i.e. speciﬁc case behavior tracking bovines. best knowledge date direct overlap literature object tracking behavior-based lameness detection video. however attempts machine learning algorithms like support vector machines directly predict lameness stage lameness identiﬁcation video. cow’s backposture extracted sets cows shot video walking scored observers based presence lameness features authors report accuracy estimation using method. background subtraction publication done relatively straightforward manner video shot outside convenient angle little clutter background mild partial occlusion. importantly contrast background quite sharp cows video. earlier work showed cow’s movement examined manner similar work established high correlation hoof positions estimated camera humans difference position hooves sound lame cows. addition studies publications lameness detection based video shot outside good contrast background object making task much easier problem address paper. beyond speciﬁc application tracking course signiﬁcant research object tracking. work kernel-based semi-supervised ensemble tracking algorithms shown much promise. tracking algorithms categories popular fulﬁl important requirements require fully-labelled datasets supervised learning generalize well different problems. semi-supervised algorithms related median flow developed kalal algorithm also kalal multiple instance learning extension built upon random forests kernel-based algorithms kernel ﬁlter similarity measure recent approaches henriques employs circulant matrices several types kernels fast fourier transform learn dense samples tracked object. advantage algorithms user needs deﬁne starting coordinates size bounding therefore easy test. also recently deep learning algorithms convolutional neural nets adapted tracking tasks convnns popular vgg-net- architecture work interested automated bootstrapping labelled dataset construction cost technical challenges associated building large labelled dataset suitable example deep learning methods. approach building dataset build predictive model track particular video. random forest classiﬁer tracking. give high-level overview stages approach help reader understand different components approach interact. approach building tracking model given involves number steps. ﬁrst step choose video tracked. drawing bounding around ﬁrst frame video label bounding containing target cow. also draw bounding boxes around cows video label bounding boxes distractor cows. sequentially process frame video. processing frame ﬁrst apply model called crfasrnn localize blobs pixels model predicts belonging multiple cows. ambiguity apply edge detector called followed thresholding method process isolates instances cows within blob. words process segment blob multiple instances. note address problem merging blobs discuss future work. extracted instances frame label instances frame belonging either target distractor cows. labelling instance current frame label nearest instance previous frame. using process frame analysis followed nearest neighbor instance labelling track target successfully short well-behaved video sequence. however approach doesn’t scale longer noisier videos. labelled short video construct training random forest model track longer difﬁcult video sequences. build training random forest model extracting features instance frame. construct training one-row-per-instance-per-frame labelled either target instance distractor instance. train validate random forest model constructed dataset test model portions video datasets consist video data collected period days cowshed environment. cameras observed enclosures contained individual animals. cameras mounted ﬁxed angle animals total video data collected. data collected provided irish national agriculture food development authority labelling data provided. wealth data extracted number snippets listed table video sequence time series i.e. ordered data snippet split consecutive training/validation testing. test datasets subsets usually times longer training validation datasets. since cows move slowly took every frame video sequence. therefore table report number frames length video. names datasets consist channel/camera date time hourminutesecond format actual time corresponding ﬁrst second snippet. example means camera number shooting june starting selected training testing datasets following objectives mind want track fairly well visible whole duration learning algorithm enough correctly labelled features train with. test hand least challenges present. recognize simplifying assumptions comparison making purely random selection sequences data believe method useful stage. background background video generally dark suffers contrast easy confuse background animals especially dark-skinned certain cows often discernible even human lighting lighting generally uneven presence narrow long gaps walls ceilings. result many cows bright rectangular patches skin often splitting object parts. easy confuse other. cows malleable objects throughout video appearance changes substantially small facing away camera blending background large contrasting standing perpendicular camera’s direction. types occlusion components cowshed dataset. first enclosure like metal bars concrete troughs serve boundaries enclosure. secondly size enclosure cows block view much time thus changes action blocked away view challenging identify change automatically. features cause considerable trouble existing tracking algorithms. exhibited fig. used tracking algorithms implemented opencv library python mentioned section boosting meanflow. drawbacks become evident ﬁrst frames starts move starting position. trackers fail account changing shape turns around instead learn objects bounding similar background. second challenge metal bars serving partial occlusion moves behind essential feature many tracking algorithms dependence contrast tracked object background however cluttered poses particular challenge project pixel intensity large areas background ﬂoor drinking troughs metal bars pathways enclosures similar many dark-skinned cows. similarly light-skinned cows easily confused patches light passing gaps wall ceiling. another problem cows color essentially similar hence enormously challenging tracking algorithm tell brown cows especially blocks camera view. main idea approach reason extract contours tracked object instead background. explained section algorithm consists steps ﬁrst instance segmentation feature extraction training validation presented fig. second feature extraction testing learning algorithm presented fig. instance segmentation phase presented fig. important phase steps approach. start localizing potentially interesting areas frame purpose pre-trained deep learning algorithm conditional random fields recurrent neural network recently introduced paper fig. performance medianflow boosting tracking algorithms test dataset arrow points algorithms must track whole duration snippet. algorithm initialized frame features sampled user-deﬁned bounding includes greater part tracked cow. break starts moving away starting position. ﬁrst ruminates close starting position moves right vertical stops drink continues movement right order ﬁnally stop start eating/drinking trough detailed table total length snippet seconds. best viewed color. zheng combination fully convolutional network conditional random ﬁeld layout recurrent neural network rnn. novel object segmentation algorithm returns mask color pixels corresponding identiﬁed class fig. yellow blobs mask correspond identiﬁed pixels crfasrnn shown high performance video data compared algorithms including fcn. convnn’s architecture used approach fcn- based vgg- identiﬁcation elements image computationally intensive part model taking ∼s/frame ∼s/frame localized blobs potentially interesting objects bounding around larger threshold empirically found pixels optimal extract patch original image. want identify instances cows since crfasrnn instances observations blobs consistent class ‘cow’. explained above background subtraction intractable cowsheds noisy low-contrast background. instead attempt extract contours objects. comes observation that even objects similar pixel value derivative boundary potential delineating them. contour detection found holisticallynested edge detector recently introduced performs strongly ﬁltering noise image. therefore next stage localized area image obtain edges. output image darker pixels corresponding important edges. since need important them want split contour image disjoint subsets objects background. using threshold detection algorithm isodata introduced ridler calvard combination methods produces isolated objects label training area exceed pixels also objects’ convex hulls bounding boxes.this step much less computationally expensive taking approach takes crfasrnn’s output step offering solution instance segmentation blobs crfasrnn’s output merely tell cows locality. extract hypothesis number cows approximation shapes locations. fig. present ﬂowchart instance segmentation step. process detailed previous subsection applied every frame video sequence. combine process simple -nearest neighbor tracking method automate feature extraction instances identiﬁed ﬁrst phase processing. ﬁrst frame sequence select want track assign label objects labelled frames instances simple distance matrix number rows equal number instances current frame number columns number labelled instances previous frame hence entry matrix distance every instance frame every labelled instance previous frame. matrix assign every instance frame label nearest instance previous frame. heuristic approach simple serious tracking problem therefore training databases small well-behaved i.e. want track well visible throughout video training set. labelled instances frame extract features them added training dataset correct order total features three types pixel intensity instance’s centroid mean sample patches object; averaging pixel intensities vector features overall mean maximum three quartiles. size size bounding around object. motivated fact previous stage ignored small objects instance segmentation algorithm tends large portions cows. location store coordinates centroid bounding distance feature. training test phases distance every instance’s centroid centroid previous observation tracked cow. coordinate difference actual feature used. finally collected data training video sequence manually clean training dataset removing mislabelled observations pass correctly labelled dataset training algorithm. features extracted trained classiﬁer automatically identify individual animal video frame. selected random forest classiﬁer attributed breiman learn features. originally training proportion positive observations provide classiﬁer data sampled negative observations thus increasing positive data points third training database. data essentially time series train algorithm ﬁrst observations validate remaining second contribution paper instance segmentation algorithm optimizing classiﬁer based training validation testing output. found trees cross-entropy error function using features training bootstrap samples out-of-bag samples generalization best data. training single forest takes small amount time seconds. results testing classiﬁer precision recall summarized tables iii. test sets taken video different training number ways many issues algorithm must handle full partial occlusion lighting contrast cluttered background other. comparison trackers mentioned above medianflow boosting test set. three datasets approach achieves highest precision highest recall rate. strength particularly well visible tracked moves around. either immediately loose confuse background soon leaves area tracking started. consider speciﬁc strength algorithm. sets approach underperformed problem related generalization capacity classiﬁer move much features easily confused objects. article presented tracking algorithm developed tracking malleable objects challenging environment ultimate goal project identify lameness cows early stage; successful tracking ﬁrst stage project. article three main contributions fig. flowchart ﬁrst step algorithm. video data processed framewise phases within bounding repeated full duration video adding labelled data points training dataset. training dataset fully built manually cleansed mislabelled observations passed random forest algorithm training cross-validation. ﬁnal output stage classiﬁer optimal parameters tracking particular cow. fig. flowchart second step algorithm. video data processed framewise phases within bounding repeated full duration video. classiﬁer optimized ﬁrst step processes objects segmented instance segmentation stage frame labels based features extracted instances. labels instances added video output. data stored output analysis. table performance algorithms available opencv library test datasets compared ours. values column percentage frames algorithm identiﬁed tracked i.e. recall. bold best algorithm test dataset. improvement instance segmentation step. currently combination deep learning thresholding labeling algorithm. although reasonably well enough space improvement. improvement generalization. although random forest good tracking always conﬁdently generalize angle faces camera. therefore intend retrain algorithm like crfasrnn track objects using segmentation information previous step. construction behavior dataset. addition tracking cows’ movement need track behavior correlates physiological condition purpose training large deep learning algorithm like lstm similar recurrent neural network. fig. full step instance segmentation. input frame pixels. ﬁrst step localization crfasrnn. second step crop promising image insets exceed pre-set threshold value. inset extract contours hed. obtain isolated objects contours isodata thresholding function. object size exceeding another pre-set threshold value assigned object status obtain convex shape bounding around contours bounding boxes input image sample data image added dataset. output image overlaid bounding boxes object contours. table results test sets obtained using random forest best parameters trained datasets table true positives fpfalse positives tntrue negatives false negatives pprecision rrecall. last column main challenges algorithm faced video listed. kamphuis frank burke verkerk jago applying additive logistic regression data derived sensors monitoring behavioral physiological characteristics dairy cows detect lameness journal dairy science vol. alban agger lawson lameness tied danish dairy cattle possible inﬂuence housing systems management milk yield prior incidents lameness preventive veterinary medicine vol. martiskainen j¨arvinen j.-p. sk¨on tiirikainen kolehmainen mononen behaviour pattern recognition using threedimensional accelerometer support vector machines applied animal behaviour science vol. poursaberi bahr pluk nuffel berckmans real-time automatic lameness detection based back posture extraction dairy cattle shape analysis image processing techniques computers electronics agriculture vol. alsaaod r¨omer kleinmanns hendriksen rosemeierh¨ofer pl¨umer b¨uscher electronic detection lameness dairy cows measuring pedometric activity lying behavior applied animal behaviour science vol. cangar leroy guarino vranken fallon lenehan berckmans automatic real-time monitoring locomotion posture behaviour pregnant cows prior calving using online image analysis computers electronics agriculture vol. babenko m.-h. yang belongie visual tracking online multiple instance learning computer vision pattern recognition cvpr ieee conference ieee tracking online multiple instance learning ieee transactions pattern analysis machine intelligence vol. zheng jayasumana romera-paredes vineet huang torr conditional random ﬁelds recurrent neural networks proceedings ieee international conference computer vision", "year": 2017}