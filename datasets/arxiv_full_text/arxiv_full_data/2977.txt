{"title": "Hand Pose Estimation through Semi-Supervised and Weakly-Supervised  Learning", "tag": ["cs.CV", "cs.AI", "cs.LG"], "abstract": "We propose a method for hand pose estimation based on a deep regressor trained on two different kinds of input. Raw depth data is fused with an intermediate representation in the form of a segmentation of the hand into parts. This intermediate representation contains important topological information and provides useful cues for reasoning about joint locations. The mapping from raw depth to segmentation maps is learned in a semi/weakly-supervised way from two different datasets: (i) a synthetic dataset created through a rendering pipeline including densely labeled ground truth (pixelwise segmentations); and (ii) a dataset with real images for which ground truth joint positions are available, but not dense segmentations. Loss for training on real images is generated from a patch-wise restoration process, which aligns tentative segmentation maps with a large dictionary of synthetic poses. The underlying premise is that the domain shift between synthetic and real data is smaller in the intermediate representation, where labels carry geometric and topological meaning, than in the raw input domain. Experiments on the NYU dataset show that the proposed training method decreases error on joints over direct regression of joints from depth data by 15.7%.", "text": "propose method hand pose estimation based deep regressor trained different kinds input. depth data fused intermediate representation form segmentation hand parts. intermediate representation contains important topological information provides useful cues reasoning joint locations. mapping depth segmentation maps learned semiweakly-supervised different datasets synthetic dataset created rendering pipeline including densely labeled ground truth dataset real images ground truth joint positions available dense segmentations. loss training real images generated patch-wise restoration process aligns tentative segmentation maps large dictionary synthetic poses. underlying premise domain shift synthetic real data smaller intermediate representation labels carry geometric topological meaning input domain. experiments dataset show proposed training method decreases error joints direct regression joints depth data computer therefore close camera problem inherently difﬁcult. case typically hand occupies small portion image ﬁngers ﬁnger parts vaguely discernible. existing discriminative solutions articulated pose depth maps concentrated different strategies early work ﬁrst contructed intermediate representation body hand parts joints estimated second step subsequent work proceeded direct regression depth either heat maps joint coordinates clear interest second strategy i.e. direct regression joint positions large body recent work pointing direction. reasons intermediate representations really efﬁcient training restricted synthetic data intermediate labels easily obtained. real data precise dense annotations like part segmentations difﬁcult come exception ﬁnger painting datasets hand amount information passed training algorithm signiﬁcantly higher case intermediate segmentation several bits pixel input image real values joint image. paper argue advantage important propose model regression well semi-supervised weakly-supervised training algorithm allows extract information automatically real data. figure rich intermediate representation fused input hand joint regression. intermediate representation learned semi/weaklysupervised setting real synthetic data input image dataset hand pose estimation tracking depth images i.e. estimation joint positions human hand ﬁrst step various applications hand gesture recognition humancomputer interfaces human-object interaction virtual reality settings many more. real-time estimation full-body pose available commercial products least cooperative environments estimation hand pose complex. situations user directly placed front target conﬁguration pose estimation performed frame-by-frame without dynamic information. model learned training sets real images acquired consumer depth sensor. ground truth joint positions assumed available instance obtained multi-camera motion capture systems. second synthetic training images produced models rendering pipeline accompanied dense ground truth form segmentation hand parts. ground truth easy come usually automatically created rendering pipeline. main arguments develop following intermediate representation deﬁned segmentation parts contains rich structural topological information since label space structured. labels adjacency topological geometric relationships leveraged translated loss weaklysupervised training; regression joint positions easier robust depth input combined rich semantic representation like segmentation parts provided semantic segmentation high ﬁdelity show additional information passed training algorithm able improve pose regression performance. component obtaining improvement obtaining reliable segmentations real data. purely supervised training synthetic data proven work well full-body pose estimation hand pose estimation known require real data captured depth sensors training input resolution data quality. manually annotating dense segmentations large datasets option estimating segmentation maps ground truth joint positions unreliable case quality images. propose semi/weakly supervised setting order tackle problem intermediate representation learned densely labeled synthetic depth images well real depth images associated ground truth joint positions. particular proposed training method exploits rich geometrical topological information intermediate representation. training process predicted segmented patches real images aligned large dictionary labelled patches extracted rendered synthetic data. novelty lies fact match input patches patches taken intermediate representation include to-be-inferred label local context. call proposed training method weakly supervised; since part ground truth data contains joint locations dense labels part segmentations used inference. method also semi-supervised part dataset fully labeled another part not. paper organized follows. section discusses related work. section introduces model semi/weakly supervised learning setting. section gives details deep architectures employed experiments. section excompared study hand pose much larger body work focused full-body pose estimation. draw inﬂuence literature therefore include brief review. learning majority recent work pose estimation based machine learning. body part segmentation intermediate representation joint estimation depth images successfully used shotton random forests trained perform pixel-wise classiﬁcation. adapted hand pose estimation keskin additional pose clustering step introduced. later proposed cascaded regression framework positions hand joints predicted hierarchical manner adapted kinematic structure hand. work tang random forest performs different tasks different levels viewpoint clustering higher levels part segmentation intermediate levels joint regression lower levels. explicit transfer function learned synthetic real data. follow-up work tang latent regression forest learned automatically extracts hierarchical topological model human hand data. instead pixel-wise voting forest descended single time starting center mass hand. traditional split nodes accompanied division nodes trigger parallel descents sub-trees multiple entities went direction proposed method topological model hand learned jointly hand pose estimation. later work uses deep networks body part segmentation images depth images recent work estimates joint positions regression deep convolutional neural nets typically models trained produce heatmaps encoding joint positions spatial gaussians though direct regression encoding joints also attempted. recently training combination classiﬁcation regression losses producing heatmaps proven particularly effective post-processing enforce structural constraints based graphical models inverse kinematics work oberweger deep learning framework regularized bottleneck layer forcing network model underlying structure joint positions. proposed multi-view deep learning framework based feature extraction several projections point cloud representing depth image hand. stacked hourglass networks introduce series modules perform convolutions followed deconvolutions skip connections. different modules allow method model context spirit auto-context models semantic segmentation human performance. context data-driven methods number recent works dedicated automating data labeling weakly-supervised learning sparsely annotated videos graphical models recent work chen yuille graphical model implemented deep convolutional nets jointly estimate unary terms given evidence joint types positions binary terms modelling relationships joints. work later extended modelling occluding parts introducing additional connectivity prior. tompson jointly learn deep full-body part detector markov random field models spatial priors. joint learning achieved designing priors convolutions implementing inference forward propagation approximating single step message passing algorithm. alternatively proposed method learning structured representations capturing dependencies body joints training introduced geometrical transform kernels. methods different group methods based top-down processes models image data. method oikonomidis based pixelwise comparison rendered observed depth maps. inverse rendering generative model including shading texture used model ﬁtting several works employ hand pose reconstruction ﬁngertip localization under spatial temporal constraints. recent work tang based hierarchical sampling optimization sequence predictors aligned kinematic structure hand. hybrid method qian real-time hand tracking uses simple hand model consisting number spheres combines gradient-based discriminative step stochastic optimization. recent work sharp directly exploits hand mesh consisting triangles vertices formulate multi-level discriminative strategy followed generative model-based reﬁnement. person-speciﬁc hybrid generative/discriminative model built system using cameras plus camera. spirit hybrid methods oberweger proposed neural model including feedback loop based iterative image generation obtained predictions followed selfcorrection. methods accurate geometric models ﬂexible enough closely real geometric data. recent work geometric models adapted instance instance ﬁtting steps integrated single joint optimization procedure. downside models requirement initialization. hybrid models combine generative discriminative steps instance performing discriminative initialization followed ﬁtting generative model. work seen improvement discriminative stage could augmented generative counterpart choice. correspondence pose estimation attempted solving correspondence problems work. method taylor correspondence depth pixels vertices articulated model learned. approximate directed chamfer distances used align observed edge images synthetic dataset. recently model ﬁtting training network dense correspondances input template proven extremely efﬁcient context facial landmark localization along lines creation large-scale synthetic datasets human pose estimation facilitate adaptation dense prediction methods human pose. work essentially motivated idea exploiting dense signals source universal rich supervision. work work applications pose estimation share similarities method. patchwise alignment segmentations transductive learning setting performed meshes matching real unlabelled shape segments shapes large labelled database. large number candidate segments created optimal segmentation calculated solving integer problem. method viewed kind multi-task learning topic actively pursued deep vision community techniques rely subnetworks share parameters approach weight sharing instead co-ordinates subnetworks patchwise restoration process joint error function. work bears certain resemblance recently proposed -fields method proposed different applications also combines deep networks patchwise nearest neighbor search. however whereas nn-search performed feature space learned deep networks method performs nn-search patch space corresponding semantic segmentation learned deep networks. part work also bears similarity label information integrated structured prediction forests although patch alignment dictionary carried there. prediction models learned automatically representation learning full end-to-end training often desirable described holy grail machine learning. approach indeed beneﬁts properties freedom training procedure explore best representation lower burden scientist practitioner required handcraft representations knowledge application and/or input data domain. practice however depending difﬁculty problem depth model amount available training data might suboptimal give model complete freedom intermediate representations explores. prob given view pose part label carries strong geometrical information label alone given pixel strong prior position pixel provides important cues regression desired joint positions. property also exploited system motivate patchwise searches label space. setting intermediate representation available during training time synthetic data only. real data test time automatically inferred. precisely training dataset organized partitions real depth images associated ground truth joint positions second synthetic depth images associated ground truth label images denote pixel image synthetic images rendered different hand models using rendering pipeline also sample different pose parameters hand shape parameters. variations viewpoints hand poses obtained taking account physical physiological constraints. contrast weakly-supervised semi-supervised methods instance suppose ground truth data intermediate representation available real training images. manually labelling segmentations extremely difﬁcult time consuming. labelling sufﬁciently large number images hardly practical. however rely ground truth joint positions obtained several ways external motion capture using markers employed. training data acquired multiple views three different depth sensors articulated model ﬁtted ofﬂine. functional decomposition method well dataﬂow training testing outlined figure goal regress joint positions input depth maps proposed method leverages different mappings learned training sets. segmentation network learns mapping depth data intermediate segmentation maps parametrized parameter vector regression network learns mapping depth data combined segmentation maps joint positions parametrized vector first segmentation network pre-trained synthetic training data supervised using dense ground truth segmentations resulting prediction model parameters learned minimizing classical negative log-likelihood training step shown blue data figure prediction model ﬁne-tuned subsequent step weakly supervised training real data resulting reﬁned prediction model fss). step shown green data figure described detail subsection figure complementarity segmentation maps points space occupied index ﬁnger ring ﬁnger difﬁcult segment seen voronoi borders depth values often similar close different ﬁngers realistic sensor resolutions lems either arise overﬁtting suboptimal solutions found minimization procedure. instead falling back handcrafting feature representations solutions intermediate supervision decomposition approach intermediate representation temporarily imposed pre-training step full end-to-end training. work propose intermediate representation form segmentation map. contrast traditional decomposition approaches intermediate representation available additional information ﬁnal regressor also receives input. intermediate representation segmentation parts illustrated figure parts correspond ﬁnger parts part palm background considered subtracted preprocessing step part segmentation process. dense segmentation complementary groundtruth points former difﬁcult obtain latter case strong auto occlusions. illustrated figure space occupied index ﬁnger ring ﬁnger difﬁcult segment. resorting spatial distances alone traditionally done easier settings fails complex curved shapes ﬁngers amount keypoints obtained automatic methods context voronoi diagram gives regions different complex ﬁnger regions. depth values might theoretically help practice fails since values often similar close different ﬁngers realistic sensor resolutions shown figure taken dataset. part label space characterized strong topologcontrast semantic segmentaical properties. tion problems strong neighborhood relationships deﬁned label space. leveraged restore noisy part label images generate loss function training. property serves component creating reliable estimators performing transfer synthetic real images. figure functional overview method. blue data corresponds supervised training segmentation network green corresponds weakly supervised training arrows show supervised training regressor full size input depth image full size segmentation joint location vector parameters trained classically minimizing norm output joint positions ground truth joint positions. training step shown data figure weakly supervised ﬁne-tuning segmentation network supervised pre-training segmentation network results prediction model address domain shift between synthetic data real data shot depth sensors model ﬁne-tuned training real data. since ground truth segmentation maps exist data generate loss function training based sources priori information local distribution part labels human hands patch-wise restoration process aligns noisy predictions large dictionary synthetic poses. weakly supervised training procedure shown green data figure real depth image passed pre-trained segmentation network resulting segmentation map. noisy predicted restored restoration process described below. quality restored segmentation estimated comparing ground truth joint positions image. particular joint corresponding part-label identiﬁed barycenter corresponding pixels segmentation calculated. rough quality measure segmentation given distances barycenters ground truth joint positions. quality measure used determine whether restoration process lead improvement segmentation quality i.e. whether barycenters restored closer ground truth joint positions barycenters original prediction. images case segmentation network updated pixel minimizing using labels restored artiﬁcial ground truth. figure organization regression network functional modules shown produced feature maps shown blue. grey areas correspond masked regions feature maps. masked areas shown rectangles ﬁgure general shape. figure different segmentation results input image; output segmentation network supervised training; restoration; output segmentation network joint training; ground truth segmentation; estimated joint positions. image part training set. patchwise restoration proceed patchwise extracting patches size large synthetic segmentation images resulting dictionary patches ={p} experiments used patches size dictionary million patches extracted training also reported range poses occur natural motion extremely large making full global matching pose datasets difﬁcult. motivates patch-based apgiven real input depth image aligned dictionary patchwise process using intermediate representation. pixel patch extracted segmentation produced network nearest neighbor found searching dictionary na¨ıve setting restored label pixel could obtained choosing label center retrieved patch this however leads noisy restorations suggest need spatial context. instead chosing center label patch only propose labels patch. input pixel nearest neighbor results local window size integrated. particular given pixel assigned patches neighbors examined position pixel patch calculated. label estimated voting resulting mapping integration bears similarity information nearest neighbor searches integrated local window albeit averaging continuous mapping. also similar patchwise integration performed structured prediction forests real-time performance required patch alignment process equation regularized graphical model including pairwise terms favoring consistent assignments instance potts model term favoring patch assignments consistent overlaps. interestingly produces small gains performance especially given higher computational complexity. moreover gains vanish local integration added. information given section structure segmentation network motivated idea performing efﬁcient pixelwise image segmentation preserving original resolution input inspired overfeat networks proposed object detection localization network consists convolutional layers followed fully connected layer pooling typically follows convolutional layers results downsampling feature maps destroying precise spatial information. instead perform pooling overlapping regions produced shifting feature maps obtained previous step single pixel along another axis. opposed patchwise training pixel classiﬁcation based local neighborhood architecture computationally efﬁcient beneﬁts dense computations earlier layers. compared recently introduced fullyconvolutional deconvolutional networks tackle similar problem context semantic segmentation proposed network requires less upsampling interpolation. regression network taking depth image single input producing coordinates given joint also incorporates information provided segmentation network training. structurally resembles inception module output ﬁrst convolutional layer pooling passed several parallel feature extractors capturing information different levels localization. organization module shown figure corresponding parameters before provided table output ﬁrst convolutional layer aligned segmentation maps produced segmentation network. feature given joint extract localized region interest ﬁltered mask hand part belongs masks calculated performing morphological opening regions corresponding class label segmentation map. local region selected rest feature area result along original feature maps next layer i.e. inception module. rest training process organized network’s capacity split global structure whole image local neighborhood subset inception ﬁlters learned speciﬁcally local area surrounding point interest. experiments showed individual networks joint perform better networks sharing parameters joints. conjecture sharing parameters would optimal choice smaller amounts training data. number examples increases separating networks allows layers pick nuances required regressing individual joint. networks relu activation functions layer employ batch normalization regression network test time uses batch normalization parameters estimated training data however segmentation network batch normalization performed across pixels image training test samples. evaluated proposed method hand pose dataset published publicly available. comprises images captured depth sensor resolution accompanied ground truth annotations positions hand joints. commercial software poser including ground truth; labelled synthetic images plus ground truth reserved testing. experiments extract hand images normalized metric size resize pixels. data preprocessed local contrast normalization kernel size able predict absolute values z-coordinates subtracted depth added back network output. supervised training segmentation network regression network full training images used. third used extract patches patch alignment mapping giving dictionary patches size extracted images. local integration given equation done using windows size segmentation network initially trained epochs batch size initial learning rate learning rate decay synthetic data ﬁnetuned additional epochs mixture synthetic restored real segmentations ratio evaluate performance various segmentation methods manually labelled images dataset report accuracy pixel class table images solely used evaluation never entered purely supervised training synthetic dataset gives poor segmentation performance accuracy pixel. emphasize training performed synthetic images test real images thus unseen distribution. domain shift clearly problem accuracy synthetic dataset high using patchwise restoration predicted real patches large dictionary synthetic patches gives performance increase percentage points pixel percentage points class. corroborates intuition intermediate representation carries important structural information. integration patch-labels local window equation essential– pure nn-search without integration performs poorly. figure provides examples input depth maps different segmentations synthetic pre-training only off-line restoration prediction weakly-supervised ﬁnetuning. majority cases restoration output close ground truth maps. figure shows distribution error different hand parts. improvement consistent high important ﬁngertips. also compared local integration equation potentially powerful regularization methods implementing crf-like discrete energy function. goal optimization problem regularize patchwise restoration process described section instead chosing nearest neighfigure visualization automatic rejections made quality check described section examples noisy segmentations real images shown corresponding maps restoration shown bottom. restoration failure cases happen artifacts depth maps increased distance camera hand particularly noisy initial predictions result restoration process result lower recall ﬁnger segments less often false detections cases automatically detected. patch space pixel described equation solution searched satisﬁes certain coherence conditions spatial neighborhoods. create global energy function deﬁned d-lattice corresponding input image restore indices neighbors pixel assigned discrete variable taking values xi=l signiﬁes pixel l−th nearest neighbor patch space chosen. pixel nearest neighbor search performed using kd-trees ranked list neighbors kept deﬁning label space pixel. variable controls degree approximation model allows pixel assigned every possible patch synthetic dictionary. inference performed message passing using open-gm library hyper-parameter optimized hold-out set. interestingly local patch integration equation outperformed combinatorial models signiﬁcantly time much faster. conjecture reason patchwise integration corresponds high-order potential whereas binary terms model poorer. calculating global solution poorer model seems less efﬁcient locally solving high order problem. indication strong topological information carried label space intermediate representation. table shows contribution semi/weakly-supervised training sparse annotation integrated training process segmentation network procedure achieves improvement percentage points pixel percentage points class essential step learning efﬁcient intermediate representation. ﬁrst sight might seem pretrained predictor better off-line restoration process whose results trained. however recall predictor also uses second source information namely joint locations available real images weakly-supervised ﬁne-tuning step. rejecting segmentations training responsible difference. patch-overlap distance alternative pairwise term deﬁned hamming distance synthethic patches deﬁned particular distance restricted overlapping area. table joint position estimation error hand pose dataset baseline corresponds case single regression network segmentation results used. cascaded baseline similar architecture features additional reﬁnement step method based full pipeline restoration employed training i.e. segmentation network trained synthetic data supervised ﬁne-tuned real samples. finally method corresponds proposed solution. bottom part table compare proposed method baselines based ablation study proposed network. particular compare direct regression without intermediate representation version intermediate representation learned supervised only. ground truth location. comparison single network regressor mean error improved second best model involving segmentation inspired work recent initial rough estimation hand joints positions improved zooming ﬁrst part table provides comparison literature based publicly available data released authors corresponding methods. error expressed mean distance predicted position joint purely supervised baseline performs well compared state-of-the-art. prior augmenting method unsupervised pipeline spent additional time careful optimization baselines tuning architecture training regime. appeared crucial figure visual comparison results produced hand pose dataset different pose estimation methods deepprior oberweger method based network trained semi/weakly-supervised fashion ground truth. figure visualizes estimated pose skeletons corresponding input depth maps randomly sampled test set. figure illustrates performance proposed method challenging examples comparison number state-ofthe-art methods. figure plots quantitative performance expressed number frames joints localized within given distance threshold ﬁgures compare proposed method several recent state-of-theart approaches. hand pose estimation method proposed follow augment estimated coordinates depth values input depth maps. cases predicted locations fall background corresponding z-coordinate median depth value hand. note here quality network outputs improved optimization inverse kinematics done example however focus work explore potential pure learning approaches priors enforcing structure output. bottom part table contains deep learning methods. recent work optimization hand pose estimation formulated inverse kinematics problem authors report performance similar terms uv-error computational complexity models trained tested using gpus except patchwise restoration process pure code used test time. estimating pose single hand takes segmentation resolution pixels segmentation outputs training segmentation network requires hours minimize validation error regression network trained single gpu. results obtained using cluster conﬁgured hex-core processors nvidia titan black cards memory card. presented method hand pose estimation based intermediate representation fused depth input data. showed additional structured information representation provides important cues joint regression leads lower error. weakly supervised learning mapping depth segmentation maps mixture densely labelled synthetic data sparsely labelled real data component proposed method. weak supervision dealt patch-wise alignment real data synthetic data performed space intermediate representation exploiting strong geometric topological properties. work partly ﬁnanced french grant interabot project type investissement’s d’avenir briques g´en´eriques logiciel embarqu´e project solstice project grant program blanc. taylor acknowledges support nserc nvidia.", "year": 2015}