{"title": "Anatomical labeling of brain CT scan anomalies using multi-context  nearest neighbor relation networks", "tag": ["cs.CV", "stat.ML"], "abstract": "This work is an endeavor to develop a deep learning methodology for automated anatomical labeling of a given region of interest (ROI) in brain computed tomography (CT) scans. We combine both local and global context to obtain a representation of the ROI. We then use Relation Networks (RNs) to predict the corresponding anatomy of the ROI based on its relationship score for each class. Further, we propose a novel strategy employing nearest neighbors approach for training RNs. We train RNs to learn the relationship of the target ROI with the joint representation of its nearest neighbors in each class instead of all data-points in each class. The proposed strategy leads to better training of RNs along with increased performance as compared to training baseline RN network.", "text": "work endeavor develop deep learning methodology automated anatomical labeling given region interest brain computed tomography scans. combine local global context obtain representation roi. relation networks predict corresponding anatomy based relationship score class. further propose novel strategy employing nearest neighbors approach training rns. train learn relationship target joint representation nearest neighbors class instead data-points class. proposed strategy leads better training along increased performance compared training baseline network. computed tomography primarily used detection diagnosis many trauma related abnormalities brain e.g. hemorrhage infarct edema skull fracture. anatomical localization underlying pathologies often required gain insights plan treatment procedures. poor anatomical contrast images non-availability anatomical atlas limited development automated methods anatomical labeling scan images. traditional image processing based approaches anatomical labeling medical images time computation intensive also often rely availability multimodality scans. limitations render infeasible clinical use. essential characteristics automated anatomical labeling solution scan images deployable real-world underlined follows rely multi-modality scans provide fast inference even computational resources typical clinics ﬁnally development cost outweigh delivered beneﬁts. considering mentioned characteristics sought development automated anatomical labeling method pathological regions brain first prepared dataset supervised learning anatomical labels underlying pathologies seen brain using least possible resources. utilized dataset primarily labeled supervised learning multiple pathologies brain scan anatomical labels sparsely available auxiliary information. therefore obtained dataset additional annotation cost otherwise would hundreds hours work neuroanatomy experts. approach works valid assumption practical applications automated anatomical labeling limited localization pathologies brain. further implemented deep learning approach learns effectively despite small dataset heavy class imbalance. propose cascaded architecture learns robust embedding pathological region interest ﬁrst stage predicts corresponding anatomical label second stage. implementation utilizes three approaches increase performance model dealing issues small dataset class imbalance. investigate relation networks exploit intra-class relations data points class discriminate efﬁciently data points belonging different classes. propose novel training strategy employing nearest neighbors approach increase performance rns. train network learns coherent representation data points belonging class discriminative representation data points belonging different classes. dataset comprising class imbalance. typically implemented cascaded networks fully connected layers wherein learns compute joint representation reference objects exploiting relations learns predict whether input object representation belongs reference objects. however broad deﬁnition makes inherently suitable kind multi-class classiﬁcation problems ﬁrst network layers computes embedding reference class second network predicts whether input object belongs class not. multi-class classiﬁcation problem heavy class imbalance training data-point leads biased towards relations majority class. further training overwhelmed non-related examples majority classes. alleviate this employ novel training strategy utilizing nearest neighbors approach. consider embedding corresponding target data point embeddings corresponding reference class inputs rns. instead sending reference class embeddings instead extract ﬁxed nearest neighbors target embedding reference class embeddings send input leads return joint embedding reference class data points related target embedding. consequently inputs would target embedding reference embedding high similarity metric. case target reference embedding belong class would trained high threshold similarity two; whereas case target reference embedding belonging different classes would forced learn discriminative features separating classes. proposed strategy also interpreted hard example mining different classes easy example mining class. underlying assumption representations class would different other. however might still examples lying cluster boundaries; examples would nearest neighbors examples neighboring class. refer samples hard negatives difﬁcult network classify belonging different class compared farther away boundaries. training different classes focus examples. similarly within class samples many examples lying cluster boundary attributed either label noise ambiguous samples. training positive class samples contribute learning incoherent class representation. training nearest neighbors approach ensures representation single class coherent. essence proposed strategy helps network learn discriminative boundaries classes avoiding overﬁtting individual class features. automated anatomical labeling methods based image processing deep learning explored imaging. methods based segmentation brain image different anatomical regions. however exist approach addressing anatomical labeling scan images such. relation networks proposed used relational reasoning deep learning model required extract relations different objects prediction. however recently used shot learning multi-class classiﬁcation task. approach using therefore similar proposed idea combining local global context quite intuitive logical. exists substantial amount prior work uses concept various tasks relevant work dense segmentation pixel localize brain tumours using local global context around pixel. further nearest neighbor famously used machine learning technique used plethora unsupervised well supervised tasks. however best knowledge ﬁrst work utilizing nearest neighbor approach method example mining training rns. dataset comprised slices corresponding scans acquired local hospitals. dataset obtained approval ethics committees hospital level. data pathological regions annotated along underlying anatomy. total anatomical labels present entire dataset. number slices present anatomical labels present dataset mentioned table dataset separated train test level ratio corresponded training testing. along falx/tentorium basal cisterns brainstem cerebellum ethmoidal frontal region gangliocapsular region maxillary occipital region parietal region sphenoid sulcal spaces temporal region thalamus ventricular system total slices preprocessing included resampling achieve isotropic resolution ﬁxed ﬁeld-of-view in-plane thresholding hounsﬁeld units brain window converting pixel intensities range intensity values regions corresponding pathologies replaced uniform gray scale values remove pathology texture related information images. architecture consists baseline two-path network cascaded relation networks baseline network referred basenet extracts features corresponding local global context along processing paths. feature vector contexts obtained output pool layer pre-trained obtained local global features later concatenated passed network layers trained scratch multi-class classiﬁcation. later part cascaded network consists composed networks layers representing implementations respectively. basenet trained separately output basenet’s second last layer passed input embedding rns. dropout used layers avoid overﬁtting. implementation done pytorch. since class distribution dataset skewed representations learnt training basenet whole dataset would biased towards majority classes. order avoid this sampled minority classes data augmentation undersampled majority classes basenet training. used stochastic gradient descent optimization learning rate momentum weight decay training. basenet respectively trained epochs took minutes hours respectively. noted although contains less number parameters training time still high. increase effective data points training take relationship datapoint classes. testing nearest neighbors target embedding fetched training dataset. relationship embedding class determined relationship score lying range class embedding belonged determined taking argmax relationship scores. calculated precision recall f-score class evaluation metrics using sklearn package. mean metrics calculated weighing individual class metrics number true instances class. method accounts underlying class imbalance reporting average metrics. achieve mean precision recall f-score shown table haven’t shown evaluation metrics classes contained small number samples test however mean metrics shown average classes. none classes removed sample size. results clearly demonstrate gain performance rns. further nearest neighbor approach shows marginal increase f-score precision. noted although performance gain achieved approach seems show marginal gain practice amounts better performance minority classes. reason behind increased performance classes reﬂected mean score total representation said classes complete test small. therefore said training approach leads balanced performance across classes thus reducing effect class imbalance. gain insights relative performance basenet basenet models compared mean f-scores models equal training time conditions. epochs mean fscore basenet whereas basenet shows basenet trains much faster basenet model also learning minority classes. proposed deep learning method automated anatomical labeling brain scans. employed cascaded architecture computes representation combining local global context ﬁrst stage uses relation networks predict underlying anatomy representation second stage. further proposed novel training procedure utilizing nearest neighbor approach train argue employs kind hard well easy example mining help robust training network. also reported test results approaches used compared relative performance. however would want mention presented approach still perform well minority classes number samples small. believe increase number samples would help achieve better performance minority classes future. summary provided resource efﬁcient solution anatomical labeling given scan images. however methods reported paper limited said application area applied various ﬁelds facing similar issues. mohammad havaei axel davy david warde-farley antoine biard aaron courville yoshua bengio chris pierre-marc jodoin hugo larochelle brain tumor segmentation deep neural networks medical image analysis vol. supplement pedregosa varoquaux gramfort michel thirion grisel blondel prettenhofer weiss dubourg vanderplas passos cournapeau brucher perrot duchesnay scikit-learn machine learning python journal machine learning research vol. david raposo adam santoro david barrett razvan pascanu timothy lillicrap peter battaglia discovering objects relations entangled scene representations corr vol. abs/. adam santoro david raposo david barrett mateusz malinowski razvan pascanu peter battaglia timothy lillicrap simple neural network module relational reasoning corr vol. abs/. alexander brebisson giovanni montana deep neural networks anatomical brain segmentation ieee conference computer vision pattern recognition workshops june abhijit guha sailesh conjeti debdoot sheet christian amin katouzian nassir navab error corrective boosting learnwachinger fully convolutional networks limited data accepted miccai hongzhi wang jung sandhitsu john pluta caryne craige paul yushkevich multiatlas segmentation joint label fusion ieee transactions pattern analysis machine intelligence vol. kevin murphy antonio torralba daniel eaton william freeman object detection localization using local global features toward categorylevel object recognition jean ponce martial hebert cordelia schmid andrew zisserman eds. springer berlin heidelberg berlin heidelberg alexander wright derek magee philip quirke darren treanor incorporating local global context better automated analysis colorectal cancer digital pathology slides procedia computer science vol. july zhao wanli ouyang hongsheng xiaogang wang saliency detection multi-context deep learning proceedings ieee computer society conference computer vision pattern recognition vol. --june", "year": 2017}