{"title": "Deep metric learning for multi-labelled radiographs", "tag": ["stat.ML", "cs.CV"], "abstract": "Many radiological studies can reveal the presence of several co-existing abnormalities, each one represented by a distinct visual pattern. In this article we address the problem of learning a distance metric for plain radiographs that captures a notion of \"radiological similarity\": two chest radiographs are considered to be similar if they share similar abnormalities. Deep convolutional neural networks (DCNs) are used to learn a low-dimensional embedding for the radiographs that is equipped with the desired metric. Two loss functions are proposed to deal with multi-labelled images and potentially noisy labels. We report on a large-scale study involving over 745,000 chest radiographs whose labels were automatically extracted from free-text radiological reports through a natural language processing system. Using 4,500 validated exams, we demonstrate that the methodology performs satisfactorily on clustering and image retrieval tasks. Remarkably, the learned metric separates normal exams from those having radiological abnormalities.", "text": "many radiological studies reveal presence several co-existing abnormalities represented distinct visual pattern. article address problem learning distance metric plain radiographs captures notion radiological similarity chest radiographs considered similar share similar abnormalities. deep convolutional neural networks used learn low-dimensional embedding radiographs equipped desired metric. loss functions proposed deal multi-labelled images potentially noisy labels. report large-scale study involving chest radiographs whose labels automatically extracted free-text radiological reports natural language processing system. using validated exams demonstrate methodology performs satisfactorily clustering image retrieval tasks. remarkably learned metric separates normal exams radiological abnormalities. permission make digital hard copies part work personal classroom granted without provided copies made distributed proﬁt commercial advantage copies bear notice full citation ﬁrst page. copyrights third-party components work must honored. uses contact owner/author. april france copyright held owner/author. ----//. https//doi.org/./. soft tissues. despite commonly performed reading challenging interpretation discrepancies occur. need develop machine learning algorithms assist reporting radiologist. work address problem learning distance metric chest radiographs using large repository historical exams already reported. ideal metric able cluster together radiographs presenting similar radiological abnormalities place away exams normal radiological appearance. learning suitable metric would enable variety applications automated retrieval radiologically similar exams teaching training automated prioritization based visual patterns. problem discuss challenging several reasons. first number potential abnormalities observed chest radiograph quite large. visual patterns detected radiographs important cues used clinicians making diagnosis. often reporting time clinician describe visual pattern using descriptors stating exact medical pathology associated visual pattern metric learning algorithm able deal labels potential overlaps. second labels always accurate comprehensive fact abnormalities always reported image e.g. omissions deemed unimportant radiologist. labels automatically obtained free-text reports work mislabelling errors also occur. third certain abnormalities less frequently observed others even exist training dataset. support study prepared large repository consisting chest radiograph examinations extracted pacs large teaching hospital london. knowledge largest chest radiograph repository ever deployed machine learning study. large sample size manual annotation exams unfeasible. historical free-text reports parsed using natural language processing system identiﬁed classiﬁed mention radiological abnormalities. result process automatically assigned multiple labels. contributions following. first discuss probbedding space siamese network used contrastive loss train network distinguish pairs examples. schroﬀ combined siamese architecture triplet loss applied resulting model face veriﬁcation problem obtaining nearly human performance. approaches proposed recently order better exploit information proposed loss mini-batch; e.g. song lifted structure sohn proposed tuplet loss. possible example pairs within mini-batch. methods query anchor image compared positive elements negative elements several methods also implement hard data mining approach whereby samples within given pair triplet selected represent hardest positive negative example respect given anchor. strategy improves convergence speed ﬁnal discriminative performance. facenet pairs anchor positive samples randomly selected negative samples selected subset training using semi-hard negative algorithm. recently proposed novel oﬀ-line mining strategy that entire training selects optimal positive negative elements anchor. diﬀerent learning framework require training data processed paired format recently proposed computer-aided diagnosis systems medical imaging goes back half century years methodologies powering systems evolved substantially rule-based engines artiﬁcial neural nertworks. recent years developers started adopt deep learning stategies number medical application domains. instance geras developed model able handle multiple views high-resolution screening mammographies commonly used screen breast cancer. applications plain chest radioghraphs standard dcns used predict pulmonary tuberculosis architecture involving dcns recurrent neural networks trained perform automatic image annotation wang used database chest x-rays frontal-view images associated radiological reports attempt detect commonly occurring thoracic diseases. radiograph associated possible labels contained collect labels describing whilst remaining labels identiﬁed learn non-linear embedding maps onto feature space subspace euclidean distance among figure examples pairs images placed close learned embedding space shown fig. incorrectly reported second reading shows presence pleural eﬀusion medical device justiﬁes proximity labelled normal second reading reveals degree cardiomegaly such scan placed close extract original reports found image. fig. contains legend labels. deep metric learning multi-labelled images propose versions loss function speciﬁcally designed deal overlapping potentially noisy labels. core architecture used learn compact image representations capturing visual patterns described labels. second report large-scale evaluation proposed methodology using manually curated subset exams. historical radiological report reviewed independent clinicians extracted labels associated ﬁlms. report comparative results tasks clustering image retrieval provide evidence learned metric used cluster radiographs normal appearance well clusters abnormal exams co-occurring abnormalities. figure illustration metric learning using triplet losses compared ideal metric. shape represents label overlapping shapes indicate co-occurring labels. dotted arcs indicate margin bounds depending text details. groups similar images small conversely distance dissimilar images large. distance robust anatomical variability within normal range well geometric distortions noise. importantly able capture notion radiological similarity i.e. images expected similar share similar radiological depend upon learnable parameter vector assumptions function made besides differentiability respect consequently learned distance also depends deﬁnition positive negative elements straightforward applications involving mutually exclusive labels becomes ambiguous image allowed non-mutually exclusive labels. restrictive assumptions would need made order existing approaches based contrastive loss triplet loss others simplest approach would assume positive respect share exactly labels i.e. ative elements equality satisﬁed. however assuming ﬁlms radiologically similar share exactly abnormalities strong. adopting strategy would also result much larger sample sizes elements frequently co-occuring labels compared elements characterised less frequent labels thus hindering learning process. furthermore since inproportional number abnormalities share. fig. illustrates ideal situation. triplet loss would struggle satisfy requirement take global structure embedding space covers period january march radiographs taken using diﬀerent scanners across departments. large portion exams radiological report well associated plain ﬁlm. reports written different readers including consultant trainee radiologists accredited reporting radiographers. examinations anonymised patient-identiﬁable data referral information. size images ranges sented greyscale precision. table contains sample size breakdown exams used training validation testing. starting full dataset selected exams concerning patients older years report plain ﬁlm. subset manually validated exams golden used assess compare performance metric algorithms. given large number reports available study obtaining manual labels exam unfeasible. instead written reports processed using system speciﬁcally developed model radiological language system trained detect mention radiological abnormalities negations. labels chosen allow common radiological ﬁndings allocated group along ﬁlms sharing similar appearances. labels adapted hansell meant capture discrete radiological ﬁndings rather giving ﬁnal diagnosis requires clinical judgement combine current ﬁndings previous imaging clinical history laboratory results. study used diﬀerent labels i.e. cardiomegaly medical devices pleural eﬀusion pneumothorax. system also identiﬁed normal exams i.e. abnormalities mentioned report. cumulatively normal abnormal labels used represent reported visual patterns database. validation study carried assess accurately system extracted clinical labels plus normal class written reports. independent clinicians presented original radiological reports manually generated labels reports. study generated golden used purely performance evaluation purposes. table report precision sensitivity speciﬁcity score obtained system. results demonstrate labels automatically extracted scale written reports suﬃciently reliable; provides evidence vast majority labels associated images datasets correct thus allowing neural network architectures learn suitable image representations. become small possible regardless number labels actually common. problem addressed introducing quantity represents degree overlap labels associated associated positive elements i.e. study obtained large dataset consisting historical chest radiographs extracted pacs system guy’s thomas’ foundation trust serving large diverse population south london. dataset non-standard model) pixels pre-processing carried out. training purposes synthetic data generated random rotation ﬂipping original images. diﬀerent experiments setups considered learned end-to-end images pre-training used instead commonly done works. proposed losses compared traditional metric learning approaches based contrastive triplet losses sharing architecture. stochastic gradient descent used optimisation process initial learning rate equal momentum equal weight decay equal started randomly initialised weights total number iterations every iterations learning rate decreased factor instead weights pre-trained classiﬁcation task number total iterations learning rate decreased every iterations. experimental setups size mini-batches equal contrastive triplet losses used equal proposed losses. tested diﬀerent values which results shown work training model best value validation kept best model used testing phase. positive negative elements randomly sampled. noisiness labels prevented exploiting sampling techniques since methods take reliability labels granted. pre-training pre-training used multi-label binary cross entropy loss. given possible labels deﬁned equal number binary classiﬁers predicting presence absence label. output binary classiﬁer assessed performance proposed losses diﬀerent tasks clustering evaluated normalized mutual information metric image retrieval evaluated recallk metric; manning complete account metrics. ages available. many studies down-scaling natural images shown good compromise amount information lost computational efﬁciency. however medical imaging setting every detail image matters least principle. thus arbitrarily reducing resolution images generally considered suboptimal reason study implemented slightly modiﬁed version inception details proposed architecture. chosen aspect ratio close median aspect ratio amongst images dataset advantage minimizing number image would cropped since input ﬁxed size. table shows empirical results obtained learning metrics training images testing golden set. learning without pre-training outperforms tasks largely improves upon alternative losses. using pre-trained architecture improvements observed across methods obtains slightly better performance based results demonstrate superior performance proposed losses respect baseline; moreover suspect able converge better optimum easily conﬁguration model yielding best performance standard image size almost improvements seen compared standard version network. fact retrieval performances almost same score point lower. hypothesize that least radiological abnormalities considered here involve large anatomical structures figure shows -dimensional representation radiographs contained golden set. representation obtained means dimensionality reduction using t-distributed stochastic neighbor embedding eﬀectively projects -dimensional embeddings extracted best model onto dimensions visualisation purposes. remarkably projection shows normal exams mostly concentrated wellseparated cluster; moreover clusters exams sharing similar abnormalities also identiﬁed. chest radiographs marked circle seen figure examples radiographs originally labelled normal ended placed away cloud normal exams. second reading exams revealed unreported abnormalities thus conﬁrming position within embedding justiﬁed. separate task tried predict whether given chest radiograph contains radiological abnormality. task compared performance architecture trained multi-label classiﬁer using cross entropy loss feature embeddings extracted trained metric loss. logistic regression used extracted embedding space order obtain classiﬁcation prediction. table present results obtained. performances evaluated terms precision sensitivity speciﬁcity score. used score instead accuracy bacause data normal abnormal exams balanced latter case comparing performances using accuracy misleading. comparison baseline model possible models based learned embedding obtain better performances showing higher proﬁciency discriminating normal abnormal exams. article proposed loss functions metric learning multi-labelled medical images. performance tested large dataset chest radiographs. initial results demonstrate learning metric captures notion radiological similarity indeed possible; importantly learned metric places normal radiographs away exams reported contain multiple abnormalities. striking result given complexity visual patterns discovered degree noise characterising radiological labels large variety scanners readers included study. also important step towards fully-automated reading chest radiographs able recognize normal radiological structures plain interpreting abnormal ﬁndings. montana. modelling radiological language bidirectional long short-term memory networks. international workshop health text mining information analysis lakhani sundaram. deep learning chest radiography automated classiﬁcation pulmonary tuberculosis using convolutional neural networks. radiology pmid pesce p.-p. ypsilantis withey bakewell montana. learning detect chest radiographs containing lung nodules using visual attention networks. arxiv e-prints dec. table classiﬁcation performance abnormal exams obtained network trained directly classiﬁcation task using embeddings extracted network trained triplet loss order train linear regression classiﬁer using embeddings extracted network trained proposed loss order train linear regression classiﬁer metric learning large margin nearest neighbor classiﬁcation. weiss sch¨olkopf platt editors advances neural information processing systems pages press figure -dimensional embedding chest radiographs contained golden dataset learned loss visualised multi-dimensional scaling. exam represented point diﬀerent shapes colors identify multiple labels. well-separated cluster normal radiographs exams featuring enlarged heart clearly visible. fig. circled images.", "year": 2017}