{"title": "A Deep Metric for Multimodal Registration", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "Multimodal registration is a challenging problem in medical imaging due the high variability of tissue appearance under different imaging modalities. The crucial component here is the choice of the right similarity measure. We make a step towards a general learning-based solution that can be adapted to specific situations and present a metric based on a convolutional neural network. Our network can be trained from scratch even from a few aligned image pairs. The metric is validated on intersubject deformable registration on a dataset different from the one used for training, demonstrating good generalization. In this task, we outperform mutual information by a significant margin.", "text": "abstract. multimodal registration challenging problem medical imaging high variability tissue appearance diﬀerent imaging modalities. crucial component choice right similarity measure. make step towards general learning-based solution adapted speciﬁc situations present metric based convolutional neural network. network trained scratch even aligned image pairs. metric validated intersubject deformable registration dataset diﬀerent used training demonstrating good generalization. task outperform mutual information signiﬁcant margin. multimodal registration challenging problem medical imaging commonly faced image-guided interventions data fusion main diﬃculty multimodal registration task comes great variability tissue organ appearance imaged diﬀerent physical principles translates lack general rule compare images. therefore efforts tackle problem focus mainly design multimodal similarity metrics. recent works explored supervised methods learn similarity metrics aligned examples showing potential outperform hand-crafted metrics particular applications. however general method learn similarity modalities calls higher capacity models. inspired success computer vision propose learn general similarity metric based convolutional neural networks problem modelled classiﬁcation task goal discriminate aligned misaligned patches diﬀerent modalities. best knowledge ﬁrst time cnns used context multimodal medical image registration. ability metric obtain reliable registrations demonstrated alberts database neonatal images outperform mutual information importantly train separate dataset demonstrating capability generalize data acquired fig. overview method. input network consists ﬁxed image warped image resampled moving image current transformation output dissimilarity element corresponds patch input derivative respect update transformation parameters warm cold colors corresponds positive negative values colormaps respectively. diﬀerent scanners demographic diﬀerences subjects. also show method able learn reliable multimodal similarities even small training often case medical imaging applications. idea using supervised learning build similarity metric multimodal images explored number works. side probabilistic approaches rely modelling joint-image distribution. instance guetter propose generative method based kullback-leibler divergence work closer discriminative concept proposed michel problem learning similarity metric posed binary classiﬁcation. goal discriminate aligned misaligned patches given pairs aligned images. propose structured support vector machine michel method based adaboost. diﬀerent approaches rely learning method choice suitable characteristics type modality combinations directly learned training data. power cnns capture complex relationships multimodal medical images shown problem modality synthesis cnns used mri-t images mri-t images using jointly appearance small patch together localization. work arguably similar approach cheng train multilayer fullyconnected network pretrained autoencoder estimating similarity ct-mr patch pairs. network enables scale weight sharing train scratch. moreover evaluate metric actual task registration unlike cheng work explore formulating convolutional neural network. rely network outputs scalar value estimating size. incorporation continuous optimization framework explained subsection architecture training described subsection continuous optimization methods iteratively update parameters based gradient objective function restrict ﬁrst-order methods gradient descent particular. metric deﬁned aggregate local patch comparisons pixel depends patches containing denoted thus high overlap registration quality drops considerably unless grid stride small. hand subsampling obtain sparser samples minor impact performance. transition equation patch-wise evaluation replaced fully convolutional evaluation whole domain makes computation eﬃcient results intermediate network layers shared among neighboring patches ultimately contribution pixel product three terms c.f. equation derivative ∂n/∂i estimated dissimilarity patches around w.r.t. intensity warped image readily computed standard backpropagation gradient moving image precomputed local jacobian matrix transformation note choice particular transformation type decoupled architecture based recent works learning compare patches notably -channel network zagoruyko komodakis patches considered -channel image ﬁrst layer network. network consists series volumetric convolutional layers relu non-linearities ﬁnalized convolutional layer without non-linearity produces scalar score. gradually subsample spatial domain within network increase spatial context prefer convolutions non-unit output stride pooling used better performance. hypothesize much spatial invariance might detrimental case learning cross-modal identity unlike aiming robustness distortions perspective deformation. product convolutional strides determines overal network stride used fully-convolutional mode. -channel architecture powerful considers patches jointly beginning. however evaluation exploit fact ﬁxed image change optimization deep representation could precomputed form descriptors cached. therefore experimented architectures independent input branches pseudo-siamese network unfortunately observed consistent decrease registration performance. sample transformations tiaj tibj j-th image pair data augmentation varying position scale rotation mirroring. patch pairs bj)) ﬁned positive tiaj tibj negative otherwise. positive negative samples mined equal probability. imposing restrictions negatives patch content experimentally shown detrimental registration quality. entropy. observed softmax leads overly gradients continuous optimization shown bottom plots figure learning rate momentum batch size used optimize network. instead preparing ﬁxed dataset patches like sample online. this together augmentations described above allows feed network practically unlimited amount training data. even small observed overﬁtting learning implementation. torch cudnn library deep learning elastix gpu-based image resampling registration. network layers parameters patch size stride plan open source implementation trained network. evaluate eﬀectiveness learned metric registration experiments clinical brain images subsection conduct experiments demonstrate interesting properties subsections datasets. conducted intersubject deformable registration experiments neonatal brain image volumes taken publicly available brain atlases alberts database consists t-weighted scans newborns. pair aligned annotated segmentation anatomical regions allows evaluate registration quality terms overlap measures; compute average dice jaccard coeﬃcients. make experiment challenging demonstrate good generalization learned metric train completely independent dataset adult brain images. remark structural diﬀerences brains neonates adults. dataset contains approximately aligned image pairs training rest validation although subsection demonstrate much less actually needed. image intensities datasets normalized baseline. baseline mutual information standard metric multimodal registration. observed perform better image domains restricted head region thus ﬁxed intensity threshold masking background denote variant mi+m. masking made nearly diﬀerence metric. unfortunately could compare learning-based metrics implementation available. protocol. test subjects alberts perform intersubject registrations half aligning half round. reserve remaining subjects validating registration parameters model selection. metrics evaluated exactly registration pipeline transformation model optimizer. pipeline consists multiresolution similarity transform registration followed multiresolution b-spline registration optimized gradient descent regular step iterations scale. used histogram bins explicit regularization term equation used neither cnn. instead regularize implicitly design pipeline choice hyperparameters. results. results listed table demonstrate statistically signiﬁcant improvement registration quality points coeﬃcients figure exhibits scatter plots initial ﬁnal dice scores registration improved alignment runs case mi+m especially showing rather precision. highest accuracies achieved methods fig. improvement average dice score registration using proposed metric mutual information without masking data point represents registration run. dashed line denotes identity transformation. rather similar seem nearly independent initial level misalignment. furthermore registration using slower using diﬀerence mostly expensive resampling moving image. huge number aligned volumes dataset rather exceptional medical domain. therefore interested much decrease training size without noticeable impact quality. train networks random image pairs setting above. table shows even little training data results good metric signiﬁcantly outperform mi+m. hand suggests online sampling data augmentation methodology works well. hand either inherent variability dataset network able exploit expect amount necessary data higher challenging modalities ultrasound. investigate behavior metric value actual derivatives used continuous optimization visualize quantities manually perturbing single parameter transformation initialized identity aligned validation image pair ixi. figure suggests metric behaves reasonably curves smooth correct local minima. analytic derivatives equation correct sign large range albeit magnitude slightly noisy. nevertheless shown prevent metric obtaining good registration results. fig. impact perturbation single parameter euclidean transform b-spline transform metric value derivatives equation curve scale. curves without legend correspond parameters strongly aﬀected overlapping patches. presented similarity metric multimodal image registration based convolutional neural network. network trained scratch even aligned image pairs mostly data sampling scheme. described incorporation metric ﬁrst-order continuous optimization frameworks. experimetal evaluation perfomed task intersubject deformable registration dataset diﬀerent used training demonstrating good generalization. task outperform mutual information signiﬁcant margin. envision incorporating network discrete optimization framework easy extension. mrf-based formulation local alignment cost expressed unary potentials nodes graph particular unary potential related cost assigning label/translation node might deﬁned un)) patch domain centered control point transformation corresponding acknowledgments. gratefully acknowledge nvidia corporation donated used research. alberts atlases copyrighted imperial college science technology medicine ioannis gousias guti´errez-becker thanks ﬁnancial support conacyt daad. oﬃcial publication available springer http//dx.doi.org/. /----_.", "year": 2016}