{"title": "No More Discrimination: Cross City Adaptation of Road Scene Segmenters", "tag": ["cs.CV", "cs.AI"], "abstract": "Despite the recent success of deep-learning based semantic segmentation, deploying a pre-trained road scene segmenter to a city whose images are not presented in the training set would not achieve satisfactory performance due to dataset biases. Instead of collecting a large number of annotated images of each city of interest to train or refine the segmenter, we propose an unsupervised learning approach to adapt road scene segmenters across different cities. By utilizing Google Street View and its time-machine feature, we can collect unannotated images for each road scene at different times, so that the associated static-object priors can be extracted accordingly. By advancing a joint global and class-specific domain adversarial learning framework, adaptation of pre-trained segmenters to that city can be achieved without the need of any user annotation or interaction. We show that our method improves the performance of semantic segmentation in multiple cities across continents, while it performs favorably against state-of-the-art approaches requiring annotated training data.", "text": "despite recent success deep-learning based semantic segmentation deploying pre-trained road scene segmenter city whose images presented training would achieve satisfactory performance dataset biases. instead collecting large number annotated images city interest train reﬁne segmenter propose unsupervised learning approach adapt road scene segmenters across different cities. utilizing google street view timemachine feature collect unannotated images road scene different times associated static-object priors extracted accordingly. advancing joint global class-speciﬁc domain adversarial learning framework adaptation pre-trained segmenters city achieved without need user annotation interaction. show method improves performance semantic segmentation multiple cities across continents performs favorably state-of-the-art approaches requiring annotated training data. recent developments technologies computer vision deep learning broadly artiﬁcial intelligence race building advanced driver assistance systems recognizing particular objects interest toward understanding corresponding driving environments road scene segmentation among components successful adas. sufﬁcient amount annotated training image data existing computer vision algorithms already exhibit promising performances task. however applies pre-trained segfigure illustration unsupervised domain adaptation method consisting global class-wise segmentation adaptations. class-wise adaptation leverage soft pseudo labels static object priors alleviate domain discrimination class. conduct pilot experiment illustrate severe state-of-the-art semantic segmenter would affected dataset bias problem. consider segmenter trained cityscapes apply segmenting annotated road scene images different cities across countries rome taipei tokyo. drop mean intersection union observed thus suppress dataset bias would critical need deploy road scene segmenters different cities. notated training image data city interest would time-consuming expensive. instance pixel labeling cityscapes image takes minutes average alleviate problem number methods proposed reduce human efforts pixellevel semantic labeling. example researchers choose utilize information rendered images weakly supervised labels labeling. however existing techniques still require human annotation data collection thus might easily scaled larger image datasets. inspired recent advances domain adaptation propose unsupervised learning framework performing cross-city semantic segmentation. proposed model able adapt pre-trained segmentation model city interest collection unlabeled road scene images city required. avoid human interaction annotation during data collection utilize google street view time-machine feature harvest road scene images taken locations across different times. detailed later sec. allows extract static-object priors city interest. integrating priors proposed global class-speciﬁc domain adversarial learning framework reﬁning/adapting pre-trained segmenter easily realized. utilize google street view images timemachine features extract static-object priors collected image data without need user annotation interaction. along static-object priors advance adversarial learning assigning pseudo labels cross-city images joint global class-wise adaptation segmenters achieved. semantic segmentation among recent breakcomputer vision development prevalence convolutional neural networks successfully applied predict dense pixelwise semantic labels example long utilize performing pixel-level classiﬁcation able produce pixel-wise outputs arbitrary sizes. order achieve high resolution prediction adapt deconvolution layers promising performances. hand chen choose fully-connected layer output reﬁnes pixel labels context information properly preserved. note that since goal paper adapt pre-trained segmenters across cities limit particular cnn-based segmentation solvers proposed framework. apply cnn-based segmenters road scene images several attempts train segmenters large-scale image datasets example cordts release natural road scene segmentation dataset consists annotated images. annotate semantic labels scene followed transferring labels associated video frames. collect semantic labels computer graphic images large scale; however building worlds practical uses might still computationally expensive. hand choose relax supervision data collection process simply require number point-labels image. moreover require image-level labels data collection training. addition image-level labels pathak incorporate constraints object sizes utilize weak object location knowledge exploit object boundaries constrained segmentation without using large annotated dataset. alternatively apply free-form squiggles provide partial pixel labels data collection. finally utilize image-level labels cosegmentation techniques infer semantic segmentation foreground objects images imagenet. since goal work adapt cnn-based segmenters across datasets review recent deep neural networks based approaches domain adaptation based maximum mean discrepancy long minimize mean distance data domains later incorporate concept residual learning improvements. zellinger consider central moment discrepancy instead sener enforce cyclic consistency adaptation structured consistency transduction framework. recently generative adversarial network raised great attention ﬁelds computer vision machine learning. existing architectures applied synthesizing images particular figure example road scene images different cities dataset. evaluation purposes randomly select images city annotate pixel-level semantic labels. color-coded labels overlaid example image mapping colors semantic classes shown left panel. styles extend frameworks domain adaptation. coupled domain adaptation achieved ﬁrst generating corresponded instances across domains followed performing classiﬁcation. parallel appearance ganin propose domain adversarial neural networks consider adversarial training suppressing domain biases. extension variational recurrent adversarial deep domain adaptation utilizes variational auto encoder timeseries adaptation. sharing similar goal ours hoffman extend frameworks semantic segmentation. diverse locations appearances. using google street view road scene images global scale accessed across large number cities world. address issue geo-location discrimination road scene segmenter download road scene images four cities diverse locations rome tokyo taipei expected signiﬁcant appearance differences. ensure cover sufﬁcient variations visual appearances city randomly sample locations city image collection. across different times obtained. detailed later sec. property particularly allows observe prior information static objects improved adaptation without annotation achieved. work collected image pairs different locations city high image quality evaluation purposes select image pairs city testing pixel-level ground truth labels annotated image processing experts. deﬁne major classes annotation road sidewalk building trafﬁc light trafﬁc sign vegetation person rider motorcycle bicycle deﬁned cityscapes fig. shows example images dataset. dataset publicly available later academic uses. details examples dataset please refer appendix visit website https//yihsinchen.github.io/segmentation adaptation/. summarize uniqueness dataset below unlike existing datasets typically collect images nearby locations dataset includes road scene images four different cities around world highquality pixel-level annotations figure overview proposed framework. feature extractor transforms cross-domain images proper feature space derived performing global class-wise predictor regularizes learned model observing ground-truth annotation source-domain images. section present details proposed unsupervised domain adaptation framework able adapt pre-trained segmenters across different cities without using user annotated data. words images labels available source domain images target domain observed. domain shift. adapting image segmenters across cities different types domain shifts expected global class-wise domain shift. former comes overall differences appearances cities latter distinct compositions road scene components city. minimize global domain shift follow apply technique adversarial learning introduces domain discriminator loss distinguish difference source target-domain images goal produce common feature space images across domains. perform class-wise alignment extend idea utilize multiple classwise domain discriminators corresponding adversarial loss lclass. unlike discriminator global alignment class-wise discriminators trained suppress difference cross-domain images class. since annotation city interest later explain method performs unsuperλg λclass weights global class-wise domain adversarial loss respectively. note ltask denotes prediction loss source-domain images viewed regularization term adapting learned model across domains. proposed framework. fig. illustrates framework. classes input image denoted proposed architecture decoupled four major components feature extractor transforms input image highlevel semantic feature space label predictor maps feature space task label space domain discriminator global class-wise class) alignments feature extractor task label predictor initialized pre-trained segmenter domain discriminators randomly initialized. utilize front-end dilated-fcn pre-trained segmenter work worth noting framework generally applied semantic segmenters. addition suppressing global misalignment between image domains propose advance adversarial learning architecture perform class-wise domain adaptation. idea regularizing class-wise information segmenter adaptation seen classwise alignment performed based composition class components cross-city road scene images. precise assumes composition/proportion object classes across cities would similar. thus regularization essentially performs global instead classspeciﬁc adaptation. that adapting segmenters across cities observe road scene images target city interest without label annotation. unsupervised settings extend idea assign pseudo labels pixels/grids images target domain. global adaptation fig. predicted probability distribution maps softmax target domain images produced. thus viewed soft pseudo label target domain images. result class-wise association across data domains initially estimated relating ground truth label source domain soft pseudo label target domain. pixel grid-level pseudo label assignment. sec. train domain discriminator deﬁne grid feature space instance corresponds multiple pixels image space. labels grids produced adapting class-wise information using adversarial learning framework achieved. propagate determine pseudo labels pixels grid adaptation purposes simply calculate proportion class grid soft label. pixel index image space grid index feature space pixels correspond grid denote ground truth label pixel source domain images calculate source-domain grid-wise soft-label learning frameworks applied solving cross-domain image classiﬁcation tasks however cross-domain image segmentation image consists multiple pixels viewed multiple instances observation. thus extend idea domain adversarial learning adapting segmenters across image domains would focus. inspire take grid feature fcn-based segmenter instance. feature maps source target domain images consists grids. θg)) probability grid image belongs source domain sigmoid function. note that cross-domain classiﬁcation ganin loss function plus gradient reversal layer update feature extractor domain discriminator simultaneously. directly applying loss function cross-domain segmentation would observe unfortunately loss function result gradient vanishing discriminator converges local minimum. alleviate issue follow decompose problem subtasks. specifically domain discriminator trained classifying distributions groups feature extractor updated inverse loss ldinv minimizes associated distribution differences. summary objective minimize ldinv iteratively update hand lack annotated targetdomain data straightforward assign grid-level soft pseudo labels images domain. solve problem utilize derived above. pixel-wise soft pseudo label pixel corresponding figure illustration static-object prior extraction. given pair images location different times image regions belonging static objects identiﬁed performing dense matching superpixel segmentation. intuitively grid-wise soft labels estimations probabilities grid source target domain images belongs object class balance appearance frequency different classes normalize estimated outputs follows class-wise adversarial learning. soft labels assigned source-domain images soft pseudo labels predicted target-domain ones explain adversarial learning class-wise domain adaptation. depicted fig. deploy multiple class-wise class proposed ardomain discriminators chitecture discriminator specially trained differentiating objects corresponding class across domains. similar given object class corresponded domain discriminator class deﬁne class)) probability relate pixels within image pair. regions matched pixels across images implies regions related static objects then additionally perform superpixel segmentation image pair using entropy rate superpixel would group nearby pixels regions boundaries objects properly preserved. derivation view matched superpixels containing matched pixels staticobject prior pstatic. please refer appendix typical examples mining static-object prior. cstatic static-object classes. pixels belong pstatic reﬁne soft pseudo labels suppressing probabilities nonﬁrst conduct experiments demonstrate issue cross-city discrimination even using state-of-the-art semantic segmenter. then verify effectiveness proposed unsupervised learning method cityscapes dataset domain adaptation task. comparing fully-supervised baseline show unsupervised method would achieve comparable performances fully-supervised methods cases. finally perform extra experiment synthia cityscapes prove method could generally applied different datasets. work implementations produced utilizing open source tensorflow framework codes released upon acceptance. following experiments mini-batch size adam optimizer learning rate beta beta optimize network. moreover hyper-parameters λclass numbers gradually changing respectively. addition experiments using static-object priors {road sidewalk building wall fence pole trafﬁc light trafﬁc sign vegetation terrain sky} static-object classes cstatic deﬁned sec. cross-city discrimination compared original performance cityscapes. interestingly observe trend farther geo-distance target city pre-trained city severer performance degradation. implies different visual appearances across cities cultural differences would dramatically impact accuracy segmenter. example taipei shown fig. many signboards shop signs attached buildings many scooters road uncommon frankfurt. also justiﬁes necessity effective domain adaptation method road scene segmenter alleviate discrimination. cross-city adaptation baseline. fully-supervised method establish strong baseline upper bound adaptation improvement. divide images annotations subsets city. time select subset testing images training ﬁne-tune segmenter steps. repeat procedure times average testing results baseline performance. method. apply domain adversarial learning method adapt pre-segmenter unsupervised fashion. meanwhile ablation study demonstrate contribution component global alignment class-wise alignment static-object prior. summarize experimental results table pretrained denotes pre-trained model denotes fully-supervised upper bound denotes global alignment part method ga+ca denotes combination global alignment class-wise alignment ﬁnally full method denotes overall method utilizes static-object priors. average four cities global alignment method contributes miou gain class-wise alignment method also contributes miou gain ﬁnally static-object priors contributes another miou improvement. furthermore t-sne visualization results appendix also show domain shift keeps decreasing pre-trained ga+ca. results demonstrate effectiveness component method. fig. show typical examples. additionally apply method another adaptation task different type domain shift synthia cityscapes. experiment take synthiarand-cityscapes source domain contains synthetic road scene images cityscapescompatible annotations. unlabeled target domain training cityscapes. evaluation test adapted segmenter validation table segmentation performance comparisons bldg motor stand sidewalk building trafﬁc light trafﬁc sign vegetation motorbike respectively. note ga/ca denote components global/class-wise adaptation architecture method integrates components static-object priors unsupervised domain adaptation. performance upper bound achieved fully supervised baseline noted figure examples cross-city adaptation. ﬁrst/third second/fourth rows show results adaptation respectively. regions improved segmentation adaptation highlighted better visualization. paper present unsupervised domain adaptation method semantic segmentation alleviates cross-domain discrimination road scene images across different cities. propose uniﬁed framework utilizing domain adversarial learning performs joint global class-wise alignment leveraging soft labels source target-domain data. addition method uniquely identiﬁes introduce static-object priors method retrieved images natural synchronization static objects time. finally provide dataset containing road scene images four cities across countries good-quality annotations paired images temporal information also included. demonstrate effectiveness component method tasks different levels domain shift.", "year": 2017}