{"title": "DeepLung: Deep 3D Dual Path Nets for Automated Pulmonary Nodule  Detection and Classification", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "In this work, we present a fully automated lung computed tomography (CT) cancer diagnosis system, DeepLung. DeepLung consists of two components, nodule detection (identifying the locations of candidate nodules) and classification (classifying candidate nodules into benign or malignant). Considering the 3D nature of lung CT data and the compactness of dual path networks (DPN), two deep 3D DPN are designed for nodule detection and classification respectively. Specifically, a 3D Faster Regions with Convolutional Neural Net (R-CNN) is designed for nodule detection with 3D dual path blocks and a U-net-like encoder-decoder structure to effectively learn nodule features. For nodule classification, gradient boosting machine (GBM) with 3D dual path network features is proposed. The nodule classification subnetwork was validated on a public dataset from LIDC-IDRI, on which it achieved better performance than state-of-the-art approaches and surpassed the performance of experienced doctors based on image modality. Within the DeepLung system, candidate nodules are detected first by the nodule detection subnetwork, and nodule diagnosis is conducted by the classification subnetwork. Extensive experimental results demonstrate that DeepLung has performance comparable to experienced doctors both for the nodule-level and patient-level diagnosis on the LIDC-IDRI dataset.\\footnote{https://github.com/uci-cbcl/DeepLung.git}", "text": "work present fully automated lung computed tomography cancer diagnosis system deeplung. deeplung consists components nodule detection classiﬁcation considering nature lung data compactness dual path networks deep designed nodule detection classiﬁcation respectively. speciﬁcally faster regions convolutional neural designed nodule detection dual path blocks u-net-like encoder-decoder structure effectively learn nodule features. nodule classiﬁcation gradient boosting machine dual path network features proposed. nodule classiﬁcation subnetwork validated public dataset lidc-idri achieved better performance state-of-the-art approaches surpassed performance experienced doctors based image modality. within deeplung system candidate nodules detected ﬁrst nodule detection subnetwork nodule diagnosis conducted classiﬁcation subnetwork. extensive experimental results demonstrate deeplung performance comparable experienced doctors nodule-level patient-level diagnosis lidc-idri dataset. lung cancer common cause cancer-related death men. low-dose lung screening provides effective early diagnosis sharply reduce lung cancer mortality rate. advanced computer-aided diagnosis systems expected high sensitivities time maintaining false positive rates. recent advances deep learning enable rethink ways clinician lung cancer diagnosis. current lung analysis research mainly includes nodule detection nodule classiﬁcation work building complete lung cancer diagnosis system fully automated lung cancer diagnosis using deep learning integrating nodule detection nodule classiﬁcation. worth exploring whole lung cancer diagnosis system understanding performance current deep learning technology differs experienced doctors. best knowledge ﬁrst work fully automated complete lung cancer diagnosis system using deep nets. emergence large-scale dataset luna accelerated nodule detection related research. typically nodule detection consists stages region proposal generation false positive reduction. traditional approaches generally require manually designed features morphological features voxel clustering pixel thresholding recently deep convnets faster r-cnn fully convnets employed generate candidate bounding boxes second stage advanced methods complex features carefully designed texture features used remove false positive nodules. nature data effectiveness faster r-cnn object detection natural images design faster r-cnn nodule detection convolutional kernels u-net-like encoder-decoder structure effectively learn latent features u-net structure basically convolutional autoencoder augmented skip connections encoder decoder layers although widely used context semantic segmentation able capture contextual local information helpful nodule detections well. convnet large number parameters difﬁcult train public lung datasets relatively small sizes dual path network employed building block since deep dual path network compact provides better performance deep residual network time figure framework deeplung. deeplung ﬁrst employs faster r-cnn generate candidate nodules. uses deep extract deep features detected cropped nodules. lastly deep features detected nodule size pixels employed classiﬁcation. patient-level diagnosis achieved fusing classiﬁcation results detected nodules neering followed classiﬁers general pipeline nodule classiﬁcation large-scale lidc-idri dataset became publicly available deep learning-based methods become dominant framework nodule classiﬁcation research multi-scale deep convnet shared weights different scales proposed nodule classiﬁcation weight sharing scheme reduces number parameters forces multi-scale deep convnet learn scale-invariant features. inspired recent success dual path network imagenet propose novel framework nodule classiﬁcation. first design deep dual path network extract features. gradient boosting machines known superb performance given effective features deep dual path features nodule size cropped nodule pixels nodule classiﬁcation finally built fully automated lung cancer diagnosis system henceforth called deeplung combining nodule detection network nodule classiﬁcation network together illustrated fig. image ﬁrst detection subnetwork detect candidate nodules. next employ classiﬁcation subnetwork classify detected nodules either malignant benign. finally patient-level diagnosis result achieved whole fusing diagnosis result nodule. main contributions follows fully exploit images deep convnets designed nodule detection classiﬁcation respectively. convnet contains many parameters difﬁcult train relatively small public lung datasets employ dual path networks neural network architecture since uses less parameters obtains better performance residual network speciﬁcally inspired effectiveness faster r-cnn object detection propose faster r-cnn nodule detection based dual path network u-net-like encoder-decoder structure deep dual path network nodule classiﬁcation. classiﬁcation framework achieves better performance compared state-of-the-art approaches surpasses performance experienced doctors public dataset lidc-idri. fully automated deeplung system nodule classiﬁcation based detection comparable performance experienced doctors nodule-level patient-level diagnosis. traditional nodule detection involves hand-designed features descriptors requiring domain expertise. recently several works proposed deep convnets nodule detection automatically learn features proven much effective handdesigned features. setio proposes multi-view convnet false positive nodule reduction nature scans work proposed convnets handle challenge. fully convnet proposed generate region candidates deep convnet weighted sampling used false positive reduction ding liao faster r-cnn generate candidate nodules followed convnets remove false positive nodules effective performance faster r-cnn design novel network faster r-cnn dual path blocks nodule detection. further u-net-like encoder-decoder scheme employed faster r-cnn effectively learn features nodule classiﬁcation traditionally based segmentation manual feature design several works designed contour feature shape feature texture feature nodule diagnosis recently deep networks shown effective medical images. artiﬁcial neural network implemented nodule diagnosis computationally effective network multi-scale convnet shared weights different scales learn scale-invariant features proposed nection might exist redundancy exploited features. dual path connection uses part feature maps dense connection part residual learning. implementation dual path connection splits feature maps parts. part used residual learning part used dense connection shown fig. hyper-parameter deciding many features exploited. dual path connection formulated feature dual path connection used relu activation function convolutional layer functions input dual path connection block. dual path connection integrates advantages advanced frameworks residual learning feature reuse dense connection ability exploit features uniﬁed structure obtained success imagenet dataset. design deep neural nets based compactness effectiveness. faster r-cnn u-net-like encoderdecoder structure dual path blocks illustrated fig. memory limitation input faster r-cnn cropped reconstructed images pixel size encoder network derived ﬁrst max-pooling convolutional layers used generate features. after that eight dual path blocks employed encoder subnetwork. integrate u-net-like encoder-decoder design concept detection learn deep nets efﬁciently fact region proposal generation faster r-cnn conducts pixel-wise multi-scale learning u-net validated effective pixel-wise labeling. integration makes candidate nodule generation effective. decoder network feature maps processed deconvolution layers dual path blocks subsequently concatenated corresponding layers encoder network convolutional layer dropout used second last layer. last layer design anchors scale references designed based distribution nodule sizes. anchor parts loss function classiﬁcation loss lcls whether current nodule regression loss lreg nodule coordinates nodule size anchor overlaps ground truth bounding intersection union higher consider positive anchor hand anchor ground truth boxes less consider negative anchor multi-task loss function anchor deﬁned nodule classiﬁcation deep transfer learning multiinstance learning used patient-level lung diagnosis comparative study convnets conducted convnet shown better convnet data furthermore multitask learning transfer learning framework proposed nodule diagnosis different approaches propose novel classiﬁcation framework nodule diagnosis. inspired recent success deep dual path network imagenet design novel extract features nodules. part superior performance complete features employ different levels granularity ranging pixels features global features nodule size nodule diagnosis. patient-level diagnosis achieved fusing nodule-level diagnosis. fully automated lung cancer diagnosis system consists parts nodule detection classiﬁcation. design faster r-cnn nodule detection propose deep features nodule pixels nodule size nodule classiﬁcation. inspired success dual path network imagenet design deep framework lung nodule detection classiﬁcation fig. fig. dual path connection beneﬁts advantage residual learning dense connection shortcut connection residual learning effective eliminate vanishing gradient phenomenon deep networks. learned feature sharing perspective residual learning enables feature reuse dense connection advantage exploiting features additionally densely connected network fewer parameters residual learning need relearn redundant feature maps. assumption dual path config. main reason employ dual modules detection classiﬁcation classifying nodules benign malignant requires system learn ﬁner-level features achieved focusing nodules. addition allows introduce extra features ﬁnal classiﬁcation. ﬁrst crop data centered predicted nodule locations size that convolutional layer used extract features. dual path blocks employed learn higher level features. lastly average pooling binary logistic regression layer used benign malignant diagnosis. deep dual path network used classiﬁer nodule diagnosis directly also employed learn effective features. construct feature concatenating learned deep features nodule size cropped nodule pixels. given complete effective features superb method build advanced classiﬁer validate feature combining nodule size cropped nodule pixels combination classiﬁer obtained average test accuracy. lastly employ constructed feature achieve best diagnosis performance. deeplung system includes nodule detection using faster r-cnn nodule classiﬁcation using constructed feature shown fig. memory limitation ﬁrst split whole several patches process detector combine detected results together. keep detected boxes detection probabilities larger that non-maximum suppression adopted based detection probability intersection union threshold expect miss many ground truth nodules. detected nodules crop nodule center detected center size detected nodule size kept feature input later downstream classiﬁcation. deep employed extract features. construct features conduct diagnosis detected nodules. pixel feature cropped size center detected nodule center experiments. patient-level diagnosis detected nodules positive patient classiﬁed cancer. conversely detected nodules negative patient considered non-cancer. figure faster r-cnn framework contains dual path blocks u-net-like encoder-decoder structure. design layers dual path network encoder subnetwork. model employs anchors multi-task learning loss including coordinates diameter regression candidate classiﬁcation. numbers boxes feature sizes format numbers connections format figure deep dual path network framework nodule classiﬁcation subnetwork contains dual path connection blocks. training deep dual path network feature extracted gradient boosting machine nodule diagnosis. numbers formats fig. nodule ground truth coordinates diameter. lcls used binary cross entropy loss function. lreg used smooth regression loss function gradient boosting machine dual path conduct extensive experiments validate deeplung system. perform -fold cross validation using detector luna dataset. nodule classiﬁcation lidc-idri annotation employ luna’s patient-level dataset split. finally also validate whole system based detected nodules patient-level diagnosis nodule-level diagnosis. training model epochs total stochastic gradient descent optimization momentum batch size parameter limited memory. weight decay initial learning rate half total number epoch epoch datasets luna dataset subset largest publicly available dataset pulmonary nodules lidc-idri luna dataset detection annotations lidc-idri contains almost related information low-dose lung including several doctors’ annotations nodule sizes locations diagnosis results nodule texture nodule margin informations. luna dataset removes slice thickness greater slice spacing inconsistent missing slices lidc-idri dataset explicitly gives patient-level -fold cross validation split dataset. luna dataset contains low-dose lung lidc-idri contains low-dose lung cts. note luna dataset removes annotated nodules size smaller nodule classiﬁcation extract nodule annotations lidc-idri dataset mapping different doctors’ nodule annotations luna’s nodule annotations obtained ground truth nodule diagnosis averaging different doctors’ diagnosis ﬁnal average score equal remove nodule. nodules score greater label positive. otherwise label negative. slides annotated anonymous doctors identities doctors strictly consistent. such refer simulated doctors. make results reproducible keep within luna dataset cross validation split luna classiﬁcation. preprocessing three automated preprocessing steps employed input images. first clip data second transform range linearly finally luna’s given segmentation ground truth remove background. figure faster r-cnn network residual blocks. contains several residual blocks. employ deep residual network layers encoder subnetwork extension train evaluate detector luna dataset following -fold cross validation given patient-level split. training augment dataset randomly ﬂipping image cropping scale betweeb evaluation metric froc average recall rate average number false positives scan ofﬁcial evaluation metric luna dataset test phase detection probability threshold followed threshold validate performance proposed deep dual path network detection employ deep residual network comparison fig. encoder part baseline network deep residual network layers extension note faster r-cnn contains trainable parameters faster r-cnn employs trainable parameters faster r-cnn. froc performance luna visualized fig. solid line interpolated froc based true prediction. faster r-cnn achieves froc score without false positive nodule reduction stage better previous using two-stage training faster r-cnn using parameters performs better faster r-cnn demonstrates superior suitability detection. ding obtains froc using faster r-cnn followed extra false positive reduction classiﬁer employ enhanced faster r-cnn deep dual path detection. recently applied model alibaba tianchi medical nodule detection challenge able achieve accuracy hold-out dataset. figure sensitivity rate respect false positives scan. froc faster r-cnn froc faster r-cnn parameters faster r-cnn. faster r-cnn total recall rate detected nodules faster r-cnn recall rate dation. nodules positive. training ﬁrst nodules size randomly crop padded data horizontal vertical z-axis data augmentation randomly patch zero normalize data mean standard deviation obtained training data. total number epochs initial learning rate reduce epoch ﬁnally epoch time resource limitation training fold test ﬁnal performance average performance test folds. nodule classiﬁcation performance concluded table table deep achieves better performance multi-scale vanilla multi-crop strong power structure deep dual path network. nodule size nodule pixels crop size achieves comparable performance multiscale superior classiﬁcation performance gbm. finally construct feature deep dual path network features faster r-cnn detected nodule size nodule pixels obtain accuracy shows effectiveness deep dual path network features. table doctors’ conﬁdent nodules easy diagnosed nodules performance comparison model’s performances table table surprise average performance model better experienced doctors even individually conﬁdent diagnosed nodules. fact model’s performance better doctors conﬁdent nodule diagnosis task. result validates deep network surpasses human-level performance image classiﬁcation deeplung better suited nodule diagnosis experienced doctors. also employ kappa coefﬁcient common approach evaluate agreement raters test agreement deeplung ground truth kappa coefﬁcient deeplung signiﬁcantly better average kappa coefﬁcient doctors evaluate performance nodules including borderline nodules compute likelihood scores deeplung doctors’ diagnosis. randomly sample times experienced doctors’ annotations simulated doctors. mean doctors standard deviation contrast deeplung showing performance deeplung standard deviation better average performance doctors highly statistically signiﬁcant. important analysis statistical property predictions borderline nodules cannot conclusively classiﬁed doctors. interestingly borderline nodules classiﬁed either malignant benign table deeplung classiﬁed borderline nodules malignant probabilities closer zero closer showing potential tool assisted diagnosis. also validate deeplung fully automated lung cancer diagnosis lidc-idri dataset protocol luna’s patient-level split. firstly employ faster r-cnn detect suspicious nodules. retrain model nodule classiﬁcation model detected nodules dataset. center detected nodule within ground truth positive nodule positive nodule. otherwise negative nodule. mapping detected nodule ground truth nodule evaluate performance compare performance experienced doctors. adopt test fold validate performance nodule classiﬁcation. different pure nodule classiﬁcation fully automated lung nodule diagnosis relies nodule detection. evaluate performance deeplung detection true positive detection false positive individually table detected nodule center within ground truth nodule regions set. detected nodule center ground truth nodule regions set. table deeplung system using detected nodule region obtains accuracy detected nodules. note experienced doctors obtain accuracy nodule diagnosis average. deeplung system fully automated lung nodule diagnosis still achieves average performance experienced doctors. nodule classiﬁcation subnetwork deeplung reduce detected nodules guarantees fully automated system effective lung cancer diagnosis. positive diagnosis positive. nodules classiﬁed negative diagnosis negative. evaluate deeplung doctors’ individually conﬁdent benchmark comparison table table deeplung achieves patient-level diagnosis accuracy. average performance four experienced doctors better altogether. performance gives conﬁdence deeplung useful tool assist doctors’ diagonsis. validate method four doctors’ individual conﬁdential cts. kappa coefﬁcient deeplung average kappa coefﬁcient doctors implies predictions deeplung good agreement ground truths patient-level diagnosis comparable experienced doctors. randomly pick nodules test fold visualize circles ﬁrst fig. detected nodules visualized blue circles second row. because voxel data plot central slice visualization. third shows detection probabilities detected nodules. central slice number shown slice. diameter circle relative nodule size. central slice visualizations fig. observe detected nodule positions including central slice numbers consistent ground truth nodules. circle sizes similar nodules ﬁrst second row. detection probability also high nodules third row. shows faster r-cnn works well detect nodules test fold also visualize nodule classiﬁcation results test fold fig. choose nodules predicted right annotated incorrectly doctors. ﬁrst seven nodules benign nodules remaining nodules malignant nodules. numbers ﬁgfigure visualization central slices nodule ground truths detection results. randomly choose nodules test fold detection results shown blue circles second row. center slice numbers shown images. last shows detection probability. deeplung performs well nodule detection. ures deeplung predicted malignant probabilities followed annotation doctors wrong. deeplung probability larger predicts malignant. otherwise predicts benign. experienced doctor nodule large irregular shape high probability malignant nodule. figure visualization central slices nodule classiﬁcation results test fold choose nodules predicted right deeplung annotated incorrectly doctors. numbers nodules model predicted malignant probabilities followed annotation doctors wrong. ﬁrst seven nodules benign nodules. rest nodules malignant nodules. deeplung performs well nodule classiﬁcation. fig. observe doctors mis-diagnose nodules. reason humans process data signal noise ratio. perhaps doctors cannot weak irregular boundaries erroraneously consider normal tissues nodule boundaries leading false negatives false positives. addition doctors’ internal bias play role conﬁdent he/she predicts scans being limited observing slice time. machine learning-based methods overcome limitations able learn complicated rules high dimensional features utilizing input slices without much problem. perspective deeplung potentially great doctors effort make consistent accurage diagonsis. work propose fully automated lung cancer diagnosis system based deep learning. deeplung consists parts nodule detection classiﬁcation. fully exploit images propose deep convolutional networks based dual path networks compact yield better performance residual networks. nodule detection design faster r-cnn dual path blocks u-netlike encoder-decoder structure detect candidate nodules. detected nodules subsequently nodule classiﬁcation network. deep dual path network extract classiﬁcation features. finally gradient boosting machine combined features trained classify candidate nodules benign malignant. extensive experimental results public available large-scale datasets luna lidc-idri datasets demonstrate superior performance deeplung system.", "year": 2018}