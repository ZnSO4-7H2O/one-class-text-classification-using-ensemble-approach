{"title": "Learning Deep Features via Congenerous Cosine Loss for Person  Recognition", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Person recognition aims at recognizing the same identity across time and space with complicated scenes and similar appearance. In this paper, we propose a novel method to address this task by training a network to obtain robust and representative features. The intuition is that we directly compare and optimize the cosine distance between two features - enlarging inter-class distinction as well as alleviating inner-class variance. We propose a congenerous cosine loss by minimizing the cosine distance between samples and their cluster centroid in a cooperative way. Such a design reduces the complexity and could be implemented via softmax with normalized inputs. Our method also differs from previous work in person recognition that we do not conduct a second training on the test subset. The identity of a person is determined by measuring the similarity from several body regions in the reference set. Experimental results show that the proposed approach achieves better classification accuracy against previous state-of-the-arts.", "text": "person recognition aims recognizing identity across time space complicated scenes similar appearance. paper propose novel method address task training network obtain robust representative features. intuition directly compare optimize cosine distance features enlarging inter-class distinction well alleviating inner-class variance. propose congenerous cosine loss minimizing cosine distance samples cluster centroid cooperative way. design reduces complexity could implemented softmax normalized inputs. method also differs previous work person recognition conduct second training test subset. identity person determined measuring similarity several body regions reference set. experimental results show proposed approach achieves better classiﬁcation accuracy previous state-of-the-arts. introduction increasing demand intelligent cellphones digital cameras people today take photos daily life stories. overwhelming trend generating desperate demand smart tools recognize person across different time space among thousands images personal data social media internet. previous work demonstrated person recognition unconstrained settings remains challenging problem many factors non-frontal faces varying light illumination variability appearance texture identities etc. recently proposed pipa dataset contains thousands images complicated scenarios similar appearance among persons. illumination scale context data varies many instances figure overview pipa dataset. previous work train ﬁnetuning features; recognition system trained test evaluated test work directly train model train test reference predict identities test measuring feature similarity sets. partial even faces. figure shows samples training test sets. previous work resort identifying person multi-cue multi-level manner training used extracting features follow-up classiﬁer trained test set. recognition system evaluated test set. argue practice infeasible realistic application since second training test auxiliary needs re-training samples added. instead providing robust well generalized feature representations trained directly shown bottom figure woman green wears similar scarf person light green box. face shown partially appear cases. obtain robust feature representations train several deep models different regions combine similarity score features different regions prediction one’s identity. observation training cross-entropy loss guarantee similarity among samples within category. magniﬁes difference across classes ignore feature similarity class. propose congenerous cosine loss namely coco enlarge inter-class distinction well narrow inner-class variation. achieved measuring cosine distance sample cluster centroid cooperative manner. moreover also align region patch pre-deﬁned base location make samples within category closer feature space. alignment strategy could also make network less prone overﬁtting. figure illustrates training pipeline proposed algorithm glance. instance image annotated ground truth head train face human body detector respectively using framework detect regions. human pose estimator applied detect parts person order localize upper body region. cropping four region patches conduct afﬁne transformation align different patches training samples ‘base’ location. four deep models trained separately pipa training using coco loss obtain robust features. contributions work follows propose congenerous cosine loss directly optimize cosine distance among samples within across categories. achieved cheap softmax manner normalized inputs less complexity. design person recognition pipeline leverages several body regions obtain discriminative representation features without necessity conducting second training test set. related work person recognition photo albums aims recognizing identity people daily life photos scenarios complex cluttered background. ﬁrst address problem proposing markov random ﬁled framework combine contextual cues recognize identity persons. recently introduce large-scale dataset task. accumulate cues poselet-level person recognizer trained deep model compensate pose variations. detailed analysis different cues explicitly investigated three additional test splits proposed evaluation. embed scene relation contexts lstm formulate person recognition sequence prediction task. person re-identiﬁcation match pedestrian images various perspectives cameras typical time period many important applications video existing work employ metric learning mid-level feature learning address problem. propose deep network using pairs people encode photometric transformation. incorporate siamese deep network learn similarity metric between pairs images. main difference person recognition re-identiﬁcation resides data logistics. former identify person across places time. cases identity varies appearance different occasions. latter detect person consecutive video meaning appearance background vary much terms time. deep neural networks dramatically advanced computer vision community recent years high performance boost tremendous tasks image classiﬁcation object detection object tracking etc. essence behind success deep learning resides superior expression power non-linear complexity highdimension space largescale datasets deep networks could full extent learn complicated patterns representative features. algorithm proposed coco loss trained body region obtain robust features. section depicts detection region given image; inference section extract features corresponding regions test test merge similarity scores different regions make ﬁnal prediction one’s identity. region detection features four regions {··· namely face head whole body upper body utilized train features. ﬁrst state detection regions. face. pre-train face detector region proposal network spirit following faster rcnn source data comes internet number images roughly network structure shallow version resnet model remove layers loss heads ﬁnetune face model pipa training coco loss. face detector identiﬁes keypoints face figure training workﬂow algorithm. person labelled ground-truth head. face whole body upper body detection. then align region base position alleviate inner-class variance. aligned patch deep model obtain representative robust features using coco loss. increase similarity samples within category enlarge centroid distance samples across classes. {··· labels sample total number categories following loss maximize indicator function trivial number computation stability. design reasonable theory suffers computational inefﬁciency. since loss complexity loss deﬁned rm×m linear transformation matrix bias alignment scheme ensures samples within across category large variance network learned without alignment distinguish patterns e.g. different rotations among persons making prone overﬁtting; network equipped alignment focus differentiating features different identities despite rotation viewpoint translation etc. head whole body upper body. head region given ground truth person. detect whole body also pre-train detector framework. model trained large-scale human celebrity dataset ﬁrst identities images. network structure inception model ﬁnal pooling layer replaced fully connected layer. determine upper body region conduct human pose estimation identity keypoints body upper part thereby located points. head whole body upper body models used coco loss training ﬁnetuned pipa training using pretained inception model following similar procedure patch alignment stated previously face region. aligned patches four regions shown figure congenerous cosine loss training intuition behind designing coco loss directly compare optimize cosine distance features. denote feature vector i-th sample region feature dimension. brevity drop superscript since region model undergoes coco training. ﬁrst deﬁne cosine similarity features mini-batch figure feature visualization using different losses trained mnist classes. softmax loss tries chock feature space coco enlarges inter-class distance well alleviates inner-class variation. cases insets evident. memory store center classes thus computation twice proposed generalized large-margin softmax loss also learns discriminative features imposing intra-class compactness inter-class separability. coupled cluster loss adaptation triplet loss mini-batch positives class possible negatives classes. optimizes inter-class distance sense fails differentiate among negatives. testing stage measure similarity features between test splits recognize identity instance test based labels test similarity between patches test test denoted indicates speciﬁc region model. problem merge similarity scores different regions. ﬁrst normalize preliminary result order scores across different regions comparable parameters logistic regression. ﬁnal score weighted mean normalized scores total number regions weight region’s score. identity patch test decided label corresponding maximum score reference maxj∗ sij. scheme guarantees training data added test need train second model reference indexes along class dimension binary mapping sample based label practice coco loss implemented neat softmax operation. eqn. constrain feature centroid normalized c/c) loose summation denominator include probability output sample becomes input softmax. seen weights classiﬁcation layer bias term zero. advantage coco loss eqn. naive version eqn. folds reduces complexity computation could achieved softmax normalized inputs terms cosine distance. derivative loss w.r.t. input feature written element-wise form dropping sample index brevity follows gradient w.r.t. normalized feature. derive gradient w.r.t. centroid ∂l/∂ckj similar manner. note features cluster centroids trained end-to-end. features initialized pretrain models initial value thereby obtained eqn. relationship coco counterparts coco loss formulated metric learning approach feature space using cluster centroid cosine distance metric enlarge inter-class variation well narrow inner-class distinction. achieved softmax operation several constraints. figure shows visualization feature clusters different loss schemes. softmax loss enforces samples across categories away ignores similarity within class coco loss replace weights classiﬁcation layer softmax clearly deﬁned learnable cluster centroid center loss similar ours. however needs external figure visualization method pipa test set. given image input predicted nearest neighbour feature space text shown identity input determined label neighbour. model handle complex scenes non-frontal faces body occlusion. last columns show failure cases. table ablation study body regions feature alignment using softmax loss. report classiﬁcation accuracy denotes non-alignment case indicates alignment case. note face region evaluate instances faces. experiments setup dataset evaluation metric. people photo albums dataset adopted evaluation. pipa dataset divided train validation test leftover sets head instance annotated sets. test split subsets namely test test roughly number instances. division called original split. training used learning feature representations; recognition system trained test evaluated test work mentioned previously take full advantage training remove second training test moreover introduced three challenging splits including album time day. case emphasizes different temporal distance between subsets. evaluation metric averaged classiﬁcation accuracy instances test weight decay momentum across models. stochastic gradient descent adam optimizer note training patch region identity cropped input image speciﬁc person resized extent longer dimension head ﬁxed across patches ensuring scale different body regions instance same. moreover whole body model simply similarity transformation instead afﬁne operation better performance. component analysis feature alignment different regions. table reports performance using feature alignment different body regions several remarks could observed. first alignment case region performs better large margin non-alignment case veriﬁes motivation patch alignment alleviate inner-class variance stated section second alignment case representative features identify person reside region face followed head upper body whole body last. clue obvious non-alignment case. third notice whole body region accuracy non-alignment case higher alignment case time day. probably improper deﬁnition base points sets. table investigation combination merging similarity score different body regions inference. results split marked bold italic. coco loss applied cases except last softmax loss. cosine distance among positive pairs negative pairs. coco trained model discrepancy interclass inner-class samples test well magniﬁed; whereas softmax trained case distinction obvious. veriﬁes effectiveness coco loss. similarity integration regions. table depicts ablation study combination merging similarity score different body regions inference. generally speaking taking regions consideration could also employs multi-region processing step include comparison table splits model superior whereas splits inferior probably distribution imbalance among splits upper body region differs greatly appearance instances absent region making coco hard learn features. however score integration scheme ﬁnal merged prediction complement features learned among different regions achieves better performance comparison state-of-the-arts table recognition system outperforms previous state-of-the-arts piper naeil four test splits. figure visualizes examples predicted instances model complex scenes non-frontal faces body occlusion handled properly scenarios. failure cases probably almost-the-same appearance conﬁguration scenarios. conclusion work propose person recognition method identify person four models different body regions trained. region patches aligned afﬁne transformation make model less prone overﬁtting. moreover training procedure employs coco loss reduce inner-class variance well enlarge interclass varation. pipeline requires one-time training model; utilize similarity text text determine person’s identity inference. experiments show proposed method outperforms state-of-the-arts pipa dataset. acknowledgements would like thank reviewers helpful comments; hasnat weiyang feng method discussion paper clariﬁcation initial release. ﬁnancially supported hong kong ph.d fellowship scheme.", "year": 2017}