{"title": "Deep Learning for Physical Processes: Incorporating Prior Scientific  Knowledge", "tag": ["cs.AI", "cs.LG", "stat.ML"], "abstract": "We consider the use of Deep Learning methods for modeling complex phenomena like those occurring in natural physical processes. With the large amount of data gathered on these phenomena the data intensive paradigm could begin to challenge more traditional approaches elaborated over the years in fields like maths or physics. However, despite considerable successes in a variety of application domains, the machine learning field is not yet ready to handle the level of complexity required by such problems. Using an example application, namely Sea Surface Temperature Prediction, we show how general background knowledge gained from physics could be used as a guideline for designing efficient Deep Learning models. In order to motivate the approach and to assess its generality we demonstrate a formal link between the solution of a class of differential equations underlying a large family of physical phenomena and the proposed model. Experiments and comparison with series of baselines including a state of the art numerical approach is then provided.", "text": "consider deep learning methods modeling complex phenomena like occurring natural physical processes. large amount data gathered phenomena data intensive paradigm could begin challenge traditional approaches elaborated years ﬁelds like maths physics. however despite considerable successes variety application domains machine learning ﬁeld ready handle level complexity required problems. using example application namely surface temperature prediction show general background knowledge gained physics could used guideline designing efﬁcient deep learning models. order motivate approach assess generality demonstrate formal link solution class differential equations underlying large family physical phenomena proposed model. experiments comparison series baselines including state numerical approach provided. physical process sustained phenomenon marked gradual changes series states occurring physical world. physicists environmental scientists attempt model processes principled analytic descriptions scientist’s prior knowledge underlying processes. conservation laws physical principles phenomenological behaviors generally formalized using differential equations. physical paradigm been still main framework modeling complex natural phenomena like e.g. involved climate. availability large datasets captured different types sensors physical modeling paradigm challenged statistical machine learning paradigm offers prior-agnostic approach. however despite impressive successes variety domains demonstrated deployment deep learning methods ﬁelds vision language speech statistical approach ready challenge physical paradigm modeling complex natural phenomena least demonstrated challenge ﬁeld emerging research direction community. believe knowledge techniques accumulated modeling physical processes well developed ﬁelds maths physics could useful guideline design efﬁcient learning systems conversely paradigm could open directions modeling complex phenomena. paper raise issues modern techniques ready used model complex physical phenomena general knowledge gained physical modeling paradigm could help designing efﬁcient models. work tackle questions considering speciﬁc physical modeling problem forecasting surface temperature plays signiﬁcant role analyzing assessing dynamics weather biological systems. accurately modeling predicting dynamics critical various applications weather forecasting planning coastal activities. since weather satellites made huge quantities high resolution data available standard physical methods forecasting coupled ocean-atmosphere prediction systems based navier stokes equations. models rely multiple physical hypotheses optimally exploit information available data. hand despite availability large amounts data direct applications methods lead competitive state results seen section typical representative problem intermediate complexity. goal offer solution problem illustration advancing challenges mentioned above. handle problem general enough transfered general class transport problems. propose deep neural network model inspired general physical motivations offers approach solving family problems. ﬁrst motivate approach introducing section solution general class partial differential equations core component large family transport propagation phenomena physics. general solution used guideline introducing deep learning architecture prediction described section experiments comparison series baselines introduced section review related work ﬁnally presented section main contributions work example showing incorporate general physical background designing aimed modeling relatively complex prediction task. believe approach general enough used family transport problems obeying general advection-diffusion principles. formal links model’s prediction solution general advection diffusion unsupervised model estimating motion ﬁelds given sequence images. proof relatively complex physical modeling problem full data intensive approaches based deep architectures competitive state dedicated numerical methods. forecasting consists predicting future temperature maps using past records. temperatures acquired satellite imagery. focus speciﬁc area formulate problem prediction future temperature images area using past images. classical approach forecasting consists using numerical models representing prior knowledge conservation laws physical principles take form pdes. models coupled data using assimilation techniques order adjust initial conditions. integrated forward time predict evolution. surface temperature variation related ﬂuid transport problem. ﬂuids transport occurs combination principles advection diffusion. advection ﬂuid transports conserved quantity material bulk motion i.e.for small variations conservation expressed applying ﬁrst order approximation right hand side moving resulting terms left hand side equation obtain advection equation known also brightness constancy constraint equation equation describes denotes gradient operator motion vector temporal evolution quantity displacement note equation also basis many variational methods optical flow. retrieve motion numerical schemes applied resulting system equations along additional constraint solved motion used forecast future value advection alone sufﬁcient explain evolution many physical processes diffusion corresponds movement spreads quantity areas high concentration areas concentration. advection diffusion considered together. following equation describes transport quantity advection diffusion denotes laplacian operator diffusion coefﬁcient. note recover advection equation equation describes large family physical processes state result characterizing general solutions equation equation provides principled calculate time using initial condition provided motion diffusion coefﬁcient known. states quantity computed initial condition convolution gaussian probability density function. words used model evolution surface’s underlying advecting mechanisms known future surface temperatures could predicted previous ones. unfortunately neither initial conditions motion vectors diffusion coefﬁcient known. estimated data. inspired general form solution propose method expressed deep learning architecture predicting sst. model learn predict motion ﬁeld analog equation used predict future images. figure motion estimated input images convolutional neural network. warping scheme displaces last input image along motion estimate produce future image. error signal calculated using target future image backprogated warping scheme correct cnn. produce multiple time-step forecasts predicted image back autoregressive manner. model consists main components illustrated figure predicts motion ﬁeld sequence past input images convolutional-deconvolutional module ﬁgure warps last input image using motion ﬁeld ﬁrst component order produce image forecast. entire system trained end-to-end fashion using supervision target image. able produce interpretable latent state corresponds problem velocity ﬁeld advecting temperatures. ﬁrst introduce notations. image acquired bounded rectangle named denote surface temperature two-dimensional motion motion vector ﬁeld time deﬁned respectively. time position available context drop subscript along clarity. given sequence consecutive images {it−k− goal predict next image it+. indicated section provided underlying motion ﬁeld known compute forecasts. introduce motion ﬁeld estimated architecture. looking vector ﬁeld applied geometric space renders close i.e. known could estimate precisely looking for. instead choose convolutional-deconvolutional architecture predict motion vector pixel. shown ﬁgure network makes skip connections allowing grained information ﬁrst layers direct manner. batch normalization layer convolution leaky relu non-linearities convolutions transposed-convolutions. used concatenated images it−k−t input training. selected architecture experimentally testing different state-of-the-art convolution-deconvolution network architectures. r×w×h output network width height images respectively. generally case problem direct supervision motion vector ﬁeld since target motion usually available. using warping scheme introduced below nonetheless able supervise based discrepancy warped version image target image it+. figure warping scheme. calculate pixel value time position ﬁrst compute previous position time i.e. center gaussian position order obtain weight value pixel based distance compute weighted average pixel values weighted average correspond pixel value it+. discretizing solution advection-diffusion equation section replacing integral setting image initial condition obtain method calculate future image based motion ﬁeld estimate latter used warping scheme d∆tx− ˆw−y radial basis function kernel equation parameterized diffusion coefﬁcient time step value calculate temperature time position compute scalar product gaussian centered previous image simply weighted average temperatures weight values larger pixel’s positions closer informally corresponds pixel’s previous position time ﬁgure seen relation solution advection-diffusion equation proposed warping mechanism clearly adapted modeling phenomena governed advection-diffusion equation. forecasting particular case proposed scheme used problem problems advection diffusion occurring. moreover warping scheme entirely differentiable allowing backpropagation error signal motion estimating module. warping mechanism inspired spatial transformer network originally designed incorporated layer convolutional neural network architecture order gain invariance geometric transformations. using notations inverse geometric transformation grid generator step kernels sampling step kernels recover warping scheme. latter seen speciﬁc case without localization step. result theoretically grounds optical flow many recent articles equation recover brightness constancy constraint equation used latter. training supervision provided output warping module. consists minimizing discrepancy warped image ˆit+ target image it+. loss measured differentiable function gradient back propagated warping function order adjust parameters convolutional-deconvolutional module generating vector ﬁeld. detailed next section. iteration model aims forecasting next observation given previous ones. evaluate discrepancy warped image ˆit+ target image using charbonnier penalty function parameters set. note recover loss. charbonnier penalty function known reduce inﬂuence outliers compared norm. tested laplacian pyramid loss enforce convolutions deconvolutional layers close down-sampled versions target image charbonnier penalty sense observed overall decrease generalization performance. proposed model designed according intuition gained general background knowledge physical phenomenon advection-diffusion equations. additional prior knowledge expressed partial differential equations constraints easily incorporated model adding penalty terms loss function. displacement explicitly part model strength model capacity apply regularization term directly motion ﬁeld. experiments tested inﬂuence different terms divergence magnitude smoothness ∇wt. data assimilation techniques sometimes weighted penalties control rotation divergence ﬁelds example. evaluate inﬂuence terms experiments section. objective function used train model written since high resolution data made available noaa weather satellite dealing directly data requires preprocessing order avoid complications beyond scope work used synthetic realistic data atlantic ocean generated sophisticated simulation engine nemo engine nemo state-of-the-art modelling framework ocean related engines. primitive equation model adapted regional global ocean circulation problems. historical data accumulated model generate synthesized estimate states system using data reanalysis speciﬁc data assimilation scheme means data follow true temperatures. resulting dataset constituted daily temperature acquisitions pixels extract pixel sized sub-regions indicated ﬁgure data years training validation years testing. withhold training data validation selected uniformly random beginning experiment. tests used sub-regions enumerated ﬁgure interactions cold waters make dynamics interesting study. regions numbered ﬁgure used training sequence images used training evaluation corresponds speciﬁc numbered sub-region. make simplifying hypothesis data single sub-region contains enough information forecast future sub-region. forecast small temporal horizon assume inﬂuence outside region small enough. standardise daily acquisitions region using mean standard deviation data region acquired year i.e. acquisition region date september standardized using data september available dataset sub-region. removes seasonal component data. mse). hyperparameters tuned using validation set. neural network based models titan runtime given comparison purpose. concerning constraints vector ﬁeld regularization coefﬁcients selected validation λdiv λmagn λgrad also compare results model without regularization. reference model forecasting numerical assimilation model relies data assimilation. ocean’s dynamics modeled using shallow water equations initial conditions along terms estimated using assimilation techniques state assimilation model predicting ocean dynamics sst. baselines autoregressive convolutional-deconvolutional architecture similar cdnn module trained predict future image directly without explicitly representing motion vector ﬁeld. past observation used input channel output used input multi step forecasting convlstm model uses convolutional transitions inner lstm module model multi-scale acnn trained generative adversial network used non-ofﬁcial code made available https //github.com/dyelax/adversarial_video_generation. code provided authors paper. implemented acnn convlstm models ourselves. code models along baselines made available. table average score average time test data. average score calculated using mean square error metric time seconds. regularization coefﬁcients model using validation λdiv λmagn λgrad quantitatively model performs well. score better baselines. closest baseline regularizes regression convolution-deconvolution model gan. performance however clearly proposed model allow easily incorporate prior constraints inspired physics phenomenon. acnn direct predictor image sequence implemented cdnn module identical used model. performance poor. clearly straightforward prediction models adapted complexity phenomenon. convlstm performs better opposed acnn seems able capture dynamic although accurately. overall direct prediction models able capture complex underlying dynamics produce blurry sequences images. explicitly forces network output eliminate blurring effect makes able capture short term dynamics. state numerical model performs well lower performance regularized model although incorporates prior constraints. shows pure models conceived adequately trained enough data competitive state dedicated models. regularizing motion vector notably increases performance w.r.t. unregularized model. choice constraints inspired physical background correspond relevant priors dynamics model. running time proposed model extremely fast convlstm model running time model comparable others. others titan gpu. however optimization procedure required estimate motion ﬁeld clearly slower straightforward predictions. moreover order prevent numerical scheme diverging multiple intermediate forecasts required. besides need analyze prediction samples qualitatively. figure shows predictions obtained different models. ground truth sequence temperature images corresponding time second corresponds regularized model prediction times model seems conserve temperatures. prediction close target starts move away time third shows motion estimated model. color images corresponds motion vector. clearly strong evolving dynamic captured sequence. numerical assimilation model also clearly captures dynamics shows interesting patterns tends diverge prediction horizon increases. acnn model rapidly produces blurry images; preserve temperatures seem capture dynamics. shows predictions convlstm model. temperature preserved although dynamic captured correspond target. overall proposed model seems forecast quite accurately retrieving coherent motion vector ﬁeld. physical modeling close work ﬁeld spatio-temporal statistics. reference book also advocate physical background knowledge build statistical models. show design statistical models inspired partial differential equations linked observed physical phenomenon. mainly consider autoregressive models within hierarchical bayesian framework. another interesting research direction reducing complexity numerical simulation physical processes. generally approaches statistical models used place computational demanding component numerical simulation process. example domain ﬂuid dynamics propose regressors simulating ﬂuid smoke animation. random forest compute particle location approximate part numerical scheme. approaches component numerical simulation scheme whereas modeling whole physical process deep learning approach. farther objective make sparse regression method discovering governing partial differential equation given system time series measurements spatial domain. work also related recent developments computer vision related distinct ﬁelds video prediction motion estimation videos. goal domain application clearly different video modeling since solution involves predicting motion ﬁeld next image solutions share similarities. motion estimation video predictions deep architectures motivated series work last years. brieﬂy review outline differences. optical flow optical consists retrieving apparent motion objects surfaces particles consecutive frames video. extracted motion used many areas object detection object tracking movement detection robot navigation visual odometry. vision community considered problem several papers dedicated topic. classical methods rely brightness constancy constrain equation derived observation surfaces usually persist time hence intensity value small region remains despite position change since using bcce directly leads complicated optimizing issues classic approaches namely differential methods approximate bcce using ﬁrst order taylor expansion develop variational methods. alternative methods deep learning models recently proposed estimating optical images. formulate optical supervised regression problem using predict motion. build approach propose ensemble architectures. assess results state methods optical maintaining small computational overhead. difﬁculty methods require notable quantity target data i.e. optical images complexity manually annotating images small annotated collections available. chose pretrain model synthetic dataset made computer animations associated motion show information transfers well real videos. demonstrate possible predict optical input images unsupervised using spatial transformer network. however extensible prediction done setting since requires images input available inference time prediction. video prediction recently video prediction emerged task deep learning community. task people generally interested predicting accurately displacement/ emergence/ disappearing objects video. application goal clearly different since interested modeling whole dynamics behind image changes following moving objects. ﬁrst introduce methods perform prediction computing optical similar transformation. form motion estimation. next frame prediction introduce module hidden layer lstm order estimate motion ﬁeld latent space. resulting image decoded original image space prediction. approach clearly allow introducing prior knowledge ﬁeld vector done work. learn afﬁne transformations image parts order predict object displacement proposed similar model. consider models directly attempt predict next frame without estimating motion ﬁeld. shown experimental section plain application autoregressive models produces blurred images. baseline proposed different loss functions regularization cdnn predictor sharper higher quality predictions. signiﬁcant improvements obtained video pixel network sophisticated architecture composed resolution preserving encoders lstm pixelcnn decoders form conditional spatio-temporal video autoencoder differentiable memory. model probably state today video prediction reach high accuracy moving mnist good performance robot video dataset. drawback complexity model number parameters using respectively frames datasets. test model since knowledge code available. data intensive paradigm offers alternative directions classical physical approaches modeling complex natural processes. belief cross fertilization paradigms essential pushing frontier complex data modeling. using example application problem intermediate complexity concerning ocean dynamics proposed principled design deep learning models using inspiration physics. proposed approach easily generalized class problems underlying dynamics follow advectiondiffusion principles. compared proposed approach series baselines. able reach performance comparable state numerical model clearly outperforms alternative models used baselines. references dominique béréziat isabelle herlin. coupling dynamic equations satellite images modelling ocean surface circulation pages springer international publishing cham isbn ----. ./----_. https//doi. org/./----_. bernstein. surface temperature estimation using noaa satellite advanced high resolution radiometer. journal geophysical research oceans issn ./jcicp. http//dx.doi.org/./ jcicp. philipp fischer alexey dosovitskiy eddy philip häusser caner hazirbas vladimir golkov patrick smagt daniel cremers thomas brox. flownet learning optical convolutional networks. corr abs/. http//arxiv.org/abs/. eddy nikolaus mayer tonmoy saikia margret keuper alexey dosovitskiy thomas brox. flownet evolution optical estimation deep networks. corr abs/. http//arxiv.org/abs/.. kalchbrenner aäron oord karen simonyan danihelka oriol vinyals alex graves koray kavukcuoglu. video pixel networks. corr abs/. http//arxiv.org/abs/.. l’ubor ladický sohyeon jeong barbara solenthaler marc pollefeys markus gross. datadriven ﬂuid simulations using regression forests. trans. graph. october issn ./.. http//doi.acm.org/./ haibin ling okada. diffusion distance histogram comparison. ieee computer society conference computer vision pattern recognition volume pages june ./cvpr... samuel rudy steven brunton joshua proctor nathan kutz. data-driven discovery partial differential equations. science advances http//arxiv. org/abs/.. xingjian zhourong chen wang dit-yan yeung wai-kin wong wang-chun woo. convolutional lstm network machine learning approach precipitation nowcasting. corr abs/. http//arxiv.org/abs/.. jonathan tompson kristofer schlachter pablo sprechmann perlin. accelerating eulerian ﬂuid simulation convolutional networks. doina precup whye editors proceedings international conference machine learning volume proceedings machine learning research pages international convention centre sydney australia pmlr. http//proceedings.mlr.press/v/tompsona.html. joost amersfoort anitha kannan marc’aurelio ranzato arthur szlam tran soumith chintala. transformation-based models video sequences. corr abs/. pages http//arxiv.org/abs/.. jason adam harley konstantinos derpanis. back basics unsupervised learning optical flow brightness constancy motion smoothness pages springer international publishing cham isbn ----. ./----_. https//doi.org/./----_. proof. following bold denote vectors correspond ﬁrst second components respectively. analogously correspond components fourier transformation deﬁned apply fourier transform sides consequence linearity fourier transform calculate decompose fourier transform left hand side transforms term. three terms denotes initial condition advection diffusion equation frequency domain. order obtain solution spatial domain calculate inverse fourier transform multiplication functions frequency domain equivalent convolution spatial domain i.e. hence inverse terms e−i<ξw>t e−dtξ calculated separately", "year": 2017}