{"title": "Meta-QSAR: a large-scale application of meta-learning to drug design and  discovery", "tag": ["cs.AI", "cs.LG", "I.2"], "abstract": "We investigate the learning of quantitative structure activity relationships (QSARs) as a case-study of meta-learning. This application area is of the highest societal importance, as it is a key step in the development of new medicines. The standard QSAR learning problem is: given a target (usually a protein) and a set of chemical compounds (small molecules) with associated bioactivities (e.g. inhibition of the target), learn a predictive mapping from molecular representation to activity. Although almost every type of machine learning method has been applied to QSAR learning there is no agreed single best way of learning QSARs, and therefore the problem area is well-suited to meta-learning. We first carried out the most comprehensive ever comparison of machine learning methods for QSAR learning: 18 regression methods, 6 molecular representations, applied to more than 2,700 QSAR problems. (These results have been made publicly available on OpenML and represent a valuable resource for testing novel meta-learning methods.) We then investigated the utility of algorithm selection for QSAR problems. We found that this meta-learning approach outperformed the best individual QSAR learning method (random forests using a molecular fingerprint representation) by up to 13%, on average. We conclude that meta-learning outperforms base-learning methods for QSAR learning, and as this investigation is one of the most extensive ever comparisons of base and meta-learning methods ever made, it provides evidence for the general effectiveness of meta-learning over base-learning.", "text": "abstract investigate learning quantitative structure activity relationships case-study meta-learning. application area highest societal importance step development medicines. standard qsar learning problem given target chemical compounds associated bioactivities learn predictive mapping molecular representation activity. although almost every type machine learning method applied qsar learning agreed single best learning qsars therefore problem area well-suited meta-learning. ﬁrst carried comprehensive ever comparison machine learning methods qsar learning regression methods molecular representations applied qsar problems. investigated utility algorithm selection qsar problems. found meta-learning approach signiﬁcantly outperformed best individual qsar learning method ﬁngerprint representation). conclude meta-learning outperforms base-learning methods qsar learning investigation extensive ever comparisons base meta-learning methods ever made provides evidence general eﬀectiveness meta-learning base-learning. standard approach predicting active chemical compound given target development medicines machine learning models. currently agreed single best learning algorithm this. paper investigate utility meta-learning address problem. discover exploit relationships machine learning algorithms measurable properties input data empirical performance learning algorithms infer best models predict activity chemical compounds given target. drug development important applications science essential step treatment almost diseases. developing drug however slow expensive. average cost bring drug market billion dollars means tropical diseases malaria schistosomiasis chagas’ disease etc. kill millions people infect hundreds millions others ‘neglected’ ‘orphan’ diseases remain untreatable generally pharmaceutical industry struggling cope spiralling drug discovery development costs drug development also slow generally taking years. means strong pressure speed development save lives reduce costs. successful drug earn billions dollars year patent protection time-limited even extra week patent protection great ﬁnancial signiﬁcance. step drug development learning quantitative structure activity relationships functions predict compound’s bioactivity structure. standard qsar learning problem given target chemical compounds machine learning methods currently used qsar learning. knowledge feed better understanding performance characteristics algorithms enable qsar practitioners improve predictions. better understand real-world meta-learning case-study important application area qsar learning. application area excellent test-bed meta-learning methodologies. importance subject area means thousands publicly available qsar datasets basic structure. machine learning application areas many datasets enabling statistical conﬁdence meta-learning results. investigating meta-learning focused algorithm selection simplest form meta-learning desire better understand baseline-learning methods. ﬁnal motivation work improve predictive performance qsar learning meta-learning. hope improved predictive performance feed faster cheaper drug development. meta-learning used extensively select appropriate learning algorithm given dataset. section ﬁrst sketch general framework algorithm selection provide overview prior approaches state-of-the-art selecting algorithms using meta-learning. algorithm selection framework contains four main components first construct problem space case space qsar datasets. dataset expresses properties activity limited molecular compounds speciﬁc target protein. paper consider qsar datasets described detail section second describe qsar dataset measurable characteristics yielding feature space paper include types meta-features describe qsar data describe properties target protein expect properties aﬀect interplay diﬀerent qsar features hence choice learning algorithm. full meta-features used paper described section third algorithm space created candidate baselevel learning algorithms case regression algorithms combined several preprocessing steps. described section current state-of-the-art exists wide variety algorithm selection algorithms. single algorithm train classiﬁcation model makes exactly prediction also regression algorithm predict performance algorithm build ranking promising algorithms cost-sensitive techniques allow optimize loss really care meta-learning approaches classiﬁcation problem learn model captures relationship properties qsar datasets meta-data performance regression algorithms. model used predict suitable algorithm dataset. ranking problem model ranks qsar combinations predicted performances. characteristics data. discriminative power meaning able distinguish base-learners terms performance computational complexity preferably lower meta-features typically categorised following simple statistical information theoretic extensive description meta-features. subset used regression measures speciﬁcally deﬁned regression targets meta-features trivially adapted regression data. first landmarking works training evaluating sets simple fast algorithms datasets using performance meta-features dataset. analysis landmarkers regression problems found another approach model-based characteristics obtained building fast interpretable models e.g. decision trees extracting properties models width depth number leaves tree statistical properties distribution nodes level tree branch lengths occurrences features splitting tests nodes. recent research ﬁnding interesting ways measure data characteristics includes instance-level complexity measures unsupervised learning discretized meta-features selecting algorithms. meta-learning algorithm selection traditionally seen learning problem train meta-learner predicts best algorithm given meta-features describing data. setting selecting best single algorithm experiments artiﬁcial datasets showed single best meta-learner decision tree-like algorithms seem edge especially used combination landmarkers experiments performed real-world data corroborated results although also show meta-learners sensitive exact combination meta-features used setting recommending subset algorithms shown that using statistical information-theoretical meta-features boosted decision trees obtained best results relational case-based reasoning also successfully applied relevant paper work amasyali ersoy uses around meta-features select best regression algorithm range artiﬁcial benchmarking drug discovery datasets. reported correlations meta-features algorithm performances typically artiﬁcial benchmarking datasets much worse drug discovery datasets. feature improve meta-learning performance. ranking algorithms another approach build ranking algorithms listing algorithms ﬁrst. several techniques k-nearest neighbors compute average rank similar prior datasets approaches directly estimate performances algorithms predictive clustering trees better results obtained subsampling landmarkers i.e. running candidate algorithms several small samples data meta-learning data samples builds idea ﬁrst determining complete learning curves number learning algorithms several diﬀerent datasets. then dataset progressive subsampling done certain point creating partial learning curve matched nearest complete learning curve algorithm order predict ﬁnal performances entire dataset. another approach sequentially evaluate algorithms dataset learn results. active testing proceeds tournament-style fashion round selects tests algorithm likely outperform current best algorithm based history prior duels algorithms similar datasets. test contribute information better estimate dataset similarity thus help better predict algorithms promising dataset. large-scale experiments show active testing outperforms previous approaches yields algorithm whose performance close optimum relatively tests. recent work aims speed active testing combining learning curves candidates algorithms need trained smaller sample data. also uses multi-objective criterion called trades runtime accuracy fast reasonably accurate candidates evaluated ﬁrst. experimental results show method converges extremely fast acceptable solution. finally algorithms also ranked using collaborative ﬁltering approach previous algorithm evaluations used ‘ratings’ given dataset. dataset algorithms would likely perform well selected based collaborative ﬁltering models model-based optimization model-based optimization aims select best algorithm and/or best hyperparameter settings given dataset sequentially evaluating full dataset. learns prior experiments building surrogate model predicts algorithms parameters likely perform well. approach proven work well practice bayesian optimization builds surrogate model predict expected performance candidate conﬁgurations well uncertainty prediction. order select next candidate evaluate acquisition function used trades exploitation versus exploration bayesian optimization used auto-weka auto-sklearn search optimal algorithms hyperparameters across weka scikit-learn environments respectively. given technique computationally expensive recent research tried include meta-learning good solution faster. approach good initial candidate conﬁgurations using meta-learning based meta-features similar datasets optimal algorithms parameter settings datasets initial candidates evaluate. eﬀect provides ‘warm start’ yields better results faster. almost every form statistical machine learning method applied learning qsars linear regression decision trees neural networks nearestneighbour methods support vector machines bayesian networks relational learning etc. methods diﬀer mainly priori assumptions make learning task. focus regression algorithms qsar problems normally cast. meta-qsar learning input data datasets compound activity diﬀerent representations structures compounds learn predict well diﬀerent learning algorithms perform exploit predictions improve qsar predictions. expect meta-learning successful qsar although datasets overall structure diﬀer numbers data points range occurrence features type chemical/biochemical mechanism causes bioactivity. diﬀerences indicate diﬀerent machine learning methods used diﬀerent kinds qsar data. ﬁrst applied meta-learning predict machine learning algorithm expected perform best given qsar dataset. known algorithm selection problem expressed formally using rice’s framework algorithm selection illustrated figure applied multi-task learning ﬁrst test whether improve standard qsar learning exploitation evolutionary related targets whether multi-task learning improved incorporating evolutionary distance targets. remainder paper organized follows. section report baseline experiments investigating eﬀectiveness large number regression algorithms thousands qsar datasets using diﬀerent data representations. section describe novel qsar-speciﬁc metafeatures inform meta-learning approach. section investigate utility meta-learning selecting best algorithm learning qsars. finally section presents discussion results future work. ﬁrst performed experiments baseline regression algorithms investigate eﬀectiveness qsar problems. learning qsar model consists ﬁtting regression model dataset instances chemical compounds input variables chemical compound descriptors numeric response variable associated bioactivities. baseline qsar methods selected regression algorithms including linear support vector machines artiﬁcial neural networks algorithms used respective parameter settings. within scope study optimize parameter settings every dataset instead chose values likely perform well qsar datasets. list includes commonly used qsar methods literature. k-nearest neighbor adaptive regression splines regularized penalized ridge regression multiple linear regression principal component regression partial least squares response surface regression relevance vector machine table list baseline qsar algorithms. abbreviations trees number trees; split minimum node size allowed splitting; bucket minimum size bucket. number neighbours; depth search depth; cross-validation; node minimum number observations node; radial basis function epsilon parameters; size number neurons hidden layer; inputs length input vector. many years qsar research held back lack openly available datasets. situation transformed number developments. important open availability chembl database medicinal chemistry database managed european bioinformatics institute abstracted curated scientiﬁc literature covers signiﬁcant fraction medicinal chemistry corpus. data consist information drug targets structures tested compounds bioactivities compounds targets binding constants pharmacology toxicity. advantages using chembl meta-qsar covers large number targets diversity chemical space investigated high quality interaction data. main weakness single target interaction data relatively small number compounds given. extracted targets chembl diverse number chemical compounds ranging target resulting dataset many examples compounds. target variable contains associated bioactivities. bioactivity data selected basis target type protein thereby excluding potential targets cell-based vivo assays activity type deﬁned list potency/aﬃnity endpoints small proportion cases multiple activities reported particular compound-target pair consensus value selected median activities falling modal unit. simpliﬁed molecular-input line-entry system representation molecules used calculate molecular properties molecular weight logarithm partition coeﬃcient topological polar surface area etc. used dragon version commercially available software library potentially calculate molecular descriptors depending availability structural list available dragon’s website. chembl records molecular structures only restricted estimating maximum molecular descriptors. decided generate datasets using permitted molecular descriptors features extract subset dragon identiﬁes basic constitutional descriptors. call representations ‘allmolprop’ ‘basicmolprop’ respectively. molecules dragon failed compute descriptors possibly malformed structures treated missing values. avoid favouring qsar algorithms able deal missing values decided impute them preprocessing step using median value corresponding feature. addition calculated fcfp ﬁngerprint representation using pipeline pilot software biovia ﬁngerprint representation commonly used qsar learning whereby presence absence particular molecular substructure molecule indicated boolean variable. fcfp ﬁngerprint implementation generates boolean variables. call dataset representation ‘fpfcfp’. fpfcfp datasets complete missing value imputation step necessary. summary types feature representations level preprocessing thus generating diﬀerent dataset representations qsar problems table produced total datasets targets. used parameter settings mentioned table experiments. figure summarizes overall relative performance qsar methods dataset representations previously mentioned table results showed random forest best performer targets followed targets glm-net targets. results best performer algorithm lowest rmse even wins small margin. terms dataset representation turned datasets formed using fcfp ﬁngerprints yielded consistently better models rest datasets results displayed figure combinations qsars representations also ranked average performances. this estimated average rmse ratio score adapted originally introduced classiﬁcation tasks. score formulated follows represents number algorithms whilst number targets. notice that seri indicates algorithm outperformed algorithm ranking results using armser presented figure friedman test corresponding pairwise post-hoc test non-parametric equivalent anova order verify whether performances baseline qsar strategies statistically diﬀerent. friedman test ranks strategies used dataset according performance tests null hypothesis equivalent. post-hoc test carried null hypothesis rejected. used nemenyi test also suggested fig. plot displays post-hoc test results ranked best performer qsar strategies rforest.fpfcfp ksvm.fpfcfp ksvmfp.fpfcfp rforest.allmolprop.miss glmnet.fpfcfp rforest.basicmolprop.miss.fs. statistically signiﬁcant comparisons represented green boxes. aforementioned post-hoc test qsar strategies presented figure results shown figure shows performance diﬀerences qsar strategies statistically signiﬁcant exception rforest.allmolprop.miss ksvmfp.fpfcfp. meta-learning analysis requires meta-features. meta-qsar study used measurable characteristics considered base study datasets drug target properties meta-features. utilised similar approach employed bodo chemical information ontology formal deﬁnitions molecular descriptors used qsar studies developed meta-qsar ontology. meta-qsar ontology provides formal deﬁnitions meta-features used reported meta-qsar study meta-features deﬁned conceptual level meaning ontology contain instance-level values meta-features considered dataset. example meta-feature ’multiple information’ deﬁned meta-feature dataset among random variables dataset) meta-qsar ontology contain values meta-feature dataset. instead contains links code calculate values relevant features. example used package peptides calculate values meta-feature ‘hydrophobicity’. figure shows information captured meta-qsar ontology. description selected meta-features instructions calculation values available online. description multiple information among random variables dataset. mutual information nominal attributes describes reduction uncertainty knowledge leans conditional normalised entropy features class entropy divided number features. average mean features. average standard deviation features. kurtosis response variable. mean response variable. skewness response variable. normalised entropy response variable. standard deviation response. considered datasets range diﬀerent properties e.g. ’number compounds’ dataset ’entropy’ ’skewness’ features ’target meta-feature’ ’mutual information’ ’total correlation’ input output features dataset properties signiﬁcant eﬀect performance explored algorithms used meta-qsar learning. figure shows level inﬂuence diﬀerent categories meta-features. example considerable contribution meta-learning. descriptors dataset properties e.g. ’number instances’ imported data mining optimization ontology also added qsar-speciﬁc dataset descriptors ’aggregated ﬁngerprint’. calculated summing columns normalised number compounds dataset. qsar datasets additionally characterized measurable properties drug target represent ’aliphatic index’ ’sequence length’ ’isoelectric point’ diﬀer description aliphatic index deﬁned relative volume occupied aliphatic side chains regarded positive factor increase thermo stability globular proteins. hydrophobicity association non-polar groups molecules aqueous environment arises tendency water exclude non-polar molecules potential protein interaction index proposed boman calculated solubility values residues sequence molecules aqueous environment arises tendency water exclude non-polar molecules estimated variants hydrophobicity. theoretical charge protein sequence described moore ratio mass molecule uniﬁed atomic mass unit. sometimes called molecular weight relative molar mass value electric charge elementary entity zero. number amino acids protein sequence. instability index proposed protein whose instability index smaller predicted stable value predicts protein unstable. dipeptide composition descriptor captures information fraction local order amino acids. also used drug target groupings ’drug target classes’ ’the preferred name groupings’ meta-features. enable meta-learning exploit known biological/chemical relationships targets indeed target proteins similar make resulting datasets similar too. drug target classes chembl database curators classiﬁed protein targets manually curated family hierarchy. version hierarchy used comprises levels level broadest class level speciﬁc. example protein target ‘tyrosine-protein kinase srms’ classiﬁed follows enzyme kinase protein kinase protein kinase group tyrosine protein kinase family tyrosine protein kinase diﬀerent classes level evolutionarily related another whereas members classes generally share common evolutionary origins. picture mixed hierarchy fully populated greatest emphasis placed target families highest pharmaceutical interest diﬀerent levels hierarchy deﬁned rigorous criteria. however hierarchical classiﬁcation provides useful means grouping related targets diﬀerent levels granularity. preferred name drug targets grouping chembl curators also assigned protein target preferred name robust consistent manner independent various adopted names synonyms used elsewhere. preferred name based practice individual proteins described range diﬀerent identiﬁers textual various data resources. detailed manual descriptions across annotation canonical target names means that part orthologous proteins related species described consistently allowing related proteins grouped together. preferred name groupings obtained drug target groups drug targets. largest drug target group dihydrofolate reductase drug targets. cast classiﬁcation task predict qsar method used particular qsar problem; ranking prediction task rank qsar methods performances. entails number extensions rice’s framework figure dealing multiple dataset representations qsar problem learning algorithm. resulting setup shown figure original qsar problem ﬁrst represented diﬀerent ways resulting datasets qsar target extract dataset-based meta-features well meta-features based target dataset represents space algorithms consists workﬂows generate base-level features regression algorithms resulting workﬂows evaluated fig. meta-learning setup select qsar combinations given qsar dataset. qsar combinations generated combining types representation/preprocessing regression algorithms plus tanimoto ksvm ﬁngerprint representation. training meta-dataset formed using meta-features extracted baseline qsar datasets inputs. classiﬁcation tasks used best qsar strategy target output labels whilst ranking tasks qsar performances used. figure shows schematic representation meta-dataset used meta-learning experiments. ﬁgure shows used meta-features derived dataset drug target properties. size ﬁnal meta-dataset meta-features targets. meta-learning classiﬁcation problem using possible combinations qsar methods dataset representions implemented using random forest trees. given large number classes highly imbalanced classiﬁcation problem also investigated. ranking problem used approaches k-nearest neighbour approach suggested multi-target regression approach. experiments k-nn carried using neighbours. multi-target regression implemented using multivariate random forest regression trees predict qsar performances rank qsar combinations. implementations assessed using -fold cross-validation. algorithm selection experiments applied classiﬁcation problems deﬁned above. results classiﬁcation performances presented figure form classiﬁcation accuracies. observed ﬁgure performances improve number base-learners decreases. also all-classes random forest implementation estimate importance meta-feature classiﬁcation task estimated using mean decrease accuracy. summary results considered meta-feature groups presented figure seen meta-features belonging information theory group relevant although found groups contributed task. mentioned before k-nn multivariate random forest used implement ranking models. used spearman’s rank correlation coeﬃcient compare predicted actual rankings results comparisons shown figure observed ﬁgure multivariate random forest -nearest neighbours implementations predicted better rankings overall. illustrative purpose average predicted rankings multivariate random forest displayed figure fig. violin plots added plots representing mean decrease accuracy meta-features grouped meta-feature groups. notice visualization purpose showing group dataset meta-features separated groups aggregated fingerprints information theory. fig. plots representing computed spearman’s rank correlation coeﬃcient predicted actual rankings. labels horizontal axis indicates multivariate random forest nearest neighbours respectively. suggested qsar combination meta-qsar implementations compared assumed default. case ranking models best suggested qsar combination ranked highest qsar problem. default used random forest ﬁngerprint molecular representation robust reliable performance hence represents strong baseline. results shown figure observed ﬁgure meta-qsar implementations improved overall performance comparison default qsar combination exception -nearest neighbour. results suggest meta-learning successfully used select qsar algorithm/representation pairs perform better best algorithm/representation pair qsars models regression models empirical functions relate quantitative description chemical structure form biological activity purposes informing drug design decision-making. many consider seminal papers hansch origin qsar ﬁeld. since then predictive modelling approaches grown become core part drug discovery process subject still increasing importance attributed alignment number factors including improving availability data advances data-mining methodologies well widespread appreciation avoid many numerous pitfalls building applying qsar models current trends ﬁeld include eﬀorts chemical data curation automation qsar model building exploration alternative descriptors eﬀorts help deﬁne applicability domain given qsar model fig. visual comparison performance distributions default strategy meta-learners using asymmetric bean plots. average rmse implementation represented vertical black lines beans provided guidance encourage good practice qsar modelling. oecd guidelines recommend qsar model deﬁned point; unambiguous algorithm; iii) deﬁned domain applicability; appropriate measures goodness robustness predictivity; mechanistic interpretation possible. however application qsar models drug discovery still fraught diﬃculties least model builder faced myriad options respect choice descriptors machine learning methods. application meta-learning study helps ameliorate issue providing guidance individual method performs best overall well method appropriate given particular circumstances. comparison qsar learning methods involves regression methods molecular representations applied qsar problems making extensive ever comparisons base learning methods reported. moreover qsar datasets source code experiments available openml results easily reproduced. valuable resource work drug discovery foster development meta-learning methods well. indeed experimental details fully available need baseline-learners again research eﬀort focused developing novel meta-learning methods. paper investigated algorithm selection qsar learning. note however many meta-learning approaches could applied would interesting investigate algorithm selection methods algorithm ranking approaches model-based optimization. another alternative framing meta-learning problem would regression algorithm meta-level predict performance various regression algorithms. explore future work. finally would also like explore algorithms selection techniques beyond random forests. plan export experiments openml aslib scenario many algorithm selection techniques could compared. success meta-learning crucially depends large datasets train meta-learning algorithm simply similar prior datasets best solutions could retrieved. work provides datasets several orders magnitude larger available before. often observed machine learning breakthroughs made novel large collections data imagenet instance sparked breakthroughs image recognition deep learning. datasets made available could similar eﬀect accelerating meta-learning research well novel machine learning solutions drug discovery. moreover ﬁrst example possible large collections scientiﬁc data made available readily usable datasets machine learning research. beyond chembl exist many databases life sciences ﬁelds face similar challenges selecting best learning algorithms hence opening interesting avenues meta-learning research. beyond number datasets study pushes meta-learning research several ways. first recent studies focussing regression problems rather classiﬁcation problems. second uses several thousands meta-features much larger reported studies. third considers single learning algorithms also workﬂows consisting preprocessing learning algorithms. ample opportunity future work. instance besides recommending best algorithm could recommend best hyperparameter settings well moreover include several types meta-features landmarkers model-based meta-features could improve performance. finally instead using randomforest meta-learner algorithms could tried well. particularly interesting approach would stacking combine individually learned models larger model exploits varying quantitative predictions representation combinations. however developing system computationally complex applying cross-validation base learners. qsar learning important established applications machine learning. demonstrate meta-learning leveraged build qsar models much better learned base-level regression algorithm. carried comprehensive ever comparison machine learning methods qsar learning regression methods molecular representations applied qsar problems. enabled ﬁrst compare success diﬀerent base-learning methods results meta-learning. found algorithm selection signiﬁcantly outperforms best individual qsar learning method application meta-learning study helps accelerate research drug discovery providing guidance machine learning method appropriate given particular circumstances. moreover represents extensive meta-learning studies ever including datasets several thousands meat-features. success meta-learning qsar learning", "year": 2017}