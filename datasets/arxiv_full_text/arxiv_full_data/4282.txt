{"title": "Data-Driven Dynamic Decision Models", "tag": ["stat.ML", "cs.GT", "cs.MA", "cs.NE"], "abstract": "This article outlines a method for automatically generating models of dynamic decision-making that both have strong predictive power and are interpretable in human terms. This is useful for designing empirically grounded agent-based simulations and for gaining direct insight into observed dynamic processes. We use an efficient model representation and a genetic algorithm-based estimation process to generate simple approximations that explain most of the structure of complex stochastic processes. This method, implemented in C++ and R, scales well to large data sets. We apply our methods to empirical data from human subjects game experiments and international relations. We also demonstrate the method's ability to recover known data-generating processes by simulating data with agent-based models and correctly deriving the underlying decision models for multiple agent models and degrees of stochasticity.", "text": "article outlines method automatically generating models dynamic decision-making strong predictive power interpretable human terms. useful designing empirically grounded agent-based simulations gaining direct insight observed dynamic processes. efﬁcient model representation genetic algorithmbased estimation process generate simple approximations explain structure complex stochastic processes. method implemented scales well large data sets. apply methods empirical data human subjects game experiments international relations. also demonstrate method’s ability recover known datagenerating processes simulating data agent-based models correctly deriving underlying decision models multiple agent models degrees stochasticity. article describes modeling method designed understand data dynamic decisionmaking. created practical easy-to-use software package implementing method. although method broadly applicable motivation model representation prediction individual behavior strategic interactions i.e. games. behavioral game-theoretic treatments repeated games action-learning models specify attractions actions updated agent play progresses action learning models perform poorly predicting behavior games cooperation coordination also often fail account effects changes information player matching conditions paper model repeated game strategies decision-making procedures explicitly consider dynamic nature environment e.g. opponent cooperated last period cooperate period. represent decision-making ﬁnite-state machines genetic algorithm estimate values state transition tables. combination representation optimization allows efﬁciently effectively model dynamic decision-making. traditional game theories deﬁne strategies complete contingent plans specify player every possible state; however environment becomes even moderately complex number possible states world grow beyond limits human cognition modeling response cognitive limitations exogenously restrict complexity repeated game strategies representing moore machines ﬁnite state machines whose outputs depend current state small number states moore machines model bounded rationality explicitly treating procedures decision-making machine modeling agent responding actions agent four-tuple transition function mapping state another agent’s action state generalize model beyond games allowing inputs providing empirical rankings inputs used induce sparsity context-rich environments. moore machine many underlying states single observable action allowing represent arbitrarily complex decision processes. complexity directly controlled number states tuning parameter method optimized algorithm predictive performance. fig. shows examples ﬁnite state machines representing strategies iterated prisoner’s dilemma game possible states cooperate defect initialization current state determined history player opponent cooperating defecting previous period. figure game theoretic strategies represented ﬁnite state machines lower-case letters denote possible outcomes previous period play e.g. means player cooperated opponent defected. genetic algorithms used model agents updating beliefs based endogenously determined variables general equilibrium environment agents learning make economic decisions contrast investigations models agent learning behavior automatically generate interpretable agent decision models empirical data. similar work fogel miller miller page evolved fsms based interactions another simulated games whereas theoretical exercises estimating models explain predict observed interactions among real agents. optimization routines estimation perform well rugged search spaces quickly solve discrete optimization problems natural complement binary string representation fsms easily parallelized. duffy engle-warnick combined empirical experimental data genetic programming model behavior. genetic operations process evolve arbitrary computer programs apply genetic operations representations rather predictor variables functional primitives interested deriving decision models particular structure fsms latent states rather models conditioning observable variables arbitrary functional form. data-driven modeling desirable impose many constraints theoretically justiﬁed functional form model interesting theoretical results related agents interacting games). avoids overﬁtting constraining model functional form likely generalizable across contexts allows genetic selection converge better reduces computational effort required explore parameter space. additional challenge implementing specifying genetic operations function primitives ensuring always produce syntactically valid programs represent meaningful decision models. requires ﬁne-tuning speciﬁc problems avoid designing general method applicable across domains. choice moore machines building blocks decision modeling method ensures estimation produce easily interpretable models latent states represented graphically process represents moore machines grayencoded binary strings consisting action vector followed elements form state matrix savage details fig. build_bitstring decode_action_vec decode_stat_mat functions. genetic operators free reign search global parameter space guided ability predict provided data decoded binary strings. data time series actions taken agents relevant predictors action. result finite state machine highest predictive performance. convergence criteria based number parameters estimate; create initial population step individuals convergence satisﬁed decode individual’s string evaluate predictive performance training data individual’s ﬁtness step improve performance implement evaluation using rcpp package embarrassingly parallel distribute across processor cores. incorporated code package documented function calls using package perform evolution. user generate optimized calling evolve_model data data.frame object columns representing time period decision decision taken period predictor variables. many additional optional arguments evolve_model function sensible default values. package generates code ﬁtness function uses evaluate automatically generated candidate models. convergence criteria iterative search process satisﬁed best identiﬁed predictor variable assessed checking identiﬁability computing importance decision model. return value contains descriptive summary results including shown fig. number states number predictor variables include hyperparameters control complexity model. beginning simplest possible model increasing complexity adding states variables often observe ﬁrst outof-sample predictive accuracy grows bias falls quickly variance rises; eventually adding complexity reduces bias less increases variance accuracy decreases cross-validation training data values hyper-parameters maximize predictive accuracy assess outof-sample predictive accuracy ﬁnal model hold-out test data distinct cross-validation test-sets algorithm increasing complexity optimize predictive accuracy introduces trade-off complex decision models harder interpret human terms best solution depend goals analysis. iterated prisoner’s dilemma often used model cooperation one-shot game unique equilibrium player chooses defect even though players would better cooperated. suppose players play simultaneous-move game fig. observe choice person play simultaneous-move game again. even repeated version cooperation applied procedure data laboratory experiments human subjects playing games real ﬁnancial incentives. gathered integrated data many experiments conducted analyzed bereby-meyer roth duffy ochs kunreuther frechette fudenberg experiments share underlying repeated prisoner’s dilemma structure although details games differed. nay’s data comprises cooperation decisions much larger previous studies repeated game strategies. fudenberg frechette modeled experimental data repeated game strategies; however applied maximum likelihood estimation process estimate prevalence relatively small predeﬁned strategies. contrast estimation process automatically searches large parameter space includes possible strategies given number states require analyst predeﬁne strategies even understand game. used data training reserved hold-out test set. fig. shows different representations ﬁttest two-state machine population evolved training data gray-encoded binary string bitstring decoded state matrix action vector form corresponding graph representation measure variable importance switching value estimated model’s state matrix another value feasible range measuring decrease goodness training data normalizing values summing across column estimate relative importance predictor variable fig. illustrates evolved fig. predicting cooperation decisions training data games. took seconds modest laptop used common algorithm settings population fsms initialized random bitstrings. analyst informed prior belief subjects’ decision models initialize population samples drawn prior distribution paper focuses deriving useful results random initializations corresponding uniform priors analyst provides data. linear-rank selection process used predictive ability individuals select subset population create next generation. single-point crossover process applied binary values selected individuals grayencoded action vector state matrix decoded binary representations. decoded consists columnwise elements index action vector determine action state. bitstring decoded action vector state matrix. action vector corresponds cooperation defection columns state matrix correspond observed behaviors rows correspond state. figure ﬁnite state machine estimated decisions accuracy holdtest data decisions. transitions would accessible strictly deterministic play represented boldface inaccessible transitions italic. human players follow exact deterministic strategies italicized transitions taken simulating model actual game play values transitions identiﬁable. probability uniform random mutation conducted probability ﬁttest individuals survived generation without crossover mutation ensuring potentially good solutions would lost standard parameter settings adjusted convergence taking particularly long given dataset. using theoretical agent-based simulations ﬁtness measure function simulated payoffs axelrod demonstrated ﬁtness tit-for-tat strategy. using ﬁtness measure function ability explain human behavior discovered hybrid grim trigger call noisy grim tft’s state determined solely opponent’s last play. never exit defecting state matter opponent does. traditional repeated game strategies player always takes action corresponding current state noise decisions player sometimes choose opposite action current state possibility arises player opponent cooperate player defecting state would return player cooperating state average random choice strategy accuracy. shaded area difference median population strategies best individual strategy. noisy grim’s predictions hold-out test data accurate gt’s accurate tft’s accurate. also tested repeated game strategies accuracy test ranged method uncovered deterministic dynamic decision model predicts play better existing theoretical automata models play aware interesting relationships well-known models process allowed estimate highly interpretable decision model predicts behavior hundreds human participants merely plugging dataset input. address potential concern process tuned speciﬁc case study inputting different dataset ﬁeld international relations obtaining useful results. however moving empirical data—where data-generating process never fully known—to test robustly estimate known model repeatedly simulate variety known data-generating mechanisms apply method resulting choice data. real world people rarely strategically interact strictly following deterministic strategy whimsy strategic randomization error induce player choose different move dictated strategy. study whether method could determine underlying strategy agent would override time time followed approach fudenberg created agent-based model agents followed deterministic strategies made noisy decisions time period deterministic strategy dictates agent’s preferred action agent choose opposite action probability ranges noise parameter constant across states strategy particular agent given simulation experiment conducted. player follows unknown strategy characterized latent states discovering strategy requires observed data explores much possible state transition matrix deﬁned possible combinations state predictor values many deterministic strategy pairings quickly reach equilibria players repeat moves rest interaction. player opponent make ﬁrst move every subsequent move repeat ﬁrst move. opponent plays ﬁrst time player defects opponent defect rest session data provide little information player’s response cooperation opponent. however opponent plays noise play include many instances cooperation defection opponent thus sample accessible state space player’s strategy thoroughly opponent plays deterministically. indeed fudenberg added noise action choices human subjects experimental games. simulated approximately million interactions varying paired decision models agent also varying noise parameter noise conditions players made equally noisy decisions opponent made noisy decisions player study strictly followed deterministic strategy. replicates experimental conditions iterations game play replicate applied estimation method replicate simulated choice data estimate strategy agent player study using. state/row corresponds player taking action current turn. entries corresponding player taking action current period identiﬁable. entries correspond taking action current period represent transitions cannot occur strictly deterministic play values cannot affect play thus cannot determined empirically. take account testing method’s ability estimate underlying deterministic models elements -element matrix identiﬁed also take account estimating models empirical data data-generating process assumed stochastic element matrix would inaccessible deterministic play identiﬁed ﬁtness calculated effect decision models noise choice ability estimate true model noisy player faces equally noisy opponent. color indicates pair decision models used player opponent. noise probabilities estimated model always exactly matches true model. comparison purely deterministic player facing noisy opponent versus noisy player facing noisy opponent. noise approaches decision model’s impact actual choices vanishes model error rises sharply player’s decisions noisy. figure role noise correctly identifying player’s strategy. points jittered visualization. lines loess-curves. noise represents probability period agent take opposite action decision model. strategies represented element matrix elements identiﬁable values. model error represents number mismatched elements estimated true matrices ranges strategy matrix element changed complement ﬂipping element change ﬁtness complementary strategies indistinguishable element question cannot determined empirically. element decreases ﬁtness ﬂipped strategy corresponds deterministic approximation stochastic process elements state matrix identiﬁed. noise parameter zero models estimated least incorrect elements. however moderate amounts noise models estimated correct noise levels player amount error rose rapidly expected action player chooses moves completely random strategy discover. strictly deterministic player faced noisy opponent correctly identiﬁed player’s strategy noise levels order extend method complex situations predictor variables include time-varying variable relevant agent’s decision. contextfree games predictor variables moves players made previous turn models strategic interactions context-rich environments include relevant variables. difﬁcult interpret graphical models four predictors analyst many potentially relevant predictor variables unable theory alone reduce number predictors sufﬁciently generate easily interpretable models method could take four courses action illustrate extra predictor variables applying method example international relations involving repeated water management-related interactions countries share rivers. data compiled brochmann treaty signing cooperation water quality water quantity ﬂood control generate model predicting whether countries cooperate. used three lagged variables whether water-related conﬂict previous year whether cooperated figure models cooperation water issues sets countries. italicized transitions would feasible outcomes strategy played deterministically realized data. inputs represent cooperation non-cooperation respectively; conﬂict non-conﬂict; signing signing treaty. around water previous year whether signed water-related treaty previous year. data small divide training hold-out subsets assessing predictive accuracy report models’ accuracy reproducing training data two-state decision model accurate three-state model accurate four-state model accurate complexity makes difﬁcult interpret visually shown. accuracy problematic measure classes imbalanced i.e. class model trying predict rare. many alternatives accuracy available illuminate different aspects predictive power. instance precision proportion event signals predicted models correct recall proportion events predicted models. subset dataset cooperate cooperate almost evenly distributed maintain comparison experimental simulated data used accuracy ﬁtness measure. whereas conﬂict without treaty-signing previous year always produces non-cooperation. three-state model three four outcomes include conﬂict lead transition non-cooperation cooperation four outcomes cause transitions cooperation non-cooperation non-conﬂict outcomes. tell something decisive role conﬂict suggests counterintuitive role conﬂict promoting cooperation. brochmann using bivariate probit simultaneous equation model similar ﬁnding aftermath conﬂict states particularly eager solve important issues could cause future problems paper outlined method estimating interpretable models dynamic decision-making. estimating global deterministic simple function given dataset imposing constraints number predictor variables providing options reducing number predictor variables process facilitates capturing signiﬁcant amount information compact useful form. method used designing empirically grounded agent models agentbased simulations gaining direct insight observed behaviors real agents social physical systems. combining state matrices genetic algorithm proven effective simulated data experimental game data observational international relations data. simulated data successfully recovered exact underlying models generated data. real data estimated simple deterministic approximations explain structure unknown underlying process. discovered theoretically interesting dynamic decision model predicted play better existing theoretical models play aware released open-source package implements methods described estimate time series classiﬁcation model uses small number binary predictor variables moves back forth values outcome variable time. larger sets predictor variables reduced smaller sets applying four methods outlined section although predictor variables must binary quantitative variable converted binary division observed values high/low classes. future releases package include additional estimation methods complement optimization.", "year": 2016}