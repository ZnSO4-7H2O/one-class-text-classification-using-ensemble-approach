{"title": "Automatic Renal Segmentation in DCE-MRI using Convolutional Neural  Networks", "tag": ["cs.CV", "stat.ML"], "abstract": "Kidney function evaluation using dynamic contrast-enhanced MRI (DCE-MRI) images could help in diagnosis and treatment of kidney diseases of children. Automatic segmentation of renal parenchyma is an important step in this process. In this paper, we propose a time and memory efficient fully automated segmentation method which achieves high segmentation accuracy with running time in the order of seconds in both normal kidneys and kidneys with hydronephrosis. The proposed method is based on a cascaded application of two 3D convolutional neural networks that employs spatial and temporal information at the same time in order to learn the tasks of localization and segmentation of kidneys, respectively. Segmentation performance is evaluated on both normal and abnormal kidneys with varying levels of hydronephrosis. We achieved a mean dice coefficient of 91.4 and 83.6 for normal and abnormal kidneys of pediatric patients, respectively.", "text": "kidney function evaluation using dynamic contrast-enhanced images could help diagnosis treatment kidney diseases children. automatic segmentation renal parenchyma important step process. paper propose time memory efﬁcient fully automated segmentation method achieves high segmentation accuracy running time order seconds normal kidneys kidneys hydronephrosis. proposed method based cascaded application convolutional neural networks employs spatial temporal information time order learn tasks localization segmentation kidneys respectively. segmentation performance evaluated normal abnormal kidneys varying levels hydronephrosis. achieved mean dice coefﬁcient normal abnormal kidneys pediatric patients respectively. index terms— dce-mri kidney segmentation hydronephrosis refers ﬂuid-ﬁlled enlargement kidney result obstruction output urine. found maternal ultrasound scans children signiﬁcant urological problem. delayed intervention infants severe hydronephrosis lead permanent loss kidney function potential lifelong complications associated chronic renal insufﬁciencies. provide clinically important markers kidney function glomerular ﬁltration rate without exposing patient ionizing radiation. dynamic contrast-enhanced signal analyzed using pharmacokinetic models based computed determining whether patient persistent hydronephrosis referred surgery receive conservative treatment. models time intensity curves kidney parenchyma region calculate single kidney map. accurate segmentation kidney parenchyma important step compute robust reliable measure. manual segmentation take several hours. accurate robust technique automated segmentation kidney parenchyma reduce burden radiologist accelerate translation based technique clinical practice. dce-mr image series include volumetric images acquired different injection. time intensity curves different organs different shapes. temporal information used discriminate kidney parenchyma abdominal organs segmentation process. several automated segmentation techniques proposed renal segmentation using temporal information however patients diseased kidneys methods often fail. software user interface available semiautomated segmentation functional analysis dce-mr images however requires several manual inputs user drawing several initial boundary curves around regions interest. recent studies attempted combine spatial temporal information using series heuristic steps might fail patients pathological kidney approaches relatively longer running times. unlike previous segmentation techniques deep learning algorithms process test data fast running times order seconds. another drawback previous methods usage hand crafted features thresholds fail perform well patients abnormal kidneys enlarged pelvis thinned parenchyma regions. contrast proposed network learns hierarchical representation spatial temporal features training process results improved performance normal abnormal kidneys. work propose fully automated segmentation framework based u-net architecture initially developed microscopy image segmentation. unet ability capture local global information image segmentation task able generalize well small training samples. variations network also shown successful results volumetric medical image segmentation propose segmentation algorithm based version architecture tecture memory efﬁcient requires many parameters learn. considering nature data need reduce data network size context fully convolutional network purpose processing. proposed algorithm divide problem sub-problems localization segmentation solved efﬁciently terms time memory separated out. figure summarizes steps input data size step. used fact localization doesn’t need high resolution image space dimension used downsampled version image localization. high resolution image inside bounding segmented second step. preprocessing details networks used step described section automatic renal parenchyma segmentation dce-mr images. incorporate temporal features channel information voxel. however applying u-net renal segmentation task multiple challenges. first subject large sized data along large sized network parameter ﬁtted limited memory therefore result slow training process. moreover resulting segmentation usually needs reﬁning step dense conditional random ﬁelds using auto-context similar methods reducing false positives makes algorithm time inefﬁcient. thus propose divide problem sub-problems solved efﬁciently terms time memory separated first apply modiﬁed u-net resolution augmented data localizing right left kidneys; second apply u-net extracted kidney region previous step segmentation. sub-problems solved quickly need less memory compared naive approach. total test time seconds patient. dce-mri images pediatric patients acquired minutes injection gadavist using radial stack-of-stars flash sequence retrospectively collected images patients hydronephrosis received part clinical protocol within last years. also recruited patients protocol approved institutional review board speciﬁcally included recruiting subjects receive contrast-enhanced undergo additional research imaging dce-mri. optimized acquisition protocol achieve mean temporal resolution arterial phase remaining phases dynamic image series reconstructed ofﬂine data using compressed sensing algorithm improve temporal resolution image quality effectively reducing streaking artifacts range pediatric patient group months years. ﬁeld view varied patients hydronephrosis according clinical protocol. section describe memory efﬁcient renal segmentation framework automatically segments kidneys given dce-mri input. described section time dimension voxel creates large data tensor subject. hand u-net architecture shown successful many segmentation applications. however version archifig. automated segmentation steps original image segmentation problem divided localization based resolution data. segmentation localized kidney. network used localization task based u-net temporal features mapped channel information dimension network. u-net architecture learns model good generalization performance using small number training samples. however considering data variability described section data augmentation necessary network learn generalize small number training samples. given large memory needed load training data network parameters augmentation choice limited. approach used reduce data size dimensions redundant information present memory size reduced. enabled data augmentation order achieve improved model ﬁtting. downsampled data sufﬁcient resolution required localization nearly isotropic resolution across different dimensions. also reduced time dimension using principle component analysis keep ﬁrst dimensions highest variance. data subject augmented various scales feeded localization network. augmentation details given section localization network based u-net architecture consists contracting expansive path. layer contracting path contains convolution ﬁlters followed rectiﬁed linear drop layers removed. input data network image channels input labels channels foreground/background labels corresponding kidney/non-kidney class. used softmax along weighted cross entropy loss compare network output true segmentation labels. cost minimization epochs performed using adam optimizer learning rate training time network approximately hour workstation nvidia quadro gpu. optimize parameters proposed framework automated segmentation normal abnormal kidneys performed cross validation experiments subjects used precision recall dice coefﬁcient f-score volumetric estimation error evaluating algorithm segmentation performance. f-score harmonic average precision recall reports accuracy overlap predicted true manual segmentation. also report performance model trained using subjects tested kidneys previously unseen subjects included training process. explained section train localization segmentation networks independently using training data manual segmentation masks. segmentation results shown figure normal abnormal kidney example test set. middle ﬁgure showing result bounding detection. predicted output consisted three classes; right kidney left kidney background. extracting three classes initial segmentation masks forming bounding boxes class scaled volumes original time dimension resampled interpolated added data channel information. finally segmentation classiﬁes voxel high resolution image kidney non-kidney class. third ﬁgure showing result segmentation re-positioning kidney back detected bounding box. resulted average performance measures ﬁnal unseen test cases reported table. mean f-scores three patients normal three abnormal kidneys respectively. unit pooling strides down-sampling. expansive path layer consists convolutional transpose strides dimension followed convolutions followed relu. layers equal resolution contracting path concatenated corresponding layers expansive path high-resolution features expansive path. finally convolution reduces number output channels number classes last layer. input data network image channels. used dropout layers maxpooling layer contracting path reduce chance overﬁtting based high resolution features ﬁrst layers. batch normalization also used ﬁnal convolution layer faster convergence less overﬁtting. input labels forming three channels foreground/background labels corresponding class. network discriminates three classes namely right kidney left kidney background. however imbalanced distribution samples kidney classes compared background class. used weighted cross entropy loss order compensate imbalance achieve accurate learning training fully convolutional network. weighted cross entropy loss given log] probability voxel belonging foreground output channel represents true label corresponding input channel. inversely proportional probability voxel belonging foreground class. used softmax weighted cross-entropy loss network output true labels comparison. cost minimization epochs performed using adam optimizer learning rate training time network approximately hour workstation nvidia quadro gpu. trained second network performs segmentation task using bounding boxes manually labeled kidneys training set. kidneys cropped second network training. resampled cropped kidneys common spatial dimension also interpolated resampled time intensity curves subject common temporal resolution common maximum acquisition time minutes. fifty samples minutes acquisition interpolated ensure keeping maximum variance time intensity curves different classes using minimum number samples. segmentation network used framework localization network exception umit yoruk brian hargreaves shreyas vasanawala automatic renal segmentation urography using d-grabcut random forests magnetic resonance medicine olaf ronneberger philipp fischer thomas brox u-net convolutional networks biomedical image segmentation international conference medical image computing computer-assisted intervention. springer ozg¨un ic¸ek ahmed abdulkadir soeren lienkamp thomas brox olaf ronneberger u-net learning dense volumetric segmentation sparse annointernational conference medical imtation computing computer-assisted intervention. springer fausto milletari nassir navab seyed-ahmad ahmadi v-net fully convolutional neural networks volumetric medical image segmentation vision fourth international conference ieee konstantinos kamnitsas christian ledig virginia newcombe joanna simpson andrew kane david menon daniel rueckert glocker efﬁcient multi-scale fully connected accurate brain lesion segmentation medical image analysis vol. patrick ferdinand christ automatic liver lesion segmentation using cascaded fully convolutional neural networks conditional random international conference medical imﬁelds computing computer-assisted intervention. springer seyed sadegh mohseni salehi deniz erdogmus gholipour auto-context convolutional neural network brain extraction magnetic resonance imaging ieee transactions medical imaging feng robert grimm tobias block hersh chandarana sungheon jian leon axel daniel sodickson ricardo otazo golden-angle radial sparse parallel combination compressed sensing parallel imaging golden-angle radial sampling fast ﬂexible dynamic volumetric magnetic resonance medicine vol. work proposed time memory efﬁcient fullyautomated framework segmentation renal parenchyma using dce-mri data. proposed learning based framework consists cascaded cnns localization segmentation kidneys. proposed fully automated algorithm performed well normal abnormal kidneys. frank z¨ollner rosario sance peter rogelj mar´ıa ledesma-carbayo jarle rørvik andr´es santos arvid lundervold assessment dce-mri kidneys using non-rigid image registration segmentation voxel time courses computerized medical imaging graphics vol. b´eatrice chevaillier yannick ponvianne jean-luc collette damien mandry michel claudon olivier pietquin functional semi-automated segmentation renal dce-mri sequences acoustics speech signal processing icassp ieee international conference ieee", "year": 2017}