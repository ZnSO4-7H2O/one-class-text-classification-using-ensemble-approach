{"title": "Deformation estimation of an elastic object by partial observation using  a neural network", "tag": ["cs.CV", "cs.LG", "stat.ML"], "abstract": "Deformation estimation of elastic object assuming an internal organ is important for the computer navigation of surgery. The aim of this study is to estimate the deformation of an entire three-dimensional elastic object using displacement information of very few observation points. A learning approach with a neural network was introduced to estimate the entire deformation of an object. We applied our method to two elastic objects; a rectangular parallelepiped model, and a human liver model reconstructed from computed tomography data. The average estimation error for the human liver model was 0.041 mm when the object was deformed up to 66.4 mm, from only around 3 % observations. These results indicate that the deformation of an entire elastic object can be estimated with an acceptable level of error from limited observations by applying a trained neural network to a new deformation.", "text": "abstract—deformation estimation elastic object assuming internal organ important computer navigation surgery. study estimate deformation entire three-dimensional elastic object using displacement information observation points. learning approach neural network introduced estimate entire deformation object. applied method elastic objects; rectangular parallelepiped model human liver model reconstructed computed tomography data. average estimation error human liver model object deformed around observations. results indicate deformation entire elastic object estimated acceptable level error limited observations applying trained neural network deformation. operation increased recent years development medical technology. however complexity treatment plans means surgical navigation treatment potentially valuable development. surgical navigation computer simulation treatment plans constructed surgery virtual internal organ deformed following surgical presented surgeon surgery. helps surgeons operate planned provides alert prevent accidents example hurt important blood vessels. surgical operations laparoscopic surgery considered less trauma patients laparotomy leads faster recovery however laparoscopic surgery difﬁcult doctors laparotomy surgery involves restricted vision limited freedom surgical instruments making difﬁcult move instruments operating ﬁeld consequently surgical navigation particularly valuable laparoscopic surgery. said surgeons feel comfortable procedures completed procedures patients surgical navigation thought reduce risk mistakes doctor gets used treatment. notwithstanding abovementioned beneﬁts necessary overcome limits problems must addressed detecting implementing deformation internal organs perform navigation surgery. ﬁrst track deformation actual organ surface. many surface organ textureless difﬁcult specify position surface point moved deformation second task obtain deformation information entire organ partial observation information. situations whole organ visible surgery narrow ﬁeld view short distance laparoscopic camera observable parts even track feature points surface information part surface obtained deformation information back side inside obtained. method solve ﬁrst problem method combining sparse feature-matching algorithm probabilistic modelling gaussian process regression method using blood vessel features tissue surfaces image features proposed. although possible track deformation every position object feature point surface tracked certain degree reliability. therefore believe second challenging problem. approach problem obtaining entire deformation partial observation information introducing machine learning techniques; especially neural networks many cases difﬁcult install equipment measures force pulling organ surgery information movement surface point caused deformation obtained. argue that estimating overall deformation observation information partial displacement important step presenting state organ surgical navigation accordance treatment doctor. contributes providing deformation information part doctor observe directly even visible area narrow points tracked. focus research hence estimate ﬁnite element method commonly used technique calculating deformation living body based model many attempts made estimate deformation living body applying ﬁnite element method visualization organs training doctors surgical planning. using computed tomography surgery attempts simulate visualize operations grasping incising organs surgical operations reported addition simulators doctors practice surgical suturing procedures developed study reported model deforming organs accord respiration dynamic radiation irradiation planning constructed using ﬁnite element method method improving accuracy deformation estimation using ﬁnite element method increase calculation speed technique reported rotational elements object extracted deformation computed elements rotation addition study reported method simplifying object shape expressing element pair edges shared element elements divided object addition techniques shape matching based dynamic deformation model proposed surgical assistance however cases pre-existing knowledge mechanical properties object necessary estimating deformation. contrast deformation simulated study applying force organ using neural network method estimating deformation based accumulated deformation data machine learning. study morooka deformation data deformed object obtained beforehand applying many types force using ﬁnite element method relation external force applied organ compressed vertex coordinates mesh could learned neural network. method advantage requiring knowledge mechanical properties organs time deformation estimation. however method still necessary input vertex coordinates contact points direction magnitude force. recent report described development method reconstructing three-dimensional shape organ endoscopic image enable navigation time laparoscopic surgery however approach difﬁcult extract feature points corresponding deformation limited range observable areas high precision. order estimate shape elastic object matching algorithms based shape descriptors method using weighted patch iterative closest point mesh method using laser range scanner data obtain information surface moving tissue proposed. another study external force applied object estimated using partial observation overcome limited visibility time surgical treatment work necessary assume properties related shape object invariant fig. framework study. data sampling displacement nonlinear ﬁnite element method elastic object assuming internal organ neural network trained data estimate displacement points including unobservable points displacement information observable points. since neural networks many parameters optimized high expression power neural network trained back-propagation method reported neural network document recognition outstanding performance large amount training data however ﬁeld medical engineering advances used cases. current study propose method estimating displacement entire elastic object displacement measured observable points training neural network learn deformation data calculated simulation condition initial shape known. study aware addressed neural network deformation estimation displacement information study ﬁrst. framework study shown fig. paper investigated size neural network iteration number optimization suitable deformation learning. also investigated generalization capability method deformation data multiple pattern. results indicate proposed method estimate whole deformation within tolerance range assumed surgery support. paper ﬁrst describe method calculating three-dimensional shape deformed elastic object using nonlinear ﬁnite element method section mention related works section describe algorithm deformation estimation method using neural network section section describe method acquiring experimental data using nonlinear ﬁnite element method elastic object section reports results applying deformation estimation neural network experimental data. finally discuss implications ﬁndings section summarize study section viii. deformation. addition attempts estimate organ deformation several silhouette images obtained objects reported however limitations accuracy estimation using method little information determining deformation. although previous studies attempted neural networks estimate force applied elastic body images deformed elastic body methods require observation whole object. ﬁeld cell micromanipulation studies also reported estimate force using neural network moreover study examining estimation outline object using neural network demonstrated advantage requiring priori knowledge material object however method requires information magnitude force deforming object position contact point making unsuitable surgical operations measuring magnitude force applied instrument organ difﬁcult. employed nonlinear ﬁnite element method forced displacement boundary conditions obtain data samples current study. boundary conditions deform elastic object known deformation structure calculated nonlinear ﬁnite element method developed years. express calculation method section. relationship force displacement expressed following stiffness equation assuming three-dimensional elastic body divided tetrahedral meshes. nonlinear deformation expressed linear equation micro deformation calculated nonlinearly repeating micro deformation. here force applied vertex mesh displacement vertex stiffness matrix matrix determined shape mechanical properties elastic body. nonlinear ﬁnite element method updated according shape every time elastic body slightly deformed. stiffness matrix entire mesh formed overlapping element stiffness matrix mesh corresponding vertex shared different meshes. matrix representing shape mesh matrix representing mechanical properties volume mesh deﬁned follows. structure whose initial shape already known initial obtained formula micro deformation generated minute force minute displacement applied mesh calculated using equation deformation obtained formula repeating calculation obtain displacement vertices mesh structure force applied contact points large deformation. deform elastic object constraint condition required setting vertices among vertices mesh ﬁxed point move. because even force applied structure without ﬁxed point whole shape change translates rotates. even column corresponding ﬁxed point part excluded expression expression holds depending characteristics matrix. among vertices excluding ﬁxed point vertices selected contact points manipulated deforming whole object. using forced displacement boundary condition deformation ﬁrst rewrite equation inverse matrix calculate ﬁnite element method giving displacement displacement contact point known given boundary condition displacement vertices contact point among vertices excluding ﬁxed point unknown. dividing vector known unknown elements equation rewritten follows known since value micro deformation. subscript signify vertices contact points vertices except contact ﬁxed points respectively. prevent over-ﬁtting three weights subjected regularization norm. therefore cost function output layer expressed follows. here number training data data number represent number elements weight matrices excluding part related bias term. regularization norm prevents elements weight optimized parameters becoming large. since learning performed without unnecessarily increasing elements’ value weight prevents overﬁtting would make optimized neural network match training data. regularization coefﬁcient positive value increasing strengthens effect suppressing weight factor becoming large value. optimize weight using error back propagation method minimize cost function derivative cost function obtained. since error function output layer deﬁned norm shown equation activation function output layer differentiation error output layer expressed follows fig. neural network hidden layers. layer circle represents node represents value node line connecting nodes represents connection weight layers. current study neural network used learning estimation elastic deformation. section describe structure cost function optimization method input/output data neural network used. study neural network hidden layers adopted shown fig. mcmcmcm number nodes layer input side values nodes layer ahcaicaj cak. bias term value wihcwjicwkj weights converting feature quantity proceeding next layer. rectiﬁed linear unit used activation function middle layer. optimization used mini batch learning method type stochastic gradient descent method. divided training data evenly mini batches containing pieces data optimized mini batch data group. optimizing mini batches shufﬂed training data optimized again repeated optimization several epochs. number data equally divisible pieces data fractional data ignored. however data shufﬂed epoch number nodes input output layers determined dimensions input/output data number nodes hidden layers arbitrarily selected. since input/output data real number negative value activation function output layer multiplied added feature quantity second hidden layer. employed adam stochastic gradient descent method speed learning. adam method adopt learning rate optimization parameters employs learning rate adjusted parameter. every time learning iterated learning rate decreased direction parameter large variance learning rate increased direction parameter small variance. method allows network escape quickly saddle point main problem leading learning stagnation. provides advantage rapid convergence. updating equation parameter adam expressed follows. here iteration number estimated value obtained bias correction ﬁrst moment second moment bias slope respectively. value contributes overall learning rate kept constant although cost function decreases greatly beginning optimization large value exerts positive effect latter half learning parameter change large cost function settle particular value. conversely small values cost function decreases steadily settles consistently convergence occurs slowly. therefore substantially change value parameter initial stage learning reduce parameter change convergence approached follows attenuates epoch training phase vertices vertices excluding ﬁxed points assumed observable points displacement could observed. necessary observation point include point action applies force. initial shape elastic object displacement initial position observation point elastic object deformed known displacement observation point taken input neural network. since elastic object three-dimensional shape underwent deformation threedimensional space displacement also component three-dimensional space. therefore three-dimensional training vertex displacements including nonobservation points given target data output neural network. number represents number vertices estimated displacements. since nonobservation point displacement also three-dimensional estimation phase displacement observation point known displacement non-observation point unknown. displacement observation point deformation input neural network trained training phase obtain estimated value displacement vertices output layer. position observation point whole object required training estimation phases. since assumed feature points characteristic shape texture selected observation points observable points could determined advance. study considered elastic bodies rectangular parallelepiped shapes divided tetrahedral meshes shown fig. testing effectiveness method. long side rectangular parallelepiped short sides interval closest vertex tetrahedral mesh simulation space real space standardized corresponding ratio liver model mentioned below. tetrahedral mesh evenly distributed surface also inside elastic object. total vertices mesh nine vertices shown edge fig. ﬁxed points. addition test proposed method actual organ liver shown fig. also examined elastic object. mesh structure constructed human data. since data three-dimensional volume data liver region extracted whole volume data converted surface mesh data structure using commercially available avizo software three-dimensional tetrahedral mesh structure constructed using tetgen library tetrahedral mesh constructed sizes triangles making mesh even possible shape triangle close possible equilateral triangle. mesh contained total vertices. since part connected descending aorta inferior vena cava deform greatly liver living body vertices mesh used ﬁxed points. schematic diagram presenting data processing shown fig. fig. schematic diagram data processing human liver model. data sampling training estimation neural network performed size simulation space size real space normalized evaluate estimation error size real space. calculation error stiffness equation. therefore moving contact point target sample point distance initial position sample point divided force stiffness matrix renewed time minute displacement applied. finally calculation error large deformation ignored negligibly small. took approximately minute rectangular parallelepiped model approximately minutes liver model undergo sample displacement large deformation. sampling pattern data consisted case sampling single area contact points case sampling performed area areas contact points. figs. vertices green points represent contact points’ position. ﬁgure represents case region contact points call data sets liver. contact points’ positions case contact point regions shown call data sets contact points’ setting liver. initial position contact point. closest sample point interval transformed model total patterns. maximum displacement contact point initial position deformation data acquired displacement initial position vertex coordinates threedimensional real values vertex. data sets sampling range determined based positional relationship ﬁxed point contact point normal vector object surface contact point. coordinates sampling points satisﬁed following conditions assuming distance center ﬁxed points center contact points direction vector fig. rectangular parallelepiped elastic object represented tetrahedral mesh. vertices shown green indicate ﬁxed points contact points respectively. designates model area contact points. ﬁgures show views different angles. cases regions contact points shown green vertices ﬁgure represent contact points case. fig. initial shape liver mesh structure constructed data. color vertices rectangular parallelepiped shape fig. case region contact points single area. ﬁgure represents case area contact points. liver since imaging range data normalized simulation space real space simulation space. although side tetrahedral mesh varied depending position approximately real space. described section deformed target elastic object using nonlinear ﬁnite element method forced displacement boundary condition obtain vertex displacement data experiment. target elastic object force applied contact point deform contact point sample point. young’s modulus poisson’s ratio represent mechanical properties elastic object ﬁxed respectively meshes obtaining deformation entire elastic object using nonlinear ﬁnite element method large displacement contact points calculation cycle cause substantial radius spheroid around direction direction perpendicular vfc. nearest neighbor sampling point interval corresponded real space. samples total. maximum displacement contact point initial position sampling data liver radius ellipsoid direction direction perpendicular nearest neighbor sample point interval select sample point based normal vector average vector normal vectors contact points used case contact point region among areas. case contact points located back liver normal vector direction toward front side used simulating action turning liver surgery. number samples somewhat different area contact points approximately average. fig. shows examples deformed shape data sample. deformed shapes displacement initial shape used experimental data. first number nodes middle layers neural network examined. addition observed test error transition training local positional error shape deformation. next examined effectiveness method deformed data multiple regions contact points. carried -fold cross-validation evaluate performance method. namely data data randomly divided data sets approximately equal size used test data remaining data used training data. data used test data changed times estimation error settings used obtain data elastic object deformed substantially rotation around ﬁxed point. greater nonlinear deformation occurs elastic object rotated around ﬁxed point compared expansion contraction. considering deformation real object direction applied force determined based normal vector direction surface elastic object many actions pulling direction perpendicular surface considered rather pushing direction toward ﬁxed point. region contact points sample points equally arranged nearest neighbor sample point interval number sample points somewhat different region contact points average approximately sample point interval deﬁned proportion distance ﬁxed point varies depending position contact point’s area need move contact points small area contact points located close ﬁxed point. necessary applying displacement large actual elastic body would tear could cause calculation errors ﬁnite element method. examples acquired samples shown fig. complicated rectangular parallelepiped model impossible deformation caused setting sampling range inside rectangular parallelepiped case rectangular parallelepiped model area contact points. therefore sample points placed inside ellipsoid obtain data liver. unlike rectangular parallelepiped model ﬁxed points liver model located near center whole shape object reference length size ellipsoid evaluation error performed transforming difference output target using test data actual size shown fig. difference corresponds difference coordinates vertices. overall error evaluated using root mean square error vertices calculated using test data. local positional error difference coordinates obtained vertex test sample. regularization coefﬁcient weight optimized equation initial value weight randomly determined every trial based matrix size weight. implementation neural network programmed using matlab personal computer. first number observation points three rectangular parallelepiped model. used edges corners observation points assumed would relatively easy feature points detect images real elastic body. since three observation points number nodes input layer neural network fig. number nodes output layer exclude ﬁxed number nodes hidden layers varied intervals training performed case using data rpp. training repeated epochs iterations mini batch. mini batches data samples each. iterations total. trial neural network trained using data samples data. estimation accuracy tested using data samples data repeated times. observation points determined based number vertices estimation corresponding percentage observation points rectangular parallelepiped model. examined cases number nodes hidden layers varied intervals using data liver. training epochs iterations nine mini batches data samples each. thus iterations total. employed smaller mini batch size liver model compared rectangular parallelepiped model data size data sample larger rectangular parallelepiped model. fig. shows rmse estimated test data color corresponding volume error. case error high estimation accuracy shown blue case high error estimation accuracy shown fig. relationship number hidden layer nodes estimation accuracy. number hidden layer nodes represented percentage hidden layers size number vertices greater error shown less error shown blue. shows results rectangular parallelepiped model shows liver model results. red. axes represent percentage hidden layers size number vertices veriﬁcation range experiment error tended decrease number nodes increased. therefore deformation estimated accurately increasing number nodes hidden layers. however number nodes large number elements weights optimized also large. number elements weight increased time required training estimation increased. therefore considering real-world applications method appropriate relatively small number nodes within range error small possible. fig. shows that rmse small enough hidden layers comparable size number vertices therefore subsequent experiments number nodes hidden layers number vertices investigated changes estimation accuracy respect number training iterations using data sets liver. rectangular parallelepiped model nodes hidden layers three observation points. mini batches data samples iterations. repeated epochs total number iterations liver model nodes hidden layer nine observation points. nine mini batches data samples performed iterations each. total number iterations epoch repeats training test conducted trials different test samples session. repeated session times. fig. shows transition rmse calculated using test data respect number iterations. results consisted averaged transition rmse across sessions. graph showing iterations enlarged ﬁgure. since optimized using stochastic gradient method rmse decrease monotonically partially increased. overall number training iterations increased rmse decreased. enlarged view small number training iterations showed rmse roughly converged approximately iterations less number iterations employed previous section. examples estimated shape using weight neural network ﬁnal training shown fig. local positional error vertex displayed color surface. surface colored dark blue around vertices difference vertex coordinates large. rectangular parallelepiped model error relatively large around position shape curved substantially. however results showed displacement could estimated less error whole even region object deformed nonlinearly average sessions ﬁnal rmse rectangular parallelepiped model liver model. percentage error maximum value contact point displacement obtaining deformed shape rectangular parallelepiped model liver model. results revealed displacement vertices excluding ﬁxed points could estimated small error average displacement observation points vertices estimated. using data sets liver estimation performance examined region contact points multiple area. sets data different regions contact points mixed. used data training testing data repeated trials. session repeated times. mini batches data samples mini batches data samples performed iterations using liver respectively. total number iterations epoch repeats conducted -fold cross-validation including trials different test samples session repeated session times. results compared experiment section vi-b. table shows estimation results data information. case liver results shown section vi-b. mean rmse obtained averaging squared error vertices sessions estimated using test data trial. percentage ratio mean rmse displacement. mean indicates average value maximum local positional error vertex test data sample. maximum value local positional error obtained sample test data. percentage represents ratio mean displacement. displacement indicates maximum displacement contact points data used training testing. observation point refers percentage number observation points number vertices number observation points also shown. vertices indicates number vertices needed estimate displacement. vertex estimated displacement corresponds vertex excluding ﬁxed point vertices. number data sample refers total number data samples used training test. case area contact points comparison actual size mean rmse revealed liver model produced less error rectangular parallelepiped model. data region contact points maximum displacement contact points around three times larger compared data liver. percentage mean rmse revealed large difference models. data multiple regions contact points maximum displacement contact points number data samples similar models. error data liver comparable. variation deformation patterns increases data multiple contact region. average error larger case contact points determined single region. average error local positional error test data session shown plot fig. error represented percentage maximum displacement contact points data set. median ratio average error slightly smaller liver model rectangular parallelepiped model cases single multiple contact regions. results imply displacement vertex would estimated method average error data contact points multiple regions. addition relationship maximum value local positional error test data trial displacement vertex maximum error test data shown fig. mean value maximum error displacement vertex displayed line error standard deviation. blue lines demonstrate results rectangular parallelepiped model liver model respectively. solid line case single contact region dashed line case multiple contact regions. maximum error increased following size displacement case multiple contact regions. contact region single area maximum error correlated amount displacement larger range displacement. examined hidden layer size liver model rmse relatively large value cases area size hidden layers larger considered convergence slow cases number parameters weight optimized large. although expressiveness neural network ability match data increases number elements weights optimized large slow convergence obstructs real-world applications method. study employed three nine observation points used rectangular parallelepiped model liver model respectively. number observation points corresponding around vertices estimated displacement determined number trial error. practical applications feasible estimate overall deformation even number observation points small. actual organ deformed deformation measured camera regions characteristic shape limited. assume deformation tracked displacement measured characteristic regions. furthermore event considered case paragraph observed examined number observation points. since number nodes input layer three times number observation points increasing number observation points increased number nodes input layer neural network. number observation points large number elements optimization parameter increased much convergence became slow. value percentile liver model larger rectangular parallelepiped model shown fig. since mesh structure around ﬁxed point complicated liver model rectangular parallelepiped model area large variation caused large error samples. median value error corresponds liver model. fig. shows maximum error using data liver largest among examinations four data sets. data could considered variation complexity mesh structure. even difﬁcult estimation condition possible estimate within maximum error average. result shows maximum error guaranteeing partially large error falls within error range. interval mesh vertices liver model approximately comparison interval maximum error would signiﬁcantly big. future work consider transfer learning neural network trained standard model targeted internal organ. example make location vertices mesh model matching original model apply trained neural network research liver model constructed data person. furthermore practical applications consider apply method actual internal organ. since whole deformation could observed actual internal organ seems need train neural network partial observation information various location subject. considered combine training using mesh model represent whole deformation using actual organ provide partial information deformation. proposed method estimating deformation whole elastic object based partial observation using neural network showed feasibility estimation. rectangular parallelepiped model human liver model reconstructed data used elastic objects evaluate method. data samples obtained nonlinear ﬁnite element method condition initial shape elastic object known. training neural network displacement small number observation points taken input displacement vertices including non-observation points excluding ﬁxed points output. current experiment investigated estimation performance proposed method examining hidden layer size number iterations optimization position contact points. selected vertices considered suitable tracking displacement number nodes hidden layers accord number mesh vertices arranged elastic object. showed estimation accuracy position error vertex coordinates average around observations among vertices using liver model single multiple contact regions respectively. current results demonstrated proposed method enables estimation deformation error much less tolerable context supporting surgical operations. proposed method potential applications deformation estimation internal organs. research supported center innovation program japan science technology agency japan society promotion science grant-in-aid young scientists grant number jpk. karimirad modelling precision loadcell using neural networks vision-based force measurement cell micromanipulation ieee/asme int. conf. adv. intell. mech. karimirad chauhan shirinzadeh vision-based force measurement using neural networks biological cell microinjection biomech. vol. a.-m. cretu payeur petriu neural network mapping clustering elastic behavior tactile range imaging virtualized reality applications ieee trans. instrum. meas. vol. a.-m. cretu estimation deformable object properties shape force measurements virtualized reality applications ieee int. symp. haptic audio visual envir. games kikuuwe tabuchi yamamoto edge-based computationally efﬁcient formulation saint venant-kirchhoff tetrahedral ﬁnite elements trans. graphics vol. suwelack physics-based shape matching intraoperative morooka nakamoto yoshinobu survey statistical modeling machine learning approaches computer assisted medical intervention intraoperative anatomy modeling optimization interventional procedures ieice trans. inform. syst. vol. saito deformation estimation elastic bodies using multiple silhouette images endoscopic image augmentation ieee int. symp. mixed augmented reality", "year": 2017}