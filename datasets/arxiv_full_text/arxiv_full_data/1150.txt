{"title": "Object detection via a multi-region & semantic segmentation-aware CNN  model", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "We propose an object detection system that relies on a multi-region deep convolutional neural network (CNN) that also encodes semantic segmentation-aware features. The resulting CNN-based representation aims at capturing a diverse set of discriminative appearance factors and exhibits localization sensitivity that is essential for accurate object localization. We exploit the above properties of our recognition module by integrating it on an iterative localization mechanism that alternates between scoring a box proposal and refining its location with a deep CNN regression model. Thanks to the efficient use of our modules, we detect objects with very high localization accuracy. On the detection challenges of PASCAL VOC2007 and PASCAL VOC2012 we achieve mAP of 78.2% and 73.9% correspondingly, surpassing any other published work by a significant margin.", "text": "figure left detecting sheep scene difﬁcult without referring context mountainish landscape. center contrast context right image confuse detection boat. pure object characteristics recognition model focus case. right instance occluded right part recognition model focus left part order conﬁdently detect. r-cnn uses alex krizhevsky’s extract features proposals provided selective search classiﬁes class speciﬁc linear svms. manage train networks millions parameters ﬁrst pre-training auxiliary task image classiﬁcation ﬁne-tuning small images annotated detection task. simple pipeline surpasses large margin detection performance previously published systems deformable parts models non-linear multi-kernel approaches success comes fact replaced hand-engineered features like sift high level object representations produced last layer model. employing even deeper model -layers vgg-net boosted performance another points. object representation. lessons learned above-mentioned works indeed features matter object detection work partly motivated observation. however instead proposing network architecture deeper also architecture greater width i.e. whose last hidden layers provide features increased dimensionality. goal build richer candidate representation. accomplished levels propose object detection system relies multi-region deep convolutional neural network also encodes semantic segmentation-aware features. resulting cnn-based representation aims capturing diverse discriminative appearance factors exhibits localization sensitivity essential accurate object localization. exploit properties recognition module integrating iterative localization mechanism alternates scoring proposal reﬁning location deep regression model. thanks efﬁcient modules detect objects high localization accuracy. detection challenges pascal pascal achieve correspondingly surpassing published work signiﬁcant margin. studied problems computer vision object detection given image return instances type objects form bounding boxes tightly enclose them. last years huge improvements observed task thanks recent advances deep learning community among them notable work sermanet overfeat framework work girshick r-cnn framework. overfeat uses models applies sliding window fashion multiple scales image. ﬁrst used classify window contains object second predict true bounding location object. finally dense class location predictions merged greedy algorithm order produce ﬁnal object detections. ﬁrst level want object representation capture several different aspects object pure appearance characteristics distinct appearance different regions context appearance joint appearance sides object boundaries semantics. believe rich representation facilitate problem recognising object instances variety circumstances order achieve goal propose multi-component model called multiregion hereafter component steered focus different region object thus enforcing diversiﬁcation discriminative appearance factors captured additionally explain shortly properly choosing arranging regions also help representation less invariant inaccurate localization object. note property highly desirable detection contradicts builtinvariances models stem max-pooling layers. second level inspired close connection exists segmentation detection wish enrich representation also captures semantic segmentation information. extend model also learns novel cnnbased semantic segmentation-aware features. importantly learning features require ground truth object segmentations training data. object localization. besides object representation work also motivated observation that tremendous classiﬁcation capability recent models bottleneck good detection performance accurate object localization. indeed noticed r-cnn common type false positives mis-localized detections. employing post processing step bounding regression apply ﬁnal list detections. however technique helps small localization errors. believe much space improvement aspect. order prove attempt built powerful localization system relies combining multi-region model cnn-model bounding regression used within iterative scheme alternates scoring candidate boxes reﬁning coordinates. develop multi-region recognition model yields enriched object representation capable capture diversity discriminative appearance factors exhibit localization sensitivity desired task furthermore extend model proposing uniﬁed neural network architecture also learns semantic segmentation-aware features task object detection. features jointly learnt weakly supervised manner thus requiring additional annotation. show signiﬁcantly improve localization capability coupling aforementioned recognition model model bounding regression adopting scheme alternates scoring candidate boxes reﬁning locations well modifying post-processing step non-maximumsuppression. detection system achieves detection challenges respectively thus surpassing previous state-of-art signiﬁcant margin. remainder paper structured follows discuss related work describe multi-region model show extend also learn semantic segmentation-aware features localization scheme described implementation details provided present experimental results qualitative results conclude apart overfeat r-cnn several recent papers dealing object detection problem using deep neural networks. recent work shares conceptual similarities ours. speciﬁcally extract features additional region order capture contextual appearance candidate utilize inference framework exploit object segmentation proposals order improve object detection accuracy also iterative regression them multiple regions designed diversify appearance factors captured representation improve localization exploit cnn-based semantic segmentation-aware features make deep model bounding regression well box-voting scheme nonmax-suppression. feature extraction multiple regions also exploited performing object recognition videos leordeanu features outputs +svm classiﬁers trained region separately -class predictions pretrained imagenet. instead ﬁne-tune deep networks region separately order accomplish goal learning deep features adequately capture discriminative appearance characteristics. furthermore regions exhibit variety shape that figure multi region architecture. clarity present four regions participate adaptive pooling layer uses spatially adaptive pooling architecture extended also learn semantic segmentation-aware features including additional ‘activation-maps’ ‘region-adaptation’ modules properly adapted task. section helps boosting detection performance. designed deep model object proposals generation contextual features extracted last hidden layer model trained imagenet classiﬁcation task applied large crops image. introduce deep novel deformation constrained pooling layer strategy pre-training uses bounding annotations provided imagenet localization task contextual features derived applying pre-trained imagenet whole image treating class probabilities imagenet objects global contextual features. spp-net detection framework instead applying deep candidate separately r-cnn does extract convolutional feature maps whole image project candidate boxes them adaptive max-pooling layer consists multiple pooling levels produce ﬁxed length feature vectors pass fully connected layers model. thanks modiﬁcations manage speed computation considerable factor maintaining high detection accuracy. work adopts paradigm processing. contemporary work approaches also based spp-net framework. improve framework replacing subnetwork component applied convolutional features extracted whole image deeper convolutional network. focus simplifying training phase spp-net r-cnn speeding testing training phases. also ﬁne-tuning whole network adopting multi-task objective classiﬁcation loss regression loss manage improve accuracy system. finally extend adding sub-network component predicting class-independent proposals thus making system faster independent object proposal algorithms. recognition model propose consists multi-component network component chosen focus different region object. call multi-region model. begin describing ﬁrst overall architecture. order facilitate description model introduce general architecture abstraction decomposes computation different modules region adaptation module. given region image activation maps image module projects activation maps crops activations inside pools spatially adaptive pooling layer forwards multi-layer network. architecture multiregion model seen ﬁgure initially entire image forwarded activation maps module. then candidate detection analysed regions {ri}k assigned dedicated region adaptation module region left/right/up/bottom half parts candidate box. region obtained scaling candidate factor region inner obtained scaling candidate factor outer factor region obtain inner scaling candidate factor outer size candidate box. region inner obtained scaling candidate factor outer factor region inner candidate outer obtained scaling candidate factor regions always deﬁned relatively bounding mentioned previously region adaptation modules passes activations pooled assigned region multilayer network produces high level feature. finally candidate representation obtained concatenating last hidden layer outputs region adaptation modules. steering focus different regions object force network capture various complementary aspects objects appearance thus leading much richer robust object representation also make resulting representation sensitive inaccurate localization also crucial object detection. gions {ri}k role object detection. region components role detection utilize types region shapes rectangles rectangular rings latter type deﬁned terms inner outer rectangle. describe regions employ speciﬁcations given caption ﬁgure original candidate candidate detection used r-cnn network trained type region guided capture appearance information entire object. used alone consists baseline work. candidate networks trained them guided learn appearance characteristics present half part object side objects borders aiming also make representation robust respect occlusions. central regions type central regions model networks trained guided capture pure appearance characteristics central part object probably less interfered objects next background. border regions include regions shape rectangular rings expect dedicated networks guided focus joint appearance characteristics sides object borders also aiming make representation sensitive inaccurate localization. contextual region region type rectangular ring shape assigned network driven focus contextual appearance surrounds object appearance background objects next discriminative feature diversiﬁcation. hypothesis regions render visible networkcomponents limited part object immediate surrounding forces network-component discriminate image boxes solely based visual information apparent thus diversifying discriminative factors captured overall recognition model. example border region depicted ﬁgure replaced includes whole inner content would expect network-component dedicated desired attention visual content concentrated around borders object. tested hypothesis conducting experiment trained tested multi-region models consist regions each. model included original region border region ﬁgure contain central part object. model replaced latter region rectangular ring normal size. trained pascal trainval tested test challenge. model achieved model achieved points lower validates assumption. localization-aware representation. argue multi-region architecture well type regions included address certain extent major problems detection task inaccurate object localization. believe multiple regions network-components dedicated imposes soft constraints regarding visual content allowed type region given candidate detection box. experimentally justify argument referring sections diversify features encoded representation extend multi-region model also learns semantic segmentation-aware features. motivation comes close connection between segmentation detection well fact segmentation related cues empirically known often help object detection context multi-region network incorporation semantic segmentation-aware features done adding properly adapted versions main modules network i.e. ‘activation-maps’ ‘region-adaptation’ modules hereafter refer resulting modules combine multi-region features semantic segmentation aware features concatenating resulting network thus jointly learns deep features types training. fully convolutional nets. order serve purpose exploiting semantic segmentation aware features module adopt fully convolutional network abbreviated hereafter trained predict class speciﬁc foreground probabilities details used task semantic segmentation). weakly supervised training. train activation maps module class-speciﬁc foreground segmentation task annotations provided object detection challenges follow weakly supervised training strategy create artiﬁcial foreground classspeciﬁc segmentation masks using bounding annotations. speciﬁcally ground truth bounding boxes image projected spatial domain last hidden layer pixels inside projected boxes labelled foreground rest labelled background aforementioned process performed independently class yields many segmentation target images number classes. seen ﬁgure right column despite weakly supervised training resulting activations still carry signiﬁcant semantic segmentation information enough even delineate boundaries object separate object background. activation maps. trained auxiliary task foreground segmentation drop last classiﬁcation layer rest network order extract images semantic segmentation aware activation maps. exploit activation maps treating mid-level features adding single region adaptation module trained primary task object detection. case choose single region obtained enlarging candidate detection factor reason repeat regions inifigure illustration weakly supervised training used activation maps module semantic segmentation aware features. left column images ground truth bounding boxes drawn them. classes depicted order horse human dog. middle column segmentation target values used training fcn. artiﬁcially generated ground truth bounding left column. blue color background color foreground. right column foreground probabilities estimated trained model. clearly verify that despite weakly supervised training extracted features carry signiﬁcant semantic segmentation information. already explained multi-region recognition model exhibits localization awareness property necessary accurate object localization. however enough. order make full recognition model needs presented well localized candidate boxes turn scored high conﬁdence solution adopt consists main components region adaptation module bounding regression. introduce extra region adaptation module that instead used object recognition trained predict object bounding box. applied activation maps produced multi-region model instead typical one-layer ridge regression model consists hidden fully connected layers prediction layer outputs values category. order allow predict location object instances close proximity initial candidate boxes region figure illustration object localization scheme instances class car. describe images left right order. step initial proposal image. clarity visualize proposals rejected ﬁrst scoring step. step locations obtained performing based bounding regression boxes step step boxes obtained second step scoring regressing boxes step step boxes step step merged together. step detected boxes applying non-maximum-suppression voting boxes step ﬁnal detections blue color true positives color false positives. also ground truth bounding boxes drawn green color. false positive last step duplicate detection survived non-maximum-suppression. obtained enlarging candidate factor combination offers signiﬁcant boost detection performance system allowing make accurate predictions distant objects. iterative localization. localization scheme starts selective search proposals works iteratively scoring reﬁning coordinates. specifically denote bounding boxes generated iteration class imboxes previous iteration recognition model reﬁned frec regression model thus forming candidate detections common classes. also threshold rejected order rescore duce computational burden subsequent iterations. obtain sequence candidate detection sets all-together exhibit high recall objects image well localized them. bounding voting. last iteration canc}t didate detections produced iteration merged together multiple regression steps generated boxes highly concentrated around actual objects interest. exploit by-product iterative localization scheme adding step bounding voting. first standard non-max suppression applied produces detections using overlap threshold then ﬁnal bounding coordinates reﬁned denotes boxes overlap metric) vote bounding location using weight score model pre-trained imagenet task image classiﬁcation. simplicity ﬁne-tuned fully connected layers model preserved pre-trained weights convolutional layers shared among activation maps module consists convolutional part -layers vgg-net outputs feature channels. max-pooling layer right last convolutional layer omitted module. region adaptation module inherits fully connected layers -layers vgg-net ﬁne-tuned separately others. regarding regions rectangular rings inner outer projected activation maps activations inside inner masked setting zero order train region adaptation modules follow guidelines r-cnn optimization objective softmax-loss minimization performed stochastic gradient descent momentum learning rate initially reduced factor every iterations minibatch samples. positive samples deﬁned selective search proposals overlap groundtruth bounding least negative samples proposals overlap ground-truth bounding range labelling training samples relative original candidate boxes across different regions. activation maps module semantic segmentation aware features. architecture consists -layers vgg-net without last classiﬁcation layer transformed efﬁciency purposes reduce output channels layer order learn semantic segmentation aware features auxiliary convolutional classiﬁcation layer outputs many channels classes binary logistic loss applied spatial cell class independently. initially train channels layer convergence. then replace layer another output channels initialized gaussian distribution training starts beginning continued convergence again. loss minimization minibatch size momentum learning rate initialized decreased factor every epochs. faster convergence learning rate randomly initialized layer channels multiplied factor region adaptation module semantic segmentation aware features. architecture consists spatially adaptive max-pooling layer outputs feature maps channels grid fully connected layer channels. order train procedure region components multi-region model. training learn weights region adaptation module layers randomly initialized gaussian distribution. classiﬁcation svms. order train svms follow principles positive samples considered ground truth bounding boxes negative samples considered selective search proposals overlap ground truth boxes less hard negative mining region adaptation module bounding regression. activation maps module used input case common multi-region model. region adaptation module bounding regression inherits fully connected hidden layers -layers vgg-net. loss function euclidean distance target values network predictions. training samples proposals overlap least ground truth bounding boxes. target values deﬁned r-cnn learning rate initially reduced factor every iterations. momentum minibatch size multi-scale implementation. system adopt similar multi-scale implementation spp-net speciﬁcally apply activation maps modules models multiple scales image single scale selected region adaptation module independently. activation maps module applied scales image shorter dimension training region adaptation modules applied random scale testing single scale used area scaled region closest pixels. case rectangular ring regions scale selected based area scaled outer rectangular ring. semantic segmentation-aware model activation maps module applied scales image shorter dimension training region adaptation module applied random scale testing single scale selected area scaled region closest pixels. training/test time. titan pascal train+val dataset training time region adaptation module approximately hours activation maps module semantic segmentation features approximately days linear approximately hours. order speed steps activation maps pre-cashed ssd. finally image runtime around seconds. evaluate detection system pascal pascal presentation results baseline either original candidate region alone and/or r-cnn framework vgg-net note that original candidate region alone used resulted model realization spp-net object detection framework -layers vgg-net except otherwise stated pascal results trained models trainval tested test year. first asses signiﬁcance region adaptation modules alone object detection task. results reported table expected best performing component original candidate box. surprising high detection performance individual regions like border region ﬁgure contextual region ﬁgure despite fact area visible includes limited portion object outperform previous detection systems based hand crafted features. also interesting high detection performance semantic segmentation aware region table report detection performance proposed modules. multi-region model without semantic segmentation aware features achieves points higher rcnn vgg-net points higher original candidate region alone moreover detection performance slightly exceeds r-cnn vgg-net bounding regression extending multi-region model semantic segmentation aware features boosts performance recognition model another points reaches total map. comparing recently published method yuting mr-cnn s-cnn model scores point higher best performing method includes generation extra proposals bayesian optimization structured loss during ﬁne-tuning vgg-net. signiﬁcant also improvement couple recognition model model bounding regression iterative localization scheme proposed speciﬁcally detection performance raised setting state-of-theart test training data table report detection performance system overlap threshold considering detection positive metric proposed order reveal localization capability method. table observe modules exhibit good localization capability goal designing them overall system exceeds metric approach tool hoiem analyse detection errors system. ﬁgure plot charts percentage detections false positive localization confusion similar category confusion category triggered background unlabelled object. tool hoiem analyse detection errors system. ﬁgure plot charts percentage detections false positive localization confusion similar category confusion category triggered background unlabelled object. observe that using multi-region model instead original candidate region alone considerable reduction percentage false positives localization achieved. validates argument focusing multiple regions object increases localization sensitivity model. furthermore recognition model integrated localization module developed reduction false positives localization huge. similar observation deducted ﬁgure plot top-ranked false positive types baseline overall proposed system. extra experiments presented indicate localization awareness multi-region model without semantic segmentation aware features model uses original candidate areo adaptation modules original left half right half half bottom half central region central region border region border region contextual region semantic-aware region. figure ranked false positive types. baseline original candidate model. bottom overall system. present graphs classes boat bottle chair pottedplant space limitations fact difﬁcult ones pascal challenge. baseline mr-cnn models table because experiment want emphasize localization aspect multi-region model proposals overlap ground truth bounding boxes least iou. area-under-the-curve well-localized proposals mis-localized proposals. curves typically used illustrate capability classiﬁer distinguish classes. discrimination capability measured computing area-underthe-curve metric. higher measure discriminative classiﬁer classes. case well-localized proposals positive class miss-localized proposals negative class. well-localized considered proposals overlap ground-truth bounding range mis-localized considered proposals overlap ground truth bounding range table report measure class separately mr-cnn baseline models. table compare detection system published work test pascal overall system involves multiregion model enriched semantic segmentation aware features coupled based bounding regression iterative localization scheme. tested instances system. exactly components being trained different datasets. ﬁrst ﬁnetuning networks well training detection svms performed train+val dataset includes annotated images. second ﬁne-tuning networks performed train dataset includes annotated images training detection svms performed train+val dataset includes annotated images. observe table achieve excellent cases setting state-of-the-art test training sets. figure fraction detections correct false positives poor localization confusion similar objects confusion objects confusion background unlabelled objects left column baseline original candidate model. middle column multi-region model without semantic segmentation aware features. right column overall system. present charts classes boat bottle chair pottedplant space limitations fact difﬁcult categories pascal challenge. approaches contemporary train models extra data order improve accuracy systems. follow practice report results tables speciﬁcally trained models train+val datasets using selective search edgebox proposals. test time edgebox proposals faster computed. tables apparent methods outperforms approaches even trained less data. currently entries ranked leader board pascal object detection comp benchmark difference performing entry points. ﬁgures present object detections obtained approach. blue bounding boxes mark true positive detections bounding boxes mark false positive detections. ground truth bounding boxes marked green color. failure cases. accurately detecting multiple adjacent object instances remains many cases difﬁcult problem even approach. ﬁgure present difﬁcult examples type. ﬁgure show failure cases. missing annotations. also cases object instances correctly detected approach ground truth annotation pascal voc. figure presents examples nonannotated object instances. proposed powerful cnn-based representation object detection relies factors diversiﬁcation discriminative appearance factors captured steering focus different regions object encoding semantic segmentation-aware features. using context cnn-based localization reﬁnement scheme show achieves excellent results surpass state-of-the signiﬁcant margin.", "year": 2015}