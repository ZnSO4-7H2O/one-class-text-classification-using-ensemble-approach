{"title": "Free energy-based reinforcement learning using a quantum processor", "tag": ["cs.LG", "cs.AI", "cs.NE", "math.OC", "quant-ph"], "abstract": "Recent theoretical and experimental results suggest the possibility of using current and near-future quantum hardware in challenging sampling tasks. In this paper, we introduce free energy-based reinforcement learning (FERL) as an application of quantum hardware. We propose a method for processing a quantum annealer's measured qubit spin configurations in approximating the free energy of a quantum Boltzmann machine (QBM). We then apply this method to perform reinforcement learning on the grid-world problem using the D-Wave 2000Q quantum annealer. The experimental results show that our technique is a promising method for harnessing the power of quantum sampling in reinforcement learning tasks.", "text": "recent theoretical experimental results suggest possibility using current near-future quantum hardware challenging sampling tasks. paper introduce free energy-based reinforcement learning application quantum hardware. propose method processing quantum annealer’s measured qubit spin conﬁgurations approximating free energy quantum boltzmann machine apply method perform reinforcement learning grid-world problem using d-wave quantum annealer. experimental results show technique promising method harnessing power quantum sampling reinforcement learning tasks. quantum bits provide samples approximate boltzmann distribution system pairwise interacting qubits called transverse-ﬁeld ising model free energy hamiltonian tfim contains information qubits measurement basis also spin transverse direction. using numerical simulation show richer many-body system provide learning eﬃciency. refer reader exposition markov decision processes controlled markov chains various broad aspects reinforcement learning. q-function deﬁned mapping tuple given stationary policy current state immediate action controlled markov chain expected value instantaneous future discounted rewards markov chain begins taking action initial state continuing according here random variable perceived agent environment representing immediate reward taking action state markov chain resulting restricting controlled markov chain policy ﬁxed real number discount factor mdp. reinforcement learning successfully applied ﬁelds engineering sociology economics training samples reinforcement learning provided interaction agent ambient environment. example motion planning problem uncharted territory desirable agent learn fastest possible correctly navigate using fewest blind decisions. neither exploration exploitation pursued exclusively without either facing penalty failing task. goal therefore design algorithm eventually converges optimal policy algorithm able generate suboptimal policies early learning process. free energy-based reinforcement learning using restricted boltzmann machine suggested sallans hinton relies approximating utility function agent called q-function using free energy rbm. rbms advantage free energy eﬃciently calculated using closed formulae. rbms represent joint distribution binary variables however property universality require exponentially large rbms crawford generalize method proposing quantum quantum-inspired algorithm eﬃciently approximating free energy general boltzmann machine using numerical simulations show ferl using deep boltzmann machine provide drastic improvement early stages learning. quantum annealer consisting network here trpe´βhvq partition function clamped density matrix e´βhv. term trpρv entropy system. notation x¨¨¨y used expected value observable respect gibbs measure particular admissible state–action pair here binary vectors encoding state action state nodes action nodes respectively qbm. reinforcement learning visible nodes partitioned subsets state nodes action nodes here represents vector weights entry trained using update rule concludes development refl method using qbms. refer reader algorithm details. remains done approximate values free energy also expected values observables paper demonstrate quantum annealing used address challenge. clamped boltzmann machine visible nodes prescribed ﬁxed assignments removed underlying graph. therefore energy clamped boltzmann machine written sets visible hidden nodes respectively slight abuse notation letter stands graph node assignment interactions variables represented respective nodes speciﬁed real-valued weighted edges underlying undirected graph represented denoting weights visible hidden hidden hidden nodes boltzmann machine respectively. clamped quantum boltzmann machine underlying graph clamped instead binary random variable qubits associated node network. energy function substituted quantum hamiltonian induced tfim mathematically hermitian matrix represent pauli x-matrices. thus clamped equivalent clamped classical boltzmann machine. because case diagonal matrix σz-basis spectrum identical evolution quantum system slowly changing time-dependent hamiltonian characterized quantum adiabatic theorem states system remains instantaneous steady state provided eigen-energy steady state rest hamiltonian’s spectrum every point time. motivated introduce paradigm quantum computing known quantum adiabatic computation closely related quantum analogue simulated annealing namely quantum annealing introduced history inspired eﬀorts manufacturing physical realizations adiabatic evolution quantum hardware reality manufactured chips operated non-zero temperature isolated environment. therefore existing adiabatic theory cover behaviour machines. contemporary investigation quantum adiabatic theory therefore initiated study adiabaticity open quantum systems references prove adiabatic theorems open quantum systems various assumptions particular quantum system coupled thermal bath satisfying kubo–martin– schwinger condition implying instantaneous steady state instantaneous gibbs state. work progress shows promising opportunities quantum annealers sample gibbs state tfim. practice additional complications samples gathered quantum annealer gibbs state ﬁnal hamiltonian. fact suggests distribution samples would instead correspond instantaneous hamiltonian intermediate point time called freeze-out point. unfortunately point consequently strength transverse ﬁeld point priori known also depends tfim evolution. goal simply associate single virual tfims constructed ferl. another unknown parameter inverse temperature gibbs state partition function free energy attained. similar fashion wish associate single virtual tfims encountered. quantum annealer used experiments d-wave consists chip superconducting qubits connected according sparse adjacency graph called chimera graph. chimera graph structure looks signiﬁcantly diﬀerent frequently used models machine learning e.g. rbms dbms consist consecutive fully connected bipartite graphs. shows adjacent blocks chimera graph consist qubits which paper serve clamped used ferl. fig. transverse-ﬁeld ising model consisting qubits arranged two-dimensional lattice nearest neighbour couplings. corresponding eﬀective classical ising model replicas arranged three-dimensional solid torus. bloch sphere). measured quantum information related projection spin along transverse ﬁeld collapses cannot retrieved. therefore even choice virtual virtual measured conﬁgurations energy still unknown. propose method overcoming challenge based suzuki–trotter expansion tfim call replica stacking details explained §iii perform grid search values virtual parameters accepted virtual parameters ones result eﬀective learning ferl early stages training. suzuki–trotter decomposition partition function tfim deﬁned hamiltonian approximated using partition function classical hamiltonian denoted corresponds classical ising model dimension higher. xhhy expected values variables products variables respectively binary encoding hidden nodes respect boltzmann distribution classical hamiltonian values q-functions also approximated empirically since classical boltzmann machine sample spin values boltzmann distribution eﬀective hamiltonian simulated quantum annealing algorithm introduction). many ﬂavours quantum monte carlo methods based suzuki–trotter expansion described above. algorithm simulates quantum annealing phenomena tfim slowly reducing strength transverse ﬁeld ﬁnite temperature desired target value. implementation used single spin-ﬂip variant linear transverse-ﬁeld schedule experimental studies shown similarities behaviour quantum annealing physical realization d-wave systems. classical counterpart conventional simulated annealing based thermal annealing. algorithm used sample boltzmann fig. adjacent unit cells d-wave chip. intra-cell couplings provide fully connected bipartite subgraph. however four inter-cell couplings. chimera graph representing connectivity unit cells qubits. number replicas represent spins classical system dimension higher. note hidden node’s pauli z-matrices represented classical spins denoted slight abuse notation. words original ising model non-zero transverse ﬁeld represented non-commuting operators mapped classical ising model higher dimension. fig. shows underlying graph tfim two-dimensional lattice corresponding ten-replica eﬀective hamiltonian three dimensions. fig. grid-world problem instance reward wall penalty. optimal policy problem instance selection directional arrows indicating movement directions. distributions correspond ising spin model absence transverse ﬁeld unlike possible approximate boltzmann distribution classical boltzmann machine also quantum hamiltonian presence transverse ﬁeld. done reducing strength transverse ﬁeld desired value deﬁned model rather zero. proven spin system deﬁned converges boltzmann distribution eﬀective classical hamiltonian dimension higher corresponds quantum hamiltonian. therefore straightforward approximate free energy well observables fig. demonstrates performance deep qnetwork network consisting input layer state nodes layers eight hidden nodes each output layer nodes representing values q-function diﬀerent actions given conﬁguration state nodes. number hidden nodes networks described paper. explained quantum annealer provides measurements spins qubit tfim. therefore apobservables proximated averaging spin conﬁgurations measured quantum annealer. moreover translation invariance replica eﬀective classical model approximation spin measurements tfim measurement bases therefore quantum annealer operates given virtual inverse temperature anneals virtual transverse-ﬁeld strength σz-conﬁguration sampled annealer viewed instance classical spin conﬁguration replica classical eﬀective hamiltonian dimension higher. suggests following method approximate free energy tfim. gather pool conﬁgurations sampled quantum annealer tfim considered allowing repetitions. iterations spin conﬁguration sampled pool inserted next replica eﬀective classical hamiltonian consisting replicas. procedure creates pool eﬀective classical spin conﬁgurations employed equation order approximate free energy tfim empirically. benchmark various ferl methods grid-world problem agent capable taking actions down left right stand still grid-world deterministic reward wall penalty shown fig. task optimal policy shown fig. agent state grid-world. discount factor explained reward attained agent top-left corner neutral value moving empty cell agent penalized receiving reward moves penalty cell value fig. heatmap average ﬁdelity obtained various choices virtual parameters tests performance ferl samples obtained quantum annealer treated classical conﬁgurations gbm. rows samples interpreted σz-measurements qbm. treat network superconducting qubits represented fig. clamped hidden layers represented using blue colours. state nodes considered fully connected blue qubits action nodes fully connected qubits. choice virtual parameters appear query dwave chip construct eﬀective classical conﬁgurations dimension higher pool reads according replica stacking method introduced §iii conﬁgurations turn employed approximate free energy quantum hamiltonian. conduct independent runs ferl fashion average ﬁdelity runs training samples. fig. demonstrates heatmap average ﬁdelity choice virtual parameters d-wave query considered sampling classical fig. underlying graph. fig. shows growth average ﬁdelity best known policies generated diﬀerent ferl methods. method ﬁdelity curve average independent runs training samples. ﬁgure d-wave curve corresponds d-wave replica stacking based method choice best virtual parameters shown heatmap fig. training based formulae bipartite chimera curves based formulae underlying graphs bipartite chimera graph respectively choice virtual parameters eﬀective hamiltonian conﬁgurations generated using explained §iii bipartite chimera curves generated using train classical classical chimera graph respectively using formulae linear inverse temperature schedule indicates ﬁnal value. d-wave classical curve generated using method samples obtained using d-wave curve generated using method solve grid-world problem using various qlearning methods q-function parametrized neural networks. comparison demonstrate performance method considered state art. method eﬃciently processes every training sample shown fig. requires large number training samples converge optimal policy. another conventional method free energy-based reinforcement learning using rbm. method also successful scale reinforcement learning task considered experiment. although method outperforming ferl methods taking advantage highly eﬃcient sampling oracle processing training sample eﬃcient based closed formulae. fact size problem considered rbm-based ferl outperforms method. comparison results fig. suggests replica stacking successful method estimating eﬀective classical conﬁgurations obtained quantum annealer given spins measured measurement bases. practical reinforcement learning method provides means treating quantum annealer qbm. ferl using quantum annealer conjunction replica stacking technique provides signiﬁcant improvement ferl using classical boltzmann machines. curve representing sqa-based ferl using boltzmann machine chimera graph almost coincident obtained using d-wave whereas sqa-based ferl using slightly outperforms suggests developing quantum annealing chips greater connectivity control annealing time improve performance replica stacking method applied reinforcement learning tasks. supported comparing performance sa-based ferl using versus sa-based ferl using chimera graph. result shows better choice neural network compared chimera graph additional connections. raymond provide methods estimating eﬀective inverse temperature applications. however studies samples obtained quantum annealer matched boltzmann distribution classical ising model. fact transverse-ﬁeld strength second virtual parameter consider. optimal choice corresponds annealing time agreement work also consider tfim qubits. agreement ferl using quantum annealer reads treated classical boltzmann samples ferl using classical boltzmann machines suggests that least task size boltzmann machine measurements provided d-wave considered good approximations boltzmann distribution samples classical ising models. paper perform free energy-based reinforcement learning using existing quantum hardware namely d-wave methods rely suzuki–trotter decomposition realization measured conﬁgurations quantum device replicas eﬀective classical ising model dimension higher. future research employ principles solve larger-scale reinforcement learning tasks emerging ﬁeld quantum machine learning.", "year": 2017}