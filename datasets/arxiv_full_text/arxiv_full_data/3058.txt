{"title": "Compatibility Family Learning for Item Recommendation and Generation", "tag": ["cs.LG", "cs.AI", "cs.CV"], "abstract": "Compatibility between items, such as clothes and shoes, is a major factor among customer's purchasing decisions. However, learning \"compatibility\" is challenging due to (1) broader notions of compatibility than those of similarity, (2) the asymmetric nature of compatibility, and (3) only a small set of compatible and incompatible items are observed. We propose an end-to-end trainable system to embed each item into a latent vector and project a query item into K compatible prototypes in the same space. These prototypes reflect the broad notions of compatibility. We refer to both the embedding and prototypes as \"Compatibility Family\". In our learned space, we introduce a novel Projected Compatibility Distance (PCD) function which is differentiable and ensures diversity by aiming for at least one prototype to be close to a compatible item, whereas none of the prototypes are close to an incompatible item. We evaluate our system on a toy dataset, two Amazon product datasets, and Polyvore outfit dataset. Our method consistently achieves state-of-the-art performance. Finally, we show that we can visualize the candidate compatible prototypes using a Metric-regularized Conditional Generative Adversarial Network (MrCGAN), where the input is a projected prototype and the output is a generated image of a compatible item. We ask human evaluators to judge the relative compatibility between our generated images and images generated by CGANs conditioned directly on query items. Our generated images are significantly preferred, with roughly twice the number of votes as others.", "text": "figure notion compatibility similarity left upper outer garment center query item. surrounding items compatible ones. styles compatible shoes lower body garments various. right style similar item constrained. real world application quite often encountered insufﬁcient records make decent compatible recommendation critical fully exploit relevant contents associated items images dresses wineries wines. even leveraging relevant information recommending generating compatible items challenging three reasons. first notion compatibility typically goes across categories broader diverse notion similarity involves complex many-to-many relationships. shown figure compatible items necessarily similar vice versa. second compatibility relationship inherently asymmetric real world applications. instance students purchase elementary textbooks buying advanced ones house owners furniture house purchases. recommendation systems must take asymmetry consideration recommending accessories customers bought cars rational; recommending cars bought accessories would improper. reasons make many existing methods less compatibility learning learn symmetric metric model item-item relationship. third currently available labeled data sets compatible incomcompatibility items clothes shoes major factor among customer’s purchasing decisions. however learning compatibility challenging broader notions compatibility similarity asymmetric nature compatibility small compatible incompatible items observed. propose end-to-end trainable system embed item latent vector project query item compatible prototypes space. prototypes reﬂect broad notions compatibility. refer embedding prototypes compatibility family. learned space introduce novel projected compatibility distance function differentiable ensures diversity aiming least prototype close compatible item whereas none prototypes close incompatible item. evaluate system dataset amazon product datasets polyvore outﬁt dataset. method consistently achieves state-of-the-art performance. finally show visualize candidate compatible prototypes using metric-regularized conditional generative adversarial network input projected prototype output generated image compatible item. human evaluators judge relative compatibility generated images images generated cgans conditioned directly query items. generated images signiﬁcantly preferred roughly twice number votes others. identifying compatible items important aspect building recommendation systems. instance recommending matching shoes speciﬁc dress important fashion; recommending wine different dishes important restaurants. addition valuable visualize style missing existing dataset foresee potential matching items could up-sold users. believe generated compatible items could inspire fashion designers create novel products help business clients fulﬁll needs customers. items sufﬁcient number viewing purchasing intents possible take co-viewing records signals compatibility simply standard techniques recommendation system collaborative ﬁltering identify compatible items. patible items insufﬁcient train decent image generation model. asymmetric relationships generator could simply learn modify input image cgans similarity learning setting. however humans capabilities create compatible items associating internal concepts. instance fashion designers utilize internal concept compatibility e.g. style material design many compatible outﬁts. inspired this demonstrate extracting meaningful representation image contents compatibility effective tackling challenges. recommending generating compatible items learning compatibility family. family item contains representation vector embedding item multiple compatible prototype vectors space. refer latent space compatibility space. firstly propose end-toend trainable system learn family item. multiple prototypes family capture diversity compatibility conquering ﬁrst challenge. secondly introduce novel projected compatibility distance function differentiable ensures diversity encouraging following properties least prototype close compatible item none prototypes close incompatible item. function captures notion asymmetry compatibility tackling second challenge. paper focuses mainly image content framework also applied modalities. learned compatible family’s usefulness beyond item recommendation. design compatible image generator trained limited labeled data given succinct representation captured compatibility space bypassing third challenge. instead directly generating image compatible item query item ﬁrst obtain compatible prototype using system. then prototype used generate images compatible items. relieves burden generator simultaneously learn notion compatibility generate realistic images. contrast existing approaches generate target images directly source images source-related features. propose novel generator referred metric-regularized conditional generative adversarial network generator restricted work similar latent space compatibility space. addition learns avoid generating ambiguous samples boundary clusters samples conﬂicting relationships query items. evaluate framework fashion-mnist dataset amazon product datasets polyvore outﬁt dataset. method consistently achieves state-of-the-art performance compatible item recommendation. finally show generate images compatible items using learned compatible family mrcgan. human evaluators judge relative compatibility generated images images generated cgans conditioned directly query items. generated images roughly likely voted compatible. focus describing related work content-based compatible item recommendation conditional image generation using generative adversarial networks content-based compatible item recommendation many works assume similarity learning setting requires compatible items stay close learned latent space. mcauley proposed low-rank mahalanobis transform compatible items embeddings close latent space. veit utilized co-purchase records amazon.com train siamese network learn representations items. seol assumed different items outﬁt share coherent style proposed learn style representations fashion items maximizing probability item co-occurrences. contrast method designed learn asymmetric-relationships. several methods beyond similarity learning. iwata watanabe sawada proposed learn topic model compatible tops bottoms. packer mcauley extended work mcauley compute query-item-only dependent weighted distances items latent spaces handle heterogeneous item recommendation. however means query item prefers several subspaces. could deal diversity across different query items less effective diversity across compatible items query item model instead represents distance item candidate minimum distance prototype candidate allowing compatible items locate different locations latent space. addition method end-to-end trained coupled mrcgan generate images compatible items unlike methods. another line research tackles outﬁt composition problem attempts predict compatible item multi-item set. proposed learning representation outﬁt pooling item features produced multi-modal fusion model. prediction made computing compatibility score outﬁt representation. treated items outﬁt sequence modeled item recommendation bidirectional lstm predict next item current ones. note methods require mult-item sets given. potentially limitation practical use. explanation number prototypes size latent vector query items items recommended encoding function shorthand k-th projection shorthand squared distance generator discriminator latent vector prediction shorthand noise input generator distribution generative adversarial networks introduction generative adversarial networks popular train generative models gans shown capable conditional generation wide applications image generation class labels texts image transformation different domains works conditional generation focused similarity relationships. however compatibility represented complex many-to-many relationships compatible item could visually distinct query item different query items could overlapping compatible items. idea regularize gans metric related reconstruction loss used autoencoders requires reconstructed image stay close original image also applied gans comparing visual features extracted samples enforce metric sample space model instead regularizes subspace latent space subspace restriction known distribution could sampled visually distinct samples allowed close long similar compatibility relationships items. allows subspace learned powerful architecture. ﬁrst introduce novel projected compatibility distance function. then introduce model architecture learning objectives. finally introduce novel metric-regularized conditional notation used paper also summarized table figure projected compatibility distance. query item respectively projected distinct compatible items thus incompatible item none projections close encoding function additionally projections denoted {ek}k∈{...k} learned directly item latent vectors close clusters compatible items. latent vectors size finally compatibility distance computed follows model architecture experiments layers shared last layers outputs separated. achieved using siamese cnns feature transformation. illustrated figure rather learning embedding like original formulation projections learned item embedding prototype projections. discriminator learns discriminate real generated images generator learns fool discriminator encoded vector projected prototypes conditioned vectors. also adopt gradient penalty loss dragan maxv measures distance given vector predicted latent vector generated sample conditioned guides generator learn align latent space compatibility space. margin menc relaxes constraint generator collapse -to- decoder. finally generator also learns avoid generating incompatible items compatibility space learned metric within space could used regularize cgan. proposed model called metric-regularized cgan learning objectives illustrated figure discriminator outputs probability sample real predicted latent vector generator conditioned latent vector compatibility space constructed given query items items recommended noise input effect learned latent space constructed space subspace similar structure compatibility space. generate compatible items used conditioning vector generate items similar style respectively recommendation generation experiments batch size adam optimizer validation best epoch selection. last layer discriminative model takes fully-connected layer weight normalization except amazon also-bought/viewed experiments weight normalization used fair comparison. last layer following feature extractors different experiments fashionmnist++ mnist++ multi-layer cnns weight normalization amazon also-bought/viewed none amazon co-purchase inception-v polyvore inception-v generation experiments apply dcgan architecture model gan-int-cls mnist++. amazon co-purchase polyvore generation experiments λdra adopt srresnet-like architecture training different learning rate setting i.e. model parameter choosing inspired take skip connections generator since work well experiment also weight normalization layers. architecture shown figure experiments sets identical. however create non-overlapped sets restricting categories generation experiments amazon co-purchase polyvore dataset. dimension number respectively generation experiments. besides rest parameters taken follows mnist++ amazon co-purchase polyvore recommendation experiments baseline proposed compared baselines distance latent vectors siamese model monomer proposed packer mcauley although monomer originally trained end-to-end still cast end-to-end setting fashion-mnist++ dataset. model achieves superior performance experiments. addition model advantages efﬁciency compared monomer storage monomer since projected item spaces beforehand compute prototype projections recommendation approximately mink therefore query time could nearest-neighbor search parallel approximate results monomer needs aggregate weighted distances latent spaces. fashion-mnist++ dataset show model’s ability handle asymmetric relationships build dataset fashion-mnist dataset consists gray-scale images classes including t-shirt trouser pullover etc. create arbitrary asymmetric relationship follows means class cases belong among training samples pairs non-overlapped randomly selected form training validation sets respectively. besides pairs created testing samples testing set. samples split also non-overlapped. strategy forming pair randomly choose negative positive sample sample thus |r+| |r−|. erase class labels keep pair labels training reason underlying factor compatibility generally unavailable. repeat setting times show averaged result table like settings packer mcauley latent size equals here size model trained epochs. experiment shows model performs poorly highly asymmetric dataset model achieves best results. amazon also-bought/viewed dataset image features dimensions extracted beforehand dataset. following setting packer mcauley also-bought also-viewed relationships amazon dataset positive pairs negative pairs sampled accordingly. parameters monomer comparison i.e. also-bought also-viewed. train epochs model table shows results. compared error rates reported packer mcauley model yields best performance settings lowest error rate average. amazon co-purchase dataset based data split deﬁned veit increase validation randomly selecting additional pairs original training since original size small accordingly decrease training removing related pairs non-overlapping requirement. totally pairs remain training set. ratio positive negative pairs disrupted re-weigh sample training re-balance back besides randomly take direction pair since coadopt pre-trained weights veit replace last embedding layer model’s projection layer. last layer trained epochs model. still latent size veit equal thus monomer model. table shows results. model obtains superior performance veit comparable results monomer. polyvore dataset demonstrate ability model capture implicit nature compatibility create outﬁt dataset polyvore.com collection usergenerated fashion outﬁts. crawl outﬁts women’s fashion category group category items tops bottoms shoes. outﬁts ranked number likes chosen positive. three datasets constructed different recommendation settings tops others bottoms others shoes others. statistics dataset shown table construction procedure follows items source target categories nonoverlapped split according ratios training validation test sets. positive pair decided belongs positive outﬁt. combinations negative sub-sampled choosing items target categories positive pair. duplicate pairs dropped afterwards. dataset difﬁcult since compatibility information across categories longer exists pre-trained inception-v used extract image features last layer trained epochs. monomer pcd. scores listed table model still achieves best results. generation experiments baseline compare model gan-int-cls mnist++ experiment. used conditioning vector gan-int-cls model uses exact architecture except discriminator mrcgan outputs additional discriminator gan-int-cls conditioned experiments compare pixpix utilizes labeled image pairs image-to-image translation discogan unsupervisedly learns transform images different domain. mnist++ mnist dataset build similar dataset fashion-mnist++ result easier interpret. additional samples selected unlabeled data train gans. figure display generation results conditioned samples test set. found model could preserve diversity better projections automatically group different modes variation controlled changing amazon co-purchase dataset sample subset amazon co-purchase dataset reducing number types target items it’s easier gans work with. particular keep relationships clothing watches shoes women’s men’s categories. re-weigh sample training balance ratio positives negatives validation simply drop excessive negative pairs. totally remain positive pairs negative pairs training validation test split respectively. unlabeled training gans selected training veit consist items source target categories respectively. image also resized discriminator. discogan pixpix inherently designed similarity learning shown figure could produce satisfying results. moreover model produces diverse outputs diversity conventional image-to-image models limited. additionally sample images conditioned illustrated figure mrcgan ability generate diverse items similar style polyvore top-to-others dataset top-to-others split demonstration methods. likewise reweigh sample training balance positive negative pairs encourage model focus positive pairs. results shown figure user study finally conduct online user surveys whether model could produce images perceived compatible. conduct types surveys users given random image source categories three generated images different models randomized order. users asked select item compatible source item none items compatible select recognizable one. users given random image source categories random image target categories image generated mrcgan randomized order. users asked select compatible item source item none items compatible users decline answer. results shown figure shows mrcgan generate compatible realistic images compatibility learning setting compared baselines. difference random images small polyvore survey mrcgan signiﬁcantly preferred amazon co-purchase survey. also consistent discriminative performance. discussion shown table larger gives better performance total embedding dimension kept equal differences small size increased continuously. regularizer controlled forces distances prototypes compatible item block images represents conditional generation. top-left conditioning image top-right four samples generated bottom-left bottom-middle discogan mrcgan conditioned bottom-right pixpix block images represents conditional generation based latent vector conditioning mrcgan generates items similar style instead compatible items. propose modeling asymmetric many-to-many relationship compatibility learning compatibility family representation prototypes end-to-end system novel projected compatible distance function. learned compatibility family achieves accurate recommendation results compared state-ofthe-art monomer method real-world datasets. furthermore learned compatibility family resides meaningful compatibility space seamlessly coupled proposed mrcgan model generate images compatible items. generated images validate capability compatibilty family modeling many-to-many relationships. furthermore compared approaches generating compatible images proposed mrcgan model significantly preferred user surveys. recommendation generation results justify usefulness learned compatibility family. authors thank chih-han colleagues appier well anonymous reviewers constructive comments. thank chia-yu joey tung organizing user study. work mostly completed sun’s visit appier summer research part industrial collaboration project national tsing university appier. also thank supports project --e--.", "year": 2017}