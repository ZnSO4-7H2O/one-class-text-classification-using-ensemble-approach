{"title": "Learning to Cluster for Proposal-Free Instance Segmentation", "tag": ["cs.CV", "cs.AI", "cs.LG"], "abstract": "This work proposed a novel learning objective to train a deep neural network to perform end-to-end image pixel clustering. We applied the approach to instance segmentation, which is at the intersection of image semantic segmentation and object detection. We utilize the most fundamental property of instance labeling -- the pairwise relationship between pixels -- as the supervision to formulate the learning objective, then apply it to train a fully convolutional network (FCN) for learning to perform pixel-wise clustering. The resulting clusters can be used as the instance labeling directly. To support labeling of an unlimited number of instance, we further formulate ideas from graph coloring theory into the proposed learning objective. The evaluation on the Cityscapes dataset demonstrates strong performance and therefore proof of the concept. Moreover, our approach won the second place in the lane detection competition of 2017 CVPR Autonomous Driving Challenge, and was the top performer without using external data.", "text": "representation. additionally proposal-free approaches usually focus instance labeling directly leverage categorical predictions semantic segmentation semantic labeling. approach belongs proposal-free style. reduce two-stage paradigm single forward pass fully convolutional network achieve designing novel learning objective uses pairwise relationships pixels supervision guide learn pixel-wise clustering. trained proposed objective learns directly assign cluster index pixel pixel cluster regarded object instance. clustering done forward propagation fcn. turns capable learning pixel-wise clustering generalize learned clustering mechanism unseen images. number cluster indices available limit number instances separated approach. provide strategy deal case unlimited number instances. inspired graph coloring theory reuses indices coloring graph inject coloring strategy learning objective. therefore trained assign different indices neighboring instances reusing index objects away other. coloring result individual instance naively recovered connected components extraction. formulate lane detection problem instance labeling problem approach second place lane detection competition cvpr autonomous driving challenge. difference accuracy ﬁrst place insigniﬁcant. considering performer used large amount external data training advantage approach becomes even signiﬁcant. also able perform prediction real-time lane detection problem involves single category limited number instances; therefore extend evaluation multi-category dataset unlimited instance setting speciﬁcally cityscapes dataset. approach demonstrates strong performance achieving comparing shares similar insights using graph coloring learning perform pixel-wise clustering. resulting clusters used instance labeling directly. support labeling unlimited number instance formulate ideas graph coloring theory proposed learning objective. evaluation cityscapes dataset demonstrates strong performance therefore proof concept. moreover approach second place lane detection competition cvpr autonomous driving challenge performer without using external data. instance segmentation task combines requirements semantic segmentation object detection. needs pixel-wise semantic labeling also requires instance labeling differentiate object pixel level. since semantic labeling directly obtained existing semantic segmentation approach instance segmentation methods focus dealing instance labeling problem. usually achieved assigning unique identiﬁer pixels belonging object instance. instance labeling becomes challenging task occlusions occur vastly varying number objects cluttered scene exist. example current performance cityscapes dataset reaches accuracy terms average precision still leaves much room improvement. techniques solve instance segmentation roughly grouped categories proposal-based methods proposal-free methods. proposal-based methods object proposals classes ﬁrst predicted foreground-background segmentation bounding performed. proposal-free approaches exclude step proposal generation. approaches usually stages. ﬁrst learn representation pixel level second stage group pixels using clustering algorithm learned fig. overview approach. address labeling problem formulating novel learning objective. guides fully convolutional networks learn perform instance labeling. summary make several contributions. first formulate novel objective train perform instance labeling. second demonstrate combine graph coloring theorem augment learning objective. third empirically show deep able learn clustering image pixels end-to-end fashion. proposal-based methods type approach usually follows detect-then-segment paradigm ﬁrst detects bounding object proposal region. variant approaches example uses rnns generate proposals instead using proposal network. uses bounding potential formulation. performance affected quality bounding boxes prefer round instance. therefore approach suitable thin long instance like lane line road. contrast proposal-free approaches limitations. proposal-free methods although approaches type share two-stage scheme representation learning clustering wide spectrum ways achieve pixel prediction breakpoints apply sequential grouping clustering pixels. learns energy level pixel followed watershed clustering. learns discriminative feature vector mean shift clustering. uses object boundary prediction multicut algorithm learn several handpicked features heuristic spectral clustering. formulate instance labeling node labeling problem feasible solution using search algorithm. learns position-sensitive score maps merge masks assembling module. method belongs category different specify intermediate representation learning. learn perform instance labeling directly. instance labeling task deﬁned follows. image input task predict mask instance. done assigning unique index pixels mask. index integer number instances scene. crucial property assignment unique. speciﬁcally swapping index masks still lead valid assignment equivalent segmentation. referred quotient space property goal task learn function assign index pixel index pixel image. resultant labeling pixels image i.e. {yi}∀i fulﬁll relationship pixels deﬁned since labels ground-truth instantiation labeling based underlying relationship propose directly supervision training. using learning objective preferable using ground-truth labeling. since instance particular instance assigned manner forcing particular labeling makes learning task difﬁcult labeling consistent image image precise representation actual learning objective. reconstructing given labeling straightforward equation learning objective fully convolutional neural network make pixel-wise prediction. deﬁne outputs probability assigning pixel certain instance index multinomial distribution. inspired intend pixels belong instance predicted distributions similar dissimilar otherwise. distance distributions could evaluated kullback-leibler divergence. given pair pixels corresponding output distributions denoted number indices available labeling. cost pixels belong instance regardless size. pixels instance randomly sampled uniform distribution. create pairs possible pairwise relationships sampled pixels enumerated. therefore million pairs image generated upon applied. treat background instance handle differently unbalanced nature. since background contains majority pixels image sampled points sparse. using cityscapes image example density sampled points background roughly leads obvious limitation boundary instance background hard learn. fact predicted instances tend stretch signiﬁcantly background region. trivial solution increase number samples background region. push notion extreme background pixels training. however consider unary prediction instead pairwise relationships. speciﬁcally binary classiﬁcation loss background background instance still share output vector represents instance index. achieve that reserve index zero background. given dimension predicted outputs summation non-zero indices probability non-background. formulate criterion background classiﬁcation similar binary cross entropy loss total number pixels image. indicator function returns pixel background. equal resulting derivative different formulation encourage outputs background. {}∀ij contain pairs sampled pixels averaged pairwise loss deﬁned section iii-a represent instance ids. therefore limits maximum number instances could detected. although ﬁxed amount instance sufﬁcient applications lane detection autonomous driving becomes limitation datasets like cityscapes segmenting arbitrary number objects. although deal problem increasing dimension output vector introduce problems. fig. example outputs lane detection. colors represent different instance ids. outputs pixel dimensional vector represents probability distribution pixel assigned certain learning objective guides output similar distribution pixels lane line vise versa. testing time pixel assigned highest probability. cost symmetric w.r.t. alternatively assumed constant. different instances output distributions expected different described hinge-loss function ||pi) example associated idea equation illustrated ﬁgure apply equation outputs softmax layer standard originally designed semantic segmentation. therefore loss function easy deploy combine pixelwise prediction tasks like semantic segmentation depth estimation. combining sampling strategy objective equation uses pairwise information pixels. number pairs grow quadratically number pixels image. therefore feasible pixels image. adopt sampling strategy. ﬁxed total number pixels sampled training time. pixels ground-truth instance masks picked instances image receive number samples first relax coloring rules constraint must satisﬁed soft guideline. guideline neighboring instances different ids. presented learning objective used training stage. second distance threshold value larger pixel threshold applied pairs randomly sampled pixels section iii-a. compared original contains pairs sampled pixels contains pairs spatial distance within threshold figure demonstrates example sampling. yellow dots sampled pixels. black edges means nodes similar predicted label distribution white edges represent dissimilar pairs. pixels distance larger considered edge therefore contribute loss learning objective. choosing number color special case inﬁnity threshold edges instances equal number object instance image. decreasing chromatic number graph also decreasing. trend stops becomes coloring problem chromatic number note necessary consider case smaller pixel. case instances independent i.e. edge vertices therefore color sufﬁcient color graph. however individual instance pixels can’t extracted resulting coloring. since transform coloring constraints soft learning objective choice hard requirement. based arguments paragraph setting number larger equal four could sufﬁcient also dependent setting determine parameters empirically. applications limited number instances applying approach section iii-a sufﬁcient. example lane detection autonomous vehicles usually bounded number visible lanes camera view. beneﬁt applying section iii-a standalone fully end-to-end solution accomplished standard fcn. post-processing required. contrast number instances unlimited approaches ﬁrst distribution number instances image usually long-tail distribution. images contains instances small fraction large number objects cases majority output nodes trained small fraction training data. therefore leads poor performance. second efﬁciency consideration. high dimension output layer greatly increase computation time since output size equal input image. section describe generic approach labeling unlimited number instances ﬁxed number ids. inspired graph coloring problem reformulate index assignment task graph coloring task. regard region instance vertex -to-). distance regions decides whether edge exists not. goal graph coloring assign color vertex neighboring vertices different colors. graph called k-colorable assignment fewer colors. minumum graph called chromatic number. could possibly much smaller number vertices example distance threshold pixel edges adjacent instances. case also called coloring problem. according fourcolor theorem need four colors make sure instances color different neighbors. colors mentioned equivalent indices used label instance pixels. compatible k-colored means adjacent instance color. condition individual instance region extracted ﬁnding connected components pixel level i.e. growing region share connected component assigned unique ﬁnal outputs. figure illustrates process. section evaluate performance proposed method vastly different datasets. ﬁrst lane detection dataset second benchmark cityscapes dataset. submission lane detection competition place evaluated performance speed cityscapes instance segmentation results entry among entries among four proposal-free entries. tusimple dataset contains video clips highway driving scenes training set. image video clip annotated ground-truth lane lines. number lane lines vary lane lines labeled arbitrary order. task predict individual lane lines test images. consider lane lines thin long region image. therefore becomes single category multi-instance segmentation task. evaluation metric used challenge recall penalty extra detections. recall score calculated detected lane lines densely evaluated pixel rather sampled horizontal lines spaced every pixels. sampled points compared sampled points ground-truth. distance pixels considered matched point. score lane line computed averaged give ﬁnal score image. since recall biased toward methods many detections ﬁnal score also penalizes extra detections beyond number lines ground-truth. submissions must also achieve minimum speed single accepted. challenge competition correctly predict number lines exact position. formulate instance segmentation problem drawing lane lines pixel-width. obtain thin long mask lane lines. since lane lines dataset problem limited amount instances. designed network output vector pixel location representing probability pixel belonging particular index including background. loss function used equation experiment setting network backbone resnet- conﬁguration train network split training images training validation. applied standard data augmentation training images. sampled pixels line compute stochastic gradient descent used optimize case multiple categories note instance assignment approach category agnostic. therefore needs external information help assigning class instance. instance mask average predicted semantic segmentation probability masked region dominant category. intersection instance mask dominant category mask semantic segmentation used ﬁnal instance output. since straightforward output branch predict semantic segmentation sharing layers except ﬁnal layer. section describes network architecture used figure illustrates diagram. style widely used pixel-wise prediction referred major beneﬁt using conﬁgurable dimension pixel-wise feature map. implementation layers conv- conv- weights initialized pretrained resnet conv-p conv-p kernel size followed batch normalization relu. conv-xp layers outputs channel dimension conﬁgurable. outputs conv-xp layers up-sampled element-wise summation outputs lower layers. resulting feature feature channels four times smaller input image. furthermore since element-wise summation combine features different convolution blocks conv-xp work like learning residual representation constructing task-speciﬁc layers added instance assignment task convolution layers. ﬁrst kernel output channels followed batch normalization relu. second kernel dimension outputs maps instance background pixel-wise prediction tasks also added construct multi-head structure multi-task learning; example semantic segmentation boundary detection depth estimation object center prediction. tasks reuse two-layer structure changing number ﬁnal outputs target fig. visualization lane detection tusimple dataset lines predictions green lines ground-truth. second shows outputs network. colors represent assigned ids. proposed learning objective initial learning rate decays epochs factor epochs. testing outputs network cluster indices assigned pixels cluster index corresponds line benchmarking purpose mean x-coordinate line speciﬁc hight calculated produce exact submission format. results discussion table shows performers among teams lane detection challenge. accuracy deﬁned equation false-positive falsenegatives also listed reference. method second position performer without using labeled external training data. performer xinganpan uses approach requires speciﬁcally designed layer e.g. scnn needs lanes labeled certain order e.g. left right uses standard cross entropy loss classify lines. contrast approach uses standard convolution layers lanes presented random order. therefore method largely simplify labeling effort constructing training data. third performer davyneven also utilizes instance segmentation strategy learning objective learns embedding pixel feature vector therefore needs extra post-processing cluster pixels discovering lines. non-trivial make hyper-parameters predeﬁned clustering algorithm perform well. hard decide number road lanes. contrast network performs clustering endto-end fashion predict active clusters cityscapes dataset high quality instance segmentation annotation different object classes. common benchmark comparing instance segmentation performance. cityscapes challenging dataset lane detection dataset three ways. first lane lines relatively well structured objects cityscapes arbitrary shape scale location. secondly number objects cityscapes larger unbounded. lastly cityscapes contains multiple categories. therefore target demonstrate generalizability approach. experiment setting ofﬁcial splits training validation testing images respectively. evaluation also ofﬁcial scoring calculates average precision various intersection-over-union thresholds i.e. step size predicted instances ground truth instances. additionally report overlap objects closer objects closer network used backbone pre-trained resnet-. feature dimension enlarge ﬁeld view pyramid pooling module conv-. pyramid pooling four pooling scales up-sampling element-wise fig. sample outputs model cityscapes validation set. colors represent different instance ids. ground-truth. network outputs eight colors. rightmost column ﬁnal outputs connected component extraction merging. feature ﬁgure instead projection concatenation original design. purpose obtaining category instance post-processing extra task-speciﬁc modules feature semantic segmentation predicting object center. later module output corresponds vector pointing object center speciﬁc pixel. usage described next section. training network sampled pixels object. loss lpair form tuned validation set. cross entropy loss semantic segmentation smooth loss regression object center prediction. weights instance assignment semantic segmentation object center prediction respectively. stochastic gradient descent optimize three losses jointly learning rate decays epochs factor post-processing instance obtains category prediction semantic segmentation. calculation described section iii-c. since apply graph coloring strategy unlimited number instance connected component extraction applied. therefore occluded object might separated multiple masks step. predicted object center reunion segments. average predictive object center ﬁrst obtained segment segments merged average center within pixels tuned validation set. merge operation helps occlusion case also situation object separated several segments large size. results discussion results test summarized table ranked forth among proposalfree approaches. method signiﬁcant advantage also leverages graph labeling concept. analyze effect semantic segmentation quality table iii. since semantic segmentation used decide category pixel plays substantial rule affect score. three semantic segmentations compared semantic segmentation outputs network prediction pspnet groundtruth results show clear trend increased semantic segmentation enhanced. despite fact network outputs used evaluations also evaluate effect conﬁdence score. oracle ranking used table combined ground-truth semantic segmentation instance masks could reach also explains qualitative result ﬁgure visually appealing gets fair score benchmark. limitation using evaluate instance segmentation also discussed besides effect semantic segmentation conﬁdence ranking another dominant failure mode neighboring segments assigned example third ﬁgure merges adjacent cars. another defect network sometimes over-segmentation example cars last problem usually mitigated merging step. leave possible enhancement future work. proposed novel objective train network perform clustering-based instance labeling. adjusting sampling method able inject graph coloring strategy learning objective. strong performance vastly different datasets demonstrates generalizability applicability proposed learning strategy. cordts omran ramos rehfeld enzweiler benenson franke roth schiele. cityscapes dataset ieee conference semantic urban scene understanding. computer vision pattern recognition june instance-aware semantic segmentation proceedings ieee conference multi-task network cascades. computer vision pattern recognition pages sun. r-fcn object detection regionbased fully convolutional networks. advances neural information processing systems pages ieee international conference computer vision zhang sun. deep residual learning image recognition. proceedings ieee conference computer vision pattern recognition pages ioffe szegedy. batch normalization accelerating deep network training reducing internal covariate shift. international conference machine learning pages chen object detection free instance segmentation labeling transformations. arxiv preprint arxiv. kirillov levinkov andres savchynskyy rother. ieee instancecut edges instances multicut. conference computer vision pattern recognition july levinkov uhrig tang omran insafutdinov kirillov rother brox schiele andres. joint graph decomposition node labeling problem algorithms applications. ieee conference computer vision pattern recognition long shelhamer darrell. fully convolutional networks semantic segmentation. proceedings ieee conference computer vision pattern recognition pages zagoruyko lerer pinheiro gross chintala doll´ar. multipath network object detection. proceedings british machine vision conference bmvc york september", "year": 2018}