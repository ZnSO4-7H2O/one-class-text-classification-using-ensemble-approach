{"title": "Automatic Estimation of Fetal Abdominal Circumference from Ultrasound  Images", "tag": ["cs.CV", "stat.ML"], "abstract": "Ultrasound diagnosis is routinely used in obstetrics and gynecology for fetal biometry, and owing to its time-consuming process, there has been a great demand for automatic estimation. However, the automated analysis of ultrasound images is complicated because they are patient-specific, operator-dependent, and machine-specific. Among various types of fetal biometry, the accurate estimation of abdominal circumference (AC) is especially difficult to perform automatically because the abdomen has low contrast against surroundings, non-uniform contrast, and irregular shape compared to other parameters.We propose a method for the automatic estimation of the fetal AC from 2D ultrasound data through a specially designed convolutional neural network (CNN), which takes account of doctors' decision process, anatomical structure, and the characteristics of the ultrasound image. The proposed method uses CNN to classify ultrasound images (stomach bubble, amniotic fluid, and umbilical vein) and Hough transformation for measuring AC. We test the proposed method using clinical ultrasound data acquired from 56 pregnant women. Experimental results show that, with relatively small training samples, the proposed CNN provides sufficient classification results for AC estimation through the Hough transformation. The proposed method automatically estimates AC from ultrasound images. The method is quantitatively evaluated, and shows stable performance in most cases and even for ultrasound images deteriorated by shadowing artifacts. As a result of experiments for our acceptance check, the accuracies are 0.809 and 0.771 with the expert 1 and expert 2, respectively, while the accuracy between the two experts is 0.905. However, for cases of oversized fetus, when the amniotic fluid is not observed or the abdominal area is distorted, it could not correctly estimate AC.", "text": "practice clinicians manually obtain standard planes process requires knowledge anatomy spatial perception thus accuracy dependent operator’s experiences accuracy estimated fetal weight using ultrasound holds intrainter-observer variability fetal weight extrapolated formulation fetal biometric measurements among biometric measurements predictive fetal weight thus variation measurement leads inaccurate fetal weight estimation ensure precise plane perpendicular true fetal longitudinal axis clinician continuously move transducer plane consisting accurate landmarks. process ﬁrstly cumbersome fetal movement breathing movement fetal position hinder prompt acquisition plane; secondly lead inaccurate measurement inexperienced operators often fail adhere multiple landmarks correct plane therefore development implementation automated fetal biometric measurements recently gained spotlight hope improve clinicians’ workﬂow overcome operator-dependency stable morphologcal information extraction ultrasound images numerous methods suggested handle noisy ultrasound images affected signal dropouts artifacts missing boundaries attenuation shadows speckle methods order deal inherent difﬁculties image intensity-based gradient-based methods preferred extract boundaries target anatomies abdominal circumference image gradient-based methods shows stable performance progresses high contrast surroundings automatic measurement considered challenging issue fetal abdomen contrast surroundings non-uniform contrast irregular shape ultrasound images. addition boundary extraction methods important evaluate given ultrasound image proper measurement although evaluation essential automate entire diagnostic process measurement model limited proper plane extract instead image-based approaches machine learning methods probabilistic boosting tree used fetal biometry including method multi-class discriminative model constructing tree nodes distinct strong classiﬁers made several weak classiﬁers. classifying segment structures ultrasound images method estimates fetal biometry parameters although approach showed notable abstract—ultrasound diagnosis routinely used obstetrics gynecology fetal biometry owing timeconsuming process great demand automatic estimation. however automated analysis ultrasound images complicated patient-speciﬁc operatordependent machine-speciﬁc. among various types fetal biometry accurate estimation abdominal circumference especially difﬁcult perform automatically abdomen contrast surroundings non-uniform contrast irregular shape compared parameters.we propose method automatic estimation fetal ultrasound data specially designed convolutional neural network takes account doctors’ decision process anatomical structure characteristics ultrasound image. proposed method uses classify ultrasound images hough transformation measuring test proposed method using clinical ultrasound data acquired pregnant women. experimental results show that relatively small training samples proposed provides sufﬁcient classiﬁcation results estimation hough transformation. proposed method automatically estimates ultrasound images. method quantitatively evaluated shows stable performance cases even ultrasound images deteriorated shadowing artifacts. result experiments acceptance check accuracies expert expert respectively accuracy experts however cases oversized fetus amniotic ﬂuid observed abdominal area distorted could correctly estimate ultrasound commonly used tool ﬁeld obstetrics anatomical functional surveillance fetuses. fetal biometry head circumference abdominal circumference known useful predicting intrauterine growth restriction fetal maturity estimating gestational acquisition standard plane includes speciﬁc anatomical structures landmarks prerequisite subsequent biometric measurements including femur length clinical park j.-y. kwon department obstetrics gynecology institute women’s life medical science yonsei university college medicine seoul south korea. asterisk indicates corresponding author using fetal abdominal region detection using hough transform acceptance plane veriﬁcation using another explaining proposed method detail review cnn. type artiﬁcial neural network inspired visual information processing brain. recognize complex features visual information consists several layers extract repeatedly combine low-level features composing high-level features. composed highlevel features used classify input image. generally many cnns consist combinations convolutional pooling fully connected layers. convolutional layer extracts higher-level features convolving received feature maps previous layer activating convolved features. paper rectiﬁed linear unit used activation function. c-layer usually followed pooling layer reduces dimensions feature maps pooling. pooling downsamples input feature maps striding rectangular receptive ﬁeld taking maximum ﬁeld. c-layers p-layers fully connected layer integrates high-level features produces compact feature vectors. like c-layers relu used activation function f-layers research. ﬁnal layer j-th layer output layer produces posterior probability class. classiﬁcation achieved ﬁnding label corresponding maximum training desires proper parameters using training data. proper entropy energy deﬁned desired minimized denotes training data. words proper parameters obtained optimization problem details readers refer proposed structure based following observations motivated comparison sonographers’ classiﬁcation process conventional structures object recognition accurate classiﬁcation local non-local structure information need integrated. example fig. observe positions similar local patterns distinct non-local structures. recently great successes object recognition convolutional neural network attracted much attention also applied fetal biometry analyze high-level features ultrasound image data. method aims standard abdominal plane succesive ultrasound frames localize fetal abdomen ultrasound image. although approaches function. approaches however implement part entire measurement process need integrated full automation measurement process. additionally method faced obstacles clinical environment difﬁcult collect sufﬁcient data training difﬁcult cope serious artifacts including shadowing artifacts paper propose method increases classiﬁcation performance relatively small number data also deals artifacts including ultrasound propagation direction well multiple scale patches inputs. proposed method classiﬁes images patches ultrasound image anatomical structures classiﬁcation allows veriﬁcation acceptability given abdominal plane. detecting anatomical structures fetal abdomen estimate accepted plane using ellipse detection method based hough transform. validated method using ultrasound data measurement fetuses weeks gestation. three trained clinicians evaluated accepted abdominal planes estimated method. major contribution work follows develop specialized structure takes account sonographers’ decision process considering characteristics ultrasound imaging. proposed structure shows high training performance spite relatively number training samples. develop framework combines hough transform complement other. simultaneously provides evidence plane evaluation pre-processing ultrasound image estimation. combination achieve stable estimation compared case using mathematical model alone. fetal measurement requires suitable selection transabdominal ultrasound images shown fig. identiﬁcation fetal region noisy ultrasound images. standard plane must contain stomach bubble portal section umbilical vein characteristic hockey-stick appearance additionally exists portion fetal boundary overlaps portion amniotic ﬂuid boundary. utilize facts distinguished shadowing artifacts appear anechoic region b-mode ultrasound images. taking account observations proposed method consists three main steps anatomical structure detection fig. fetal abdominal ultrasound images anatomical structures. standard plane stomach bubble appearing hockey-stick bending must demonstrated. position respect probe position. computational efﬁciency size input small possible. however second observation need local non-local structure information classify position accurately. therefore used image patches corresponding normal view wide view inputs. firstly sized local image patch selected normal-view image patch analyze local structure around given position using image pattern. secondly sized non-local image patch selected wide-view image patch combine local structure structures position. reduce computational cost wide-view image patch simpliﬁed low-resolution image size output proposed structure vector corresponds categories main anatomical structures standard abdominal plane chose image patches centered dark pixels given ultrasound image. then proposed allows classiﬁcation chosen image patches categories. result semantically segmented image made coloring chosen pixels according categories. proposed begins three branches designed handle propagation direction image patch multiple views. branch extracts desired image features analyzes propagation direction. shown fig. branches image analysis basically consist pairs convolutional max-pooling layers well fully connected layer. branch analyzing normal-view image patch ﬁrst second convolutional layers respectively used ﬁlters max-pooling used stride step maxpooling layers. branch analyzing wide-view image patch consists structure combinations result produced branch concatenated feature vector classiﬁcation. vector passes fully connected layers classify given data classes. made semantic segmentation image using classiﬁcation results commonly used measurement manual ﬁtting ellipse fetal abdominal contour. order detect ellipse form automatically ellipse detection method based hough transform proposed. however direct application methods extracted region could produce undesired ellipse candidates since region semantic image surround entire fetal abdomen region select proper ellipse candidates generated ellipse detection method accept ellipses ratio minor axis major axis greater among remaining candidates half candidates less amount selected fetal abdominal boundary stable result medians major axis minor axis center angle positive horizontal axis major axis candidate ellipses taken parameters ﬁnal ellipse. estimate calculating selected ellipse boundary using fig. overall process proposed framework. proposed framework performs semantic segmentation using measurement plane acceptance check. especially used semantic segmentation admits normal-view wide-view ultrasound propagation direction section evaluate suitability selected plane determine whether plane appropriate measuring semantic segmentation image cropped estimated fetal abdomen area previous step cropped image rescaled size described fig. especially gray region corresponding shadowing artifact excluded image rescaled. admitting rescaled image input table estimates suitability probability given image appropriate measuring consists three pairs convolutional pooling layers three fully-connected layers. ﬁrst convolutional layer detects features different channels mean different anatomical structures feature information propagated following convolutional layers analyse anatomical conﬁguration. last three fully-connected layers integrate detected features determine suitability. transabdominal ultrasound images obtained expert reviewed ultrasound experts including operator. either experts accepts given image given image considered acceptable image. proposed evaluated comparing acceptance result experts’ acceptance result. fig. proposed structure. uses input data combination image patches multiple sizes ultrasound propagation direction. image patches propagation directions feature vectors extracted combined classify given image patch. cases ultrasound images case consists several true false abdominal ultrasound images obtained pregnant woman experts ultrasound machine –-mhz transabdominal transducer. provided cases separated training cases test cases consist cases cases respectively. training images used generate training data classiﬁcation acceptance check tune heuristic parameters ellipse detection. caffe used implement train proposed framework. framework consists proposed cnns hough transform-based ellipse detection implemented matlab python. mentioned fetal abdominal ultrasound images test cases provided pairs image patches multiple views extracted images ultrasound propagation direction patches. extracted patches divided sets training test evaluate training process simple cross validation. ratio training test approximately used adam minimize loss function dropout ratio last layer training prevent overﬁtting fig. relation ultrasound propagation direction image pattern direction image patches. image patch corresponding shadowing artifact image pattern strongly related ultrasound propagation direction compared patch corresponding fig. variation observed image feature according size view. local pattern dark region appear similar relatively small size view however size view increases distinct image feature appears view. training evaluation fetal abdominal ultrasound images provided department obstetrics gynecology yonsei university college medicine seoul korea provided fig. fetal abdomen detection work ﬂow. acquired sementic segmentation image. extracted region boundary images respectively. candidates fetal abdomen generated hough transform. candidates best ﬁtting ellipse choose shown experts’ caliper placement fig. process acceptance check. semantic segmentation image detected ellipse. based detected ellipse semantic segmentation image abdominal region cropped like yellow cropped image rescaled image used input acceptance check. fig. initialized ﬁlters fully-connected layer propagation direction. filters initialized component ﬁlters follows gaussian distribution ﬁlters uniformly distributed toward imaging range expert’s example caliper placement. compared automatic caliper placement expert’s placement tends smaller. vectors fig. correspond initialized ﬁlters directional ﬁlters fully-connected layer branch propagation direction analysis direction branch. fig. shows directional ﬁlters initialized randomly distributed vector normal distribution uniformly distributed vectors. training processes initialization strategies compared training process without direction analysis branch. comparison ﬁlters image branches initialized ﬁlters three cases. training loss test accuracy changes plotted graph fig. respectively. directional ﬁlters randomly initialized ﬁlter vectors could toward image range vectors obtuse ultrasound propagation direction image range described fig. inner-products obtuse vectors ultrasound propagation directions negative neurons corresponding obtuse ﬁlter vectors activated relu function ﬁlters updated training. fig. difference training performances notable cases randomly initialized directional ﬁlter without direction analysis branch. hand directional ﬁlters initialized uniformly distributed toward image range directional ﬁlters contribute classiﬁcation. therefore results convergence speed increases uniform initialization case. following sections trained ﬁlters initialized directional ﬁlters uniformly distributed vector toward imaging range. ultrasound images labelled true axial planes experts measurement used perform semantic segmentation using proposed cnn. every anechoic point images image patches corresponding normalwide-views ultrasound propagation direction used input proposed cnn. described fig. classiﬁcation results anechoic points given ultrasound image represented color maps whose green blue gray colors correspond respectively. since could inefﬁcient choose candidate ellipses among possible ellipses ﬁlter worthless ellipses. example ellipses overlap amniotic ﬂuid region abnormal ratio major minor axes possibility selected candidates. fig. train loss test accuracy trained following three casese ﬁlters initialized unifomrly distributed toward imaging domain ﬁlters initialized randomly gaussian distribution ultrasound propagation direction used classiﬁcation hand image branches weights initialized values three cases. fig. result measurement. applying proposed corresponding semantic segmentation images obtained respectively. localization proposed hough transform-based method. placement calipers similar experts’ caliper placement order make clear criteria used true abdominal images annotations length training images. true abdominal images heuristically chosen lower bound ration major minor axes ellipse annotation. criteria candidates ellipsoidal contours selected single region image extracted semantic segmentation image median parameters chosen. although contours localized abdominal regions well using lower bound ratio detected contours tend larger contours annotated experts described fig. comparing measurement results experts’ measurement training images decided multiply adjust automatic measurement. regions fetal abdomen fully surrounded proposed hough transform-based approach segments fetal abdominal regions. compared estimation accepted ultrasound images experts method. comparison abdominal contours selected experts ellipsoidal contour plotted fig. abdomen region obtained estimation ground truth abdomen region delineated doctors. similarity metric explains ground truth detected region close overlapped other. dice similarity train plane acceptance check used true false transabdominal plane images images training cases. training test sets acceptance check consist cases annotated images respectively. case training test sets semantic segmentation performed fetal abdominal region localized using proposed hough transformbased approach. based localization semantic image cropped rescaled mentioned above. augment training rescaled image rotated every degrees degree mirrored. training adam dropout applied too. training threshold level accept true axial plane determined maximize test accuracy proposed acceptance check using test set. performance evaluation transabdominal images among annotated ultrasound images images test cases used evaluation. valuation compared acceptance check results among experts using accuracy number true positive true negative false positive false negative respectively. shown table accuracy acceptance check results expert expert respectively accuracy experts although showed good performance image recognition recently requires collection large amount training data achieve satisfactory pixel-wise classiﬁcation results. unfortunately owing limitation gathering clinical data difﬁcult collect sufﬁcient data guarantee satisfactory classiﬁcation various cases ultrasound images. trained image data owing lack physical characteristics number training data required increases. attempted evade problem designing modality-speciﬁc structured obtained notable improvement training performance. also used technique evaluate suitability selected image proper measurement suitability check performed analyzing anatomical conﬁguration regions semantic segmentation images. ultrasound imaging systems method used select best abdominal biometry plane volume data. approaches suitability evaluation reported literatures abdominal region used acceptance check. fig. indicates cases detected ellipses method insufﬁcient accepted although fetal abdomen classiﬁed well. cases fig. detected ellipses relatively acceptable position lack region causes inaccurate caliper localization. explained clinical situations could guaranteed sufﬁcient anechoic points appear region ultrasound image accurate stable ellipse detection. therefore would desirable combine method supplementary method develop advanced detect ribs spine known crucial acceptance check ﬁtting. second although augmented given true false abdominal plane images numbers true false images balanced guarantee balanced performance true false cases. false abdominal images acceptance check performed well accuracy true abdominal planes lower false planes. given true images sufﬁcient represent features true abdominal planes. additionally established architectures adopted part proposed architecture u-net. limited memory computing environment difﬁculty sharing training established architectures. sufﬁcient computing environment performance could improved sharing established architectures pre-trained ﬁlters called domain-transferred deep experiments technical difﬁculties fetal ultrasound images provided without probe geometry available method implemented ultrasound system. absence information performance framework could decrease. experiments order evaluate ultrasound propagation direction assumed probe located certain point image position applied provided images even though images different imaging range. performance comparison existing methods automatic measurement none existing methods provides stable performance quantitative results similar experimental environmental refer quantitative results parts head femur. summary proposed method automatic estimation ultrasound images. method shows good performance cases relatively small number training data. suggests machine learning might breakthrough medical imaging ﬁeld focusing developing modality-speciﬁc structures cnn. even though proposed method shows limitations cases oversized fetuses images highly corrupted shadowing artifact expect proposed method automated measurement contribute measure accurate leading estimate fetal weight accurately well decrease operator dependency measurement. furthermore method helpful artiﬁcial intelligence technique automated measurement ultrasonography addition current automation techniques. fig. cases whose ﬁttings inapproparate. ﬁrst ﬁtted ellipse properly localized bigger shpae lack abdominal boundary information along minor axis direction. case second lack region left part causes underestimate even though region fetal abdomen classiﬁed. hadlock harrist sharman deter park estimation fetal weight head bodyand femur measurements-a prospective study american journal obstetrics gynecology vol. chen yang wang p.a. heng. standard plane localization fetal ultrasound domain transferred deep neural networks ieee journal biomedical health informatics vol. yang chen c.t. chin chen p.a. heng wang standard plane localization ultrasound radial component model selective search ultrasound medicine biology vol. campbell wilkin ultrasonic measurement fetal abdomen circumference estimation fetal weight bjog international journal obstetrics gynaecology vol. pp.– espinoza good russell does automated fetal biometry improve clinical work efﬁciency? journal ultrasound medicine vol. rueda evaluation comparison current fetal ultrasound image segmentation methods biometric measurements grand ieee transactions medical imaging vol. challenge s.t. acton speckle reducing anisotropic diffusion ieee transactions image processing vol. s.m. jardim m.a. figueiredo segmentation fetal ultrasound images ultrasound medicine biology vol. detection measurement fetal abdominal contour ultrasound images local phase information iterative randomized hough transform bio-medical materials engineering vol. nithya madheswaran detection intrauterine growth retardation using fetal abdominal circumference international conference computer technology development carneiro georgescu good comaniciu detection measurement fetal anatomies ultrasound images using constrained probabilistic boosting tree ieee transactions medical imaging vol. srivastava g.e. hinton krizhevsky sutskever salakhutdinov dropout simple prevent neural networks overﬁtting journal machine learning research vol.", "year": 2017}