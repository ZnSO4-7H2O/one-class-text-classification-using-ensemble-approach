{"title": "Image Reconstruction from Bag-of-Visual-Words", "tag": ["cs.CV", "cs.AI"], "abstract": "The objective of this work is to reconstruct an original image from Bag-of-Visual-Words (BoVW). Image reconstruction from features can be a means of identifying the characteristics of features. Additionally, it enables us to generate novel images via features. Although BoVW is the de facto standard feature for image recognition and retrieval, successful image reconstruction from BoVW has not been reported yet. What complicates this task is that BoVW lacks the spatial information for including visual words. As described in this paper, to estimate an original arrangement, we propose an evaluation function that incorporates the naturalness of local adjacency and the global position, with a method to obtain related parameters using an external image database. To evaluate the performance of our method, we reconstruct images of objects of 101 kinds. Additionally, we apply our method to analyze object classifiers and to generate novel images via BoVW.", "text": "abstract—the objective work reconstruct original image bag-of-visual-words image reconstruction features means identifying characteristics features. additionally enables generate novel images features. although bovw facto standard feature image recognition retrieval successful image reconstruction bovw reported yet. complicates task bovw lacks spatial information including visual words. described paper estimate original arrangement propose evaluation function incorporates naturalness local adjacency global position method obtain related parameters using external image database. evaluate performance method reconstruct images objects kinds. additionally apply method analyze object classiﬁers generate novel images bovw. mance object recognition retrieval system image feature characteristics. develop high-performance systems must adopt develop suitable features target task. however intuitive ways evaluate characteristics image features present themselves. reconstruct original images features examining reconstructed images elucidate information feature captures. insight useful improving performance computer vision systems. example vondrick analyzed classiﬁcation failures features image reconstruction found weaknesses hog. winners ilsvrc object recognition competition carefully tuned hyperparameters system visualizing learned features moreover image reconstruction another application image generation features. image feature represents semantics images. therefore feature-based image generation mode semantic image modiﬁcation crossmodal translation. example chen inferred unseen view people generated images feature. although content generation features might sound strange computer vision commonly used approach audio signal processing activities. popular audio feature mfcc widely used intermediate representation speech synthesis voice conversion bag-of-visual-words facto standard feature image recognition retrieval basis many modern features however method reconstructing images bovw reported literature. therefore developed method work. fig. illustration reconstruction method. first spatial arrangement visual words optimized maximizing naturalness local adjacency global position. visual word converted blended single image. strated capability converting local descriptors original image patches. however arranging difﬁcult bovw lacks related spatial information. therefore must recover original layout main point work. fig. presents method. rearrange local descriptors maximizing naturalness local adjacency global position like solving jigsaw puzzles. produces optimization problem called quadratic assignment problem. solve using generic solver based meta-heuristics. contributions paper summarized follows. tackled novel problem reconstructing images bovw. decomposed problem estimation optimal layout local descriptors proposed evaluation function measures naturalness layouts using external image database. described relation among evaluation function jigsaw puzzle solvers quadratic assignment problem. applied method analyze object classiﬁers generate novel images natural sentences. preliminary version work presented elsewhere presentation includes addition three image-generation applications described section along evaluation humans detailed discussion. proposed method includes slight modiﬁcations. related work section summarize existing image reconstruction methods explain relations others. additionally describe existing approaches image generation. image reconstruction work weinzaepfel ﬁrst reconstruct images features. used sift descriptors geometric information reconstruction. sampled descriptors keypoints geometric information includes size orientation position image patch descriptor extracted. construct database local descriptors. corresponding image patches taken external image database advance. reconstruct image retrieve resemblant image descriptor database local descriptor transform corresponding image patches according geometric information blend poisson blending assumed geometric information local descriptors available rarely true realistic systems. d’angelo proposed method convert breaf descriptors freak descriptors image patches. method generates optimal image patch input descriptor analytically. although generated images clear method applicable descriptors certain kinds. vondrick reconstructed images features proposed four methods concluded approach learns pairs image features corresponding image patch sparse coding effective. method applicable feature principle. visualization features also important representation learning. widely used deep convolutional neural networks loss spatial information pooling step problematic bovw. zeiler addressed problem saving spatial information pooling step. mahendra inverted cnns generating optimal image feature directly using stochastic gradient descent. image generation conventional approach image generation synthesize multiple images direct generation images rather difﬁcult. produce clear aesthetic images. however need extremely large labeled segmented image dataset entails high costs. moreover produce patchwork existing images; cannot produce truly novel images. recent rapid progress neural networks started used image generation. generative models deep belief networks variational autoencoders generate images directly features generative properties recurrent neural networks also used generation although potential versatile capacities attractive image generation limited certain domains handwriting digits characters faces cifar- dataset reconstruction method section propose method reconstruct images bovw. first provide brief introduction bovw specify deﬁnitions bovw paper. deﬁne problem setting decompose problem estimation spatial layout visual words generation images them. former show similarity jigsaw puzzle solvers propose evaluation function describe optimization method. also describe means evaluate reconstruction performance. bag-of-visual-words bovw de-facto standard feature image retrieval recognition inspired bagof-words proposed natural language processing community. deﬁned histogram words included document. similarly bovw deﬁned histogram visual words included image. basic procedure extract bovw image following. ﬁrst step called sampling. step descriptors sift extracted small local regions image. next step called coding. step local descriptor assigned nearest visual word. visual words obtained centroids clusters local descriptors extracted image dataset. last step called pooling. step histogram visual words computed counting many descriptors assigned visual word. major strategies exist sampling step. extract descriptors local image patches detected keypoint detectors ﬁxed grid points. size orientation local image patches variable former ﬁxed latter one. latter designated dense sampling better image recognition retrieval continuous. consider naturalness global structure. example pieces tend situated image. naturalnesses evaluated according past experiences seeing images. evaluation function assignment elements places represented permutation matrix i-th element assigned k-th place; otherwise actually following constraints multiple elements assigned place. ijkl represent unnaturalness assignment i-th j-th elements placed respectively k-th l-th places. ijkl k-th l-th places adjacent. designate local adjacency cost. local adjacency cost elements following. represent unnaturalness assignment i-th element assigned k-th place. designate global position cost. global position cost elements following. local adjacency cost local adjacency cost gives reconstructed images consistent edges shapes. measuring naturalness adjacent visual words rather difﬁcult measuring adjacent jigsaw pieces visual words apparent edge shape. additionally decide preferably independent kind descriptors. therefore construct parameters using statistics external image database. several options exist coding step. instead assigning local descriptor visual word method represents descriptor vector i-th dimension weight i-th visual word. actually bovw extended state-of-the-art hand-engineered features vlad super vector fisher vector although recognition performance superior bovw differences great bovw still widely used. work assume bovw simplest style. dense sampling sampling step hard assignment coding step pooling pooling step. method embed spatial information local descriptors. problem settings three approaches possible image reconstruction. ﬁrst compute optimal images analytically approach described d’angelo difﬁcult bovw bovw extracted highly complicated transformations. second learn correspondence features images directly external image database. evaluate approach application method vondrick experiment section report. third trace back pipeline extraction bovw. particularly study approach paper. work assume dense sampling hard assignment pooling bovw described above. additionally assume availability dictionary visual words grid size dense sampling original image size. setting ascertain number kind visual words included image bovw. missing geometric information visual words positions image size orientation image patches ﬁxed dense sampling. trace back pipeline bovw necessary estimate original arrangement visual words generate image patches assume quantization error coding step negligible. analogy jigsaw puzzles visual words grid structure given recovery spatial arrangement ascertain optimal assignments visual words grid points. problem similar solving jigsaw puzzle square pieces without original image studied recently optimization solving equation straightforward. number possible solutions therefore unrealistic solve using brute-force algorithms. section show problem result optimization markov random field quadratic assignment problem propose optimization method based meta-heuristics. therein label assigned k-th node. nodes pairs nodes affect other. preference node label. represents effects connected nodes. example noise reduction images stands cost change pixel value original value; denotes cost smoothness neighboring pixels. optimization markov random fields known np-hard. however leaving restrictions equation consideration solved approximately belief propagation α-expansion sequential treereweighted message passing applicable restrictions equation solved problem introducing approximation position image within m-neighbor visual word extracted visual word number visual word extracted visual word number relative position relative position obtain co-occurrence statistics visual words local regions images. first extract descriptors densely image database quantize visual words saving geometric information. second possible neighboring patterns possible kinds visual word pairs count pairs exist database. consider relative position visual words neglect absolute position. also dismiss pairs distance m-neighbor. means consider elements centered certain element. finally counts smoothing normalize them take negative logarithm. algorithm shows method obtain procedure similar learning uni-gram language model text corpus. bottom-right part fig. illustration algorithm. global position cost makes reconstructed images globally feasible. visual word presumed preference absolute position placed preference cannot obtained visual word itself. therefore external image dataset. obtain occurrence statistics certain visual word certain place. first extract descriptors densely image database quantize visual words. second possible places possible kinds visual word count visual words existing database. finally counts smoothing normalize take negative logarithm. algorithm ours. solved belief propagation approximation. method accurate. therefore achieve results using method correct positions pieces must given. pomeranz considered local naturalness optimized repeating greedy assignments retrial unacceptable regions. gallagher assumed orientations pieces also unknown addition positions. also considered local naturalness. proposed sophisticated method evaluate whether pieces connected optimized whole assignment solving minimum spanning tree. sholomon proposed efﬁcient genetic algorithm solved puzzles pieces thought impossible. although consider kind local adjacent cost jigsaw puzzle settings ijkl nonzero value -neighbor feature reduces structure graph elements making much simpler; global location cost included model proposed others reasons optimization jigsaw puzzles less complicated. large problems solvable efﬁciently. image generation spatial arrangement visual words estimated remaining task generate images visual words geometric information. accomplished converting visual word image patch transforming blending image canvas. several methods exist convert visual word image patch among them method vondrick performs well. applicable descriptors arbitrary kinds. image patch generation. relation quadratic assignment problem within problems assigning elements places ones objective function quadratic functions called quadratic assignment problem among several deﬁnitions objective function formulation lawler deﬁned follows general form. actually regarded extremely difﬁcult nphard problem. problem large obtaining exact solution impossible. therefore generally solved approximating methods based metaheuristics results extensive experiments show hybrid algorithm genetic algorithm tabu search effective. paper solve using algorithm based them hill climbing instead tabu search computational efﬁciency. optimization procedure shown algorithm first generate random solutions optimize hill climbing append population second select solutions randomly generate child optimize hill climbing. better worst solution append remove solution. exclude probability similar pairs otherwise. repeat procedure best worst solution become almost identical. generate random solution assigning elements randomly places without overlapping. hill climbing modify solution exchanging assignment elements improves objective value best. generate child measure similarity solutions manner described drezner relation jigsaw solvers described section main problem similar solving jigsaw puzzles. however automatic jigsaw solvers proposed recent years. show relation method methods. fig. examples images obtained bovw. original images reconstructed. images reconstructed using method. images reconstructed hoggles nearest images retrieved million images. patches draw overall structure; blended smaller ones draw small details. described herein adopted dense sampling image patch sizes equal desirable generated images dependent order patches draw. therefore simply additive synthesis. evaluation metrics objective generate image resembling original image. therefore evaluation must measure similarity images ultimate goal computer vision accomplished adequately. various image features proposed compute image similarity. however avoid arbitrariness selecting features evaluation image features. simplest option normalized cross correlation pixel values images used vondrick designate xcorr. however metric extremely sensitive small shift image contents. therefore transform image slightly compute normalized cross correlation transform take maximum. designate xcorr maximum shift pixels xcorr pixels. normalized cross correlation always match human evaluations reported therefore compare different methods also asked hundred people select image different methods similar original image crowdflower. designate human. example people judged image method similar original people selected image method human main point method estimation original layout visual words. evaluation rather simple. proposed metrics evaluate correctness solved jigsaw puzzles. used repeatedly later papers. direct comparison portion pieces placed correct positions. neighbor comparison portion pairs pieces -neighbor correct neighbors. experiments image reconstruction section present evaluation proposed method experiments reconstruction. first demonstrate method reconstruct images bovw. compare approaches. thereafter examine effect weighting parameter balances global local naturalness size visual word dictionary mode optimization. also show reconstructed images derived local descriptors various kinds. built dataset evaluate reconstruction performance. randomly extracted image class caltech dataset appended dataset. caltech dataset object classes. therefore dataset includes images kinds objects. images dataset shown fig. images dataset shown fig. experiment settings follows unless otherwise noted. vocabulary size visual word dictionary size image patch extracting local descriptor pixels extraction step descriptors pixels. resized images used experiments pixels. used sift descriptors local descriptors. used million images extracted randomly ilsvrc image classiﬁcation dataset construct global position cost local adjacency cost. setting bovw includes visual words. threefourths visual word overlapping next visual word. image reconstruction visual words geometric information proposed method decomposed estimation optimal spatial arrangement visual words generation image visual words position information. elucidate capability method fig. examples images reconstructed local descriptors geometric information. visual word dictionary size. well identiﬁable images reconstructed even descriptors quantized. fig. best worst results. left signiﬁes best. bottom left represents worst. images sorted neighbor comparison score. results demonstrate arrangement accuracy dependent complexity image. section presume layout visual words given. examine latter procedure. additionally explore effect quantization error occurs local descriptors assigned visual words coding step. fig. shows reconstructed images local descriptor geometric information. local descriptors fig. quantized figs. quantized visual words dictionary. although less clear original images fig. image contents still identiﬁable. dictionary becomes smaller quantization error coding step becomes higher; resulting images become blurred. however still identiﬁable. become grayscale images sift descriptors capture color information. feature visualization method called hoggles proposed vondrick although applicable arbitrary image features principle reported results hog-based features only. similar image retrieval using bovw. bovw demonstrates superior performance image search. therefore results retrieval bovw might help ascertain bovw captures. experiment examines nearest image measured euclidean distance. used million images table quantitative evaluation proposed method hoggles image retrieval details metrics described section scores averaged images reconstruction dataset. figs. present results obtained using method. objects visible images using methods. closely resemble images fig. indicates positions visual words estimated properly. although rough shapes images hoggles original images severely blurred difﬁcult identify. images obtained image retrieval semantically different original images. therefore reading original contents difﬁcult. images reconstructed using method shown fig. said loss spatial information visual words important shortcoming bovw. plenty work done compensate embedding spatial information bovw however results fig. show much spatial information potentially retained bovw. developing method embed spatial information features referring reconstructed images might interesting approach. fig. examples reconstructed images. parameter balances global local naturalness visual words varied. local naturalness ignored global naturalness excluded table presents quantitative evaluation three methods. details metrics described section method outperforms methods view xcorr xcorr. slightly inferior hoggles xcorr sometimes produces images spatially shifted objects. although difference approach others seems slight seeing xcorrn human evaluations strongly indicate superiority method. indeed images method judged similar original. fig. shows best worst results evaluated neighbor comparison. result understand method performs better reconstructing images simple objects without background textures. however weak estimating objects complicated shapes textures. tendency indicates local descriptors used cannot acquire adequate information complicated shapes. improve representations images must kinds descriptors increase size visual words dictionary. effects weighting parameter parameter balances global position cost local adjacency cost objective function. examine effect balancing reconstructed images. fig. presents results. local adjacency costs excluded reconstructed images faint shapes heavily blurred difﬁcult identify. however global position cost excluded reconstructed images tend corrupted shapes although clear contours. results indicate costs types working effectively must balanced properly. converting local descriptors image patches. however affect estimation spatial arrangement. examine related effects changed size visual word dictionary reconstructed images. fig. presents results. images however shapes objects tend corrupted images chair seventh column apparent chair becomes invisible indicates possibility feature cannot capture chair. analysis type probably useful tuning fig. shows relation evaluation metrics. expected larger produces larger xcorr xcorr xcorr. interpreting rather difﬁcult multiple descriptors quantized visual word chance rate correct assignment becomes higher dictionary becomes smaller. comparison optimization methods section compare optimization method random assignment hill climbing simulated annealing modify solution described table comparison optimization methods. rand randomly generated solution. denotes hill climbing. represents simulated annealing. ga+hc combination genetic algorithm hill climbing. table presents evaluation values optimized values objective function running time ﬁnish optimization. method outperforms methods metrics. signiﬁcant difference among ratio visual words assigned correct position seven times large four times large however method requires much time methods image reconstruction various descriptors although sift descriptors used preceding experiments method applicable descriptors kind. reconstructed images might vary along kind descriptor exhibit characteristics. reconstructed images using rgbsift opponentsift local descriptors. results shown fig. accurate images opponentsift. however rgbsift less capacity color representation opponentsift has. observation understand exists tradeoff color representation edge representation. although shapes edges reconstructed correctly color variation images awfully limited. colors consistent original images fig. indicates cannot capture color information adequately probably dictionary visual words small biased. reconstructed images much worse applications proposed method method useful reconstructing images also generating novel images bovws manipulated feature space. section present three imagegeneration applications. ﬁrst image morphing interpolating features. second visualizing learned object classiﬁers. third image generation natural sentences. intermediate images directly straightforward rather simple generate images intermediate features. therefore section apply method image morphing. feature space bovw preferred recognition retrieval pixels. therefore image morphing image features semantic conventional approaches. image morphing interpolation feature space used examine manifold property features representation learning experiment fig. shows examples images generated preceding procedure. intermediate images omitted because limited space. results showed apparently object gradually transforms another object. although unsuitable practical image quality image editing image features interesting avenue. visualization object classiﬁers section visualize object classiﬁers generating images features activate classiﬁers most. enables understand intuitively classiﬁers captured. also reveals differences human vision computer vision suggested deep neural networks used linear svms object classiﬁers commonly used ﬁrst choice classify bovws. positive judged belong positive class. consider feature maximizes score multiplied also multiplied. therefore inﬁnity limitation exists therefore restrict lagrange’s method undetermined multipliers. difﬁcult interpret visual words dimension negative noninteger. therefore modify dimension non-negative integer norm number visual words image firstly negative value secondly satisﬁes round rescale round. procedure enables interpret visual words. trained classiﬁers linear kernels using caltech dataset ilsvrc dataset. images class caltech dataset treated positive examples. thousand images randomly extracted ilsvrc dataset treated negative examples. generated images classiﬁer times selected clearest image manually optimization layouts sometimes became stuck poor local optima. examples visualized classiﬁers shown fig. results shown fig. understand pizza classiﬁer strongly captures circular shape. interesting clear horizontal line exists image joshua tree classiﬁer. fact suggests horizon strong clue classiﬁer. also surprising simple method produced well-identiﬁable images indicates inner class variation images caltech dataset extremely limited. fig. morphing image generation bovw. bovws extracted images interpolated converted images. ketch sunﬂower. buddha strawberry. face yin–yang. ewer laptop. automatic caption generation studied extensively recent years caption-generation systems capture relation images captions using image caption dataset. here relation captured possible generate natural sentences images also images natural sentences. recent caption-generation systems convolutional neural networks image feature extraction. however invertible. work enables inversion bovw. section bovw intermediate feature image generation sentences. generate images natural sentences decompose sentence words convert word bovw average bovw convert ﬂoat-value bovw integer-value bovw manner described section generate image obtained bovw. method convert word bovw following. image caption dataset appears times caption i-th image visual word appears times bovw i-th image compute correlation coefﬁcient finally concatenate treat bovw experiment used pascal sentence dataset image caption dataset. dataset includes thousand images captions each. concatenate captions treat caption. additionally used nouns conversion. used rgbsift local descriptors. examples generated images shown fig. clear slight correspondences input sentences. example image fig. vertically long object corresponding bottle fig. horizontally long object corresponding bus. images ﬁeld many green parts coast beach not. setting several sentences translated completely nonsense images. method probably simple complicated task. image caption dataset small variety images sentences. however fact simple method small dataset produce results fig. indicates future possibility realizing image generation systems. discussion method assumes dense sampling single-scale sampling hard assignment local descriptors. limitations prevent application method advanced bovw based features. relax assumptions additional terms must added objective function method also presumes size extraction step local descriptors available. assumptions appropriate users intend analyze bovw improve systems developing novel applications. however limitation impossible reconstruct images bovws extracted unknown systems. described section although human evaluation clearly indicates strong superiority approach others difference small view xcorrn. human evaluation costs high take much time subject selection participants development reliable evaluation metrics necessary accelerate future research ﬁeld. work spatial pyramid however spatial pyramid used possible positions visual words greatly limited might produce clear reconstructions within much less optimization time. conclusion described herein addressed problem reconstructing original images bag-of-visual-word feature. decomposed novel task estimation optimal arrangement visual words generation images them. speciﬁcally emphasized former subproblem proposed method acts like jigsaw puzzle solver using statistics visual words image dataset. results experiments revealed following. method reconstruct images bovw. estimation original arrangement visual words effective consider naturalness preference global position naturalness local adjacencies. quantization error emerges coding step problematic generate image patches strongly affects estimation geometric information visual words. optimization method offers correct reconstruction although time consuming. method applicable local descriptors arbitrary kinds. additionally applied method three tasks image morphing bovw visualization object classiﬁers image generation natural sentences. although proposed methods simple produced promising results. believe image reconstruction features extremely important theme useful feature analysis interesting challenging applications. expect work related well-used bag-of-visualwords invokes intensive research ﬁeld. russakovsky deng krause satheesh huang karpathy khosla bernstein berg fei-fei imagenet large scale visual recognition challenge int’l computer vision stylianou capp´e moulines continuous probabilistic transform voice conversion ieee trans. speech audio processing vol. s´anchez perronnin mensink verbeek image classiﬁcation ﬁsher vector theory practice int’l computer vision vol. gordoa rodr´ıguez-serrano perronnin valveny leveraging category-level labels instance-level image retrieval proc. ieee conf. computer vision pattern recognition lazebnik schmid ponce beyond bags features spatial pyramid matching recognizing natural scene categories proc. ieee conf. computer vision pattern recognition loiola abreu boaventura-netto hahn querido survey quadratic assignment problem european operational research vol. drezner extensive experiments hybrid genetic algorithms solution quadratic assignment problem computers operations research vol. genetic algorithm quadratic assignment problem informs computing vol. fei-fei fergus perona learning generative visual models training examples incremental bayesian approach tested object categories computer vision image understanding vol. nguyen yosinski clune deep neural networks easily fooled high conﬁdence predictions unrecognizable images proc. ieee conf. computer vision pattern recognition rashtchian young hodosh hockenmaier collecting image annotations using amazon’s mechanical turk proc. naacl workshop creating speech language data amazon’s mechanical turk hiroharu kato received degree engineering degree information science technology university tokyo japan. currently research engineer sony corporation. research interests include multimedia processing artiﬁcial intelligence industrial applications. tatsuya harada received degree mechanical engineering university tokyo japan. currently professor department mechano-informatics school information science technology university tokyo japan. research interests include real world intelligent system large scale visual recognition well intelligent robot.", "year": 2015}