{"title": "Scale Optimization for Full-Image-CNN Vehicle Detection", "tag": ["cs.CV", "cs.AI"], "abstract": "Many state-of-the-art general object detection methods make use of shared full-image convolutional features (as in Faster R-CNN). This achieves a reasonable test-phase computation time while enjoys the discriminative power provided by large Convolutional Neural Network (CNN) models. Such designs excel on benchmarks which contain natural images but which have very unnatural distributions, i.e. they have an unnaturally high-frequency of the target classes and a bias towards a \"friendly\" or \"dominant\" object scale. In this paper we present further study of the use and adaptation of the Faster R-CNN object detection method for datasets presenting natural scale distribution and unbiased real-world object frequency. In particular, we show that better alignment of the detector scale sensitivity to the extant distribution improves vehicle detection performance. We do this by modifying both the selection of Region Proposals, and through using more scale-appropriate full-image convolution features within the CNN model. By selecting better scales in the region proposal input and by combining feature maps through careful design of the convolutional neural network, we improve performance on smaller objects. We significantly increase detection AP for the KITTI dataset car class from 76.3% on our baseline Faster R-CNN detector to 83.6% in our improved detector.", "text": "hand domain speciﬁc object detection benchmarks kitti vision benchmark suite present might call domain-natural distribution. vehicle detection domain scale distribution found benchmark represents typical presentation scales. scale vehicles scene presents naturally according forward motion vehicle. small/distant vehicle likely present benchmark larger/closer vehicle. figure figure compare distribution images kitti datasets respectively. fig. kitti benchmark object scale comparison. kitti benchmark presents domainnatural distribution object scales. vehicle moves scene scales following expected distribution object forward motion. also observe distinct ’aspect-modes’ caused presence front/rear side vehicles perspectives. dataset dominated larger objects consume large portion image scene. abstract— many state-of-the-art general object detection methods make shared full-image convolutional features achieves reasonable test-phase computation time enjoys discriminative power provided large convolutional neural network models. designs excel benchmarks contain natural images unnatural distributions i.e. unnaturally high-frequency target classes bias towards friendly dominant object scale. paper present study adaptation faster r-cnn object detection method datasets presenting natural scale distribution unbiased real-world object frequency. particular show better alignment detector scale sensitivity extant distribution improves vehicle detection performance. modifying selection region proposals using scaleappropriate full-image convolution features within model. selecting better scales region proposal input combining feature maps careful design convolutional neural network improve performance smaller objects. signiﬁcantly increase detection kitti dataset class baseline faster r-cnn detector improved detector. recently several design variations object detection using region based convolutional neural networks generated state-of-the-art performance traditional manyclass object detection benchmarks datasets typically present target objects unnaturally high target object frequency friendly dominant scale. natural consequence data collection methodology casting prior bias seeking images specifically containing chosen target classes i.e. benchmark images chosen larger pool available images contain examples instances chosen class furthermore contain examples usually signiﬁcant scale easily labeled. consequence popular benchmarking leading object detectors play benchmark design choices. particular designing detectors datasets requires moderate attention detectors scaleinvariance much lower frequency objects real-world. consider case scanning pascal-voc trained faster-rcnn detector random selection flickr images detector precision person class might acceptable precision detection challenges believe many underlying design choices used methods valuable. particular shared full-image convolution features approach faster r-cnn method shows forward object detection possible powerful large based models suffering large computational burden inherent moving prior detector designs attentional cascades fast handcrafted features insight possible apply heavy computation entire image produce feature description content extracted analysed locally objects within image without evaluating many thousands local image patches. however demonstrate faster r-cnn design though brilliant cost terms scale invariance image description obtained. work propose maintaining design choices given faster r-cnn method explore optimization approach domain-natural object detection distribution speciﬁcally kitti vehicle detection benchmark. however rather following standard benchmarking scheme somewhat focused improving mean average precision leading benchmark contenders speciﬁcally study response method variations images different scales. therefore whereas kitti dataset divided subsets based scale occlusions truncation speciﬁcally study effect scale inclusion shallower layer feature maps method overall representation kitti dataset. object detection. early obvious approach scale-space pyramid windowing allow detector consider problem single window scale. particularly effective detector attentional cascade relatively fast support vector machine approach suitably fast features however approach challenging integrate today’s powerful neural network models yield computationally minimalistic features. reason systems chosen modern neural network designs ‘tail-end’ detection cascades average per-image computation burden tail-end detection cascade miss beneﬁts offer. shown recent times hard crafted features simply tend miss general discriminative power available cnn’s pool multi-layer co-optimized feature sets. furthermore features excel moving discriminative value chain general low-level features image understanding higher-level features-of-features importantly compared cascade approaches share lower-level features object classes. primary ancestor modern based object detectors r-cnn combines leading classiﬁcation method alexnet sparse region proposal method provided candidate image sub-regions classiﬁcation according target object classes. produced state-of-the-art performance high computational cost number region proposals often signiﬁcant sub-region image required separate processing cnn. computational cost signiﬁcantly reduced fast r-cnn approach. main contribution work propose idea sharing feature entire images various region proposals. speciﬁcally fast r-cnn ﬁrst computes feature maps whole image extracts region features according objectness region proposal method. since different proposals image make feature compute feature maps every proposal separately. resulting region interest feature takes place last convolutional layer’s feature output standard r-cnn classify region proposals. followed bounding regression achieve accurate bounding coordinates. strategy greatly reduces repeat computation overlapping regions. however r-cnn fast r-cnn traditional region detection methods like selective search generate region proposals. method computationally expensive becomes bottleneck fast real-time processing. evolved r-cnn fast r-cnn proposed faster r-cnn approach consisting fast r-cnn method region proposals network sharing features. faster r-cnn optimizes region proposal process introducing region proposal network improves computational speed proposal quality. explores capability sliding window fast r-cnn combined neural network generating objectness region proposals. incorporation method detection framework takes fuller advantage greatly improving computational speed. furthermore common structure method utilized speeding training sharing parameters following proposal classiﬁcation network fast r-cnn. faster r-cnn design extracts features high-level convolution layers. example conv zf-net presents downsampling factor consequently receptive ﬁeld corresponding original image larger smaller target vehicles within kitti dataset intuitively large receptive ﬁeld introduces unrelated object background information dilutes discriminative power conv ‘feature fig. faster r-cnn multi-task learning different anchor scales ratios. full-image convolution used process input image feature map. local region feature reduced vector used anchor region suggestions infer class/nonclass detections bounding reﬁnement relative input anchor suggestions. show appropriate matching anchor scales dataset distribution important success method. it’s easy good region proposals vital efﬁcient object detection. fast r-cnn uses traditional selective search generate region proposals. method computationally expensive bottleneck real-time processing. faster r-cnn developed region proposal network address problem exploring capability neural network generating proposals sharing parameter fast r-cnn improve training speed. improvement quality proposed region crucial whole detection system. faster r-cnn’s layer utilizes sliding window approach convolution output order generate object proposals. done summarizing convolution output single ﬁxed length description location application convolution followed convolution. ﬁxed length vector passed box-classiﬁcation box-regression layer. task box-classiﬁcation layer determine objectness given region box-regression layer suggests offsets actual object location relative region given anchor box. analysis bounding box-classiﬁcation box-regression computed relative so-called anchor boxes presenting suggested scales aspect ratio variations location. original method used scales aspect ratios combination yield anchors box-classiﬁcation box-regression layers. presumably original authors used degree empirical optimization chosen datasets choosing anchor values aspect ratios anchor boxes success method across different domains. ideally anchor boxes suggest approximate location scale aspect ratio objects want detect suggesting minimal number nonobject regions. ratios scales anchor boxes important. given prior contributions surprising others already attempted modify faster r-cnn method class-speciﬁc object detection. notable examples include pedestrian detection hard background images scale issues identiﬁed difﬁculty existing approach well vehicle detection outer training test parameters faster rcnn approach explored. given previous study vehicle detection using faster r-cnn important draw distinction. work consider issues relating scale objects reference algorithm internals anchor method features pooled different layers cnn. rather produced informative exploration issues training test input image size number region proposals used training method. detect smaller objects smaller anchor proposals needed speciﬁcally address larger presence smaller objects. original method used anchor scales pixels area. given higher frequency small vehicles kitti vision benchmark smaller scales anchor boxes generation process cover high-frequency interval dataset pixels width. yields boxes pixels area. since ratios number anchor boxes location results show usage smaller anchor signiﬁcantly increase test addition varying number scale distribution anchor boxes explore possibility changing actual network design full-image convolution layers. particular large receptive ﬁeld existing approach means convolutional feature aggregates image information large area. small objects leads dilution object information background non-object information dominate feature. large receptive ﬁeld derived directly size convolution kernels used number layers network. lower layers smaller receptive ﬁelds layers them. therefore explore networks redesigned based original zf-net used original faster r-cnn paper. case allow lower level ﬁne-grained scale information input image. higher-level features larger receptive ﬁeld. features contain global information smaller scale information lost along objects precise position information. higher level feature descriptive high-level representation suitable accurate prediction small objects. proposed three possible methods extending ﬁnal convolutional layer ﬁne-scale features. multi-layer proposal. leverage idea deepid concatenating feature maps conv conv different receptive ﬁelds. i.e. conv better placed detect smaller objects conv. resulting feature maps layer shown figure since combined features contain information gathered range receptive scales yields better proposals improves detection performance faster training. however networks fully trained performance multi-layer proposal network similar baseline model. multi-scale proposal. inspired googlenet multiple scale convolutional kernels conv layer concatenate conv layer. advantages multiscale convolutional ﬁelds optimized different scale information input image. resulting feature maps layer shown figure combined features contain different information different convolutional scales yielding better object proposals improved detection performance ﬁrst stage training. ﬁnal detection improves upon baseline performance signiﬁcantly. residual block embedding. deep residual networks emerged state-of-the-art deep neural network architecture. accordingly residual block conv conv layers shown figure main branch apply convolution ﬁlters sequentially conv feature using identity shortcut branch. corresponding outputs together giving deeper layer features avoiding loss ﬁne-scale information. result input layer. expect residual block embedding could boost performance scale-ﬂexible representation. fig. proposed network architecture modiﬁcations. dotted-line rectangle means layers initialized pre-trained model. solid-line rectangle means layers trained scratch. combinations conv conv feature maps multi-layer network. zfml combinations multi-scale convolution layers. zfms residual network embedding zfres. fig. proposed combination network architecture zfcombin combines zfms zfres. zfml model speciﬁcally combined based results doesn’t improve detection precision much. network architecture. baseline network faster r-cnn pre-trained imagenet. dataset training trained iterations learning rate starting dropping steps. kitti dataset training trained iterations learning rate step size implement cnns based caffe library. baseline model termed simply ﬁnal network multi-layer representation multi-scale representation residual block embedding tiny anchors termed zfml zfms zfres zfanchor. ﬁnally combine techniques form carefully designed network termed zfcombin.. training testing dataset. dataset contains training images testing images including objects respectively. classes dataset aeroplane bicycle bird kitti dataset images total images contain cars. randomly divide training partition testing consequence fact methods designed scale-variance dataset little scale variance. furthermore training dataset reveals modest improvement detection. however kitti trained tested faster r-cnn detector shows signiﬁcant improvement shown table tuned faster r-cnn network kitti dataset accuracy increased overall. table test experiments kitti dataset. strongest single contribution anchor adjustment strong contribution also provided residual network. combination network strongest performer. kitti dataset closer typical real-world scenario data shown figures figure kitti dataset image size datasets like imagenet carefully designed general objection detection. typically image contains objects objects occupy image. hand images kitti dataset taken viewpoint vehicle road. case cars appear anywhere image perspective effects mean scale vehicles varies greatly. three baseline results dataset trained tested faster r-cnn detector dataset trained kitti dataset tested faster r-cnn detector kitti dataset trained tested fast r-cnn. trained tested network shows little improvement proposed modiﬁcations. multi-scale also similar baseline result improvement. kitti dataset average performance among test images improved using scales. limited improvement dataset expected scale-variance. kitti dataset tiny objects easily detected multi-scale proposals original faster r-cnn network. consistent expectation since tiny-anchor proposal designed give better region proposals smaller vehicles. fig. anchor scale detector performance different sized objects. detector performance best around limited scale range near anchor scaling performance drops quickly beyond certain point different anchor provides best chance capturing object. interestingly curves upward biased towards larger scales. attributed fact detection performance improves quite markedly size object increases scene. scale’s ability detection objects also studied. result shown figure detection performance certain scale best around object scale range near anchor scale. addition tested performance various models images speciﬁc scales performance gains speciﬁcally realised figure shows majority improvements comes handling smaller scaled objects dataset. residual block embedding. detection performance residual block based method kitti dataset given table table respectively. model improves network performance residual network embedding allows information lower level convolutional layers addition layers convolutions residual connection makes ﬁnal feature diverse high mid-level features also converging quickly. combination proposed techniques. since proposed improvements incorporated single framework perform experiment based combination network shown figure observed table combined model works remarkably well kitti. effectively validates analysis kitti dataset regarding small scale vehicles within data. ﬁnal detection signiﬁcantly improved study explored application faster r-cnn framework vehicle detection task. faster r-cnn particularly designed general object detection objects particular scale-distribution frequency requires adaptation order work well vehicle detection task. primarily attributed need vehicle detection method match signiﬁcant variations natural distribution target object scale position frequency. address issue proposed several modiﬁcations network architecture’s convolutional layers region proposal selections. combined multiple level features obtain better performance across scales adding additional anchor suggestions. experiments kitti dataset improve detection performance relative baseline anticipate strong future full-image convolution methods based fasterrcnn real-world problems kitti vehicle detection. combined network designs able capture features large variety scales shown paper believe methods displace traditional exhaustive scale-space search approach realworld real-time object detection. russakovsky deng krause satheesh huang karpathy khosla bernstein imagenet large scale visual recognition challenge international journal computer vision vol. girshick donahue darrell malik rich feature hierarchies accurate object detection semantic segmentation proceedings ieee conference computer vision pattern recognition fig. detector performance object scales. larger object level. however combination anchor-box optimized models achieve signiﬁcant improvement smaller object instances. multi-layer proposals shown table table performance baseline multi-layer model remains unchanged. kitti dataset model performance improved iterations converges similar accuracy baseline model. shows concatenation layer convolutions didn’t improve ﬁnal accuracy detection decreases required training time. multi-scale proposals kitti dataset multiscale performance signiﬁcantly improved relative baseline model iterations. however ﬁnal performance converges slightly higher ﬁnal easy understand since multi-scale proposal ﬁner scaled features viola jones rapid object detection using boosted cascade simple features proceedings ieee conference computer vision pattern recognition vol. i–i. shen brandt convolutional neural network cascade face detection cvpr verma hebbalaguppe kumar hassan pedestrian detection mixture experts thresholded aggregated channel features proceedings ieee international conference computer vision workshops szegedy sermanet reed anguelov erhan vanhoucke rabinovich going deeper convolutions proceedings ieee conference computer vision pattern recognition shelhamer donahue karayev long girshick guadarrama darrell caffe convolutional architecture fast feature embedding proceedings international conference multimedia.", "year": 2018}