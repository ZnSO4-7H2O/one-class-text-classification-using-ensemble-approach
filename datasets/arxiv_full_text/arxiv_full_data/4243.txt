{"title": "Improving Smiling Detection with Race and Gender Diversity", "tag": ["cs.CV", "cs.AI"], "abstract": "Recent progress in deep learning has been accompanied by a growing concern for whether models are fair for users, with equally good performance across different demographics. In computer vision research, such questions are relevant to face detection and the related task of face attribute detection, among others. We measure race and gender inclusion in the context of smiling detection, and introduce a method for improving smiling detection across demographic groups. Our method introduces several modifications over existing detection methods, leveraging twofold transfer learning to better model facial diversity. Results show that this technique improves accuracy against strong baselines for most demographic groups as well as overall. Our best-performing model defines a new state-of-the-art for smiling detection, reaching 91% on the Faces of the World dataset. The accompanying multi-head diversity classifier also defines a new state-of-the-art for gender classification, reaching 93.87% on the Faces of the World dataset. This research demonstrates the utility of modeling race and gender to improve a face attribute detection task, using a twofold transfer learning framework that allows for privacy towards individuals in a target dataset.", "text": "figure end-to-end architecture smile detector. gray blue layers part pretrained face recognition model modeled facenet blue layers transferred diversity smile classiﬁers. green denotes layer pretrained gender classiﬁcation transfer learn smile classiﬁer. yellow denotes layer pretrained race classiﬁcation transfer learn smile classiﬁer. pink denotes layers trained scratch smile classiﬁcation task. paper examine problem unequal performance across different races genders context smiling detection chalearn looking people challenge document disparities demographic subgroups working four race subgroups genders serve initial subgroups room grow. detail method improve accuracy across demographic subgroups overall preserving demographic privacy unique individuals. approach utilizes transfer learning using last hidden layers face recognition model train race classiﬁer gender classiﬁer held-out public data combining last hidden layers classiﬁers third model trained recent progress deep learning accompanied growing concern whether models fair users equally good performance across different demographics computer vision research questions relevant face detection related task face attribute detection among others measure race gender inclusion context smiling detection introduce method improving smiling detection across demographic groups. method introduces several modiﬁcations existing detection methods leveraging twofold transfer learning better model facial diversity. results show technique improves accuracy strong baselines demographic groups well overall. best-performing model deﬁnes state-of-theart smiling detection reaching faces world dataset. accompanying multi-head diversity classiﬁer also deﬁnes state-of-the-art gender classiﬁcation reaching faces world dataset. research demonstrates utility modeling race gender improve face attribute detection task using twofold transfer learning framework allows privacy towards individuals target dataset. detecting recognizing people faces become increasingly feasible machine learning task rise deep learning techniques large people-focused datasets closely related task face attribute detection seen similar gains work everything estimation arched eyebrow detection demonstrating signiﬁcant strides modern machine learning however rise come cost modern public technology incorporated modern computer vision techniques users noticed troubling between well demographics recognized compared others example woman’s face task smiling detection. results overall improved smiling detection accuracy across board including improvements minority demographic subgroups. also reduces errors captured false negative rate false positive rate calculations decreasing average false rate two. contributions include propose approach face attribute detection sensitive race gender underrepresentation training data race gender disparities system predictions user privacy. ethical considerations intent. intent work demonstrate utility reasoning demographics case race gender order better across demographics well overall downstream task case smiling detection. research motivate race gender identiﬁcation end-goal motivate inferring race gender individuals without consent. ideas work towards goals supported authors. although work concerns race gender provide evidence support inferring race gender directly. race gender categories. categories choose within race gender imperfect number reasons including fact gold-standard ‘race’ categories; race often collection variety demographic information; debatable whether gender treated discrete categories spectrum. deep-dive subgroup categories intentionally absent work order promote idea subgroup categories good generally. research computer vision included work issues direct social impact security privacy however research related issue diversity computer vision surprisingly lacking details pressing issues). face attribute detection. chalearn looking people challenge piqued interests accelerated research progress detecting face attributes smile gender. challenge provides faces world dataset training validation. ﬁrst place challenge utilizing multitask learning ﬁne-tuning model trained face recognition later published out-performing result task fotw utilizing transfer learning face recognition model well mtl. authors explore frozen parameter values rather ﬁne-tuning parameters. reached stateof-the-art performance smiling task celeba test dataset authors employ transfer learning face recognition model similar addition providing additional features inputs besides features extracted face recognition model. authors utilize geo-location weather information inferred given face additional input features model. work explored latent relationship smaller attributes face attributes related identity gender ﬁnding performance smaller attribute tasks could improved also inferring identity attributes. several lines research face detection recognition utilize skin tone proxy race however skin tone variable visual feature within race group shown least helpful features distinguishing races explores inferring race geo-location features extracted face. explores inferring racial population location distribution maker location distribution. however application race classiﬁcation models limited adopted tools measure improve fairness performance computer vision model. open-sourced ﬁrst race classiﬁcation model races including subset census hispanic. bias diversity ﬁrst papers present dataset bias problem documenting issue popular object recognition datasets exploring implications effects computer vision models. points importance diversity source material vision dataset postulates analysis made skewed datasets cannot representative enough benchmarking progress. authors provide faces world collected achieving uniform distribution across different gender ethnic groups recent work also applied computer vision techniques bring light gender bias present movies using tool introduced called gdiq research team detects faces measures scene time gender. team discovered actresses seen fewer times actors. fairness machine learning. area machine learning fairness recently surged newly uncovered theoretical guarantees demonstrated results using modern deep learning techniques. advocates fairness awareness demonstrating importance aware sensitive characteristics gender race order work towards models work well regardless demographics. proposals fairness included parity demographic parity requires proportion individuals demographic group matches different decisions algorithm. however pointed provides guarantee quality algorithmic decisions equally good group. building idea discusses measures equality equality opportunity requires equal false negative rates across subgroups equality odds additionally requires equal false positive rates across subgroups. applies equality opportunity within multi-task paradigm main head predicts task income bracket auxiliary head predicts sensitive attribute gradient prediction negated passed back model effectively minimizing accuracy sensitive attribute task maximizing attribute main task. work take somewhat opposite approach learning race gender transferring learning model. core work lies idea faces look different across different races genders equally important well demographic group. best knowledge studied whether exists direct relationship smile detection race gender subgroup classiﬁcation tasks. relationship holds smile detection might improved across races genders model learning them. demonstrate learning race gender indeed improve performance. classiﬁer trained maximize likelihood given dataset learn representations within bounds dataset dataset exhibits racial disparity models trained learn encode similar disparities poor performance underrepresented races better performance represented races dataset. figure multihead diversity classiﬁer’s gender head sets state-of-the-art accuracy fotw achieves state-ofthe-art accuracy celeba. umiacs ﬁne-tuned gender model fotw train dataset evaluating fotw validation dataset. accurate performance comparison model adopted method analysis. models compared left right legend. poor performance take form accuracy subgroups frequent false positives false negatives subgroups. disparities missed training validation datasets reﬂect similarly skewed demographic distributions. evaluate systems terms performance across subgroups report values accuracy subgroup. inspired recent work fairness machine learning also introduce metric evaluates false positive rates false negatives rates robust label subgroup imbalances average false rate given false positives; false negatives true positives; true negatives false positive rate fp+tn false negative rate average false rate equal weighted average weights fpr. weighting provides opportunity capture different relative importance kinds error rates depending task metric used somewhat comparable error rate however balances positive negative labels effect label imbalance error calculation. work weight equally calculate performance full dataset addition reporting accuracy report mean average false rate across subgroups additionally address issues label class imtransfer learning useful case feature space marginal distribution feature space x...xn well marginal distribution related feature space setting space face features face images smiling task face images demographic classiﬁcation task race gender. optimize learning include learned representations target domain learning hence name twofold transfer learning. added beneﬁt protecting privacy individuals smiling detection task without directly inferring gender race individuals. concern training classiﬁers dataset class imbalance classes subgroups prevalent others training data. negatively impacts well trained classiﬁer generalize beyond frequent groups training data groups minority. working object recognition cnns demonstrates oversampling outperforms popular sampling methods undersampling types class imbalance. however oversampled folds face dataset high class imbalance context race classiﬁcation performance improvements. order balance dataset across different classes training instead list eight combinations undersample dataset stratiﬁed sampling fashion face images race gender intersection. minority subgroups dataset could even meet under-sample threshold. these employ off-line oversampling method order make sure training batch contains faces across race gender. resulting diversity classiﬁer sets state-ofthe-art gender classiﬁcation accuracy fotw dataset reaches current state-of-the-art accuracy celeba datset. figure comparisons. multihead diversity classiﬁer’s gender head also performs figure provides high-level overview architecture used learning demographic domains first face detector crop align faces. using face crops train face recognition system modeled facenet architecture following extract features layer called avgpool refer avgpool-facenet rest paper. fully connected layers ﬁne-tune model race gender estimation tasks. train multihead diversity classiﬁer data collected publicly available resources celebrities appearing curate data train validation sets consist disjoint sets identities. unlike traditional approach labeling race gender obscure race gender subgroup names whenever possible order avoid introducing unconscious societal bias associated existing labels. call gender gender gender towards adding gender subgroups future work. call races subgroup subgroup subgroup subgroup similarly anticipate using naming scheme extend race subgroups. gender classiﬁcation. model’s performance gender classiﬁcation fotw celeba datasets respectively setting state-of-the-art gender classiﬁcation accuracy. figure illustrates model’s performance compared existing models. additional experiments demonstrate gender classiﬁcation works surprisingly well part face also known attention region trained model achieves accuracy slightly underperforms experiments full faces. race classiﬁcation. explore four race subgroups able scrape images famous identities listed allows train reasonably performing race head multihead diversity classiﬁer however limited races might considered. initial classiﬁer demonstrate potential usefulness learning race detecting face attributes. train model reach greater across four race subgroups. smile detector architecture figure provides high-level overview architecture used learning detect smiles smiling domain building learned representations figure close-up part model architecture trained scratch outputs smiling detection results. learning rate. learning rate plays important role small neural avoid getting stuck local minima enough exposure learn ﬁne-tune teacher model. also ideal model overﬁt training dataset learning rate certain threshold. experiments adjusted initial learning rate brute force search reduce oscillation continuous training accuracylosscurves. found initial learning rates range work best experiments early stopping training steps trained batch size number parameters trained. weight parameters trained scratch. comparison experiments number parameters without transfer learning demonstrate transfer learning adds additional beneﬁt ﬁnal model. input features twofold transfer learning. transfer learn ﬁnal smile detection model three sets features extracted different pretrained models face recognition model multihead diversity classiﬁer. smile detection datasets looking people smile gender challenge chalearn looking people smile gender challenge requires classifying images according figure table detail racial inclusion faces world celeba datasets used challenge. faces world race model estimates high variance among subgroups plurality data subgroup subgroup smallest subgroups training data instances. contrary reported racial diversity fotw fact estimated labels model well differences different parties categorize racial subgroups. demonstrate agreement race categories needed improve performance. improve models smiling task ﬁrst examine effect different layers input model. compare avgpool-facenet inception table ‘other’ label applied conﬁdence score subgroups. inception yields best results across racial subgroups boosting overall accuracy accuracy minority subgroup simple fully connected layer output size rest experiments features extracted inception layer input smile detection system. considering avgpool-facenet helps multihead diversity classiﬁer layer comes various bottleneck layers conjecture avgpool-facenet richer features representative facial identities inception. meanwhile inception richer features representative facial muscle movements like smiling. layer encode features irrelevant smiling accuracy improvement introducing bottleneck layer similar avgpool-facenet system table details). compare maxpool conv avgpool fully connected layers comparing different layers inception layer. moving fully connected layer improve performance changing size layer lead signiﬁcant gains. however adding pooling layer leads additional gains. table inspired since avgpool worked best experiment another popular pooling layer maxpool. ﬁnal baseline architecture adopt table achieving accuracy smiling detection task. table estimated race groundtruth gender distribution across datasets. duplicated images celeba counted dataset analysis. *fotw comes ‘female’ ‘male’ labels. celeba comes ‘male’ ‘nonmale’ faces world dataset image displays single face labeled smile gender. train smile smile validation smile smile. table details across genders races. estimate subgroup makes half data rest minorities. large-scale celebfaces attributes data contains images duplicates unique images train set; images duplicates unique images validation set; images duplicates unique images test set. image labeled smiling/not-smiling male/not-male. estimate subgroup vast majority here relatively little data race subgroups. table details. table accuracy average false rate mean race subgroup smiling detection proposed systems fotw dataset. denotes transferred representations gender head diversity classiﬁer race head diversity classiﬁer +r+g both. last three rows represent models number parameters models without transferred representations. call baseline model smiling discussed earlier section studies show latent relationship physical appearance lips sexual and/or racial identity. here postulate appearance smiling likely differ race gender affects smiling model’s performance. however often faced face dataset lack sexual racial diversity. mitigate issue train multi-head diversity classiﬁer classiﬁes gender race augment baseline model additional input features transfer learned head diversity classiﬁer here denote input features extracted gsubgfc figure extracted rsubgfc figure experiment combinations input features datasets included results below. addition accuracy smiling detection measure average false rate across race subgroups intuitively measures much model fails predict smiling across smiling instances results shown table achieve accuracy higher previous state-of-the-art smile classiﬁer using race gender smiling+r+g state-of-the-art performance model includes learned race representation smiling+r. test whether transfer learning transferred representations help task compare models number parameters without transferred learning. rows lower half table correspond fully-connected layer dimensions dimensions fully-connected layers dimensions. models transfer achieve higher overall accuracy although interestingly number parameters lead reduced cases highest accuracy subgroup outperformtransferring race knowledge increases accuracy subgroups improves total accuracy state art. also decreases average false rate four race subgroups gender subgroups well overall. notably learning race improves performance across genders. transferring gender knowledge similarly leads accuracy false rate improvements although impactful race. addition gender features increases accuracy gender groups well race subgroups addition improving accuracy overall. point evaluation transferred knowledge hurts performance addition gender subgroup accuracy less baseline smiling. adding race gender signiﬁcantly improve adding race alone race subgroups overall however improve performance gender beyond improvements provided race gender alone. limited improvements provided model +r+g tables part fact model comes parameters difﬁcult tune relatively small amount data provided fotw dataset. accuracy change subgroups dataset size much smaller hypothetical threshold. example performance changes race subgroup attribute data subgroup small compared rest shown figure similar class imbalance problem discussed section this make soft conclusion methodology’s effectiveness limited size minority demographic subgroup dataset meet minimum threshold. gives strong motivation collecting diverse dataset order achieve even greater model performance boost. despite diversity classiﬁer’s state-of-the-art performance gender classiﬁcation model ﬁne-tuned gender-head diversity classiﬁer shows accuracy drop subgroup table looking figure good gender parity dataset. explain additional two-gender input features help much genders already well represented training data. worth noting subgroup highest accuracy compared subgroups subgroup results decrease accuracy gender representations added. perhaps information transferred gender already better captured baseline smiling model subgroup although it’s clear model performs particularly well group. also noteworthy fact subgroup achieves best performance fully connected layers added next best performance achieved adding gender. reason entirely clear look towards ethical approaches deeper dive differences subgroups future work. fotw smile model smiling+r+g reaches accuracy higher chalearn looking people challenge winner siat mmlab higher published state-of-theart umiacs fotw validation dataset. models used transfer learning face recognition model mtl. siat mmlab exploited ﬁne-tuning entire face recognition model couple iterations additional pre-training/ﬁne-tuning using celeba dataset ﬁnally ﬁne-tuning using fotw. umiacs takes similar approach model transfer learned features extracted multiple mid-/lowlayer face recognition model. also pretrained celeba ﬁne-tuned fotw. best performing model trained fotw train dataset face recognition model skipping intermediate step ﬁne-tuning celeba dataset. model outperforms models published increased performance large absolute. figure presents accuracy comparison graph. paper ﬁrst demonstrate building inclusive vision model building state-of-the-art model harmoniously hand-in-hand. moreover vision diversity research result gives insight understanding vision models interaction vision models visually distinctive features faces. present in-depth analysis race/gender demonstrated problem race gender differences smiling detection proposed method improving accuracy across races genders. model utilizes twofold transfer learning better representations race gender subgroups present faces reaches state-of-the-art accuracy smiling detection faces world dataset. process also reach state-of-the-art accuracy gender classiﬁcation using sampling balance demographic labels classes fotw transferred racial representations smiling detection model improved state-of-the-art accuracy. absolute improvement previous chalearn winner absolute improvement previous state incorporating learned representations gender race gender improves. special thanks blaise ag¨uera arcas corinna cortes supports sponsorship. thanks caroline pantofaru sergio guadarrama rahul sukthankar florian schroff marco andreetto david karam krishna somandepalli shrikanth narayanan moritz hardt helpful conversations. thanks divya tyam andrew zaldivar hutchinson donating face photos research.", "year": 2017}