{"title": "Robust Photometric Stereo via Dictionary Learning", "tag": ["cs.CV", "stat.ML"], "abstract": "Photometric stereo is a method that seeks to reconstruct the normal vectors of an object from a set of images of the object illuminated under different light sources. While effective in some situations, classical photometric stereo relies on a diffuse surface model that cannot handle objects with complex reflectance patterns, and it is sensitive to non-idealities in the images. In this work, we propose a novel approach to photometric stereo that relies on dictionary learning to produce robust normal vector reconstructions. Specifically, we develop three formulations for applying dictionary learning to photometric stereo. We propose a preprocessing step that utilizes dictionary learning to denoise the images. We also present a model that applies dictionary learning to regularize and reconstruct the normal vectors from the images under the classic Lambertian reflectance model. Finally, we generalize the latter model to explicitly model non-Lambertian objects. We investigate all three approaches through extensive experimentation on synthetic and real benchmark datasets and observe state-of-the-art performance compared to existing robust photometric stereo methods.", "text": "abstract—photometric stereo method seeks reconstruct normal vectors object images object illuminated different light sources. effective situations classical photometric stereo relies diffuse surface model cannot handle objects complex reﬂectance patterns sensitive non-idealities images. work propose novel approach photometric stereo relies dictionary learning produce robust normal vector reconstructions. speciﬁcally develop three formulations applying dictionary learning photometric stereo. propose preprocessing step utilizes dictionary learning denoise images. also present model applies dictionary learning regularize reconstruct normal vectors images classic lambertian reﬂectance model. finally generalize latter model explicitly model non-lambertian objects. investigate three approaches extensive experimentation synthetic real benchmark datasets observe state-of-the-art performance compared existing robust photometric stereo methods. reconstruct normal vectors object images object light sources. concretely images threedimensional object image object illuminated light source light incident object directions given goal estimate normal vector object numerically integrated obtain three-dimensional representation object. appeal photometric stereo simplicity requires camera movable light source generate three-dimensional representation object. since introduction woodham signiﬁcant work performed increase generality robustness photometric stereo body work typically seeks weaken underlying assumptions woodham’s original model position object relative position light source known object follows lambertian reﬂectance model. works addressing ﬁrst assumption solving so-called uncalibrated photometric stereo problem generally attempt estimate normal vectors object without knowledge lighting directions works addressing latter assumption generally attempt either reconstruct normal vectors objects whose reﬂectance properties deviate lambertian model develop methods robust corruptions observed images. work focus primarily design robust photometric stereo algorithms also incorporate non-lambertian model increased generality. lambertian reﬂectance model holds intensity light reﬂected point surface linearly proportional inner product direction illumination normal vector surface point given images lambertian object illuminated several lighting directions simple system equations solved determine normal vector point surface. practice reasonable model objects reﬂectance properties many real-world objects differ signiﬁcantly lambertian model. furthermore shadows specularities non-idealities cause additional deviations linear reﬂectance. performing classical photometric stereo non-lambertian data typically yields large errors estimated normal vectors. such developing photometric stereo methods objects inherently non-lambertian improving robustness imperfections data essential extending applicability accuracy photometric stereo. primary approaches found success addressing problems. several works assume lambertian model fundamentally correct seek account deviations model explicit outlier removal often assuming non-idealities sparse. achieving level success approaches place overly restrictive assumptions data result falsely rejecting useful data outliers make attempt model true reﬂectance properties objects. turn works propose complex reﬂectance models enable non-lambertian photometric stereo approaches class able accurately model wider range objects still break modeling assumptions fail. furthermore often fail data contains corruptions accounted reﬂectance models. addition aforementioned difﬁculties state-of-the-art methods categories typically rely large number images accurately estimate normal vectors infeasible gather practice. work propose novel approach photometric stereo relies dictionary learning robustly handle wide range non-idealities data. dictionary learning seeks represent local patches data sparse respect learned collection atoms. models effectively dynamic regularization adapts underlying structure data removes spurious corruptions. inspired recent successes applying dictionary learning variety imaging problems adopt methodology improve robustness photometric stereo. approach data-driven adapts underlying structure data without imposing additional explicit constraints. furthermore incorporate existing non-lambertian reﬂectance model method better handle non-lambertian surfaces. total present three dictionary learning-based formulations robust photometric stereo. investigate performance method variety different scenarios. particular evaluate performance benchmark diligent dataset ability handle general non-sparse corruptions. work extension recent work here substantially build work performing extensive numerical study evaluate performance proposed dictionary learning-based approaches real synthetic data extend methods incorporate aforementioned non-lambertian reﬂectance model. remainder work organized follows. section provide brief overview related works photometric stereo. section carefully deﬁne photometric stereo problem non-lambertian reﬂectance model incorporate method. present proposed dictionary learning-based methods section section present associated algorithms solving them. finally section provides extensive numerical study performance proposed methods compared state-of-the-art methods. lambertian photometric stereo originally proposed woodham since then much work done extending general settings lambertian model hold exactly. body work generally proceeded either treating non-lambertian effects outliers directly accounting non-lambertian effects reﬂectance model. variety approaches proposed perform robust photometric stereo outlier rejection. general methods assume data inherently lambertian seek isolate non-lambertian effects outliers reject outliers increase accuracy computed normal vectors. early works robust photometric stereo— typically referred four source photometric stereo— utilized four images identify reject specularities recently complex methods developed rely maximum likelihood estimation expectation maximization maximum feasible subsystem framework approaches include graph cuts-based algorithm identify shadows method seeks color images two-dimensional subspace invariant specularities several methods utilize ransacbased algorithms detect reject outliers. recent works robust photometric stereo outlier rejection—and current state-of-the-art area— ikehata works rely observation images lambertian object three-dimensional subspace. observation together modeling non-lambertian effects sparse corruptions underlying lambertian data motivates authors propose rank minimization-based approaches shown effectively separate lambertian portion data non-lambertian effects. regardless robustness outliers approaches rely lambertian reﬂection model underlying model data inherently limited scope wide variety non-lambertian surfaces exist real world. result another body work incorporating general reﬂectance models photometric stereo example uncalibrated photometric stereo based torrance sparrow reﬂectance model proposed well calibrated photometric stereo based ward reﬂectance model large amount work also done developing photometric stereo algorithms incorporate reﬂectance models based general reﬂectance properties exhibited materials. particular property isotropy successfully utilized variety works current state-of-the-art category works ikehata ikehata models reﬂectance function using sum-of-lobes representation utilizing bernstein polynomials basis inverse reﬂectance function performing bivariate regression determine normal vectors. instead models low-frequency reﬂectance component using polynomials order three discarding high-frequency reﬂectance components. particular interest paper another work ikehata models reﬂectance function piecewiselinear. explore method detail following section. addition aforementioned approaches variety robust photometric stereo methods proposed recent work seeks standardize future work photometric stereo introducing extensive dataset facilitate future testing evaluation. furthermore compare variety existing approaches dataset providing benchmark future work. image intensity pixel direction light source incident surface object light source intensity normal vector surface surface albedo measure reﬂectivity surface. solution denotes moorepenrose pseudoinverse. setting typically gathers images problem overdetermined thus provides robustness non-lambertian effects. several works apply constraints —such constraining sparse—allowing derive accurate estimates obtained section propose novel approaches apply dictionary learning model regardless constraints imposed additive error model fundamentally relies lambertian reﬂectance model thus limiting generality. recent works sought move beyond lambertian assumption utilize general reﬂectance models accurately model normal vectors wider range objects work particularly interested model presented brieﬂy summarize here. given lighting vectors corresponding images task jointly estimate pixel. highly underdetermined problem solve practice constraints must imposed. natural possibility assume piecewise linear. here design parameter determines number piecewise segments inﬂection points slope segment. simplicity choose remaining values equally spaced along range intensity values among images pixel denotes image intensity age. assuming images dimension solved times obtain normal vector object point surface. also combine equations single matrix equation. indeed deﬁne observation matrix rmm× r×d. avoid scaling ambiguity assume light sources intensity normal vector contains three unknown components. thus given images corresponding light directions solve obtain normal vector point object. computed integrate normal vectors produce full three-dimensional model surface lambertian reﬂectance model good approximation reﬂectance properties surfaces poor approximation many real-world objects. lambertian objects matte appearance thus non-matte objects necessarily deviate lambertian reﬂectance model. latter class includes object exhibits specularities—bright points observed light reﬂects shiny surface. furthermore even object lambertian shadows cause lambertian model break down. analogue lambertian model. equation solved determine normal vector corresponding nonlinear reﬂectance function avoid scaling ambiguity constrain normalize unit norm solving lambertian case model accounts reﬂectance properties object. signiﬁcantly general lambertian model non-idealities present images conform reﬂectance properties—or explicitly follow piecewise linear relationship nxy—will prevent holding exactly. thus analogous modify yield model practice improve robustness applying regularization modeling error particular utilizes reﬂectance model assumes corruptions data sparse. next section propose alternative model based dictionary learning robustly solve dictionary learning refers class algorithms seek sparsely represent data interest respect learned dictionary—a collection basis atom elements. intuitively dictionary learning methods allow uncover structure present data without priori knowledge form structure. section propose three adaptive dictionary learning algorithms photometric stereo. ﬁrst propose applying dictionary learning data preprocessing step performed images reconstructing normal vectors. formulation utilizes dictionary learning regularization term represent local patches data matrix sparse adaptive dictionary thereby removing certain non-idealities data represented dictionary. approach thought applying denoising step images. speciﬁcally propose solve optimization problem here rmmd rcxcycz×mmd diagonal matrix extracts vectorized patches dimensions correspond dimensions patches extracted image corresponds number consecutive images patches extracted from. practice extract patches using simple sliding window strategy. rcxcycz×k learned dictionary atoms note that atom stored vector interpreted upon reshaping tensor. rk×c sparse coding matrix whose columns deﬁne linear combinations dictionary atoms used represent patch. also familiar norm regularization parameters. parameter speciﬁes number atoms dictionary number patches extracted v—the denoised images. impose constraint ||b||∞ maxj||bj||∞ typically large prevent instability could theoretically arise non-coercive respect constraint inactive practice without loss generality also constrain dictionary atoms unit-norm avoid scaling ambiguity obtaining solution reshape matrix estimate associated normal vectors using standard least-squares model denoised images place original images henceforth refer approach dictionary problem thought generalization dlnv. indeed reduces however present models distinct methods work highlight differences models rely lambertian assumption versus models incorporate complex reﬂectance models. investigate performance approaches detail section henceforth refer approach dictionary learning normal vectors piecewise-linear reﬂectance method present algorithm solving section propose solving block coordinate descent-type algorithms. speciﬁcally alternate updating respectively ﬁxed updating ﬁxed. similar strategy alternate updating variables held ﬁxed. subproblem derive simple efﬁcient schemes minimizing associated cost. update identical three methods. present update using notation notational convenience deﬁne denote matrix whose column pjv. ﬁxed optimization respect written solve applying iterations block coordinate descent iterate columns columns sequentially. minimize ﬁrst respect respect holding variables ﬁxed. next propose modifying adding adaptive dictionary learning regularization term applied normal vectors. approach seek normal agrees lambertian model also locally sparse representation respect learned dictionary—resulting smoother normal robust non-idealities data. speciﬁcally propose solve optimization problem here rmmd rmmd×mm denotes kronecker product identity matrix. furthermore vectorized normal vectors. dlpi formulation denotes patch extraction matrix extracts vectorized patches dimensions treated tensor extraction. practice extract patches using simple sliding window strategy. also rwxwywz×k denotes learned dictionary whose columns thought vectorized tensors rk×w sparse coefﬁcients needed represent patch normal vectors linear combination dictionary atoms. impose constraints dlpi formulation intuitively adaptive dictionary learning regularization able uncover underlying local structure least squares formulation alone cannot deduce images. results normal vectors smooth\" free noise non-idealities otherwise corrupt them. henceforth refer approach dictionary learning normal vectors method present algorithm solving section finally present method based nonlambertian reﬂectance model section iii-c. using baseline approach incorporate dictionary learning term increase robustness corruptions. particular apply dictionary learning regularization normal vectors thus constraining agree non-lambertian model also admitting sparse representation learned dictionary. speciﬁcally propose vector ones applied element-wise vector arguments denotes elementwise multiplication. furthermore denotes elementwise hard thresholding function deﬁned proposed algorithms solving alternate updating variables held ﬁxed. except updates dlnv pdlnv update schemes either exact block coordinate descent updates composed inner iterations exact block coordinate descent updates objectives formulations must monotonically decreasing updates. moreover proximal gradient step size update chosen guarantee iterations also monotonically decrease objectives. thus cost functions three proposed algorithms monotonically decreasing bounded zero must converge. whether algorithm iterates converge critical points costs interesting theoretical question future work. although least-squares problem normal equation cannot easily inverted presence matrix. instead perform iterations proximal gradient solve cost function written form perform proximal proximal gradient many possible iterative schemes minimizing quadratic objective could also employ different algorithm preconditioned conjugate gradient. investigate performance proposed dictionary learning-based methods experimentally. obtain quantitative results rely primarily recent diligent benchmark dataset dataset contains images variety surfaces different materials provides true normal vectors object allowing measure accuracy normal vectors produced method. quantify error estimated normal vector measuring angular difference correponding true normal vector. evaluate methods variety settings. experiment compare results methods robust approach sparse regression method ikehata constrained bivariate regression approach ikehata addition compare baseline least squares model deﬁned exception method contains regularization parameters. method sweep parameters across wide range values select optimal parameters trial. existing methods include recommended parameters respective papers sweep. iterative algorithms convergence repeat experiment additive noise multiple realizations average results. majority photometric stereo literature focused primarily problem reconstructing normal vectors uncorrupted generally large datasets diligent dataset. cases additional corruptions added corruptions typically sparse better align modeling assumptions method. experiments endeavor fully investigate robustness proposed methods existing methods general non-sparse corruptions. speciﬁcally corrupt images poisson noise realistic model noise real images model applicable example performing photometric stereo low-light conditions noise levels signiﬁcant. many existing photometric stereo algorithms apply pixelwise mask preprocessing step remove shadows images. masks typically computed performing simple thresholding operation data excluding pixels chosen threshold subsequent computations. strategy improve results cases capture complexity shadows present image often results useful data rejected. particular importance working small heavily corrupted datasets important reconstruction method access much data possible uncover relevant information. robust methods ﬁrst investigate performance proposed methods diligent dataset object images present dataset additional corruptions images. pdlnv dataset except harvest table presents mean angular errors reconstructed normal vectors method dataset. pdlnv outperforms existing approaches objects. cases methods outperform existing approaches exception reading datasets achieve comparable angular errors best performer. demonstrate primary strength proposed methods constructing normal vectors images less pristine diligent datasets. however table shows pdlnv still able perform better comparable methods speciﬁcally designed operate large clean datasets. practice infeasible collect images object varying lighting conditions. such important develop methods accurately estimate normal vectors smaller datasets. figures illustrate angular errors normal vectors estimated method uncorrupted diligent harvest datasets function number images used. experiments randomly selected images among original images averaged results across trials. ﬁgures clear pdlnv signiﬁcantly outperforms methods dataset sizes. next compare performance proposed methods existing methods images corrupted poisson noise. speciﬁcally subsample diligent dataset images corrupt images poisson noise given signal-to-noise-ratio figure plots angular errors estimated normal vectors algorithm function snr. clear proposed dictionary learning-based approaches significantly robust high levels non-sparse corruptions addition diligent dataset also consider dataset dataset contains images several real objects corresponding normal vectors. obtain reference normal vectors dataset assume objects lambertian. assumption hold exactly objects matte appearance thus nearly lambertian. compute reference normal vectors applying standard least squares method images. motivation considering lambertian dataset follows. even additional noise added primary challenge diligent datasets dealing fundamentally non-lambertian properites data such experiments thus necessarily evaluate ability method estimate lambertian surface presence noise despite fact majority methods investigating based lambertian model. therefore section assume data lambertian corruptions evaluate ability method reject corruptions produce normal vectors agree underlying lambertian model. figure plots mean angular errors estimated normal vectors hippo dataset function snr. high errors approach zero expected since uncorrupted data lambertian. however high regime proposed dictionary learning-based approaches signiﬁcantly robust imperfections compared existing approaches. unlike diligent experiments dlpi method outperforms dlnv pdlnv. suggests dictionary learning-based preprocessing step able robustly remove corruptions lambertian data. also evaluate qualitative performance method. figure shows reference normal vectors dataset dictionary free choose tall square wide dictionaries. case pdnlv also choose parameter controls number piecewise segments non-lambertian model; optimal value depend properties given surface. preceding experiments used atoms dlpi standard choice dictionary learning methods. least squares method) together normal vectors estimated method data corrupted poisson noise snr. figure shows error maps estimated normal vectors respect reference normal vectors. clearly proposed dictionary learningbased methods produce much accurate normal vectors compared existing methods. note dlpi method achieves particularly small errors smooth portions surface normal vectors slowly varying. initialized dictionary discrete cosine transform matrix appropriate size. updates dlnv pdlnv used step size guarantee updates monotonically decrease objectives. figure shows per-iteration properties pdlnv method representative trial diligent dataset. figure plots cost function iteration figure shows corresponding mean angular error normal vector estimates. cost guaranteed decrease iteration angular error increase. empirically found however angular error typically decreases iteration. figure plots sparsity sparse coding matrix iteration. sparsity changed varying regularization parameter empirically found sparsity values around often yield good results. plot figure includes multiple curves several different dictionary sizes particular interest size dictionary affects mean angular error. figure illustrates larger dictionaries typically perform better smaller undercomplete dictionaries. however observe signiﬁcant boost performance dictionary becomes overcomplete. note dictionary atoms used pdlnv size corresponds square dictionary. practice trials included work terminated pdnlv iterations terminated dlnv dlpi iterations. every iteration would iterate columns take proximal gradient steps updating next illustrate effect varying parameter performance pdlnv. figure shows angular error estimated normal vectors varying number images diligent dataset several values illustrated dataset optimal choice. general found typically produces good pdnlv choose atoms third dimension corresponds coordinates normal vector. case used sliding window strategy spatial stride pixels direction extract overlapping patches images normal vectors. used square dictionaries experiments fig. cost function normal vector angular errors sparsity sparse coding matrix pdlnv method applied diligent dataset images poisson noise several different dictionary sizes. figure illustrates initial ﬁnal dictionaries produced pdlnv full diligent dataset. dictionary atom tensor visualize atom three images arranged horizontally. learned dictionary exhibits interesting structure. atoms learned structure across three normal vector dimensions atoms learned structure dimensions trivial dimension. note behavior emerged organically— dictionary learning methods automatically adapt underlying structure per-dataset basis. work proposed three methods applying dictionary learning photometric stereo. method seeks represent form data—either original images reconstructed normal vectors—as sparse respect adaptive dictionary. showed extensive numerical studies proposed methods signiﬁcantly robust existing methods high-noise regime preserving accuracy low-noise regime. dictionary learning general purpose adaptive regularization framework such could coupled complex reﬂectance models photometric stereo literature improve reconstruction quality. plan investigate line inquiry future work. yuille snow epstein belhumeur determining generative models objects varying illumination shape albedo multiple images using integrability international journal computer vision vol. efﬁcient learning dictionaries low-rank atoms proc. ieee global conference signal information processing duan s.-k. yeung benchmark dataset evaluation non-lambertian uncalibrated photometric stereo cvpr", "year": 2017}