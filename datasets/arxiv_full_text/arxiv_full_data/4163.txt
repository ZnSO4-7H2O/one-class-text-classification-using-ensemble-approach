{"title": "Learning to detect and localize many objects from few examples", "tag": ["cs.CV", "cs.AI"], "abstract": "The current trend in object detection and localization is to learn predictions with high capacity deep neural networks trained on a very large amount of annotated data and using a high amount of processing power. In this work, we propose a new neural model which directly predicts bounding box coordinates. The particularity of our contribution lies in the local computations of predictions with a new form of local parameter sharing which keeps the overall amount of trainable parameters low. Key components of the model are spatial 2D-LSTM recurrent layers which convey contextual information between the regions of the image. We show that this model is more powerful than the state of the art in applications where training data is not as abundant as in the classical configuration of natural images and Imagenet/Pascal VOC tasks. We particularly target the detection of text in document images, but our method is not limited to this setting. The proposed model also facilitates the detection of many objects in a single image and can deal with inputs of variable sizes without resizing.", "text": "current trend object detection localization learn predictions high capacity deep neural networks trained large amount annotated data using high amount processing power. work propose neural model directly predicts bounding coordinates. particularity contribution lies local computations predictions form local parameter sharing keeps overall amount trainable parameters low. components model spatial d-lstm recurrent layers convey contextual information regions image. show model powerful state applications training data abundant classical conﬁguration natural images imagenet/pascal tasks. particularly target detection text document images method limited setting. proposed model also facilitates detection many objects single image deal inputs variable sizes without resizing. object detection localization images currently dominated approaches ﬁrst create proposals followed feature extraction pooling boxes classiﬁcation latter steps usually performed deep networks recent methods also deep networks proposal step sometimes sharing features between localization classiﬁcation. differences exist detailed architectures calculations shared layers scales spatial regions etc. another criterion coupling between hypothesis creation conﬁrmation/classiﬁcation. earlier works create thousands hypotheses image figure fully convolutional model high spatial parameter sharing fully trainable d-lstm context layers learns detect potentially many objects examples inputs variable sizes. sometimes using level algorithms leaving burden validation subsequent classiﬁer. current work tends create proposals image satisfy high degree objectness. work focus localization step targeting cases existing methods tend give weak results current trend design high capacity networks trained large amounts training data either directly pre-training step. however applications image content weakly correlated data available standard dataset like imagenet. case small medium amounts training data fully automatic training deep models remains challenge cases. allow detection localization relatively high number potentially small objects image especially hard existing methods target application localization text boxes method restricted kind setting. figure sketches different ways model bounding regression spatially multibox yolo three models pass fully connected layer connects bounding outputs; architecture wise three models identical. grid-like display outputs training; proposed model fully-convolutional layers) keeps spatial structure feature map. global context handled d-recurrent lstm networks indicated colored squares starting corner feature bounding boxes direct regression coordinates. main contribution claim model performs spatially local computations efﬁciently sharing parameters spatially. main challenge case allow model collect features local regions well globally pooled features order able efﬁciently model context. similar models like yolo single-shot detector outputs assigned local regions image. however contrast methods output trained able predict objects support region outside. gradient update step globally match predictions ground truth objects. output model directly sees limited region input image keeps overall number trainable parameters low. however outputs additional information outside regions context collected using spatial recurrent units. spatial context layer proved component model. propose following contributions fully convolutional model object detection using spatial d-lstm layers handling spatial context objective high spatial parameter sharing. application document analysis experiments difﬁcult heterogeneous maurdor dataset show model signiﬁcantly outperforms state objects detection. paper organized follows next section brieﬂy outlines related work. section discusses properties trade-offs deep models related convolutions poolings subsampling related proposed model. based conclusions model introduced section earlier work object recognition proceeded matching local features decomposing objects mixtures parts solving combinatorial problems early work deep learning ﬁrst extended sliding window approach deep neural networks. avoid testing large number positions aspect ratios r-cnn introduced concept object proposals created separate methods followed convolutional networks classify proposal. concept improved fast r-cnn faster r-cnn erhan proposed multibox performs direct regression bounding locations instead relying object proposals. forward pass network outputs assigned target ground-truth boxes matching algorithm. yolo single-shot detector seen variants concept discussed detail section recent work strives detect localize objects pixel-wise precision somewhat blurs boundaries object detection semantic segmentation methods learn segment without pixelwise ground truth also proposed pixelwise segmentation needed application segmentation step performed latter stage jointly recognition context spatial d-recurrent networks proposed early however knowledge method object localization. similarly method inside-outside-nets contain spatial context layers collecting information different directions. however hidden transitions recurrent layers identity whereas model contains fully-ﬂedged trainable d-lstm layers. moreover localization performed proposals selective search deep model being used classiﬁcation bounding correction whereas require region proposal step. model directly performs bounding regression. recent work uses recurrent networks semantic segmentation cnns used text detection instance fully convolutional network used classify position salient text nontext. yolo-related method proposed detection text natural images objects present images. problem dataset sizes addressed before strategies reaching external memories unsupervised learning instance learning feature extraction physics object detection localization convolutional deep neural networks governed implicit properties requirements following lines. concentrate approach direct prediction object locations input image passed series convolutional layers extracts features preceding layer. although absolutely required reducing spatial size features maps frequently done order increase receptive ﬁelds i.e. relative size ﬁlters w.r.t. inputs. choosing pool reduce critical optimizations lead large decreases numbers trainable parameters alternative in-betweenlayer pooling changing size ﬁlters especially trou computation order keep number parameters classical networks stop sequence convolutions reductions spatial size feature shrinks keeping spatial geometrical structure feature representation. subsequent fully connected layers perform feature extraction implicit pooling decision taking. spatial structure feature allows perform controlled pooling speciﬁc regions limshift-invariance representation. recently fully-convolutional networks perform convolutions reductions+pooling spatial size feature negligible e.g. high feature dimension goal fully translate geometry appearance features semantics. training principle lead spatial structuring feature dimension i.e. training lead situation different elements feature layer correspond different regions input image. however constraint model activation last feature layer potentially contain features full image. object detection localization require certain properties like shift invariance spatial precision context collected global scene. several state models multibox yolo single-shot detector tackle architecture sketched ﬁgure sequence convolutions reductions decrease spatial size feature maps small grid figure conv+lstm modules shown ﬁgure module composed convolutional layer directional d-lstm layers parallel whose output feature maps element-wise added single directional d-lstm shown left-to-right/bottom-to-top direction. element gets recurrent connections different predecessors. single unit shown site; notation used contrast real lstm models trainable transition matrices. fully connected feature layer fully connected outputs output predicting bounding positions conﬁdence scores approach several advantages. outputs fully connected previous layers therefore potentially access information full image. last feature layer mixes spatial structure feature dimensions trainable way. although principled difference last fully connected layer actually implemented three models display output layer differently multibox yolo latter also accordance ﬁgures respective papers outputs shown spatial grid however structuring interpretation spatial structure grid wired network architecture. justiﬁed training performed models particular ground truth outputs matched network outputs. case assignment purely spatial outputs given cell trained provide predictions spatial region corresponding cell propose model designed detect large number small objects number training examples i.e. model small number trainable parameters. achieve techniques feature sharing predict different object locations local features only. precisely output layer single object bounding fully connected previous layer illustrated ﬁgure outputs connected convolutions i.e. element last feature connected output modules module consisting relative positions width height conﬁdence score used conﬁrm presence object predicted position. objectives two-fold spatial recurrent context layers drawback local parameter sharing twofold objects larger receptive ﬁeld output lose valuable context information full input image. address concerns context layers consisting multi-dimensional long-short term memory models inserted convolutional layers. vector size corresponding predicted location corresponding conﬁdence target location. ﬁrst term handles location alignment second favours high conﬁdence weight between terms. equation minimized subject constraints namely target matched hypothesis vice versa. well known bi-partite graph matching problem solved hungarian algorithm equation gives loss function used parameter updates. however prefer different values gradient updates matching. found important increase matching order help network diverse outputs. mentioned earlier matching strategy similar described multibox global property brought conﬁdence term hand yolo matching done locally i.e. predictors matched targets falling spatial regions associated with. reason spatial interpretation output grid shown ﬁgure moreover yolo matches target location spatial cell leads non-matched targets case several objects bounding centers cell. target application large number objects present large number objects matched predictor training seen example ﬁgure matching process restricted ﬁxed dictionary anchor locations obtained arbitrarily clustering helps network create outputs specialized regions image. proved unnecessary even counter-productive case predictors share parameters spatially. tested proposed model baselines publicly available maurdor dataset highly heterogeneous dataset composed document images mixed french english arabic text handwritten printed. figure illustrates context layers organized. convolutional layer followed different parallel d-lstm layers propagate information feature elements different diagonal directions starting edges. directions element gets recurrent connections different neighbouring sites. outputs directions summed concatenation would another possibility albeit drastically higher amount parameters. pooling performed convolutions. spatial resolution reduced convolutions strides network outputs computed last hidden layer regression normalized relative bounding locations. particular absolute location predicted object calculated multiplying network output width parameter vector offset vector whose values depend architecture network. formally location lijk object prediction element last feature given follows lijk last hidden layer element-wise sigmoid function weights biases trainable parameters. note that since outputs convolutions parameters shared locations however object predictor features parameters. flexibilty another signiﬁcant advantage proposed local method handle images varying sizes without performing resizing cropping. decreasing increasing size input image changing aspect ratio change size post convolutional feature maps accordingly. change number network outputs i.e. object predictions. model trained stochastic gradient descent using mini-batches size dropout regularization. training object predictors need matched targets i.e. groundtruth object positions. similar strategy multibox done globally entire image allows bounding predictor respond location image. denote number predicted objects given width height last feature number predictors feature location; denote number reference objects image. matching combinatorial problem matching matrix xnm= line level keep pages conﬁdent automatic line position generation worked well. obtain restricted dataset containing training pages validation pages test pages used training validation test evaluation intersection union deteval metrics. intersection union commonly used metric object detection image segmentation. given ratio intersection union reference hypothesis objects. reference objects hypothesis objects matched thresholding score. frequent versions hypothesis associated reference others considered error/insertions. alternatively reporting directly thresholding f-measure computed precision recall. deteval deteval metric chosen icdar robust reading series competitions. main advantage allows many-to-many matchings reference objects hypothesis objects important applications fragmentation objects allowed case text localization. objects assigned thresholding overlap precisions recall f-mesure reported. bag-of-words recognition error goal oriented method described measures performance subsequent text recognition module. objective avoid need judging geometrical precision result directly evaluate performance goal localization method. case target application subsequent recognizer. recognition model based deep convolutional networks spatial/sequence modelling d-lstm layers. assigning character labels network outputs performed connectionist temporal classiﬁcation framework recent follow-up work solves problem attention based mechanisms investigated future work. recognizer trained handwritten printed text lines separately english french text. apply crops localized bounding boxes. word metric contrary metrics based levenshtein distance enables avoid alignment ambiguous page level. word insertion deletions computed page level f-measure reported. traditional text segmentation methods comparison used techniques based image processing document text line segmentation. steerable directional ﬁlters create adaptive local connectivity map. line locations given positions connected components extracted binarisation connectivity map. positions reﬁned heuristic-based post-processing. method proposed nicolaou follows whitest blackest paths blurred image lines interlines. yolo multibox yolo used classes object classiﬁcation part model handwritten text lines printed text lines. helped model learn better without classiﬁcation. systems tested different conﬁgurations original architecture tuned large scale image recognition architecture optimized task validation set. particular size ﬁlters adapted shape objects. hyper-parameter tuning cases architectures heavily reduced numbers layers less units layer. also optimized learning rates minibatch sizes. network architecture proposed model tuned correspond task. found hyperparameters detailed table width height feature maps given illustration course vary. particular aspect ratio image vary. would like stress number parameters independent actual size input image. note number weights last layer position prediction layer rather small able predict number objects number input features multibox yolo would needed parameters. experimentaly found resolution reduction between layers works better using strides convolutional layers instead max-pooling. explained need precision max-pooling known lead shift invariance. figure yolo matches target objects according spatial region fall image leaves many targets unassigned applications many objects makes method applicable. results discussion localization results restricted maurdor test proposed method baselines shown metric table deteval metric table text recognition results shown table respectively pages fully french fully english whole maurdor test set. port f-measure different thresholds i.e. different localization quality requirements. image-based techniques perform poorly threshold i.e. interested ability system detect boxes regardless exact location. suffer general recall. however relatively precise. f-measure drops less learning based methods precision requirements increased increasing threshold iou. explained nature algorithms proceed binarisation input images. normal operating range algorithm segmentation steps work well precision almost guaranteed high. however images don’t fall situations algorithms tuned performance hand methods based direct regression multibox proposed method robust achieve better general recall advantage bought slight drop precision. proposed method gives best results realistic thresholds. deteval metric results shown table conﬁrm results intersection union metric. application perspective namely full page text recognition documents table shows proposed method delivers good results fmeasure word score french english outperforming methods. explained high recall slightly better precision image based methods advantage since recognizer compensate certain limit. last lines tables illustrate importance adding d-lstm layers recover information signiﬁcantly improves performances metrics. power d-lstm layers also shown figure gives example detections. figures show model capable detecting objects larger receptive ﬁelds individual bounding predictors. made possible context information gathered lstm layers. figures show system capable detecting locating large number small objects. signiﬁcantly outperformed method even optimize hyper-parameters attribute fact output layers shared. model needs express similar prediction behavior output thus relearn strategies several times. yolo proved impossible apply kind problem least current shape. reported authors system gives excellent results tasks designed for. however despite extensive tuning hyperparameters able reach satisfying results although worked different implementations original implementation authors well implementation. identify problem however. yolo designed small number objects predictor/target matching algorithm adapted settings mentioned target associated spatial cell harmless restriction traditional object detection tasks. however real problem case shown example image figure large part ground truth objects ﬁgures assigned predictor trained for. boxes missing training network outputs predicting locations punished next parameter update hurting performance hindering networks converging properly. deep learning framework used implementation proposed method since recently theano version doetsch d-lstms implementation knowledge existing tensorﬂow torch theano caffe. system implemented using inhouse framework implemented including optimizer dropout etc. reason also model trained cpus. presented fully-convolutional model detection localization potentially large number objects images. optimize invariance order limit number trainable parameters shared parameters output layer spatial blocks image implementing output layer convolution. deal objects larger receptive ﬁeld order compared proposed model state object detection particular yolo multibox measured detection performance word recognition performance subsequent classiﬁer. experiments showed proposed model signiﬁcantly outperforms methods even hyper-parameters optimized targeted conﬁgurations.", "year": 2016}