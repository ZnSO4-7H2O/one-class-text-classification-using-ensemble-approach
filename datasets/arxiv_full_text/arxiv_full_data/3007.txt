{"title": "Regularizing Face Verification Nets For Pain Intensity Regression", "tag": ["cs.CV", "cs.AI", "cs.LG", "cs.MM"], "abstract": "Limited labeled data are available for the research of estimating facial expression intensities. For instance, the ability to train deep networks for automated pain assessment is limited by small datasets with labels of patient-reported pain intensities. Fortunately, fine-tuning from a data-extensive pre-trained domain, such as face verification, can alleviate this problem. In this paper, we propose a network that fine-tunes a state-of-the-art face verification network using a regularized regression loss and additional data with expression labels. In this way, the expression intensity regression task can benefit from the rich feature representations trained on a huge amount of data for face verification. The proposed regularized deep regressor is applied to estimate the pain expression intensity and verified on the widely-used UNBC-McMaster Shoulder-Pain dataset, achieving the state-of-the-art performance. A weighted evaluation metric is also proposed to address the imbalance issue of different pain intensities.", "text": "fig. example testing result estimated pain intensities patient video shoulder-pain dataset provides per-frame observer-rated labels best viewed color. rate alone combination change often increase. nevertheless takes much effort obtain physiological data videos faces. computer vision supervised learning come long recent years redeﬁning state-of-the-art using deep convolutional neural networks however ability train deep cnns pain assessment limited small datasets labels patient-reported pain intensities i.e. annotated datasets emopain shoulder-pain biovid heat pain particularly shoulder-pain dataset available visual analysis per-frame labels. contains videos patients suffer shoulder pain repeatedly raise arms frames labeled discrete-valued pain intensities dataset small label discrete labels limited labeled data available research estimating facial expression intensities. instance ability train deep networks automated pain assessment limited small datasets labels patient-reported pain intensities. fortunately ﬁne-tuning data-extensive pretrained domain face veriﬁcation alleviate problem. paper propose network ﬁne-tunes state-of-the-art face veriﬁcation network using regularized regression loss additional data expression labels. expression intensity regression task beneﬁt rich feature representations trained huge amount data face veriﬁcation. proposed regularized deep regressor applied estimate pain expression intensity veriﬁed widely-used unbc-mcmaster shoulderpain dataset achieving state-of-the-art performance. weighted evaluation metric also proposed address imbalance issue different pain intensities. obtaining accurate patient-reported pain intensities important effectively manage pain thus reduce anesthetic doses in-hospital deterioration. traditionally caregivers work patients manually input patients’ pain intensity ranging among levels mild moderate severe excruciating. recently couple concepts proposed active automated objective pain monitoring patient’s stay hospital roughly motivation ﬁrst simplify pain reporting process reduce strain manual efforts; second standardize feedback mechanism ensuring single metric performs assessments thus reduces bias. indeed exist efforts assess pain observational behavioral effect caused pain physiological data. ©medasense developed medical devices objective pain monitoring. basic premise pain cause vital signs blood pressure pulse rate respiration fig. simpliﬁed illustration network architecture. convolution layers adapted state-of-the-art face veriﬁcation network remove fullyconnected layers layers. avoid over-ﬁtting limited data number neurons hidden layer relatively smaller previous layer known dropout regularization. ﬁne-tune network pain intensity classiﬁcation limited face images pain labels. however feasible data points regression problem. ﬁne-tuning network employs regression loss regularized center loss shown fig. first modify face veriﬁcation net’s softmax loss mean square error loss regression. last layer network distance layer easily causes gradient exploding large magnitudes gradients initial iterations. thus replace loss using smooth loss huber loss ﬂavor secondly labels discrete sensible regularize loss make regressed values discrete. introduce center loss regularizer output vector hidden layer vector real-valued weights ground-truth label sigmoid activation function +e−x truncate output second layer range pain intensity omitted bias term ﬁne-tuning data-extensive pre-trained domain face veriﬁcation alleviate problem. solutions ﬁne-tuning well-trained face veriﬁcation additional data regularized regression loss hidden fullconnected layer regularized using dropout regularizing regression loss using center loss re-sampling training data population proportion certain pain intensity w.r.t. total population. work ﬁrst attempt regularization idea knowledge ﬁrst apply pain expression intensity estimation. correspondingly propose three solutions address four issues mentioned above. summary contributions work include addressing limited data expression intensity labels relating mappings input face space different output label space identity labels rich pushing pain assessment performance large margin proposing center loss regularizer make regressed values closer discrete values proposing sensible evaluation metric address imbalance issue caused natural phenomena time patient express pain. pieces recent work make progress estimating pain intensity visually using shoulder-pain dataset only ordinal support vector regression recurrent convolutional regression notably trained end-to-end achieving sub-optimal performance. please reference therein existing works. facial expression recognition general trade-off between method simplicity performance i.e. image-based video-based methods. videos sequential signals appearance-based methods including cannot model dynamics given temporal model spatio-temporal models regards regularizing deep networks exists recent work regularize deep face recognition nets expression classiﬁcation facenetexpnet pre-training train convolutional layers expression regularized deep face recognition net. reﬁning stage append fully-connected layers pre-trained convolutional layers train whole network jointly. network based state-of-the-art face veriﬁcation network trained using casia-webface dataset contaning million face images identity labels. classiﬁcation network employs softmax loss regularized proposed center loss. difﬁcult directly similar idea linear discriminant analysis withminimizing between-class distances. also ﬂavor k-means clustering supervised way. center loss added regression loss hidden layer induce loss coefﬁcient. thus supervision regularizer applied features. different jointly learn centers minimize within-class distances gradient descent centers learned moving average. weighted evaluation metrics labels shoulder-pain dataset highly imbalanced frames labeled pain intensity thus relatively safe predict pain intensity zero. fairly evaluate performance propose weighted version evaluation metrics i.e. weighted weighted address dataset imbalance issue. example wmae simply mean pain intensity. weighted population pain intensity. apply techniques sample training data make training consistent metrics. first eliminate redundant frames sequences following intensity remains consecutive frames choose ﬁrst representative frame. second training uniformly sample images classes feed network. neural network ‘see’ totally balanced dataset. dataset training details test network shoulder-pain dataset contains videos subjects widely used benchmarking pain intensity estimation. dataset comes four types labels. three annotated online video collection sensory scale affective scale visual analog scale ranging addition observers rated pain intensity ofﬂine recorded videos ranging previous works take online label quantify original pain intensity range range face veriﬁcation network trained casiawebface dataset contains training images identities. consistent face veriﬁcation perform pre-processing images shoulder-pain dataset. speciﬁc leverage mtcnn model detect faces facial landmarks. faces aligned according detected landmarks. fig. illustration loss functions works. point represents feature vector feature space. regression loss linear projection project feature vectors one-dimension values. calibration coordinate axis uniform sigmoid activation linear function. best viewed color. elegance. gradient exploding problem often happens relatively large gradient magnitude initial iterations. phenomenon also described solve problem follow apply smooth loss makes gradient smaller case loss absolute error large. different regressor outputs scalar instead vector. compromise squared absolute error losses turning point absolute error squared error function absolute error function. ﬂavor huber loss. works similar loss since error usually equivalent mean abosolute error loss. regularization using center loss since pain intensity labeled discrete values shoulder-pain dataset natural regularize network make regressed values ‘discrete’ training make same-intensity’s regressed values compact possible center loss minimizes within-class distance thus deﬁned represents center class essentially mean features class. denotes norm typically observe expriments center loss shrinks distances features label illustrated fig. relate literature table performance regression network related works shoulder-pain dataset estimation pain intensity short mean absolute error deviated ground-truth labels frames video. mean squared error measures curve ﬁtting degree. pearson correlation coefﬁcient measures curve trend similarity best highlighted bold. learning rate avoid huge modiﬁcation convolution layers. network trained iterations reasonable networks converge observed cross validation folds. weight regression loss weights softmax loss center loss respectively. evaluation using unweighted metrics cross validation conventional address over-ﬁtting small dataset. case -fold cross validation times shoulder-pain dataset contains subjects. setting exactly leave-one-subject-out setting osvr except osvr’s experiments exclude subject whose expressions noticeable pain time videos subject reserved testing. videos used train deep regression network. performance summarized table concluded algorithm performs best equally best various evaluation metrics especially combination smooth loss center loss. note osvr uses hand-crafted features concatenated landmark points gabor wavelet coefﬁcients pca. evaluation using weighted metrics table provide performance predicting zeros baseline. interestingly metrics zero prediction performs much better several state-ofthe-art algorithms. using proposed metrics performance summarized table performance previous work osvr longer predicting zeros. also table uniform class sampling strategy help evaluation metrics. moreover provided evaluation program table performance network evaluated using weighted weighted mse. ‘sampling’ means uniform class sampling technique applied. notably center loss sampling incrementally boost performance. given restriction labeled data prevents directly training deep pain intensity regressor ﬁne-tuning data-extensive pre-trained domain face veriﬁcation alleviate problem. paper regularize face veriﬁcation network pain intensity regression. particular introduce smooth loss pain intensity regression well introduce center loss regularizer induce concentration discrete values. ﬁne-tuned regularizered network regression layer tested unbc-mcmaster shoulder-pain dataset achieves state-of-the-art performance pain intensity estimation. main problem motivates work expertise needed label pain. take-home message ﬁne-tuning data-extensive pre-trained domain alleviate small training problems. hand unsupervised learning rely training data. indeed discrete-valued regression good test center-based clustering. although regularizing supervised deep network intuitive performance rather empirical. future need insights function transfer learning. note temporal information modeled paper. pain temporal subjective prior knowledge stimulus needs incorporated help quantify individual differences. performing work xiang xiang funded dept’s teaching assistantship feng wang alan yuille supported ofﬁce naval research feng jian chen supported national natural science foundation china feng also funded china scholarship council xiang grateful fellowship previous years. ziheng wang shangfei wang qiang capturing complex spatio-temporal relations among facial muscles proceedings facial expression recognition ieee conference computer vision pattern recognition yimo guoying zhao matti pietik¨ainen dynamic facial expression recognition using longitudinal proceedings eufacial expression atlases ropean conference computer vision yandong kaipeng zhang zhifeng qiao discriminative feature learning approach deep face recognition proceedings european conference computer vision nitish srivastava geoffrey hinton alex krizhevsky ilya sutskever ruslan salakhutdinov dropout simple prevent neural networks overﬁtting. journal machine learning research vol. ognjen rudovic vladimir pavlovic maja pantic automatic pain intensity estimation heteroscedastic conditional ordinal random ﬁelds proceedings international symposium visual computing patrick lucey jeffrey cohn kenneth prkachin patricia solomon iain matthews painful data unbc-mcmaster shoulder pain expression archive proceedings ieee international database conference automatic face gesture recognition aung sebastian kaltwang bernardino romeraparedes brais martinez aneesha singh matteo cella michel valstar hongying meng andrew kemp aaron elkins automatic detection chronic painrelated expression requirements challenges multimodal dataset ieee transactions affective computing vol. philipp werner ayoub al-hamadi robert niese steffen walter sascha gruss harald traue towards pain monitoring facial expression head pose database automatic system remaining challenges proceedings british machine vision conference ding shaohua kevin zhou rama chellappa facenetexpnet regularizing deep face recognition expression recognition proceedings ieee international conf. automatic face gesture recognition zhao quan shangfei wang qiang facial expression intensity estimation using ordinal inproceedings ieee conference formation computer vision pattern recognition jing zhou xiaopeng hong guoying zhao recurrent convolutional neural network regression continuous pain intensity estimation video proceedings ieee conference computer vision pattern recognition workshops fabian benitez-quiroz ramprakash srinivasan aleix martinez emotionet accurate real-time algorithm automatic annotation million facial expressions wild proceedings ieee conference computer vision pattern recognition arnaud dapogny kevin bailly severine dubuisson pairwise conditional random forests facial expression recognition proceedings ieee international conference computer vision", "year": 2017}