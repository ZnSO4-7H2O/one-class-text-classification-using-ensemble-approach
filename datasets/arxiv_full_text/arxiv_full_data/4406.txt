{"title": "Driver Action Prediction Using Deep (Bidirectional) Recurrent Neural  Network", "tag": ["stat.ML", "cs.CV"], "abstract": "Advanced driver assistance systems (ADAS) can be significantly improved with effective driver action prediction (DAP). Predicting driver actions early and accurately can help mitigate the effects of potentially unsafe driving behaviors and avoid possible accidents. In this paper, we formulate driver action prediction as a timeseries anomaly prediction problem. While the anomaly (driver actions of interest) detection might be trivial in this context, finding patterns that consistently precede an anomaly requires searching for or extracting features across multi-modal sensory inputs. We present such a driver action prediction system, including a real-time data acquisition, processing and learning framework for predicting future or impending driver action. The proposed system incorporates camera-based knowledge of the driving environment and the driver themselves, in addition to traditional vehicle dynamics. It then uses a deep bidirectional recurrent neural network (DBRNN) to learn the correlation between sensory inputs and impending driver behavior achieving accurate and high horizon action prediction. The proposed system performs better than other existing systems on driver action prediction tasks and can accurately predict key driver actions including acceleration, braking, lane change and turning at durations of 5sec before the action is executed by the driver.", "text": "abstract—advanced driver assistance systems significantly improved effective driver action prediction predicting driver actions early accurately help mitigate effects potentially unsafe driving behaviors avoid possible accidents. paper formulate driver action prediction timeseries anomaly prediction problem. anomaly detection might trivial context finding patterns consistently precede anomaly requires searching extracting features across multi-modal sensory inputs. present driver action prediction system including real-time data acquisition processing learning framework predicting future impending driver action. proposed system incorporates camera-based knowledge driving environment driver themselves addition traditional vehicle dynamics. uses deep bidirectional recurrent neural network learn correlation sensory inputs impending driver behavior achieving accurate high horizon action prediction. proposed system performs better existing systems driver action prediction tasks accurately predict driver actions including acceleration braking lane change turning durations action executed driver. driving indispensable component daily life. decades tremendous effort dedicated improving safety efficiency driving. although earlier advanced driver assistance systems primarily focused sensing dangerous external environmental factors might impact safe driving recent efforts shifting incorporating driver intention system several recent studies demonstrated predictive driving assistant systems aware driving patterns intentional driver behavior helpful providing early notification mitigate dangerous driving maneuvers paper formulate driver action prediction timeseries anomaly prediction problem. therefore proposed framework contains main components. first anomaly detection driver action recognition system. fig. shows detection common driver actions related pedalling steering timeseries anomalies. second component anomaly prediction driver action prediction system involves predicting earlier detected anomalies occur future. prediction system uses deep bidirectional recurrent neural network consisting multiple long-short term memory units and/or gated recurrent units cells learns identify early possible spatialtemporal dependencies timeseries data respect future driver action. therefore dependencies occur data stream model able accurately predict impending driver action driver takes action. choice prediction algorithm conjunction high observability driver action enables possibility training driver action prediction model offline online using data obtained action recognition system. rest paper organized follows section describe related driver action prediction work section contains system description section contains deep principle structure. driver-vehicleexisting work driver action prediction focuses feature engineering addition basic temporal sequence modeling. action interest features temporally correlated action interest selected based prior expert knowledge. example vehicle speed measurements can-bus along traffic light sensing data adopted predicting driver braking behavior time window. steeringwheel angles considered lane departure analysis. vehicle velocity steering angle external information used modelling lane-change maneuver similarly vehicle dynamics used identifying driver intention near intersections proposed long-term trajectories also informative driver intention analysis. probabilistic finite state machine used model driver intention trajectory data. others also studied extracted features vision-based sensors cameras. front-facing camera used predict different driving behaviors. authors also used ego-vehicle dynamics lane information extracted cameras recognize driving related events. driver behavior modeling also involve advanced control machine learning techniques. existing literature driving models built using optimal control theory analyzing steering behavior tracking driving path estimating route. bayesian reasoning used recognize driver intention complex input feature dimension. high performance models used dynamic bayesian networks hidden markov model modified structures achieve remarkable achievements various applications. yield best result. system capable extracting relevant sensing information useful predicting future driver action. therefore sensor-rich input there’s need learning framework take advantage this. although authors explore sensor-rich input lane change prediction learning framework based relevant vector machine limited feature extraction capability. authors addressed problem using lstm based recurrent neural network richer discriminative features) spatial sensory fusion improve performance. also include turn prediction work. comparison work explores richer sensory input model also predict steering braking/acceleration actions unlike focused steering actions. importantly using windowing approach similar employ deep bidirectional extract richer stable representation sensory input. core algorithmic difference paper proposition double lstm units used achieved spatial fusion assigning in-vehicle features lstm outside vehicle features other assign feature lstm units unit processes sensory sequence past current future current. fusion different temporal directions enables model find causes future action accurately much earlier achievable purpose proposed system correctly estimate driver intent early possible driver takes action. system shown fig. capable modeling prediction recognizable driver action. proposed system depicted left fig. consists sensing module feature extraction modules action recognition module action prediction module training module. sensing module handles sensing. feature extraction modules independently extract features used recognize predict driver actions shown table driver action prediction module continuously predicts future driver action running prediction network model features extracted prediction. hand driver action recognition module runs recognition network model features extracted recognition order recognize driver actions. lastly training module retroactively combining features extracted prediction recognized action label generate training examples used train model. system uses off-the-shelf feature extraction systems therefore main algorithmic contribution prediction network shown right fig. component work dbrnn framework shown right hand side model future driver action. cell simple long-short term memory gated recurrent unit rnns. since goal predict driver action takes place assuming negative positive states recognized correctly recognition network dbrnn framework focuses modeling transition negative state positive state feature sequences. state rest anomalous. define parameters; maximum horizon maximum sequence length prediction. time prediction system models joint conditional probability .sec .sec please note internal state used provide context timestamp other. order limit arbitrary context propagation therefore improve performance dbrnn network uses window similar model conditional probability non-linear activation. output vectors hidden variables describe distribution observation. different traditional feed-forward neural network also considers historical information so-called memory. label determined non-linear mapping hidden variables. mathematical formulations described following equations. hidden bias vector) matrices respectively. parameters learned training data. recently researchers demonstrated problem simple structures gradient vanishes training. solve problem popular replacements long short-term memory gated recurrent unit cells maintain state time resulting captured long term dependencies within time series data versions lstm cell used paper respectively given following shorthand notation respectively denote lstm cell operations. although system uses multi-modal inputs need feed input modality since modalities already pre-processed. therefore concatenated features together pass network single vector. also evaluated spatial sensory fusion demonstrated yield improved performance deeper structure bidirectional rnn. network training train network back propagation time using tensorflow nvidia running ubuntu network weights biases adapted using adam optimizer learning rate decay epochs. maximum epoch gradient cell clipped value avoid gradient explosion problem. cell hidden units. performance machine learning methods heavily dependent choice data representation applied. data used paper sensory input system multi-modality sequences derived following can-bus steering angle pedal pressures rate speed acceleration road slope engine rpm; face camera head pose gaze; hand camera hands positions hands moving on/off streering wheel status; dash camera adjacent lane availability right left lane offset relative position speed road objects driver adjacent lanes gps+map distance direction nearest intersection. separated incoming sensory data recognition prediction purposes depicted table following detailed description features extracted driver action prediction. vehicle dynamic information monitoring straightforward method determining vehicle’s working status driver-vehicle interaction. data obtained decoding codes according protocols. obtain dimension feature vector can-bus. shortcoming conventional rnns able make previous context. however windowed approach whole available reason exploit future context well. shown right hand side fig. bidirectional rnns using basic units processing data directions separate hidden layers forward output layer. brnn potential disentangle complicated temporal dependencies deep rnns created stacking multiple hidden layers other output sequence layer forming input sequence next shown fig. assuming hidden layer function used layers stack hidden receives input forward backward layers level below. proposed network right fig. deeper architecture obtained replacing unit deep bidirectional deep unidirectional rnn. hence stacked brnn forward backward cell stacked configuration obtain xmxn unit system. however found deep configurations yield better performance limited dataset over-fit training data. therefore dataset considered here single bidirectional lstm stacked single unidirectional cell yielding three unit system i.e. driver’s head motion determined analyzing video driver’s face. processing pipeline consists face detection facial landmark tracking feature extraction. similar face detection landmark tracking tasks implemented constrained local neural field model totally landmarks extracted detected face. based landmark tracks driver’s face movements rotations represented histogram features. particular matching landmarks successive frames per-pixel horizontal changes calculated model movements rotations. finally mean movement histograms horizontal angular motions bins calculated. final result -dimensional feature vector sample represent face features. important driving behavior hand gesture descriptor. location movement hands steering highly correlated impending lane change turn cases even braking acceleration. adopt frcnn facilitated hand detection algorithm extracted following features hand positions distance relative angle towards steering center relative position steer wheel motion moving distance moving direction. overall -dimensions sample encode hand information driving. driving environment information environment provides influential driving context affecting driver’s judgment driving maneuver change. features describing environment constructed outputs mobileye system processing dash camera images. extracted features include binary features indicating whether lane exists left side right side vehicle respective offset curvature; object position speed information driver adjacent lanes. dimension feature vector obtained dash camera. also compare vehicle coordinates street maps build -dimensional representation proximity intersection. consists -factor feature indicating vehicle approaching departing road artifact intersections turns highway exists etc; actual distance nearest intersection. collected driving data different driving conditions across drivers recorded south fransisco area california. data collection vehicle outfitted three cameras data logger. sampling rates across sensors -fps cameras respectively. action prediction resampled incoming data missing data either extrapolated float-value features repeated nearest past value factor-value features. postive negative samples sequence used yileding input size example demonstrate proposed system capabilities evaluate braking lane change turn anomaly action prediction. table contains detected number anomalous actions normal states using proposed recognition system cases compare unidirectional system using balanced dataset. finally investigate performance training data individual driver compared generic model five drivers. braking action prediction fig. plots performance predicting braking events braking detected. proposed dbrnn network gives comparable unidirectional lstm slight performance improvement beginning test sequence yielding better prediction horizon. unidirectional lstm obtained removing backward lstm network. overall proposed dbrnn system able achieve average accuracy true positive rate false positive rate braking event. lane change action prediction lstm entire preceding event. however fewer number positive lane change actions overall performance less braking prediction. please note true positive rate average positive rates left right lane change. turning action prediction predicting left right turns proposed dbrnn system shows better performance unidirectional version models perform better worse compared lane change braking prediction respectively. also worth note performance dbrnn unidirectional version higher lower compared braking lane change prediction respectively. individual driver action prediction finally apply predictive models braking data individual driver opposed drivers data used evaluations above. overall accuracy comparison depicted fig. result shows models perform better individual driver data compared combined driver fig. however proposed dbrnn performance improvement unidirectional version higher individual driver. summary results indicate proposed dbrnn performs better unidirectional version across evaluated scenarios. exception predicting braking using generic model systems demonstrated comparable performance. general performance improvement appears increase reduced number detected positive examples well individual driver data. also performance models increases individual driver data compared generic driver data. highlights predictive model able learn data single individual making real-time training vehicle real possibility future predictive systems. paper proposed novel system integrates recognition prediction systems. proposed prediction system based dbrnn enables temporal fusion past future context learn correlation sensor data future driver action. proposed dbrnn system performs better state-of-the-art system based unidirectional potentially trainable vehicle modeling individual drivers. high prediction accuracy prediction horizon performance enable driver assistance capabilities effectively alert drivers taking dangerous driving actions. proposed prediction system also applied general class anomaly prediction system. future works include improving system performance extending input sensing modalities well extending system capability directly predict anomalous event time-to-event simultaneously. ohn-bar eshed ashish tawari sebastien martin mohan manubhai trivedi. \"predicting driver maneuvers learning holistic features.\" intelligent vehicles symposium proceedings ieee morris doshi trivedi. lane change intent prediction driver assistance on-road design evaluation. ieee international vehicle symposium proceedings jain ashesh hema koppula shane bharad raghavan singh ashutosh saxena. \"braincars knows sensory-fusion deep learning architecture.\" arxiv preprint arxiv. maye jérôme rudolph triebel luciano spinello roland siegwart. \"bayesian on-line learning driving behaviors.\" robotics automation ieee international conference ieee miyajima chiyomi yoshihiro nishiwaki koji ozawa toshihiro wakita katsunobu itou kazuya takeda fumitada itakura. \"driver modeling based driving behavior evaluation driver identification.\" proceedings ieee ortiz michaël garcia jens schmüdderich franz kummert alexander gepperth. \"situation-specific learning ego-vehicle behavior prediction systems.\" intelligent transportation systems international ieee conference ieee angkititrakul pongtep ryuta terashima toshihiro wakita. stochastic driver behavior model lane departure warning.\" intelligent transportation systems ieee transactions guoqing yongsheng zhangjun song. \"dynamic modeling driver control strategy lane-change behavior trajectory planning collision prediction.\" intelligent transportation systems ieee transactions liebner martin michael baumann felix klanner christoph stiller. \"driver intent inference urban intersections using intelligent driver model.\" intelligent vehicles symposium ieee ieee kurt arda john yester yutaka mochizuki. \"hybrid-state driver/vehicle modelling estimation prediction.\" intelligent transportation systems ieee conference ieee ortiz michaël garcia franz kummert jens schmüdderich. \"prediction driver behavior limited sensory setting.\" intelligent transportation systems international ieee conference ieee meyer-delius daniel christian plagemann wolfram burgard. \"probabilistic situation recognition vehicular traffic scenarios.\" robotics automation international conference ieee berndt holger jörg emmert klaus dietmayer. \"continuous driver intention recognition hidden markov models.\" intelligent transportation systems itsc international ieee conference ieee jain ashesh hema koppula bharad raghavan shane ashutosh saxena. knows anticipating maneuvers learning temporal driving models.\" arxiv preprint arxiv. graves alan abdel-rahman mohamed geoffrey hinton. \"speech recognition deep recurrent neural networks.\" acoustics speech signal processing ieee international conference ieee kyunghyun merrienboer bart gulcehre caglar bougares fethi schwenk holger bengio yoshua. learning phrase representations using encoder-decoder statistical machine translation. arxiv preprint arxiv. baltrusaitis tadas peter robinson louis-philippe morency. \"constrained local neural fields robust facial landmark detection wild.\" proceedings ieee international conference computer vision workshops shaoqing kaiming ross girshick jian sun. \"faster rcnn towards real-time object detection region proposal networks.\" advances neural information processing systems", "year": 2017}