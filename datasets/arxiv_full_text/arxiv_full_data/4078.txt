{"title": "FastMask: Segment Multi-scale Object Candidates in One Shot", "tag": ["cs.CV", "cs.AI"], "abstract": "Objects appear to scale differently in natural images. This fact requires methods dealing with object-centric tasks (e.g. object proposal) to have robust performance over variances in object scales. In the paper, we present a novel segment proposal framework, namely FastMask, which takes advantage of hierarchical features in deep convolutional neural networks to segment multi-scale objects in one shot. Innovatively, we adapt segment proposal network into three different functional components (body, neck and head). We further propose a weight-shared residual neck module as well as a scale-tolerant attentional head module for efficient one-shot inference. On MS COCO benchmark, the proposed FastMask outperforms all state-of-the-art segment proposal methods in average recall being 2~5 times faster. Moreover, with a slight trade-off in accuracy, FastMask can segment objects in near real time (~13 fps) with 800*600 resolution images, demonstrating its potential in practical applications. Our implementation is available on https://github.com/voidrank/FastMask.", "text": "segment proposal segment proposal. highly matched receptive ﬁeld demanded distinguish foreground object background. figure examples given explain mismatched receptive ﬁeld affects segment proposal results hand receptive ﬁeld object proposer much smaller object bbox-based proposer could still roughly estimate bounding prior knowledge. however mission becomes almost impossible segment-based proposer need imagine complete contour bus; hand large receptive ﬁeld introduce noises backgrounds result incorrect instance-level segments. example segment-based proposer could distracted people standing nearby target person leading inaccurate mask covering target person. consequence receptive ﬁeld segmentbased proposer ﬁxed object scale variance badly affect segmentation ﬁneness proposal recall. general existing methods could divided major categories deal scale variances. ﬁrst category uses extra bboxbased object proposals object detections initial inputs. objects appear scale differently natural images. fact requires methods dealing object-centric tasks robust performance variances object scales. paper present novel segment proposal framework namely fastmask takes advantage hierarchical features deep convolutional neural networks segment multi-scale objects shot. innovatively adapt segment proposal network three different functional components propose weight-shared residual neck module well scale-tolerant attentional head module efﬁcient one-shot inference. coco benchmark proposed fastmask outperforms state-of-the-art segment proposal methods average recall times faster. moreover slight trade-off accuracy fastmask segment objects near real time resolution images demonstrating potential practical applications. implementation available https//github.com/voidrank/fastmask. object proposal considered ﬁrst fundamental step object detection task domain rapidly progressed renewed interest object segment proposal received intensive attentions different traditional object proposal methods segment proposal algorithms expected generate pixel-wise segment instead bounding object. perspective segment proposal inherits object proposal image segmentation takes step towards simultaneous detection segmentation brings challenges overcome. among challenges tackle scale variances object appearance remains critical one. compared bounding-box-based object proposal scale variance becomes serious problem however effectiveness efﬁciency highly dependent accuracy speed pre-processing proposal methods. second adopts image pyramid strategy original image rescaled ﬁxed-scale object proposer repeatedly multiscale inference however multi-shot methods face common dilemma densely sampled image pyramid becomes computational bottleneck whole framework; nevertheless reducing number scales image pyramid leads performance degradation. methods could hardly provide satisfactory accuracy speed time. observation original image already contained information image pyramid argue using single image enough capture multi-scale objects therefore paper address scale variances segment proposal leveraging hierarchical feature pyramid convolutional neural networks adapt segment proposal network three different functional components namely body neck head. similar body head module responsible extracting semantic feature maps original images decoding segmentation masks feature maps respectively. furthermore introduce concept neck module whose recurrently zoom feature maps extracted body module feature pyramids feed feature pyramids head module multi-scale inference. summarize main contributions follows first learn novel weight-shared residual neck module build feature pyramid preserving well-calibrated feature semantics efﬁcient multi-scale training inference. next propose novel scale-tolerant head module takes advantage visual attention signiﬁcantly reduces impact background noises caused mismatched scales receptive ﬁelds. finally together modules make framework capable one-shot segment proposal. evaluate framework coco benchmark achieves state-of-the-art results running near real time. related work bbox-based object proposal. bbox-based object proposal methods rely dense sliding windows image pyramid. edgebox bing edge feature used make prediction sliding window gradient feature used recently deepbox trains re-rank proposals generated edgebox multibox generates proposals convolutional feature maps directly. presented region proposal network proposed handle object candidates varying scales. segment-based object proposal. segments proposal algorithms diverse regions image likely contain objects. traditional segment proposal methods selectivesearch geodesic ﬁrst over-segment image super pixels merge super pixels bottom-up fashion. inspired success cnns image segmentation previous works perform segmentation bbox-based object proposal results obtain object segments. state-of-the-arts deepmask proposes body-head structure decode object masks feature maps sharpmask adds backward branch reﬁne masks. however methods rely image pyramid inference limits application practice. visual attention. instead using holistic image feature number recent works explored visual attention highlight discriminative region inside images reduce effects noisy background. paper apply attention mechanism improve instance-level segmentation performance. deepmask considered representative cnn-based multi-shot segment proposal methods body-head structure proposed. section brieﬂy review deepmask help better understand multi-shot paradigm proceed proposed oneshot paradigm. patch-based training. deepmask trained predict segmentation mask conﬁdence score given ﬁxedsize image patch. training image patch assigned positive satisﬁes object-centric constrain otherwise negative. image patches cropped rescaled ﬁxed size patches body network deepmask extract semantic feature maps decoded conﬁdence scores segmentation masks using head module. multi-shot inference. multi-shot inference deepmask applies trained model densely location repeatedly across different scales. shown figure ﬁrst input image resized repeatedly image pyramid. next body network deepmask extracts full feature resized image. finally head module applied every ﬁxed-size sliding window multi-scale feature maps decodes conﬁdence score mask sliding window. overcome inefﬁciency brought image pyramid propose one-shot paradigm enables efﬁcient training inference. shown figure inherit body-head structure introduce component called neck. neck component could used feature zoom feature pyramid preserving feature semantics. then shared head module applied pyramid feature maps decode object segments different scales. proposed body-neck-head structure could save redundant convolutional computation make efﬁcient information perform segment proposal shot. refer one-shot segment proposal paradigm derive proposed segment proposal framework section section introduce approach detail. first overview proposed architecture give concrete idea body-neck-head structure. explain entire pipeline illustrating data input image object segments. next study different designs neck module including non-parametric parametric necks. finally present novel head module enables scale-tolerant segmentation mask decoding taking advantage attention model plays role improving performance. present network architecture figure similar multi-shot methods body network extracts semantic feature input image. base feature shared neck module applied recursively build feature maps different scales. pyramid feature maps input convolution reducing dimensionality. next extract dense sliding windows feature maps batch normalization across windows calibrate window features. note feature downscaled factor sliding window size corresponds patch approach could easily adopted existing architectures resnet replacing fully connected layers convolutional pooling layers neck head modules. reason removing convolutional pooling layers keep feature feasible size small object could still correspond notable region feature map. consider non-parametric parametric methods encoding feature pyramid. zoom feature straightforward choice non-parametric pooling. pooling average pooling widely used components modern architectures recognition detection. scenario would like calibrate feature uniﬁed decoding. however pooling necks generate sub-optimal empirical results desired natural. section discuss several choices necks compare empirically. pooling neck. pooling produces uncalibrated features encoding. spatial grids feature pooling takes response grid downscaled feature maps. result process increases mean output feature maps. pooling repeatedly applied feature maps would signiﬁcantly larger mean bottom ones. average pooling neck. average pooling smooths discriminative feature encoding. different pooling average pooling maintains mean feature maps. although helps keep means features different scales calibrated blurs discriminative feature. lost discriminative feature makes head module suffer distinguishing object background. feed-forward neck. alleviate side-effects propose learn parametric necks preserve feature semantics. naive parametric choice learn feedforward neck uses convolutional pooling layers zoom feature maps. however feed-forward neck following combination convolutional layers fully connected layers assemble head module decoding mask object conﬁdence. however context feature pyramid decoding found simply applying head leads suboptimal performance. likely reason that comparing original deepmask feature pyramid sparser scales. concrete neck module applied feature downscaled factor means scale adjacent feature maps sparse feature pyramid raises possibility suitable feature maps exists object decode also increases risk introducing background noises object matches well size receptive ﬁeld observations drive propose alternative solutions alleviating problem. first tried expand network stream simply increase scale density second develop novel head module learns attend salient region decoding. visual attention decoding head could reduce noises backgrounds sliding window alleviate mismatch size receptive ﬁeld object. note attention also brings tolerance shift disturbance improves robustness. figure gives detailed implementation attentional head. given feature sliding window input ﬁrst compute spatial attention fully connected layer. spatial attention applied window feature element-wise multiplication across channels. operation enables head module highlight features salient region indicates rough location target object. finally attended feature input fully connected layer decode segmentation mask object. comparison. verify effectiveness proposed attentional head experimental comparisons fastmask standard head fastmask attentional head reported table table tolerance scale shift disturbance attentional head signiﬁcantly improves segment profaces gradient vanishing effect number scales increases. addition feature semantics change substantially since feature maps convolutional operations bottom ones. residual neck. inspired bottle-neck connection design learn residual neck figure augment non-parametric average pooling parametric residual component zoom feature maps order reduce smooth effect average pooling well preserve feature semantics. comparison. verify effectiveness proposed necks empirically evaluate designs report performance table report overall objects different sizes results conﬁrm residual neck component beats necks terms average recall. note obtain large margin average recall objects large scale decoded feature maps. veriﬁes effectiveness residual neck encoding feature pyramid. posal accuracy. visualization. justify effectiveness regional attention denoising visualize examples exemplars. example skateboard central object person riding noisy. consequence generated attention weight regions close skateboard higher conﬁdence highlight central object. similarly bottom example indicates spirit vice versus manner person becomes central object skateboard noise. section ﬁrst present practical technique obtaining scales feature pyramid. give details training optimization inference framework. made code public available https//github.com/voidrank/fastmask. mentioned section make feature pyramid denser craft body network branches middle applying pooling layers different strides feed differently scaled features shared neck. augments body network capability produce features diverse sizes necessarily limited multiple two. practice branch pooling feature downscaled generate feature downscaled factors input feature shared convolutions. apply neck head modules streams produce object segments different scales. technique adds scales feature helps fastmask robust scale difference introduce limited extra computation. note parameters learning branching technique. training difference training fastmask standard deepmask fastmask could trained images varying scales rather cropped ﬁxed-scale patches. enable training scheme introduce strategies ground truth assignment learning objective optimization details. ground truth assignment. training need determine sliding window ground truth object belongs ground truth object assign sliding window fully contains object object scale range regard window object roughly centered window object assigned window extract segmentation mask segmentation ground truth surrounding bounding attention ground truth learning objective. overall objective function fastmask weighted conﬁdence loss segmentation loss region attention loss note stand ground truth label conﬁdence region attention segmentation mask stand corresponding prediction. indicator function returns true otherwise. equation indicates back-propagate gradients critical good performance computing lseg latt positive object samples. normalize weighted lseg latt normalize spatially across window balance gradients three loss components. standard binary cross entropy function sigmoid activation function following form train network approximately epochs choose best models different subset coco validation set. following practice balance positive negative samples certain ratio collecting sliding-windows training. practice limitation memory train two-stream network totally -scale feature maps taking zooming times stream stride times stream stride inference process image shot extract windows multi-scale feature maps training stage. first conﬁdence score window predicted top-k conﬁdent windows selected object segment decoding. addition residual neck weight shared could reduce number neck components inference. enables make easy trade-off effectiveness efﬁciency adjusting number neck components. therefore although trained scales two-stream network could still equipped neck modules generate denser feature pyramid. following experiments unless speciﬁed two-stream network scales inference stage. analyze evaluate network coco benchmark contains training images total nearly instance annotations. following experimental setting report result ﬁrst coco validation images. another nonoverlapped images validation. metrics. measure mask accuracy intersection union predicted mask ground truth annotation. average recall correlates well object proposal quality summarize average recall ﬁxed number proposals denoted order measure performance scales. coco dataset contains objects wide range scales ﬁne-grained evaluation tends measures metrics regards object scales. practically objects divided three groups according pixel areas small medium large experiments denote metrics different scales adding superscripts respectfully. methods. default compare method recent state-of-the-arts segment proposal including deepmask sharpmask instancefcn note also provide results revised deepmask architecture denoted deepmask∗. different original deepmask implemented based layer residual revised head component. methods achieve good average recall also provide strong efﬁciency inference. network general could plug-in different body networks. experiments adopt -layer residual best accuracy well fair comparison pvanet best efﬁciency. table compares performance fastmask state-of-the-art methods. report results bounding segment proposals include sharpmaskzoom result images extra scales obtain superior performance. compare two-stream fastmask image pyramid based methods since one-stream network contain density feature pyramid. address inﬂuence feature scale density performance well efﬁciency conduct separate controlled experiments section quantitative evaluation. according table outperform state-of-the-art methods bounding-box proposal large margin obtain competitive results segmentation proposals worth noting two-stream network signiﬁcantly improves proposal quality comparing methods provides guidance potential bbox-based object detection. twostream fastmask model -layers resnet achieves approximately relative improvement metrics respectively previous best sharpmask model. order give better picture proposal quality plot recall versus threshold different segmentation proposals coco dataset figure clear plot indicates fastmask produce better mask quality overall. obtaining superior performance method also yields better efﬁciency image pyramid based approaches. controlled experiments report speed/performance section qualitative visualization. visualize results figure showing exemplars method improves baselines. generally observe method robust scale variance invariant noisy background. like sharpmask fastmask perform mask reﬁnement all. possible boost mask quality leveraging mask reﬁnement. efﬁciency study section evaluate threads support argument fastmask outperforms image pyramid methods efﬁciency performance. ﬁrst thread provide experimental results deepmask sharpmask restriction scale density image pyramids. construct fair environment methods method take equivalently many scales evaluate inference speed performance. thread provide performance speed state-of-the-art methods compare best model well fastest model them. trade-off scale density speed. conduct fair study analyze trade-off decreasing scale density. deepmaskzoom∗ sharpmaskzoom inference images scaled obtain superior performance diverse range object segments. similar two-stream network input image up-sampled two. improve inference efﬁciency made trade-off scale density reducing network one-stream withre-training identical reduce scale density deepmaskzoom∗ sharpmaskzoom sparse scale density leads less total proposal number. controlled experiments tested using nvidia titan gpu. multiple runs average time obtain estimation runtime speed. method achieves preserve best performance increase inference speed almost note retraining network reduced scale density boost performance. speed evaluation. evaluate inference speed state-of-the-art methods. variant models effective model efﬁcient model reported. effective model takes two-stream structure -layer resnet; fastest model takes one-stream structure pvanet light-weight fast. figure compare best fastest model networks. best model produces superior proposal performance preserving good efﬁciency. slight trade-off performance fastest model obtains alreal-time efﬁciency paper present innovative framework i.e. fastmask efﬁcient segment-based object proposal. instead building pyramid input image fastmask learns encode feature pyramid neck module performs one-shot training inference. along process scale-tolerant head module proposed highlight foreground object background noises havesting signiﬁcant better segmentation accuracy. coco benchmark fastmask outperforms state-of-the-art segment proposal methods average recall keeping several times faster. impressively slight tradeaccuracy fastmast segment objects nearly real time images resolution. effective efﬁcient segment proposal method fastmask believed great potentials tasks.", "year": 2016}