{"title": "Convergent message passing algorithms - a unifying view", "tag": ["cs.AI", "cs.LG"], "abstract": "Message-passing algorithms have emerged as powerful techniques for approximate inference in graphical models. When these algorithms converge, they can be shown to find local (or sometimes even global) optima of variational formulations to the inference problem. But many of the most popular algorithms are not guaranteed to converge. This has lead to recent interest in convergent message-passing algorithms. In this paper, we present a unified view of convergent message-passing algorithms. We present a simple derivation of an abstract algorithm, tree-consistency bound optimization (TCBO) that is provably convergent in both its sum and max product forms. We then show that many of the existing convergent algorithms are instances of our TCBO algorithm, and obtain novel convergent algorithms \"for free\" by exchanging maximizations and summations in existing algorithms. In particular, we show that Wainwright's non-convergent sum-product algorithm for tree based variational bounds, is actually convergent with the right update order for the case where trees are monotonic chains.", "text": "message-passing algorithms emerged powerful techniques approximate inference graphical models. algorithms converge shown local optima variational formulations inference problem. many popular algorithms guaranteed converge. lead recent interest convergent message-passing algorithms. paper present uniﬁed view convergent message-passing algorithms. present simple derivation abstract algorithm tree-consistency bound optimization provably convergent product forms. show many existing convergent algorithms instances tcbo algorithm obtain novel convergent algorithms free exchanging maximizations summations existing algorithms. particular show wainwright’s non-convergent sum-product algorithm tree based variational bounds actually convergent right update order case trees monotonic chains. probabilistic inference graphical models component learning using models practice. inference problems calculating marginals model calculating likely assignment inference cast optimization problem. marginals case usually corresponds minimization free energy functional problem corresponds solving linear programming relaxation challenge marginals case devise simple scalable algorithms solving variational optimization problem. recent years numerous algorithms introduced tasks. algorithms typically message passing like structure. perhaps widely used message-passing algorithms belief propagation generalizations algorithms typically variants sum-product used approximate marginals max-product used approximate map. fixed-points algorithms shown local optima corresponding variational formulation. despite spectacular empirical success algorithms real-world applications guaranteed converge variants dampening often used improve convergence therefore much recent work convergent message passing algorithms algorithms often similar structure nonconvergent algorithms often include local maxproduct sum-product operations. however speciﬁc algorithms possible prove value variational problem improves iteration. perhaps intriguing example kolmogorov’s trw-s algorithm simply wainwright’s tree-reweighted max-product algorithm diﬀerent update schedule. bound optimum variational approximations give suﬃcient conditions algorithms need satisfy order decrease bound monotone fashion. algorithm satisﬁes conditions guaranteed decrease upper bound every iteration. property turn guarantees algorithms converge global optimum variational problem marginals case local optimum approximation case. framework involves updating subset regions form tree region graph. related approach recently suggested sontag context solving approximation. work gives explicit algorithm optimizing edges corresponding tree original graph upper bound optimum decreased every iteration. formalism give explicit update rather conditions guarantee update decrease objective. however show conditions satisﬁed several known algorithms. furthermore since condition similar marginals case easy obtain algorithms cases simultaneously results problem obtaining algorithms other. instance consider tree-reweighted free energy minimization problem recently works provided convergent algorithms problem involved standard message passing algorithms. show surprising result fact original algorithm provided wainwright convergent appropriate schedule message updates. maximization general intractable approximate free energies often used. class approximate free energies discussed based concept region graph whose nodes regions original graph whose edges represent subregion relationships approximation replaces joint entropy linear combination local region entropies local entropy weighted double-counting number distributions need consider distributions exists marginals. cannot expressed compact form typically approximated. popular approximation local polytope region graph deﬁned local distributions agree marginals regions region graph subsets other entropy approximation ˜hgc generally concave function local distributions thus maximization result local optima. avoid undesirable property several works focused entropies obtained considering concave ˜hgc functions. focus approximations double counting numbers non-negative. strong restriction since working region graph formulation many approximate free energies negative double counting numbers transformed ones positive double counting numbers region graph. perhaps important example tree-reweighted free energies entropy probability distribution trees graph entropy distribution marginals given consider region graph trees intersection double counting numbers non-negative. bility edge distribution case double-counting number singletons negative. however show sometimes advantageous work representation uses non-negative mixture trees since nonnegativity counting numbers allows simpler derivation algorithms. vast majority methods solving variational approximation based classes constraints local optima satisfy. easy show using lagrange multipliers local optima satisfy types constraints general simply iteratively enforcing constraints guaranteed give convergent algorithms. however show paper iterating constraints particular order obtain monotonically convergent algorithms. algorithms propose optimize variables keeping constraint satisﬁed times. moreover monotonically decrease upper bound optimum following lemmas provide bound cases. enforcing constraints iteratively obtains many popular sum-product algorithms. replacing sum-consistency constraint maxconsistency gives many popular max-product algorithms. simple example ordinary maintains admissiblity iteration message enforces consistency proof kolmogorov showed reparameterization also holds h˜θiq hθiq using property log-partition function constant reparameterization particular maximum value bound tight exists reparameterization marginals sumconsistent existence re-parameterization guaranteed maximum approximated negative free energy happen extreme point note lemmas also viewed outcome convex duality. words original variational maximization problem equivalent bound minimization problem convex duals other. propose tree consistency bound optimization algorithm general framework minimizing bounds sec. approximated log-partition within region graph positive counting numbers method propose described algorithm keeps beliefs admissible positive counting numbers reparameterize original energy corresponding thus satisfy conditions bound sec. furthermore iteration consistency beliefs enforced subtree mentioned earlier maintaining consistency subsets generally result convergent algorithms. however following lemmas show case enforcing consistency equivalent block coordinate lemma sum-consistency lemma consider bound minimization problem logpartition function positive counting numbers deﬁned subset regions intersections part bound inﬂuenced beliefs subset lemmas show tcbo algorithm monotonically decreases bound update. log-partition case bound strictly convex thus strategy ﬁnds global minimum bound global maximum case function strictly convex algorithm converge values global optimum. phenomenon shared dual descent algorithms identify existing convergent algorithms instances tcbo heskes’ algorithm approximating marginals mplp trw-s maxsum diﬀusion approximating map. figures show reparametrization region graph tree sub-graph updated iteration algorithms simple example grid shown fig. note algorithms reparameterization positive double counting numbers. furthermore update subtree variables provide global re-parameterization marginals exp/cα) maximize term separately also sum-consistent achieve optimal value thus perform block coordinate descent bound. lemma max-consistency lemma consider bound minimization problem positive counting numbers deﬁned subset regions intersections form tree part bound inﬂuenced beliefs tree figure illustration max-sum-diﬀusion algorithm instance tcbo formalism. operates region graph containing pairs singletons subgraph corresponding tcbo update shown blue dashed line. heskes’ algorithm shown instance tcbo using direct substitution. update rules shown algorithm mplp appear ﬁrst sight region graph illustrated fig. rather works edges singletons. however show appendix transform messages used max-product version heskes’s algorithm messages mplp using mplp region graph. max-consistency achieved shown directly. also possible tree graphs regions various existing methods indeed approach. consider tcbo algorithm iterates edges nodes edge node enforces consistency trees contain illustrated fig. naive implementation scheme costly requires multiple tree updates every edge. however kolmogorov showed exists eﬃcient implementation scheme case. implementation applied trees monotonic chains deﬁned follows given ordering nodes graph chains monotonic order nodes chain respects given ordering. structure allows reuse messages simultaneously implements operations multiple trees. scheduling messages important guaranteeing convergence case. turns needs scan nodes along pre-speciﬁed order ﬁrst forward backward. marginals case algorithm wainwright corresponds optimizing tree regions provably convergent. next section show derive convergent algorithm case using formalism. replacing algorithms discussed previous section obtain algorithms enforce diﬀerent type consistency keep reparameterization region graph shown ﬁgures. thus maxproduct version heskes’ algorithm sumproduct versions trw-s mplp convergent respect relevant bound. trw-s sum-product case especially interesting. case relevant bound becomes treereweighted log-partition function bound introduced message passing algorithm suggested generally converge. contrast trwsum-product algorithm guaranteed converge figure region graph chains pairwise singleton components. graphs used trw-s algorithms. example chains also monotonic chains since agree node ordering trw-s viewed tcbo algorithm subgraph shown blue dashed line additional algorithm easily shown convergent double counting numbers versions. iteration two-way updates beliefs region subregions trivially tree. fact maintains reparameterization enforces consistency shown directly. fact shown identical msd. present experiments illustrate convergence algorithms. algorithms applied instance spin glass pairwise terms drawn randomly ﬁeld case tested tcbo algorithms. estimating log-partition considered uniform distribution spanning forests graph horizontal vertical chains. chains monotone respect node ordering trw-s following nodes order ﬁrst forward backward updating time messages direction scan. fig. shows comparison schedule node ordering followed forward manner outgoing messages updated node. schedules keep re-parameterization provide bound log-partition trw-s monotonically decreases iteration. case max-product version heskes’ algorithm using region graph pairs singletons also mplp problem. fig. shows bounds obtained iteration. seen three algorithms monotonically converged value. despite empirical success max-product sumproduct algorithms applications original algorithms guaranteed converge. much research recent years therefore devoted devising convergent algorithms. typically recent algorithms either max-product sum-product proof convergence speciﬁc algorithm. presented uniﬁed framework convergent message passing algorithms showed importance enforcing consistency sum-product max-product algorithms. analogy allow give uniﬁed derivation existing algorithms also gives easy derive novel algorithms existing ones exchanging maximizations summations. although many convergent algorithms instances framework worth pointing convergent algorithms not. ﬁrst hazan shashua’s recent algorithm works provably convex double counting numbers second ordinary single cycle shown convergent product forms. emphasize even negative counting numbers handled cases using larger regions. algorithms discussed fact updated star graphs region graph. conditions monotonicity apply general tree updates. however seems less straightforward obtain general tree updates achieve consistency reparameterization simultaneously. interestingly tree based updates monotonically decrease upper bound seem satisfy maxconsistency. thus remains interesting challenge general tree updates satisfy consistency constraints could easily used interchangeably marginals. perhaps intriguing result analysis importance update schedule obtaining convergence non-convergent algorithm becomes convergent right update schedule used. interesting whether convergent update schedules derived even larger class message-passing algorithms.", "year": 2012}