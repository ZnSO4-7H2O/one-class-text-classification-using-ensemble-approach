{"title": "Diabetic Retinopathy Detection via Deep Convolutional Networks for  Discriminative Localization and Visual Explanation", "tag": ["cs.CV", "cs.LG", "cs.NE"], "abstract": "We proposed a deep learning method for interpretable diabetic retinopathy (DR) detection. The visual-interpretable feature of the proposed method is achieved by adding the regression activation map (RAM) after the global averaging pooling layer of the convolutional networks (CNN). With RAM, the proposed model can localize the discriminative regions of an retina image to show the specific region of interest in terms of its severity level. We believe this advantage of the proposed deep learning model is highly desired for DR detection because in practice, users are not only interested with high prediction performance, but also keen to understand the insights of DR detection and why the adopted learning model works. In the experiments conducted on a large scale of retina image dataset, we show that the proposed CNN model can achieve high performance on DR detection compared with the state-of-the-art while achieving the merits of providing the RAM to highlight the salient regions of the input image.", "text": "interpretable diabetic retinopathy detection. visualinterpretable feature proposed method achieved adding regression activation global averaging pooling layer convolutional networks proposed model localize discriminative regions retina image show speciﬁc region interest terms severity level. believe advantage proposed deep learning model highly desired detection practice users interested high prediction performance also keen understand insights detection adopted learning model works. experiments conducted large scale retina image dataset show proposed model achieve high performance detection compared state-ofthe-art achieving merits providing highlight salient regions input image. diabetes widespread disease world around million people worldwide disease. diabetic retinopathy disease caused long-standing diabetes. basically affects blood vessels light-sensitive tissue becomes leading cause vision impairment blindness working-age adults world today around half americans diabetes disease extent. widely-known challenge early warning sign even diabetic macular edema. thus highly desired detected time. unfortunately practice current detection solution nearly infeasible meet requirement. speciﬁcally current solution requires well-trained clinician manually evaluate digital color fundus photographs retina identiﬁed locating lesions associated vascular abnormalities diabetes. though current solution effective time-consuming highly relies expertise well-training practitioners. solve issue past years considerable efforts developing automated solution detection. previous automated solutions consists parts feature extraction detection/prediction algorithm feature extraction main focus standard machine learning algorithms directly used detection/prediction algorithm. type approaches effective extent also suffer several shortcomings. first reviewed section extracted features hand-crafted features. thus features highly depend parameters used feature extraction tools sensitive quality fundus photography like object view exposedness artifacts noise out-of-focus etc. second feature extraction solo task rather embedded whole detection framework. above-mentioned features extraction methods considered universal image feature extraction methods applicable computer vision tasks dedicated speciﬁc task e.g. detection task considered paper. worth noting color fundus photography challenging standard scene object images image feature extraction methods developed based since signals often tiny fundus photography often look indiscriminating noise artifacts. thus challenges make highly desirable develop systematical feature representation approach effectively characterize nature features particularly related detection task. recently convolutional neural networks achieved tremendous success computer vision area. model high-level abstractions data relative speciﬁc prediction task multiple layers network built automating feature design. speciﬁcally layer deep architecture performs non-linear transformation outputs previous layer data represented hierarchy features lowlevel high-level. attribute conducting different processing units alternatively. variety processing units yield effective nonlinear representation local salience signals. then deep architecture allows multiple layers processing units stacked deep learning model characterize salience signals different scales. also feature extraction prediction algorithm uniﬁed single model. thus extracted features discriminative power since entire model trained supervision output labels. brieﬂy speaking features extracted task dependent non-handcrafted. paper also adopt predictive algorithm develop efﬁcient architecture particularly useful large-scale dataset. speciﬁcally built fully connected layer convolutional pooling layers. setting signiﬁcantly reduces number parameters provides better conditions interpretability neural network presented below. show experiments less parameters fully-connected layers proposed architecture achieve comparative prediction performance. advantage proposed network structure provide regression activation maps input image show contribution score pixel input image detection task. output extent somehow mitigates well-known uninterpretable shortcoming black method. believe output make proposed solution self-explained motivate practitioners trace cause disease every patient. two-step automated detection approaches dominated ﬁeld detection many years. given color fundus photography type approaches often extracted visual features images parts blood vessels fovea optic disc generic feature extraction methods developed computer vision area widely used here hough transform gabor ﬁlters intensity variations. extracted features object detection object registration algorithm like support vector machines k-nn used identify localize exudates hemorrhages mentioned before type approaches effective recent deep learning approaches deep learning approaches adopted standard architecture like alexnet googlenet build based experimental results deep learning approaches signiﬁcantly outperform traditional two-step approaches. moreover recent detection competition held kaggle witnessed solutions adopted algorithm. however approaches require complex neural network structures hard practitioners understand insight clearly explain region color fundus photography main cause disease. understanding insights always pain point though yields excellent predictive performance. well-known deriving theoretical results quite challenging nonliner non-convex nature cnn. mitigate issue considerable efforts visualizing cnn. deconvolutional networks approach proposed visualize activated pattern hidden unit method limited hard summarize hidden units’s patterns pattern also hidden neurons hidden layers analyzed though networks considered also contain fully-connected layers. work reference therein include objection location task besides conventional object classiﬁcation problem predict label image also identify region object related class label. though type cnns predict location object interest still cannot reveal insight cnn. recently presented methods invert representation images layer cnn. however approaches indicate information preserved layer cnn. work related method class activation proposed characterize weighted activation maps global average pooling global maximum pooling layer. idea recently generalized time series analysis localize signiﬁcant regions data paper extend method classiﬁcation regression setting shed light detection problem. inspired present section idea generating input image localize discriminative region towards regression outcomes. known convolutional units layers visual concept detectors identify low-level concepts like textures materials high-level concepts thus essentially weighted feature maps last convolutional layer. weights herein connections outputs global averaging pooling layer neuron output layer. therefore ﬁnal prediction also expressed intuitively contains immediate information prediction also maintain correspondence last convolutional feature input images. therefore localize discriminative region towards regression outcomes. illustration adopted neural network structure show figure like objects scenes. deeper network units become increasingly discriminative. however fullyconnected layers make difﬁcult identify importance different units identifying output labels instead using linear output unit directly visualize region interest discriminative given regression value. regression purpose classiﬁcation single obtained single image explicitly depict different clinical level. network architectures convolutional nets shown table since consider regression problem output layer neuron outputting real value. difference neural network conventional neural networks like alexnet googlenet network uses global averaging pooling layer connect last convolutional layer output layer instead using fully-connected layers. idea layer neuron obtains spatial average feature maps last convolutional layer value neuron reﬂects contribution ﬁnal prediction. speciﬁcally supposing last convolutional layer contains feature maps {gk|∀i spatial coordinate locating entry feature layer feature last convolutional layer mapped scaler function then weighted output color retina images downloaded kaggle website. training dataset contains high resolution images variety imaging conditions. retina images obtained group subjects subject images obtained left right eyes respectively. labels provided clinicians rated presence diabetic retinopathy image scale represent mild moderate severe proliferative respectively. mentioned description dataset images dataset come different models types camera affect visual appearance left right. samples images shown also dataset doesn’t equal distributions among scales. expect normal data label biggest class whole dataset proliferative data smallest class. shows counts images different scales training dataset. consider publicly-available method benchmark method ranked second place kaggle competition. method crops away background resize images squares pixels. interested readers refer detailed settings baseline method. summarize main features baseline methods follow trained convolutional neural network table single tesla-p gpu. nonlinearity leaky rectiﬁer units following convolutional layer. networks trained nesterov momentum ﬁxed schedule epochs. nets pixel images stop training epochs. weight decay factor applied layers. treat problem regression problem loss function mean squared error.the convolutional networks untied biases. batch size ﬁxed networks. following evaluation setting quadratic weighted kappa score adopted performance metric prediction. speciﬁcally predicted regression values discretized thresholds obtain integer levels computing kappa scores making submissions. features mentioned section also adopted model training. following split images training validation datasets ratio local evaluation purpose also submit prediction results test dataset kaggle obtain kappa score. table summarizes performance benchmark approach test dataset. simply replacing fullyconnected layer global average pooling layer networks achieved competitive kappa score compared benchmark reducing parameter size speed-up training .%-.%. mentioned section feature blending strategy used. thus ﬁnal kappa score average patient blends convolutional network architectures three different sets trained weights. considering signals retina images like micro-aneurysms small respect retina also evaluate performance model respect different size input images. validation networks achieve kappa scores around initialization pretraining orthogonal initialization used initialize weights biases. train smaller networks pixel images. then trained weights initialize medium networks training pixel images. finally trained weights medium networks initialize large network training pixel images. feature blending last pooling layer convolutional networks extracted features blend extracted features networks outputs then fully-connected neural network used blended features ﬁnal predictor. figure example generated pixel image pixel image. note output neural network size up-sampled lanczos interpolation functions shown plots ensembled averaged resolutions shown original image. pixel images pixel images pixel images net- net- settings without feature blending. observation suggests larger input images better prediction performance much gain image size greater taking computation cost consideration limit input image size greater generate used net- pixel images input. also removed several convolutional layers net- input size increase resolution since localization ability signiﬁcantly improved last convolutional layer higher spatial resolution speciﬁcally made following modiﬁcations net- pixel images removed layers conv- strides excepts maxpool- resulting mapping resolution net- pixel images removed layers conv- last pooling layer resulted mapping resolution networks ﬁne-tuned training data. figure show rams input images size pixels respectively corresponding kappa scores noticed rams reﬂect different rois contributions ﬁnal kappa score prediction. thus consider fusion multiple rams generated different scales input images. fusion rams i.e. average values matrices plotted figure referring original image shown figure argue figure better capture original image. also found similar phonomania examples. conclude fusion different rams various resolutions simple effective depict comprehensive fused reported following analysis. mild-conditioned patients learned discover narrowing retinal arteries associated reduced retinal blood vessel shows dark red. dysfunction neurons inner retina followed later stages changes function outer retina captured figure dysfunction protects retina many substances blood leading leaking blood constituents retinal neuropile. patients belong next stage basement membrane retinal blood vessels thickens capillaries degenerate lose cells leading loss blood progressive ischemia microscopic aneurysms appear balloon-like structures jutting capillary walls. shown figure learned converge focus border balloon-like structures occurs. disease progresses proliferative stage lack oxygen retina causes fragile blood vessels grow along retina clear gel-like vitreous humour ﬁlls inside eye. figure shows model attention grey dots scattering around undoubtedly also observed proposed model conservative diagnostics behavior means predicted regression value often smaller ground truth. examples case plotted figure plausible reason training dataset considerably large number normal images shown figure learned model might biased class. reasons could image quality sensitivity ambiguous features different levels. speciﬁcally figure though model ignores proliferate left corner capture leaking blood region retinal neuropile. identify leaking blood retinal neuropile even challenging clinicians. original images contain limited information balloon-like jitter blood leaking partial exposedness scattered dard vessels caused reduced retinal blood ﬂow. based analysis provides reasonable transparency deep learning model makes decision. visual explanation assist clinicians quickly identify pathogenesis disease. practically clinicians identify presence lesions associated vascular abnormalities caused disease. approach effective resource demands high. work provided deep learning model includes regression activation maps layer layer provide robust interpretability proposed detection model monitoring pathogenesis proposed model taken assistant clinicians. feature proposed model still yield competitive performance detection compared state-of-the-art methods. future would consider extend proposed method medical application problems.", "year": 2017}