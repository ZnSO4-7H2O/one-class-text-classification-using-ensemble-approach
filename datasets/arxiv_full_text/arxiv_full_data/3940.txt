{"title": "Searching for Globally Optimal Functional Forms for Inter-Atomic  Potentials Using Parallel Tempering and Genetic Programming", "tag": ["cs.NE", "cs.AI"], "abstract": "We develop a Genetic Programming-based methodology that enables discovery of novel functional forms for classical inter-atomic force-fields, used in molecular dynamics simulations. Unlike previous efforts in the field, that fit only the parameters to the fixed functional forms, we instead use a novel algorithm to search the space of many possible functional forms. While a follow-on practical procedure will use experimental and {\\it ab inito} data to find an optimal functional form for a forcefield, we first validate the approach using a manufactured solution. This validation has the advantage of a well-defined metric of success. We manufactured a training set of atomic coordinate data with an associated set of global energies using the well-known Lennard-Jones inter-atomic potential. We performed an automatic functional form fitting procedure starting with a population of random functions, using a genetic programming functional formulation, and a parallel tempering Metropolis-based optimization algorithm. Our massively-parallel method independently discovered the Lennard-Jones function after searching for several hours on 100 processors and covering a miniscule portion of the configuration space. We find that the method is suitable for unsupervised discovery of functional forms for inter-atomic potentials/force-fields. We also find that our parallel tempering Metropolis-based approach significantly improves the optimization convergence time, and takes good advantage of the parallel cluster architecture.", "text": "develop genetic programming-based methodology enables discovery novel functional forms classical inter-atomic ﬁelds used molecular dynamics simulations. unlike previous eﬀorts ﬁeld parameters ﬁxed functional forms instead novel algorithm search space many possible functional forms. follow-on practical procedure experimental inito data optimal functional form force-ﬁeld ﬁrst validate approach using manufactured solution. validation advantage well-deﬁned metric success. manufactured training atomic coordinate data associated global energies using well-known lennard-jones inter-atomic potential. performed automatic functional form ﬁtting procedure starting population random functions using genetic programming functional formulation parallel tempering metropolis-based optimization algorithm. massively-parallel method independently discovered lennard-jones function after searching several hours processors covering miniscule portion conﬁguration space. method suitable unsupervised discovery functional forms inter-atomic potentials/force-ﬁelds. also parallel tempering metropolis-based approach signiﬁcantly improves optimization convergence time takes good advantage parallel cluster architecture. classical molecular dynamics molecular mechanics simulations become important computational tools nano-scale design novel materials brought insight structure function bio-molecules. simulations require accurate computationally eﬃcient forms inter-atomic potential/force function. force-ﬁelds serve role typically physics-intuitionbased functions inter-atomic distances bonding structure. classical force-ﬁeld functions represent extensive work invention validation using physical insight combined experimental sources information. computationally construction force-ﬁeld viewed ﬁtting process successful functional forms force-ﬁeld best available data. given clear metric ﬁtness ﬁtting classical force-ﬁeld well-deﬁned optimization procedure. requires deﬁnition mutable representation function parameters quantiﬁable ﬁtness criterion ergodic evolution operators. functional forms functions generated physical intuition parameters optimized. process done manually represents many man-years highly qualiﬁed labor often meets failure. important laborious task clearly calls automation. case parameter-only ﬁtting useful representation problem ordered real numbers number acting parameter ﬁxed functional form. evolution operators case generalized linear transformations treat ordered numbers vector real space search vector’s optimal size direction. number research eﬀorts attacked partial problem automatically ﬁtting numerical parameters ﬁxed functional forms successfully obtaining better objective function based training set. become increasingly interested complex multi-species systems look critically quantitative prediction material properties stringent requirements lead need complicated functional forms. optimization functional form requires substantial change methodology. complicated functions embedded large combinatorial space. researchers diﬃcult impossible develop intuition relationships various functions ever-expanding training set. automatic functional form ﬁtting method clearly called for. genetic programming formalism starting point ﬁtting algorithm. genetic programming uses library elementary operators build population hierarchical computer programs represented operator trees. description functional form provides maximum generality functional expression. choose minimal algebraic operators ||}. algebraic operators used resulting tree becomes algebraic expression variable constant number input leaves. population trees evolved using genetic algorithm improve ﬁtness tree population according user-deﬁned ﬁtness criterion. small mutation operators provides evolve trees functional space. describe model detail section ﬁtting problem training underlies ﬁtness function requires careful deﬁnition robust design much labor. objective function typically based sets atomic positions associated observables obtained either experimentally initio simulations. validation purposes construct manufactured training using existing classical force-ﬁeld. manufactured solution provides advantage clearly deﬁned objective terms known answer. leave somewhat philosophical discussion diﬀerence manufactured real system section choose lennardjones pair potential basis training set. training boxes randomly populated atoms. potential energy calculated summing lennard-jones pair potential function pairs atoms within speciﬁed cut-oﬀ distance. list pairwise distances together associated energies serve basis ﬁtness function turn used evaluate ﬁtness trees algorithm. details training ﬁtness function construction found section overall algorithm described section lennard-jones functional form target function minimally appears four-level tree representation wrong. space possible trees size large energy landscape rough discontinuous littered local minima. developed powerful optimization method hybrid parallel tempering metropolis enable eﬃcient search massively parallel cluster architecture. method evolves populations trees according scheme combines mutation metropolis monte carlo algorithm. population assigned diﬀerent eﬀective temperature trees periodically exchanged populations. details algorithm found section searching several hours processors algorithm reproducibly discovered lennard-jones functional form traversing small fraction total search space. believe demonstrates eﬀectiveness algorithm method unsupervised development force-ﬁeld functional forms. believe ﬁrst demonstration unsupervised force-ﬁeld functional form ﬁtting. details refer reader section general terms method iteratively reﬁnes overall population candidate trees convergence criterion deﬁned ﬁtness best individual tree population overall population randomly generated start iteratively reﬁned using parallel tempering genetic program method section move next generation according ﬁtness described section ﬁttest individuals monitored detect convergence. convergence obtained best individual tree output. functional programming programming style approaches computation hierarchical evaluation functions. concept ﬁrst-order function meaning function operates functions deﬁned context though widely used without formal deﬁnition. example derivative function takes function another function. formal setting genetic programming case ﬁrst-order function typically operates pure functions construct reﬁne composite computer programs. genetic programming methodology originally developed koza enable automatic generation computer programs. high-level strategy builds population random programs computationally represented nested trees pure functions depicted figure iteratively reﬁnes population using ﬁtness function operates single tree. reﬁnement relies existence mutation ﬁrst-order operators change structure tree. operators work tree either locally drastically though terminology mutation operators borrowed genetic programming operators reasonably well-deﬁned description much fuzzier case function tree. since attempting build algebraic expression force-ﬁeld pure tree elements unary binary algebraic functions. composite tree traversed data-passing sense leaves root simply evaluates algebraic expression. however general well code pure operators constrained. library operators consist logical calculus transform composite operators encapsulated functional form. sampling metropolis monte carlo iterative process attempts improve population trees evolving better population reﬁnement step. evolution happens three stages generation mutation testing. ﬁrst stage produces trees trees. second stage randomly mutates trees. testing stage compare ﬁtness trees trees pick based metropolis acceptance probability. generation stage tree created either pass-through crossover equal probablility. pass-through involves selecting ﬁttest tree already passed though population copying population. cross-over involves creating tree combining parent trees selcted population. tournament selection used choose parent trees population four trees selected equal probability population tree highest ﬁtness selected. perform actual crossover operation depth level ﬁrst parent selected restriction node root maximum depth depth level selected second parent restrictions. randomly chosen subtree rooted selected depth level chopped ﬁrst parent replaced randomly chosen subtree rooted selected depth level second parent producing child tree containing parts parents. additional restriction child tree must satisfy minimum maximum allowable tree depths. mutation stage tree either mutated left alone equal probability without regard ﬁtness tree created. tree mutated node selected include root leaf. node selected equal probability nodes meaning higher probability select node near leaves select node near root; done give preference small adjustments parameters rather drastic changes entire functional form. subtree rooted node chopped random subtree made scratch restricted keeping entire tree within legal depth limits. thus average trees made crossover crossover mutation mutation alone retained previous generation. testing stage trees trees compared head-to-head. metropolis compares tree tree position list. simple variant tournament selection. tree accepted population better occasionally otherwise according boltzmann probability parallel tempering originally introduced swendsen wang deal local traps spin glass energy surface. technique uses replicas system diﬀerent temperature exchanges partial state information replicas. fundamental idea high-temperature replicas sample system phase space coarse level low-temperature replicas reﬁning states local traps. hybrid local global sampling achieved. later changes method replace partial information exchange complete state swap. many parameters method come scrutiny since. review recent developments method single replica population candidate trees. replicas exchange information nearest neighbors temperature space swapping random trees probability based tree’s relative boltzmann weights ﬁtness tree selected replica temperature initialize initial temperature distribution replicas either linear logarithmic upper lower bounds. also allow dynamic temperature adjustment using acceptance/rejection ratios guide perturbing individual temperatures. training series nbox -dimensional domains randomly populated atom positions. associated energy depends positions atoms box. current work energy given pair potential functions evaluated pairs atoms lying within given cut-oﬀ distance. periodic boundary conditions used pairs atoms closer minimum interaction distance ignored. pair potential chosen well-known lennard-jones potential function energy length parameters. procedure produces nbox energies box. atomic coordinates periodic boundary conditions corresponding surrogate target energies become training set. purpose study test whether approach capable discovering accurate potential energy functions replicate true potential energy surface. typically information true potential energy surface obtained using quantum mechanics calculations evaluate energy small conﬁgurations atoms. hence chose test case boxes containing randomly positioned particles. order construct problem known global optimum energies boxes calculated using lennard-jones pair potential described above. dimensions particles placed randomly particles allowed come closer pairs distances range recorded used compute target energy taking periodic images account. values σandǫ unity. resulted pair distances box. varying random number seed generated four independent test cases. test case executed diﬀerent parallel tempering optimizations either individual trees population. cases used populations temperatures distributed logarithmically trees required minimum depths maximum depths calculations cluster opteron processors quadrics interconnects. runs individuals population generation required seconds. indiviuals time generation times longer. time spent evaluation energies. results runs stochastic initial conditions optimization method distribution behaviors. however runs successfully found algebraic equivalent original target function. algebraic equivalence means functional form transformed exact lennard-jones form sequence algebraic transformations. three algebraic equivalents displayed figure fig. shows average square error overall ﬁttest tree generation. total runs shown. dashed lines indicate four independent runs individuals population using diﬀerent initial populations diﬀerent test boxes. solid lines indicate four independent runs individuals population using diﬀerent initial populations test boxes used ﬁrst four runs. four independent runs three successfully found algebraic equivalents lennard-jones function. residual average square error approximately attributed machine error. fourth failed algebraic equivalent even generations. however several functions good approximations lennard-jones function quite diﬀerent functional forms e.g. tree shown figs. case larger populations four runs found algebraic equivalents substantially fewer generations. clearly greater diversity larger populations improves search eﬃciency. fig. shows clearly runs progressed. initially ﬁtness improves quite steadily good approximation exact lennard-jones function found. point improvement occurs sporadically. eventually algebraic equivalent appears. problem ﬁnding correct tree space possible trees given size made diﬃcult sheer size search space. algorithm starting initial total populations trees cases found global optimum less generations. provides upper bound number trees surveyed compare ﬁgure number possible trees depth figure lennard-jones equivalent trees near miss. trees shown algebraically equivalent lennard-jones form. tree shown produces function replicates lennard-jones numerically range interest error less example function represented literally given reduce tree good approximation function. figure convergence average square error overall ﬁttest tree generation eight runs cases successfully found algebraic equivalents lennard-jones function runs detail. hence upper bound ratio total space searched space roughly clearly non-trivial problem. reason surprising appear ﬁrst group attempt unsupervised automated approach ﬁnding functional forms force-ﬁelds. previous eﬀorts unsupervised force-ﬁeld ﬁtting restricted parameter optimization given ﬁxed functional form. succeeded able relatively large computational resources used robust optimization method. important emphasize surrogate test problem used study known solution nonetheless representative many potential energy surfaces accurate functional forms unknown. deliberately chose training closely resembled data generated quantum density functional theory calculations potential energy. given success method current study intend apply method many atomic systems existing force-ﬁelds found lacking.", "year": 2006}