{"title": "Training Deep Learning based Denoisers without Ground Truth Data", "tag": ["cs.CV", "stat.ML"], "abstract": "Recent deep learning based denoisers are trained to minimize the mean squared error (MSE) between the output of a network and the ground truth noiseless image in the training data. Thus, it is crucial to have high quality noiseless training data for high performance denoisers. Unfortunately, in some application areas such as medical imaging, it is expensive or even infeasible to acquire such a clean ground truth image. We propose a Stein's Unbiased Risk Estimator (SURE) based method for training deep learning based denoisers without ground truth data. We demonstrated that our SURE based method only with noisy input data was able to train CNN based denoising networks that yielded performance close to that of the original MSE based deep learning denoisers with ground truth data.", "text": "recent deep learning based denoisers trained minimize mean squared error between output network ground truth noiseless image training data. thus crucial high quality noiseless training data high performance denoisers. unfortunately application areas medical imaging expensive even infeasible acquire clean ground truth image. propose stein’s unbiased risk estimator based method training deep learning based denoisers without ground truth data. demonstrated sure based method noisy input data able train based denoising networks yielded performance close original based deep learning denoisers ground truth data. deep learning successful various high-level computer vision tasks image classiﬁcation object detection semantic segmentation deep learning also investigated low-level computer vision tasks image denoising image inpainting image restoration particular image denoising fundamental computer vision task yield clean image reduced noise also improves tasks image classiﬁcation image restoration department electrical engineering ulsan national institute science technology ulsan republic korea. correspondence young chun <sychununist.ac.kr>. better conventional state-of-the-art denoising techniques deep learning based denoisers train networks minimizing mean squared error output network target noiseless image. thus crucial high quality noiseless images high performance deep learning denoisers. high quality camera sensors abundant light allows obtain high quality almost noiseless images daily environment. acquiring high quality photo quite cheap smart phones digital cameras. however application areas medical imaging acquiring almost noiseless ground truth data training expensive sometimes even infeasible. x-ray poisson noise added measurement domain. noise reduced increasing radiation dose high dose lead harmful effect scanned subjects high dose saturate detectors recent works deep learning based image denoisers utilized normal dose images ground truth denoising networks trained yield images normal dose level noise instead noiseless image. similarly works predict standard dose image dose image well additional anatomical side information increasing radiation dose usually leads higher risk patients increased detector dead time thus infeasible obtain noiseless images general. medical imaging modalities ultrasound challenging expensive obtain noiseless images particularly high resolution settings. conventional denoising methods usually require noiseless ground truth images perform denoising often require tuning parameters image ﬁlters best possible results since noiseless ground truth images noisy input image several works using stein’s unbiased risk estimator optimal parameters. instance ramani proposed monte-carlo practice easily estimated requires output estimator last divergence term obtained analytically special cases linear ﬁlters ﬁlters however challenging calculate term general denoising methods analytically. section develop proposed monte-carlo sure based training method deep learning denoisers without noiseless ground truth images assuming gaussian signal noise model based sure method determine near optimal denoising parameters works sure based methods optimize parameters popular ﬁlter since sure unbiased estimator require ground truth data methods used optimize ﬁlter parameters noisy input data. initial step toward training deep learning based denoisers without ground truth data medical imaging investigated sure based training methods deep learning based denoisers. section review major results sure monte-carlo sure. then section describe proposed training method using monte-carlo sure deep learning based image denoisers. section denoising results presented deep learning based denoiser deep learning denoiser proposed monte-carlo sure training. lastly section conclude paper discussing several issues proposed method used medical imaging. small ﬁxed positive number single realization standard normal distribution training data order make sure estimator unbiased order randomly permuted generated every epoch. implementation deep learning based image denoiser cost function done using deep learning development framework tensorflow deﬁning cost function properly. then gradient automatically calculated training performed. potential advantage sure based training method available data without noiseless ground truth images. words train denoising deep neural networks training data also test data together. advantage improve performance deep learning based denoisers. lastly almost deep learning based image denoiser utilize monte-carlo sure based training modifying cost function satisﬁes condition theorem many deep learning based denoisers differentiable activation functions meet condition. denoisers piecewise differentiable activation functions still make theorem weak sense since deep learning based denoiser parametrized vector usually infeasible calculate exactly expectation operator. thus empirical risk used cost function follows train deep learning network respect gradient based optimization algorithm used stochastic gradient descent momentum nesterov momentum adam optimizer gradient based optimization method essential calculate gradient respect follows practice calculating gradiant large inefﬁcient since small amount well-shufﬂed training data approximate gradient well. thus mini-batch used efﬁcient training calculating mini-batch empirical risk follows section denoising simulation results mnist dataset using simple stacked denoising autoencoder cifar- dataset using convolution-deconvolution deep network natural image dataset using deep image denoiser presented. networks presented section trained using following optimization objectives minimum noisy input image ground truth image minimum monte-carlo sure note ground truth images used latter case. training dataset following conﬁguration used performed denoising simulations mnist dataset. noisy images generated based model noise levels .%). experiments mnist dataset pixels simple chosen decoder encoder networks consists convolutional layers sigmoid activation functions stride thus training sample size downsampled upsampled back trained output denoised image using training validation images. performance model tested images chosen randomly default test images. cases trained adam optimizer batch size learning rate epochs. value figure illustrates performance different denoising methods. subﬁgure left noisy image contaminated noise level subﬁgure right denoising result looks slightly blurrier results. deep learning based denoising networks outperformed cases. however hard observe visually distinct results table results deep learning based denoisers different training conﬁgurations mnist sure based denoisers yielded comparable better based denoisers well bmd. table shows quantitative results figure methods yielded better psnr conventional proposed sda-sure-sm yielded almost performance sda-mse-lg since sure based methods utilize data without ground truth also performed sure based training data well testing data. sda-sure-sm-t yielded better sda-mse-lg sdasure-sm respectively. therefore seems using test data training sure based denoiser helpful improve denoising performance. high noise level deep learning based approaches seem advantage denoising performance signiﬁcantly shown figure based methods clearly outperform conventional visually indistinguishable simulation results methods different cost function various training set. observations conﬁrmed quantitative results shown table based methods outperformed signiﬁcantly small differences among methods even using noisy test data. take wide range values choice critical admissible range however depends according preliminary experiments mnist dataset choice worked well sure approximation noisy data matches close cost function ground truth data training illustrated figure extremely small values result numerical instabilities illustrated figure contrary approximation becomes inaccurate. note values trained mnist dataset. suitable value must carefully selected cases. also trained minimize output input noisy image explore regularization effects case noise level early stopping applied network started overﬁt noisy dataset ﬁrst epochs. performance method signiﬁcantly worse methods psnr lower psnr conventional bmd. noise patterns visible shown figures shows good performance arise structure comes optimizing sure. work u-net chosen denoise corrupted images cifar- dataset noise levels u-net modiﬁed inputs images dimension contractive path reaching size expansive path back original size. u-net structure consists skip connections batch normalization layers padded convolutional layers followed relu nonlinearities. network also incorporates maxpooling downsampling transposed convolution size stride upsampling. table denoising results deep learning based denoisers different training methods data cifar based unet denoisers yielded comparable better sure based unet denoisers well conventional stateof-the-art denoiser training sure based method improve performance unlike mnist simulation unet-sure-sm-t able outperform unet-mse-lg. high noise using training test data sure yielded almost performance using training data only. observation consistent mnist simulation. show capabilities sure based deep learning denoisers investigated deeper powerful denoising network called dncnn high resolution images. dncnn consists -layers batch normalization relu activation functions. convolutional layer ﬁlters size following network trained images size total image patches size extracted randomly images. testing widely used images chosen dncnn-sure-sm-t additional image patches extracted noisy test images added training dataset. cases network trained epochs noise level adam optimizer used initial learning rate decayed epochs. dncnn uses residual learning network forced learn difference noisy ground truth images. then output residual image subtracted input noisy image yield estimated image. therefore case residual learning network trained sure using follows cnnθ figure shows denoising results noise level sd=.%. unet-mse-lg method yields relatively cleaner images denoising results look slightly blurry. unet-sure methods seem similar results unet-mse. figure results higher noise level shown. clearly seen that unetmse unet-sure signiﬁcantly better denoising results bmd. table displays quantitative results figures noise levels sd=.% deep learning based denoising methods yielded better psnr respectively. unetmse-lg outperformed methods expected unet-sure-sm-t also yielded comparable performance unet-mse-lg. using test data nvidia titan training process took approximately hours dncnn-mse-lg hours dncnn-sure-sm. sure based method take training time based method additional divergence term calculations done optimize monte-carlo sure cost function. dncnn-sure-smmethod took around hours complete training dncnn selection value turned important denoising performance. stable training good performance possible selecting however network trained took much epochs converge yielded lower ﬁnal psnr. hand training process become unstable network usually diverged epochs. using performance denoising table state-of-the-art deep image denoiser trained dncnn image denoiser trained sure without knowing noiseless ground truth images different dataset variations based dncnn image denoiser dncnn-mse-lg yielded best denoising performance methods consistent results dncnn-sure-sm yielded better performance images among worse performance images. average dncnnsure-sm able achieve comparable performance bmd. better performance sure based method achieved training dataset augmented noisy test images. result dncnn-sure-sm-t able outperform conventional dncnn-sure-sm. figure illustrates example images dncnn sure outperformed bmd. advantage high denoising performance images contain repeated structures simple large areas. examples figure seem quite complicated non-repeated structures dncnn sure yielded better denoising results bmd. consistently yielded slightly blurrier images table results deep image denoiser deep image denoiser monte-carlo sure sure based image denoiser yielded comparable results based image denoiser bmd. figure results various denoising methods. ‘monarch’ image middle ‘airplane’ image bottom ‘starﬁsh’ image. image image patches left corner original noisy dncnn-mse-lg dncnn-sure-sm dncnn-sure-sm-t images dncnn-sure-sm outperformed bmd. deep learning based denoisers possibly rare patch effect contrast figure illustrates example images outperformed dncnn sure. images contain repeated pattern structures simple areas since looks similar image patches denoising repeated patterns factor proposed monte-carlo sure based training method general deep learning denoisers. proposed method train denoisers without noiseless ground truth data comparable denoising performance conventional state-of-the-art denoisers trained noiseless data. sure based training method work simple also works u-net state-of-the-art dncnn denoising network without noiseless ground truth images. work gaussian noise known variance assumed simulations. however several noise estimation methods used sure details). sure based methods incorporate variety noise distributions gaussian noise. example sure poisson noise used parameter selection conventional ﬁlter generalized sure exponential families proposed common noise imaging systems potentially considered sure based methods. note sure require prior knowledge images applied measurement domain. example measurement domain medical imaging follows poisson distribution measurement domain contains complex gaussian noise medical imaging known exact noise distribution. noise property medical imaging image domain complex works analyze approximately follows weighted gaussian distribution since sure expression unbiased risk estimator pixel trivial apply sure locally spatially varying variance. however correlation noise image domain challenging apply sure image domain directly. proposed sure based deep learning denoiser potentially useful applications massive amount noisy images noiseless images expensive noiseless images. deep learning based denoising research still evolving even possible achieve signiﬁcantly better performance conventional state-of-the-art denoisers sure based training method. investigation needed high performance denoising networks. figure results various denoising methods. ‘barbara’ image middle ‘house’ image bottom ‘lena’ image. image image patches left corner original noisy dncnn-mse-lg dncnn-sure-sm dncnn-sure-sm-t images dncnn-sure-sm outperformed bmd. yield strong denoising results. note ‘barbara’ image repeated textures even outperformed dncnn mse. preliminary results suggest possible train state-of-the-art deep learning based denoisers using sure based optimization criteria without noiseless ground truth images good denoising performance achieved better bmd. korea funded ministry education technology innovation program industrial strategic technology development program funded ministry trade industry energy references abadi mart´ın barham paul chen jianmin chen zhifeng davis andy dean jeffrey devin matthieu ghemawat sanjay irving geoffrey isard michael kudlur manjunath levenberg josh monga rajat moore sherry murray derek steiner benoit tucker paul vasudevan vijay warden pete wicke martin yuan zheng xiaoqiang. tensorﬂow system large-scale machine learning. proceedings usenix conference operating systems design implementation burger harold schuler christian harmeling stefan. image denoising plain neural networks compete bmd? ieee conference computer vision pattern recognition chen zhang kalra mannudeep feng chen yang liao peixi zhou jiliu wang low-dose residual encoder-decoder convolutional neural network. ieee transactions medical imaging november chen liang-chieh papandreou george kokkinos iasonas murphy kevin yuille alan semantic image segmentation deep convolutional nets international conference fully connected crfs. learning representation girshick donahue darrell rich feature hierarchies accurate object detection semantic segmentation. ieee conference computer vision pattern recognition kang eunhee junhong jong chul. deep convolutional neural network using directional wavelets low-dose x-ray reconstruction. medical physics october long jonathan shelhamer evan darrell trevor. fully convolutional networks semantic segmentation. ieee conference computer vision pattern recognition weili shen dinggang. predicting standard-dose image low-dose multimodal images using mapping-based sparse representation. physics medicine biology january xiao jiao shen chunhua yang bin. image restoration using deep convolutional encoderdecoder networks symmetric skip connections. advances neural information processing systems wolterink jelmer leiner viergever isgum ivana. generative adversarial networks noise reduction low-dose ieee transactions medical imaging november ramani unser monte-carlo sure black-box optimization regularization parameters general denoising algorithms. ieee transactions image processing august shaoqing kaiming girshick ross jian. faster r-cnn towards real-time object detection region proposal networks. advances neural information processing systems zhang wangmeng chen yunjin meng deyu zhang lei. beyond gaussian denoiser residual learning deep image denoising. ieee transactions image processing ronneberger olaf fischer philipp brox thomas. u-net convolutional networks biomedical image segmentation. international conference medical image computing computer-assisted intervention ville dimitri kocher michel. nonlocal means dimensionality reduction sure-based parameter selection. ieee transactions image processing august vincent pascal larochelle hugo lajoie isabelle bengio yoshua manzagol pierre antoine. stacked denoising autoencoders learning useful representations deep network local denoising criterion. journal machine learning research december", "year": 2018}