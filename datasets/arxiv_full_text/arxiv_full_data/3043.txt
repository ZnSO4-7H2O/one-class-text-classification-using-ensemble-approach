{"title": "Dose Prediction with U-net: A Feasibility Study for Predicting Dose  Distributions from Contours using Deep Learning on Prostate IMRT Patients", "tag": ["physics.med-ph", "cs.AI", "cs.CV", "cs.LG"], "abstract": "With the advancement of treatment modalities in radiation therapy, outcomes haves greatly improved, but at the cost of increased treatment plan complexity and planning time. The accurate prediction of dose distributions would alleviate this issue by guiding clinical plan optimization to save time and maintain high quality plans. We have developed a novel application of the fully convolutional deep network model, U-net, for predicting dose from patient contours. We show that with this model, we are able to accurately predict the dose of prostate cancer patients, where the average dice similarity coefficient is well over 0.9 when comparing the predicted vs. true isodose volumes between 0% and 100% of the prescription dose. The average differences in mean and max dose for all structures were within 2.3% of the prescription dose.", "text": "advancement treatment modalities radiation therapy outcomes haves greatly improved cost increased treatment plan complexity planning time. accurate prediction dose distributions would alleviate issue guiding clinical plan optimization save time maintain high quality plans. developed novel application fully convolutional deep network model u-net predicting dose patient contours. show model able accurately predict dose prostate cancer patients average dice similarity coefficient well comparing predicted true isodose volumes prescription dose. average differences mean dose structures within prescription dose. introduction radiation therapy leading treatment methods cancer patients advent advancements innovative modalities intensity modulated radiation therapy volume modulated therapy plan quality drastically improved last decades. however development comes cost treatment planning complexity. complexity given rise better plan quality double-edged sword also increased planning time obscured tighter standards treatment modalities capable meeting. prediction dose distributions constraints become active field research goal creating consistent plans informed ever-growing body treatment planning knowledge well guiding clinical plan optimization save time maintain high quality treatment plans across planners different experiences skill levels. much work dose prediction radiotherapy revolving around paradigm known knowledge-based planning focused prediction patient’s dose distribution dose volume histogram using historical patient plans information. seen large successes advancements improved reliability predictions methods require enumeration parameters/features order feed model dose prediction. although much time effort spent selecting handcrafted features—such spatial information organs risk planning target volumes distance-to-target histograms overlapping volume histograms structure shapes number delivery fields etc.-—it still deliberated features greatest impact features would considerably improve dose prediction. artificial neural networks applied learn complex relationships handcrafted data still limited inherent information present data. last years deep learning made quantum leap advancement many areas. particular area progression convolutional neural network architectures imaging vision purposes-. radical idea called fully convolutional networks proposed. provided architecture make predictions pixel level instead coarse inference images outperformed state-of-the-art techniques time semantic segmentation. shortly after complex models built around concept order solve shortcomings. particular architecture proposed model called u-net focused semantic segmentation biomedical images. success largely attributed ability capture local global features image three central ideas architecture design large number pooling operations allow convolution filters find global non-local features transposed convolution operations—also known deconvolution up-convolution—to return image original size copying maps first half u-net order preserve lower-level local features. ideas u-net make ideal challenge dose prediction radiotherapy. inserting domain knowledge problem essential limited amount data look towards deep learning reduce dependence handcrafted features allow deep network learn features prediction. hypothesize u-net architecture able accurately predict dose distribution simple patient contours learning abstract high-level local broad features. figure u-net architecture additional layers used dose prediction. numbers boxes represent number features numbers left hierarchy u-net represents size feature. shown figure seven-level hierarchy u-net constructed extra modifications made original design achieve goal contour-to-dose mapping. choice levels pooling operations made reduce feature size pixels pixels allowing convolution operation connect center tumor edge body patient cases. zero padding added convolution process feature size maintained. seven layers denoted purple arrows figure added u-net order smoothly reduce number filters one. batch normalization added convolution rectified linear unit operations u-net allows equal updating weights throughout u-net leading faster convergence. noted original publication suggests performing normalization process non-linearity operation found better performance using normalization relu operation—the validation’s mean squared error epochs using relu using relu. input starts channels pixel images channel representing binary mask contours used study. adam algorithm chosen optimizer minimize loss function. total network consisted layers. deep network architecture implemented keras tensorflow backend. training evaluation test feasibility model treatment plans clinical coplanar imrt prostate patients planned imrt fields used. imrt beam angles similar across patients. patient contours planning target volume bladder body left femoral head right femoral head rectum. volume dimensions reduced voxels resolutions training patient doses normalized mean dose delivered equal u-net model trained single slices patient. input contours treated channel image output u-net’s prediction dose patient slice. loss function chosen mean squared error predicted dose true dose delivered patient. since central slices containing important edge slices dose prediction applied domain knowledge problem implementing gaussian sampling scheme—the center slice would likely chosen training function queried another batch random samples. distance center slice edge slice chosen equal standard deviations gaussian sampling. training patients test patients. separate u-net models initialized trained validated unique training test combination. fold produces model predict dose distribution patients never trained combining prediction results models yields total patients valid dose predictions. remainder manuscript common notation used. dose volume structure interest least receiving. volume region interest. example dose volume structure interest least receiving. volume volume isodose region. compare across patients plans normalized volume receiving prescription dose noted normalized differently training model normalized plans mean dose. normalizing mean dose creates uniform dataset likely stable training plans normalized clinical relevance value assessment. dose statistics also reported relative prescription dose evaluation criteria dice similarity coefficients total models folds trained epochs each took approximately days gpus. plot training validation loss folds shown figure example. final average loss standard deviation folds figure contours planning target volume organs risk true dose wash predicted dose wash difference patient. mean dose difference inside body prescription dose. typical prediction example u-net model figure shows input contours true predicted dose washes difference doses patient. average dose difference inside body less prescription dose. figure shows patient figure visually u-net tends predict similar dose coverage slightly under-predicting doses. figure shows examples dose prediction u-net patients diverse geometries. visually seen u-net learned shape dose based oars sizes locations shapes. finer details dose distributions away correctly predicted deep network model. dice similarity coefficients range considered perfect match. average dice similarity coefficients well isodose volumes shown figure cross-validation folds shared similar trends isodose volume similarity expressing slight decreases dice coefficient near isodose volume isodose volume isodose volume. entirely clear u-net model difficulty predicting dose areas. investigation conducted matter. plot mean dose differences oars shown figure median values plot slightly positive showing u-net tends under-predict doses. under-predictions minor largest average difference dose right femoral head prescription dose. average largest difference mean dose found bladder prescription dose. full list average differences found table homogeneity similar true predicted values shown table larger differences found van’t riet conformation number high dose spillage average u-net model tends predict conformal dose less dose spillage outside ptv. discussion clear trend u-net model would tend predict conformal dose less dose spillage outside also slightly under-predicting doses organs risk. likely caused u-net making averages higher order heterogeneities dose different patient cases. error slight prediction mean doses. practice underprediction beneficial used planning guidance tool planners meet criteria outlined model. clinical prostate patients acquired study used similar beam angles criteria treatment giving rise uniformity data made ideal test investigate feasibility dose prediction using deep learning model. however current model architecture data leave u-net several limitations. first model currently learned predict dose coming approximately orientations able account intricate beam geometries. secondly current model unable account physician preferences predicting dose limiting level treatment personalization patient. example model unable create rectum-sparing plan bladder-sparing plan physician patient geometry. furthermore training sliceby-slice proven successful coplanar cases method perform satisfactorily performing dose prediction non-coplanar plans. deep network plan extend study building deep learning model learning dose predictions capable handling diverse selection non-coplanar beam orientations. investigate extension u-nets volumetric domain using v-nets order tackle dose prediction non-coplanar radiotherapy plans dose constraint parameters model input allow prediction dose based physician’s prescription patient’s geometry. conclusion developed novel application fully convolutional deep network model unet dose prediction. model able take prostate patient’s contours predict dose distribution abstracting contours local global features. using implementation u-net able accurately predict dose patient average mean dose differences structures within prescription dose. isodose similarity evaluation reveals predicted dose isodose volumes match true isodose volumes average dice coefficient well plan continue improving model adding dose prediction non-coplanar beam arrangements accounting physician preference. immediate application dose prediction model guide clinical plan optimization reduce treatment planning time maintain high quality plans. long-term objective incorporate learning dose prediction model artificially intelligent radiation therapy treatment planner. brahme optimization stationary moving beam radiation therapy techniques. radiotherapy oncology. bortfeld bürkelbach boesecke schlegel methods image reconstruction projections applied conformation radiotherapy. physics medicine biology. bortfeld kahler waldron boyer x-ray field compensation multileaf collimators. international journal radiation oncology* biology* physics. webb optimisation conformal radiotherapy dose distribution simulated annealing. physics medicine biology. convery rosenbloom generation intensity-modulated fields conformal radiotherapy dynamic collimation. physics medicine biology. verhey multileaf collimator leaf sequencing algorithm intensity modulated beams multiple static segments. medical physics. keller-reichenbecher bortfeld levegrün stein preiser schlegel intensity modulation step shoot technique using commercial planning study. international journal radiation oncology* biology* physics. intensity-modulated therapy dynamic multileaf collimation alternative tomotherapy. physics medicine biology. otto volumetric modulated therapy imrt single gantry arc. medical physics. palma vollans james volumetric modulated therapy delivery prostate radiotherapy comparison intensity-modulated radiotherapy three-dimensional conformal radiotherapy. international journal radiation oncology*biology*physics. shaffer morris moiseenko volumetric modulated therapy conventional simultaneous maximal intraprostatic boost planning comparison study. clinical oncology. shaffer nichol vollans comparison volumetric modulated therapy conventional intensity-modulated radiotherapy frontal temporal radiation oncology*biology*physics. xing smcaxwactamwal. aperture modulated therapy. physics medicine biology. earl shepard naqvi inverse planning intensity-modulated therapy using direct aperture optimization. physics medicine biology. daliang muhammad knaajyafcadms. generalized inverse planning tool volumetric-modulated medicine biology. thongphiew planning quality evaluation tool prostate adaptive learning. medical physics. appenzoller michalski thorstad mutic moore predicting dosevolume histograms imrt planning. medical physics. pang improved robotic stereotactic body radiation therapy plan quality planning efficacy organ-confined prostate cancer utilizing overlapvolume histogram-driven planning methodology. radiotherapy oncology. shiraishi olsen moore knowledge-based prediction plan quality metrics intracranial stereotactic radiosurgery. medical physics. moore brame mutic experience-based quality control clinical intensity-modulated radiotherapy planning. international journal radiation oncology*biology*physics. shiraishi moore knowledge-based prediction three-dimensional dose distributions external beam radiotherapy. medical physics. ricchetti sanguineti data-driven approach generating intensity-modulated achievable dose–volume histogram objectives radiotherapy planning. international journal radiation oncology*biology*physics. pang simari taylor sanguineti mcnutt using overlap volume histogram imrt plan data guide automate vmat planning head-andneck case study. medical physics. ;-n/a. tran woods nguyen predicting liver sbrt eligibility plan quality vmat plans. radiation oncology. yuan kirkpatrick quantitative analysis factors affect interpatient organ-at-risk dose sparing variation imrt plans. medical physics. lian yuan modeling dosimetry organ-at-risk head neck imrt planning intertechnique interinstitutional study. medical physics. ;-n/a. folkerts radke jiang su-g-tep- modality-specific dose gradient modeling prostate imrt using spherical distance maps isodose contours. medical physics. folkerts long radke knowledge-based automatic treatment planning prostate imrt using -dimensional dose prediction thresholdbased optimization. presented american association physicists medicine denver lecun boser denker backpropagation applied handwritten code recognition. neural computation. krizhevsky sutskever hinton imagenet classification deep convolutional neural networks. paper presented advances neural information processing systems. girshick donahue darrell malik rich feature hierarchies accurate object detection semantic segmentation. paper presented proceedings ieee conference computer vision pattern recognition. simonyan zisserman deep convolutional networks large-scale image recognition. arxiv preprint arxiv. long shelhamer darrell fully convolutional networks semantic segmentation. paper presented proceedings ieee conference computer vision pattern recognition. ronneberger fischer brox u-net convolutional networks biomedical image segmentation. paper presented international conference medical image computing computer-assisted intervention. hong learning deconvolution network semantic segmentation. paper presented proceedings ieee international conference computer vision. ioffe szegedy batch normalization accelerating deep network training reducing internal covariate shift. paper presented international conference machine learning. srivastava hinton krizhevsky sutskever salakhutdinov dropout simple prevent neural networks overfitting. journal machine learning research. kingma adam method stochastic optimization. arxiv preprint arxiv. chollet keras. https//github.com/fchollet/keras github; abadi agarwal barham tensorflow large-scale machine learning heterogeneous distributed systems. arxiv preprint arxiv. van't riet moerland elders conformation number quantify degree conformality brachytherapy external beam irradiation application prostate. international journal radiation oncology* biology* physics. milletari navab ahmadi s-a. v-net fully convolutional neural networks volumetric medical image segmentation. paper presented vision fourth international conference", "year": 2017}