{"title": "Shape-aware Surface Reconstruction from Sparse 3D Point-Clouds", "tag": ["cs.CV", "stat.ML"], "abstract": "The reconstruction of an object's shape or surface from a set of 3D points plays an important role in medical image analysis, e.g. in anatomy reconstruction from tomographic measurements or in the process of aligning intra-operative navigation and preoperative planning data. In such scenarios, one usually has to deal with sparse data, which significantly aggravates the problem of reconstruction. However, medical applications often provide contextual information about the 3D point data that allow to incorporate prior knowledge about the shape that is to be reconstructed. To this end, we propose the use of a statistical shape model (SSM) as a prior for surface reconstruction. The SSM is represented by a point distribution model (PDM), which is associated with a surface mesh. Using the shape distribution that is modelled by the PDM, we formulate the problem of surface reconstruction from a probabilistic perspective based on a Gaussian Mixture Model (GMM). In order to do so, the given points are interpreted as samples of the GMM. By using mixture components with anisotropic covariances that are \"oriented\" according to the surface normals at the PDM points, a surface-based fitting is accomplished. Estimating the parameters of the GMM in a maximum a posteriori manner yields the reconstruction of the surface from the given data points. We compare our method to the extensively used Iterative Closest Points method on several different anatomical datasets/SSMs (brain, femur, tibia, hip, liver) and demonstrate superior accuracy and robustness on sparse data.", "text": "reconstruction object’s shape surface points plays important role medical image analysis e.g. anatomy reconstruction tomographic measurements process aligning intra-operative navigation preoperative planning data. scenarios usually deal sparse data signiﬁcantly aggravates problem reconstruction. however medical applications often provide contextual information point data allow incorporate prior knowledge shape reconstructed. propose statistical shape model prior surface reconstruction. represented point distribution model associated surface mesh. using shape distribution modelled formulate problem surface reconstruction probabilistic perspective based gaussian mixture model order given points interpreted samples gmm. using mixture components anisotropic covariances oriented according surface normals points surface-based ﬁtting accomplished. estimating parameters maximum posteriori manner yields reconstruction surface given data points. compare method extensively used iterative closest points method several diﬀerent anatomical datasets/ssms demonstrate superior accuracy robustness sparse data. keywords sparse shape reconstruction statistical shape model point distribution model gaussian mixture model expected conditional maximisation. reconstruction object’s shape surface points highly relevant problem medical image analysis. appears example image segmentation images provide implicit information location anatomical structures intensity levels frequently converted geometric information kind feature extraction method. another scenario computer-assisted surgery pre-operative therapy plan transferred operating room means navigation system. contrast mere point-clouds represent virtually object image data medical objects yield additional contextual information used adopt prior knowledge anatomical structures reconstructed. heckel make variational interpolation method essentially uses general prior surface smoothness. going step further pauly considered templates scan completion matched measurements. however methods limited since available measurements assumed suﬃciently dense tackle limitation bernard suggested statistical shape model surface reconstruction. class anatomical structures known clinical routine tasks segmentation registration intra-operative navigation possible shapes geometric priors. main contribution work introduction surface-based ﬁtting procedure order reconstruct surface sparse point-cloud. using point distribution model incorporate prior reconstruction framework captures likely shape object extracted. reformulate problem surface reconstruction probabilistic perspective embedding prior distribution parameters explain plausible shapes objective function. evaluation considers several diﬀerent anatomical structures ssms sparse data point scenarios occur diﬀerent applications ranging interactive segmentation intra-operative registration navigation. able show superior accuracy robustness compared extensively used iterative closest point method rather restricting particular applications investigating application-speciﬁc aspects goal demonstrate general applicability proposed approach order emphasize method useful wide range settings. surface-based ﬁtting procedure achieved following methodological contributions dures based gaussian mixture models anisotropic covariances used combination transformation model obtain shapeaware surface reconstruction method superior respect robustness accuracy. point-based matching used complement works presenting formulation based anisotropic gmms oriented surface normals accounting surface-based ﬁtting. surface-based ﬁtting method presented leading expected conditional maximisation algorithm shares convergence properties expectation maximisation method general. ﬁtting method computational complexity spherical gmm-based method. numerical simulations show less prone unwanted local optima compared original ecm-based method. article organised follows section summarises previous research relevant methodology. sections introduce notation formally state considered surface reconstruction problem. addition recapitulate background pdms probabilistic point-set registration expectation maximisation method. section present novel shapeaware surface reconstruction method including time complexity convergence analysis. section comprises experiments conducted using proposed methods. section conclude work. bernardini treece kazhdan schroers many summarised described state-of-the-art report berger remainder present section discuss surface reconstruction methods beyond pure smoothness assumptions make explicit shape priors. completion shapes incorporate templates shape database priors bayesian framework. similarly database shapes used pauly completing surface scans. increased ﬂexibility compared static priors contextspeciﬁc database local shape priors input data matched combining multiple local shape priors global prior. pointed berger approaches described pauly limited assumption point-clouds assumed suﬃciently dense. uniﬁed framework repairing geometry texture meshes presented park employ context-based geometry ﬁlling ﬁlling holes surface available local patches mesh used missing parts. task obtaining high-resolution meshes low-quality inputs tackled shen dynamically assembling object templates database object parts. shape completion methods discussed common focus completing missing parts meshes obtained scans. however interest lies primarily methods beyond patching improving low-resolution input. blanz presented closed-form solution ssm-based surface reconstruction sparse points relies however assumption points already correspondence model. albrecht introduced posterior shape models objective model distribution whole shape given partial information. method assumes corresponding model points available partial data known. experiments issue either solved manually using method. similarly shape prediction sparse observations blanc sz´ekely variant evaluates multiple initialisations. anguelov introduced shape completion animation people method model pose deformations model shape variations learned separately. main objective method completion body shapes based small number known positions model points. applied bone models rajamani small number anatomical landmarks correspond model points. baka sparse data points correspondence model applied heart datasets. producing conﬁdence intervals output method able incorporate uncertainties input data. instead using trained formulate low-rank matrix recovery problem restoring missing parts objects archaeological studies. considering objects class available correspondences common parts known approach based assumption shapes approximately linearly correlated. shortcoming methods discussed assume known correspondences. however objects exhibit suﬃcient amount distinct features identiﬁcation exact correspondences diﬃcult even infeasible practice. literature several methods published addressing diﬃculty detecting correspondence sparse data points model. simplicity algorithm correspondences transformations estimated alternating manner popular method registration shapes represented point sets. numerous variants originally-proposed method since developed e.g. rusinkiewicz levoy granger pennec segal maier-hein bouaziz billings example granger pennec propose em-icp algorithm hidden variables used model unknown correspondences surface registration problem. based work hufnagel proposed method learning unstructured pointsets. that authors establish probabilistic correspondences ﬁrst followed computation mean shape modes variability. surface reconstruction method stoll able deform given template point-cloud data. user deﬁnes initial correspondences template points reﬁned iteratively icplike manner. along lines stoll knee surgery fleute lavall´ee fleute presented methodology pose shape deformation parameters order sparse data points. approach resembles alternating closest point estimation pose/deformation model parameter updates. similarly chan reconstruct models bones orthopaedic surgery based sparse points obtained ultrasound. here shapes repeatedly instantiated using shape instance used input order sparse points. work extended barratt deﬁned regular grid instead shape surface. zheng proposed three-stage procedure sparse shape reconstruction computer-assisted orthopaedic surgery. ﬁrst stage pose sparse points adapted using best mean shape. second stage shape deformation parameters estimated given correspondences eventually reﬁned using deformation based thin-plate splines. based gaussian mixture models heteroscedastic covariances zheng proposed method deformable shape registration. promising approach ﬁtting hand pose model points suﬃciently densely sampled depth images presented taylor authors formulate continuous optimisation problem solves simultaneously surface-based correspondences model parameters using nonlinear sum-of-squares objective. work chang zwicker registration articulated shapes range scans based reduced deformation model deﬁned regular grid. approach deformations modelled convex combination rigid transformations weights spatially varying. registration performed alternatingly updating rigid transformations weights closest point correspondences recomputed step. despite immense amount literature applications variations statistical shape models ginneken heimann meinzer limited number investigations ssms interactive segmentation. work ginneken user directly manipulates points disadvantage user needs estimate corresponding position considered model point image. particularly diﬃcult object exhibit distinct features. slice-wise ssm-based segmentation abdominal aortic aneurysms bruijne initialise current slice’s ﬁtting segmentation result previous slice option manually correcting segmentations per-slice basis. udupa present oriented active shape models semi-automatic live-wire technique coupled active shape model. authors present tools posterior correction model-based segmentations timinger schwarz acharya hengel present interactive procedure based rules sketches completing partial models structure motion. summarise existing approaches performing surface reconstruction using ssms either assume known correspondences estimate point-based correspondences alternating manner. exception work taylor where suﬃciently dense data surfacebased hand pose model ﬁtting performed. identity matrix diag matrix elements vector diagonal. matrix element column colon-notation used denote rows columns e.g. j-th column matrix concatenation columns given vec. statistical shape models based pdms established technique capture nonlinear shape deformations shapes training data using linear model higher-dimensional shape space. trainvertices oriented triangular surface mesh additionally given sparse sense contains points lying object’s surface. objective deformation parameter best agrees points work motivated widely used coherent point drift approach general point-set registration also resembles approach zheng deformable shape registration however based heteroscedastic gmms isotropic covariances related em-icp algorithm since also make hidden variables model unknown correspondences. usually addition accounting shape deformations rigid transformation employed order account absolute pose shape respect reference assume predominant part pose already normalised. minor pose variations captured implicitly pdm. section below present main novelty paper anisotropic gmm-based ﬁtting approach employs covariance matrices oriented according surface normals points. allows move purely point-based matching surface-based ﬁtting. subsequently describe fast approximation anisotropic method. using extension approximation ensure instance generalised expectation maximisation method thus convergence guaranteed. using spherical covariances gaussian components purely point-based ﬁtting conducted. however vast amount medical applications ssms points represent vertices surface mesh. surface mesh general approximation continuous surface. whilst sparse scalar parameter seen global scaling factor whereas matrix models anisotropy surface structure locally using larger variance directions vectors lying tangent plane surface compared variance along normal direction maximisation w.r.t. cannot solved readily appearing inside logarithm. therefore common approach employ iterative method maximisation. denote estimate iteration rewrite such right-hand side denote lower bound maximising lower bound idea algorithm. e-step probabilities evaluated ﬁxed using then m-step maximised w.r.t. ﬁxed shown green green points deﬁne vertices orientation covariance matrices shown white ellipses. objective deform rectangle points adjusting initialisation shown since points sampled points using spherical covariance matrices results even worse initialisation whereas using anisotropic covariances results accurate initialisation admit simple closed-form solution. contrast isotropic case maximises found solving linear system equations. instead obtained using bfgs quasi-newton method idea start value iteratively move along directions increase whilst ordinary newton method requires gradient well hessian bfgs quasi-newton method uses approximation hessian cheap compute. derivation order obtain option bfgs quasi-newton procedure convergence obtains maximises that updates depend procedure reverts algorithm alternative single quasi-newton step m-step. that obtained local maximiser however still guarantee non-decreasing. such procedure reverts algorithm finally σ-update ﬁxed given introduce approximation α-update much faster alternative quasi-newton method. main idea previous value instead computing anisotropic covariance matrices α-update mpoints). motivation found work hill covariance matrix variance along normal given variance direction vector tangent plane such obtains isotropic ﬁtting analogy algorithm refer isotropic method iso. main diﬀerences approach case transformations parametrised also allow anisotropic covariances. using transformations parametrised also done zheng deformable shape registration. choosing achieves desired behaviour modelling larger variance tangent plane. note matrix symmetric positive deﬁnite spectrum precision matrix methods reverts isotropic case condition vacuously holds. however true general. ensure nondecreasing evaluate condition iteration case violation revert quasi-newton methods α-update. speciﬁcally consider single quasi-newton step updating denote approximate method without convergence check aniso method convergence check quasi-newton step fall-back anisoc. fig. illustrate behaviour compare various choices note visualisation purposes chosen whereas higherdimensional cases eﬀect increasing nonconcavity expected severe. table summarises computational complexity presented methods. fig. plot mean normalised value function processing time four anisotropic ﬁtting methods. random sample shape instance drawing select points randomly mesh surface four methods. obtained four methods normalised smallest corresponds largest corresponds found single-step quasinewton method faster compared full quasi-newton procedure moreover compared quasi-newton methods approximate methods much faster. since anisoc method makes elements aniso method total time complexity anisoc method combined time complexity aniso nevertheless simulations anisoc method comes close aniso method terms convergence speed. early stages iterative procedure anisoc method satisﬁes condition cases. violation happens frequently later stages. since results suggest aniso step. assumption wellbehaved sense neighbouring vertices vary locally deforsmoothly deformation; thus mation individual triangle nearly translation. since surface normals invariant translations foldiﬀerence constant used place function such α-update m-step quadratic concave problem maximised eﬃciently. solution found solving linear system figure illustration behaviour various height colour surface show value depending grid shows concave approximation presented denotes value position yellow indicates maximum trivial case seen everywhere whereas increasing leads larger discrepancy well increased non-concavity sample sparse points randomly shape surfaces. ﬁrst select triangle surface mesh probability proportional area. then uniformly sample point lying within triangle according procedure presented osada moreover order evaluate well method able cope uncertainties given points considered noisy versions points adding spherical gaussian noise covariance point individually. experiment taken scale object shape model account choosing considered values presented table table summary parameters datasets. number points number training shapes number modes variation leave-all-in leave-one-out experiments anisotropy parameter standard deviation noise added points. addition proposed probabilistic ﬁtting methods presented paper also evaluate nonprobabilistic approaches. ﬁrst approach regularised isotropic method outlined algorithm denote experiments. second approach anisotropic version thereof denote aicp experiments. similarly maierhein anisotropic compute nearest neighbours third line algorithm table computational complexity table. complexity α-update iteration bfgs quasi-newton methods plus complexity evaluation matrix inversion involved. note figure proportion best value versus processing time averaged random runs four anisotropic methods choices column diﬀerent dataset used produced results left right show results produced brain shapes dataset femur dataset tibia dataset dataset taking anisotropic covariance matrices account. both aicp regulariser corresponds covariance matrix parameter moreover evaluation compare ground truth data mean shape i.e. setting ﬁtting procedure amounts setting anisotropic method requires parameter accounting amount anisotropy. manually chosen values dataset shown table empirically found increasing amount uncertainty sparse points advantageous lower value consider leave-all-in leave-one-out experiments. experiments measure performance method given perfect model whereas experiments evaluate generalisation ability unseen data. femur tibia datasets assumed pose already normalised worked directly space ssm. practice example tackled similar manner seim proposed automated ssm-based knee bone segmentation initially model positioned inside three dimensional image generalised hough transform present experiments femur points tibia points additionally evaluated aniso method using downsampled pdms denoted aniso-ds subset original vertices used fig. random sparse points generated according procedure described section training shape seen bone pdms points available methods perform slightly better aniso method. points become available aniso method outperforms method. surprisingly aniso-ds method uses downsampled outperforms aniso method assume original pdms comprising vertices femur vertices tibia contain local details lead overﬁtting reconstructing surface points. contrast downsampled contains less details impede surface reconstruc femur mean shape figure femur tibia datasets. vertices. downsampled mean shape vertices. tibia mean shape vertices. downsampled mean shape vertices. bone models sparse points randomly drawn original surface according procedure described section tion. moreover aniso-ds method outperforms iso-ds method conﬁrms elaborations fig. real data. moreover bone pdms aicp method performs similar icp. settings without noise i.e. anisotropic method outperforms methods respect mean regardless many random points sampled. especially points accuracy anisotropic method becomes increasingly superior compared icp. considering random points disturbed gaussian noise method yields better results points. noisy points experiments least points seem necessary anisotropic method achieve results similar methods respect dsc. similarly femur tibia cases aicp method method. results shown fig. settings without gaussian disturbance i.e. anisotropic method outperforms method respect mean dice similarity coeﬃcient points. again aniso method accuracy increasing sampled points. considering random points disturbed gaussian noise method yields better results points whereas points aniso method figure liver dataset. mean shape vertices. downsampled mean shape vertices. sparse points randomly drawn original surface according procedure described section figure dataset. mean shape vertices. downsampled mean shape vertices. sparse points randomly drawn original surface according procedure described section interesting perspective presented shapeaware surface reconstruction method might integration interactive segmentation setting. could implemented alternating user annotating object boundaries running ﬁtting method order reconstruct surface user-input. ﬁrst step direction addition random sparse points brain structure dataset also evaluate ﬁtting partial contours. decided focus partial contours instead full contours since structures regions diﬃcult delineate. order perform evaluation synthetically generated contours according procedure described supplementary material. fig. show sparse points constitute partial contours. main idea contour generation follows. first randomly select slice binary segmentation image particular object. next slice ground truth segmentation subcontour entire boundary randomly selected. combining chosen slice index subcontour leads planar contour. eventually contour subsampled points added substitute proper study involving user-drawn contours found resulting contours look plausible drawn human operator. generation partial contours considered settings contours four eight brain structures shown fig. number points ranges median single contour eight brain structures number points ranges median note considering partial contours order evaluate robustness presented method respect noisy inputs also created noisy contours. that partial contour translated image plane random vector zero-mean gaussian distribution covariance ˜σi. motivation using in-plane translations user draws contour image particular image plane ﬁxed thus uncertainty occurs in-plane. duced cootes taylor wang staib experiments increase ﬂexibility resulting shape model extracting eigenvectors modiﬁed covariance matrix. case used covariance matrix gaussian kernel standard deviation approximately refer interested reader previous work experiment consider multi-object captures inter-relation multiple brain structures namely substantia nigra subthalamic nucleus nucleus ruber thalamus putamen globus pallidus structures considered bilaterally. mean shown fig. learned multi-label segmentations represented common coordinate system icbm template space case alignment patient images template space conducted using rigid image registration method flirt hence thanks alignment orientation position already approximately normalised. consequently patient image segmented registration template space suﬃcient. figure brain shapes dataset. mean shape vertices. downsampled mean shape vertices. sparse points randomly drawn original surface according procedure described section shape instance training partial contours. cases running ﬁtting method superior compared simply using mean shape. simplicity method runtime much lower compared proposed ﬁtting methods. however using aniso method downsampled runtime reduced compared aniso method whilst still superior ﬁtting accuracy compared icp. using method interactive segmentation individual annotation moderate amount random points e.g. rather tedious time-demanding. thus settings evaluated alternative using points derived number partial contours. that obtain reasonable number points section much less eﬀort. results suggest general preferable using small amount random points points outperformed considered partial contours. believe reason random points contain diverse scattered information compared contours containing many correlated points. paper presented methodology shape-aware surface reconstruction sparse surface points. proposed methodology superior compared standard approach respect accuracy robustness wide range datasets. method likely shape object reconstructed captured associated surface mesh. interpreting available sparse surface points samples drawn surface reconstruction task cast maximisation posterior likelihood tackle variants algorithm. order achieve surface-based ﬁtting anisotropic covariance matrices oriented surface normals points. however redetails method referred kpca. also demonstrated method able improve generalisation ability small training dataset comprising shapes. summaries results shown fig. anticipated plots conﬁrm respect ﬁtting accuracy increasing number measurements improves results. moreover seen aniso method outperforms methods cases standard deviation much larger. sults non-concave optimisation problem needs solved m-step. deal maximising concave approximation considers surface normals computed previous value shape deformation parameter. stated before approximation makes sense assumption neighbour vertices vary smoothly fact surface normals invariant translations. empirically demonstrated ﬁnding global maximum approximation leads better results compared ﬁnding local optimum exact m-step. moreover proposed concave approximation results algorithm time complexity isotropic ﬁtting procedure. proposed surface reconstruction method deals exclusively shape deformations. thus normalisation pose must solved a-priori applicationdependent manner. example multi-object brain shape reconstruction dealt issue ﬁrst performing rigid image registration order align data common coordinate system. dealing limitation explicitly considering rigid transformation order model pose object next step achieving even broader applicability. whilst principal formulate analogous problem considers pose resulting problem much diﬃcult solve. simultaneous maximisation must performed respect rigid transformation shape deformation parameter. usually done iteratively active shape model search that particular challenges dealt resulting surface reconstruction procedure would much sensitive unwanted local optima well much slower. conducted evaluation proposed algorithmic tools wide range datasets order demonstrate general applicability ﬁeld medical image analysis. evaluation considered general noise model i.e. gaussian noise independent point. addition contour case also considered in-plane noise. since focus demonstrating general applicability detailed evaluation certain application-speciﬁc aspects studied paper. interesting direction future work consider outliers sparse points relevant sparse points automatically generated could example tackled integrating additional uniform component mixture model another approach ransac-like procedure order encourage integration method application-speciﬁc medical imaging workﬂows make method publicly available. expect authors gratefully acknowledge ﬁnancial support fonds national recherche luxembourg german federal ministry education research grant einstein center mathematics berlin. brevity write denote partial derivative w.r.t. dependence implicit. first note cross-product vec∂αm tors written matrix multiplication operator creates skewblanz mehl vetter seidel h.p. statistical method robust surface reconstruction sparse data data processing visualization transmission bolle r.m. vemuri b.c. three-dimensional surface reieee transactions pattern analysis dempster a.p. laird n.m. rubin d.b. maximum likelihood incomplete data algorithm. journal royal statistical society. series edelsbrunner m¨ucke e.p. three-dimensional alpha fleute lavall´ee building complete surface model sparse data using statistical shape models application computer assisted knee surgery international conference medical image computing computer-assisted intervention. incorporating statistically based shape model system computer-assisted anterior cruciate ligament surgery. medical image analysis fonov v.s. evans a.c. mckinstry r.c. almli c.r. collins d.l. unbiased nonlinear average age-appropriate brain templates birth adulthood. neuroimage ginneken frangi a.f. frangi r.f. staal j.j. haar romeny b.m. viergever m.a. active shape model segmentation optimal features. ieee transactions medical imaging", "year": 2016}