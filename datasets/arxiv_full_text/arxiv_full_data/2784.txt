{"title": "Deep Reinforcement Learning for De-Novo Drug Design", "tag": ["cs.AI", "cs.LG", "stat.ML"], "abstract": "We propose a novel computational strategy based on deep and reinforcement learning techniques for de-novo design of molecules with desired properties. This strategy integrates two deep neural networks -generative and predictive - that are trained separately but employed jointly to generate novel chemical structures with the desired properties. Generative models are trained to produce chemically feasible SMILES, and predictive models are derived to forecast the desired compound properties. In the first phase of the method, generative and predictive models are separately trained with supervised learning algorithms. In the second phase, both models are trained jointly with reinforcement learning approach to bias newly generated chemical structures towards those with desired physical and biological properties. In this proof-of-concept study, we have employed this integrative strategy to design chemical libraries biased toward compounds with either maximal, minimal, or specific range of physical properties, such as melting point and hydrophobicity, as well as to develop novel putative inhibitors of JAK2. This new approach can find a general use for generating targeted chemical libraries optimized for a single desired property or multiple properties.", "text": "propose novel computational strategy based deep reinforcement learning techniques de-novo design molecules desired properties. strategy integrates deep neural networks generative predictive trained separately employed jointly generate novel chemical structures desired properties. generative models trained produce chemically feasible smiles predictive models derived forecast desired compound properties. first phase method generative predictive models separately trained supervised learning algorithms. second phase models trained jointly reinforcement learning approach bias newly generated chemical structures towards desired physical biological properties. proof-of-concept study employed integrative strategy design chemical libraries biased toward compounds either maximal minimal specific ranges physical properties melting point hydrophobicity well develop novel putative inhibitors jak. approach find general generating targeted chemical libraries optimized single desired property multiple properties. artificial intelligence systems radically transform practice scientific discovery. combination data artificial intelligence referred fourth industrial revolution. artificial intelligence also revolutionizing medicine including radiology pathology medical specialties deep learning technologies beginning find applications drug discovery including areas molecular docking transcriptomics reaction mechanism elucidation molecular energy prediction drug discovery pipeline notoriously sequential hits high throughput screen slowly progressed toward promising lead compounds. next admet selectivity profiles optimized challenge maintain potency efficacy. high failure rates late-stage compound development clinical trials could potentially avoided models forecast compound fate could employed initial molecular design phase. example approach broad lipinski’s rules bioavailability filter molecules possess desired bioactivity vitro. indeed acknowledged broad rules substantially reduced failure rate experimental adme studies drug candidates crucial step many drug discovery projects formulation well-motivated hypothesis lead compound generation compound selection available synthetically feasible chemical libraries based available data. commonly interdisciplinary team scientists generates hypothesis employing computational models drug action relying expertise medicinal chemistry intuition. therefore design hypothesis often biased towards preferred chemistry driven model interpretation automated approaches designing compounds desired properties novo become active field research last years attempt design compounds medicinal computational chemists face virtually infinite chemical space. diversity synthetically feasible chemicals considered potential drug-like molecules estimated great advances computational algorithms hardware high-throughput screening technologies notwithstanding size virtual library prohibits exhaustive sampling testing systematic construction evaluation individual compound. local optimization approaches proposed ensure optimal solution design process converges local ‘practical’ optimum stochastic sampling restrict search defined section chemical space screened exhaustively notably method exploring chemical space based continuous encodings molecules proposed recently allows efficient directed gradient-based search chemical space include biasing libraries toward special physical biological properties. another recent approach generating focused molecule libraries desired bioactivity using recurrent neural networks proposed well however properties produced molecules could controlled well. another approach proposed novel molecular development adversarial autoencoder suggests method virtual screening large libraries cannot design novel molecules. points latent space projected nearest known molecule screening database. herein propose novel method generating chemical compounds desired physical chemical and/or bioactivity properties based deep reinforcement learning reinforcement learning subset artificial intelligence used solve dynamic decision problems. involves analysis possible actions estimation statistical relationship actions possible outcomes followed determination treatment regime attempts find desirable outcome based analysis integration reinforcement learning neural networks dates back however recent advancement deep learning benefiting data powerful algorithmic approaches emerging. current renaissance especially combined deep neural networks i.e. deep reinforcement learning. recently employed achieve superhuman performance game considered practically intractable theoretical complexity possible solutions analogy complexity chemical space exploration algorithm avoids brute-force computing examine every possible solution. describe application deep problem designing chemical libraries desired properties. devised novel based novo design method generating chemical compounds desired physical chemical bioactivity properties. termed release general release workflow represented deep neural networks process training consists stages. first stage models trained separately supervised learning algorithms second stage models trained jointly reinforcement learning approach optimizes target properties. system generative model plays role agent whereas predictive model plays role critic estimates agent's behavior assigning numerical reward every generated molecule. reward function numerical property generated predictive model. generative model trained maximize expected reward. reinforcement learning formulation. generative predictive model combined system. actions defined alphabet i.e. entire collection letters symbols used define canonical smiles strings commonly used encode chemical structures. molecule aspirin example encoded oc=cc=cc=cco]. states defined possible strings alphabet lengths value state length unique considered initial state. state length called terminal state causes training end. subset terminal states contains states length called terminal states set. reward calculated training cycle terminal state reached. intermediate rewards equal terms generator network treated policy approximation model. time step takes previous state input estimates probability distribution next action. afterwards next action sampled estimated probability. reward function predicted property predictive model chosen depending task. examples functions provided computational experiment section. given notations assumptions problem generating chemical compounds desired properties formulated task finding vector parameters policy network maximizes expected reward iterates terminal states. case exponential cannot computed exactly. according large numbers approximate mathematical expectation sampling terminal sequences model distribution estimate sequentially sample model unbiased estimation rewards every time step which case equals reward terminal state assume intermediate rewards equal quantity needed maximized; therefore need compute gradient. done example reinforce algorithm uses approximation mathematical expectation provided equation following form neural networks architectures. model generative recurrent neural network outputs molecules smiles notation. special type stack-augmented recurrent neural network regular recurrent neural networks like lstm unable solve sequence prediction problems inability count. challenging examples sequences cannot properly modeled regular recurrent networks words dyck language language balanced strings brackets another weakness regular recurrent neural networks inability capture long term dependencies leads difficulties generalizing longer sequences properties required learn language smiles notation. valid smiles molecule addition correct valence atoms must count ring opening closure well bracket sequences several bracket types. therefore stack rnns proper choice modeling sequence dependencies. stack-rnn defines neuron cell structure standard cell additional multiplicative gates referred memory stack allow stack-rnn learn meaningful long-range interdependencies. stack differentiable structure onto continuous vectors inserted removed. stack terminology insertion operation called push operation removal operation called operation. traditionally discrete operations continuous here since push operations permitted real values interval intuitively interpret values degree certainty controller wishes push vector onto stack stack. second model predictive model estimating physical chemical biological properties molecules. property prediction model deep neural network consists embedding layer lstm layer dense layers. network designed calculate userspecified property molecule taking smiles string input data vector. practical sense learning step analogous traditional quantitative structure-activity relationships models. however unlike conventional qsar numerical descriptors needed model distinctly learns directly smiles notation. generation chemicals novel structures. generator network trained structures chembl database demonstrate versatility baseline stack generated dataset million virtually synthesized compounds. structures available download supplementary information. random examples generated compounds illustrated figure established generated structures valid chemically-sensible molecules. validity check performed structure checker chemaxon comparing generated molecules chembl model produced less structures training dataset. additional comparison zinc database synthetically accessible drug-like molecules showed match novo generated structures could found zinc. zinc available supplementary information. results demonstrate approach produce realistic molecules enabling generation predominantly novel molecules chief objective novo chemical design. order characterize structural novelty novo generated molecules compared content murcko scaffolds chembl training virtual library generated system. murcko scaffolds provide hierarchical molecular organization scheme dividing small molecules r-groups linkers frameworks scaffolds. define ring systems molecule removing side chain atoms. found less scaffolds library present chembl. overall analysis suggests generative stack model simply memorize training smiles sequences indeed capable generating extremely diverse realistic molecules. assess synthetic accessibility generated molecules using synthetic accessibility score employs knowledge extracted known synthesis reactions penalty high molecular complexity. ease interpretability scaled molecules high typically difficult synthesize whereas molecules values easily synthetically accessible. distribution values calculated molecules generated release shown supplementary figure illustrate robustness approach compared distribution values full chembl library random subsample zinc. similarly typical commercial vendor libraries distribution release rightskewed towards easily synthesizable molecules. median values chembl zinc release. generated molecules therefore despite high novelty vast majority generated compounds considered synthetically accessible. property prediction. past years well defined qsar protocols procedures established qsar method generally defined application machine learning and/or statistical methods problem finding empirical relationships form biological activity molecules; calculated molecular descriptors compounds; empirically established mathematical transformation applied descriptors calculate property values molecules. building machine learning models directly smiles strings completely bypasses traditional qsar step descriptor generation. addition relatively slow descriptor generation non-differentiable allow straightforward inverse mapping descriptor space back molecules. albeit approaches direction proposed contrast using neural networks directly smiles fully differentiable enables direct mapping properties smiles sequence characters smiles strings used model building previously however cases smiles strings used derive stringsubstring-based numerical descriptors note that case ability develop property activity qsar models using smiles critical integrating models possessing novo structure generation step described below. terms accuracy smiles based models also perform well. example using five-fold cross validation obtained external model accuracy expressed rmse logp compared favorably random forest model dragon descriptors melting temperature prediction observed rmse state-of-the-art model obtained stacking multiple descriptors-based models together afforded rmse generation property value biased libraries system. explore utility algorithm drug design setting conducted case studies design libraries three controlled target properties physical properties considered important drug-like molecules specific biological activity chemical complexity. physical properties selected melting temperature n-octanol/ water partition coefficient bioactivity prediction designed putative inhibitors janus protein kinase novel chemotypes. finally number benzene rings number substituents used structural reward design novel chemically complex compounds. figure shows distribution predicted properties interest training test molecules libraries designed system. cases sampled molecules baseline generator rl-optimized generative models calculated properties corresponding predictive model. values substructure features calculated directly structure. table summarizes analysis generated molecules respective statistics. figure property distributions optimized versus baseline generator model. melting temperature inhibition partition coefficient number benzene rings number substituents. elting temperature experiment goals i.e. either minimize maximize target property. upon minimization mean distribution novo generated library shifted compared training distribution library virtually synthesized chemicals included simple hydrocarbons like butane well poly-halogenated compounds like cfcl chf. molecule lowest tm=- produced dataset clearly property minimization strategy extremely effective allowed discovery molecules regions chemical space beyond training drug-like compounds. maximization regime mean melting temperature increased generated library included substantially complex molecules abundance sulphurcontaining heterocycles phosphates conjugated double bond moieties. designing chemical library biased toward range lipophilicity compound hydrophobicity important consideration drug design. components famous lipinski’s rule five orally bioavailable compounds octanol-water partition coefficient logp less thus endeavored design library would contain compounds logp values within favorable drug-like range. reward function case defined piecewise linear function logp constant region words goal generate molecules according typical lipinski’s constraints. shown figure succeeded generating library molecules falling within logp drug-like region. inhibition jak. third experiment serves example common application computational modeling drug discovery employed system design molecules specific biological function i.e. activity modulation. specifically designed libraries goal minimizing maximizing values jak. bioactivity minimization also pursued drug discovery mitigate off-target effects. therefore interested exploring ability system bias design novel molecular structures toward desired range target properties. non-receptor tyrosine kinase involved various processes cell growth development differentiation histone modifications. mediates essential signaling events innate adaptive immunity. cytoplasm also plays important role signal transduction mutations implicated multiple conditions like thrombocythemia myelofibrosis myeloproliferative disorders reward functions cases defined exponential functions results library optimization shown figure minimization mean predicted distribution shifted unit distribution heavily biased toward lower ranges bioactivity molecules predicted practically activity activity maximization exercise properties generated molecules tightly distributed across predicted activity range. case system virtually synthesized known novel compounds majority novo designs novel molecules. generation known compounds regarded model validation. indeed system retrospectively discovered commercially available compounds deposited zinc database constituted total generated library. them like zinc zinc actually annotated possible tyrosine kinase inhibitors. substructure bias. finally also performed simple experiments mimicking strategy biased chemical library design designed library enriched certain user-defined substructures. defined reward function exponent number benzene rings total number small groups substituents. among case studies described structure bias found easiest optimize. figure illustrates evolution generated structures structural reward increases. indeed model progresses toward generating increasingly complex realistic molecules greater numbers rings and/or substituents. expect designing structurally biased libraries highly desirable application approach researchers often wish generate libraries enriched certain privileged scaffold conversely system also allows avoid particular chemical groups substructures lead undesired compound properties toxicity. finally could implement certain substructure pharmacophore similarity reward explore additional chemical space. table shows decrease proportion valid molecules optimization. explain phenomenon weaknesses predictive models integration predictive generative models single design system. presume generative model tends find local optima reward function correspond invalid molecules predictive model assigns high rewards molecules. explanation also supported results structure bias optimization experiments predictive models experiments decrease proportion valid molecules insignificant. also noticed among experiments predictive models logp optimization showed highest proportion valid molecules time predictive model logp estimation highest accuracy igure evolution generated structures chemical substructure reward increases. reward proportional total number small group substituents reward proportional number benzene rings. odel analysis. model interpretation highly significant component study. section demonstrate stack-rnn learns memorizes useful information smiles string currently processing. manually analyzed neuron gate activations neural network processes input data. figure lists several examples cells neural networks interpretable gate activations. figure line corresponds activations specific neuron different processing smiles time steps pre-trained baseline generative model. letter colored according value tanh activation cool-warm colormap dark blue dark i.e. found several interpretable cells. cells divided groups chemically sensible group activates specific chemical groups moieties syntactic group keep tracks numbers bracket opening closure even smiles string termination molecule generated. instance cells reflecting presence carbonyl group aromatic groups moieties heterocycles. also observed three examples counter-cells deactivate presence aforementioned chemical groups. neural network-based models notoriously uninterpretable majority cells indeed category. hand possibility even partial interpretation offered approach could highly valuable medicinal chemist. visualization chemical libraries. order understand generative models populate chemical space molecules used t-distributed stochastic neighbor embedding dimensionality reduction selected datasets three endpoints used case studies produced corresponding optimized generative models every molecule calculated latent vector representation feed-forward layer relu activation function predictive model respective property constructed projection using t-sne. projections illustrated figure every point corresponds molecule colored according property value. igure examples stack-rnn cells interpretable gate activations. color coding corresponds cells hyperbolic tangent 𝑡𝑎𝑛ℎ activation function dark blue corresponds activation function value described value activation function numbers range colored using cool-warm color map. libraries generated achieve certain partition coefficient distribution observe well-defined clustering molecules similar logp values. contrast melting temperature clusters. high molecules intermixed together. observation explained fact melting temperature depends chemical structure molecule also intermolecular forces well packing crystal lattice. therefore plotting molecules neural representation could achieve good separation high case model could observe large non-overlapping areas roughly corresponding inactive active compounds. inside areas molecules typically clustered around multiple privileged scaffolds. specifically abundance compounds -triazine -triazine -methyl-h--triazole h-pyrrolopyrimidine hpyrazolopyrimidine thieno-triazolo-pyrimidine substructures. overall approach offers rapid visualize chemical space coordinates relevant specific prediction endpoint. joint embedding training newly generated molecules could also help understand parts novel chemical space model already explored. implemented deep reinforcement learning approach novo molecular design. strategy allows generation novel chemical compounds desired properties. deep neural networks generative predictive combined general workflow. training process consists stages. first stage models trained separately using supervised learning second stage models trained jointly reinforcement learning method. neural networks employ endto-end deep learning rely pre-defined chemical descriptors trained directly chemical structures represented smiles strings. distinction makes approach clearly differentiated traditional qsar methods simpler execute. reinforcement learning approach de-novo molecular design employed well. however data provided show predicted properties molecular compounds optimized. instead demonstrating shift distribution biological activity values dopamine receptor type optimization paper shows increase fraction generated molecules similar train test sets. increase doesn’t mean generative model capable produce novel active compounds results model’s weaknesses memorizing training set. indeed generative model vanilla recurrent neural network without augmented memory stack capacity count infer algorithmic patterns. another weakness point view usage standard qsar predictive model depending numerical descriptors whereas propose model essentially descriptor-free naturally forms coherent workflow together generative model. proof principle tested approach three diverse types endpoints physical properties biological activity chemical substructure bias. flexible reward function enables different library optimization strategies minimize maximize impose desired range property interest generated compound libraries. by-product case studies generated dataset novel compounds model synthesized virtually. figure clustering generated molecules t-distributed stochastic neighbor embedding molecules colored based predicted properties model values shown color right. examples generated molecules randomly picked matches zinc database property values predicted model partition coefficient logp melting temperature examples show generated molecules lowest highest predicted melting temperatures inhibition predicted pic. common critique methods computational library design often inability control synthetic accessibility produced molecules. indeed computationally generated compounds often quite complex exotic substituents. many cases require multi-step custom syntheses even could synthesized current level technology. pharmaceutical industry ease synthesis prospective molecule primary concern strongly affects cost manufacturing process required industrial-scale production. experiments paper synthetic accessibility generated focus libraries estimated using score. distributions values depicted supplementary figure medians listed table clearly seen property optimization significantly affect synthetic accessibility produced molecules. biggest shift distribution median observed minimization inhibition. less molecules high approximate cutoff systems difficult synthesize. opinion main reasons feasible include least current form reward function. first release model stable practically independent property optimization distribution follows commercially available compound space. second synthetic accessibility well-defined concept. process chemistry refers numerous factors determine ease synthesis particular molecule. include availability reagents number difficulty synthetic steps stability intermediate products ease separation reaction yields etc. however global score available. contrast method choice based molecular complexity defined number substructures molecular fragments. therefore direct optimization result substantially reduced novelty generated molecules bias toward substructures scores used train model. overall lack rigorous definition also makes determination comparison non-trivial task. despite active area research little progress achieved past years. summary devised executed strategy designing libraries compounds desired properties employs deep learning reinforcement learning approaches. termed method release reinforcement learning structural evolution conducted computational experiments demonstrated efficiency proposed release strategy single-task regime endpoints interest optimized independently. however system extended afford multi-objective optimization several target properties concurrently need drug discovery drug molecule optimized respect potency selectivity solubility admet properties. future studies address challenge. data. melting point dataset extracted literature physprop database used extract octanol/water partition coefficient logp diverse molecules. experimental data tested extracted chembl pubchem eidogen-sertanty compounds inconclusive values considered unreliable included modeling. data curation. compiled datasets compounds carefully curated following protocols proposed fourches briefly explicit hydrogens added specifics chemotypes aromatic nitro groups normalized using chemaxon standardizer. polymers inorganic salts organometallic compounds mixtures duplicates removed. modeling-ready curated dataset contained compounds logp compounds melting temperature. molecules stored normalized canonicalized smiles strings according procedures developed elsewhere predictive models. trained predictive models three different properties melting temperature logp jak. model consists embedding layer transforms sequence discrete tokens vector continuous numbers lstm layer units tanh nonlinearity dense layers units rectify nonlinearity function dense layer unit identity activation function. three models trained learning rate decay technique convergence. curated datasets divided training validation sets ratio. results accuracy model shown figure training. first stage pre-train generative model chembl dataset approximately drug-like compounds model capable producing chemically feasible molecules without property optimization. network units recurrent layer units stack augmentation layer. model trained epochs. learning curve illustrated figure generative model modes processing sequences training generating. time step training mode generative network takes current prefix training object predicts probability distribution next character. then next character sampled predicted probability distribution compared ground truth. afterwards based comparison cross-entropy loss function calculated parameters model updated. time step generating mode generative network takes prefix already generated sequences then like training mode predicts probability distribution next character samples predicted distribution. generative model update model parameters. second stage combine generative predictive model reinforcement learning system. system generative model plays role agent whose action space represented smiles notation alphabet state space represented possible strings alphabet. predictive model plays role critic estimating agent's behavior assigning numerical reward every generated molecule reward function numerical property calculated predictive model. stage generative model trained maximize expected reward. whole pipeline illustrated figure trained stack-augmented generative model. training dataset used chembl database drug-like compounds includes approximately million smiles strings. training selected molecules initial training dataset whose smiles notation lengths fewer characters. length chosen smiles training dataset characters fewer stack-augmented recurrent neural network section describes generative model details. assume data sequential means comes form discrete tokens i.e. characters. goal build model able predict next token conditioning previous tokens. regular recurrent neural network input layer hidden layer. time step neural network takes embedding vector token number sequence input models probability distribution next token given previous tokens next token sampled distribution. information previously observed tokens aggregated hidden layer. written following figure deep algorithm generating smiles strings compounds desired properties. training step generative stack-augmented rnn; generator step generative stack-augmented rnn. training input token character currently processed smiles string training set. model outputs probability vector next character given prefix. vector parameters optimized cross-entropy loss function minimization. generator regime input token previously generated character. next character sampled randomly distribution general pipeline reinforcement learning system novel compounds generation. scheme predictive model. model takes smiles string input provides real number estimated property value output. parameters model trained squared loss function minimization. vector hidden states vector hidden states previous time step input vector time step parameters input layers -parameter hidden layer activation function. stack memory used keep information deliver hidden layer next time step. stack type persistent memory accessed topmost element. three basic operations supported stack operation deletes element stack push operation puts element stack; also no-op operation performs action. element stack value stored position matrix vector stack control variables define next operation performed. equal value used replace element stack. equal value added rest values moved down. equals stack keeps value top. acknowledge support eshelman institute innovation award dod-onr acknowledges financial support skolkovo institute science technology. o.i. acknowledges extreme science engineering discovery environment award dmr- supported national science foundation grant number aci-. gratefully acknowledge support hardware donation nvidia corporation personally mark berger. also thank stephen cappuzzi technical discussions reading manuscript prior publication. data materials availability data needed evaluate conclusions paper present paper and/or supplementary materials. code datasets available github gawehn hiss schneider deep learning drug discovery. mol. inform. reker schneider schneider multi-objective active machine learning rapidly improves structure–activity models reveals protein–protein interaction inhibitors. chem. sci. zheng tropsha rational combinatorial library design. rational design targeted combinatorial peptide libraries using chemical similarity probe inverse qsar approaches. chem. inf. comput. sci. lipinski lombardo dominy feeney experimental computational approaches estimate solubility permeability drug discovery development settings. adv. drug deliv. rev. sakatsume kinases differentially associate alpha beta chains interferon gamma receptor form functional receptor unit capable activating stat transcription factors. biol. chem. beauman howard physprop database. syracuse res. syracuse wang pubchem bioassay update. nucleic acids res. eidogen-sertanty fourches muratov tropsha trust verify importance chemical structure curation cheminformatics qsar modeling research. chem model. figure distribution synthetic accessibility score full chembl database random subsample molecules zinc generated dataset molecules baseline generator model figure reward functions. logp optimization maximization melting temperature maximization benzene rings maximization minimization melting temperature minimization substituents maximization. igure distributions synthetic accessibility score experiments. melting temperature inhibition partition coefficient number benzene rings number substituents.", "year": 2017}