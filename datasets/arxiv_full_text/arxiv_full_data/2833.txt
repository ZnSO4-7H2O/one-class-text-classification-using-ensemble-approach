{"title": "Admissible Time Series Motif Discovery with Missing Data", "tag": ["cs.LG", "cs.AI", "stat.ML"], "abstract": "The discovery of time series motifs has emerged as one of the most useful primitives in time series data mining. Researchers have shown its utility for exploratory data mining, summarization, visualization, segmentation, classification, clustering, and rule discovery. Although there has been more than a decade of extensive research, there is still no technique to allow the discovery of time series motifs in the presence of missing data, despite the well-documented ubiquity of missing data in scientific, industrial, and medical datasets. In this work, we introduce a technique for motif discovery in the presence of missing data. We formally prove that our method is admissible, producing no false negatives. We also show that our method can piggy-back off the fastest known motif discovery method with a small constant factor time/space overhead. We will demonstrate our approach on diverse datasets with varying amounts of missing data", "text": "abstract discovery time series motifs emerged useful primitives time series data mining. researchers shown utility exploratory data mining summarization visualization segmentation classification clustering rule discovery. although decade extensive research still technique allow discovery time series motifs presence missing data despite welldocumented ubiquity missing data scientific industrial medical datasets. work introduce technique motif discovery presence missing data. formally prove method admissible producing false negatives. also show method piggy-back fastest known motif discovery method small constant factor time/space overhead. demonstrate approach diverse datasets varying amounts missing data. introduction time series motifs short approximately repeated patterns within longer time series dataset. fact patterns conserved often suggests underlying structure regularities exploited many ways. examples include rule discovery forecasting building better classifiers however despite decade active research known method allow discovery motif presence missing data. paradoxically spite improvements sensor technology missing data becoming prevalent. sensors cheap willing deploy hostile environments intermittent unreliable bandwidth many cases sensors become throwable disposable figure four-second long motif appears pitch contour time series cypriot folk song kotsini trantafillia note occurrences multiple instances missing data data could missing reasons. might meaningful i.e. vocalist produced sound times. also possible missing data reflects poor audio quality loose wires etc. agnostic issues work. simply note either case motif discovery algorithm defined literature data. imputation method running analysis unaltered. however shall demonstrate matter interpolation imputation method used matter current motif discovery algorithm used result false negatives. solve problem introduce novel algorithm allow false negatives. method allow occasional false positives since discovered motifs typically examined human subsequent analysis false positives filtered later stage. call algorithm motif discovery missing data mdms. mdms algorithm built recently introduced matrix profile data structure matrix profile-based motif discovery shown following advantageous features inherited proposed mdms simple parameter-free. contrast general motif discovery algorithms require building tuning spatial access methods and/or hash functions. requires inconsequential space overhead small constant factor. motifs dataset incrementally update efficiently. thus reasonable arrival rates effectively maintain exact motifs streaming data forever. algorithm easy parallelize multicore processors distributed systems. rest paper organized follows. section reviews related work introduces necessary background materials definitions. section introduce algorithms. section gives detailed empirical evaluation. finally section offer conclusions directions future work. related work background time series motif discovery active area research decade however best knowledge existing algorithm find motifs presence missing data. principle motif discovery algorithm could used missing data imputation algorithm fill missing values. hundreds imputation algorithms literature references therein) choose from matter obtain false negatives respect oracle data clearly pair perfect motif. suppose second value missing. obvious imputation technique interpolation neighbors missing data point giving amiss figure change means longer discover pair perfect trivial example easy matter imputation algorithm used using simple adversarial augment always construct datasets classic motif algorithms would produce false negatives. problem even severe complex datasets contain highfrequency patterns noise example seismology datasets. authors showed repeating earthquake patterns appeared approximately years apart. found handful missing data points earthquake samples would unable detect match common imputation method high-frequency noisy data defies assumptions imputation techniques assume. figure showed imputation methods produce possible false negatives even random single value missing data. moreover another disadvantage current imputation methods cannot predict block-missing data well circumstances malfunction sensor anomaly factors lose reading sensor consecutive timestamps often called block-missing data. authors proposed state-of-the-art spatial-temporal imputation method predict block-missing data learning real-valued reading sensor also reading several geographically nearby sensors. information sensors greatly improved imputation accuracy. however method apply access single sensor sensors contain block-missing data timestamps regional power outage communication errors. finally note problem artificial contrived anyway. literature replete examples data analysts frustrated inability perform motif discovery presence missing data. example recent paper studies recurrent water consumption behavior australian consumers authors observe small proportion hourly readings missing‚Ä¶ probably server failure maintenance. authors observe small proportion hourly readings missing‚Ä¶ probably server failure maintenance. authors realize imputation method used risk producing false negatives noting ‚Ä¶hourly water consumption highly unpredictable ignored points missing hours approximating missing readings. however solution ignoring data runs risk missing interesting patterns. last decade seen several distance measures handling uncertain time series including proud dust pbrq munich etc. might believe measures could used replace euclidean distance subroutine existing motif discovery algorithm. however believe possible following reasons methods assume missing data uncertain data. example address situation observation known precisely comes known distribution. example explicitly model normal exponential uniform error distributions. however generality wish make strong assumptions. even assume could somehow avail existing uncertain distance measure none metrics however speedup techniques exact motif discovery aware require exploit metric properties suggests must resort brute force search however proposed method thousands suggests three order magnitude time difference. finally want able guarantee search produces false negatives face missing data. best knowledge existing uncertain time series similarity measures support requirement. reader appreciate task-at-hand hard analogue problem strings trivial. suppose asked compare following text strings norwegian blue norwegian wood hamming distance encounter missing values represented easily compute lower upper bound hamming distance. former case would assume missing values word counterparts word. given letters sure differing lower bound three. latter case would assume missing values word different counterparts word. three pessimistic differences combined three observed differences give upper bound six. might consider applying similar logic here. example accumulating error first pair numbers error second pair etc. however critical difference time series must normalized comparison. because aside rare well understood exceptions meaningless compare time series without normalizing first. presents problem z-normalization requires know exact mean standard deviation data undefined single missing data point. generalize definitions allow possibly least value missing. clarity differentiate time series bar. keep common notation implementation purposes nans placeholder missing values. rest paper assume actual time series missing values created process. would obtained instead sensors functioning properly. know precisely ùë°ÃÖi= ‚â†nan. assume distance measured euclidean distance z-normalized subsequences unless otherwise stated rest paper always represent znormalized euclidean distance tjm. interested finding nearest neighbors subsequences closest pairs classic definition time series motifs note definition location distance profile zero close zero location. literature matches called trivial matches avoid matches ignoring exclusion zone length location query. practice infinity evaluating definition matrix profile time series vector euclidean distances subsequence nearest neighbor time series formally min‚Ä¶ min] distance profile time series figure top) distance profile created random subsequence created distance profiles possible subsequences element-wise minimum would matrix profile shown note lowest values location motif element matrix profile tells euclidean distance subsequence nearest neighbor time series however tell neighbor located. information recorded companion data structure called matrix profile index. clarity presentation confined work single dimensional case; however nothing work intrinsically precludes generalizations multidimensional data. briefly summarize section create meta time series matrix profile matrix profile index annotate time series distance location subsequences‚Äô nearest neighbors within itself. time series length recently introduced stomp algorithm able compute meta files mere time complexity space complexity enables fast motif discovery massive time series. however stomp algorithm applicable time series missing values claim mdms algorithm solve missing data problem time space complexity. leave detailed discussion algorithm section pseudo missing data introducing solution missing data problem take time point problem general assume consider generalization pseudo missing data informally define data technically missing effectively figure illustrates three kinds frequently encountered. enough produce data clearly artifact. likewise figure dramatic increase variance suggests section data likely faithfully represent underlying physical process. finally figure perfectly flat plateau reflective reality simply region physical process exceeds -bit precision available record three cases best thing would treat data missing. note decision domain-dependent; clearly domains short spike represents physical event perfectly flat plateau represents physical limitation quirk hardware/software use. algorithms intuitive preview begin previewing solution. shown used compute matrix profile finding motifs trivial. location smallest pair values matrix profile also location optimal motif pair. moreover definitions motifs top-k motifs range motifs also easily extracted matrix profile. given this solution missing data problem build special matrix profile using special matrix profile similar true matrix profile lower bound existing motif extraction algorithms pull motifs matrix profile false positives false negatives thus contribution outlined show build special matrix profile. lower bound matrix profile create special matrix profile data structure mdms algorithm evaluates z-normalized euclidean distance every pair subsequences within missing value time series depending whether subsequences missing values encounter three different situations. assume pair subsequences consideration ùëáùëóùëö. case neither contain missing value normally applies subsequence pairs within time series contains real-valued numbers nans. traditional exact z-normalized euclidean distance evaluated case. case missing values cases exact z-normalized euclidean distance cannot evaluated. however evaluate lower bound distance ùëáùëñùëöand min‚Å°. matter missing values guarantee actual distance less ready redefine definition context missing values. keep values corresponding case replace values corresponding unchanged cases obtain lower bound distance profile missing definition lower bound distance profile value time series vector ùëëÃÖùëñùëó=ùëëùëñùëó neither contains nans ùëëÃÖùëñùëó=ùëëùëñùëó similarly redefine definition definition context missing values. definition lower bound matrix profile missing value time series vector lower bound euclidean distances subsequence ùëáÃÖùëñùëö nearest possible neighbor formally shows cost filter false positive motifs matrix profile cannot afford occurrence false negatives since include important patterns time series. following sections introduce lower bounds corresponding cases respectively; introduce mdms algorithm evaluates lower bound matrix profile. lower bound euclidean distance case first consider case contains missing values vice versa. without loss generality assume subsequence contains missing values subsequence without missing values. figure shows visual example case. figure top) subsequence missing values. bottom) subsequence without missing values. {ùëò‚Å°|‚Å° ùëö‚Å°and‚Å°ùë°ùëñ+ùëò‚àí ùëÅùëéùëÅ‚Å°} locations missing values within {ùëò‚Å°|‚Å° ùëö‚Å°and‚Å°ùë°ùëñ+ùëò‚àí ùëÅùëéùëÅ‚Å°and‚Å°ùë°ùëó+ùëò‚àí ùëÅùëéùëÅ‚Å°} intersection real-valued locations within within evaluate lower bound distance subsequences first need z-normalize assume and‚Å°ùúéùëñ mean standard deviation and‚Å°ùúéùëó mean standard deviation ùëáùëóùëö. note missing values cannot evaluate ùúáùëñ‚Å°and however treat variables. assume distance oracle subsequence easily obtain lower bound distance ignoring missing part figure figure diligent reader noticed lower bound subsumes lower bound expression expression case visualize figure remove problem transformed case therefore directly substitute result case dependent ‚Å°ùëëùëñùëó missing part figure larger smaller ‚Å°ùëëùëñùëó becomes zero. note large case ‚Å°ùëëùëñùëó undesirable lower bound pair missing value subsequences reported motif even look different other. figure shows example this. figure subsequences missing values. real-valued parts subsequences look different other fill missing parts infinitely large numbers z-normalized euclidean distance subsequences become zero. fortunately sensor readings normally physical limits. accelerometer values iphone limited virtually medical sensors come carefully specified limits meet regulations etc. therefore assume missing values bounded bound complete derivation) shown figure assume mean standard deviation standard deviation figure visualizes note offset scale fixed figure obtain adjust line evaluate maximum minimum values real-value part every subsequence lines evaluate mean standard deviation every subsequence lines initialize product vectors. initialize lower bound matrix profile matrix profile index line lines iteratively evaluate lower bound distance profile update necessary. calculatelbdistance algorithm lines shown table algorithm calculatelbdistance input length time series subsequence length maximum/minimum possible value vector vmax/vmin product vectors means standard deviations time series current subsequence index output lower bound distance profile n-m+ //ùúáùëñ //ùúéùëñ qbui sqrt qb==m case ‚Üê√óm√ó else maxŒºb)== //case Œºb>Œºb vo‚Üêvi v‚ÜêœÉz^ else vo‚Üêvj v‚ÜêœÉz^ else else //case v‚Üêvmax v‚Üêvmin c‚Üêv‚Äìv b‚Üêv√óv a‚Üêv+v ur‚ÜêŒºz/Œºb vr‚Üê^+Œºz^)/Œºb-ur^ f=vi/√ó)+c^/) v‚Üêvmax v‚Üêvmin c‚Üêv‚Äìv b‚Üêv√óv a‚Üêv+v ur‚ÜêŒºz/Œºb vr‚Üê^+Œºz^)/Œºb-ur^ f=vj/√ó)+c^/) else calculatelbdistance algorithm evaluates n-m+ lower bound distance values equations line evaluates case handled lines lines handle case case evaluated lines table evaluated time time complexity calculatelbdistance space needed store vectors table loop lines table takes time. therefore time complexity mdms algorithm space complexity stomp analysis case complete. finally completeness briefly discuss case case neither contain missing value case exact z-normalized euclidean distance using following equation mdms algorithm stomp algorithm obtain matrix profile time series free missing values time space; show face missing data mdms algorithm obtain lower-bound matrix profile time space complexity. table summarizes algorithm. algorithm mdms input missing value time series subsequence length output lower bound matrix profile associated lower bound matrix profile index length n-m+ vmax slidingmax vmin slidingmin padzero onezero elementwisesquare computemeanstd computemeanstd slidingdotproduct qz_first //see slidingdotproduct qb_first //see slidingdotproduct bz_first //see slidingdotproduct zb_first zb//see slidingdotproduct bx_first //see slidingdotproduct xb_first //see calculatelbdistance ones initialization in-order evaluation downto update product qz-z√óz+z√óz qb-b√ób+b√ób bz-b√óz+b√óz zb-z√ób+z√ób bx-b√óx+b√óx xb-x√ób+x√ób discussing algorithm detail first need introduce three important auxiliary time series define ùëÅùëéùëÅ. simply obtain filling zeros locations data missing. furthermore unlike imputation algorithms mdms algorithm extremely model-free parameterfree. inputs algorithm time series subsequence length. next section case studies demonstrate robustness efficacy ultra-fast parameter-free motif discovery algorithm face missing data. next consider larger gaps case. here instead removing individual data points removed consecutive blocks length shown figure shape lower bound matrix profile still looks similar oracle matrix profile deep valleys vicinity motifs false positive patterns discovered. test robustness algorithm false negatives removed block missing data center second earthquake pattern. length missing block subsequence length. figure compared lower-bound matrix profile result matrix profile generated linear imputation. case study seismological data repeated pattern discovery fundamental tool seismology allows discovery foreshocks triggered earthquakes swarms volcanic activity induced seismicity however domain replete missing data. example classic paper notes frequent dilemma spectral analysis incompleteness data record either form occasional missing data larger gaps experiment demonstrate handle cases. consider dataset know answer external sources. april earthquake magnitude sonoma county california. then december years later another earthquake similar magnitude. allow results visualized single plot edited data earthquakes happen seconds apart. subsequence length corresponds second data. shown figure missing data matrix profile correctly discovers locations earthquakes. figure seismograph contrived earthquakes region happen seconds apart. matrix profile computed missing data finds true event mdms even presence missing points missing blocks test algorithm occasional missing data case randomly deleted data points. figure shows matrix profile still minimized correct location false positives finds true event mdms even presence large missing block. matrix profile generated linear imputation fails capture minimum points within oracle matrix profile. lower-bound matrix profile generated mdms algorithm agrees closely oracle matrix profile vicinity earthquake patterns matrix profile generated linear imputation shows high value locations. result mdms algorithm successfully captures motif even presence large missing block within earthquake pattern imputation method misses motif within oracle data. illustrates major strength algorithm imputation methods. firstly algorithm allow false negatives. secondly algorithm robust large missing blocks change data imputation method change data lot. next case study demonstrate robustness mdms presence missing blocks. case study activity data video time series extracted video often missing data reflecting frame drops bandwidth congestion test algorithm context examine activity dataset dataset consists minute -fps video sequence actor performing various activities. data original authors extracted channels optical flow time series length time series consider time series corresponding channel suggestive structure places noisy. data shown figure .top subsequence length oracle matrix profile figure extract motif oracle data. test performance mdms algorithm remove consecutive data points center motif patterns. figure compare lower-bound matrix profile result matrix profile generated linear imputation figure activity time series. removed consecutive data points motif patterns time series. oracle matrix profile computed missing data finds true motif starting data points. presence missing data points mdms algorithm finds motif oracle result starting data points. matrix profile generated linear imputation fails capture deep valleys within oracle matrix profile thus misses motif. oracle matrix profile shows apparent valleys locations motif lower bound matrix profile generated mdms motif discovered mdms algorithm identical oracle motif contrast matrix profile generated imputation valleys thus misses motif oracle data. figure though large portion blue pattern missing mdms algorithm still finds similar pattern. example demonstrates algorithm robust missing true motif patterns. quantifying robustness mdms mdms evaluates lower bound matrix profile naturally allow false negatives produce false positives. perform stress tests evaluate robustness limitations mdms algorithm false positives. first test sensitivity mdms length missing blocks. remove missing blocks length located respectively data. figure show lower bound matrix profile varies increase figure lower bound matrix profiles corresponding different missing block lengths. removed blocks length seismograph. oracle matrix profile finds true motif. mdms able find true event motif. mdms finds false positive motif. note removed blocks within repeated earthquake patterns. result lower bound matrix profiles oracle matrix profile vicinity repeated patterns lower locations. words easier detect false positives setting. side valleys oracle matrix profile become deeper side valleys show vicinity removed blocks. increases side valleys become deeper deeper. able find true event motif mdms. however motif longer true event. show false positive motif pair figure subsequences vicinity second missing block figure close inspection pair reported motif mdms. fill missing part subsequence counterpart subsequence similar other. since mdms allow false negatives capture report possible matching pair. furthermore figure implies cannot larger subsequence length otherwise mdms able find perfect match already close limit. therefore figure deep side valleys vicinity missing blocks prone detect false positives. main valleys corresponding true events dominate detect false positives. demonstrated mdms robust discovering false positives missing blocks length blocks within reasonable range. next stress test sensitivity mdms total number missing values data. seismograph dataset figure lower bound matrix profiles corresponding various percentage data missing. left) random-missing data right) blockmissing data. first randomly selected points remove data. figure .left scale matrix profile decreased points missing. however even data missing valleys corresponding true events still dominate. second removed blocks length data. missing blocks uniformly distributed number missing blocks increased figure .right shows even data missing main valleys still dominate. data missing main valleys longer apparent still find true events motif. experiment demonstrates mdms robust detecting false positives even large percentage data missing. conclusions introduced believe first time series motif discovery algorithm find motifs presence missing data. algorithm time space complexity fastest known algorithm motif discovery formally proved admissibility algorithm produce false negatives. experimental results show algorithm also robust false positives even large portion data missing. algorithm based creating special version matrix profile work implications algorithms exploit matrix profile including discord discovery time series joins. lower bounds introduced also used accelerate various length motif discovery. leave considerations future work. buza schmidt-thieme motif-based classification time series bayesian networks svms. advances data analysis data handling business intelligence mcgovern rosendahl d.h. brown r.a. droegemeier k.k. identifying predictive multi-dimensional time series motifs application severe weather prediction. data mining knowledge discovery mueen keogh cash westover exact discovery time series motifs. neocleous petkov schizas finding repeating stanzas monophonic folk songs cyprus. cyprus workshop signal processing informatics patnaik manish sharma ramakrishnan sustainable operation management data center chillers using temporal data mining. rakthanmanon searching mining trillions time series subsequences dynamic time warping. sarangi murthy dust generalized notion similarity uncertain time series. shokoohi-yekta chen campana zakaria keogh discovery meaningful rules time series. song w.z. huang shirazi lahusen air-dropped sensor network real-time highfidelity volcano monitoring. proceedings international conference mobile systems applications services", "year": 2018}