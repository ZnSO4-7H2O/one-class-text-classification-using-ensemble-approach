{"title": "Makeup like a superstar: Deep Localized Makeup Transfer Network", "tag": ["cs.CV", "cs.AI"], "abstract": "In this paper, we propose a novel Deep Localized Makeup Transfer Network to automatically recommend the most suitable makeup for a female and synthesis the makeup on her face. Given a before-makeup face, her most suitable makeup is determined automatically. Then, both the beforemakeup and the reference faces are fed into the proposed Deep Transfer Network to generate the after-makeup face. Our end-to-end makeup transfer network have several nice properties including: (1) with complete functions: including foundation, lip gloss, and eye shadow transfer; (2) cosmetic specific: different cosmetics are transferred in different manners; (3) localized: different cosmetics are applied on different facial regions; (4) producing naturally looking results without obvious artifacts; (5) controllable makeup lightness: various results from light makeup to heavy makeup can be generated. Qualitative and quantitative experiments show that our network performs much better than the methods of [Guo and Sim, 2009] and two variants of NerualStyle [Gatys et al., 2015a].", "text": "figure system functions. recommend suitable makeup before-makeup face transfer foundation shadow gloss reference before-makeup face. lightness makeup tuned. better view ﬁgures paper please refer original color special attention shadow gloss foundation transfer. mouth shapes suitable similar makeups given before-makeup face visually similar face reference dataset. similarity measured euclidean distance deep features produced off-the-shelf deep face recognition network recommendation personalized data-driven easy implement. second function makeup transfer reference face before-makeup face. makeup transfer function satisfy criteria. complete functions consider three kinds commonly used cosmetics i.e. foundation shadow gloss. note model quite generic easily extended types cosmetics. cosmetic speciﬁc different cosmetics transferred ways. example maintaining shape important shadow rather foundation. localized cosmetics applied locally corresponding facial parts. example gloss shadow worn eyelid. naturally looking cosmetics need seamlessly fused before-makeup face. words after-makeup face look natural. controllable makeup lightness change lightness type cosmetic. paper propose novel deep localized makeup transfer network automatically recommend suitable makeup female synthesis makeup face. given before-makeup face suitable makeup determined automatically. then beforemakeup reference faces proposed deep transfer network generate after-makeup face. end-to-end makeup transfer network several nice properties including complete functions including foundation gloss shadow transfer; cosmetic speciﬁc different cosmetics transferred different manners; localized different cosmetics applied different facial regions; producing naturally looking results without obvious artifacts; controllable makeup lightness various results light makeup heavy makeup generated. qualitative quantitative experiments show network performs much better methods variants nerualstyle introduction makeup makes people attractive commercial facial makeup systems market. virtual hairstyle provides manual hairstyle try-on. virtual makeover taaz offers pre-prepared cosmetic elements lipsticks liners. however softwares rely pre-determined cosmetics cannot meet users’ individual needs. different existing work goal design real application system automatically recommend suitable makeup female synthesis makeup face. shown figure simulate applicable makeup process functions. ﬁrst function makeup recommendation personalization taken special cares. speciﬁcally females similar face gions corresponding facial parts. therefore unnatural results avoided. related work introduce related makeup transfer methods representative deep image synthesis methods. figure proposed deep localized makeup transfer network contains sequential steps. correspondences facial part cosmetic built based face parsing network. shadow foundation gloss locally transferred global smoothness regularization. shown figure network transfers makeup recommended reference face before-makeup face. firstly before-makeup reference faces face parsing network generate corresponding labelmaps. parsing network based fully convolutional networks emphasizing makeup relevant facial parts shadow considering symmetry structure frontal faces. based parsing results local region before-makeup face corresponds counterpart reference face. secondly three common cosmetics shadow gloss foundation transferred manners. example keeping shape important transferring shadow smoothing skin’s texture important foundation. shadow transferred directly altering corresponding deep features foundation transferred regularizing inner product feature maps after-makeup face initialized before-makeup face gradually updated stochastic gradient descent produce naturally looking results. tuning weight cosmetic series after-makeup faces increasingly heavier makeup generated. system produce various results controllable makeup lightness. facial makeup studies work ﬁrst attempt makeup transfer task. ﬁrst decomposes before-makeup reference faces three layers. then transfer information corresponding layers. major disadvantage needs warp reference face before-makeup face challenging. scherbaum propose morphable face model facilitate facial makeup. also requires before-after makeup face pairs person difﬁcult collect real appli propose cosmeticcation. tong transfer procedure realistically transfer cosmetic style captured example-pair another person’s face. requirement before-after makeup pairs limits practicability system. propose automatic makeup recommendation synthesis system called beauty e-expert. contribution recommendation module. method greatly relaxes requirements traditional makeup methods generates naturally-looking results. compared traditional makeup transfer methods require complex data preprocessing annotation results inferior contributions follows. best knowledge ﬁrst makeup transferring method based deep learning framework produce natural-looking results. system transfer foundation shadow gloss therefore complete functions. furthermore lightness makeup controlled meet needs various users. propose end-to-end deep localized makeup transfer network ﬁrst build part cosmetic correspondence transfer makeup. compared nerualstyle fuses images globally method transfers makeup locally cosmetic redeep image synthesis methods recently deep learning achieved great success fashion analysis works dosovitskiy generative generate images objects given object type generate image visualizes notion class captured net. mahendran contribute general framework invert hand-crafted deep representations images. gatys present parametric texture model based synthesise high-quality natural textures. generative adversarial network consists components; generator discriminator. generated image natural without facial parts cosmetics correspondence order transfer makeup need build correspondence facial parts before-makeup face cosmetic regions reference face. result cosmetic matched pairs. correspondences obtained face parsing results e.g. gloss. exception shadow transfer. before-makeup face shadow region shape eyes different need warp shadow shape reference face. face parsing face parsing model based fully convolution network trained using before-makeup reference faces. parsing labels shown table network takes input arbitrary size produces correspondinglysized output efﬁcient inference learning. training face parsing model attention makeup relevant labels. example compared background bias toward left shadow. therefore propose weighted cross-entropy loss weighted spatial dimensions ﬁnal layer cross entropy loss deﬁned pixel. ground truth predicted label pixel label weight. weight empirically maximizing score validation set. faces collected datasets frontal view preprocessed face detection alignment. testing phase enforce symmetric prior replace prediction conﬁdence point horizontally mirrored counterparts average symmetric prior added testing phase currently. explore enforce structure prior training phase. figure shows parsing results original weighted symmetric weighted fcn. vious artifacts. goodfellow introduce simple fast method generating adversarial examples. main enhance training instead image synthesis. kulkarni present deep convolution inverse graphics network learns interpretable representation images rendering. existing deep methods generate image. however mainly focus generate image nature input images. recently deep learning techniques applied many image editing tasks image colorization photo adjustment ﬁlter learning image inpainting shadow removal super-resolution methods operated single image. nerualstyle similar synthesis image combining structure layer image style layers another. difference work network applied locally produce natural results. approach section sequentially introduce makeup recommendation makeup transfer methods detail. makeup recommendation important criterion makeup recommendation personalization females look like suitable similar makeups. given before-makeup face several similar faces reference dataset. similarities deﬁned euclidean distances deep features extracted feeding face off-the-shelf face recognition model named vgg-face. deep feature concatenation normalized layers. vgg-face model trained based vgg-verydeep- architecture aims accurately identify different people regardless whether puts makeup meets requirement. therefore extracted features capture discriminative structure faces. finally retrieved results serve reference faces transfer cosmetics before-makeup face. figure shows makeup recommendation results. illustrates recommended reference faces similar facial shapes before-makeup faces therefore recommendation personalized. labels eyebrow inner mouth shadow up/low background face subsets table labels before-makeup reference face sets certain labels belong dataset certain labels shadow belong reference face only. stands left right upper lower respectively. therefore need generate shadow mask before-makeup face. moreover shapes eyes brows different face pair shape shadow need slightly warped. speciﬁcally landmarks eyes brow regions including inner upper-middle lower-middle outer corner eyes brows. shadows warped thin plate spline here number layers used. technically layers including conv- conv- conv- conv- conv-. gram matrix rnl×nl deﬁned number feature maps l-th layer inner product vectorised feature layer figure exemplars gloss transfer results. before-makeup reference after-makeup shown. structure preservation term deﬁned difference every elements overall makeup transfer considers shadow gloss foundation also preserves face structure. makeup transfer makeup transfer conducted based correspondences among image pairs. next elaborate transfer shadow gloss foundation. keeping facial structure also considered incorporated ﬁnal objective function. shadow transfer needs consider shape color. take left shadow example. right shadow transferred similarly. suppose binary mask left shadow reference face warped binary mask before-makeup face. note shadow warping shape size. technically shadow transfer replace sb’s deep feature representation certain layer mathematical form loss left shadow transfer height width channel rh×w×c input image. d-dim feature representation conv- layer face parsing model after-makeup face reference face respectively. achieved mapping data layer conv- layer convolutional feature masking shadow regions corresponding masks similarly deﬁne loss function right shadow results shadow transfer shown figure color shape shadows transferred. weighed average last several gradients decaying factor initialized before-makeup face. experiments experimental setting data collection parameters collect dataset before-makeup faces reference faces. before-makeup faces nude makeup light makeup. among faces before-makeup faces reference faces randomly selected test set. remaining faces faces used training validation set. given before-makeup test face similar ones among reference test faces chosen transfer makeup. weights weights different labels weighted {eyebrows eyes shadows} {lip inner mouth} {face background} respectively. weights empirically validation set. baseline methods best knowledge makeup transfer work also compare variants gatys al.’ method synthesis image combining content layer image style layers another image. ﬁrst variant called nerualstyle-cc treating before-makeup reference figure qualitative comparisons state-of-thearts ours. faces content. another variant named nerualstyle-cs uses before-makeup content reference face style. cannot compare related makeup methods tong scherbaum beauty e-expert system require before-and-after makeup image pairs information extensive labeling facial attributes. proposed model transfer makeup seconds image pair using titan gpu. makeup lightness order show method generate after-makeup face various makeup lightness ranging light makeup dark makeup gradually increase certain makeup weights four results shown figure ﬁrst rows before-makeup reference faces. girl’s shadows become gradually darker ﬁrst row. second color becomes redder cosmetics keep unchanged. third fourth rows show another example. shadow gloss increasingly darker third last respectively. comparison state-of-the-arts compare nerualstyle-cc nerualstyle-cs follwing evaluation metric comparison conducted qualitatively quantitatively. qualitative results shown figure produce naturally looking results. however result transfers gloss shadows lightness reference faces always transfers much lighter makeup reference face. example ﬁrst gloss reference face results deep red. gloss orange-red. addition shadows reference face results dark smoky. however produce light shadow. compared nerualstyle-cc nerualstyle-cs after-makeup faces contain much less artifacts. makeup transfer conducted local regions gloss nerualstyle-cc nerualstyle-cs transfer makeup globally. global makeup transfer suffers mismatch problem image pair. shows advantages deep localized makeup transfer network. quantitative comparison mainly focuses quality makeup transfer degree harmony. before-makeup test faces similar reference faces found. thus totally after-makeup results makeup transfer method. compare method baselines sequentially. time -tuple i.e. before-makeup face reference face after-makeup face method after-makeup face baseline sent participants compare. note after-makeup faces shown random order. participants rate results degrees much better better same worse much worse. percentages degree shown table method much better better cases. much better nerualstyle-cc nerualstyle-cs cases. figure reference face select similar looking before-makeup girls. makeup applied different before-makeup girls. shows shadow gloss foundation transferred successfully face areas. note method handle makeup transfer different facial expressions. example figure second girl left panel grinning. however reference face smiling. thanks localization property method gloss transfer teeth after-makeup face. figure before-makeup face select similar looking reference girls. function quite useful real application users virtually different makeup choose favorite one. paper propose novel deep localized makeup transfer network automatically transfer makeup reference face before-makeup face. proposed deep transfer network nice properties complete function cosmetic speciﬁc localized producing naturally looking results controllable makeup lightness. extensive experiments show network performs better stateof-the-arts. future plan explore extensibility network. example before-makeup face combined reference faces. after-makeup face shadow reference face gloss anreference face. acknowledgments work supported national natural science foundation china talents programme chinese academy sciences strategic priority research program chinese academy sciences references fred bookstein. principal warps thin-plate splines decomposition deformations. ieee transactions pattern analysis machine intelligence iasonas kokkinos kevin murphy alan yuille. semantic image segmentation deep convolutional nets fully connected crfs. international conference learning representations chao dong chen change kaiming xiaoou tang. learning deep convolutional network european conference computer image super-resolution. vision pages alexey dosovitskiy jost tobias springenberg thomas brox. learning generate chairs convolutional neural networks. computer vision pattern recognition pages leon gatys alexander ecker matthias bethge. texture synthesis controlled generation natural stimuli using convolutional neural networks. advances neural information processing systems jean pouget-abadie mehdi mirza bing david warde-farley sherjil ozair aaron courville yoshua bengio. generative adversarial advances neural information processing systems nets. pages kaiming xiangyu zhang shaoqing jian sun. spatial pyramid pooling deep convolutional networks visual recognition. ieee transactions pattern analysis machine intelligence xiaodan liang xiaohui shen jianchao yang luoqi jian dong liang shuicheng yan. deep human parsing active template regression. pattern analysis machine intelligence ieee transactions luoqi junliang xing zhou shuicheng yan. beautiful today transactions multimedia computing communications applications xiaodan liang luoqi xiaohui shen jianchao yang changsheng liang xiaochun shuicheng yan. matching-cnn meets quasi-parametric human parsing. proceedings ieee conference computer vision pattern recognition omkar parkhi andrea vedaldi andrew zisserman vedaldi lenc jaderberg simonyan vedaldi zisserman lenc deep face recognition. british machine vision conference kristina scherbaum tobias ritschel matthias hullin thorsten thorm¨ahlen volker blanz hanspeter seidel. computer-suggested facial makeup. computer graphics forum volume pages karen simonyan andrea vedaldi andrew zisserman. deep inside convolutional networks visualising image classiﬁcation models saliency maps. corr wai-shun tong chi-keung tang michael brown ying-qing example-based cosmetic transfer. computer graphics applications pages jimmy qiong renjie liao jiaya jia. deep edge-aware ﬁlters. international conference machine learning pages", "year": 2016}