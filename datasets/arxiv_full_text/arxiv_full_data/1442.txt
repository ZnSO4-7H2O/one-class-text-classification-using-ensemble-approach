{"title": "A Distance Oriented Kalman Filter Particle Swarm Optimizer Applied to  Multi-Modality Image Registration", "tag": ["cs.NE", "cs.CV", "cs.LG", "math.OC"], "abstract": "In this paper we describe improvements to the particle swarm optimizer (PSO) made by inclusion of an unscented Kalman filter to guide particle motion. We demonstrate the effectiveness of the unscented Kalman filter PSO by comparing it with the original PSO algorithm and its variants designed to improve performance. The PSOs were tested firstly on a number of common synthetic benchmarking functions, and secondly applied to a practical three-dimensional image registration problem. The proposed methods displayed better performances for 4 out of 8 benchmark functions, and reduced the target registration errors by at least 2mm when registering down-sampled benchmark brain images. Our methods also demonstrated an ability to align images featuring motion related artefacts which all other methods failed to register. These new PSO methods provide a novel, efficient mechanism to integrate prior knowledge into each iteration of the optimization process, which can enhance the accuracy and speed of convergence in the application of medical image registration.", "text": "abstract—in paper describe improvements particle swarm optimizer made inclusion unscented kalman filter guide particle motion. demonstrate effectiveness unscented kalman filter comparing original algorithm variants designed improve performance. psos tested firstly number common synthetic benchmarking functions secondly applied practical three-dimensional image registration problem. proposed methods displayed better performances benchmark functions reduced target registration errors least registering downsampled benchmark brain images. methods also demonstrated ability align images featuring motion related artefacts methods failed register. methods provide novel efficient mechanism integrate prior knowledge iteration optimization process enhance accuracy speed convergence application medical image registration. optimization component many practical scientific computing problems. used search optimum value pre-defined fitness function measure within problem space typical global optimization method particle swarm optimization paid significant attention last decades less prone becoming trapped local optima. various improvements suggested original algorithm improve convergence computation speed. converge local optima exhibit better measurement values. local optima significant distance global optimum thereby causing image registration fail. deal special type application paper introduce novel distance-oriented guided unscented kalman filter method encode prior knowledge distribution fitness function within problem space tends stretch optimizer converge point near true global optimum. image registration algorithms often based premise magnitude chosen similarity metric related magnitude error current spatial transform optimal spatial transform images assuming distribution similarity metric function approximately unimodal propose customized ukf-pso framework derived bayesian perspective ukf-pso algorithm iteratively estimates global optima accumulated information probability distributions similarity measurements. leads faster convergence improved robustness local optima large search space. another advantage approach ease multiple similarity metrics combined extension nested ukf-pso removes need apply fixed weights different similarity metrics adaptively adjusting weighting convergence process kalman filter. proposed methods compared several popular methods using popular benchmark functions well publicly available medical image registration dataset. ukfhowever neither original method existing modifications derived advantage available prior knowledge problem space critical role specific applications. goal many optimization problems searching optimal value fitness function. typical example issue presented problem associated image registration distance real global optima rather value measurement function important. small fitness differences large distances problem space actually image transformation parameters turn falsely indicate alignment images. prior knowledge content image ignored favour result value-oriented optimization process tend fig. fitting gaussian function distribution mutual information within three different searching ranges. gaussian function tends give accurate estimation distribution within smaller searching range. fig. hidden markov model hidden observed states. qpso another popular approach hybridize optimization methods example genetic algorithm simplex comparisons reviews major variants found wachowiak’s method provides registration-specific prior knowledge approach requires precise initialization. methods exploit prior knowledge include bare bones kalman filter andras' gaussian based bayesian interpretation methods either provide probabilistic perspective particle status mechanism integrate prior knowledge. fitness function optimization process search problem space gives optimal value problem targeted paper image registration predefined similarity measure images possible image transformations limited degrees freedom. purpose optimization formulated optimal solution purpose registration find gives optimal image transformation parameters leads highest similarity images. however presence local optima often difficult find. case returned close possible simulates social cooperative behavior swarm potential solutions called particles potential solution corresponds position problem space. particle explores problem space individual random speed partially affected combined knowledge up-to-date global local optima. searching global optima d-dimension problem space particles iteration solution represented position particle d-element vector x𝑖𝐷} original method widely used formula updating speeds particles given paper important previous work attempts solve similar image registration problems using original modified versions briefly reviewed section theory ukf-pso n-ukfpso methods introduced section iii. sections describe details ukf-pso n-ukf-pso. experiments performed benchmark functions publicly available image registration dataset shown sections discussed section viii. local global optimization methods applied solve image registration problems. local optimization suffers becoming trapped local optima. multi-resolution image pyramids partially mitigate this however global optimum represented down-sampled problem spaces case optimizer still converge local optima among global optimization methods evolutionary computation plays important role. example inspired social cooperative behavior kennedy eberhart proposed first algorithm mid-s since number modified versions developed applied different image registration applications research efforts concentrated improving convergence speed robustness problem spaces large exhibit multiple local optima. extensions methods either alternative neighbourhood structures novel particle evolution strategies widely used using alternative particle evolution formulae quantum behaved formulae redesigned revised qpso diversity controlled rqpso chaotic search fig. information available iteration hidden state represents optimal estimation true global optimum; observed state defined average position particles weighted measured fitness function particle. estimation hidden state produced fitting gaussian function iteration optimization process. iteration obtained combining 𝒙̂𝑔. solving optimization problem using linear kalman filter treated output 𝑡𝑖𝑚𝑒 𝑢𝑝𝑑𝑎𝑡𝑒 stage output 𝑚𝑒𝑎𝑠𝑢𝑟𝑒𝑚𝑒𝑛𝑡 𝑢𝑝𝑑𝑎𝑡𝑒 stage optimal solution. thus registration problem similarity measure considered non-normalized probability. probability distribution whole search range interpolated using multiple gaussian bases. andras provides framework integrate prior knowledge image registration form paper simplified definition based prior knowledge specific image registration. result need calculate probability distribution different assumptions dependences particles directly fitted using evaluation particles. target registration error often ground truth metric image registration problems. zero perfectly aligned images. generalize this optimal transformation represented point problem search space results closest zero. whole search range similarity measure transformation represented particle distance measure similarity measure considered monotonic mapping distance simply assume form gaussian function assumption prior knowledge indicates follows gaussian-like distribution unknown expectation advantage using gaussian form equals expectation whole problem space. iteration estimated optimum value within area searched particles. here rather directly selecting optimum value among particles estimated global optimum calculated average weighted normalized defined equation inertia weight local best solution found particle best up-to-date global optimum. acceleration constants weight attraction local global optima particle random generated numbers drawn uniform distribution range updated particle positions given quation consists three components previous velocity cognition component 𝑐𝑝𝑟𝑝 combination components compound velocity moves particles towards local global optima preventing significant deviations particles' previous directions mechanism makes stepwise improvement algorithm convergence particles moved small constrained area global best position remains unchanged certain number iterations. coefficients appear formula common modifiable parameters swarm size searching range maximum number iterations. complicated presents multiple local optima common image registration applications still suffers premature convergence. integration prior knowledge problem space particle evolution formulae improve robustness pso. andras proposed gaussian model based bayesian interpretation. model evaluated fitness value given noise distribution added noise-free fitness value following bayesian theory likelihood given form probability density function defined search range. given calculated using calculated t-th iteration. calculation performed based assumption evaluated fitness values particles either codependent independent leading implementations bayesian gaussian pso. fitness function assumed proportional probability point search range iteration encoded observed state based theory desired hidden state represents ideal location speed particle leads better fitness prior knowledge discussed define average weighted noise-free fitness function directly define estimation hidden state given iteration. however prior knowledge registration problems integrated calculated using equation much simpler adopted here using information demonstrated fig. iterations hidden state ideal position closer equals observation directly defined 𝒙̂𝑔. iteration current estimation hidden state based observation. obtain estimation relationship depicted instance hidden markov model shown fig. hidden state evolves time based state transition model influences observable state known observation model transition model reflects estimated global optimum moves closer locations better fitness observation model described model influence upon 𝒙̂𝑔. defining average weighted shown fig. specified evolution depends movements every particle. assumes either highly non-linear state transition process hidden state assumes identical state transition. cases observation model identical mapping. influence inherently noisy noise used subjective uncertainty model accuracy observation based prior knowledge integrated current state modeled gaussian distribution mean variance models strong likelihood reflects 𝒙𝑔∗. goal registration process reduce uncertainty likelihood lowest level thus give accurate prediction. since prediction produced combining information particles previous iterations applicable different methods different velocity position updating mechanisms. global optima improve search range contracts shown fig. searching algorithm converges ideally gaussian function becomes dirac delta function. equation solved fitting shape using quadratic least squares method though introduce much greater computational complexity. purpose fitting gaussian function obtain estimated global optimum used optimization processes. weighted mean particles obtained iteration estimate initial global optimum i.e. estimation global optimum move towards true global optimum similarity measure search range contracts optimization process. important assumption easy achieve normalization. specific image registration problems images aligned minimizing difference measure denoted convert similarity measure function search range. summary iteration noisy estimation global optimum obtained using improved evolutionary process combining information particles previous iterations. calculated using replace formulae moves closer optimum however integrated prior knowledge estimation search range improved accumulating information obtained previous iterations. achieved dynamic bayesian network presented monson seppi's kalman filter used characterize time-sensitive relationship observable hidden states. image registration problems using swarm optimization global local optima obtained complicated state transition function. hence propose novel unscented kalman filter rather estimate arbitrary transition function does approximates gaussian probability distribution using standard vector matrix operations based weighted sigma points iteration d-dimensional problem space sample mean covariance sigma points specifically sigma points associated weights selected weight associated sigma point. details select weighting parameter found work follow uhlmann’s recommendation kalman update stage sigma point instantiated state transition function recursively estimate state process minimizing mean square error kalman filter models predictor-corrector circle state-transition observation noisy processes additive gaussian noise. registration problem assuming prediction time-update stage prediction given matrix representation state transition function mean variance predicted respectively covariance state-transition noise. assuming identity matrix. correction measurement-update stage estimation state refined using observation kalman gain iteration used balance influence prediction observation observation matrix identity mean variance estimation respectively. estimate global optimum based following probability distribution using non-linear state transition model shown fig. lds. case non-linear extensions kalman filter applied deal non-linear state transition process extended kalman filter standard method dealing non-linear processes. however requires calculation jacobian matrix difficult image registration performed using different types similarity measures well different features. order combine different features measures must assign suitable weighting normalize comparable scales. benefit proposed model using prior knowledge fitness values similarity measure automatically normalized samples probability distribution maps measures uniform scale. shown fig. case similarity measures estimation global optimum output using measure intuitively considered second associated measure. ukfs share population particles optimization process means particle obtains fitness values iteration. framework extended using multiple nested ukfs allow number features similarity measures guide optimization. outputs three implementations include estimated hidden state variance reflects estimation error. discussed sections accuracy estimation global optimum given weighted average dependent size search region positioning true global optimum. furthermore extensions generally behave like low-pass filters means high frequency information filtered well noise. case reliable rapid model formulated acceleration constant weighting attraction estimated hidden state output randomly generated number drawn uniform distribution range component 𝑐𝜃𝑟𝜃) introduced equation controls influence estimated hidden state orientation particles. acceleration constants need adjusted non-lds assumption since uncertainty associated estimated global optimum related distribution particles simply either sample particles together estimated global optimum sigma points ukf. allows number sigma points greater makes integrating convenient. addition traditional stopping criteria used additional evidence convergence situation pso. procedure combined predict-correct circle kalman filter. non-lds cases ukf-pso algorithm represented shown fig. estimated global optimum affected relative location global optimum search range. estimation accurate true global optimum closer center search range. slightly different observation therefore used improve estimated global optimum iteration calculated particles resampled searching range centered 𝒙̂𝑔. average calculated observation weighted evaluations name model shift particles observation ukfpso case different used ukfpso method different definitions workflow spo-ukfpso method shown fig. apply guided model real image registration tasks choice similarity measure also profound influence results. chosen similarity measure follow prior knowledge modeled equation allows problem solved shown fig.. example multi-modality registration problem squared difference intensity poor choice. therefore widely used mutual information instead. register reference image floating image calculated using joint entropy marginal entropies image registration problems important find position closer real global optima search space search better value fitness function. performances compared algorithms therefore measured norm differences returned vectors ground truths benchmark functions. since chosen benchmark functions ground truth optima locate center search space weak optimization algorithm tends converge center search space obtain better results others. deal bias keeping ground truth within search space generated random shifts searching bounds limited within problem space. besides random shift search ranges algorithms tested using random problem dimension chosen repeated algorithm times benchmark function. mean standard deviation algorithm calculated. stop condition algorithms either reaching iterations reduction variability particle positions around global optima less algorithms implemented matlab vectorized simulation particle positions. particle position update mechanism method specific parameters different implementations shared core code ensure comparison performed similar circumstances. accuracy convergence speeds times method measured. speeds evaluated using average number iterations function evaluations well convergence time. general overview performances mean accuracy method benchmark functions also calculated. balance influence personal optima measured global optimum filtered optimum many methods initialise work initialized letting particle evolution process adjusted proposed models compared using common benchmark functions widely used literature shown table since optimization methods proposed paper customized image registration applications assumed prior knowledge described section chose different types benchmark functions singleobjective multi-objective comprehensively compare power different methods. nested ukfpso method image registration applications requiring multiple types features different types similarity measures included order evaluate performances proposed methods real registration applications conducted rigid registration experiment based data multi-modality brain image datasets retrospective image registration evaluation project comparison includes original drqpso bare bones kalman filter lds-kfpso spo-ukfpso nested ukfpso methods. methods similarity measure except nested ukfpso used measure gradient features proposed pluim used purpose experiment compare performance different methods image registration applications rather obtain absolute highest registration accuracy integrated methods simple registration framework. sake simplicity efficiency slice reference floating volumes down-sampled original inplane resolution reference image along dimension. slice thickness floating volume also interpolated slice thickness reference volume optimization method dealt translation rotation parameters. allow speed-up registration selected cubic region interest volume applying otsu's histogram-based threshold selection method normalized data. rire project measures accuracy registration using calculated multiple volumes interest used measure registration accuracy. transformation parameters calculated resampled data rescaled transformation original volume. patient attempts registration completed methods initialized particles generated matlab quasi-random number simulator. compare performance methods original also conducted experiment using neonatal data collected clinical trial performed clinical research imaging centre university edinburgh dataset previously used evaluate performance registration framework based rearranged histogram specification k-means binning used images acquired weeks’ postmenstrual natural sleep using verio system neonatal population imaged likely significant motion acquisitions makes dataset good test registration algorithms. isotropic anatomical data acquired range contrasts selected facilitate development volumetric brain segmentation algorithms main study. data patients aligned using rigid-body transform calculated within ××mm userpositioned volumes isotropic voxel size transformation matrices obtained data down-sampled half original resolution. performance evaluated tres calculated pairs corresponding landmarks manually placed clinical expert. accuracy lds-kfpso nested-ukfpso compared results earlier work based original shown table original gave best result step function. bare bones performed better griewank modulus salomon functions. proposed lds-kfpso method converged positions closer true global optima ackley schewefel rosenbrock functions. majority benchmark functions proposed lds-kfpso spo-ukfpso returned best performances performances comparable bare bones pso. step function special case among benchmark functions increases monotonically global optimum located around upper bound search range. registration applications happen true global optimum included search space. expected case lds-ukfpso spoukfpso methods gave worse results. performances measured mean standard deviation distances returned function values ground truths benchmark functions. mean values shown within parenthesis. best results benchmark functions shown bold font. performances measured mean standard deviation distances returned function values ground truths benchmark functions. mean values shown within parenthesis. best results benchmark functions shown bold font. achieved using ukfpso method previous methods failed register shown example. quantitative evaluation registration results shown table lds-kfpso nested ukfpso therefore gave smaller tres original also successfully aligned particular problematic dataset previous method failed register paper described three ukf-guided registration-oriented optimization implementations. pso-based methods evaluated using benchmark functions registering medical image cohorts. compared selected algorithms ukf-guided methods achieved accurate registration results displayed better robustness presence local optima. convergence speed qpso minimizing benchmark functions comparable original algorithm registering medical images. fig. registration results obtained using original particle swarm optimizer linear dynamic system kalman filter nested unscented kalman filter registration; registered using original pso; registered using lds-kfpso; registered using nested ukfpso. registration performed align weighted dark fluid mrpage images visualized overlapped green color channels. based results shown table simplicity position update model implementation chaotic qpso fastest convergence time worst accuracy. comparison lds-kfpso spo-ukfpso take slightly longer complete iteration required fewer iterations methods. particular lds-kfpso used least number function evaluations shortest time achieve best optimization results. spo-ukfpso provided greater accuracy compared ldskfpso converged quicker methods. tres ct-mr_t pet-mr_pd registrations shown table three proposed methods returned better results methods terms mean median tre. combined features similarity measures utilizes nested-ukfpso gave better results amongst three proposed models. bare bones kalman filter since methods feature deterministic position update mechanism display better convergence speed original drqpso. however original drqpso highly sensitive particle initialization gave greatest variability experiment. space optimization process without requiring manually assigned weights feature included prior knowledge. unlike methods proposed methods update probabilistic distribution whole search space rather storing distribution particle. process iteratively moves particles close global optimum especially early stage thus leading quicker convergence. furthermore mechanism updates knowledge search space also applied population based optimization methods example swarm intelligence methods. thus great potential application variety medical image registration problems. zitová flusser \"image registration methods survey\" image vision computing vol. julier uhlmann \"new extension kalman filter nonlinear systems\" aerosense' andras bayesian interpretation particle swarm optimization kernel extension.\" plos vol. e--e wachowiak smolíková approach multimodal biomedical image registration utilizing particle swarm optimization\" evolutionary vol. eberhart kennedy optimizer using particle swarm theory\" proceedings sixth international symposium micro machine human science vol. thangaraj pant abraham bouvry \"particle optimization hybridization perspectives experimental illustrations\" applied mathematics computation vol. meshoul batouche novel quantum behaved particle swarm optimization algorithm chaotic search image alignment\" evolutionary computation vol. kennedy mendes \"neighborhood topologies fully informed best-of-neighborhood particle swarms\" ieee transactions systems cybernetics part applications reviews vol. fang ding review quantum-behaved particle swarm optimization\" iete technical review vol. zhou c.-h. improved swarm optimization application medical image registration\" international journal computer mathematics duan deng chaotic quantumbehaved particle swarm optimization based lateral inhibition image matching\" optik international journal light electron optics vol. robinson sinton rahmat-samii \"particle swarm genetic algorithm hybrids optimization profiled corrugated horn antenna\" antennas propagation society international symposium ieee vol. s.-k. y.-c. liang zahara \"hybrid simplex search particle swarm optimization global optimization multimodal functions\" engineering optimization vol. kennedy swarms\" proceedings ieee swarm intelligence symposium. sis' vol. monson seppi \"bayesian optimization models proceedings annual conference genetic evolutionary computation kalman approach linear filtering prediction problems\" journal fluids engineering vol. einicke white \"robust extended kalman filtering\" ieee transactions signal processing vol. kalman introduction kalman filter\" university north carolina chapel hill department computer science uhlmann julier durrant-whyte method linear transformation means covariances filters estimations\" ieee transactions automatic control vol. jamil x.-s. yang literature survey benchmark global optimisation problems\" international journal mathematical modelling numerical optimisation vol. west \"comparison evaluation retrospective intermodality brain image registration assisted techniques.\" tomography vol. pluim maintz viergever \"image registration maximization combined mutual information gradient information\" ieee transactions medical imaging vol. otsu threshold selection method graylevel histograms\" automatica vol. wang \"automatic multi-parametric registration method using mutual information based adaptive asymmetric k-means binning\" biomedical ieee international symposium", "year": 2018}