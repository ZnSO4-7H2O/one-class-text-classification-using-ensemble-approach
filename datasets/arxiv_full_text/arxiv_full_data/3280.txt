{"title": "Microscopic Advances with Large-Scale Learning: Stochastic Optimization  for Cryo-EM", "tag": ["stat.ML", "cs.CV", "cs.LG", "q-bio.QM"], "abstract": "Determining the 3D structures of biological molecules is a key problem for both biology and medicine. Electron Cryomicroscopy (Cryo-EM) is a promising technique for structure estimation which relies heavily on computational methods to reconstruct 3D structures from 2D images. This paper introduces the challenging Cryo-EM density estimation problem as a novel application for stochastic optimization techniques. Structure discovery is formulated as MAP estimation in a probabilistic latent-variable model, resulting in an optimization problem to which an array of seven stochastic optimization methods are applied. The methods are tested on both real and synthetic data, with some methods recovering reasonable structures in less than one epoch from a random initialization. Complex quasi-Newton methods are found to converge more slowly than simple gradient-based methods, but all stochastic methods are found to converge to similar optima. This method represents a major improvement over existing methods as it is significantly faster and is able to converge from a random initialization.", "text": "determining structures biological molecules problem biology medicine. electron cryomicroscopy promising technique structure estimation relies heavily computational methods reconstruct structures images. paper introduces challenging cryo-em density estimation problem novel application stochastic optimization techniques. structure discovery formulated estimation probabilistic latent-variable model resulting optimization problem array seven stochastic optimization methods applied. methods tested real synthetic data methods recovering reasonable structures less epoch random initialization. complex quasinewton methods found converge slowly simple gradient-based methods stochastic methods found converge similar optima. method represents major improvement existing methods signiﬁcantly faster able converge random initialization. discovering structure molecules proteins viruses important problem biology medicine. biological macromolecules composed chains simpler monomers conformation folding chains structure determines speciﬁc function properties. traditional approaches estimating structures x-ray crystallography nuclear magnetic resonance spectroscopy fundamental limitations. x-ray crystallography requires crystal target molecule; difﬁcult grow best often impossible doesn’t require special form target limited relatively small molecules preventing study important biological complexes electron cryomicroscopy emerging experimental methodology structure determination able measure medium large-sized molecules native state i.e. without need crystallization non-native solvents however cryo-em raises challenging computational problems attempt address here. cryo-em puriﬁed solution target molecules frozen thin imaged transmission electron microscope. scattering electrons pass sample measured producing images individual molecules visible. particle image related orthographic integral projection electron density target molecule direction projection unknown. captured image corrupted destructive interference electron microscope imaging process sensitive nature biological specimens radiation dosage kept minimum leading particle images extremely signal-to-noise ratios typically around cryo-em imaging method including typical particle images illustrated figure figure generative image formation model cryo-em. electron beam results orthographic integral projection electron density specimen. projection modulated contrast transfer function corrupted noise. images pictured dataset real particle images protein synthase showcasing typical cryo-em. zeros make estimation particularly challenging however location vary function experimental parameters. particle images density computational task cryo-em estimate electron density target molecule given particle images. similar density estimation computed tomography however projection direction image known together unknown orientations image corruption make cryo-em density estimation challenging problem. inspecting real particle images figure makes clear human coarse dumbbell shape molecule barely visible ﬁner details like presence three stalks practically imperceptable. paper explore stochastic optimization techniques cryo-em density estimation. introduce probabilistic latent-variable model image formation cryo-em seek maximum-a-posteriori estimate electron density. formulate electron density estimation stochastic optimization problem. show approach leads signiﬁcant speed gains providing ability compute density estimates hours existing approaches would take days weeks. further results show stochastic optimization approach dramatically less sensitive initialization previous methods. previous approaches strongly biased initialization method able quickly converge random initialization. explore array stochastic optimization algorithms compare performance class objective functions arises probabilistic model. believe cryo-em important challenging problem which exceptions seen little attention machine learning computer vision communities. mixed results comparing stochastic optimization methods also suggest cryo-em serve important benchmark problem stochastic optimization algorithms. stochastic optimization algorithms signiﬁcant success application typically limited small objective functions. paper hope spark interest problem large cryo-em density estimation real-world benchmark stochastic optimization methods. traditional approaches cryo-em density estimation e.g. solve problem iterative reﬁnement. initial density estimate projected large number directions projection compared particle image. particle projection matches closest considered true orientation particle. reconstruction density estimate based fourier slice theorem states fourier transform projection density equal slice origin fourier transform density plane perpendicular projection direction using computed orientations particle density estimated interpolation averaging observed particle images. approach fundamentally limited even ideal circumstances particle images makes accurately identifying single correct orientation particle nearly impossible resulting errors estimated density. problem exacerbated attempting reﬁne density without prior knowledge shape; poor initialization result estimating structure either clearly wrong worse appears correct misleading resulting publication incorrectly estimated structures finally crucially case density estimation many particle images data used reﬁnement iteration causing methods slow general. recently bayesian approaches density estimation proposed avoid estimating single orientation individual particle images. orientation particle treated random variable rather simply unknown parameter orientations considered marginalizing random variables. resulting integral analytically intractable computed numerically. further simple interpolation averaging based longer possible form optimization must performed estimate density. marginalization cryo-em originally proposed image alignment reconstruction gradient based optimization marginalization originally proposed jaitly batch gradient-based optimization performed using small number low-noise images found clustering averaging individual particle images. scheres used marginalization batch expectation-maximization algorithm relion package particle images. paper work similar generative model methods show stochastic optimization signiﬁcant progress towards estimate made quickly better robustness initialization. stochastic optimization seen signiﬁcant theoretical practical interest recently. fundamental approach stochastic gradient descent remains popular often surprisingly effective algorithmic choice. momentum based methods improve using gradient information multiple iterations allowing faster traversal directions curvature natural gradient methods developed based theoretical connections manifold geometry parameter space fisher information matrix statistical considerations accounting noise gradient vectors higher-order methods developed attempt either approximate analytic hessians speed convergence explicitly accounting curvature. methods number hyper-parameters highly sensitive settings; motivated number attempts develop methods fewer parameters finally operating ﬁnite-data context algorithms developed utilize gradients data-points still operating limited subset time strong convergence results. full review theoretical results beyond scope paper refer interested readers paper compare number methods evaluate performance suitability given task. results show methods good solutions quickly almost methods converge similarly optimal solution simpler methods typically good better complex costly ones. order formulate density estimation optimization problem turn probabilistic latent variable model three parts; particle images observed variables corresponding orientations unknown latent variables electron density unknown parameter seek estimate. particle image considered orthographic integral projection electron density along direction microscope beam. image corrupted phenomenon contrast transfer function noise. primary effects resulting destructive interference modelled modulation frequency space i.e. linear operator integral projection. fourier spectrum typical shown figure note phase changes zero crossings result missing information individual images. zero crossings vary experimental settings microscope although sample target molecules imaged once different samples imaged different conditions ensure every frequency captured. full review beyond scope paper refer interested readers noise formalize this represent electron density grid density voxel denoted side length cubic grid. integral projection density orientation represented linear transformation assume particle image associated parameters discussed above modelled linear operator projected image denoted finally particle subject shift image plane necessarily centered image similarly represented linear operator denoted conditional probability distribution observing image thus standard deviation noise multivariate normal distribution mean vector covariance matrix practice computational considerations equation evaluated fourier space making fourier slice theorem parseval’s theorem obtain fourier transform image shift operator fourier space modulation fourier space sinc interpolation operator extracts plane origin deﬁned projection orientation fourier transform speed computation likelihood level noise attenuation high frequencies equation evaluated using fourier coefﬁcients speciﬁed maximum frequency. image formation model provides conditional probability observing image given orientation shift density. orientation shift however unknown. cope this marginalize latent variables assuming independent density uniform distribution normal distribution truncated based size particle images shift distribution double integral analytically tractable resort numerical quadrature. lebedev quadrature directions projection combined uniform quadrature interval account in-plane rotation uniform quadrature truncated region account shifts. using numerical quadrature conditional probability image weighted quadrature points. accuracy quadrature scheme consequently value automatically based speciﬁed maximum frequency considered. given images parameters pendence images posterior figure negative likelihood test data versus number gradient evaluations synthetic thermus datasets zoomed view ﬁnal iterations. prior. combination exponential distribution positive density values encourage sparsity generalized normal distribution softly penalize negative density value voxel e−λ+vi e−λ−|vi| many choices prior possible promising direction future research. estimating electron density corresponds ﬁnding maximizes equation optimizing directly costly marginalization equation selecting maximum frequency cut-off nyquist limit corresponds approximately quadrature points datasets shown here. combined dataset size around particle images full evaluation posterior gradient takes computation time modern cpu. instead formulate stochastic optimization problem. taking dropping constant factors optimization problem becomes presenting results discuss general observations objective function. first neighbourhood solution explains particle image well enough single term equation signiﬁcant equation becomes prior term quadratic terms thus near objective roughly regularized linear least squares problem thus approximately convex. general objective function algebraic form mixture model posterior equation orientation analogous mixture component parameters corresponding respective slice might suspect typical pathologies mixture models manifest overﬁtting components assigned small number data points. however unlike mixture model problem parameters component interrelated linear combination elements particular frequency coefﬁcients shared many mixture components progressively higher frequencies shared fewer fewer. taken together observations suggest that objective function equation convex well behaved long low-frequency fourier coefﬁcients approximately correct. observation also seen motivation considering fourier coefﬁcients threshold expect restricted problem better behaved. practice higher resolution structures sought good strategy would introduce high-frequency fourier coefﬁcients gradually. large transmembrane molecule provides energy cells. dataset consisting particle images parameters provided rubinstein high resolution structure sample images shown figure specimen cryo-em dataset known challenging particle symmetry contrast low. second dataset synthetically created using simple hand crafted electron density. using density particle images generated uniformly sampling random orientations assuming zero in-plane translation. ctfs simulated parameters randomly selected thermus dataset noise added comparable snr. synthetic density simulated images shown figure optimization methods. optimization performed datasets seven different stochastic optimization algorithms. speciﬁcally used traditional stochastic gradient descent classical momentum nesterovs accelerated gradient adagrad tonga online lbfgs hessian-free optimization particle images datasets pixels values rescaled standard deviation noise prior parameters synthetic dataset thermus dataset. fourier coefﬁcients considered radius nyquist limit synthetic dataset thermus. minibatch size used methods except conjugate gradient iterations used minibatch size damping parameter tuned hand. larger minibatch size chosen trade-off; smaller minibatches required strong damping resulted small step sizes slower convergence. base learning rate tuned hand method examining performance subset training examples. methods except adagrad learning rate annealed according iteration number base learning rate. momentum parameters min{. −−log tonga covariance matrix approximated rank approximation after every iterations regularization parameter tuned along learning rate. online lbfgs used update vectors approximate inverse hessian. methods epochs except online lbfgs fewer iterations account increased number gradient evaluations needed methods. datasets particle images randomly held test negative likelihood test used measure performance. remaining images randomly shufﬂed method seeing images order. case optimization initialized randomly constructed density shown figure stochastic optimization results. results optimizations plotted figure versus number gradients individual particle images. used account additional gradient evaluations required online lbfgs different minibatch sizes hessian-vector products required show estimated densities throughout optimization figure note algorithms able reasonable solutions eventually ﬁnal data likelihood methods within units other. terms speed epoch took approximately hour using threads quad eight core .ghz intel xeon cpu. looking plots figure make observations efﬁcacy individual methods. first note behaviour different synthetic real datasets. suspect outliers thermus dataset blame part difference. image formation model described previous section good approximation well established cryo-em literature perfect. further particle images manually selected large micrographs mistakes made high signal-to-noise ratio well simple human error. additional difference datasets shape structure itself. strong cylindrical shape synthetic structure causes objective function directions curvature early iterations resulting symmetry. methods able efﬁciently traverse regions likely better. note structures like uncommon nature many molecules interest particular viruses strong symmetries. mind note tonga momentum methods well synthetic dataset might predicted adagrad clearly slow around traverse low-curvature area. online lbfgs appear plateau adagrad added cost extra gradient evaluations needed compute update vectors lbfgs outweighed faster progress able make iteration. comparison thermus dataset curvature area appear present asymmetry particle resulting similar qualitative behaviour methods. said adagrad tonga generally converge faster online lbfgs momentum methods. datasets however story hessian-free optimization consistent added cost iterations larger minibatches allow faster progress given iteration progress outweigh additional computational cost. comparison state-of-the-art. compare method existing methods structure determination selected approaches. ﬁrst standard iterative projection matching scheme images matched initial density global cross-correlation search. density reconstructed based orientations process iterated. second relion package described uses similar marginalized model method figure baseline comparisons existing standard methods. iterative projection matching reconstruction relion batch iterations. proposed method epoch. method iterations roughly equivalent computationally epochs gradient evaluations method. results iterations methods shown figure cases approaches failed converge time allotted particularly compared structures estimated proposed approach approximately ﬁfth computation i.e. columns figure paper introduced motivated challenging problem density estimation cryoem formulated using probabilistic image formation model cast resulting estimation problem stochastic optimization. implemented array seven stochastic optimization methods ranging simple momentum methods complex quasinewton methods compared behaviour performance cryoem problem real synthetic data. comparison proposed stochastic optimization approach current methods demonstrates stochastic optimization yields signiﬁcant speedups robustness initialization. proposed approach converges reasonable structures little epoch random initialization while comparison existing methods make slow progress even many epochs become trapped local minima. among stochastic optimization methods tested effective ﬁnding good solution though typically converge faster others. notably methods require signiﬁcant additional computation iteration like online lbfgs hessian-free optimization perform better simply taking iterations methods problem. believe problem density estimation cryoem important problem interesting challenge stochastic optimization algorithms general. particular work highlights major limitations existing methods reliance manual tuning. methods parameters required amount manual tuning every dataset would potentially require parameters re-adjusted. efforts made standardize datasets amount retuning generally necessary dataset. research needed develop methods able automatically adapt different objective functions note several methods show signiﬁcant promise along lines william baxter robert grassucci haixiao joachim frank. determination signal-to-noise ratios spectral snrs cryo-em low-dose imaging molecules. struct biol henderson sali baker carragher devkota downing egelman feng frank grigorieff jiang ludtke medalia penczek rosenthal rossmann schmid schr¨oder steven stokes westbrook wriggers yang young berman chiu kleywegt lawson. outcome ﬁrst electron microscopy validation task force meeting. structure jiang hsieh. computed tomography principles design artifacts recent advances. navdeep jaitly marcus brubaker john rubinstein ryan lilien. bayesian method macromolecular structure inference using class average images single particle electron microscopy. bioinformatics nicolas roux andrew fitzgibbon. fast natural newton method. icml nicolas roux pierre-antoine manzagol yoshua bengio. topmoumoute online natural satya mallick sameer agarwal david kriegman serge belongie bridget carragher clint potter. structure view estimation tomographic reconstruction bayesian approach. cvpr schaul sixin zhang yann lecun. pesky learning rates. icml sjors scheres haixiao mikel valle gabor herman paul eggermont joachim frank jose-maria carazo. disentangling conformational states macromolecules likelihood optimization. nature methods", "year": 2015}