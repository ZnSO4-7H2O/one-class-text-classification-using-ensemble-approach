{"title": "Evaluation of Deep Convolutional Nets for Document Image Classification  and Retrieval", "tag": ["cs.CV", "cs.IR", "cs.LG", "cs.NE"], "abstract": "This paper presents a new state-of-the-art for document image classification and retrieval, using features learned by deep convolutional neural networks (CNNs). In object and scene analysis, deep neural nets are capable of learning a hierarchical chain of abstraction from pixel inputs to concise and descriptive representations. The current work explores this capacity in the realm of document analysis, and confirms that this representation strategy is superior to a variety of popular hand-crafted alternatives. Experiments also show that (i) features extracted from CNNs are robust to compression, (ii) CNNs trained on non-document images transfer well to document analysis tasks, and (iii) enforcing region-specific feature-learning is unnecessary given sufficient training data. This work also makes available a new labelled subset of the IIT-CDIP collection, containing 400,000 document images across 16 categories, useful for training new CNNs for document analysis.", "text": "fig. examples document images share visual style letter. note even text documents illegible style type clear. documents similar spatial conﬁgurations various parts addresses dates typically appear near signatures typically appear near bottom documents share exact layout. identifying style type documents therefore difﬁcult potentially facilitate extraction information. perspective visual styles erroneous retrievals circumstances justiﬁable general task document image analysis effectively classify retrieve documents despite intra-class variability interclass similarity. similar challenges appear ﬁelds object recognition scene classiﬁcation. domains current state-of-the-art approach involves training deep convolutional neural network learn features task inspired success cnns domains paper presents extensive evaluation cnns document classiﬁcation retrieval. determined features extracted deep cnns exceed performance popular alternative features classiﬁcation retrieval large margin. experiments also presented transfer learning demonstrate cnns trained object recognition learn features surprisingly effective describing documents. furthermore found deep strategy signiﬁcantly improved additional guidance toward region-focused features suggesting trained whole images already capable learning amount information region-based analysis would add. abstract—this paper presents state-of-the-art document image classiﬁcation retrieval using features learned deep convolutional neural networks object scene analysis deep neural nets capable learning hierarchical chain abstraction pixel inputs concise descriptive representations. current work explores capacity realm document analysis conﬁrms representation strategy superior variety popular hand-crafted alternatives. experiments also show features extracted cnns robust compression cnns trained non-document images transfer well document analysis tasks enforcing region-speciﬁc feature-learning unnecessary given sufﬁcient training data. work also makes available labelled subset iit-cdip collection containing document images across categories useful training cnns document analysis. many document types distinct visual style. example letter documents typically written standard format recognizable even scales text unreadable. motivated observation paper addresses problem document classiﬁcation retrieval based visual structure layout document images. content-based analysis document images number applications. digital libraries documents often stored images processed optical character recognition system means basic image analysis available tool initial indexing classiﬁcation pre-processing stage document image analysis facilitate improve providing information document’s visual layout furthermore document information lost typeface graphics layout stored indexed using images image descriptors. therefore image analysis complementary several stages document analysis. challenge document image analysis arises fact within document type exists wide range visual variability. example correspondence documents shown figure documents share exact spatial arrangement header date address body signature; documents even omit components entirely. level intra-class variability renders spatial layout analysis difﬁcult rigid template matching impossible another issue documents different categories often substantial visual similarities. instance exist advertisements look like news articles questionnaires look like forms clearly demonstrated domain rigidly structured documents forms business letters general approach assumes many document types distinct consistent conﬁguration visually-identiﬁable components. example formal business letters typically share particular spatial conﬁguration letterhead date salutation. extent classiﬁcation perfectly rigid documents reduced problem template matching less-rigid document types similarly classiﬁed ﬁtting geometric conﬁguration document’s components several template conﬁgurations geometric transformations drawback approach requires manual deﬁnition template document type categorized. furthermore approach limited documents template deﬁnition possible. documents ﬂexible structures considered herein template-based approaches inapplicable. alternative strategy treat document images holislarge regions search tically discriminative landmark features appear anywhere document strategy sometimes called visual words approach since describes images histogram orderless vocabulary features example landmark feature discriminating letters document classes salutation ﬁnding salutation document good document letter regardless feature’s exact spatial position advantage holistic analysis resulting representation documents invariant geometric conﬁguration features. approach therefore successful retrieving classifying broader range documents templatebased approaches although approach less discriminating domain rigid-template documents. attempts bridge region-based holistic analyses. concatenating image features pooled several stages beginning whole-image pool proceeding smaller smaller regions possible build descriptor contains global local layout characteristics technique known spatial pyramid matching initially developed categorizing scenes shown apply well documents also especially pooling regions designed document categorization mind document retrieval type representation represents current state-of-the-art. time many researchers replaced handcrafted features representations machine-learned variants popular area research domain concerns task learning document structure. typically involves training decision tree navigate various possible geometric conﬁgurations ﬁxed features within document type toward goal structure-based classiﬁcation recently shown entire pipeline supervised document image classiﬁcation feature-building decision making learned convolutional neural network work authors reported remarkable increase classiﬁcation accuracy compared previous best reported shift toward machine-learned features taking place areas computer vision well. object recognition literature cnns currently exceed performance every approach large margin approach even shown apply well domains traditionally believed ill-suited attribute detection ﬁne-grained object recognition success cnns ﬁne-grained object recognition especially relevant document image analysis since ﬁelds share signiﬁcant challenges e.g. items distinguished similar other exist problem-speciﬁc datasets large enough train powerful without causing overﬁt. makes sense therefore draw inspiration ﬁne-grained object recognition research overcome challenges. major points training usage cnns gleaned ﬁne-grained classiﬁcation research. first training data interest recommended pre-train network much larger related problem ilsvrc challenge regularization technique addresses issue overﬁtting allows large cnns effectively applied small problems. second problems spatial information important potentially better encode information multiple networks trained speciﬁc regions interest single network trained entire image generally second point suggests unnecessary rely entirely machine learning especially human knowledge easily implemented system. paper seeks investigate whether insights relevant document image analysis. finally cnns domains recently extended task image retrieval. trained classiﬁcation layers network interpreted forming hierarchical chain abstraction lowest layers contain simple features highest layers contain concise descriptive representations therefore output extracted near serve feature vector used task including retrieval present work ﬁrst apply idea toward document retrieval. light previous work paper makes following contributions. first paper thoroughly evaluates power deep features representing document images. toward paper presents experiments design training feature processing compression. results show features extracted cnns superior handcrafted competitors furthermore compressed short codes negligible loss performance. second work demonstrates cnns trained nondocument document-related tasks. third paper explores strategy embedding human knowledge document structure architectures guiding ensemble cnns toward learning region-speciﬁc features. interestingly results show little improvement classiﬁcation retrieval augmentation suggesting basic holistic learning region-speciﬁc features automatically. finally work makes available labelled subset iit-cdip collection tobacco litigation documents containing document images across categories. structured documents layout text graphics elements often reﬂects important information genre. therefore documents category often share region-speciﬁc features. paper attempts learn informative features training either single holistic ensemble region-based cnns. additionally paper explores different initialization strategies ﬁrst initializes weights cnns randomly relies entirely training process features; second transfers weights network trained another task relies training ﬁne-tune features domain document analysis. modern implementations neural networks computer vision network takes input square matrix pixels input processes input stack convolutional layers classiﬁes output convolutional layers using three fully-connected layers typical network type approximately million trainable parameters; vast representational capacity along hierarchical organization representation assumed responsible network’s power featurebuilder classiﬁer convolutional neural network activations geometrically invariant. applications object detection sometimes inconvenient property. much work done spatial invariance cnns e.g. jittering training data geometric variants image dataset altering architecture process input multiple scales positions document analysis however spatial speciﬁcity activations beneﬁcial. example makes sense treat header region document differently footer region. design holistic trained dataset well-aligned document images capable learning region-speciﬁc features automatically. typically cnns trained perform classiﬁcation task trained classiﬁcation exploited perform retrieval also. found activation patterns near deep make descriptive feature vectors feature vectors high-dimensional dimensionality reduced signiﬁcantly principal component analysis without signiﬁcantly affecting discriminative power retrieval involves computing euclidean distance query descriptor every descriptor training set. sorted distances used rank images training data return sorted list documents. accounting possibility holistic take advantage region-speciﬁc information document images guiding cnns learn region-based features ﬁne-grained discrimination isolating subtle region-speciﬁc appearance differences document categories. consider example discriminating letters memos illustrated figure categories consistently differ address section; memos short from letters full addresses. possible holistic learn automatically training classify documents using region increases likelihood feature learned. idea approach devote region interest therefore force multiple cnns learn rich region dependent representations features extracted combined. number region-speciﬁc cnns used approach. work total cnns used. four region-tuned placed header left body right body footer document images. ﬁfth holistic trained entire images. ﬁnal region-based representation document images built combining compressing features extracted region-tuned cnn. ﬁnal descriptor represented concatenation region speciﬁc features represents pca-compressed feature vector extracted holistic represent analogous vectors extracted regions figure illustrates full process vector’s construction. retrieval vector used directly. classiﬁcation fully-connected network trained classify concatenated vector. goal transfer learning take advantage shared structure related problems facilitate learning problems little training data context cnns transfer learning implemented weight initialization step. typical initialization strategy cnns weights small random numbers biases either alternative strategy pretrain network network complementary task potentially training data target task. puts network near good solution target problem prevents descending local minima early training process popular choice pre-training ilsvrc imagenet challenge contains million training examples natural images categorized object categories features extracted second version dataset listed results bigtobacco random sample images categories cdip collection total labelled images. sample collected speciﬁcally present paper. categories letter memo email ﬁlefolder form handwritten invoice advertisement budget news article presentation scientiﬁc publication questionnaire resume scientiﬁc report speciﬁcation. selection categories guided earlier work document categorization also range categories present already-existing smalltobacco sample collection. another factor knowledge cnns well large datasets selection restricted categories well represented dataset. representative sample dataset shown figure ﬁnal categories perfectly distinct many images originally labelled multiple tags potentially covered several categories eventually selected; version dataset image labelled single category. dataset split three subsets purposes experimentation. smalltobacco dataset split related work images used training validation remainder testing. since small dataset random splits proportions created; results reﬂect median performance splits. case retrieval median selected based mean average precision retrieval bigtobacco dataset split proportions similar imagenet images used training images validation images testing. validation sets used plateaus training process. results reported test sets. cnns used caffe’s reference imagenet architecture based work krizhevsky network convolutional layers three fully-connected layers. network takes images size full architecture written features extracted cnns taking output ﬁrst fully-connected layer dimensions. ﬁrst network different architecture listed results small holistic uses hyperparameters established another work document image analysis network convolutional layers three fully-connected layers pooling relu dropemployed several stages between. network takes input images size full architecture written ×−××−×−−−n. fig. construction region-based representation delineated three steps. first pre-deﬁned regions cropped input image resized common size. second region processed feature vector extracted. third feature vectors compressed concatenated. paper studies three questions transfer learning document analysis. first paper investigates whether imagenet features general enough applied documents. ﬁne-tuning documents generic object-recognition features applicable document analysis? second paper addresses question whether initialization provided pre-training ilsvrc challenge provides better results random initialization documentclassifying cnns. third paper seeks investigate usefulness transfer learning document categories; trained small number document categories features learned process useful discriminating unseen document categories? questions answered retrieval tasks follow. performance various proposed approaches evaluated versions cdip test collection collection contains high resolution images scanned documents collected public records lawsuits american tobacco companies. total database seven million documents hand-labelled tags. often ﬁrst document image indicative document’s category many documents dataset missing erroneous tags. ﬁrst version dataset listed results smalltobacco sample images collection selected labelled another work version dataset used number related papers image labels. uneven fig. representative examples category dataset. category three images shown column. order document classes shown letter memo email ﬁlefolder form handwritten invoice advertisement budget news article presentation scientiﬁc publication questionnaire resume scientiﬁc report speciﬁcation. notice although category certain distinctive features wide variation within category images certain pairs categories could easily confused second network different architecture ensemble cnns network uses vectors extracted region-based cnns perform classiﬁcation. since vector length large classify individual region-based vectors compressed using principle component analysis dimensions concatenated classiﬁcation. network architecture written retrieval features approach created individually compressing region’s feature vector dimensions concatenating resulting vector dimensions. test effect transfer learning categories documents holistic trained using categories bigtobacco dataset letters memos. network pre-trained imagenet. results listed lettermemo cnn. extract regions images images ﬁrst resized header region deﬁned ﬁrst rows pixels image. footer region similarly deﬁned last rows pixels image. left body region delineated intersection central rows left columns; right body region symmetrically deﬁned. every extracted region resized used input. several state-of-the-art words approaches document representation also implemented. previous work words k-means clustered surf features features pooled spatial pyramid well various combinations horizontal vertical partitions results denote horizontalvertical partitioning schemes havb number times image recursively split horizontally number times image recursively split vertically. example bags original image ﬁrst vertical split second vertical split third. holistic words resulting feature vector dimensions; dimensions; dimensions; dimensions. classiﬁcation features three additional features added baselines featured approaches gist descriptor average brightness ensemble-of-regions average brightness. gist descriptor shown perform well image retrieval tasks applied document analysis. average brightness acts baseline minimum performance; images representation represented single value. ensemble-of-regions average brightness represents document images vector elements corresponding average brightness regions created ensemble cnns approach. intended demonstrate small scale basic beneﬁt afforded region-based analysis. retrieval performed computing euclidean distance test descriptors every descriptor training set. sorted distances used rank images training data return sorted list documents test query. approaches feature vectors larger dimensions vectors ﬁrst compressed dimensions using used retrieval. consistent related work enables fast retrieval also keeps task within reasonable memory limits. related work feature vectors l-normalized compression. smalltobacco ensemble region-based cnns performed better approach achieving classiﬁcation accuracy. previous best reported result dataset randomly initialized small approximately replicated here. holistic network performed slightly worse ensemble cnns suggesting holistic learning amount information region-based analysis expected add. interestingly small compares similarly large-sized holistic initialized random weights. appears indicate additional parameters large network necessarily beneﬁcial. initializing larger networks imagenettrained weights improves performance substantially. without initialization cnns perform similarly approaches. approaches spatial-pyramid-pooled performs best. bigtobacco holistic ﬁnetuned imagenet performed better approach including ensemble cnns. suggests given sufﬁcient training data advantage gained region-tuned analysis eliminated learning power holistic cnn. results approaches perform better approaches likely beneﬁt additional training data. observed smalltobacco ﬁnetuning improves results although smaller margin small dataset. comparing performance approaches datasets interesting observe performance drops nearly suggesting larger dataset presents difﬁcult classiﬁcation task perhaps also additional training data help approaches. confusion matrix holistic shown figure retrieval measured using mean average precision average precision computes average value precision function recall interval. formally discrete version metric given rel) rank document retrieved equals document relevant otherwise. metric sensitive ranking order score higher relevant documents retrieved irrelevant documents. mean average precision simply average precision summed queries divided number queries. retrieved documents determined relevant class label query image. mean average precision ﬁrst retrievals datasets summarized figure smalltobacco dataset ensemble region-tuned cnns performs best followed holistic ﬁne-tuned imagenet. interestingly generic imagenet descriptor performs well also exceeding performance descriptors. approaches spatialpyramid-pooled performs best. gist descriptor performs approximately well approaches. bigtobacco dataset holistic performs best exceeding ensemble region-tuned cnns small margin exceeding approaches large margin. confusion matrix ﬁnetuned holistic computed using ﬁrst retrievals shown figure approaches outperformed every vector including generic imagenet vector. lettermemo slightly improves upon generic imagenet descriptor suggesting knowledge learned letters memos transfers categories gain marginal. approaches spatial-pyramidpooled performs best smalltobacco. interestingly gist descriptor exceeds performance descriptors large margin dataset. figure shows representative sample retrieval output holistic bigtobacco dataset. ﬁgure interesting notice ﬁrst query image memo seven retrievals different memos author memo query image. ﬁnal similarly impressive every document retrievals letterhead query document despite variations content also despite differing typefaces letterhead. exist biases dataset lead fortunate retrievals results still remarkable. additional experiment performed measure effect compression performance bigtobacco dataset results summarized figure remarkably vectors show almost loss performance reduced dimensions. levels compression holistic performs exceeds performance every approach. paper established state-of-the-art document image classiﬁcation retrieval using features learned deep convolutional neural networks generic features extracted trained imagenet exceeded performance state-of-the-art alternatives ﬁne-tuning features document images pushed results even higher. interestingly experiments also showed given sufﬁcient training data enforcing region-speciﬁc feature-learning unnecessary; single trained entire images performed approximately well ensemble cnns trained speciﬁc subregions document work showed approach document image representation exceeds power hand-crafted alternatives. fig. confusion matrices classiﬁcation performance retrieval performance holistic cnn. darkness off-diagonal cells adjusted better visibility. cells values greater annotated actual values. fig. mean average precision retrievals variety approaches smalltobacco dataset bigtobacco dataset legend approaches sorted descending order according corresponding graph. a.w.h.). authors thank palomino systems helpful discussions. authors gratefully acknowledge support nvidia corporation donation tesla used research. fig. effect reduction mean average precision retrieval holistic achieves highest levels reduction remarkably little loss across ﬁrst several steps reduction. fig. representative output retrieval process. ﬁgure best viewed computer monitor zoomable pdf. query images shown ﬁrst column retrievals shown following columns order. retrievals class shown green border; retrievals different class shown border. retrievals classes considered incorrect often good retrievals nonetheless. douze j´egou sandhawalia amsaleg schmid. proevaluation gist descriptors web-scale image search. ceedings int. conf. image video retrieval civr pages york acm. gong wang lazebnik. multi-scale orderless pooling deep convolutional activation features. eccv kashi wilfong. comparison classiﬁcation information retrieval krizhevsky sutskever hinton. imagenet classiﬁcation deep convolutional neural networks. nips pages kumar doermann. unsupervised classiﬁcation structurally similar document images. icdar pages kumar doermann. learning document structure retrieval classication. icpr pages kumar doermann. structural similarity document image classiﬁcation retrieval. marinai miotti soda. digital libraries document image retrieval techniques survey. biba xhafa editors learning structure schemas documents volume pages springer berlin heidelberg", "year": 2015}