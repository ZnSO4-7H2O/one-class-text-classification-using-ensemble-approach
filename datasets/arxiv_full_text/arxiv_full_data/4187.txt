{"title": "Expecting the Unexpected: Training Detectors for Unusual Pedestrians  with Adversarial Imposters", "tag": ["cs.CV", "cs.AI"], "abstract": "As autonomous vehicles become an every-day reality, high-accuracy pedestrian detection is of paramount practical importance. Pedestrian detection is a highly researched topic with mature methods, but most datasets focus on common scenes of people engaged in typical walking poses on sidewalks. But performance is most crucial for dangerous scenarios, such as children playing in the street or people using bicycles/skateboards in unexpected ways. Such \"in-the-tail\" data is notoriously hard to observe, making both training and testing difficult. To analyze this problem, we have collected a novel annotated dataset of dangerous scenarios called the Precarious Pedestrian dataset. Even given a dedicated collection effort, it is relatively small by contemporary standards (around 1000 images). To allow for large-scale data-driven learning, we explore the use of synthetic data generated by a game engine. A significant challenge is selected the right \"priors\" or parameters for synthesis: we would like realistic data with poses and object configurations that mimic true Precarious Pedestrians. Inspired by Generative Adversarial Networks (GANs), we generate a massive amount of synthetic data and train a discriminative classifier to select a realistic subset, which we deem the Adversarial Imposters. We demonstrate that this simple pipeline allows one to synthesize realistic training data by making use of rendering/animation engines within a GAN framework. Interestingly, we also demonstrate that such data can be used to rank algorithms, suggesting that Adversarial Imposters can also be used for \"in-the-tail\" validation at test-time, a notoriously difficult challenge for real-world deployment.", "text": "figure examples novel precarious pedestrian dataset dangerous rare pedestrian scenes. important scenario pedestrians phone adequately aware examples caltech dataset tend roundings. capture rare scenarios. examples adveserial imposters synthetic images adversarially-trained mimic precarious pedstrians. demonstrate images used train evaluate robust pedestrian recognition systems targeting dangerous scenarios. there’s software designer world that’s ever going smart enough anticipate potential circumstances autonomous going encounter. runs street person runs street bicyclist policeman construction worker. autonomous vehicles become every-day reality high-accuracy pedestrian detection paramount practical importance. pedestrian detection highly researched autonomous vehicles become every-day reality high-accuracy pedestrian detection paramount practical importance. pedestrian detection highly researched topic mature methods datasets focus common scenes people engaged typical walking poses sidewalks. performance crucial dangerous scenarios children playing street people using bicycles/skateboards unexpected ways. inthe-tail data notoriously hard observe making training testing difﬁcult. analyze problem collected novel annotated dataset dangerous scenarios called precarious pedestrian dataset. even given dedicated collection effort relatively small contemporary standards allow large-scale data-driven learning explore synthetic data generated game engine. signiﬁcant challenge selected right priors parameters synthesis would like realistic data poses object conﬁgurations mimic true precarious pedestrians. inspired generative adversarial networks generate massive amount synthetic data train discriminative classiﬁer select realistic subset deem adversarial imposters. demonstrate simple pipeline allows synthesize realistic training data making rendering/animation engines within framework. interestingly also demonstrate data used rank algorithms suggesting adversarial imposters also used in-the-tail validation test-time notoriously difﬁcult challenge real-world deployment. topic mature methods datasets focus everyday scenes people engaged typical walking poses sidewalks however perhaps important operating point deployable system behaviour dangerous unexpected scenarios children playing street people using bicycles/skateboards unexpected ways. precarious pedestrian dataset in-the-tail data notoriously hard observe making training evaluation existing systems difﬁcult. analyze problem collected novel annotated dataset dangerous scenarios called precarious pedestrian dataset. even given dedicated collection effort relatively small contemporary standards explore large-scale data-driven learning explore synthetic data generated game engine. synthetic training data actively explored topic provides potentially inﬁnite well annotated data training datahungry architectures particularly attractive approaches combine large amount synthetic training data small amount real data challenges synthesis primary difﬁculties synthetic training data. ﬁrst data created equal combining synthetic data real data synthesizing common scenes particularly useful since likely already appear training set. hence argue real power synthetic data generating examples in-the-tail would otherwise hard collect. second difﬁculty arises building good generative models images notoriously difﬁcult problem. rather building generative pixel-level models make state-of-the-art rendering/animation engines contain immense amount knowledge challenge generative synthesis lies constructing right priors scene-parameters render/animate. case correspond body poses spatial conﬁgurations people objects scene. adversarial imposters address concerns novel variant generative adversarial networks method synthesizing data latent noise vectors. traditional gans learn generative feedforward models process latent noise vectors typically ﬁxed known prior distribution. instead feedforward model rendering engine adverserial framework learn latent priors. deﬁne rendering pipeline takes input vector scene parameters capturing object attributes spatial layout. rejection sampling construct scene parameters maximally confuse discriminator. call examples adversarial imposters within simple pipeline adapting detectors synthetic data world real images. rpn+ dataset real imposter images train suite contemporary detectors. surprisingly good results novel variant region proposal network tuned particular objects rather general class objectness detections. instead classifying sparse proposed windows network returns dense heatmap pedestrian detections along regressed bounding location pixel location heatmap. call detector rpn+. experiments show rpn+ trained real+imposter data outperforms detectors trained real data. validation interestingly also demonstrate adverserial imposter dataset used rank algorithms suggesting pipeline also used in-thetail validation test-time notoriously difﬁcult challenge real-world deployment. contributions contribution work follows novel dataset pedestrians dangerous situations general architecture creating realistic synthetic data in-the-tail limited real data collected demonstration overall pipeline task pedestrian detection using novel detector. datasets code found here https//github.com/huangshiyu/rpnplus. related work synthetic data synthetic datasets used train evaluate performance computer vision algorithms. forms ground truth hard obtain hand-labelling optical easy synthesize simulation adam used game engine generate synthetic data learned intuitive physics model predict falling towers blocks. mayer released benchmark suite various tasks using synthetic data including disparity optical ﬂow. richter used synthetic data improve image segmentation performance notably control scene explore targeted arrangements objects. german used unity development platform generate synthetic urban scene dataset. models detection notable application computer graphics model vision modeling human body shapes moreover simulation also used detection scene understanding marin used game engine generate synthetic training data. pishchulin used cameras scan human body built real human models. used synthetic data labelled real data train pedestrian detectors. hattori used modelling software build special scene randomly models special background pedestrian detection. works synthetic data as-is analyze statistical differences synthetic real data describing pipeline reconciling differences adversarial domain adaption. domain adaptation domain adaptation standard strategy deal data across different domains synthetic versus real. large synthetic datasets used bootstrap detectors adapted real data moving target domain distribution. saenko used models train detectors real objects. work typically used shallow detectors deﬁned ﬁxed feature sets focus gradient-based adaption deep detection networks perspective work inspired approaches deep domain adaptation work typically assumes access large amounts unlabeled data target domain. case assembling large target dataset unlabelled examples challenging necessitating need alternative approaches make stronger source dataset. generative adversarial nets gans deep networks generate synthetic images latent noise vectors. adversarially-training neural network discriminate real versus synthetic images. recent works shown impressive performance generation synthetic images however appears challenging synthesize high-resolution images semantically-valid content. circumvent limitations rendering-based adversarial approach image synthesis. figure show percentage number people image datasets. show percentage different types people datasets. precarious dataset contains cyclists motorcyclists caltech dataset. begin describing precarious pedestrian dataset. perform dedicated search targeted keywords google images baidu images selected images mpii dataset producing total reasonable images. label bounding boxes image manually. precarious pedestrians contains various kinds scenes children running road people tripping motorcyclists performing dangerous movements people interacting objects important dangerous increasingly common scenario consists people watching phones texting crossing street potentially dangerous person aware surroundings quantify similarity precarious pedestrians standard pedestrian benchmarks caltech tabulate percentage images people well number irregular pedestrians bicyclists motorcyclists. compared caltech precarious pedestrians contains images many overall people well many cyclists motorbikes split precarious dataset equally training testing. help train evaluate algorithms detecting precarious pedestrians make synthetic data. section describe rendering pipeline generating synthetic data. unity game engine basic platform simulation rendering large availability commercial user-generated assets form models character animations. figure shows commercial human models data generation consisting models spanning different women cyclists skateboarder avatars. designed game engine play model associated characteristic animations jumping talking running cheering applauding. animate models scene billboard capture scene background shown figure billboards randomly sampled background images inria dataset custom outdoor scenes downloaded internet. approach generate diverse background scenes unlike approaches limited single virtual urban city scene parameters build large library synthetic images potentially used training evaluation ﬁrst deﬁne parameters parameter ranges. index background images models animation frame number model. brief scene parameters include directional light intensity direction background image index number models model index specifying avatar animation frame well root position orientation assume ﬁxed camera viewpoint. note root position affects location scale model rendered image. parameters summarized variable-length vector vector corresponds particular scene instantiation. synthesis generator rendering engine synthesizes image corresponding importantly also synthesize labels rendered image specifying object type location pixel segmentation masks etc. practice make object bounding boxes. table shows viable ranges parameter. addition found following heuristic simulate reasonable object layouts enforce maximum overlap models projected location models within camera’s ﬁeld-of-view. conditions straightforward verify given vector without rendering pixels efﬁciently enforced though rejection sampling unlike hironori generate training data manually tuning match speciﬁc scenes approach scene speciﬁc require manual intervention. pre-processing synthesized images precarious pedestrian images different sizes. isotropically scale image resolution zero-padding necessary. experiments also make caltech pedestrian benchmark apply pre-processing. domain adaption section introduce novel framework adversarially adapting detectors synthetic training data real training data. denote image denote label vector refer distribution image-label pairs source domain refer target domain problem expect large amounts source samples limited amount target ones. factorize joint marginal image appearance conditional label given appearance e.g. psps. importantly discriminatively train feedforward function match conditional distribution. central question transfer feedforward predictors trained source samples target domain fine-tuning natural approach domain adaption simply ﬁne-tune predictor originally trained source samples target indeed virtually contemporary methods visual recognition makes ﬁne-tuned models pre-trained imagenet compare strategy experiments ﬁne-tuning works best source target distributions similar. argue rendering engines produce photorealistic scenes difﬁcult specify prior scene parameters mimic real scenes. describe solution adversarially learns prior. generators introduced sec. vector scene parameters feedforward generator function renders synthetic image given scene parameters function generates labels scene parameters. reparameterize distribution synthetic images distribution scene parameters describe procedure learning prior allows easier transfer. speciﬁcally learn prior fools adversary trying distinguish samples source target. adversarial generators describe approach ﬁrst recall traditional generative adverserial network minmax optimization jointly tries estimate discriminator distinguish real versus synthesized data examples generator tries synthesize realistic examples fool discriminator. typically discriminator trained output probability real ﬁxed zero-mean unit-variance gaussian. optimization performed stochastic gradient updates converge ﬁxed point minimax problem. refer reader excellent introduction importantly generator must encode complex constraints manifold natural images capture amongst knowledge physical properties light transport material appearance. adversarial priors note rendering engines viewed generators already contain much knowledge production-quality rendering platform instead learn prior generator differentiable respect possible backprop compute gradient updates simple prior distributions gaussians implies formulation adversarial priors amenable gradient-based learning. imposter search difﬁculties directly applying problem seems unlikely optimal prior precarious scene parameters simple unimodal distribution single mean parameter vector rendering readily expressed feed-forward function naturally differentiable object boundaries approximate differentiable renderers exist wish make highly-optimized commercial packages animation image synthesis such adopt simple samplingbased approach addresses limitations ex∼pt] ez∼u search subset parameter vectors fool discriminator. could employ various sequential sampling strategies optimizing above; start random sample parameter vectors update discriminator generate additional samples close imposters fool discriminator repeat. found single iteration work quite well. algorithm synthesizing realistic precarious scenes given alg. overall approach advesarial domain adaption given alg. input examples source domain target domain output subset imposters train binary discriminator network distinguishes examples return subset samples best fool discriminator. here consists synthetic image-label pairs rendered exhaustive scene parameters consists real image-label pairs. without step alg. reduces standard ﬁne-tuning input examples source domain target domain output predictor target pre-train predictor source adapt predictor imposters found alg. fine-tune predictor target source target domain. step thought marginal distribution adaption since distribution imposter images mimics true target distribution least discriminator’s perspective. importantly discriminator made labels imposters imposter labels mimic true target label distribution. this ﬁnally ﬁne-tune target image-label pairs. alternatively explore discriminator directly operates pairs data labels implementation discriminator discriminator network trained output probability input images real synthetic found modest number images sufﬁced training images precarious pedestrian train split random synthetic images. downsample images accelerate training. training generate another synthetic images select various subsets size deﬁne imposter roughly synthesized images serve reasonable imposters. predictor make detection system based region proposal network rather training return objectness proposals train directly return pedestrian bounding boxes. network denoted rpn+ illustrated figure rpn+ fully convolutional network implemented tensorflow. concatenate several layers different stages order improve ability locating people different resolutions. anchors sliding position. training candidate bounding treated positive intersection-over-union overlap ground-truth exceeds negative overlaps less accelerate training time initialize pretrained vgg- model ﬁrst convolutional layers frozen. follow evaluation protocol caltech pedestrian dataset curves bounding detection overlap thresholds. testsets three different datasets evaluation novel precarious pedestrian testset real images novel adverserial imposter testset diagnostics standard pedestrian benchmark dataset baselines compare approach following baselines aggregate channel features detector ldcf ldcf detector hog+cascade cascade boosted classiﬁers working features harr+cascade cascade boosted classiﬁers working haar-like features. rpn/bf detection model trained boosted forest appears state-of-the-art pedestrian detection system time publication. precarious pedestrians results precarious pedestrians presented figure detector signiﬁcantly outperforms alternative approaches including state-of-theart rpn/bf model. false positive image miss rate signiﬁcantly outperforms baselines including state-of-the-art rpn/bf model note baseline detectors trained caltech. comparing baselines complicated fact detection system training dataset changed. however sense fundamental contribution method generating accurate training datasets adversarial imposters. isolate impact underlying detection network rpn+ also train variant solely caltech training making directly comparable baselines training set. rpn+caltech performs slightly worse rpn/bf though outperforms rpn/bf higher false positive rates. suggests underlying network close state-of-the-art moreover validates signiffigure curves different detectors different overlap ratio criteria precarious pedestrian testset. legend denote miss rate false positives image. rpn+caltech refers rpn+ network architecture trained caltech refers detector trained synthetic imposter real images note detectors besides trained caltech dataset. icant improvement training adversarial imposters. figure visualizes results rpn+ trained caltech trained adversarial imposters. qualitatively precarious pedestrians tend take pose variation typical pedestrians. requires detection systems able report back wider range bounding scales aspect ratios. adversarial imposters also explore detectors perform testset adversarial imposters. note generate arbitrarily large testset since synthetic. figure figure show performance real test data synthetic test data ranking order. results suggest synthetic data useful testset evaluating detectors rare scenarios difﬁcult observe real test data. caltech finally completeness also test rpn+ network caltech dataset figure here detectors trained caltech dataset. reference rpn+caltech model would currently rank entries caltech dataset leaderboard. also attempted evaluate ﬁnal model caltech lackluster performance. posit different scales aspect ratios precarious pedestrians. leave crossdataset analysis future work. diagnostics section explore various variants approach. table examines different ﬁne-tuning strategies adapting detectors source domain synthetic images target domain real precarious images. finetuning imposters performs best nofigure examines effect size imposter set. good performance equal size target precarious pedestrians used training. retrospect surprising produces balanced distribution real images adversarial imposters training. finally figure also explores impact discriminator. plots performance function training epoch used learn train better discriminator performance overadversarial pipeline gets noticeably better. explored methods analyzing in-the-tail urban scenes represent important modes operations autonomous vehicles. motivated fact rare dangerous scenes exactly scenarios visual recognition excel ﬁrst analyze existing datasets illustrate contain sufﬁcient rare scenarios address collected dataset precarious pedestrians release spur research important problem. precarious scenes challenging little data available evaluation training. address challenge propose synthetic data generated game engine. however challenging ensure synthesized data matches statistics real precarious scenarios. inspired generative adversarial networks introduce discriminative classiﬁer implicitly specify distribution. synthesized data fooled discriminator train evaluate state-of-the-art robust pedestrian detection systems. figure algorithm rankings real datasets synthetic dataset. curves detectors precarious dataset synthetic dataset. ours trained selection model. results suggest performances algorithms real dataset synthetic dataset rankings.", "year": 2017}