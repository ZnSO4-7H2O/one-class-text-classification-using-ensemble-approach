{"title": "Neural Stain-Style Transfer Learning using GAN for Histopathological  Images", "tag": ["cs.CV", "cs.AI"], "abstract": "Performance of data-driven network for tumor classification varies with stain-style of histopathological images. This article proposes the stain-style transfer (SST) model based on conditional generative adversarial networks (GANs) which is to learn not only the certain color distribution but also the corresponding histopathological pattern. Our model considers feature-preserving loss in addition to well-known GAN loss. Consequently our model does not only transfers initial stain-styles to the desired one but also prevent the degradation of tumor classifier on transferred images. The model is examined using the CAMELYON16 dataset.", "text": "performance data-driven network tumor classiﬁcation varies stain-style histopathological images. article proposes stain-style transfer model based conditional generative adversarial networks learn certain color distribution also corresponding histopathological pattern. model considers feature-preserving loss addition well-known loss. consequently model transfers initial stain-styles desired also prevent degradation tumor classiﬁer transferred images. model examined using camelyon dataset. keywords deep learning stain normalization domain adaptation neural style transfer generative adversarial network deep learning based image recognition receives attention notable application digital histopathology including automatic tumor classiﬁcation. convolutional neural networks recently achieved state-of-the-art performance task image classiﬁcation detection especially replaced traditional rule-based methods several contests medical image diagnosis lecun wang data-driven approach especially depends quality training dataset hence requires sensible preprocesses. histopathology staining e.g. haematoxylin eosin essential examine microscopic presence characteristics disease pathologists also neural networks. digital histopathology several stain normalization preprocesses well-known ruifrok reinhard ruifrok annadurai magee macenko khan plataniotis bejnordi standard stain normalization algorithms based stain-speciﬁc color deconvolution ruifrok stain deconvolution requires prior knowledge reference stain vecfigure samples tissue tiles diﬀerent institutes camelyoncam dataset. ﬁrst shows normal samples second shows tumor samples. samples institute included others included dataset. tors every present whole-slide images ruifrok suggested manual approach estimate color deconvolution vectors selecting representative sample pixels stain class similar approach used magee extracting stain vectors. manual estimation stain vectors however strongly limits applicability large studies. khan modiﬁed magee estimating stable stain matrices using image-speciﬁc color descriptor. combined robust color classiﬁcation framework based variety training data particular stain nonlinear channel mappings method ensured smooth color transformation without introducing visual artifacts. another approach used bejnordi transforms chromatic density distributions individual stain class hue-saturation-density color model. bejnordi references therein. stain normalization methods histopathological images studied extensively still possess challenging issues. conventional methods various thresholds ﬁlter backgrounds irrelevant dimensions. however methods cannot represent broad feature distribution entire target image thus require manual tuning hyper-parameters thresholds. furthermore since nuclei detection signiﬁcant impact performance color normalization unlikely expect good performance mistake nuclei detection stage. finally although major conventional approaches enhance prediction performance classiﬁcation system stain normalization methods classifer work separately. reported performance network varies institutes even applied staining methods ciompi order prevent variation required consider domain adaption method. paper propose novel stain-style transfer method using deep learning well special loss function minimizes diﬀerence latent features input image target image thus preserves performance classiﬁer. contributions paper areas. first replace color normalization methods generative model learns certain stain-style distribution dataset. second introduce feature-preserving loss induce classiﬁer extract better features diﬀerent methods. dataset histological sample corresponding label class stained images color images channels denoted deﬁned d-matrix entries. setting deﬁne stain-style institute random variable probability suppose trained tumor classiﬁer network infers histological pattern input image write classiﬁer especially trained dataset follows stain-style estimate performance since stain-styles institute dissimilar histological pattern image diﬀerent institute would break view classiﬁer network. consequently would show degraded performance ciompi figure overview stain-style transfer network. network composed transformations gray-normalization style-generator standardizes stain-style color images diﬀerent institutes colorizes gray images following stain-style certain institute. state. procedure every stained image might transferred desired stain-style. however approach often tend make frequent color images independent histological pattern. phenomena called mode collapse possibly interrupt achieving therefore need additional loss function. perform quantitative experiment tumor classiﬁcation evaluate network. show general performance method apply extensions vanilla models well conventional method. baseline methods reinhard macenko histogram speciﬁcation annadurai color standardization bejnordi camelyon dataset composed slides diﬀerent institutes radbound utrecht. patches training validation radbound patches testing utrecht. number tumor normal same. hypothesizing training validation dataset belong certain institue test another merge every stain-style space applying gray normalization. training validation dataset labeled supervised learning applied train mapping gray image colored one. used gray classiﬁer network carries tasks experiment. firstly discriminator evaluates performance stain-style generator secondly already explained subsection works feature-extractor used feature preserving loss generator network provided image input instead noise vector. therefore type architectures u-net famous network among them. however limit performance fusionnet combined advantages u-net resnet. hyperparameters network quan adapt discriminator architectures radford based vgg-net without pooling layer. hyperparameters discriminator radford figure illustrates result stain normalization method sample image. target image comes radbound used training tumor classiﬁer. original image sampled utrecht used testing tumor classiﬁer. although visual diﬀerence outputs method classiﬁcation performance color images varies signiﬁcantly. given experiment results table network successfully avoids performance degradation. achieves highest performance original images tumor classiﬁcation area curve result shows diﬀerence visual judgment result classiﬁer. case wsics’s result visually similar sst’s score worse hand macenko visually worst performs better methods except sst. conventional methods consider physical features input images lose patterns features classiﬁer’s decision making process. contrast maintains features input image’s patterns also consider color distribution target images well contextual information original images. table performance tumor classiﬁer network diﬀerent stain normalization methods. network shows signiﬁcant improvement compared direct application original outperforms others. work presented stain style transfer approach stain normalization histopathological images. replace stain normalization models generative model learns certain stain-style distribution training dataset. stain style transfer network considerably simpler contemporaneous work produces realistic results without additional labeling annotation training well prior knowledge. further unlike conventional stain normalization acts independently tumor classiﬁer proposed feature-preserving loss induces coloration direction aﬀect tumor classiﬁer. demonstate model optimized performance tumor classiﬁer allows successful stain-style transfer. style chemical cell staining mainly aﬀected structural information morphology cells rather factors cell brightness. based observation points converted test image gray image performed stain style transfer process. method advantage making process simpler also lost information. resolve limitation investigation assess direct stain style transfer approach color image color image. addition hope closely examine parameters deep learning approach. further perform rounds hard negative mining consider reliability reproducibility deep models.", "year": 2017}